<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Chromium UI Development</h1>

<h2>Ben</h2>

<a class="video" href="http://youtu.be/WsvNebq1dRg">youtu.be/WsvNebq1dRg</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="1"><span class="speakerName">Ben</span>: So, I'm going </span><span class="line" data-startTime="1">to talk today about </span><span class="line" data-startTime="3">the Chrome UI framework </span><span class="line" data-startTime="3">that we use on Windows </span><span class="line" data-startTime="6">called views, </span><span class="line" data-startTime="7">how we build UI there, </span><span class="line" data-startTime="7">how we test it, </span><span class="line" data-startTime="10">and stuff like that. </span> <span class="line" data-startTime="12">And some more people's </span><span class="line" data-startTime="12">coming in. </span> <span class="line" data-startTime="15">[clears throat] </span><span class="line" data-startTime="19">So anyway, hopefully, </span><span class="line" data-startTime="19">this will sort of give you </span><span class="line" data-startTime="21">a broad idea of how </span><span class="line" data-startTime="21">the framework works. </span> <span class="line" data-startTime="24">If you haven't used it before, </span><span class="line" data-startTime="25">if you find yourself having </span><span class="line" data-startTime="25">to do any UI development &mdash; </span><span class="line" data-startTime="29">Maybe if you've even </span><span class="line" data-startTime="29">already been using &mdash; </span><span class="line" data-startTime="31">done all of the UI stuff, </span><span class="line" data-startTime="31">but don't think that </span><span class="line" data-startTime="34">the UI framework extends </span><span class="line" data-startTime="34">beyond the status bubble. </span> <span class="line" data-startTime="38">That was a joke for Glenn. </span> <span class="line" data-startTime="41">But anyway, the view system </span><span class="line" data-startTime="41">is basically &mdash; </span><span class="line" data-startTime="45">it's a rendering system </span><span class="line" data-startTime="45">and an event handling system </span><span class="line" data-startTime="48">for drawing stuff into Windows </span><span class="line" data-startTime="48">and handling events, </span><span class="line" data-startTime="52">and stuff that happen in them. </span></p>

<p><span class="line" data-startTime="54">So basically, </span><span class="line" data-startTime="54">you have top-level windows, </span><span class="line" data-startTime="58">and within them </span><span class="line" data-startTime="58">you have individual controls. </span> <span class="line" data-startTime="61">And these things are &mdash; </span><span class="line" data-startTime="61">we call them views. </span> <span class="line" data-startTime="63">And there's a base class </span><span class="line" data-startTime="63">for all of them that is view, </span><span class="line" data-startTime="66">in the view's namespace &mdash; </span><span class="line" data-startTime="68">in the sky, he can paint </span><span class="line" data-startTime="68">into a canvas, </span><span class="line" data-startTime="72">he can receive events, </span><span class="line" data-startTime="75">and do all kinds of things </span><span class="line" data-startTime="75">in response to those. </span> <span class="line" data-startTime="79">So the views toolkit provides </span><span class="line" data-startTime="79">some basic widgets </span><span class="line" data-startTime="83">that allow you </span><span class="line" data-startTime="83">to construct UI. </span> <span class="line" data-startTime="86">And all of these widgets </span><span class="line" data-startTime="86">are just sub-classes of view. </span> <span class="line" data-startTime="90">And they override things </span><span class="line" data-startTime="90">like Paint and other stuff </span><span class="line" data-startTime="91">to do interesting things. </span> <span class="line" data-startTime="94">So the view itself &mdash; </span><span class="line" data-startTime="94">all of the rendering </span><span class="line" data-startTime="96">that we do in views is use Skia. </span></p>

<p><span class="line" data-startTime="99">And so when we paint, </span><span class="line" data-startTime="99">we paint into Skia canvases </span><span class="line" data-startTime="103">and use some of the Skia </span><span class="line" data-startTime="103">utilities to make things happen. </span> <span class="line" data-startTime="108">And so, if you've done work </span><span class="line" data-startTime="108">on WebKit, </span><span class="line" data-startTime="111">you might find that this </span><span class="line" data-startTime="111">is somewhat similar to the way </span><span class="line" data-startTime="115">rendering works within WebKit, </span><span class="line" data-startTime="115">except much, much simpler, </span><span class="line" data-startTime="118">because we don't have to, </span><span class="line" data-startTime="118">you know, support things like </span><span class="line" data-startTime="122">HTML, CSS, </span><span class="line" data-startTime="122">and all that kind of stuff. </span> <span class="line" data-startTime="125">So basically, it's just </span><span class="line" data-startTime="125">a very simple layout </span><span class="line" data-startTime="127">and rendering system. </span> <span class="line" data-startTime="129">And so, I'll just tell you </span><span class="line" data-startTime="129">a little bit about how it all </span><span class="line" data-startTime="132">sort of fits together. </span> <span class="line" data-startTime="134">Like I said, we have </span><span class="line" data-startTime="134">this view thing </span><span class="line" data-startTime="135">that is like the individual </span><span class="line" data-startTime="135">controls within a window. </span> <span class="line" data-startTime="139">The actual window itself </span><span class="line" data-startTime="139">at the top level &mdash; </span><span class="line" data-startTime="142">we have something </span><span class="line" data-startTime="142">that we call a widget. </span> <span class="line" data-startTime="144">Which is &mdash; </span><span class="line" data-startTime="144">on Windows, this is a hWnd. </span></p>

<p><span class="line" data-startTime="148">Because in Windows, </span><span class="line" data-startTime="149">eventually you have </span><span class="line" data-startTime="149">to have an hWnd. </span> <span class="line" data-startTime="150">hWnd is what Windows thinks of </span><span class="line" data-startTime="150">as the control. </span> <span class="line" data-startTime="153">And it doesn't know </span><span class="line" data-startTime="153">anything else about </span><span class="line" data-startTime="155">what else we might do. </span> <span class="line" data-startTime="157">So, we have this class called </span><span class="line" data-startTime="157">Widget Win, on Windows, </span><span class="line" data-startTime="162">which basically is responsible </span><span class="line" data-startTime="164">for translating operating </span><span class="line" data-startTime="164">system messages, </span><span class="line" data-startTime="167">things like WMPaint, </span><span class="line" data-startTime="169">WML button down, </span><span class="line" data-startTime="169">all that sort of thing, </span><span class="line" data-startTime="171">into things that </span><span class="line" data-startTime="171">our view system understands. </span> <span class="line" data-startTime="175">And so this guy </span><span class="line" data-startTime="175">has all these message handlers, </span><span class="line" data-startTime="178">and he does that. </span></p>

<p><span class="line" data-startTime="180">And the widget is responsible </span><span class="line" data-startTime="182">for hosting a special kind </span><span class="line" data-startTime="182">of view called a root view. </span> <span class="line" data-startTime="185">Maybe if I just come over here </span><span class="line" data-startTime="185">and I'll just draw the structure </span><span class="line" data-startTime="188">on this white board. </span> <span class="line" data-startTime="219">Oh, maybe Ian can &mdash; </span><span class="line" data-startTime="223">So, Ian's just gonna turn </span><span class="line" data-startTime="223">the camera around. </span> <span class="line" data-startTime="227">Okay. </span> <span class="line" data-startTime="235">Here we go. </span> <span class="line" data-startTime="237">So I've just drawn </span><span class="line" data-startTime="237">some boxes here. </span> <span class="line" data-startTime="239">The outermost box is </span><span class="line" data-startTime="239">the Widget Win. </span> <span class="line" data-startTime="241">So there would be, </span><span class="line" data-startTime="241">you know, </span><span class="line" data-startTime="242">when you're typically writing </span><span class="line" data-startTime="242">Windows code, </span><span class="line" data-startTime="244">you have your hWnd </span><span class="line" data-startTime="244">and you might have child hWnds </span><span class="line" data-startTime="245">and stuff like that. </span> <span class="line" data-startTime="246">Here is the Widget Windows, </span><span class="line" data-startTime="246">the hWnd. </span> <span class="line" data-startTime="249">And inside that, </span><span class="line" data-startTime="249">we have a single view, </span><span class="line" data-startTime="251">which is a root view. </span> <span class="line" data-startTime="252">And the root view is a sub-class </span><span class="line" data-startTime="252">of view that does some &mdash; </span><span class="line" data-startTime="256">basically, it figures out </span><span class="line" data-startTime="256">how to propagate events </span><span class="line" data-startTime="258">and all that sort of thing. </span></p>

<p><span class="line" data-startTime="260">So that sits there. </span> <span class="line" data-startTime="261">And then within the root view, </span><span class="line" data-startTime="264">there is basically </span><span class="line" data-startTime="264">the view hierarchy. </span> <span class="line" data-startTime="266">And so for the Chrome </span><span class="line" data-startTime="266">browser window, </span><span class="line" data-startTime="268">there is a fairly </span><span class="line" data-startTime="268">deep hierarchy of views, </span><span class="line" data-startTime="271">starting with the frame, </span><span class="line" data-startTime="271">with the window </span><span class="line" data-startTime="274">and all the way down </span><span class="line" data-startTime="274">to individual buttons </span><span class="line" data-startTime="275">and so on the toolbar. </span> <span class="line" data-startTime="277">And then dialogue boxes, </span><span class="line" data-startTime="277">you end up with the same thing. </span> <span class="line" data-startTime="280">You know, there's the frame </span><span class="line" data-startTime="280">with the dialogue box, </span><span class="line" data-startTime="281">and then you'll end up </span><span class="line" data-startTime="281">with individual buttons </span><span class="line" data-startTime="284">and text fields and whatnot </span><span class="line" data-startTime="284">inside that. </span></p>

<p><span class="line" data-startTime="287">And so one of the most common </span><span class="line" data-startTime="287">things that you will do </span><span class="line" data-startTime="292">if you have to build some UI, </span><span class="line" data-startTime="293">you might have to create </span><span class="line" data-startTime="293">a dialogue box for something. </span> <span class="line" data-startTime="295">Maybe you're implementing </span><span class="line" data-startTime="295">a new feature </span><span class="line" data-startTime="297">and you need to configure it </span><span class="line" data-startTime="297">or pop up something. </span> <span class="line" data-startTime="300">And so, we have a special kind </span><span class="line" data-startTime="300">of widget </span><span class="line" data-startTime="302">that is just for creating </span><span class="line" data-startTime="302">a top-level window </span><span class="line" data-startTime="306">or dialogue box, </span><span class="line" data-startTime="306">and that's called Window. </span> <span class="line" data-startTime="308">And it's basically </span><span class="line" data-startTime="308">a sub-class of widget. </span> <span class="line" data-startTime="312">And that provides you </span><span class="line" data-startTime="312">with the ability to create </span><span class="line" data-startTime="316">a top-level window, </span><span class="line" data-startTime="317">and have all of </span><span class="line" data-startTime="317">the right appearance, </span><span class="line" data-startTime="318">the Chrome blue frame </span><span class="line" data-startTime="318">and all sorts of other things </span><span class="line" data-startTime="322">that sort of come </span><span class="line" data-startTime="322">automatically. </span> <span class="line" data-startTime="324">And so you do that </span><span class="line" data-startTime="324">in your code. </span></p>

<p><span class="line" data-startTime="326">Basically, you create </span><span class="line" data-startTime="326">one of these windows, </span><span class="line" data-startTime="328">and you provide it </span><span class="line" data-startTime="328">with something called </span><span class="line" data-startTime="330">a window delegate. </span> <span class="line" data-startTime="331">And a window delegate </span><span class="line" data-startTime="331">is this object. </span> <span class="line" data-startTime="333">It's an interface that you </span><span class="line" data-startTime="333">implement on your object, </span><span class="line" data-startTime="336">then you get notified of things </span><span class="line" data-startTime="336">like the window is closing, </span><span class="line" data-startTime="338">and you also get to configure </span><span class="line" data-startTime="338">the window through </span><span class="line" data-startTime="340">your implementation </span><span class="line" data-startTime="340">of this interface. </span> <span class="line" data-startTime="343">Things like whether or not </span><span class="line" data-startTime="343">you can be resized or maximized, </span><span class="line" data-startTime="347">or things like that. </span> <span class="line" data-startTime="350">So by doing that, </span><span class="line" data-startTime="350">you basically &mdash; </span><span class="line" data-startTime="353">you tell the window </span><span class="line" data-startTime="353">how it should look </span><span class="line" data-startTime="354">when it gets created, </span><span class="line" data-startTime="354">and also, </span><span class="line" data-startTime="357">you can respond to events </span><span class="line" data-startTime="357">that come from the window, </span><span class="line" data-startTime="359">through your window delegate. </span> <span class="line" data-startTime="361">And typically, </span><span class="line" data-startTime="361">the way this works is &mdash; </span><span class="line" data-startTime="364">when you build a dialogue box, </span><span class="line" data-startTime="364">you'll create a view </span><span class="line" data-startTime="368">that is the contents </span><span class="line" data-startTime="368">of your dialogue box. </span> <span class="line" data-startTime="371">And that will actually </span><span class="line" data-startTime="371">be the thing </span><span class="line" data-startTime="372">that sits in here somewhere. </span></p>

<p><span class="line" data-startTime="375">And your view that &mdash; </span><span class="line" data-startTime="375">your contents view </span><span class="line" data-startTime="378">is actually your &mdash; in most cases </span><span class="line" data-startTime="378">in the Chrome code, </span><span class="line" data-startTime="381">it ends up being </span><span class="line" data-startTime="381">the window delegate. </span> <span class="line" data-startTime="383">And that is able to respond </span><span class="line" data-startTime="383">to the, you know, </span><span class="line" data-startTime="385">closing of the things, </span><span class="line" data-startTime="385">and it can go and configure &mdash; </span><span class="line" data-startTime="388">it can go and, you know, </span><span class="line" data-startTime="388">do things, you know, </span><span class="line" data-startTime="391">when the window is closed. </span> <span class="line" data-startTime="392">Maybe you wanna perform an </span><span class="line" data-startTime="392">action or something like that, </span><span class="line" data-startTime="394">or scrape the state out of </span><span class="line" data-startTime="394">any text boxes that you have, </span><span class="line" data-startTime="397">and things like that. </span> <span class="line" data-startTime="399">Specifically for </span><span class="line" data-startTime="399">a dialogue box, </span><span class="line" data-startTime="401">we have some sugar on top of </span><span class="line" data-startTime="401">a window delegate called </span><span class="line" data-startTime="404">dialogue delegate </span><span class="line" data-startTime="404">that supports being able </span><span class="line" data-startTime="407">to create dialogue boxes </span><span class="line" data-startTime="408">that have okay cancel buttons </span><span class="line" data-startTime="408">and such. </span></p>

<p><span class="line" data-startTime="411">And so that makes </span><span class="line" data-startTime="411">that sort of thing a bit easier. </span> <span class="line" data-startTime="413">By the way, all this code &mdash; </span><span class="line" data-startTime="415">if I didn't mention this before, </span><span class="line" data-startTime="415">I probably should have &mdash; </span><span class="line" data-startTime="416">is in the Chrome source </span><span class="line" data-startTime="416">under source/chrome/views. </span> <span class="line" data-startTime="421">And there's some sub-directories </span><span class="line" data-startTime="421">under there </span><span class="line" data-startTime="422">that kind of organize this </span><span class="line" data-startTime="422">into related sections. </span> <span class="line" data-startTime="427">So some of the stuff </span><span class="line" data-startTime="427">that I was just talking about, </span><span class="line" data-startTime="429">window, window delegate, </span><span class="line" data-startTime="429">etcetera, is in view/window. </span> <span class="line" data-startTime="433">And there's a lot of </span><span class="line" data-startTime="433">the other things around there. </span> <span class="line" data-startTime="436">And there's a controls directory </span><span class="line" data-startTime="436">as well, </span><span class="line" data-startTime="438">where you can find </span><span class="line" data-startTime="438">the individual controls </span><span class="line" data-startTime="442">that you can use buttons, </span><span class="line" data-startTime="442">labels, etcetera, etcetera. </span></p>

<p><span class="line" data-startTime="446">So I'll just mention </span><span class="line" data-startTime="446">a couple of the controls. </span> <span class="line" data-startTime="448">I mean, most of them </span><span class="line" data-startTime="448">will make sense </span><span class="line" data-startTime="450">if you've ever done </span><span class="line" data-startTime="450">any kind of UI programming </span><span class="line" data-startTime="451">with any framework. </span> <span class="line" data-startTime="454">You know, </span><span class="line" data-startTime="454">most of them make sense. </span> <span class="line" data-startTime="455">We have a couple </span><span class="line" data-startTime="455">of interesting ones. </span> <span class="line" data-startTime="457">One is called hWnd View. </span> <span class="line" data-startTime="459">Sometimes you need to wrap </span><span class="line" data-startTime="459">a native windows control. </span> <span class="line" data-startTime="465">Sometimes you just have </span><span class="line" data-startTime="465">an hWnd. </span> <span class="line" data-startTime="467">And you need to put that </span><span class="line" data-startTime="470">into your view hierarchy </span><span class="line" data-startTime="470">somewhere. </span> <span class="line" data-startTime="471">And thing is, is that because </span><span class="line" data-startTime="471">an hWnd isn't a Chrome view &mdash; </span><span class="line" data-startTime="475">it is an hWnd. </span> <span class="line" data-startTime="476">It's not gonna get resized </span><span class="line" data-startTime="476">automatically </span><span class="line" data-startTime="479">per the layout rules </span><span class="line" data-startTime="481">that you specify </span><span class="line" data-startTime="481">in your view hierarchy. </span></p>

<p><span class="line" data-startTime="484">So what we have is a control </span><span class="line" data-startTime="484">called hWnd View </span><span class="line" data-startTime="488">that basically allows you </span><span class="line" data-startTime="488">to take any hWnd </span><span class="line" data-startTime="490">that you might have &mdash; </span><span class="line" data-startTime="490">say you have a &mdash; </span><span class="line" data-startTime="492">I'll just use one example </span><span class="line" data-startTime="492">of a renderer </span><span class="line" data-startTime="494">or some other control </span><span class="line" data-startTime="494">that you might have, </span><span class="line" data-startTime="495">where you just have </span><span class="line" data-startTime="495">the hWnd of it. </span> <span class="line" data-startTime="497">You can create an hWnd view </span><span class="line" data-startTime="497">and attach the hWnd to it. </span> <span class="line" data-startTime="500">And from then on, </span><span class="line" data-startTime="501">any time the hWnd view </span><span class="line" data-startTime="501">gets resized, </span><span class="line" data-startTime="503">it'll automatically size </span><span class="line" data-startTime="503">the hWnd with it. </span></p>

<p><span class="line" data-startTime="506">So that means that you can </span><span class="line" data-startTime="506">basically have your hWnd, </span><span class="line" data-startTime="509">your individual native hWnds </span><span class="line" data-startTime="509">take part in the window layout. </span> <span class="line" data-startTime="515">And we have some other ones </span><span class="line" data-startTime="515">like hWnd HTML view, </span><span class="line" data-startTime="517">which is a specialization </span><span class="line" data-startTime="517">of hWnd View </span><span class="line" data-startTime="520">that allows you to specifically </span><span class="line" data-startTime="520">embed a web rendering area </span><span class="line" data-startTime="525">within your view hierarchy. </span> <span class="line" data-startTime="528">Now I just talked </span><span class="line" data-startTime="528">a little bit about layout, </span><span class="line" data-startTime="529">and that's something </span><span class="line" data-startTime="529">that's kind of interesting. </span> <span class="line" data-startTime="531">A lot of the times when </span><span class="line" data-startTime="531">you're building a dialogue box, </span><span class="line" data-startTime="533">you might use one of the &mdash; </span><span class="line" data-startTime="535">you might use </span><span class="line" data-startTime="535">the existing layout manager, </span><span class="line" data-startTime="536">like GridLayout, </span><span class="line" data-startTime="536">which allows you to specify &mdash; </span><span class="line" data-startTime="539">so you have a nicely lined up </span><span class="line" data-startTime="539">arrangement of controls, </span><span class="line" data-startTime="545">if you're putting something </span><span class="line" data-startTime="545">together like that. </span> <span class="line" data-startTime="546">And there's some header files </span><span class="line" data-startTime="546">around that define, </span><span class="line" data-startTime="549">you know, nicely &mdash; </span><span class="line" data-startTime="551">the nice aesthetic spacing </span><span class="line" data-startTime="551">between controls </span><span class="line" data-startTime="553">and stuff like that. </span> <span class="line" data-startTime="555">Sometimes you might be doing </span><span class="line" data-startTime="555">something more specific, </span><span class="line" data-startTime="557">more custom, things like </span><span class="line" data-startTime="557">the top-level browser window, </span><span class="line" data-startTime="560">for instance, </span><span class="line" data-startTime="560">is not using a grid layout </span><span class="line" data-startTime="562">because everything is very </span><span class="line" data-startTime="562">specific to the individual case. </span></p>

<p><span class="line" data-startTime="565">In this case for </span><span class="line" data-startTime="565">your view method, </span><span class="line" data-startTime="566">you just override layout, </span><span class="line" data-startTime="568">and then you get to specify </span><span class="line" data-startTime="568">each child's bounds </span><span class="line" data-startTime="571">when your layout method </span><span class="line" data-startTime="571">is called. </span> <span class="line" data-startTime="573">Layout is called automatically </span><span class="line" data-startTime="573">by the framework </span><span class="line" data-startTime="575">whenever the top-level widget </span><span class="line" data-startTime="575">is resized. </span> <span class="line" data-startTime="579">Basically, it goes down through </span><span class="line" data-startTime="579">the hierarchy calling layout. </span> <span class="line" data-startTime="582">And then basically </span><span class="line" data-startTime="582">each child view &mdash; </span><span class="line" data-startTime="588">each view has a layout called, </span><span class="line" data-startTime="589">and then it goes and sizes </span><span class="line" data-startTime="589">its children. </span> <span class="line" data-startTime="591">And when the children's </span><span class="line" data-startTime="591">bounds change, </span><span class="line" data-startTime="593">it calls layout and it </span><span class="line" data-startTime="593">just propagates like that. </span> <span class="line" data-startTime="596">So part of that &mdash; </span><span class="line" data-startTime="598">there's another method </span><span class="line" data-startTime="598">that you might override </span><span class="line" data-startTime="599">sometimes called </span><span class="line" data-startTime="599">Get Preferred Size. </span> <span class="line" data-startTime="602">And the preferred size </span><span class="line" data-startTime="602">of your widget </span><span class="line" data-startTime="604">is basically the size </span><span class="line" data-startTime="604">that you want your view to be </span><span class="line" data-startTime="608">when it's layed out. </span></p>

<p><span class="line" data-startTime="609">So you might say that your view, </span><span class="line" data-startTime="609">wants to be, you know, 20 x 30, </span><span class="line" data-startTime="613">and then when that view's parent </span><span class="line" data-startTime="613">is called, </span><span class="line" data-startTime="616">it might call </span><span class="line" data-startTime="616">Get Preferred Size </span><span class="line" data-startTime="617">and then size that </span><span class="line" data-startTime="617">and position it, </span><span class="line" data-startTime="619">and stuff like that. </span> <span class="line" data-startTime="621">So that's something else </span><span class="line" data-startTime="621">that you might find you do. </span> <span class="line" data-startTime="626">I just figured I'd talk briefly </span><span class="line" data-startTime="626">about the construction </span><span class="line" data-startTime="631">of the top-level window </span><span class="line" data-startTime="631">as well. </span> <span class="line" data-startTime="633">Sometimes you see some of these </span><span class="line" data-startTime="633">things in your call stack. </span> <span class="line" data-startTime="636">It might be interesting </span><span class="line" data-startTime="636">to know what they are. </span></p>

<p><span class="line" data-startTime="637">Like I said before, </span><span class="line" data-startTime="638">and I drew my diagram </span><span class="line" data-startTime="638">of it here, </span><span class="line" data-startTime="641">the top-level Widget Win window </span><span class="line" data-startTime="641">is the container, </span><span class="line" data-startTime="646">the native hWnd that contains </span><span class="line" data-startTime="646">the view hierarchy. </span> <span class="line" data-startTime="649">Top-level view is a root view. </span> <span class="line" data-startTime="652">Then inside that, </span><span class="line" data-startTime="652">in every single case these days, </span><span class="line" data-startTime="656">the only child </span><span class="line" data-startTime="656">of the root view </span><span class="line" data-startTime="659">is something called </span><span class="line" data-startTime="659">a non-client view. </span> <span class="line" data-startTime="661">And this kind of maps to </span><span class="line" data-startTime="661">the window's concept </span><span class="line" data-startTime="664">of client and non-client </span><span class="line" data-startTime="664">rendering. </span> <span class="line" data-startTime="666">On Windows, when you have </span><span class="line" data-startTime="666">a non-client area, </span><span class="line" data-startTime="669">this is the area that is </span><span class="line" data-startTime="669">the frame of the window, </span><span class="line" data-startTime="672">the title by the sizing border, </span><span class="line" data-startTime="672">stuff like that. </span></p>

<p><span class="line" data-startTime="674">And then inside that, </span><span class="line" data-startTime="674">you have a client area, </span><span class="line" data-startTime="676">which is the contents </span><span class="line" data-startTime="676">of the window. </span> <span class="line" data-startTime="679">So it kind of replicated </span><span class="line" data-startTime="679">that here in the view system. </span> <span class="line" data-startTime="682">The non-client view contains </span><span class="line" data-startTime="682">the client view, </span><span class="line" data-startTime="685">and it also contains a &mdash; </span><span class="line" data-startTime="685">what we call a frame view, </span><span class="line" data-startTime="688">which actually renders </span><span class="line" data-startTime="689">the blue border around </span><span class="line" data-startTime="689">the window. </span> <span class="line" data-startTime="694">And so &mdash; </span><span class="line" data-startTime="694">and that can do </span><span class="line" data-startTime="696">all of the specific </span><span class="line" data-startTime="696">functionality for that. </span> <span class="line" data-startTime="698">And then the client view </span><span class="line" data-startTime="698">is the thing </span><span class="line" data-startTime="700">that actually contains </span><span class="line" data-startTime="700">the contents. </span> <span class="line" data-startTime="701">So I should have simplified this </span><span class="line" data-startTime="701">a bit before </span><span class="line" data-startTime="703">when I was talking about </span><span class="line" data-startTime="703">dialogue boxes, </span><span class="line" data-startTime="705">and I said that you would make </span><span class="line" data-startTime="705">a contents view for your &mdash; </span><span class="line" data-startTime="707">had the controls </span><span class="line" data-startTime="707">of your dialogue box, </span><span class="line" data-startTime="709">and that would go </span><span class="line" data-startTime="709">into the window. </span> <span class="line" data-startTime="711">That actually goes inside </span><span class="line" data-startTime="711">of client view. </span></p>

<p><span class="line" data-startTime="714">You don't actually get to see </span><span class="line" data-startTime="714">any of this. </span> <span class="line" data-startTime="715">It's all hidden behind </span><span class="line" data-startTime="715">the call to create Chrome window </span><span class="line" data-startTime="718">that you make. </span> <span class="line" data-startTime="720">But the client view is the thing </span><span class="line" data-startTime="720">that basically &mdash; </span><span class="line" data-startTime="723">in the case of a dialogue box, </span><span class="line" data-startTime="724">the client view provides </span><span class="line" data-startTime="724">the Okay and Cancel buttons, </span><span class="line" data-startTime="727">and stuff like that. </span> <span class="line" data-startTime="728">And you may find that, </span><span class="line" data-startTime="728">you know, </span><span class="line" data-startTime="731">you find yourself in there </span><span class="line" data-startTime="731">sometimes </span><span class="line" data-startTime="733">if you're trying </span><span class="line" data-startTime="733">to figure something out. </span> <span class="line" data-startTime="735">So just a general high-level </span><span class="line" data-startTime="735">comment about the way that </span><span class="line" data-startTime="739">the front end is being developed </span><span class="line" data-startTime="739">primarily because &mdash; </span><span class="line" data-startTime="744">all the stuff I've talked about </span><span class="line" data-startTime="744">so far </span><span class="line" data-startTime="746">is related to UI that we've been </span><span class="line" data-startTime="746">building on windows. </span></p>

<p><span class="line" data-startTime="749">But we are a cross-platform </span><span class="line" data-startTime="749">project. </span> <span class="line" data-startTime="752">And so there is </span><span class="line" data-startTime="752">a lot of logic </span><span class="line" data-startTime="754">that is shared </span><span class="line" data-startTime="754">between platforms. </span> <span class="line" data-startTime="757">And you'll find that there are </span><span class="line" data-startTime="757">a lot of objects </span><span class="line" data-startTime="758">within the browser front end </span><span class="line" data-startTime="760">that are actually </span><span class="line" data-startTime="760">cross platforms. </span> <span class="line" data-startTime="764">Things like browser, </span><span class="line" data-startTime="764">tab content, stuff like that. </span> <span class="line" data-startTime="767">And so we didn't want </span><span class="line" data-startTime="767">to tie them too closely together </span><span class="line" data-startTime="769">with our windows implementation </span><span class="line" data-startTime="769">of the front end, </span><span class="line" data-startTime="771">so we used the sort of </span><span class="line" data-startTime="771">the standard approach </span><span class="line" data-startTime="773">for this in model view </span><span class="line" data-startTime="773">controller layout, where &mdash; </span><span class="line" data-startTime="778">we consider some of </span><span class="line" data-startTime="778">the state objects like browser, </span><span class="line" data-startTime="780">tab contents, etcetera, </span><span class="line" data-startTime="780">to be the state of the model </span><span class="line" data-startTime="784">in this case, and then the &mdash; </span><span class="line" data-startTime="786">all of the Chrome view stuff, </span><span class="line" data-startTime="786">that's kind of the &mdash; </span><span class="line" data-startTime="789">that's sort of the view </span><span class="line" data-startTime="789">controller side of things. </span></p>

<p><span class="line" data-startTime="792">And what this means is that </span><span class="line" data-startTime="792">we can separate out this model </span><span class="line" data-startTime="794">and we can actually use that on </span><span class="line" data-startTime="794">Mac and Linux, </span><span class="line" data-startTime="797">which is what we're doing. </span> <span class="line" data-startTime="798">And also because there isn't </span><span class="line" data-startTime="798">this sort of type coupling </span><span class="line" data-startTime="801">of that particular UI state. </span> <span class="line" data-startTime="803">And it's also a lot easier </span><span class="line" data-startTime="803">to write unit tests </span><span class="line" data-startTime="805">for the model. </span> <span class="line" data-startTime="808">And I'll get to that </span><span class="line" data-startTime="808">in just a moment. </span> <span class="line" data-startTime="810">Actually, I'll get to that </span><span class="line" data-startTime="810">right now. </span> <span class="line" data-startTime="812">So because the &mdash; </span><span class="line" data-startTime="815">like I said, </span><span class="line" data-startTime="815">because it separated it out, </span><span class="line" data-startTime="817">it's been more possible </span><span class="line" data-startTime="817">to write more unit tests. </span></p>

<p><span class="line" data-startTime="819">Sometimes you have a relatively </span><span class="line" data-startTime="819">simple state object, </span><span class="line" data-startTime="822">and you can just write </span><span class="line" data-startTime="822">a regular unit test for it </span><span class="line" data-startTime="825">using the existing </span><span class="line" data-startTime="825">unit test framework </span><span class="line" data-startTime="827">and get that to work. </span> <span class="line" data-startTime="829">Sometimes you wanna do something </span><span class="line" data-startTime="829">a little bit more complicated, </span><span class="line" data-startTime="831">and you wanna test functionality </span><span class="line" data-startTime="831">that goes out and loads pages, </span><span class="line" data-startTime="835">you know, off a test server </span><span class="line" data-startTime="835">and stuff like that. </span> <span class="line" data-startTime="838">So we have a thing called </span><span class="line" data-startTime="838">in-process browser tests </span><span class="line" data-startTime="841">that basically allow &mdash; </span><span class="line" data-startTime="842">that basically spins up </span><span class="line" data-startTime="842">a message loop </span><span class="line" data-startTime="845">and allows you to simulate </span><span class="line" data-startTime="845">running the actual browser, </span><span class="line" data-startTime="848">but in a unit test. </span> <span class="line" data-startTime="849">And these are pretty easy </span><span class="line" data-startTime="849">to write. </span> <span class="line" data-startTime="850">We're still getting </span><span class="line" data-startTime="850">some of the kinks </span><span class="line" data-startTime="852">worked out of the system, </span><span class="line" data-startTime="853">but they're still pretty easy </span><span class="line" data-startTime="853">to write and run in isolation. </span></p>

<p><span class="line" data-startTime="856">And finally, we have UI tests </span><span class="line" data-startTime="856">which are much higher level, </span><span class="line" data-startTime="860">very deep sort of tests </span><span class="line" data-startTime="860">that basically run </span><span class="line" data-startTime="864">the whole browser </span><span class="line" data-startTime="864">in a separate process. </span> <span class="line" data-startTime="866">Basically, to run the browser </span><span class="line" data-startTime="866">as a user would. </span> <span class="line" data-startTime="868">And it sends commands to it </span><span class="line" data-startTime="868">through an automation API. </span> <span class="line" data-startTime="871">I would recommend if </span><span class="line" data-startTime="871">you're writing new features </span><span class="line" data-startTime="873">to write most stuff </span><span class="line" data-startTime="873">as unit tests </span><span class="line" data-startTime="875">or in-process browser tests </span><span class="line" data-startTime="877">'cause these are the easiest </span><span class="line" data-startTime="877">to debug. </span> <span class="line" data-startTime="879">But if you want to get &mdash; </span><span class="line" data-startTime="880">if you want something to run </span><span class="line" data-startTime="880">on Chrome Bot </span><span class="line" data-startTime="883">or any of these other things, </span><span class="line" data-startTime="885">you would need to write UI </span><span class="line" data-startTime="885">tests, and automated UI tests. </span> <span class="line" data-startTime="890">So that's sort of a brief </span><span class="line" data-startTime="890">summary of the framework. </span></p></div>