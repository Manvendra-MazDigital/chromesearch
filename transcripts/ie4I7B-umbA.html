<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Google I/O 2012 &mdash; Fast UIs for the Cross-Device Web</h1>

<h2>Boris Smus</h2>

<a class="video" href="http://youtu.be/ie4I7B-umbA">youtu.be/ie4I7B-umbA</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="7"><span class="speakerName">Boris Smus</span>: All right. Hey, folks, good </span><span class="line" data-startTime="7">to see so many people in the room. Can everyone </span><span class="line" data-startTime="13">hear me fine? </span><span class="line" data-startTime="13">Great. So my name is Boris Smus. I'm an engineer </span><span class="line" data-startTime="18">in the Chrome developer relations team. And </span><span class="line" data-startTime="18">this talk is called Fast User Interface for </span><span class="line" data-startTime="23">the cross-device Web. So before talking about </span><span class="line" data-startTime="23">this, let me motivate the subject a little </span><span class="line" data-startTime="30">bit. Who cares? </span><span class="line" data-startTime="30">And I care and you should care because this </span><span class="line" data-startTime="36">is the current state of mobile internet usage </span><span class="line" data-startTime="36">compared to desktop internet usage. So you </span><span class="line" data-startTime="41">can see the projected cross-over point for </span><span class="line" data-startTime="41">when mobile becomes more used, and this is </span><span class="line" data-startTime="48">sometime around 2013, 2014. This is all internet </span><span class="line" data-startTime="48">use, so not just Web. The Web is currently </span><span class="line" data-startTime="55">about 10% of all &mdash; mobile Web is about 10% </span><span class="line" data-startTime="55">of all Web usage and it's been doubling every </span><span class="line" data-startTime="62">year, so expect this to change very drastically. </span> <span class="line" data-startTime="62">Note that I call the talk cross-device, and </span><span class="line" data-startTime="71">not mobile, because the term mobile is a little </span><span class="line" data-startTime="71">bit overloaded. Does it include tablets? </span><span class="line" data-startTime="77">Does it include other kinds of devices like </span><span class="line" data-startTime="77">TVs, cars, et cetera? </span><span class="line" data-startTime="81">And what is the opposite of mobile? </span><span class="line" data-startTime="81">Stationary? </span><span class="line" data-startTime="84">Desktop? </span><span class="line" data-startTime="84">Not clear. So I'm not going to jump into pedantic </span><span class="line" data-startTime="89">discussions about this. Instead, clearly, </span><span class="line" data-startTime="89">this is not a mobile device, so this is a </span><span class="line" data-startTime="95">desktop, and many people still think of this </span><span class="line" data-startTime="95">as the target for the Web. But, in fact, the </span><span class="line" data-startTime="102">Web looks a lot more like this. We have a </span><span class="line" data-startTime="102">mass of devices that all access &mdash; that all </span><span class="line" data-startTime="108">expect Web content to serve correctly for </span><span class="line" data-startTime="108">them, tablets, SmartPhones, et cetera, it's </span><span class="line" data-startTime="113">very complex landscape, and it's only going </span><span class="line" data-startTime="113">to get more complex and more interesting with </span><span class="line" data-startTime="119">future interactions that can include gestural </span><span class="line" data-startTime="119">UIs, handtracking, full body tracking, et </span><span class="line" data-startTime="127">cetera, or audio input. So how can we talk </span><span class="line" data-startTime="127">about this broad topic? </span><span class="line" data-startTime="133">There are still a set of common issues that </span><span class="line" data-startTime="133">we need to tackle for all of these problems </span><span class="line" data-startTime="138">that I've discussed. We have a wide variety </span><span class="line" data-startTime="138">of form factors, as you saw a couple of slides </span><span class="line" data-startTime="144">ago. In addition we have CPUs and networks </span><span class="line" data-startTime="144">that are much, much slower and much less predictable </span><span class="line" data-startTime="149">in many cases on mobile devices. We need to </span><span class="line" data-startTime="149">deal with new kinds of input, specifically </span><span class="line" data-startTime="155">touch and multi-touch, and we have issues </span><span class="line" data-startTime="155">with developing when your host machine is </span><span class="line" data-startTime="160">not your target machine. So I'll talk more </span><span class="line" data-startTime="160">about that, in addition. So this is &mdash; these </span><span class="line" data-startTime="165">are all issues, but they're also &mdash; this is </span><span class="line" data-startTime="165">also a outline for the rest of the talk. So </span><span class="line" data-startTime="171">let's jump right in into the form factor question. </span></p>

<p><span class="line" data-startTime="171">And how do we support multiple devices that </span><span class="line" data-startTime="177">access our site? </span><span class="line" data-startTime="177">First extreme is we simply create one version. </span> <span class="line" data-startTime="185">And some people do this. Some of the examples </span><span class="line" data-startTime="185">of sites that do &mdash; that take this approach </span><span class="line" data-startTime="191">are shown here. We have &mdash; you can see text </span><span class="line" data-startTime="191">that's not very clearly readable. It's very </span><span class="line" data-startTime="197">small on a mobile device. Text that's being </span><span class="line" data-startTime="197">cut off because the developers didn't intend </span><span class="line" data-startTime="203">it to be used on such a screen, or in this </span><span class="line" data-startTime="203">last example, we have actually two versions, </span><span class="line" data-startTime="209">one of which says the device doesn't work </span><span class="line" data-startTime="209">on your phone, or the application doesn't </span><span class="line" data-startTime="213">work on your phone. Sorry. So this is not </span><span class="line" data-startTime="213">a very good extreme to be at. The other opposite </span><span class="line" data-startTime="219">end of the spectrum is to create a version </span><span class="line" data-startTime="219">for each device, so we have here a very incomplete </span><span class="line" data-startTime="226">list of sound devices in the market and you </span><span class="line" data-startTime="226">can simply say, okay, let's develop a version </span><span class="line" data-startTime="232">for each. You can see this has ten devices, </span><span class="line" data-startTime="232">there's probably hundreds, maybe thousands </span><span class="line" data-startTime="236">of devices out there. It's simply not feasible </span><span class="line" data-startTime="236">to do this, especially if you take into account </span><span class="line" data-startTime="241">the number of browsers that exists on some </span><span class="line" data-startTime="241">platforms. For example, Android supports a </span><span class="line" data-startTime="245">wide variety of browsers. So we need to find </span><span class="line" data-startTime="245">some sort of middle ground, keeping in mind </span><span class="line" data-startTime="251">this tradeoff that the more versions you create </span><span class="line" data-startTime="251">the better each one can be from a user experience </span><span class="line" data-startTime="256">perspective but the more effort it will require. </span></p>

<p><span class="line" data-startTime="256">So the question then is where can we save </span><span class="line" data-startTime="263">some effort? </span><span class="line" data-startTime="263">And how can we make this a &mdash; how can we make </span><span class="line" data-startTime="267">a better decision what to build? </span><span class="line" data-startTime="267">So we have two sort of axes to choose from. </span> <span class="line" data-startTime="275">We have platforms and form factors. Let's </span><span class="line" data-startTime="275">talk about platforms. So native platforms, </span><span class="line" data-startTime="284">this is a bit of an aside, they provide human </span><span class="line" data-startTime="284">interface guidelines and UI frameworks, so </span><span class="line" data-startTime="291">this is on the &mdash; on the right, example of </span><span class="line" data-startTime="291">a human interface guideline for Android, it </span><span class="line" data-startTime="296">provides a set of common UI controls and the </span><span class="line" data-startTime="296">corresponding UI framework makes it really </span><span class="line" data-startTime="301">easy to build that kind of UI for a developer. </span> <span class="line" data-startTime="301">So the point of this is to make it &mdash; to have </span><span class="line" data-startTime="308">developers fall into a pit of success by default. </span> <span class="line" data-startTime="308">If you try to do this sort of thing on the </span><span class="line" data-startTime="313">Web, as some people have, you quickly run </span><span class="line" data-startTime="313">into problems, so emulating native UIs is </span><span class="line" data-startTime="322">a perilous path. It's hard to implement. You're </span><span class="line" data-startTime="322">going to be always slightly off and look and/or </span><span class="line" data-startTime="328">feel, and even once you've done this painstaking </span><span class="line" data-startTime="328">effort that some people have taken, you still </span><span class="line" data-startTime="334">have to repeat that same process on every </span><span class="line" data-startTime="334">other platform that you want to support. So </span><span class="line" data-startTime="340">if you want to read more about some pour soul </span><span class="line" data-startTime="340">that did this, you should check out this guy's </span><span class="line" data-startTime="344">blog post. It's very detailed and good. He </span><span class="line" data-startTime="344">goes into details like you can see a little </span><span class="line" data-startTime="349">bit of diagonal artifact here in the CSS version </span><span class="line" data-startTime="349">of this platform. So that kind of level of </span><span class="line" data-startTime="357">detail. So generally speaking platform differences </span><span class="line" data-startTime="357">vary &mdash; platform differences are both small, </span><span class="line" data-startTime="363">so we can have different styles for buttons, </span><span class="line" data-startTime="363">but some of them may appear bigger, for example, </span><span class="line" data-startTime="369">the placement of navigation bar, the Android </span><span class="line" data-startTime="369">human interface guideline says to place it </span><span class="line" data-startTime="375">at the top of the screen whereas the IOS one </span><span class="line" data-startTime="375">places it on the bottom. Fairly major change, </span><span class="line" data-startTime="381">but it's important to note that these are </span><span class="line" data-startTime="381">differences that &mdash; or, sorry, these are rules </span><span class="line" data-startTime="385">that are meant to be broken, and in many cases </span><span class="line" data-startTime="385">are. So on Android many applications place </span><span class="line" data-startTime="391">the tool bar on the bottom, whereas on IOS </span><span class="line" data-startTime="391">for example, on iPad the guidelines actually </span><span class="line" data-startTime="396">say to place it on the top. If we look at </span><span class="line" data-startTime="396">form factor differences, though, these are </span><span class="line" data-startTime="404">much bigger. We have completely different </span><span class="line" data-startTime="404">usage patterns, phones that you hold with </span><span class="line" data-startTime="408">one hand, and tablets that you hold with two. </span></p>

<p><span class="line" data-startTime="408">Major variations in screen real estate. So </span><span class="line" data-startTime="415">these form factor differences I would say </span><span class="line" data-startTime="415">trump platform differences, so as a first </span><span class="line" data-startTime="423">cut, and I'm not saying that this is perfect </span><span class="line" data-startTime="423">for your application, we can consider having </span><span class="line" data-startTime="428">multiple versions of our site, and compromise </span><span class="line" data-startTime="428">to phone, tablet and desktop, just as a starting </span><span class="line" data-startTime="438">point. So how do we actually build this? </span><span class="line" data-startTime="438">We build this &mdash; there's two possible angles </span><span class="line" data-startTime="444">to come at it from. We can start from single </span><span class="line" data-startTime="444">version and make tweaks &mdash; diversion tweaks </span><span class="line" data-startTime="448">to that version, or we can say up front we're </span><span class="line" data-startTime="448">going to build three versions and serve the </span><span class="line" data-startTime="454">correct one. So the first version, many of </span><span class="line" data-startTime="454">you are probably familiar with CSS media queries. </span> <span class="line" data-startTime="462">In case you're not, it's an easy way to tweak </span><span class="line" data-startTime="462">your CSS style sheets depending on properties </span><span class="line" data-startTime="469">of your device. So here I have a media query </span><span class="line" data-startTime="469">which says if the screen is less than 1,000 </span><span class="line" data-startTime="475">pixels, then hide the side bar. So this is </span><span class="line" data-startTime="475">pretty straightforward, and is used to create </span><span class="line" data-startTime="483">websites that look like this. So here is a </span><span class="line" data-startTime="483">German design magazine, and you can see, as </span><span class="line" data-startTime="493">I resize the page, the styling changes subtly. </span></p>

<p><span class="line" data-startTime="493">You will see &mdash; you'll notice also that Chrome </span><span class="line" data-startTime="503">has a minimum size. Let me show you a cool </span><span class="line" data-startTime="503">trick that you can &mdash; you may not know. I </span><span class="line" data-startTime="508">can actually resize the page using the developer </span><span class="line" data-startTime="508">tools. Resize it back to the correct size </span><span class="line" data-startTime="515">here. Switch over to Dev Tools, and I will </span><span class="line" data-startTime="515">override device metrics here and pick the </span><span class="line" data-startTime="521">resolution that I want. Just set it to 320 </span><span class="line" data-startTime="521">by 480, and you can see I've sized it down </span><span class="line" data-startTime="529">&mdash; I couldn't use Chrome natively &mdash; or sorry, </span><span class="line" data-startTime="529">I couldn't resize Chrome to be this small. </span> <span class="line" data-startTime="536">You can get a good preview of how these sites </span><span class="line" data-startTime="536">look like using this feature. But there's </span><span class="line" data-startTime="546">limitations to this approach, right? </span><span class="line" data-startTime="546">We're talking here about a shared DOM, shared </span><span class="line" data-startTime="551">JavaScript and simply tweaking the CSS. So </span><span class="line" data-startTime="551">if we want to make big changes between form </span><span class="line" data-startTime="557">factors such as this example here where we </span><span class="line" data-startTime="557">have Gmail native apps for Android, you can </span><span class="line" data-startTime="563">imagine the pain that you would have to go </span><span class="line" data-startTime="563">through to use this same HTML and create these </span><span class="line" data-startTime="568">separate layouts. A lot of CSS tweaks, a lot </span><span class="line" data-startTime="568">of hidden content, a lot of conditional CSS </span><span class="line" data-startTime="576">for the various &mdash; for the two form factors. </span></p>

<p><span class="line" data-startTime="576">Also, since we have shared JavaScript in this </span><span class="line" data-startTime="581">case, how do we load additional functionality? </span><span class="line" data-startTime="581">So one middle ground here, between these &mdash; between </span><span class="line" data-startTime="590">the two extremes of one version and separate </span><span class="line" data-startTime="590">versions completely is using media queries </span><span class="line" data-startTime="596">in JavaScript, we can do this with the window </span><span class="line" data-startTime="596">of match media call, and this lets you evaluate </span><span class="line" data-startTime="602">arbitrary media queries as in this sample, </span><span class="line" data-startTime="602">you can see I'm evaluating this media query </span><span class="line" data-startTime="607">and I'm seeing if it matches or not. You can </span><span class="line" data-startTime="607">also listen for changes with this event listener, </span><span class="line" data-startTime="615">syntax, and here in this example, I'm listening </span><span class="line" data-startTime="615">for the orientation media query, and as soon </span><span class="line" data-startTime="621">as that changes, if I switch from portrait </span><span class="line" data-startTime="621">to landscape, this will fire, and I can respond </span><span class="line" data-startTime="627">to that. It's a much nicer way of going about </span><span class="line" data-startTime="627">things using orientation change. </span></p>

<p><span class="line" data-startTime="636">But if we want to completely separate the </span><span class="line" data-startTime="636">two &mdash; separate the versions that we want </span><span class="line" data-startTime="642">to create, we can take an approach like this. </span> <span class="line" data-startTime="642">This is really simple code that basically </span><span class="line" data-startTime="649">says default to a desk &mdash; to the desktop version, </span><span class="line" data-startTime="649">then check for touch support, if there's touch </span><span class="line" data-startTime="655">support and the screen is small, is there </span><span class="line" data-startTime="655">a phone version, otherwise if the screen is </span><span class="line" data-startTime="659">large but touch is still enabled, serve the </span><span class="line" data-startTime="659">tablet. So here we need to figure out how </span><span class="line" data-startTime="667">to know if there's touch or not. Right now </span><span class="line" data-startTime="667">there's not a really good way of doing this </span><span class="line" data-startTime="671">on the open Web. So we can use modernizr or </span><span class="line" data-startTime="671">other feature detection libraries to do this </span><span class="line" data-startTime="678">sort of thing. So modernizr.touch will return </span><span class="line" data-startTime="678">true if touch is enabled. But we have media </span><span class="line" data-startTime="686">queries that are coming through the pipe. </span> <span class="line" data-startTime="686">They're not implemented anywhere yet. We have </span><span class="line" data-startTime="691">hover and pointer media queries which are </span><span class="line" data-startTime="691">used to distinguish between pointer or mouse </span><span class="line" data-startTime="698">pointer type input and touch input. The other </span><span class="line" data-startTime="698">question here is how do we know what's small </span><span class="line" data-startTime="706">enough? </span><span class="line" data-startTime="706">Where do we draw the line between phones and </span><span class="line" data-startTime="710">tablets? </span><span class="line" data-startTime="710">So we can evaluate the media query, but where </span><span class="line" data-startTime="714">do we set this boundary? </span><span class="line" data-startTime="714">So here is a &mdash; on the right &mdash; diagram of </span><span class="line" data-startTime="724">various mobile devices and their resolutions </span><span class="line" data-startTime="724">in CSS pixels, so it's important here for </span><span class="line" data-startTime="730">this discussion to remember that, CSS pixels </span><span class="line" data-startTime="730">are not the same as device pixels. CSS pixels </span><span class="line" data-startTime="736">are scaled to the &mdash; they're scaled by the </span><span class="line" data-startTime="736">device pixel ratio to be virtually sized, </span><span class="line" data-startTime="745">essentially, so the history here is when Apple </span><span class="line" data-startTime="745">released iPhone 4, they had doubled the resolution </span><span class="line" data-startTime="752">of both dimensions, creating four times as </span><span class="line" data-startTime="752">many pixels on the screen. So if they did </span><span class="line" data-startTime="757">nothing about this, then sites would render </span><span class="line" data-startTime="757">at half size, so they introduced this notion </span><span class="line" data-startTime="762">of device pixel ratio, and sites render the </span><span class="line" data-startTime="762">same way on iPhone 4 and iPhone 3, and other </span><span class="line" data-startTime="769">device vendors have been embracing this and </span><span class="line" data-startTime="769">providing device pixel ratios sometimes of </span><span class="line" data-startTime="775">2, sometimes of 1.5, sometimes somewhat irrational </span><span class="line" data-startTime="775">numbers so it's a little bit interesting and </span><span class="line" data-startTime="784">you should definitely be aware of this &mdash; this </span><span class="line" data-startTime="784">concept. So if we take a look at the diagram, </span><span class="line" data-startTime="790">we can say, well, let's just draw the line </span><span class="line" data-startTime="790">at, let's see, 400, somewhere between 400 </span><span class="line" data-startTime="797">and 600, that's pretty straightforward, right? </span><span class="line" data-startTime="797">But we should remember that all these devices </span><span class="line" data-startTime="801">have landscape mode as well, in which case </span><span class="line" data-startTime="801">width becomes height, height becomes width. </span></p>

<p><span class="line" data-startTime="806">So the actual picture is something more like </span><span class="line" data-startTime="806">this, if we take a look at the max of the </span><span class="line" data-startTime="813">two dimensions for phones and they're meant </span><span class="line" data-startTime="813">for tablets, so we can draw the line roughly </span><span class="line" data-startTime="818">at 650 pixels, and this will work most of </span><span class="line" data-startTime="818">the time with some exceptions. For example, </span><span class="line" data-startTime="824">some &mdash; some tablets in portrait mode, in </span><span class="line" data-startTime="824">this case will get the phone version. So if </span><span class="line" data-startTime="833">you're specifying multiple versions of your </span><span class="line" data-startTime="833">site, you may be sharing a URL or you may </span><span class="line" data-startTime="837">have separate URLs. If you have separate URLs, </span><span class="line" data-startTime="837">then you can declaratively define all the </span><span class="line" data-startTime="844">versions of your site in your head section, </span><span class="line" data-startTime="844">and you can do that with the link rel equals </span><span class="line" data-startTime="848">alternate and the idea here is you specify </span><span class="line" data-startTime="848">the URLs and the associated media queries </span><span class="line" data-startTime="855">for each of these versions. This is good for </span><span class="line" data-startTime="855">crawlers that are indexing your site so that </span><span class="line" data-startTime="860">they can know which versions exist and to </span><span class="line" data-startTime="860">crawl them with these different settings. </span></p>

<p><span class="line" data-startTime="867">So one thing that you might want to do is </span><span class="line" data-startTime="867">based on these versions that you've declared </span><span class="line" data-startTime="872">up front, redirect correctly. So the Web doesn't </span><span class="line" data-startTime="872">do this for you, so I worked on a project </span><span class="line" data-startTime="880">called device.js which tries to formalize </span><span class="line" data-startTime="880">this approach, and what it does is it parses </span><span class="line" data-startTime="886">the link alternates in your head section, </span><span class="line" data-startTime="886">matches the media queries and then redirects </span><span class="line" data-startTime="892">you to the right version, if necessary. So </span><span class="line" data-startTime="892">let me quickly show you how this works. So </span><span class="line" data-startTime="900">I'll &mdash; I'll load up a really simple application. </span> <span class="line" data-startTime="900">This is a fake to do list. Now, if I send </span><span class="line" data-startTime="907">it over to Chrome, on my phone, and switch </span><span class="line" data-startTime="907">it, switch the camera here, let me just load </span><span class="line" data-startTime="927">it up... one second... all right. Okay. So </span><span class="line" data-startTime="927">I've &mdash; I've loaded the same exact URL on </span><span class="line" data-startTime="941">both devices, here I've been redirected to </span><span class="line" data-startTime="941">the phone version. Let me do that again. I'll </span><span class="line" data-startTime="947">try loading to desktop version. Sorry. Hmmm... </span> <span class="line" data-startTime="947">it's going to work, trust me. Could you guys </span><span class="line" data-startTime="993">turn off your internet? </span><span class="line" data-startTime="993">[chuckling] </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="993"><span class="speakerName">Boris Smus</span>: I should have done that Steve </span><span class="line" data-startTime="993">Jobs thing. </span><span class="line" data-startTime="997">[ Laughter ] </span></p>

<p class="speaker"><span class="line" data-starttime="997"><span class="speakerName">Boris Smus</span>: Thanks. Let's try this one. </span> <span class="line" data-startTime="1018">The pipes are clogged. It's terrible. Ah, </span><span class="line" data-startTime="1018">amazing. Watch this. It's loading. So the </span><span class="line" data-startTime="1028">same URL loaded a completely different version, </span><span class="line" data-startTime="1028">so let me just show you for comparison here, </span><span class="line" data-startTime="1038">the desktop version, the phone version, so </span><span class="line" data-startTime="1038">it's useful to still provide a fall-back mechanism </span><span class="line" data-startTime="1044">so that you're able to specify a different </span><span class="line" data-startTime="1044">version if you prefer it, so device.js does </span><span class="line" data-startTime="1049">that as well, and here if I switch to layout </span><span class="line" data-startTime="1049">&mdash; landscape mode, I may actually prefer the </span><span class="line" data-startTime="1055">tablet version, so if I pick it, then I can </span><span class="line" data-startTime="1055">override the default version that was served </span><span class="line" data-startTime="1062">to me and this will eventually load, so we </span><span class="line" data-startTime="1062">can move on for now. So for more details about </span><span class="line" data-startTime="1069">this project, take a look at the GitHub page, </span><span class="line" data-startTime="1069">and you're welcome to collaborate with me </span><span class="line" data-startTime="1076">on it, so that's the clientside story, so </span><span class="line" data-startTime="1076">we've taken a look at both of these approaches, </span><span class="line" data-startTime="1083">separate versions and one shared version, </span><span class="line" data-startTime="1083">but the client has performance penalties for </span><span class="line" data-startTime="1090">doing redirection, so if we do a redirect </span><span class="line" data-startTime="1090">that costs somewhere between 100 and 1,000 </span><span class="line" data-startTime="1096">milliseconds, on the server we can save on </span><span class="line" data-startTime="1096">that redirection in some cases, so the only </span><span class="line" data-startTime="1102">problem with the server is we have much less </span><span class="line" data-startTime="1102">features than we do on the client. We don't </span><span class="line" data-startTime="1107">have JavaScript. We don't have media queries. </span></p>

<p><span class="line" data-startTime="1107">All we have is a user agent string, and this </span><span class="line" data-startTime="1113">string gets sent with every request, so the </span><span class="line" data-startTime="1113">server can decide what to do with this. You </span><span class="line" data-startTime="1120">can see it's a bit of a mess, so this is what </span><span class="line" data-startTime="1120">Chrome for Android user agent string looks </span><span class="line" data-startTime="1125">like, and this is pretty much as complicated </span><span class="line" data-startTime="1125">as most other browsers. You can see there's </span><span class="line" data-startTime="1132">mentions of pretty much every single browser </span><span class="line" data-startTime="1132">that has ever existed. I'm exaggerating. But </span><span class="line" data-startTime="1138">it's kind of a messy thing to deal with. Let </span><span class="line" data-startTime="1138">me show you a couple of tools that can make </span><span class="line" data-startTime="1143">this a bit easier. Firstly, let me show you </span><span class="line" data-startTime="1143">how pervasive this use is of user agent strings </span><span class="line" data-startTime="1150">on the net. So here is YouTube. If I open </span><span class="line" data-startTime="1150">Dev Tools, and I'll turn off this screen scaling </span><span class="line" data-startTime="1158">device metrics feature that I had before. </span></p>

<p><span class="line" data-startTime="1158">I can override the user agent, so why don't </span><span class="line" data-startTime="1163">I set it to Galaxy Nexus on Android 402, you'll </span><span class="line" data-startTime="1163">notice the device metrics have been set for </span><span class="line" data-startTime="1170">me, automatically, based on a little database </span><span class="line" data-startTime="1170">that you just send the developer tools, but </span><span class="line" data-startTime="1176">when I over &mdash; when I reload the page here, </span><span class="line" data-startTime="1176">now I've &mdash; I've used a new &mdash; I've reset </span><span class="line" data-startTime="1183">my user agent header and YouTube has sent </span><span class="line" data-startTime="1183">me a completely different version of the page, </span><span class="line" data-startTime="1189">so just for comparison, this is the mobile </span><span class="line" data-startTime="1189">version, and if I reload, I just the regular </span><span class="line" data-startTime="1195">YouTube version, it's a completely separate </span><span class="line" data-startTime="1195">page, so many, many Web properties use this </span><span class="line" data-startTime="1200">service side detection and redirect you without </span><span class="line" data-startTime="1200">you even knowing. So how do they do it? </span><span class="line" data-startTime="1209">Generally, they have some sort of device database. </span> <span class="line" data-startTime="1209">These are typically large databases of known </span><span class="line" data-startTime="1217">user agents and their capabilities and what </span><span class="line" data-startTime="1217">device databases do is they try to find the </span><span class="line" data-startTime="1222">closest known UA and give you information </span><span class="line" data-startTime="1222">based on your client. So a couple of them </span><span class="line" data-startTime="1230">are device applets in WURFL. They have drawbacks </span><span class="line" data-startTime="1230">in that they're nonfree for commercial use. </span></p>

<p><span class="line" data-startTime="1236">They come in two flavors, typically, one as </span><span class="line" data-startTime="1236">an API service, so you can make a request </span><span class="line" data-startTime="1242">every time you get a new client connected </span><span class="line" data-startTime="1242">and ask a service somewhere else in the Cloud </span><span class="line" data-startTime="1248">what that user agent is, or you can set it </span><span class="line" data-startTime="1248">up yourself, but it's not that simple to do, </span><span class="line" data-startTime="1254">so that's the state-of-the-art right now. </span> <span class="line" data-startTime="1254">And just to recap this multiple versions idea. </span> <span class="line" data-startTime="1262">If you're separating your versions upfront, </span><span class="line" data-startTime="1262">I would recommend to start with device.js </span><span class="line" data-startTime="1268">or some other similar solution in the client, </span><span class="line" data-startTime="1268">measure performance overhead, see if that </span><span class="line" data-startTime="1273">performance of mobile or of clientside redirection </span><span class="line" data-startTime="1273">is too high, and if that penalty is too high, </span><span class="line" data-startTime="1280">then switch to user side. So at this point </span><span class="line" data-startTime="1280">you're probably thinking this guy is telling </span><span class="line" data-startTime="1287">me to create multiple versions of my app. </span></p>

<p><span class="line" data-startTime="1287">This is terrible. I'm not going to do this. </span> <span class="line" data-startTime="1295">And I am probably &mdash; I'm thinking you're probably </span><span class="line" data-startTime="1295">using a model view controller or if not, you </span><span class="line" data-startTime="1300">should be. So if you don't know what this </span><span class="line" data-startTime="1300">pattern is, it is a way to separate the presentation </span><span class="line" data-startTime="1306">layer of your code from the structure and </span><span class="line" data-startTime="1306">data logic, business logic of your application. </span> <span class="line" data-startTime="1313">So with a cross-device approach, we can simply </span><span class="line" data-startTime="1313">swap out the views, create form factor specific </span><span class="line" data-startTime="1321">views and serve them to the various devices </span><span class="line" data-startTime="1321">sharing a lot of code. Okay. So that's the </span><span class="line" data-startTime="1331">story for multiple versions, single versions. </span> <span class="line" data-startTime="1331">Let's talk about some technical things about </span><span class="line" data-startTime="1335">building a great UI. Firstly, what makes a </span><span class="line" data-startTime="1335">great UI? </span><span class="line" data-startTime="1342">On the Web, on the mobile Web, I would say </span><span class="line" data-startTime="1342">single page sites are examples of that. Some </span><span class="line" data-startTime="1350">features of single page sites are limited </span><span class="line" data-startTime="1350">zooming so the user gets text that's readable </span><span class="line" data-startTime="1355">immediately, they don't have to pinch zoom </span><span class="line" data-startTime="1355">around. Fixed headers and footers. So content </span><span class="line" data-startTime="1360">that scrolls independently of one another </span><span class="line" data-startTime="1360">or having a header placed that's fixed to </span><span class="line" data-startTime="1366">the viewport as opposed to content, and smooth </span><span class="line" data-startTime="1366">transitions, animations between states as </span><span class="line" data-startTime="1373">well as just loading links. The most basic </span><span class="line" data-startTime="1373">fundament mobile thing to do is the viewport, </span><span class="line" data-startTime="1384">viewport is a virtual viewing area that's </span><span class="line" data-startTime="1384">scaled down to your phones or your mobile </span><span class="line" data-startTime="1389">device's display, and you can configure this </span><span class="line" data-startTime="1389">viewport by setting the metatag called viewport </span><span class="line" data-startTime="1396">inside your head, and by default it's set </span><span class="line" data-startTime="1396">to something ridiculous, like 980 pixels, </span><span class="line" data-startTime="1403">which is wider than most devices. You can </span><span class="line" data-startTime="1403">configure it by setting its width to some </span><span class="line" data-startTime="1410">value, but if you set it to a fixed value, </span><span class="line" data-startTime="1410">say 320 pixels, that won't work on many devices </span><span class="line" data-startTime="1418">that aren't 320 pixels wide and you will have </span><span class="line" data-startTime="1418">the problem of when you switch from landscape </span><span class="line" data-startTime="1424">or from portrait to landscape, text will be </span><span class="line" data-startTime="1424">scaled in interesting ways, so the best practice </span><span class="line" data-startTime="1430">here, at minimum, at minimum, is to set the </span><span class="line" data-startTime="1430">width to be the device width, which evaluates </span><span class="line" data-startTime="1435">to be the current width for your device in </span><span class="line" data-startTime="1435">its current orientation. And you can see without </span><span class="line" data-startTime="1440">a viewport the text is hardly readable on </span><span class="line" data-startTime="1440">the left. With a viewport set as I recommend, </span><span class="line" data-startTime="1448">it's much more readable and everyone is happy. </span></p>

<p><span class="line" data-startTime="1448">We can take this one step further and prevent </span><span class="line" data-startTime="1455">zooming entirely to sort of be closer to the </span><span class="line" data-startTime="1455">user experience of a mobile &mdash; native mobile </span><span class="line" data-startTime="1463">application. We can do this by setting initial </span><span class="line" data-startTime="1463">minimum and maximum scale to 1. Just adding </span><span class="line" data-startTime="1468">that to the viewport, and know that you should </span><span class="line" data-startTime="1468">separate these directives with commas, not </span><span class="line" data-startTime="1473">semi colons, a lot of Web samples on the Web </span><span class="line" data-startTime="1473">use semi colons unfortunately, that is not </span><span class="line" data-startTime="1480">the standard thing to do. Also avoid user </span><span class="line" data-startTime="1480">scalable equals no or supplement it with these </span><span class="line" data-startTime="1486">media queries, or, sorry, these content directives, </span><span class="line" data-startTime="1486">because it's not supported in Chrome &mdash; user </span><span class="line" data-startTime="1493">scalable, no, is not supported in Android </span><span class="line" data-startTime="1493">&mdash; other Android browsers and some other that </span><span class="line" data-startTime="1500">I've tested. So generally speaking, on the </span><span class="line" data-startTime="1500">mobile Web, or on any Web, anywhere, really, </span><span class="line" data-startTime="1509">we want our animations to be smooth, and what </span><span class="line" data-startTime="1509">this means is we want &mdash; we want them to be </span><span class="line" data-startTime="1516">approaching the limits of human perception, </span><span class="line" data-startTime="1516">so 60 frames per second is the animation refresh </span><span class="line" data-startTime="1523">rate above which we can't really tell the </span><span class="line" data-startTime="1523">difference, so on mobile devices, this is </span><span class="line" data-startTime="1530">hard, because we have CPUs that are far less </span><span class="line" data-startTime="1530">powerful than desktops, and because of this </span><span class="line" data-startTime="1535">we want to utilize hardware acceleration as </span><span class="line" data-startTime="1535">much as possible because these devices come </span><span class="line" data-startTime="1539">with pretty powerful CPUs, so an example of </span><span class="line" data-startTime="1539">this, to keep an element fixed in relation </span><span class="line" data-startTime="1547">to scrolling of content, the old style way </span><span class="line" data-startTime="1547">of doing this, you would position something </span><span class="line" data-startTime="1552">absolutely, listen to scroll events and then </span><span class="line" data-startTime="1552">kind of jitter as you try to reposition your </span><span class="line" data-startTime="1558">element every time you scroll. With position </span><span class="line" data-startTime="1558">fixed, what you're essentially saying is you're </span><span class="line" data-startTime="1564">telling your GPU that this is a separate layer </span><span class="line" data-startTime="1564">and composite in a &mdash; composite it separate </span><span class="line" data-startTime="1573">from my CPU, and this is a much more, much </span><span class="line" data-startTime="1573">less janky experience, and much more smooth. </span></p>

<p><span class="line" data-startTime="1582">Similar &mdash; similar tactic applies for scrolling. </span> <span class="line" data-startTime="1582">Often we want sub element scrolling, so an </span><span class="line" data-startTime="1589">example here is Gmail. Or any two pane tablet </span><span class="line" data-startTime="1589">application. So we have a list view and a </span><span class="line" data-startTime="1599">content view on the right, and we can enable </span><span class="line" data-startTime="1599">independent scrolling of elements with overflow </span><span class="line" data-startTime="1605">auto, so this is old news. The new thing here </span><span class="line" data-startTime="1605">is Webkit overflow scrolling. </span> <span class="line" data-startTime="1613">This is a custom Webkit property which works </span><span class="line" data-startTime="1613">on IOS and Chrome for Android and it essentially </span><span class="line" data-startTime="1618">forces hardware accelerated scrolling. Let </span><span class="line" data-startTime="1618">me quickly show you a demo here. So I'll send </span><span class="line" data-startTime="1626">this &mdash; these are beautiful Chrome ponies. </span> <span class="line" data-startTime="1626">Chronies? </span><span class="line" data-startTime="1629">I'm not sure. So I'm going to load this on </span><span class="line" data-startTime="1629">the device. Mobile Web scrolling. I'm going </span><span class="line" data-startTime="1645">to load it on both devices. See which one </span><span class="line" data-startTime="1645">is faster. It's going to be a race. So you </span><span class="line" data-startTime="1660">can watch them race. Anyway, while it's loading, </span><span class="line" data-startTime="1660">the idea here is here with overflow hidden, </span><span class="line" data-startTime="1676">we see we can't scroll this region at all, </span><span class="line" data-startTime="1676">I'm trying to scroll, we can't. Overflow auto </span><span class="line" data-startTime="1682">is scrolling, but with this Webkit overflow </span><span class="line" data-startTime="1682">scrolling touch edition, we get really, really </span><span class="line" data-startTime="1688">fast scrolling on mobile devices, and this </span><span class="line" data-startTime="1688">is what I'm trying to show you with this demo, </span><span class="line" data-startTime="1694">and unfortunately it doesn't seem to want </span><span class="line" data-startTime="1694">to work. That's too bad. Okay, well, hopefully </span><span class="line" data-startTime="1710">it will load eventually. Okay. So scrolling. </span> <span class="line" data-startTime="1710">Often we want to go beyond scrolling and have </span><span class="line" data-startTime="1726">transformations of an arbitrary nature, animations, </span><span class="line" data-startTime="1726">et cetera, and we still want this to be as </span><span class="line" data-startTime="1731">fast as possible. 60 frames a second. A key </span><span class="line" data-startTime="1731">thing here is being able to position elements </span><span class="line" data-startTime="1738">arbitrarily on the screen. You would use position </span><span class="line" data-startTime="1738">absolute to do this, but this isn't slow and </span><span class="line" data-startTime="1744">takes the software path &mdash; or this isn't fast, </span><span class="line" data-startTime="1744">and takes the software path, so the hardware </span><span class="line" data-startTime="1750">accelerated approach, which is very useful </span><span class="line" data-startTime="1750">on mobile, is to use the WebKit transform </span><span class="line" data-startTime="1754">and the WebKit translate &mdash; I'm sorry, WebKit </span><span class="line" data-startTime="1754">transform and translate transformations, this </span><span class="line" data-startTime="1761">will trigger hardware accelerated rendering, </span><span class="line" data-startTime="1761">especially with translate 3D, this gives a </span><span class="line" data-startTime="1768">hint to the GPU that, hey, you're doing something </span><span class="line" data-startTime="1768">fancy and probably GPU mode should be enabled. </span></p>

<p><span class="line" data-startTime="1774">You can of course also do rotations and scales </span><span class="line" data-startTime="1774">in this fashion, and it looks like our demo </span><span class="line" data-startTime="1780">has loaded, which is great, so let me switch </span><span class="line" data-startTime="1780">back to the projector here for both screens. </span> <span class="line" data-startTime="1785">We have our beautiful ponies, as you would </span><span class="line" data-startTime="1785">expect. As I scroll hidden &mdash; attempt to scroll </span><span class="line" data-startTime="1793">the hidden view, nothing works. Auto, you </span><span class="line" data-startTime="1793">can see it's scrolling. But it's kind of janky, </span><span class="line" data-startTime="1799">I don't know if you can notice that on the </span><span class="line" data-startTime="1799">projector. Compare that to this. </span> <span class="line" data-startTime="1806">So this is what you get. </span> <span class="line" data-startTime="1806">[ Laughter ] </span></p>

<p class="speaker"><span class="line" data-starttime="1807"><span class="speakerName">Boris Smus</span>: Thanks, guys, this is what you </span><span class="line" data-startTime="1807">get with the WebKit overflowing scrolling </span><span class="line" data-startTime="1811">touch. So on &mdash; on Chrome for Android, this </span><span class="line" data-startTime="1811">is the &mdash; basically the smoothness that you </span><span class="line" data-startTime="1819">get, on iOS. You end up with &mdash; with bounceback </span><span class="line" data-startTime="1819">effects. And inertial scrolling as well. </span> <span class="line" data-startTime="1827">So we'll do questions after. </span> <span class="line" data-startTime="1827">So as I go into the next section, I'm going </span><span class="line" data-startTime="1835">to preload this. </span> <span class="line" data-startTime="1835">So in addition to regular transforms, we can </span><span class="line" data-startTime="1841">do more advanced things. As I alluded, we </span><span class="line" data-startTime="1841">can do 3D transformations, we can apply perspective </span><span class="line" data-startTime="1847">as well. Even arbitrary matrices, as in this </span><span class="line" data-startTime="1847">example here, if you are into linear algebra. </span> <span class="line" data-startTime="1854">And we can let CSS interpolate between the </span><span class="line" data-startTime="1854">various animation states by using the transition </span><span class="line" data-startTime="1862">property and here we are transitioning between </span><span class="line" data-startTime="1862">&mdash; or say &mdash; sorry, we're transitioning the </span><span class="line" data-startTime="1869">transform property, we're specifying its length </span><span class="line" data-startTime="1869">of time, one second, and an easing function </span><span class="line" data-startTime="1874">as well. So these &mdash; both the transition and </span><span class="line" data-startTime="1874">the transform property need vendor prefixes. </span> <span class="line" data-startTime="1883">So unfortunately the demo here is still loading. </span></p>

<p><span class="line" data-startTime="1883">But ... I'm gonna ... just gonna hope that </span><span class="line" data-startTime="1903">it will load eventually. </span> <span class="line" data-startTime="1903">Okay. We'll get back to that. We'll have reason </span><span class="line" data-startTime="1905">to revisit. </span> <span class="line" data-startTime="1905">So I talked a lot about output here. Let's </span><span class="line" data-startTime="1910">talk about input. So for decades, 20, 30 years, </span><span class="line" data-startTime="1910">more, more than that, this has been the input </span><span class="line" data-startTime="1920">mode of computing. Mouse and keyboard. And </span><span class="line" data-startTime="1920">for quite a long time, even into mobile, we've </span><span class="line" data-startTime="1929">had very similar input devices. This is a </span><span class="line" data-startTime="1929">pretty new Blackberry with keyboard and essentially </span><span class="line" data-startTime="1936">a mouse-like implement. </span> <span class="line" data-startTime="1936">So the current state is much more interesting. </span> <span class="line" data-startTime="1944">Multi-touch pretty much changed the game completely. </span> <span class="line" data-startTime="1944">And one thing that I want to emphasize here </span><span class="line" data-startTime="1949">is touch is not the same as mouse. It's completely </span><span class="line" data-startTime="1949">different. There's no hover state in touch. </span> <span class="line" data-startTime="1956">There are multiple touch points. Input is </span><span class="line" data-startTime="1956">far less precise. You don't get the pixel </span><span class="line" data-startTime="1961">accuracy of a mouse. And going forward, fingers </span><span class="line" data-startTime="1961">aren't just coordinates, but they also have </span><span class="line" data-startTime="1966">shape and in the future we have all sorts </span><span class="line" data-startTime="1966">of interesting possibilities. Pressure input, </span><span class="line" data-startTime="1974">haptic feedback, et cetera. Touch interface, </span><span class="line" data-startTime="1974">as I'm sure you are all familiar with, have </span><span class="line" data-startTime="1980">essential building blocks. These are very </span><span class="line" data-startTime="1980">simple gestures. Well, they range from simple </span><span class="line" data-startTime="1985">ones like tap and double tap to more complex </span><span class="line" data-startTime="1985">one like pinch-zoom and rotation and we can </span><span class="line" data-startTime="1990">do all of these things on the Web using the </span><span class="line" data-startTime="1990">touch events. So here we have touchmove, touchstart </span><span class="line" data-startTime="1998">and touchend. </span></p>

<p><span class="line" data-startTime="1998">These are pretty similar to their mouse equivalents, </span><span class="line" data-startTime="2001">except instead of single coordinates, we have </span><span class="line" data-startTime="2001">lists of touches on the screen. There's a </span><span class="line" data-startTime="2008">spec and you can read more about this. </span> <span class="line" data-startTime="2008">So one of the first things that you'll notice </span><span class="line" data-startTime="2014">is the browser has its own touch behavior. </span> <span class="line" data-startTime="2014">So like I mentioned earlier, pinch-zoom is </span><span class="line" data-startTime="2021">one of them, scrolling is another, tap switching </span><span class="line" data-startTime="2021">as you probably saw in the keynote this morning </span><span class="line" data-startTime="2027">between tabs when you slide out from the side </span><span class="line" data-startTime="2027">of the bevel on some browsers and you can </span><span class="line" data-startTime="2032">override some of these behaviors using the </span><span class="line" data-startTime="2032">event prevent default call in JavaScript. </span> <span class="line" data-startTime="2039">In IE it's a little bit different, you can </span><span class="line" data-startTime="2039">specify touch action none, this is IE 10, </span><span class="line" data-startTime="2045">and you can even specify which specific kinds </span><span class="line" data-startTime="2045">of interactions to disable. So you can say </span><span class="line" data-startTime="2051">enable no touch interactions by default or </span><span class="line" data-startTime="2051">you can say only enable pinch-zooms or only </span><span class="line" data-startTime="2059">enable scrolls. </span> <span class="line" data-startTime="2059">Touch performance is an interesting topic </span><span class="line" data-startTime="2065">because as a Web developer, if you are not </span><span class="line" data-startTime="2065">creating touch specific input, you end up </span><span class="line" data-startTime="2072">having events that are very heavily delayed. </span> <span class="line" data-startTime="2072">The reason for this is, for example, if you </span><span class="line" data-startTime="2077">do a double tap, the browser needs to decide </span><span class="line" data-startTime="2077">if it's a zoom gesture or if it's a click. </span></p>

<p><span class="line" data-startTime="2084">So it waits for 300 milliseconds to wait for </span><span class="line" data-startTime="2084">that second tap and then if there's no other </span><span class="line" data-startTime="2089">tap, it emits a click. </span> <span class="line" data-startTime="2089">So this is not great, 300 milliseconds is </span><span class="line" data-startTime="2093">definitely visible. You can see the delay </span><span class="line" data-startTime="2093">and the &mdash; the workaround for this is to use </span><span class="line" data-startTime="2099">touchend. Touchend will fire right away. As </span><span class="line" data-startTime="2099">soon as you release your finger from the screen </span><span class="line" data-startTime="2105">and there's a nice guide about this on Google </span><span class="line" data-startTime="2105">developer docs. </span> <span class="line" data-startTime="2110">The other consideration here is with multi-touch, </span><span class="line" data-startTime="2110">events often come in very quickly, much faster </span><span class="line" data-startTime="2118">than 60 frames per second. If you are touching </span><span class="line" data-startTime="2118">your screen with many fingers, every single </span><span class="line" data-startTime="2124">finger will fire at whatever that rate is. </span> <span class="line" data-startTime="2124">And if you draw, as soon as you handle the </span><span class="line" data-startTime="2129">event, you will end up just having too many </span><span class="line" data-startTime="2129">things rendering at the same time and this </span><span class="line" data-startTime="2136">will be very bad for your performance. </span></p>

<p><span class="line" data-startTime="2136">So the solution for this is to create separate </span><span class="line" data-startTime="2144">handlers for input handling and create a separate </span><span class="line" data-startTime="2144">animation thread. Or animation timer in this </span><span class="line" data-startTime="2151">case. </span> <span class="line" data-startTime="2151">So here I'm doing exactly that. I've got a </span><span class="line" data-startTime="2154">set interval call and the touch rendering </span><span class="line" data-startTime="2154">code goes here. We can do even better in Chrome </span><span class="line" data-startTime="2161">for Android and Chrome and Safari and probably </span><span class="line" data-startTime="2161">other browsers, we just requestAnimationFrame. </span> <span class="line" data-startTime="2169">What this does is it's essentially a polite </span><span class="line" data-startTime="2169">request to the browser for animation frame </span><span class="line" data-startTime="2175">so it aims to &mdash; to fire roughly 60 to &mdash; 60 </span><span class="line" data-startTime="2175">times a second. But if something is overloading </span><span class="line" data-startTime="2184">the &mdash; the machine or the device, then it </span><span class="line" data-startTime="2184">scales back in an elegant way and you can </span><span class="line" data-startTime="2190">get as smooth of an animation as you possible </span><span class="line" data-startTime="2190">can. </span> <span class="line" data-startTime="2195">So with this, let me show you an example of </span><span class="line" data-startTime="2195">that. </span></p>

<p><span class="line" data-startTime="2200">Style switch over. The demo is already loaded. </span> <span class="line" data-startTime="2200">That's awesome! </span><span class="line" data-startTime="2206">So for this particular demo, I'm using a requestAnimationFrame </span><span class="line" data-startTime="2206">and the transitions and transforms that I </span><span class="line" data-startTime="2211">talked about earlier, to have this pretty </span><span class="line" data-startTime="2211">smooth transition experience between multiple </span><span class="line" data-startTime="2220">screens. So you can see it follows my finger </span><span class="line" data-startTime="2220">pretty closely. And when I let go, the transition </span><span class="line" data-startTime="2226">will fire. And the content just shows up. </span> <span class="line" data-startTime="2226">So this is using requestAnimationFrame WebKit </span><span class="line" data-startTime="2234">transforms and transitions. </span> <span class="line" data-startTime="2234">I also have another demo that I'm going to </span><span class="line" data-startTime="2240">start loading now. </span> <span class="line" data-startTime="2240">And I'll get to that in a second as soon as </span><span class="line" data-startTime="2252">it loads. </span> <span class="line" data-startTime="2252">So let's talk about some of the problems with </span><span class="line" data-startTime="2257">&mdash; with touch input. </span> <span class="line" data-startTime="2257">The first is how do we handle both gracefully? </span><span class="line" data-startTime="2264">Right? What if we want to support both? </span><span class="line" data-startTime="2264">This right now is not very pleasant. So what </span><span class="line" data-startTime="2271">we end up with is two essentially completely </span><span class="line" data-startTime="2271">different input methods. Mouse and touch. </span> <span class="line" data-startTime="2278">And what we might do is we can extract the </span><span class="line" data-startTime="2278">positions of the relevant input. And then </span><span class="line" data-startTime="2284">just relay them to a common handler. This </span><span class="line" data-startTime="2284">&mdash; eh ... it's unnecessary boilerplate. It's </span><span class="line" data-startTime="2290">not something that you want to do every single </span><span class="line" data-startTime="2290">time. So instead &mdash; well, we'll talk about </span><span class="line" data-startTime="2296">solutions to this in a second. </span></p>

<p><span class="line" data-startTime="2296">The other problem before I talk about solutions, </span><span class="line" data-startTime="2301">is gestures are difficult. You saw that list </span><span class="line" data-startTime="2301">of gestures that I showed you that are common </span><span class="line" data-startTime="2305">for mobile devices, but doing such a thing </span><span class="line" data-startTime="2305">without gesture events, which are only available </span><span class="line" data-startTime="2312">on iOS, is pretty hard. So here's a pinch-zoom </span><span class="line" data-startTime="2312">snippet that recognizes the pinch-zoom gesture. </span> <span class="line" data-startTime="2320">It's a lot of code. And doing this every time </span><span class="line" data-startTime="2320">you want to pinch-zoom just is not reasonable. </span> <span class="line" data-startTime="2328">So Microsoft has a &mdash; has an input model that </span><span class="line" data-startTime="2328">they're planning on using for metro. It's </span><span class="line" data-startTime="2339">called MSPointer. And the idea is to consolidate </span><span class="line" data-startTime="2339">input, to consolidate mouse, touch and pointer </span><span class="line" data-startTime="2346">into one single type. </span> <span class="line" data-startTime="2346">And, of course, you can still distinguish </span><span class="line" data-startTime="2351">between mouse and touch with &mdash; with an event </span><span class="line" data-startTime="2351">property and it's a really nice idea. I like </span><span class="line" data-startTime="2358">it a lot. </span> <span class="line" data-startTime="2358">The problem is, with the current proposal, </span><span class="line" data-startTime="2362">it's essentially just another input mechanism </span><span class="line" data-startTime="2362">to deal with. So now you have the mouse handler, </span><span class="line" data-startTime="2366">the touch handler and the MSPointer handler </span><span class="line" data-startTime="2366">and it's just not necessarily great. </span> <span class="line" data-startTime="2373">So pointer.js is a project that I worked on </span><span class="line" data-startTime="2373">to try to consolidate this input problem between </span><span class="line" data-startTime="2379">browsers. Using a similar idea as MSPointer </span><span class="line" data-startTime="2379">events except to take all of these different </span><span class="line" data-startTime="2385">event models and make an abstraction layer </span><span class="line" data-startTime="2385">around them to make it really easy for developers. </span></p>

<p><span class="line" data-startTime="2392">So let me show you this in action. </span> <span class="line" data-startTime="2392">And here I have a &mdash; a space shooter. And </span><span class="line" data-startTime="2400">actually let me show you this on the device </span><span class="line" data-startTime="2400">instead. So this is a &mdash; this is a demo that </span><span class="line" data-startTime="2407">was created by a friend of mine called Seb </span><span class="line" data-startTime="2407">and you can see it's essentially just a &mdash; a </span><span class="line" data-startTime="2413">space shooter thing demo. It's kind of neat </span><span class="line" data-startTime="2413">because you can place your control anywhere </span><span class="line" data-startTime="2418">you want and then just shoot on the &mdash; anywhere </span><span class="line" data-startTime="2418">on the right side of the screen. </span> <span class="line" data-startTime="2423">So this is using pointerevents. One of the </span><span class="line" data-startTime="2423">benefits of this, it was initially using just </span><span class="line" data-startTime="2430">touchevents. So on the desktop nothing would </span><span class="line" data-startTime="2430">work at all. With pointerevents, though, I </span><span class="line" data-startTime="2437">can have essentially the same experience in </span><span class="line" data-startTime="2437">&mdash; on both mouse and touch input. So this </span><span class="line" data-startTime="2445">is a quick and straightforward pointer example. </span> <span class="line" data-startTime="2445">Pointer.js also aspires to have gesture recognizers </span><span class="line" data-startTime="2456">on top of the consolidated input model. For </span><span class="line" data-startTime="2456">more details about this, check out the project </span><span class="line" data-startTime="2460">page on GitHub. </span></p>

<p><span class="line" data-startTime="2460">So let me quickly talk about mobile Web development. </span> <span class="line" data-startTime="2474">One second. </span> <span class="line" data-startTime="2474">So I've been trying to show you some features </span><span class="line" data-startTime="2484">of the Chrome developer tools as we go. And, </span><span class="line" data-startTime="2484">of course, the easiest path to getting started </span><span class="line" data-startTime="2492">with mobile development is to emulate it on </span><span class="line" data-startTime="2492">the desktop. You don't have to deal with extra </span><span class="line" data-startTime="2496">devices. You don't have any of that headache </span><span class="line" data-startTime="2496">of trying to &mdash; having to touch around all </span><span class="line" data-startTime="2502">of the time. So it's nice. And I have shown </span><span class="line" data-startTime="2502">you how to emulate screen size, how to override </span><span class="line" data-startTime="2509">the User-Agent string and let me just show </span><span class="line" data-startTime="2509">you one more thing ... </span> <span class="line" data-startTime="2509">this is part of the mobile Chrome experiments </span><span class="line" data-startTime="2523">that you may or may not have seen. If you </span><span class="line" data-startTime="2523">haven't seen it, check it out, it's on the </span><span class="line" data-startTime="2528">second floor in the Chrome booth. So this </span><span class="line" data-startTime="2528">is a Chrome experiment. And it's essentially </span><span class="line" data-startTime="2532">a scroll view. With a twist. </span> <span class="line" data-startTime="2532">So to show you the twist, I have to scroll, </span><span class="line" data-startTime="2538">but you'll notice here that it's using touchevents. </span> <span class="line" data-startTime="2538">And when I try to scroll, nothing works. So </span><span class="line" data-startTime="2545">let me open up devtools. </span> <span class="line" data-startTime="2545">And show you a cool feature that's very useful. </span></p>

<p><span class="line" data-startTime="2553">I can emulate touchevents. So what this will </span><span class="line" data-startTime="2553">do, when I reload the page, and switch back </span><span class="line" data-startTime="2561">to it, now when I mouse around these mouse </span><span class="line" data-startTime="2561">events are being translated into touches, </span><span class="line" data-startTime="2568">so instead of a mouse down I get a touch start, </span><span class="line" data-startTime="2568">et cetera. You can see this is using again </span><span class="line" data-startTime="2573">requestAnimationFrame and Hakim here has a </span><span class="line" data-startTime="2573">whole bunch of cool effects to just give you </span><span class="line" data-startTime="2580">a sense of how performant you can have these </span><span class="line" data-startTime="2580">nice transitions. On both Chrome and &mdash; it </span><span class="line" data-startTime="2586">works just great on Chrome for Android as </span><span class="line" data-startTime="2586">well. You should check it out in the Chrome </span><span class="line" data-startTime="2593">experiments booth. </span> <span class="line" data-startTime="2593">So that's &mdash; that's some Chrome devtools features. </span> <span class="line" data-startTime="2599">You can also emulate multi-touch events on </span><span class="line" data-startTime="2599">the Mac. And this is a fun little project </span><span class="line" data-startTime="2606">that I worked on. It requires a bit of setup. </span> <span class="line" data-startTime="2606">But once you've got it set up, then you can </span><span class="line" data-startTime="2616">&mdash; you can essentially create multi-touch </span><span class="line" data-startTime="2616">prototyping, you can do multi-touch prototyping </span><span class="line" data-startTime="2623">on any Mac with a magic touch track pad. So </span><span class="line" data-startTime="2623">here you can see I've got a single touch that's </span><span class="line" data-startTime="2629">coming from my Mac track pad and I can do </span><span class="line" data-startTime="2629">multiple touches, too. </span></p>

<p><span class="line" data-startTime="2635">And I can do this arbitrarily. So it's kind </span><span class="line" data-startTime="2635">of cool if you're doing complex multi-touch </span><span class="line" data-startTime="2640">interactions. This game is just like a fruit </span><span class="line" data-startTime="2640">ninja clone that I whipped up, except with </span><span class="line" data-startTime="2643">browsers. It doesn't really make sense. You </span><span class="line" data-startTime="2643">hit a blink tag and you get a 406. [Laughter </span><span class="line" data-startTime="2650">] </span></p>

<p class="speaker"><span class="line" data-starttime="2650"><span class="speakerName">Boris Smus</span>: Right? Anyway, so that's multi-touch. </span><span class="line" data-startTime="2654">And, of course, you want to test on your device, </span><span class="line" data-startTime="2654">ultimately. You can do these emulations, you </span><span class="line" data-startTime="2661">can use these tricks, but ultimately you need </span><span class="line" data-startTime="2661">to test on your device. And Chrome for Android </span><span class="line" data-startTime="2665">has great support for remote debugging, and </span><span class="line" data-startTime="2665">we have plenty of resources about that. In </span><span class="line" data-startTime="2671">the interest of time I won't burden you, but </span><span class="line" data-startTime="2671">you should check it out. And I will make these </span><span class="line" data-startTime="2674">slides available afterward. </span><span class="line" data-startTime="2674">So thank you all for listening. We've got </span><span class="line" data-startTime="2681">some time for questions. </span><span class="line" data-startTime="2681">And, um ... so, yeah, right, we have microphones </span><span class="line" data-startTime="2687">on both sides. So feel free to ask anything </span><span class="line" data-startTime="2687">and I'll be available in the Chrome area as </span><span class="line" data-startTime="2692">well afterward. </span><span class="line" data-startTime="2692">[ Applause ] </span></p>

<p class="speaker"><span class="line" data-starttime="2701"><span class="speakerName">Audience member</span>: You &mdash; I guess the mic is off. There we </span><span class="line" data-startTime="2701">go. </span></p>

<p class="speaker"><span class="line" data-starttime="2706"><span class="speakerName">Boris Smus</span>: I think it's on. </span></p>

<p class="speaker"><span class="line" data-starttime="2706"><span class="speakerName">Audience member</span>: You showed examples of how to get the </span><span class="line" data-startTime="2709">GPU hardware acceleration enabled. Why don't </span><span class="line" data-startTime="2709">those turn on by defaults? Why do you have </span><span class="line" data-startTime="2715">to play tricks to get it to work reasonably? </span></p>

<p class="speaker"><span class="line" data-starttime="2715"><span class="speakerName">Boris Smus</span>: Right, this is &mdash; I agree &mdash; a </span><span class="line" data-startTime="2723">problem that we are tackling currently. So </span><span class="line" data-startTime="2723">the Chrome GPU team is working very hard to </span><span class="line" data-startTime="2730">try to make these &mdash; to try to make more of </span><span class="line" data-startTime="2730">the rendering part of the GPU pipeline, essentially. </span><span class="line" data-startTime="2736">So like you are saying, part of the problem </span><span class="line" data-startTime="2736">is you don't really know which tricks will </span><span class="line" data-startTime="2741">render GPU mode, which ones won't, it's very </span><span class="line" data-startTime="2741">implicit. And generally, of course, the whole </span><span class="line" data-startTime="2747">rendering path should be done on the GPU as </span><span class="line" data-startTime="2747">much as possible. So GPU team is definitely </span><span class="line" data-startTime="2751">looking at this and trying to optimize it </span><span class="line" data-startTime="2751">as much as possible. It's on my radar. </span></p>

<p class="speaker"><span class="line" data-starttime="2755"><span class="speakerName">Audience member</span>: All right. </span></p>

<p class="speaker"><span class="line" data-starttime="2755"><span class="speakerName">Boris Smus</span>: Yes, go ahead. </span></p>

<p class="speaker"><span class="line" data-starttime="2761"><span class="speakerName">Audience member</span>: If you are trying to emulate more of a </span><span class="line" data-startTime="2761">mobile native experience, the address bar </span><span class="line" data-startTime="2768">gets in the way or &mdash; and is there anything </span><span class="line" data-startTime="2768">more elegant than just scroll one pixel when </span><span class="line" data-startTime="2773">your app starts up? </span></p>

<p class="speaker"><span class="line" data-starttime="2773"><span class="speakerName">Boris Smus</span>: Um, yeah. So &mdash; right, as you </span><span class="line" data-startTime="2777">are saying, the current hacks are around using </span><span class="line" data-startTime="2777">Scroll 2, which is a JavaScript function that </span><span class="line" data-startTime="2783">you just call and say scroll to the top and </span><span class="line" data-startTime="2783">in most browsers, in some browsers, it will </span><span class="line" data-startTime="2788">hide the location bar. We're working on evaluating </span><span class="line" data-startTime="2788">what a full screen API might look like. So </span><span class="line" data-startTime="2796">this is an example of there's an open Web </span><span class="line" data-startTime="2796">API that lets you make a browser go into full-screen </span><span class="line" data-startTime="2802">mode. So this would be a nice application. </span> <span class="line" data-startTime="2802">That said, right now in Chrome for Android, </span><span class="line" data-startTime="2807">we have an Omnibox that's always there. There's </span><span class="line" data-startTime="2807">good reasons for that as well. Just if you </span><span class="line" data-startTime="2814">have your URL bar always present, it's an </span><span class="line" data-startTime="2814">indication that you are in the browser, you </span><span class="line" data-startTime="2820">are not being phished, you know exactly where </span><span class="line" data-startTime="2820">you are, and it's also very easy to navigate </span><span class="line" data-startTime="2825">away, like, to any other page. </span> <span class="line" data-startTime="2825">Oftentimes on iOS I'll have hard time getting </span><span class="line" data-startTime="2831">back to the URL bar, especially if someone </span><span class="line" data-startTime="2831">is overriding the default scrolling behavior. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2838"><span class="speakerName">Audience member</span>: I see. </span></p>

<p class="speaker"><span class="line" data-starttime="2838"><span class="speakerName">Boris Smus</span>: It's hard to get back. So ... but, </span><span class="line" data-startTime="2841">yeah, I agree, it's totally a hack. </span></p>

<p class="speaker"><span class="line" data-starttime="2841"><span class="speakerName">Audience member</span>: Should be a new GitHub project for you. </span><span class="line" data-startTime="2846">Fullscreen.js &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="2846"><span class="speakerName">Boris Smus</span>: Thanks. Yes? </span></p>

<p class="speaker"><span class="line" data-starttime="2850"><span class="speakerName">Audience member</span>: I was just wondering, you were always </span><span class="line" data-startTime="2850">saying it's important on iOS and on Chrome </span><span class="line" data-startTime="2854">for Android. What about stock browser that </span><span class="line" data-startTime="2854">gets shipped? </span></p>

<p class="speaker"><span class="line" data-starttime="2858"><span class="speakerName">Boris Smus</span>: Right. So the stock browser </span><span class="line" data-startTime="2858">on Ice Cream Sandwich is actually quite good. </span><span class="line" data-startTime="2864">And there's a lot of &mdash; there are many features </span><span class="line" data-startTime="2864">that are supported on it that I discussed </span><span class="line" data-startTime="2871">today. Don't quote me, I believe requestAnimationFrame </span><span class="line" data-startTime="2871">maybe. Anyway the inertial scrolling certainly </span><span class="line" data-startTime="2879">is. </span><span class="line" data-startTime="2879">So &mdash; yeah. Thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="2883"><span class="speakerName">Audience member</span>: I was curious. So we provide a third-party </span><span class="line" data-startTime="2883">widget that you can embed on your page. So </span><span class="line" data-startTime="2892">we don't have control over things like the </span><span class="line" data-startTime="2892">meta tags, some of the stuff that you showed. </span><span class="line" data-startTime="2899">I'm kind of curious, we were thinking of using </span><span class="line" data-startTime="2899">the new implementation of position fixed to </span><span class="line" data-startTime="2902">allow our chat box to show up. </span></p>

<p class="speaker"><span class="line" data-starttime="2902"><span class="speakerName">Boris Smus</span>: Yep. </span></p>

<p class="speaker"><span class="line" data-starttime="2906"><span class="speakerName">Audience member</span>: But you don't get kind of zoom fixed on </span><span class="line" data-startTime="2906">it. So when you zoom in, then like eventually </span><span class="line" data-startTime="2910">this position fix thing just takes over the </span><span class="line" data-startTime="2910">whole screen. </span></p>

<p class="speaker"><span class="line" data-starttime="2914"><span class="speakerName">Boris Smus</span>: Yep. </span></p>

<p class="speaker"><span class="line" data-starttime="2914"><span class="speakerName">Audience member</span>: Anything new that we could take advantage </span><span class="line" data-startTime="2918">of? </span></p>

<p class="speaker"><span class="line" data-starttime="2918"><span class="speakerName">Boris Smus</span>: Yeah, it's a good question. </span><span class="line" data-startTime="2921">Position fixed is a little interesting if </span><span class="line" data-startTime="2921">you don't have control over the fixed viewport. </span><span class="line" data-startTime="2927">Because it &mdash; it actually varies quite a bit </span><span class="line" data-startTime="2927">in its behavior depending on the browser. </span><span class="line" data-startTime="2931">So, yeah, I think you have a pretty unique </span><span class="line" data-startTime="2931">case in that you're like a third period JavaScript </span><span class="line" data-startTime="2938">plug-in. I can't think of anything off the </span><span class="line" data-startTime="2938">top of my head that you could do that with. </span><span class="line" data-startTime="2943">Maybe we should talk offline. </span></p>

<p class="speaker"><span class="line" data-starttime="2943"><span class="speakerName">Audience member</span>: Sure thing. </span></p>

<p class="speaker"><span class="line" data-starttime="2947"><span class="speakerName">Boris Smus</span>: Great, thanks. All right? No </span><span class="line" data-startTime="2947">other questions? Find me later, I'll be hanging </span><span class="line" data-startTime="2953">out in the Chrome booth. </span></p></div>