<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Google I/O 2013 &mdash; True Grit: Debugging CSS & Render Performance</h1>

<h2>Chelsea Derrick</h2>

<a class="video" href="http://youtu.be/gqc88qWuiI4">youtu.be/gqc88qWuiI4</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="1"><span class="speakerName">Chelsea Derrick</span>: Hi, everyone. </span> <span class="line" data-startTime="2">Welcome to True Grit, Debugging </span><span class="line" data-startTime="2">CSS and Render </span><span class="line" data-startTime="5">Performance. </span> <span class="line" data-startTime="6">My name is Chelsea Derrick and </span><span class="line" data-startTime="6">I'm a Software Engineer at </span><span class="line" data-startTime="9">Google on the Gmail Team. </span> <span class="line" data-startTime="13">I'm going to kick </span><span class="line" data-startTime="13">us off with an </span><span class="line" data-startTime="14">incredibly provocative statement. </span> <span class="line" data-startTime="16">Fast is better than flow. </span> <span class="line" data-startTime="18">This is actually a part of </span><span class="line" data-startTime="18">Google's 10 Things, which is </span><span class="line" data-startTime="22">our corporate philosophy. </span> <span class="line" data-startTime="24">And it's Number Three on that </span><span class="line" data-startTime="24">list, and we put it there </span><span class="line" data-startTime="27">explicitly because we don't </span><span class="line" data-startTime="27">get speed for free. </span> <span class="line" data-startTime="30">We have to spend a lot of blood, </span><span class="line" data-startTime="30">sweat, and tears to get </span><span class="line" data-startTime="33">our apps to go quickly. </span> <span class="line" data-startTime="35">And when we're talking about </span><span class="line" data-startTime="35">web applications in </span><span class="line" data-startTime="37">particular, there's just a </span><span class="line" data-startTime="37">lot of room to optimize. </span> <span class="line" data-startTime="41">We start out trying to minimize </span><span class="line" data-startTime="41">the number of </span><span class="line" data-startTime="44">redirects, get the user to the </span><span class="line" data-startTime="44">landing page immediately, make </span><span class="line" data-startTime="48">sure that when they log in, </span><span class="line" data-startTime="48">it's a quick and easy </span><span class="line" data-startTime="50">experience. </span> <span class="line" data-startTime="52">Then &mdash; </span><span class="line" data-startTime="52">this is near and dear to my </span><span class="line" data-startTime="52">heart on the Gmail team &mdash; </span><span class="line" data-startTime="55">any sort of data look we have </span><span class="line" data-startTime="55">to do on the back end, get </span><span class="line" data-startTime="58">emails, get docs, get posts, </span><span class="line" data-startTime="58">anything like that. </span></p>

<p><span class="line" data-startTime="62">Network delay. </span> <span class="line" data-startTime="63">I've often suggested that Google </span><span class="line" data-startTime="63">take some of that money </span><span class="line" data-startTime="66">out of the bank and just move </span><span class="line" data-startTime="66">all of our users a little </span><span class="line" data-startTime="68">closer to the data center. </span> <span class="line" data-startTime="71">Not generally something that we </span><span class="line" data-startTime="71">can do, however, we can try </span><span class="line" data-startTime="74">to reduce the number of bytes </span><span class="line" data-startTime="74">we send across the wire. </span> <span class="line" data-startTime="76">That'll speed up our </span><span class="line" data-startTime="76">page a little bit. </span> <span class="line" data-startTime="79">And then as we're getting </span><span class="line" data-startTime="79">closer and closer to the </span><span class="line" data-startTime="81">client, we start worrying about </span><span class="line" data-startTime="81">things like JavaScript </span><span class="line" data-startTime="84">execution, and finally, </span><span class="line" data-startTime="84">rendering. </span> <span class="line" data-startTime="87">This is what we're here </span><span class="line" data-startTime="87">to talk about today. </span> <span class="line" data-startTime="90">And in particular, especially </span><span class="line" data-startTime="90">given that I work on a product </span><span class="line" data-startTime="94">where sometimes, it takes five, </span><span class="line" data-startTime="94">ten seconds for an email </span><span class="line" data-startTime="97">to load, it can be very tempting </span><span class="line" data-startTime="97">to spend all of our </span><span class="line" data-startTime="100">time worrying about </span><span class="line" data-startTime="100">back end latency. </span> <span class="line" data-startTime="104">However, that just isn't </span><span class="line" data-startTime="104">quite good enough. </span></p>

<p><span class="line" data-startTime="107">So even though we're </span><span class="line" data-startTime="107">talking about much </span><span class="line" data-startTime="110">smaller periods of time &mdash; </span><span class="line" data-startTime="112">often milliseconds when we're </span><span class="line" data-startTime="112">talking about rendering &mdash; </span><span class="line" data-startTime="115">we can't look at that as just </span><span class="line" data-startTime="115">a drop in the bucket. </span> <span class="line" data-startTime="118">That time is really, really </span><span class="line" data-startTime="118">important to our users. </span> <span class="line" data-startTime="123">So in particular, I've got a </span><span class="line" data-startTime="123">quick little demo here for you </span><span class="line" data-startTime="127">guys to show exactly </span><span class="line" data-startTime="127">how important it is </span><span class="line" data-startTime="129">to have fast rendering. </span> <span class="line" data-startTime="132">So I've got the slow version </span><span class="line" data-startTime="132">of this turned on. </span> <span class="line" data-startTime="136">Unfortunately, apps don't </span><span class="line" data-startTime="136">come with these links. </span> <span class="line" data-startTime="138">But you can see that </span><span class="line" data-startTime="138">my scrolling here </span><span class="line" data-startTime="140">is incredibly choppy. </span> <span class="line" data-startTime="142">I put an empty for loop in here </span><span class="line" data-startTime="142">to demonstrate my point, </span><span class="line" data-startTime="146">but there are few things on </span><span class="line" data-startTime="146">this earth that are more </span><span class="line" data-startTime="148">irritating than choppy </span><span class="line" data-startTime="148">scrolling, right? </span><span class="line" data-startTime="151">If we were to compare that, for </span><span class="line" data-startTime="151">example, to a nice, smooth </span><span class="line" data-startTime="154">scrolling, the user's going to </span><span class="line" data-startTime="154">get a much better experience. </span></p>

<p><span class="line" data-startTime="157">So again, we're only talking </span><span class="line" data-startTime="157">about a delay of a few </span><span class="line" data-startTime="159">milliseconds sometimes, but </span><span class="line" data-startTime="159">it really does have a very </span><span class="line" data-startTime="162">profound impact on our </span><span class="line" data-startTime="162">user's experiences. </span> <span class="line" data-startTime="166">So part of that is going to be </span><span class="line" data-startTime="166">freeing up the UI thread. </span> <span class="line" data-startTime="170">Browser UIs you run in a single </span><span class="line" data-startTime="170">thread, so we have to </span><span class="line" data-startTime="173">share that between rendering </span><span class="line" data-startTime="173">and JavaScript. </span> <span class="line" data-startTime="176">But just making sure we've got </span><span class="line" data-startTime="176">really efficient, performant </span><span class="line" data-startTime="180">JavaScript is not enough. </span> <span class="line" data-startTime="182">So I'm going to take us a level </span><span class="line" data-startTime="182">past that, assume that </span><span class="line" data-startTime="184">we've already made that </span><span class="line" data-startTime="184">optimization. </span> <span class="line" data-startTime="186">What can we do to make </span><span class="line" data-startTime="186">our pages quick? </span><span class="line" data-startTime="192">So traditionally, the way that </span><span class="line" data-startTime="192">I've done this in the past, I </span><span class="line" data-startTime="197">will start commenting out </span><span class="line" data-startTime="197">sections of JavaScript and see </span><span class="line" data-startTime="200">which one I add back </span><span class="line" data-startTime="200">in makes it faster. </span> <span class="line" data-startTime="202">This is irritating, even more </span><span class="line" data-startTime="202">irritating when you have to do </span><span class="line" data-startTime="205">this with your CSS. </span></p>

<p><span class="line" data-startTime="207">Is it the box shadow that's </span><span class="line" data-startTime="207">slowing me down? </span><span class="line" data-startTime="209">Is it the rounded corners? </span><span class="line" data-startTime="211">This is not the best way </span><span class="line" data-startTime="211">to approach things. </span> <span class="line" data-startTime="213">It can get pretty irritating. </span> <span class="line" data-startTime="216">Fortunately, there are a number </span><span class="line" data-startTime="216">of tools available, </span><span class="line" data-startTime="218">particularly in Chrome today. </span> <span class="line" data-startTime="221">So I'm going to talk a little </span><span class="line" data-startTime="221">bit about some Chrome Dev </span><span class="line" data-startTime="223">Tools today. </span> <span class="line" data-startTime="225">In particular, there are various </span><span class="line" data-startTime="225">profilers available </span><span class="line" data-startTime="227">for JavaScript and for CSS. </span> <span class="line" data-startTime="230">And the one that I'm really </span><span class="line" data-startTime="230">going to focus on today is the </span><span class="line" data-startTime="232">Chrome Timeline. </span> <span class="line" data-startTime="233">This is a quick little </span><span class="line" data-startTime="233">screenshot, and we can </span><span class="line" data-startTime="237">basically tell the browser to </span><span class="line" data-startTime="237">start recording what we do, </span><span class="line" data-startTime="241">and it will give us information </span><span class="line" data-startTime="241">about where its </span><span class="line" data-startTime="243">time is being spent. </span> <span class="line" data-startTime="245">And in particular, we're going </span><span class="line" data-startTime="245">to worry about the things that </span><span class="line" data-startTime="247">are associated with </span><span class="line" data-startTime="247">rendering today. </span> <span class="line" data-startTime="251">So there are going to be a few </span><span class="line" data-startTime="251">different annotations we'll </span><span class="line" data-startTime="253">see in the Timeline that </span><span class="line" data-startTime="253">indicate a problem with our </span><span class="line" data-startTime="255">rendering pipeline. </span></p>

<p><span class="line" data-startTime="257">The first one will be </span><span class="line" data-startTime="257">Style Recalculation. </span> <span class="line" data-startTime="260">We'll talk a bit about what each </span><span class="line" data-startTime="260">of these mean shortly. </span> <span class="line" data-startTime="264">Layout, I'm sure we're all </span><span class="line" data-startTime="264">familiar with that one. </span> <span class="line" data-startTime="266">Avoid Layouts. </span> <span class="line" data-startTime="268">And lastly, Painting. </span> <span class="line" data-startTime="270">So I do want to show really </span><span class="line" data-startTime="270">quickly what this would look </span><span class="line" data-startTime="273">like, and I'll zoom in a bit so </span><span class="line" data-startTime="273">that hopefully those of you </span><span class="line" data-startTime="276">in the back can see. </span> <span class="line" data-startTime="278">Here we've got the Chrome </span><span class="line" data-startTime="278">Timeline, and I'm just going </span><span class="line" data-startTime="281">to go ahead and record </span><span class="line" data-startTime="281">what happens when </span><span class="line" data-startTime="283">I click this button. </span> <span class="line" data-startTime="285">It's going to add a little bit </span><span class="line" data-startTime="285">of margin on there, so we'll </span><span class="line" data-startTime="286">see all of these things occur. </span> <span class="line" data-startTime="289">So I'm going to go ahead and hit </span><span class="line" data-startTime="289">Record, and then I'll head </span><span class="line" data-startTime="291">up here, click on the button, </span><span class="line" data-startTime="291">and then stop recording. </span> <span class="line" data-startTime="295">So Chrome has given us </span><span class="line" data-startTime="295">a few little frames </span><span class="line" data-startTime="298">that we can look at. </span></p>

<p><span class="line" data-startTime="299">Let's see here. </span> <span class="line" data-startTime="301">And in particular, we see </span><span class="line" data-startTime="301">all of these steps. </span> <span class="line" data-startTime="303">We see a style recalculation </span><span class="line" data-startTime="303">occurring. </span> <span class="line" data-startTime="307">And if I zoom back a little bit </span><span class="line" data-startTime="308">further, we'll see a layout &mdash; </span><span class="line" data-startTime="311">apologies &mdash; </span><span class="line" data-startTime="312">a layout right here. </span> <span class="line" data-startTime="314">We notice that the whole </span><span class="line" data-startTime="314">screen turns blue. </span> <span class="line" data-startTime="316">This is the browser telling us </span><span class="line" data-startTime="316">Layouts are the worst thing </span><span class="line" data-startTime="318">that has ever happened. </span> <span class="line" data-startTime="320">And then there's a series of </span><span class="line" data-startTime="320">paints, and actually if I </span><span class="line" data-startTime="322">hover over those, Chrome is </span><span class="line" data-startTime="322">going to show me exactly how </span><span class="line" data-startTime="325">big of a rectangle </span><span class="line" data-startTime="325">got painted. </span> <span class="line" data-startTime="328">These are just the hovers on </span><span class="line" data-startTime="328">the button, but when I </span><span class="line" data-startTime="331">actually added the margin, it </span><span class="line" data-startTime="331">affected everything below it </span><span class="line" data-startTime="334">on the page as well because </span><span class="line" data-startTime="334">margin is part of the box </span><span class="line" data-startTime="336">model, so it pushed </span><span class="line" data-startTime="336">other things down. </span> <span class="line" data-startTime="340">So that's just a quick look at </span><span class="line" data-startTime="340">the tool itself, which is </span><span class="line" data-startTime="344">really helpful, but even more </span><span class="line" data-startTime="344">useful is knowing exactly what </span><span class="line" data-startTime="349">causes periods of time </span><span class="line" data-startTime="349">to be spent in </span><span class="line" data-startTime="351">those different phases. </span> <span class="line" data-startTime="353">So what I'd like to spend the </span><span class="line" data-startTime="353">majority of this talk doing is </span><span class="line" data-startTime="357">explaining a little bit about </span><span class="line" data-startTime="357">the rendering cycle. </span></p>

<p><span class="line" data-startTime="360">So we have information about </span><span class="line" data-startTime="360">the Timeline, but we don't </span><span class="line" data-startTime="363">really have any information </span><span class="line" data-startTime="363">about what caused particular </span><span class="line" data-startTime="366">chunks of time to go missing. </span> <span class="line" data-startTime="368">And so by understanding a </span><span class="line" data-startTime="368">little bit about how the </span><span class="line" data-startTime="370">rendering cycle is implemented </span><span class="line" data-startTime="370">in browsers, we can have a </span><span class="line" data-startTime="373">more clear understanding of </span><span class="line" data-startTime="373">maybe what caused a layout or </span><span class="line" data-startTime="376">what caused a paint to occur. </span> <span class="line" data-startTime="382">So first of all, any edit that </span><span class="line" data-startTime="382">we make to the document is </span><span class="line" data-startTime="386">going to cause the rendering </span><span class="line" data-startTime="386">cycle to be entered, and here </span><span class="line" data-startTime="390">are the steps that we're going </span><span class="line" data-startTime="390">to be working with &mdash; </span><span class="line" data-startTime="392">updating the DOM itself, </span><span class="line" data-startTime="392">calculating CSS property </span><span class="line" data-startTime="396">values, building the rendering </span><span class="line" data-startTime="396">tree, and then using that to </span><span class="line" data-startTime="401">perform layout calculations. </span> <span class="line" data-startTime="403">And then there are two more </span><span class="line" data-startTime="403">steps at the end, which are </span><span class="line" data-startTime="406">paint and compositing. </span> <span class="line" data-startTime="408">So let's look at each one of </span><span class="line" data-startTime="408">these in a bit more detail. </span></p>

<p><span class="line" data-startTime="414">So first of all, the DOM is </span><span class="line" data-startTime="414">basically an API that provides </span><span class="line" data-startTime="419">access to HTML documents. </span> <span class="line" data-startTime="421">The browser parses this and </span><span class="line" data-startTime="421">provides us with a tree of </span><span class="line" data-startTime="423">objects that we can manipulate </span><span class="line" data-startTime="423">with JavaScript. </span> <span class="line" data-startTime="428">Now, this is the first </span><span class="line" data-startTime="428">step for a reason. </span> <span class="line" data-startTime="430">Everything else in the whole </span><span class="line" data-startTime="430">rendering cycle depends on </span><span class="line" data-startTime="433">this being accurate. </span> <span class="line" data-startTime="434">So when we, for example, add a </span><span class="line" data-startTime="434">child or change a class name, </span><span class="line" data-startTime="438">the first thing that has to </span><span class="line" data-startTime="438">happen is we have to actually </span><span class="line" data-startTime="440">edit the DOM. </span> <span class="line" data-startTime="443">This may be familiar to you if </span><span class="line" data-startTime="443">you have used the Dev Tools </span><span class="line" data-startTime="446">Element Inspector. </span> <span class="line" data-startTime="448">We'll see a tree representation </span><span class="line" data-startTime="448">of our </span><span class="line" data-startTime="450">document, and that's actually </span><span class="line" data-startTime="450">going to be </span><span class="line" data-startTime="454">reflecting the DOM itself. </span></p>

<p><span class="line" data-startTime="457">And here's a little snippet of </span><span class="line" data-startTime="457">JavaScript with some examples </span><span class="line" data-startTime="460">of things we might do to </span><span class="line" data-startTime="460">cause the browser to </span><span class="line" data-startTime="463">have to edit the DOM. </span> <span class="line" data-startTime="465">We might set the inner text or </span><span class="line" data-startTime="465">inner HTML, we might add or </span><span class="line" data-startTime="469">remove children, or we might </span><span class="line" data-startTime="469">even just change the </span><span class="line" data-startTime="471">attributes on an element. </span> <span class="line" data-startTime="473">Any of these things are going to </span><span class="line" data-startTime="473">cause the browser to enter </span><span class="line" data-startTime="475">the rendering cycle and </span><span class="line" data-startTime="475">go to step number one. </span> <span class="line" data-startTime="480">The next thing that the browser </span><span class="line" data-startTime="480">does, once it's got an </span><span class="line" data-startTime="483">accurate snap of the DOM, is </span><span class="line" data-startTime="483">it's going to calculate CSS </span><span class="line" data-startTime="486">property values. </span> <span class="line" data-startTime="489">So that means for every single </span><span class="line" data-startTime="489">element on the page, the </span><span class="line" data-startTime="492">browser has to have a value for </span><span class="line" data-startTime="492">every single CSS property. </span></p>

<p><span class="line" data-startTime="495">Depending on what kind of </span><span class="line" data-startTime="495">element you're looking at, </span><span class="line" data-startTime="498">this is often upwards of 200 </span><span class="line" data-startTime="498">different properties. </span> <span class="line" data-startTime="501">So we can kind of get a glimpse </span><span class="line" data-startTime="501">of all the work that </span><span class="line" data-startTime="504">the browser is doing. </span> <span class="line" data-startTime="505">In the Chrome Inspector, if we </span><span class="line" data-startTime="505">take a look at this Computed </span><span class="line" data-startTime="508">Style Zippy, we can see that </span><span class="line" data-startTime="508">there are just a ton of </span><span class="line" data-startTime="511">properties here. </span> <span class="line" data-startTime="513">Fortunately, browsers today are </span><span class="line" data-startTime="513">fast, but it's still an </span><span class="line" data-startTime="517">amount of work that has to be </span><span class="line" data-startTime="517">done before we can actually </span><span class="line" data-startTime="519">make updates. </span> <span class="line" data-startTime="521">So here's an example of just a </span><span class="line" data-startTime="521">menu toggle button that we </span><span class="line" data-startTime="524">might have in our HTML and </span><span class="line" data-startTime="524">then some CSS that </span><span class="line" data-startTime="527">goes along with it. </span> <span class="line" data-startTime="528">We've got Hover Selector. </span> <span class="line" data-startTime="530">We might behave a little bit </span><span class="line" data-startTime="530">differently when the menu is </span><span class="line" data-startTime="532">open versus closed. </span></p>

<p><span class="line" data-startTime="534">Same thing if we've disabled </span><span class="line" data-startTime="534">the Menu button. </span> <span class="line" data-startTime="538">And going on a little bit </span><span class="line" data-startTime="538">further, we see some </span><span class="line" data-startTime="540">JavaScript that's going to cause </span><span class="line" data-startTime="540">style recalculations. </span> <span class="line" data-startTime="544">So if we set that Disabled </span><span class="line" data-startTime="544">Attribute to be true, the </span><span class="line" data-startTime="547">browser is actually going to </span><span class="line" data-startTime="547">have to start recalculating </span><span class="line" data-startTime="549">styles again because </span><span class="line" data-startTime="549">we can put HTML </span><span class="line" data-startTime="553">attributes in our CSS selectors. </span> <span class="line" data-startTime="557">And here, I've highlighted the </span><span class="line" data-startTime="557">key things that will cause </span><span class="line" data-startTime="560">style recalculation. </span> <span class="line" data-startTime="562">Things like pseudo classes, such </span><span class="line" data-startTime="562">as Hover or Active, can </span><span class="line" data-startTime="568">actually also cause a </span><span class="line" data-startTime="568">style recalculation. </span> <span class="line" data-startTime="571">The browser had to go, through </span><span class="line" data-startTime="571">find new matches for all of </span><span class="line" data-startTime="574">our properties, and potentially </span><span class="line" data-startTime="574">change the value </span><span class="line" data-startTime="578">for various CSS properties. </span></p>

<p><span class="line" data-startTime="583">Once we've got all of our CSS in </span><span class="line" data-startTime="583">place, we're going to start </span><span class="line" data-startTime="586">getting into the </span><span class="line" data-startTime="586">layout portion. </span> <span class="line" data-startTime="588">And the first step of that </span><span class="line" data-startTime="588">is building a new tree. </span> <span class="line" data-startTime="591">We already have the DOM, </span><span class="line" data-startTime="591">however, the rendering tree is </span><span class="line" data-startTime="595">sort of an internal data </span><span class="line" data-startTime="595">structure that the browser </span><span class="line" data-startTime="597">uses to perform layout tasks. </span> <span class="line" data-startTime="601">It might be shaped differently </span><span class="line" data-startTime="601">than the DOM and it might </span><span class="line" data-startTime="603">contain different things. </span> <span class="line" data-startTime="606">So here are some examples. </span> <span class="line" data-startTime="608">In the DOM, we're always going </span><span class="line" data-startTime="608">to have elements and nodes. </span> <span class="line" data-startTime="612">These are the entries that we </span><span class="line" data-startTime="612">see in the DOM, and that's </span><span class="line" data-startTime="614">contrasted with the rendering </span><span class="line" data-startTime="614">tree where we see boxes. </span></p>

<p><span class="line" data-startTime="617">Those are things that are </span><span class="line" data-startTime="617">actually painted on the page. </span> <span class="line" data-startTime="620">And in terms of the shape of </span><span class="line" data-startTime="620">the rendering tree, we </span><span class="line" data-startTime="622">actually have a different </span><span class="line" data-startTime="622">parenting strategy. </span> <span class="line" data-startTime="624">It's not necessarily the case </span><span class="line" data-startTime="624">that a DOM parent is going to </span><span class="line" data-startTime="627">be the parent in the </span><span class="line" data-startTime="627">rendering tree. </span> <span class="line" data-startTime="630">So first, let's talk </span><span class="line" data-startTime="630">a little bit about </span><span class="line" data-startTime="632">elements versus boxes. </span> <span class="line" data-startTime="633">They're related, but they're </span><span class="line" data-startTime="633">not the same. </span> <span class="line" data-startTime="636">So a box is going to be any </span><span class="line" data-startTime="636">entity that gets rendered on </span><span class="line" data-startTime="639">the page, whereas an element is </span><span class="line" data-startTime="639">just going to be an entry </span><span class="line" data-startTime="642">in the DOM. </span> <span class="line" data-startTime="644">So here's some examples of </span><span class="line" data-startTime="644">elements that might never be </span><span class="line" data-startTime="648">rendered on the page. </span> <span class="line" data-startTime="650">Things that are displayed </span><span class="line" data-startTime="650">None will not be in </span><span class="line" data-startTime="651">the rendering tree. </span> <span class="line" data-startTime="653">Style tags, script tags, </span><span class="line" data-startTime="653">the head tag &mdash; </span><span class="line" data-startTime="655">any of those things are elements </span><span class="line" data-startTime="655">but not boxes. </span></p>

<p><span class="line" data-startTime="659">Similarly, there are lots of </span><span class="line" data-startTime="659">generated boxes that we do not </span><span class="line" data-startTime="662">have access to in the DOM. </span> <span class="line" data-startTime="664">Examples include any pseudo </span><span class="line" data-startTime="664">elements that we've added to </span><span class="line" data-startTime="668">our CSS, line boxes. </span> <span class="line" data-startTime="670">If we've got a large paragraph </span><span class="line" data-startTime="670">of text with many lines, the </span><span class="line" data-startTime="673">browser is laying those </span><span class="line" data-startTime="673">out in boxes. </span> <span class="line" data-startTime="676">And any other generate a box, </span><span class="line" data-startTime="676">like an anonymous box. </span> <span class="line" data-startTime="680">These are all going to </span><span class="line" data-startTime="680">be painted but not </span><span class="line" data-startTime="682">present in the DOM. </span> <span class="line" data-startTime="684">And then there's a good deal </span><span class="line" data-startTime="684">of overlap in the middle &mdash; </span><span class="line" data-startTime="687">Divs, Anchors, things </span><span class="line" data-startTime="687">that are painted </span><span class="line" data-startTime="689">that are also elements. </span> <span class="line" data-startTime="693">So in addition to the fact that </span><span class="line" data-startTime="693">we might have different </span><span class="line" data-startTime="696">content inside of these </span><span class="line" data-startTime="696">trees, they can also </span><span class="line" data-startTime="698">have a different shape. </span> <span class="line" data-startTime="699">So a parent in the DOM tree is </span><span class="line" data-startTime="699">always going to be the parent </span><span class="line" data-startTime="703">in the HTML. </span></p>

<p><span class="line" data-startTime="704">However, the parent in the </span><span class="line" data-startTime="704">rendering tree is always going </span><span class="line" data-startTime="707">to be a boxes containing </span><span class="line" data-startTime="707">block. </span> <span class="line" data-startTime="710">And if you ever decide that </span><span class="line" data-startTime="710">you just need some fun on </span><span class="line" data-startTime="713">Friday night and you read the </span><span class="line" data-startTime="713">CSS spec, you'll see lots of </span><span class="line" data-startTime="716">references to the containing </span><span class="line" data-startTime="716">block when you are reading the </span><span class="line" data-startTime="719">layout module. </span> <span class="line" data-startTime="721">And in general, we actually do </span><span class="line" data-startTime="721">see a lot of correlation </span><span class="line" data-startTime="724">between the DOM tree and the </span><span class="line" data-startTime="724">rendering tree, but there are </span><span class="line" data-startTime="727">some notable exceptions. </span> <span class="line" data-startTime="729">Absolutely positioned boxes </span><span class="line" data-startTime="729">are the most obvious one. </span></p>

<p><span class="line" data-startTime="733">So whenever we're looking for a </span><span class="line" data-startTime="733">rendering tree parent for an </span><span class="line" data-startTime="736">absolute box, the browser's </span><span class="line" data-startTime="736">actually walking up the DOM </span><span class="line" data-startTime="739">looking for a positioned </span><span class="line" data-startTime="739">ancestor. </span> <span class="line" data-startTime="741">So this is going to be some </span><span class="line" data-startTime="741">other parent in the tree &mdash; </span><span class="line" data-startTime="744">or an ancestor, rather &mdash; </span><span class="line" data-startTime="746">that has a position property </span><span class="line" data-startTime="746">other than static. </span> <span class="line" data-startTime="749">This will be the parent </span><span class="line" data-startTime="749">in the rendering tree. </span> <span class="line" data-startTime="752">So I've got a bit of an example </span><span class="line" data-startTime="752">on the next page. </span> <span class="line" data-startTime="755">So there's a bit of HTML here, </span><span class="line" data-startTime="755">and I'm going to show you the </span><span class="line" data-startTime="759">differences between the DOM tree </span><span class="line" data-startTime="759">and the rendering tree. </span> <span class="line" data-startTime="763">So as we're parsing along with </span><span class="line" data-startTime="763">our HTML, we notice we've got </span><span class="line" data-startTime="767">this section element. </span> <span class="line" data-startTime="769">It has a Div child. </span> <span class="line" data-startTime="773">That Div child itself </span><span class="line" data-startTime="773">has got a text node. </span> <span class="line" data-startTime="776">It's got this Nav element, </span><span class="line" data-startTime="776">which has a text </span><span class="line" data-startTime="778">node itself, et cetera. </span> <span class="line" data-startTime="781">We can keep on parsing </span><span class="line" data-startTime="781">all the way down. </span></p>

<p><span class="line" data-startTime="785">This is the structure </span><span class="line" data-startTime="785">we expect. </span> <span class="line" data-startTime="787">We put in valid HTML, we </span><span class="line" data-startTime="787">got a tree back that </span><span class="line" data-startTime="789">looked exactly the same. </span> <span class="line" data-startTime="790">Now if we were to go back and </span><span class="line" data-startTime="790">build the rendering tree from </span><span class="line" data-startTime="796">the same piece of HTML, </span><span class="line" data-startTime="796">it's going to look </span><span class="line" data-startTime="798">a little bit different. </span> <span class="line" data-startTime="799">So our root element </span><span class="line" data-startTime="799">is the same. </span> <span class="line" data-startTime="801">It's just going to </span><span class="line" data-startTime="801">be a block box. </span> <span class="line" data-startTime="804">And we are definitely going </span><span class="line" data-startTime="804">to have that Div as its </span><span class="line" data-startTime="807">descendant. </span> <span class="line" data-startTime="808">However, something a little bit </span><span class="line" data-startTime="808">different starts to happen </span><span class="line" data-startTime="811">when we reach that absolutely </span><span class="line" data-startTime="811">positioned Nav element. </span> <span class="line" data-startTime="815">This is actually going to become </span><span class="line" data-startTime="815">a sibling of that Div </span><span class="line" data-startTime="818">because this section is </span><span class="line" data-startTime="818">positioned relative, so that </span><span class="line" data-startTime="821">Nav is going to be parented </span><span class="line" data-startTime="821">under that section element. </span></p>

<p><span class="line" data-startTime="825">We also notice that we start </span><span class="line" data-startTime="825">getting some anonymous boxes </span><span class="line" data-startTime="829">that the browser generates </span><span class="line" data-startTime="829">for us. </span> <span class="line" data-startTime="831">This is because any given box </span><span class="line" data-startTime="831">in the tree wants to have </span><span class="line" data-startTime="834">homogeneous children. </span> <span class="line" data-startTime="835">So soon as a particular box has </span><span class="line" data-startTime="835">a block child, it wants </span><span class="line" data-startTime="839">all block children. </span> <span class="line" data-startTime="840">As soon as it has an </span><span class="line" data-startTime="840">inline child, it </span><span class="line" data-startTime="842">wants all inline children. </span> <span class="line" data-startTime="845">So the browser is going to do </span><span class="line" data-startTime="845">whatever it has to to meet </span><span class="line" data-startTime="847">that constraint. </span> <span class="line" data-startTime="848">And when we finish, there's a </span><span class="line" data-startTime="848">tree that is certainly shaped </span><span class="line" data-startTime="852">differently but is in a really </span><span class="line" data-startTime="852">good position to perform </span><span class="line" data-startTime="855">layout tasks. </span> <span class="line" data-startTime="857">So this is all setting us up to </span><span class="line" data-startTime="857">do a layout pass later on. </span></p>

<p><span class="line" data-startTime="861">We've already decided what </span><span class="line" data-startTime="861">everyone's containing block </span><span class="line" data-startTime="863">is, so we know its containing </span><span class="line" data-startTime="863">width, all </span><span class="line" data-startTime="866">those kinds of things. </span> <span class="line" data-startTime="870">Let's talk a little bit about </span><span class="line" data-startTime="870">the properties that are going </span><span class="line" data-startTime="873">to affect the rendering tree. </span> <span class="line" data-startTime="876">The first one is going to </span><span class="line" data-startTime="876">be the display property. </span> <span class="line" data-startTime="878">Is this a block or </span><span class="line" data-startTime="878">an inline box? </span><span class="line" data-startTime="881">Is it Display None, in which </span><span class="line" data-startTime="881">case it's not even in the </span><span class="line" data-startTime="883">rendering tree at all? </span><span class="line" data-startTime="885">Is it a float? </span><span class="line" data-startTime="887">Is it position fixed, position </span><span class="line" data-startTime="887">absolute, position relative, </span><span class="line" data-startTime="890">or position static? </span><span class="line" data-startTime="892">Any edits that we make to these </span><span class="line" data-startTime="892">properties are going to </span><span class="line" data-startTime="894">cause the browser to have to </span><span class="line" data-startTime="894">make some kind of change to </span><span class="line" data-startTime="896">the rendering tree. </span> <span class="line" data-startTime="901">There also some affects on </span><span class="line" data-startTime="901">layers, which we'll talk about </span><span class="line" data-startTime="903">a bit later on. </span> <span class="line" data-startTime="905">But in general, the rendering </span><span class="line" data-startTime="905">tree, again, has set us up to </span><span class="line" data-startTime="908">do a layout pass. </span> <span class="line" data-startTime="911">And when we talk about layout, </span><span class="line" data-startTime="911">all we really mean is that we </span><span class="line" data-startTime="914">have to determine the position </span><span class="line" data-startTime="914">and dimensions of every box. </span> <span class="line" data-startTime="918">How tall is it, how wide is it, </span><span class="line" data-startTime="918">and where is its top left </span><span class="line" data-startTime="921">corner, in most cases. </span></p>

<p><span class="line" data-startTime="925">So the kinds of properties we're </span><span class="line" data-startTime="925">talking about here is </span><span class="line" data-startTime="927">going to be anything to do </span><span class="line" data-startTime="927">with the box model, so </span><span class="line" data-startTime="930">content, padding, border, </span><span class="line" data-startTime="930">margin, and any coordinates. </span> <span class="line" data-startTime="938">So if we've got an absolutely </span><span class="line" data-startTime="938">positioned box, for example, </span><span class="line" data-startTime="942">the top, right, bottom, </span><span class="line" data-startTime="942">and left properties. </span> <span class="line" data-startTime="945">So you'll notice that there is </span><span class="line" data-startTime="945">sometimes a different set of </span><span class="line" data-startTime="947">properties for these </span><span class="line" data-startTime="947">two different parts </span><span class="line" data-startTime="950">of the layout phase. </span> <span class="line" data-startTime="955">Now at this point, the browser </span><span class="line" data-startTime="955">has determined where </span><span class="line" data-startTime="957">everything needs to go but </span><span class="line" data-startTime="957">hasn't actually shown these </span><span class="line" data-startTime="960">changes to the user. </span> <span class="line" data-startTime="962">So the next thing that </span><span class="line" data-startTime="962">to happen is paint. </span> <span class="line" data-startTime="966">And a few things happen opaquely </span><span class="line" data-startTime="966">to us as developers, </span><span class="line" data-startTime="970">but in the end, the browser </span><span class="line" data-startTime="970">has a couple of tasks. </span></p>

<p><span class="line" data-startTime="973">One, it has to determine, what </span><span class="line" data-startTime="973">color does every pixel on the </span><span class="line" data-startTime="976">page need to be painted? </span><span class="line" data-startTime="978">It needs to actually create </span><span class="line" data-startTime="978">a bitmap that has that </span><span class="line" data-startTime="981">information, and then it needs </span><span class="line" data-startTime="981">to send that to the GPU so </span><span class="line" data-startTime="984">that it can actually be </span><span class="line" data-startTime="984">presented to the user. </span> <span class="line" data-startTime="988">Now, a given pixel can only </span><span class="line" data-startTime="988">have one particular color. </span> <span class="line" data-startTime="991">So as you might expect, we can </span><span class="line" data-startTime="991">incur some extra costs here if </span><span class="line" data-startTime="995">we have any transparency. </span> <span class="line" data-startTime="997">We can't stop at </span><span class="line" data-startTime="997">the top layer. </span></p>

<p><span class="line" data-startTime="999">We have to keep looking </span><span class="line" data-startTime="999">underneath it to calculate </span><span class="line" data-startTime="1001">exactly what color to </span><span class="line" data-startTime="1001">paint this pixel. </span> <span class="line" data-startTime="1004">You can get especially slow if </span><span class="line" data-startTime="1004">we're talking about anything </span><span class="line" data-startTime="1007">that has text because text is </span><span class="line" data-startTime="1007">anti-aliased and there are </span><span class="line" data-startTime="1010">lots of little transparent </span><span class="line" data-startTime="1010">pixels around every letter. </span> <span class="line" data-startTime="1016">So one other thing to note </span><span class="line" data-startTime="1016">is the browser doesn't </span><span class="line" data-startTime="1019">necessarily have </span><span class="line" data-startTime="1019">one big bitmap. </span> <span class="line" data-startTime="1021">When we were looking at the </span><span class="line" data-startTime="1021">timeline earlier on, you saw </span><span class="line" data-startTime="1024">small rectangles that were being </span><span class="line" data-startTime="1024">updated rather than the </span><span class="line" data-startTime="1027">whole thing at once. </span> <span class="line" data-startTime="1028">And so there are a number of </span><span class="line" data-startTime="1028">strategies the browser uses to </span><span class="line" data-startTime="1031">pick small damaged rectangles, </span><span class="line" data-startTime="1031">and one of those is it can </span><span class="line" data-startTime="1036">have several different layers. </span> <span class="line" data-startTime="1037">So we can actually tell </span><span class="line" data-startTime="1037">the browser how to </span><span class="line" data-startTime="1039">slice the page up. </span></p>

<p><span class="line" data-startTime="1041">I know that all these things </span><span class="line" data-startTime="1041">are likely to stay together </span><span class="line" data-startTime="1044">relative to each other, so keep </span><span class="line" data-startTime="1044">all these in one layer. </span> <span class="line" data-startTime="1048">And then it would be the GPU's </span><span class="line" data-startTime="1048">job to put all of those </span><span class="line" data-startTime="1052">together in the next step. </span> <span class="line" data-startTime="1055">I do want to point out that </span><span class="line" data-startTime="1055">although browser vendors tend </span><span class="line" data-startTime="1058">to be going towards this layer </span><span class="line" data-startTime="1058">strategy, it's not specified </span><span class="line" data-startTime="1061">behavior anywhere. </span> <span class="line" data-startTime="1063">So it is an implementation </span><span class="line" data-startTime="1063">detail, one that we certainly </span><span class="line" data-startTime="1066">want to take advantage of when </span><span class="line" data-startTime="1066">we're trying to get a really </span><span class="line" data-startTime="1068">fast experience, but also one </span><span class="line" data-startTime="1068">that we can't say will still </span><span class="line" data-startTime="1072">be there in a couple of years. </span></p>

<p><span class="line" data-startTime="1074">Hopefully, we won't have to </span><span class="line" data-startTime="1074">worry about it anymore. </span> <span class="line" data-startTime="1077">So we've got a bunch of bitmaps </span><span class="line" data-startTime="1077">that's been handed </span><span class="line" data-startTime="1079">over to us, and we need to </span><span class="line" data-startTime="1079">composite them together. </span> <span class="line" data-startTime="1084">So all these layer bitmaps are </span><span class="line" data-startTime="1084">handed over to the GPU. </span> <span class="line" data-startTime="1088">The GPU sticks them all together </span><span class="line" data-startTime="1088">and then draws those </span><span class="line" data-startTime="1090">things on the screen. </span> <span class="line" data-startTime="1091">Now, anywhere we see some sort </span><span class="line" data-startTime="1091">of hand-off from the CPU to </span><span class="line" data-startTime="1095">the GPU to the actual render, </span><span class="line" data-startTime="1095">those are all going to incur </span><span class="line" data-startTime="1100">some sort of cost because we're </span><span class="line" data-startTime="1100">transferring this object </span><span class="line" data-startTime="1103">around in memory, so that's </span><span class="line" data-startTime="1103">something to keep in mind. </span> <span class="line" data-startTime="1106">But something else to note is </span><span class="line" data-startTime="1106">that the GPU, it turns out, is </span><span class="line" data-startTime="1110">very fast at drawing things. </span></p>

<p><span class="line" data-startTime="1112">This make sense. </span> <span class="line" data-startTime="1114">The first G is for graphics. </span> <span class="line" data-startTime="1116">So it's much better for us </span><span class="line" data-startTime="1116">to spend as much time in </span><span class="line" data-startTime="1119">compositing rather </span><span class="line" data-startTime="1119">than painting </span><span class="line" data-startTime="1121">if we have the choice. </span> <span class="line" data-startTime="1125">So properties that the </span><span class="line" data-startTime="1125">compositor is really good at </span><span class="line" data-startTime="1129">are going to be opacity. </span> <span class="line" data-startTime="1134">If we're just doing some sort </span><span class="line" data-startTime="1134">of transition or something </span><span class="line" data-startTime="1136">that just changes opacity, the </span><span class="line" data-startTime="1136">GPU can do this all on its </span><span class="line" data-startTime="1139">own, and same thing </span><span class="line" data-startTime="1139">with transforms. </span> <span class="line" data-startTime="1142">So that's going to be anything </span><span class="line" data-startTime="1142">like a rotation, a skew, a </span><span class="line" data-startTime="1144">translation, any of those things </span><span class="line" data-startTime="1144">that move a particular </span><span class="line" data-startTime="1147">element around the screen. </span></p>

<p><span class="line" data-startTime="1150">Transform is very &mdash; </span><span class="line" data-startTime="1152">well, I think it's </span><span class="line" data-startTime="1152">very interesting. </span> <span class="line" data-startTime="1154">You may or may not. </span> <span class="line" data-startTime="1155">We can move things around the </span><span class="line" data-startTime="1155">page without actually </span><span class="line" data-startTime="1158">affecting layout. </span> <span class="line" data-startTime="1160">So typically, when we move </span><span class="line" data-startTime="1160">things around the page, we're </span><span class="line" data-startTime="1162">using the position relative </span><span class="line" data-startTime="1162">and we change the left </span><span class="line" data-startTime="1165">property, or we'll add some </span><span class="line" data-startTime="1165">margin, something like that, </span><span class="line" data-startTime="1169">but all those are taking us </span><span class="line" data-startTime="1169">back to the layout step. </span></p>

<p><span class="line" data-startTime="1171">However, if we're relying just </span><span class="line" data-startTime="1171">on transformation to do that, </span><span class="line" data-startTime="1175">this element is totally </span><span class="line" data-startTime="1175">out of the flow. </span> <span class="line" data-startTime="1177">The layout engine, the rendering </span><span class="line" data-startTime="1177">tree still thinks </span><span class="line" data-startTime="1179">it's in the original location, </span><span class="line" data-startTime="1179">so it's not dirtying up </span><span class="line" data-startTime="1182">anything else anywhere </span><span class="line" data-startTime="1182">on the page. </span> <span class="line" data-startTime="1185">Now, this also has the side </span><span class="line" data-startTime="1185">effect that it's not pushing </span><span class="line" data-startTime="1188">anything out of its way, so </span><span class="line" data-startTime="1188">maybe you have to move other </span><span class="line" data-startTime="1190">things as well. </span> <span class="line" data-startTime="1192">But to get certain kinds of </span><span class="line" data-startTime="1192">effects, this can be a very </span><span class="line" data-startTime="1194">handy thing to know. </span> <span class="line" data-startTime="1197">So if we look back over the </span><span class="line" data-startTime="1197">rendering cycle that we've </span><span class="line" data-startTime="1199">just discussed, we can see </span><span class="line" data-startTime="1199">that there is definitely </span><span class="line" data-startTime="1202">alignment with the things </span><span class="line" data-startTime="1202">the Timeline tells us. </span></p>

<p><span class="line" data-startTime="1205">So in terms of updating the </span><span class="line" data-startTime="1205">DOM and doing our style </span><span class="line" data-startTime="1209">recalc, those are all going </span><span class="line" data-startTime="1209">to fall under the Style </span><span class="line" data-startTime="1212">Recalculation that we saw. </span> <span class="line" data-startTime="1214">And then we've got all </span><span class="line" data-startTime="1214">of this layout work. </span> <span class="line" data-startTime="1216">We have to make any updates to </span><span class="line" data-startTime="1216">the rendering tree, and then </span><span class="line" data-startTime="1220">actually calculate the layout. </span> <span class="line" data-startTime="1222">And then at the very end, we've </span><span class="line" data-startTime="1222">got a painting step and </span><span class="line" data-startTime="1225">then compositing layers, which </span><span class="line" data-startTime="1225">I did not show you yet, but I </span><span class="line" data-startTime="1229">will in just a moment. </span> <span class="line" data-startTime="1231">So at this point, we're armed </span><span class="line" data-startTime="1231">with enough knowledge to maybe </span><span class="line" data-startTime="1235">look at the Timeline and reverse </span><span class="line" data-startTime="1235">engineer, OK, a layout </span><span class="line" data-startTime="1239">occurred here. </span> <span class="line" data-startTime="1240">I don't want one. </span></p>

<p><span class="line" data-startTime="1241">What other strategy could </span><span class="line" data-startTime="1241">I have used for </span><span class="line" data-startTime="1243">that particular effect? </span><span class="line" data-startTime="1245">And we can try to remove </span><span class="line" data-startTime="1245">layouts, eliminate style </span><span class="line" data-startTime="1249">recalculations, that </span><span class="line" data-startTime="1249">sort of thing. </span> <span class="line" data-startTime="1254">So I apologize because I'm going </span><span class="line" data-startTime="1254">to be hiding behind my </span><span class="line" data-startTime="1257">computer a bit, but I have a </span><span class="line" data-startTime="1257">short demo app that I'm going </span><span class="line" data-startTime="1260">to show various snaps of </span><span class="line" data-startTime="1260">the Timeline from. </span> <span class="line" data-startTime="1265">So first of all, the effect that </span><span class="line" data-startTime="1265">we're going for here is </span><span class="line" data-startTime="1269">going to be this little guy </span><span class="line" data-startTime="1269">sliding in and out, and that's </span><span class="line" data-startTime="1273">just a hover change. </span> <span class="line" data-startTime="1275">So when I hover in, it </span><span class="line" data-startTime="1275">slides in and out. </span> <span class="line" data-startTime="1277">And I'm going to show you what </span><span class="line" data-startTime="1277">the Timeline looks like for </span><span class="line" data-startTime="1279">various different ways we can </span><span class="line" data-startTime="1279">implement the same effect. </span></p>

<p><span class="line" data-startTime="1283">This first one is implemented </span><span class="line" data-startTime="1283">with margin. </span> <span class="line" data-startTime="1285">We can see that we positioned </span><span class="line" data-startTime="1285">this element offscreen with a </span><span class="line" data-startTime="1288">margin left, and then </span><span class="line" data-startTime="1288">we bring it back in </span><span class="line" data-startTime="1290">whenever a hover occurs. </span> <span class="line" data-startTime="1293">So if we go ahead and fire up </span><span class="line" data-startTime="1293">our Timeline and we take a </span><span class="line" data-startTime="1297">recording, we'll see lots of </span><span class="line" data-startTime="1297">exciting things happening. </span> <span class="line" data-startTime="1301">And I'm going to go ahead and </span><span class="line" data-startTime="1301">zoom in here and just analyze </span><span class="line" data-startTime="1304">what the browser's had to do. </span> <span class="line" data-startTime="1306">So we see that there are </span><span class="line" data-startTime="1306">a number of style </span><span class="line" data-startTime="1308">recalculations. </span> <span class="line" data-startTime="1309">It is unfortunate that there </span><span class="line" data-startTime="1309">are several instead of just </span><span class="line" data-startTime="1312">one, but that happens </span><span class="line" data-startTime="1312">sometimes. </span> <span class="line" data-startTime="1316">Chrome in particular is getting </span><span class="line" data-startTime="1316">better and better at </span><span class="line" data-startTime="1319">combining these things, but we </span><span class="line" data-startTime="1319">see that we've got a bunch of </span><span class="line" data-startTime="1323">style recalcs, and then we </span><span class="line" data-startTime="1323">have a layout here, which </span><span class="line" data-startTime="1327">makes sense. </span></p>

<p><span class="line" data-startTime="1328">Margin is a layout-related </span><span class="line" data-startTime="1328">property. </span> <span class="line" data-startTime="1330">So even though it didn't push </span><span class="line" data-startTime="1330">anything else out of the way, </span><span class="line" data-startTime="1332">the rendering tree and the </span><span class="line" data-startTime="1332">dimensions of this element </span><span class="line" data-startTime="1338">actually had to be updated. </span> <span class="line" data-startTime="1339">As we scroll down, we continue </span><span class="line" data-startTime="1339">to see that there are a series </span><span class="line" data-startTime="1342">of recalculate style and layout, </span><span class="line" data-startTime="1342">one after the other. </span> <span class="line" data-startTime="1345">So the way that I have </span><span class="line" data-startTime="1345">implemented this is with a CSS </span><span class="line" data-startTime="1349">transition, and so the browser </span><span class="line" data-startTime="1349">is basically, on my behalf, </span><span class="line" data-startTime="1352">going through and saying, well, </span><span class="line" data-startTime="1352">the margin left was </span><span class="line" data-startTime="1355">negative 215. </span> <span class="line" data-startTime="1356">Now it's negative 214, </span><span class="line" data-startTime="1356">and on, and so forth. </span></p>

<p><span class="line" data-startTime="1360">So we'll continue to see a </span><span class="line" data-startTime="1360">number of style recalculations </span><span class="line" data-startTime="1362">as we go, and we'll also start </span><span class="line" data-startTime="1362">to see some paints. </span> <span class="line" data-startTime="1366">Now I scrolled a bit so my </span><span class="line" data-startTime="1366">rectangles will be in the </span><span class="line" data-startTime="1368">wrong place, but we can see </span><span class="line" data-startTime="1368">that there are little </span><span class="line" data-startTime="1371">rectangles that start peeking </span><span class="line" data-startTime="1371">in, demonstrating where a flag </span><span class="line" data-startTime="1375">comes in and out. </span> <span class="line" data-startTime="1377">Now, as a hat tip and also a bit </span><span class="line" data-startTime="1377">of a frustration for me, </span><span class="line" data-startTime="1381">when I started working on this </span><span class="line" data-startTime="1381">talk a month ago, those </span><span class="line" data-startTime="1384">rectangles were huge and I got a </span><span class="line" data-startTime="1384">really big win when I showed </span><span class="line" data-startTime="1387">you the next version. </span> <span class="line" data-startTime="1389">It got faster, and so the impact </span><span class="line" data-startTime="1389">is less severe, but we </span><span class="line" data-startTime="1393">can still see as we go through </span><span class="line" data-startTime="1393">that the browser's having to </span><span class="line" data-startTime="1395">do a number of steps before </span><span class="line" data-startTime="1395">it can do a single paint. </span> <span class="line" data-startTime="1399">Sometimes a paint doesn't </span><span class="line" data-startTime="1399">even fit in. </span></p>

<p><span class="line" data-startTime="1401">We'll get a recalc, a layout, </span><span class="line" data-startTime="1401">and then another recalc </span><span class="line" data-startTime="1404">without even getting a paint. </span> <span class="line" data-startTime="1406">So this sort of thing is going </span><span class="line" data-startTime="1406">to cause a lower frame rate </span><span class="line" data-startTime="1408">for the user. </span> <span class="line" data-startTime="1411">So we scroll all the way to the </span><span class="line" data-startTime="1411">end, and at some point, </span><span class="line" data-startTime="1416">everything finished and it </span><span class="line" data-startTime="1416">painted the entire little logo </span><span class="line" data-startTime="1421">all the way on screen. </span> <span class="line" data-startTime="1423">And it's not too bad. </span> <span class="line" data-startTime="1424">This happens to be an incredibly </span><span class="line" data-startTime="1424">lightweight page. </span> <span class="line" data-startTime="1427">If we had a lot more elements </span><span class="line" data-startTime="1427">on the page, though, we'd </span><span class="line" data-startTime="1430">start getting some jerkiness </span><span class="line" data-startTime="1430">that the user </span><span class="line" data-startTime="1432">can actually see. </span> <span class="line" data-startTime="1433">And so we've got a number of </span><span class="line" data-startTime="1433">steps that we want to go </span><span class="line" data-startTime="1437">through, and we get the biggest </span><span class="line" data-startTime="1437">wins at the beginning </span><span class="line" data-startTime="1441">of the rendering cycle. </span></p>

<p><span class="line" data-startTime="1442">So in particular, can we </span><span class="line" data-startTime="1442">eliminate recalcs and can we </span><span class="line" data-startTime="1445">eliminate layouts? </span><span class="line" data-startTime="1446">So those are the things </span><span class="line" data-startTime="1446">that we're going to </span><span class="line" data-startTime="1448">try to focus on. </span> <span class="line" data-startTime="1449">So prior to CSS3, I would have </span><span class="line" data-startTime="1449">said to myself, you know, </span><span class="line" data-startTime="1453">margin can cause other things on </span><span class="line" data-startTime="1453">the page to move around, so </span><span class="line" data-startTime="1458">maybe I'll try to absolutely </span><span class="line" data-startTime="1458">position this flag and slide </span><span class="line" data-startTime="1461">it in and out, because then, I'm </span><span class="line" data-startTime="1461">guaranteed it's not going </span><span class="line" data-startTime="1463">to affect all those siblings </span><span class="line" data-startTime="1463">that are in the flow. </span> <span class="line" data-startTime="1469">So I'll go ahead and click </span><span class="line" data-startTime="1469">Position, and my </span><span class="line" data-startTime="1471">CSS is going to change. </span> <span class="line" data-startTime="1472">This is going to be absolutely </span><span class="line" data-startTime="1472">positioned, and I'm going to </span><span class="line" data-startTime="1474">use the left property instead </span><span class="line" data-startTime="1474">to do the animation. </span> <span class="line" data-startTime="1479">And I'll weasel it on screen </span><span class="line" data-startTime="1479">a little bit, take a new </span><span class="line" data-startTime="1482">recording, and zoom in and see </span><span class="line" data-startTime="1482">if things got any better. </span> <span class="line" data-startTime="1489">So I still see a number of </span><span class="line" data-startTime="1489">recalculations, and I still </span><span class="line" data-startTime="1492">see layouts. </span></p>

<p><span class="line" data-startTime="1493">Now, these layouts are going to </span><span class="line" data-startTime="1493">be a bit quicker than the </span><span class="line" data-startTime="1497">layouts we saw with margin, </span><span class="line" data-startTime="1497">but they're still there </span><span class="line" data-startTime="1500">because when we looked at the </span><span class="line" data-startTime="1500">layout slide, left is still a </span><span class="line" data-startTime="1505">property that has to do some </span><span class="line" data-startTime="1505">sort of layout calculation. </span> <span class="line" data-startTime="1509">Now, it's cheaper because it </span><span class="line" data-startTime="1509">doesn't affect anything else </span><span class="line" data-startTime="1511">on the page, but it's still </span><span class="line" data-startTime="1511">going to cost us. </span> <span class="line" data-startTime="1514">So as we're going down, we still </span><span class="line" data-startTime="1514">see that we've got these </span><span class="line" data-startTime="1517">recalculations and layouts </span><span class="line" data-startTime="1517">interspersed </span><span class="line" data-startTime="1520">with all of our painting. </span> <span class="line" data-startTime="1522">And this is just not going to be </span><span class="line" data-startTime="1522">good enough, mostly because </span><span class="line" data-startTime="1524">we can do better. </span></p>

<p><span class="line" data-startTime="1527">So that wasn't as big a win as </span><span class="line" data-startTime="1527">maybe we would have hoped. </span> <span class="line" data-startTime="1530">However, if we think back to </span><span class="line" data-startTime="1530">what I said about layers, it </span><span class="line" data-startTime="1534">might occur to us to try a </span><span class="line" data-startTime="1534">transformation instead. </span> <span class="line" data-startTime="1538">Transforms have no </span><span class="line" data-startTime="1538">effect on layout. </span> <span class="line" data-startTime="1539">It's a paint only concept, so </span><span class="line" data-startTime="1539">we might give that a try. </span> <span class="line" data-startTime="1544">So let's take a look at </span><span class="line" data-startTime="1544">the CSS we do here. </span> <span class="line" data-startTime="1546">We're going to use </span><span class="line" data-startTime="1546">a transformation. </span> <span class="line" data-startTime="1549">We're going to translate </span><span class="line" data-startTime="1549">x instead of </span><span class="line" data-startTime="1551">moving our left property. </span> <span class="line" data-startTime="1553">So leave the element in the </span><span class="line" data-startTime="1553">flow, but go ahead and </span><span class="line" data-startTime="1555">reposition it using </span><span class="line" data-startTime="1555">a transform. </span></p>

<p><span class="line" data-startTime="1558">So I'll go ahead and take </span><span class="line" data-startTime="1558">a recording here. </span> <span class="line" data-startTime="1564">I can tell already there's a lot </span><span class="line" data-startTime="1564">more green in here, which </span><span class="line" data-startTime="1566">is exactly what I'm </span><span class="line" data-startTime="1566">looking for. </span> <span class="line" data-startTime="1569">So I still see a number of </span><span class="line" data-startTime="1571">recalculations at the beginning. </span> <span class="line" data-startTime="1573">Remember, hovering can cause our </span><span class="line" data-startTime="1573">CSS selectors to change. </span> <span class="line" data-startTime="1576">That's what actually kicked off </span><span class="line" data-startTime="1576">my transition, in fact. </span> <span class="line" data-startTime="1581">But when I continue looking, I </span><span class="line" data-startTime="1581">see that there are a large </span><span class="line" data-startTime="1585">number of paints at the </span><span class="line" data-startTime="1585">beginning, but then as I go </span><span class="line" data-startTime="1588">through, I'm getting just a </span><span class="line" data-startTime="1588">bunch of composited layers. </span> <span class="line" data-startTime="1593">So these are incredibly cheap </span><span class="line" data-startTime="1593">and easy for the GPU to do, </span><span class="line" data-startTime="1597">and so we're going to see a </span><span class="line" data-startTime="1597">much smoother transform, </span><span class="line" data-startTime="1600">especially if, like I said, we </span><span class="line" data-startTime="1600">had a very heavyweight DOM </span><span class="line" data-startTime="1604">page that was hard for </span><span class="line" data-startTime="1604">the browser to paint. </span></p>

<p><span class="line" data-startTime="1608">However, still at the end, we've </span><span class="line" data-startTime="1608">got this large paint </span><span class="line" data-startTime="1611">right at the end, and at the </span><span class="line" data-startTime="1611">beginning, there are a series </span><span class="line" data-startTime="1614">of pains as well. </span> <span class="line" data-startTime="1617">These sort of perplexed me when </span><span class="line" data-startTime="1617">I first tried this out </span><span class="line" data-startTime="1619">and I was thinking to myself, </span><span class="line" data-startTime="1619">there's nothing up there. </span> <span class="line" data-startTime="1621">What's happening? </span><span class="line" data-startTime="1622">But what the browser is actually </span><span class="line" data-startTime="1622">doing is it's saying, </span><span class="line" data-startTime="1624">well, you added a layer here </span><span class="line" data-startTime="1624">but in order to slide that </span><span class="line" data-startTime="1628">around, I had to put everything </span><span class="line" data-startTime="1628">else on the page in </span><span class="line" data-startTime="1630">a layer as well so that the </span><span class="line" data-startTime="1630">GPU can composite them. </span> <span class="line" data-startTime="1634">So this is that little </span><span class="line" data-startTime="1634">CSS tag that I have. </span> <span class="line" data-startTime="1639">This is the links that </span><span class="line" data-startTime="1639">are on there. </span> <span class="line" data-startTime="1642">This is the flag itself. </span> <span class="line" data-startTime="1644">And then we had to do one big </span><span class="line" data-startTime="1644">paint to the whole page to </span><span class="line" data-startTime="1646">actually render those layers. </span> <span class="line" data-startTime="1649">So for the duration of the </span><span class="line" data-startTime="1649">animation, we actually get </span><span class="line" data-startTime="1651">fairly smooth effects, but at </span><span class="line" data-startTime="1651">the beginning and at the end </span><span class="line" data-startTime="1655">we have to do a very </span><span class="line" data-startTime="1655">large paint. </span> <span class="line" data-startTime="1658">And since painting is less </span><span class="line" data-startTime="1658">efficient than compositing, we </span><span class="line" data-startTime="1661">want to try to get the smallest </span><span class="line" data-startTime="1662">rectangles that we can. </span></p>

<p><span class="line" data-startTime="1665">So you may have heard that </span><span class="line" data-startTime="1665">Transform 3D is supposed to </span><span class="line" data-startTime="1669">accelerate things, whatever </span><span class="line" data-startTime="1669">that means. </span> <span class="line" data-startTime="1672">So whenever I'm working on my </span><span class="line" data-startTime="1672">own, I just sort of take that </span><span class="line" data-startTime="1676">as a given and I say, all </span><span class="line" data-startTime="1676">right, let's try that. </span> <span class="line" data-startTime="1678">See if it makes it faster. </span> <span class="line" data-startTime="1680">So let's go ahead and </span><span class="line" data-startTime="1680">take a recording. </span> <span class="line" data-startTime="1682">You'll see at this point I've </span><span class="line" data-startTime="1682">use Translate 3D instead. </span> <span class="line" data-startTime="1685">I haven't actually done anything </span><span class="line" data-startTime="1685">with the y- or the </span><span class="line" data-startTime="1687">z-axis, but I'm going to give </span><span class="line" data-startTime="1687">it a shot and just see if it </span><span class="line" data-startTime="1691">makes a change. </span> <span class="line" data-startTime="1692">Guess and check, the web </span><span class="line" data-startTime="1692">developer's best friend. </span> <span class="line" data-startTime="1698">So I'll go ahead and zoom in on </span><span class="line" data-startTime="1698">here, and I still see that </span><span class="line" data-startTime="1701">I've got a large number </span><span class="line" data-startTime="1701">of paints that </span><span class="line" data-startTime="1703">occur at the beginning. </span> <span class="line" data-startTime="1705">So I'm thinking to myself that </span><span class="line" data-startTime="1705">this is not good enough. </span></p>

<p><span class="line" data-startTime="1709">What I want to do is I want to </span><span class="line" data-startTime="1709">avoid these initial paints, so </span><span class="line" data-startTime="1712">I need to actually take the </span><span class="line" data-startTime="1712">things that are present here </span><span class="line" data-startTime="1715">and I need to put them in </span><span class="line" data-startTime="1715">layers the whole time. </span> <span class="line" data-startTime="1718">The problem here is that </span><span class="line" data-startTime="1718">something is getting popped </span><span class="line" data-startTime="1720">out into a layer, it's causing </span><span class="line" data-startTime="1720">all this extra </span><span class="line" data-startTime="1723">work to have to happen. </span> <span class="line" data-startTime="1724">So instead, if in the resting </span><span class="line" data-startTime="1724">state I put them in layers all </span><span class="line" data-startTime="1728">along, I can avoid this. </span> <span class="line" data-startTime="1730">So I'm going to go and do this </span><span class="line" data-startTime="1730">on the fly, hoping not to make </span><span class="line" data-startTime="1733">typos in front of all of you. </span> <span class="line" data-startTime="1737">But I'm going to go ahead and </span><span class="line" data-startTime="1737">say that everything will be in </span><span class="line" data-startTime="1740">a Translate 3D in its </span><span class="line" data-startTime="1740">resting state. </span> <span class="line" data-startTime="1745">I already have one for the </span><span class="line" data-startTime="1745">resting state of the bar, but </span><span class="line" data-startTime="1750">I don't have anything for this </span><span class="line" data-startTime="1750">list that I've got right here, </span><span class="line" data-startTime="1754">so I might try a Transform 3D </span><span class="line" data-startTime="1754">and say, don't go anywhere. </span></p>

<p><span class="line" data-startTime="1764">Just sit there. </span> <span class="line" data-startTime="1766">And then I might do the same </span><span class="line" data-startTime="1766">thing with this code block </span><span class="line" data-startTime="1768">right here. </span> <span class="line" data-startTime="1777">So my hypothesis is things are </span><span class="line" data-startTime="1777">in layers right now, so as </span><span class="line" data-startTime="1781">soon as I made that change, we </span><span class="line" data-startTime="1781">had to paint each of those </span><span class="line" data-startTime="1783">individually to pop them </span><span class="line" data-startTime="1783">out into layers. </span> <span class="line" data-startTime="1786">But now, it shouldn't cause a </span><span class="line" data-startTime="1786">hitch at the beginning or the </span><span class="line" data-startTime="1789">end of my animation. </span> <span class="line" data-startTime="1790">They're already in layers. </span> <span class="line" data-startTime="1791">We don't have to do that work. </span> <span class="line" data-startTime="1793">So let's give that a shot, </span><span class="line" data-startTime="1793">see how accurate it is. </span> <span class="line" data-startTime="1799">I do see one here. </span></p>

<p><span class="line" data-startTime="1800">I apparently missed somebody </span><span class="line" data-startTime="1800">somewhere on the page. </span> <span class="line" data-startTime="1803">But my giant paints that </span><span class="line" data-startTime="1803">I had before &mdash; </span><span class="line" data-startTime="1805">apologies &mdash; </span><span class="line" data-startTime="1807">no paints, right? </span><span class="line" data-startTime="1809">So I completely eliminated </span><span class="line" data-startTime="1809">paint as </span><span class="line" data-startTime="1812">associated with this layer. </span> <span class="line" data-startTime="1814">Now obviously, when I introduce </span><span class="line" data-startTime="1814">the layer, that </span><span class="line" data-startTime="1816">caused a paint, but now I've </span><span class="line" data-startTime="1816">taken it out of the places </span><span class="line" data-startTime="1819">where I care about smoothness, </span><span class="line" data-startTime="1819">which is the </span><span class="line" data-startTime="1821">duration of my animation. </span> <span class="line" data-startTime="1828">So that was the demo, so let's </span><span class="line" data-startTime="1828">head back and get a high level </span><span class="line" data-startTime="1833">view of the kinds of </span><span class="line" data-startTime="1833">things that we want </span><span class="line" data-startTime="1834">to try to do here. </span> <span class="line" data-startTime="1836">So the first and foremost is </span><span class="line" data-startTime="1836">we have to get rid of any </span><span class="line" data-startTime="1839">JavaScript interruptions </span><span class="line" data-startTime="1839">that we have. </span> <span class="line" data-startTime="1842">If an animation or scrolling is </span><span class="line" data-startTime="1842">occurring, we want to make </span><span class="line" data-startTime="1845">sure that we're not getting </span><span class="line" data-startTime="1845">random JavaScript callbacks, </span><span class="line" data-startTime="1847">we're not doing expensive </span><span class="line" data-startTime="1847">JavaScript in the middle of </span><span class="line" data-startTime="1849">our animation. </span></p>

<p><span class="line" data-startTime="1850">Sometimes, maybe you're </span><span class="line" data-startTime="1850">implementing something like a </span><span class="line" data-startTime="1852">sticky header, you can't avoid </span><span class="line" data-startTime="1852">it, but you want to keep it as </span><span class="line" data-startTime="1855">lightweight as possible because </span><span class="line" data-startTime="1855">any time that we're </span><span class="line" data-startTime="1858">spending on our JavaScript </span><span class="line" data-startTime="1858">is taking </span><span class="line" data-startTime="1861">away time from painting. </span> <span class="line" data-startTime="1863">So that's the first one. </span> <span class="line" data-startTime="1865">The next one is we want </span><span class="line" data-startTime="1865">to get rid of as </span><span class="line" data-startTime="1867">many layouts as possible. </span> <span class="line" data-startTime="1870">Now, we can't always avoid </span><span class="line" data-startTime="1870">a layout occurring. </span> <span class="line" data-startTime="1873">In fact, not only writing to the </span><span class="line" data-startTime="1873">DOM causes a layout, but </span><span class="line" data-startTime="1878">sometimes reading from the DOM </span><span class="line" data-startTime="1878">causes a layout as well. </span> <span class="line" data-startTime="1880">So the browser will try to batch </span><span class="line" data-startTime="1880">up a series of writes to </span><span class="line" data-startTime="1884">the DOM, and if we've </span><span class="line" data-startTime="1884">interleaved a bunch of reads </span><span class="line" data-startTime="1886">in there, it has to validate the </span><span class="line" data-startTime="1886">whole thing before it can </span><span class="line" data-startTime="1889">give you an accurate answer. </span> <span class="line" data-startTime="1890">So for example, if you are </span><span class="line" data-startTime="1890">measuring the width of </span><span class="line" data-startTime="1893">something and then you write </span><span class="line" data-startTime="1893">to the height of something </span><span class="line" data-startTime="1895">else and then you get the </span><span class="line" data-startTime="1895">offset top of something, </span><span class="line" data-startTime="1897">that's going to cause a lot more </span><span class="line" data-startTime="1897">layouts instead of the </span><span class="line" data-startTime="1900">browser being able to </span><span class="line" data-startTime="1900">batch them all up. </span> <span class="line" data-startTime="1902">So even if we can't fully </span><span class="line" data-startTime="1902">eliminate them, we want to get </span><span class="line" data-startTime="1905">as few layouts as possible. </span></p>

<p><span class="line" data-startTime="1908">And then moving on from there, </span><span class="line" data-startTime="1908">we went to minimize our paint </span><span class="line" data-startTime="1910">rectangles. </span> <span class="line" data-startTime="1912">We can't always avoid having </span><span class="line" data-startTime="1912">these rectangles, but we want </span><span class="line" data-startTime="1915">to get them as small </span><span class="line" data-startTime="1915">as possible. </span> <span class="line" data-startTime="1917">So small in number, small </span><span class="line" data-startTime="1917">in size on our paints. </span> <span class="line" data-startTime="1920">And then if we can, we want to </span><span class="line" data-startTime="1920">try to eliminate painting </span><span class="line" data-startTime="1923">altogether. </span> <span class="line" data-startTime="1925">Now again, this whole layer </span><span class="line" data-startTime="1925">concept is not anywhere in any </span><span class="line" data-startTime="1928">sort of standardized </span><span class="line" data-startTime="1928">specification. </span> <span class="line" data-startTime="1930">It's just one of those things </span><span class="line" data-startTime="1930">that we have to do if we want </span><span class="line" data-startTime="1933">a great experience for </span><span class="line" data-startTime="1933">our users these days. </span></p>

<p><span class="line" data-startTime="1936">I will say that a question I </span><span class="line" data-startTime="1936">often get is, well, why don't </span><span class="line" data-startTime="1939">we just put everything into a </span><span class="line" data-startTime="1939">layer and then we don't have </span><span class="line" data-startTime="1941">to worry about it? </span><span class="line" data-startTime="1942">It does take up some amount of </span><span class="line" data-startTime="1942">vRAM, and if you put every </span><span class="line" data-startTime="1946">element in the page on a layer, </span><span class="line" data-startTime="1946">at that point, there's </span><span class="line" data-startTime="1949">so much memory being taken up </span><span class="line" data-startTime="1949">and so much work to combine </span><span class="line" data-startTime="1952">them all together that you get </span><span class="line" data-startTime="1952">very diminishing returns, </span><span class="line" data-startTime="1956">especially on a very low power </span><span class="line" data-startTime="1956">device like a phone. </span> <span class="line" data-startTime="1959">And so we have to be a little </span><span class="line" data-startTime="1959">bit thoughtful. </span> <span class="line" data-startTime="1962">We have to choose our layers, </span><span class="line" data-startTime="1962">carve up our page in a way </span><span class="line" data-startTime="1964">that will actually support </span><span class="line" data-startTime="1964">whatever particular effect </span><span class="line" data-startTime="1967">we're trying to get. </span> <span class="line" data-startTime="1969">So these are our takeaways </span><span class="line" data-startTime="1969">from this session. </span> <span class="line" data-startTime="1972">And if we're trying to improve </span><span class="line" data-startTime="1972">our rendering time, we want to </span><span class="line" data-startTime="1976">start at the top and </span><span class="line" data-startTime="1976">go to the bottom. </span> <span class="line" data-startTime="1977">We'll get the biggest win by </span><span class="line" data-startTime="1977">getting rid of our JavaScript </span><span class="line" data-startTime="1980">and so on down the page. </span></p>

<p><span class="line" data-startTime="1983">There are some links on here, </span><span class="line" data-startTime="1983">and I will also have a link to </span><span class="line" data-startTime="1986">this slide show, but </span><span class="line" data-startTime="1986">there are a ton of </span><span class="line" data-startTime="1988">great resources available. </span> <span class="line" data-startTime="1990">The Chrome Team has been </span><span class="line" data-startTime="1990">wonderful about posting things </span><span class="line" data-startTime="1993">to the HTML5 Rocks website, </span><span class="line" data-startTime="1993">so I definitely highly </span><span class="line" data-startTime="1996">recommend that one. </span> <span class="line" data-startTime="1998">And there are some links on here </span><span class="line" data-startTime="1998">that I've found useful. </span> <span class="line" data-startTime="2000">The last one explains all kinds </span><span class="line" data-startTime="2000">of things about the </span><span class="line" data-startTime="2002">threading architecture for the </span><span class="line" data-startTime="2002">Chrome renderer, so settle in </span><span class="line" data-startTime="2006">on that one, but it's definitely </span><span class="line" data-startTime="2006">a great read. </span> <span class="line" data-startTime="2009">And with that, we're going to </span><span class="line" data-startTime="2009">go ahead and take questions. </span> <span class="line" data-startTime="2012">This link is to the slideshow, </span><span class="line" data-startTime="2012">so if you'd like to revisit </span><span class="line" data-startTime="2015">and click on those links, this </span><span class="line" data-startTime="2015">is where you can go. </span></p>

<p><span class="line" data-startTime="2018">Thank you. </span> <span class="line" data-startTime="2019">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="2027"><span class="speakerName">Chelsea Derrick</span>: And if there </span><span class="line" data-startTime="2027">are any questions, there are a </span><span class="line" data-startTime="2028">couple microphones. </span><span class="line" data-startTime="2029">There's one here </span><span class="line" data-startTime="2029">in the middle. </span></p>

<p class="speaker"><span class="line" data-starttime="2037"><span class="speakerName">Audience</span>: Hi. </span><span class="line" data-startTime="2039">Not sure if this is the most </span><span class="line" data-startTime="2039">appropriate forum for this </span><span class="line" data-startTime="2043">question, but I've always </span><span class="line" data-startTime="2043">wondered why every value of </span><span class="line" data-startTime="2046">position triggers a layout when </span><span class="line" data-startTime="2046">most of them don't really </span><span class="line" data-startTime="2052">affect layout that much. </span><span class="line" data-startTime="2053">Like position absolute elements </span><span class="line" data-startTime="2053">don't affect layout </span><span class="line" data-startTime="2056">at all, they're taken </span><span class="line" data-startTime="2056">out of the flow. </span><span class="line" data-startTime="2059">Position relative elements, </span><span class="line" data-startTime="2059">they seem to behave quite </span><span class="line" data-startTime="2063">similarly to an element that </span><span class="line" data-startTime="2063">has been translated using </span><span class="line" data-startTime="2066">transforms. </span><span class="line" data-startTime="2066">And of course, fixed elements </span><span class="line" data-startTime="2066">are in their own world. </span><span class="line" data-startTime="2070">So why do these trigger </span><span class="line" data-startTime="2070">a layout? </span></p>

<p class="speaker"><span class="line" data-starttime="2072"><span class="speakerName">Chelsea Derrick</span>: Yes. </span> <span class="line" data-startTime="2072">That's a great question, and </span><span class="line" data-startTime="2072">definitely one of the places </span><span class="line" data-startTime="2075">that browsers have </span><span class="line" data-startTime="2075">a long way to go. </span> <span class="line" data-startTime="2078">We shouldn't have to </span><span class="line" data-startTime="2078">think about this. </span> <span class="line" data-startTime="2080">If I don't have any children and </span><span class="line" data-startTime="2080">I'm just a square on the </span><span class="line" data-startTime="2082">page and you move my left edge, </span><span class="line" data-startTime="2082">it shouldn't affect </span><span class="line" data-startTime="2084">anything else. </span> <span class="line" data-startTime="2085">Why are you wasting the time? </span><span class="line" data-startTime="2087">It's sort of a result of the </span><span class="line" data-startTime="2087">fact that left can sometimes </span><span class="line" data-startTime="2092">have an effect, and it's better </span><span class="line" data-startTime="2092">to waste a little time </span><span class="line" data-startTime="2095">and make sure you're 100% </span><span class="line" data-startTime="2095">accurate rather than to try to </span><span class="line" data-startTime="2098">prematurely optimize. </span> <span class="line" data-startTime="2100">Now, I say the web </span><span class="line" data-startTime="2100">is pretty old. </span> <span class="line" data-startTime="2102">It's not premature anymore. </span> <span class="line" data-startTime="2103">It's definitely an area for </span><span class="line" data-startTime="2103">active development, but it's </span><span class="line" data-startTime="2106">hard to do it correctly. </span></p>

<p><span class="line" data-startTime="2108">So those are sort of tagged as </span><span class="line" data-startTime="2108">layout-related properties, and </span><span class="line" data-startTime="2111">so the layouts that they trigger </span><span class="line" data-startTime="2111">are shorter than other </span><span class="line" data-startTime="2114">layouts, but they </span><span class="line" data-startTime="2114">still happen, </span></p>

<p class="speaker"><span class="line" data-starttime="2116"><span class="speakerName">Audience</span>: Got it. </span><span class="line" data-startTime="2116">Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="2117"><span class="speakerName">Chelsea Derrick</span>: Sure. </span></p>

<p class="speaker"><span class="line" data-starttime="2119"><span class="speakerName">Audience</span>: Hi. </span><span class="line" data-startTime="2120">I'm wondering, how does SVG play </span><span class="line" data-startTime="2120">a role, if you know, in </span><span class="line" data-startTime="2126">all this stuff? </span></p>

<p class="speaker"><span class="line" data-starttime="2127"><span class="speakerName">Chelsea Derrick</span>: Yeah, that's </span><span class="line" data-startTime="2127">a great question. </span><span class="line" data-startTime="2128">I myself don't have a ton </span><span class="line" data-startTime="2128">of experience with SVG. </span><span class="line" data-startTime="2131">Right now, SVG, Canvas, </span><span class="line" data-startTime="2131">HTML, these are all </span><span class="line" data-startTime="2134">very divorced concepts. </span><span class="line" data-startTime="2136">They don't share a common layer </span><span class="line" data-startTime="2136">underneath anything. </span><span class="line" data-startTime="2140">There's a lot of work being </span><span class="line" data-startTime="2140">done right now. </span><span class="line" data-startTime="2142">Actually, there's a Chrome team </span><span class="line" data-startTime="2142">in Google who's working </span><span class="line" data-startTime="2146">on a spec for animations that </span><span class="line" data-startTime="2146">will have a common layer </span><span class="line" data-startTime="2150">underneath all of these </span><span class="line" data-startTime="2150">things, but </span><span class="line" data-startTime="2151">we're not there yet. </span><span class="line" data-startTime="2152">So they're all completely </span><span class="line" data-startTime="2152">separate code </span><span class="line" data-startTime="2154">branches at the moment. </span><span class="line" data-startTime="2155">So things that are going to </span><span class="line" data-startTime="2155">work on HTML and CSS don't </span><span class="line" data-startTime="2158">necessarily work on </span><span class="line" data-startTime="2158">SVG or Canvas. </span></p>

<p class="speaker"><span class="line" data-starttime="2162"><span class="speakerName">Audience</span>: Thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="2164"><span class="speakerName">Chelsea Derrick</span>: All right. </span><span class="line" data-startTime="2165">We'll see if anyone happened to </span><span class="line" data-startTime="2165">be live streaming and asked </span><span class="line" data-startTime="2168">me questions. </span><span class="line" data-startTime="2169">Sweet. </span><span class="line" data-startTime="2171">I was kind of worried </span><span class="line" data-startTime="2171">that it was going to </span><span class="line" data-startTime="2172">be unmoderated content. </span><span class="line" data-startTime="2177">Are there any other questions? </span><span class="line" data-startTime="2179">All right. </span><span class="line" data-startTime="2179">Thank you so much </span><span class="line" data-startTime="2179">for attending. </span><span class="line" data-startTime="2181">[APPLAUSE] </span></p></div>