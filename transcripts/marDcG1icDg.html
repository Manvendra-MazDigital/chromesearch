<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Google I/O 2013 &mdash; Keys to the Kingdom: Design Patterns for Using OAuth in the Cloud</h1>

<h2>Adam Eijdenberg</h2>

<a class="video" href="http://youtu.be/marDcG1icDg">youtu.be/marDcG1icDg</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="1"><span class="speakerName">Adam Eijdenberg</span>: Thank </span><span class="line" data-startTime="1">you, everyone, </span><span class="line" data-startTime="1">for coming this morning. </span><span class="line" data-startTime="3">Clearly the party last night </span><span class="line" data-startTime="3">mustn't have been as good as </span><span class="line" data-startTime="6">the night before, because we </span><span class="line" data-startTime="6">have a lot of people here very </span><span class="line" data-startTime="8">early in the morning </span><span class="line" data-startTime="8">for an auth talk. </span><span class="line" data-startTime="9">So thank you for coming. </span><span class="line" data-startTime="10">My name is Adam Eijdenberg. </span><span class="line" data-startTime="12">I'm a product manager on our </span><span class="line" data-startTime="12">Cloud Platform Team. </span><span class="line" data-startTime="14">This is my colleague Ben. </span><span class="line" data-startTime="16">BEN WILEY SITTLER: </span><span class="line" data-startTime="16">I'm Ben Sittler. </span><span class="line" data-startTime="17">I'm an engineer on our </span><span class="line" data-startTime="17">authorization and </span><span class="line" data-startTime="19">authentication team. </span></p>

<p class="speaker"><span class="line" data-starttime="21"><span class="speakerName">Adam Eijdenberg</span>: So before we </span><span class="line" data-startTime="21">get started, maybe just a </span><span class="line" data-startTime="24">quick hands up around </span><span class="line" data-startTime="24">the room. </span> <span class="line" data-startTime="26">Who here gets really excited </span><span class="line" data-startTime="26">about authentication? </span><span class="line" data-startTime="31">Really? </span><span class="line" data-startTime="34">I was going to let you in on a </span><span class="line" data-startTime="34">bit of a secret, which is that </span><span class="line" data-startTime="37">I don't actually get as excited </span><span class="line" data-startTime="37">about authentication </span><span class="line" data-startTime="39">as I do about using the API </span><span class="line" data-startTime="39">that I'm trying to access. </span> <span class="line" data-startTime="42">And I think one of the things </span><span class="line" data-startTime="42">I really want to do today is </span><span class="line" data-startTime="46">show you how easy it is to </span><span class="line" data-startTime="46">be able to get past the </span><span class="line" data-startTime="49">authentication step when using </span><span class="line" data-startTime="49">Cloud Platform and get to </span><span class="line" data-startTime="52">using one of the 60 or so APIs </span><span class="line" data-startTime="52">that Google provides. </span> <span class="line" data-startTime="58">So when I look at a Cloud </span><span class="line" data-startTime="58">platform, I see we have a </span><span class="line" data-startTime="63">number of different areas. </span></p>

<p><span class="line" data-startTime="64">We have services and APIs that </span><span class="line" data-startTime="64">we provide that make it easy </span><span class="line" data-startTime="68">for you to get on with </span><span class="line" data-startTime="68">solving your problem. </span> <span class="line" data-startTime="71">We have services like Cloud </span><span class="line" data-startTime="71">Storage, which is an object </span><span class="line" data-startTime="74">[INAUDIBLE]. </span> <span class="line" data-startTime="75">We have Cloud SQL. </span> <span class="line" data-startTime="77">We have Cloud NoSQL. </span> <span class="line" data-startTime="79">Two different ways of storing </span><span class="line" data-startTime="79">data and manipulating that </span><span class="line" data-startTime="82">from within your application. </span> <span class="line" data-startTime="84">We have things like Big Query, </span><span class="line" data-startTime="84">which is a great way of </span><span class="line" data-startTime="86">manipulating huge amounts of </span><span class="line" data-startTime="86">data and running query and </span><span class="line" data-startTime="88">getting [? business ?] </span><span class="line" data-startTime="88">intelligence out of that. </span> <span class="line" data-startTime="91">But now I look, and I see a </span><span class="line" data-startTime="91">second half of what we have. </span> <span class="line" data-startTime="93">We have a number of containers </span><span class="line" data-startTime="93">where you can write code. </span></p>

<p><span class="line" data-startTime="97">We have App Engine, which is </span><span class="line" data-startTime="97">the platform as a service </span><span class="line" data-startTime="99">offering, and we have Compute </span><span class="line" data-startTime="99">Engine, which is our </span><span class="line" data-startTime="101">infrastructure as a </span><span class="line" data-startTime="101">service offering. </span> <span class="line" data-startTime="103">App Engine lets you write code </span><span class="line" data-startTime="103">and automatically take care of </span><span class="line" data-startTime="105">scaling that and building a </span><span class="line" data-startTime="105">great web application for you. </span> <span class="line" data-startTime="108">Compute Engine gives you virtual </span><span class="line" data-startTime="108">machines, so you can </span><span class="line" data-startTime="110">write your own code and </span><span class="line" data-startTime="110">do it your own way. </span> <span class="line" data-startTime="113">But what we don't see on this </span><span class="line" data-startTime="113">diagram &mdash; and it is a very </span><span class="line" data-startTime="116">pretty diagram. </span> <span class="line" data-startTime="117">It came from our marketing </span><span class="line" data-startTime="118">department, and they actually &mdash; </span><span class="line" data-startTime="119">I actually learned a </span><span class="line" data-startTime="119">new word this week. </span> <span class="line" data-startTime="121">They called it a marketecture </span><span class="line" data-startTime="121">diagram, and that was a new </span><span class="line" data-startTime="124">one for me. </span> <span class="line" data-startTime="125">But what we don't see on here </span><span class="line" data-startTime="125">is, I think, the glue that </span><span class="line" data-startTime="128">holds this together, which </span><span class="line" data-startTime="128">is authentication and </span><span class="line" data-startTime="130">authorization, which is how </span><span class="line" data-startTime="130">you identify the code that </span><span class="line" data-startTime="135">you're running to the rest </span><span class="line" data-startTime="135">of Google services. </span></p>

<p><span class="line" data-startTime="137">So whether you're running your </span><span class="line" data-startTime="137">code within our platform on </span><span class="line" data-startTime="140">App Engine or Compute Engine, </span><span class="line" data-startTime="140">or you're running your code </span><span class="line" data-startTime="143">under your desk, or whether </span><span class="line" data-startTime="143">you're running it on premise </span><span class="line" data-startTime="146">or if you're running it on </span><span class="line" data-startTime="146">another service provider. </span> <span class="line" data-startTime="149">And so what we're going to </span><span class="line" data-startTime="149">go through today is the </span><span class="line" data-startTime="151">authentication part. </span> <span class="line" data-startTime="152">How to identify your code to </span><span class="line" data-startTime="152">Google so that you can use our </span><span class="line" data-startTime="155">APIs and you can get on with </span><span class="line" data-startTime="155">building the application that </span><span class="line" data-startTime="157">you're trying to [INAUDIBLE]. </span> <span class="line" data-startTime="161">Now, we say auth a lot, and </span><span class="line" data-startTime="161">auth can mean a lot of </span><span class="line" data-startTime="164">different things to </span><span class="line" data-startTime="164">different people. </span> <span class="line" data-startTime="165">I split into two areas &mdash; </span><span class="line" data-startTime="167">authentication and </span><span class="line" data-startTime="167">authorization. </span> <span class="line" data-startTime="170">So authentication, to me, is </span><span class="line" data-startTime="170">knowing who you are, whether </span><span class="line" data-startTime="173">that's a person logging into </span><span class="line" data-startTime="173">an application, or whether </span><span class="line" data-startTime="176">that's your application </span><span class="line" data-startTime="176">making a call </span><span class="line" data-startTime="178">against one of our APIs. </span></p>

<p><span class="line" data-startTime="180">Today, we're going to go </span><span class="line" data-startTime="180">through, we're going to show </span><span class="line" data-startTime="181">you how to write code to </span><span class="line" data-startTime="181">authenticate against our APIs. </span> <span class="line" data-startTime="185">We're going to show you easy </span><span class="line" data-startTime="185">ways to do it using our client </span><span class="line" data-startTime="187">libraries, but we're also going </span><span class="line" data-startTime="187">to show you how to do it </span><span class="line" data-startTime="190">from first principles. </span> <span class="line" data-startTime="191">So if you're not using one of </span><span class="line" data-startTime="191">our client libraries, and you </span><span class="line" data-startTime="193">actually really want to </span><span class="line" data-startTime="193">understand what's going on </span><span class="line" data-startTime="195">behind the scenes, we're </span><span class="line" data-startTime="195">going to show you </span><span class="line" data-startTime="196">how to do that, too. </span> <span class="line" data-startTime="198">We're going to look at how to </span><span class="line" data-startTime="198">do that from within the App </span><span class="line" data-startTime="201">Engine, within Compute Engine. </span></p>

<p><span class="line" data-startTime="202">We have some special tricks </span><span class="line" data-startTime="202">there that make it very easy. </span> <span class="line" data-startTime="205">And we're going to show you how </span><span class="line" data-startTime="205">to do that from anywhere </span><span class="line" data-startTime="207">else, whether it's under your </span><span class="line" data-startTime="207">desk on premise or on another </span><span class="line" data-startTime="210">hosting provider. </span> <span class="line" data-startTime="212">The second part of auth that </span><span class="line" data-startTime="212">we're going to talk about is </span><span class="line" data-startTime="214">authorization. </span> <span class="line" data-startTime="215">And authorization &mdash; </span><span class="line" data-startTime="217">I always think of that </span><span class="line" data-startTime="217">as the second step. </span> <span class="line" data-startTime="218">Now we know who you are. </span> <span class="line" data-startTime="220">Are you allowed to perform </span><span class="line" data-startTime="220">the action that </span><span class="line" data-startTime="222">you're trying to do? </span><span class="line" data-startTime="223">So are you allowed to start </span><span class="line" data-startTime="223">this virtual machine? </span><span class="line" data-startTime="225">Are you allowed to read </span><span class="line" data-startTime="225">this particular </span><span class="line" data-startTime="226">file in Cloud Storage? </span><span class="line" data-startTime="228">We're going to spend some time </span><span class="line" data-startTime="228">on that today, but we're not </span><span class="line" data-startTime="230">going to spend as much time. </span></p>

<p><span class="line" data-startTime="231">The authorization part is </span><span class="line" data-startTime="231">primarily configuration. </span> <span class="line" data-startTime="235">It's not as complicated. </span> <span class="line" data-startTime="236">There aren't as many spots that </span><span class="line" data-startTime="236">you can go wrong there. </span> <span class="line" data-startTime="239">But what I want to show today </span><span class="line" data-startTime="239">is how to set that up and go </span><span class="line" data-startTime="242">through some of the common </span><span class="line" data-startTime="242">pitfalls I see when people are </span><span class="line" data-startTime="244">trying to do this and when </span><span class="line" data-startTime="244">they're having difficulty </span><span class="line" data-startTime="246">accessing our APIs. </span> <span class="line" data-startTime="250">So I thought maybe first, let's </span><span class="line" data-startTime="250">look at what goes into </span><span class="line" data-startTime="253">making an API call against </span><span class="line" data-startTime="253">a Google hosted API. </span> <span class="line" data-startTime="256">The good news is, we host all </span><span class="line" data-startTime="256">of our APIs in the same spot </span><span class="line" data-startTime="259">at Google, which means that once </span><span class="line" data-startTime="259">you figure out how to do </span><span class="line" data-startTime="262">this once &mdash; once you master this </span><span class="line" data-startTime="262">in one spot &mdash; you can hit </span><span class="line" data-startTime="264">any of our other APIs </span><span class="line" data-startTime="264">the same way. </span></p>

<p><span class="line" data-startTime="268">So let's look at, say, </span><span class="line" data-startTime="268">the Big Query API. </span> <span class="line" data-startTime="271">So those of you that don't know </span><span class="line" data-startTime="271">what Big Query is, it's a </span><span class="line" data-startTime="274">way of uploading a huge amount </span><span class="line" data-startTime="274">of data &mdash; gigabytes, hundreds </span><span class="line" data-startTime="278">of gigabytes of data &mdash; into </span><span class="line" data-startTime="278">Google, and running big </span><span class="line" data-startTime="282">queries against those SQL-like </span><span class="line" data-startTime="282">statements to get </span><span class="line" data-startTime="284">results very quickly. </span> <span class="line" data-startTime="286">I'm not going to focus on what </span><span class="line" data-startTime="286">Big Query does, but what I am </span><span class="line" data-startTime="288">going to focus on is how to </span><span class="line" data-startTime="288">make an API call that. </span> <span class="line" data-startTime="291">And with Big Query, one of the </span><span class="line" data-startTime="291">primary entities that you </span><span class="line" data-startTime="295">operate on are data sets. </span> <span class="line" data-startTime="297">You upload data sets into a </span><span class="line" data-startTime="297">project that you own, and </span><span class="line" data-startTime="299">those are resources that </span><span class="line" data-startTime="299">you then manipulate. </span> <span class="line" data-startTime="303">So let's look at an API call to </span><span class="line" data-startTime="303">list the data sets that I </span><span class="line" data-startTime="305">have associated with </span><span class="line" data-startTime="305">the project. </span> <span class="line" data-startTime="308">All of our API calls are HTTP, </span><span class="line" data-startTime="308">or more accurately, HTTPS. </span> <span class="line" data-startTime="312">And when we make that API call, </span><span class="line" data-startTime="312">we either do a get or a </span><span class="line" data-startTime="315">post or another type of </span><span class="line" data-startTime="315">HTTP verb, and we </span><span class="line" data-startTime="317">specify a number of things. </span> <span class="line" data-startTime="319">We specify the API that </span><span class="line" data-startTime="319">we want to hit &mdash; in </span><span class="line" data-startTime="322">this case, Big Query. </span></p>

<p><span class="line" data-startTime="323">We support multiple </span><span class="line" data-startTime="323">versions of APIs. </span> <span class="line" data-startTime="325">So here, we're accessing </span><span class="line" data-startTime="325">version 2 of </span><span class="line" data-startTime="327">the Big Query API. </span> <span class="line" data-startTime="330">The rest of the path that we </span><span class="line" data-startTime="330">have here will vary a little </span><span class="line" data-startTime="333">bit by service. </span> <span class="line" data-startTime="334">But a fairly common pattern we </span><span class="line" data-startTime="334">see within the Cloud Platform </span><span class="line" data-startTime="338">Services is we're manipulating </span><span class="line" data-startTime="338">resources </span><span class="line" data-startTime="341">that belong to a project. </span> <span class="line" data-startTime="342">So typically, you would see the </span><span class="line" data-startTime="342">word project somewhere in </span><span class="line" data-startTime="345">that path. then you'll see an </span><span class="line" data-startTime="345">identifier for that project </span><span class="line" data-startTime="347">and that path. </span> <span class="line" data-startTime="349">In this case, I can see project </span><span class="line" data-startTime="349">number 1, 2, 3, 4, and </span><span class="line" data-startTime="353">I would try to list </span><span class="line" data-startTime="353">the data sets </span><span class="line" data-startTime="354">associated with this project. </span></p>

<p><span class="line" data-startTime="357">We go against a common host &mdash; </span><span class="line" data-startTime="357">the googleapis.com server. </span> <span class="line" data-startTime="361">And now, the interesting bit. </span> <span class="line" data-startTime="362">We have this authorization </span><span class="line" data-startTime="362">header, and that header is all </span><span class="line" data-startTime="366">we need to get right. </span> <span class="line" data-startTime="367">That passes in what we call a </span><span class="line" data-startTime="367">bearer token, and that's a </span><span class="line" data-startTime="369">token that will then allow us to </span><span class="line" data-startTime="369">access that particular API. </span> <span class="line" data-startTime="374">So the focus today in our </span><span class="line" data-startTime="374">presentation is going to be </span><span class="line" data-startTime="376">how to acquire one of those </span><span class="line" data-startTime="376">access tokens so that you can </span><span class="line" data-startTime="379">make that API call, because </span><span class="line" data-startTime="379">the rest of the API call's </span><span class="line" data-startTime="381">fairly simple. </span> <span class="line" data-startTime="382">It's basic HTTP. </span></p>

<p><span class="line" data-startTime="383">Again, we have client libraries </span><span class="line" data-startTime="383">for it, but we're </span><span class="line" data-startTime="385">going to show you how to do it </span><span class="line" data-startTime="385">from first principle as well. </span> <span class="line" data-startTime="389">So let's look at what one of </span><span class="line" data-startTime="389">those tokens is to us. </span> <span class="line" data-startTime="393">We call it an access token </span><span class="line" data-startTime="393">behind the scenes, and when I </span><span class="line" data-startTime="396">think about access tokens, to </span><span class="line" data-startTime="396">me, this is very much like an </span><span class="line" data-startTime="400">HTTP session cookie. </span> <span class="line" data-startTime="401">You go through some kind of </span><span class="line" data-startTime="401">dance to set it, we return it </span><span class="line" data-startTime="404">back, and then you staple that </span><span class="line" data-startTime="404">to each of your requests that </span><span class="line" data-startTime="407">you send to us. </span> <span class="line" data-startTime="408">And when we get one of those </span><span class="line" data-startTime="408">access tokens, we look up, </span><span class="line" data-startTime="411">essentially, three pieces </span><span class="line" data-startTime="411">of information. </span> <span class="line" data-startTime="414">We authenticate we know </span><span class="line" data-startTime="414">what application is </span><span class="line" data-startTime="417">associated with this call. </span> <span class="line" data-startTime="420">What that means is that when you </span><span class="line" data-startTime="420">want to make an API call </span><span class="line" data-startTime="422">against Google, you first must </span><span class="line" data-startTime="422">register the application that </span><span class="line" data-startTime="425">you're building. </span></p>

<p><span class="line" data-startTime="426">Now, application doesn't mean </span><span class="line" data-startTime="426">an Android app or a web app. </span> <span class="line" data-startTime="430">This could just be a process </span><span class="line" data-startTime="430">running under your desk. </span> <span class="line" data-startTime="432">But you register an application </span><span class="line" data-startTime="432">as that </span><span class="line" data-startTime="435">application that is </span><span class="line" data-startTime="435">making that call. </span> <span class="line" data-startTime="437">We also refer to that fairly </span><span class="line" data-startTime="437">synonymously as the client </span><span class="line" data-startTime="440">that is associated with </span><span class="line" data-startTime="440">that request. </span> <span class="line" data-startTime="443">The second bit of information </span><span class="line" data-startTime="443">that we have associated with </span><span class="line" data-startTime="445">the token is a user. </span> <span class="line" data-startTime="447">So when you're making a request, </span><span class="line" data-startTime="447">you may be making it </span><span class="line" data-startTime="450">on behalf of a user, or the </span><span class="line" data-startTime="450">application might be </span><span class="line" data-startTime="453">acting on its own. </span></p>

<p><span class="line" data-startTime="455">And I'll give you an </span><span class="line" data-startTime="455">example of that. </span> <span class="line" data-startTime="457">Let's say that we're accessing </span><span class="line" data-startTime="457">Google Drive. </span> <span class="line" data-startTime="460">Google Drive is a consumer </span><span class="line" data-startTime="460">product, but we have APIs go </span><span class="line" data-startTime="464">through the same infrastructure </span><span class="line" data-startTime="464">so that you can </span><span class="line" data-startTime="466">register an application, allow </span><span class="line" data-startTime="466">the user to click through a </span><span class="line" data-startTime="469">consent screen, and then your </span><span class="line" data-startTime="469">application can access their </span><span class="line" data-startTime="473">data and their drive. </span> <span class="line" data-startTime="475">And so that's a case where you </span><span class="line" data-startTime="475">have a client that is acting </span><span class="line" data-startTime="478">on behalf of a user. </span> <span class="line" data-startTime="479">That's not the typical pattern </span><span class="line" data-startTime="479">that we see in Cloud. </span> <span class="line" data-startTime="483">In Cloud, typically you are </span><span class="line" data-startTime="483">building applications. </span> <span class="line" data-startTime="485">You're building that on top of </span><span class="line" data-startTime="485">our platform, on top of our </span><span class="line" data-startTime="487">infrastructure. </span></p>

<p><span class="line" data-startTime="489">And you might have your own set </span><span class="line" data-startTime="489">of users, you might not </span><span class="line" data-startTime="491">have any users, you might just </span><span class="line" data-startTime="491">have an application that is </span><span class="line" data-startTime="493">doing analysis with Big Query. </span> <span class="line" data-startTime="495">So in this particular case, for </span><span class="line" data-startTime="495">a typical Cloud Platform </span><span class="line" data-startTime="497">API, your user is your </span><span class="line" data-startTime="497">application. </span> <span class="line" data-startTime="500">One and the same thing. </span> <span class="line" data-startTime="503">The third bit of information </span><span class="line" data-startTime="503">that we have associated with </span><span class="line" data-startTime="505">an access token is one </span><span class="line" data-startTime="505">or more scopes. </span> <span class="line" data-startTime="508">When you get an access token, </span><span class="line" data-startTime="508">it's not an all powerful being </span><span class="line" data-startTime="512">that lets you do anything </span><span class="line" data-startTime="512">against any API. </span> <span class="line" data-startTime="515">When you get that access token, </span><span class="line" data-startTime="515">you request that we </span><span class="line" data-startTime="519">downscope it to let </span><span class="line" data-startTime="519">you perform a </span><span class="line" data-startTime="521">certain set of actions. </span></p>

<p><span class="line" data-startTime="522">So, for example, when we had </span><span class="line" data-startTime="522">the user clicking through a </span><span class="line" data-startTime="525">consent screen to access Google </span><span class="line" data-startTime="525">Drive, they're not </span><span class="line" data-startTime="528">authorizing your application </span><span class="line" data-startTime="528">to access their Gmail. </span> <span class="line" data-startTime="531">They're only authorizing your </span><span class="line" data-startTime="531">application to access the </span><span class="line" data-startTime="534">Google Drive content. </span> <span class="line" data-startTime="535">And in the same way, because we </span><span class="line" data-startTime="535">use the same architecture </span><span class="line" data-startTime="538">within Cloud, when you get an </span><span class="line" data-startTime="538">access token to talk to Big </span><span class="line" data-startTime="540">Query, if you accidentally leak </span><span class="line" data-startTime="540">that token, you can't </span><span class="line" data-startTime="544">just magically use that to start </span><span class="line" data-startTime="544">virtual machines in a </span><span class="line" data-startTime="546">project, unless you requested </span><span class="line" data-startTime="546">virtual machine scope when you </span><span class="line" data-startTime="549">started at the same time. </span> <span class="line" data-startTime="553">So how do we get one </span><span class="line" data-startTime="553">of these tokens? </span><span class="line" data-startTime="556">This can vary depending on whose </span><span class="line" data-startTime="556">data is being accessed. </span></p>

<p><span class="line" data-startTime="558">Again, the first case where </span><span class="line" data-startTime="558">we have user data &mdash; </span><span class="line" data-startTime="562">how do we get that? </span><span class="line" data-startTime="564">We register an application, we </span><span class="line" data-startTime="564">write some magic code, we pop </span><span class="line" data-startTime="568">up a user consent screen, the </span><span class="line" data-startTime="568">user consents to allow you to </span><span class="line" data-startTime="571">access the data on a certain </span><span class="line" data-startTime="571">spot, and you get back an </span><span class="line" data-startTime="573">access token. </span> <span class="line" data-startTime="574">I'm not going to talk through </span><span class="line" data-startTime="574">that in any detail today. </span> <span class="line" data-startTime="577">That's not going to be </span><span class="line" data-startTime="577">the focus today. </span> <span class="line" data-startTime="579">We have a heap of sessions on </span><span class="line" data-startTime="579">Sign In with G+, which is </span><span class="line" data-startTime="582">built on top of this same behind </span><span class="line" data-startTime="582">the scenes flow, and we </span><span class="line" data-startTime="585">have a lot of other resources </span><span class="line" data-startTime="585">there that I could </span><span class="line" data-startTime="587">point you to later. </span> <span class="line" data-startTime="588">What I'm going to focus on today </span><span class="line" data-startTime="588">is how to help you build </span><span class="line" data-startTime="591">your application on top of Cloud </span><span class="line" data-startTime="591">Platform, and how to get </span><span class="line" data-startTime="594">an access token for your </span><span class="line" data-startTime="594">application, where there is no </span><span class="line" data-startTime="597">user present to agree </span><span class="line" data-startTime="597">to a consent screen. </span></p>

<p><span class="line" data-startTime="600">You need a way of getting </span><span class="line" data-startTime="600">credentials so that your </span><span class="line" data-startTime="602">application can then talk to </span><span class="line" data-startTime="602">Google and access APIs to </span><span class="line" data-startTime="605">manipulate your data. </span> <span class="line" data-startTime="609">So there's two parts to this. </span> <span class="line" data-startTime="612">The first part is we need to </span><span class="line" data-startTime="612">create a project and do some </span><span class="line" data-startTime="614">configuration. </span> <span class="line" data-startTime="615">I'm going to go through </span><span class="line" data-startTime="615">and talk about that. </span> <span class="line" data-startTime="617">Then we get to the fun bit. </span> <span class="line" data-startTime="618">Ben's going to then show us how </span><span class="line" data-startTime="618">to write some code to use </span><span class="line" data-startTime="621">the data that we've configured, </span><span class="line" data-startTime="621">and to make that </span><span class="line" data-startTime="623">successful API call. </span> <span class="line" data-startTime="627">So the first thing we </span><span class="line" data-startTime="627">need to do is we </span><span class="line" data-startTime="628">need to create a project. </span> <span class="line" data-startTime="629">And a project is an entity that </span><span class="line" data-startTime="629">basically represents your </span><span class="line" data-startTime="636">relationship as a developer with </span><span class="line" data-startTime="636">Google for the context of </span><span class="line" data-startTime="639">what you're trying to do. </span> <span class="line" data-startTime="641">So when we create a project, I </span><span class="line" data-startTime="641">think of this as a container </span><span class="line" data-startTime="645">for a number of things. </span> <span class="line" data-startTime="646">It's a container for resources </span><span class="line" data-startTime="646">that will belong to y our </span><span class="line" data-startTime="648">application. </span></p>

<p><span class="line" data-startTime="649">So, for example, if you're using </span><span class="line" data-startTime="649">Cloud Storage, you'll be </span><span class="line" data-startTime="652">creating buckets. </span> <span class="line" data-startTime="653">Those buckets are associated </span><span class="line" data-startTime="653">with a project. </span> <span class="line" data-startTime="655">That project, ultimately, will </span><span class="line" data-startTime="655">get the bill for the usage of </span><span class="line" data-startTime="657">those buckets. </span> <span class="line" data-startTime="658">Similarly, when you create </span><span class="line" data-startTime="658">virtual machines, they're </span><span class="line" data-startTime="660">associated with the project. </span> <span class="line" data-startTime="662">When you upload Big Query data </span><span class="line" data-startTime="662">sets, they're are associated </span><span class="line" data-startTime="665">with the project. </span> <span class="line" data-startTime="666">So one key part of what a </span><span class="line" data-startTime="666">project does is access a </span><span class="line" data-startTime="669">container for the resources </span><span class="line" data-startTime="669">that belong to your </span><span class="line" data-startTime="671">application. </span> <span class="line" data-startTime="673">The second key part to what a </span><span class="line" data-startTime="673">project does is this is where </span><span class="line" data-startTime="676">you register an application that </span><span class="line" data-startTime="676">wants to make an API call </span><span class="line" data-startTime="679">against Google. </span> <span class="line" data-startTime="681">And those API calls </span><span class="line" data-startTime="681">aren't limited to </span><span class="line" data-startTime="683">Cloud Platform resources. </span></p>

<p><span class="line" data-startTime="685">Any of the other 60 APIs that </span><span class="line" data-startTime="685">Google provides goes through </span><span class="line" data-startTime="688">the same common area. </span> <span class="line" data-startTime="690">So this is where we will </span><span class="line" data-startTime="690">register our application. </span> <span class="line" data-startTime="692">This is where we will get </span><span class="line" data-startTime="692">credentials that we can then </span><span class="line" data-startTime="694">use to make subsequent </span><span class="line" data-startTime="694">API calls. </span> <span class="line" data-startTime="697">There's also a bunch of other </span><span class="line" data-startTime="697">configuration that lives </span><span class="line" data-startTime="700">within a project. </span> <span class="line" data-startTime="701">We have information there about </span><span class="line" data-startTime="701">billing, if you're using </span><span class="line" data-startTime="703">a service that requires </span><span class="line" data-startTime="703">payment. </span> <span class="line" data-startTime="705">We have information about quota </span><span class="line" data-startTime="705">that may be set up, </span><span class="line" data-startTime="708">either a free quota, or you </span><span class="line" data-startTime="708">can actually specify and </span><span class="line" data-startTime="710">configure a per user quota for </span><span class="line" data-startTime="710">individual users that are </span><span class="line" data-startTime="713">using API on your behalf. </span> <span class="line" data-startTime="716">We also track here &mdash; this </span><span class="line" data-startTime="716">is also where you enter </span><span class="line" data-startTime="719">authorization information. </span> <span class="line" data-startTime="721">And I'll go through that </span><span class="line" data-startTime="721">in more detail later. </span></p>

<p><span class="line" data-startTime="723">But essentially, this is where </span><span class="line" data-startTime="723">you can create a team. </span> <span class="line" data-startTime="726">A project is not tied to </span><span class="line" data-startTime="726">an individual person. </span> <span class="line" data-startTime="728">That's not typically how </span><span class="line" data-startTime="728">developers operate. </span> <span class="line" data-startTime="732">You have other developers that </span><span class="line" data-startTime="732">you're working with. </span> <span class="line" data-startTime="733">You shouldn't have to share </span><span class="line" data-startTime="733">passwords to log in to manage </span><span class="line" data-startTime="737">a common set of resources. </span> <span class="line" data-startTime="738">So this is where you can add </span><span class="line" data-startTime="738">your teammates to your project </span><span class="line" data-startTime="741">and work and collaborate </span><span class="line" data-startTime="741">together. </span> <span class="line" data-startTime="745">So we created a project. </span> <span class="line" data-startTime="746">We gave it a name before. </span> <span class="line" data-startTime="747">The next thing we need to do </span><span class="line" data-startTime="747">is we need to enable these </span><span class="line" data-startTime="750">services that we're interested </span><span class="line" data-startTime="750">in using. </span> <span class="line" data-startTime="752">So here, I'm enabling the </span><span class="line" data-startTime="752">Big Query service. </span></p>

<p><span class="line" data-startTime="755">Now, I should just note, this is </span><span class="line" data-startTime="755">the current what we call a </span><span class="line" data-startTime="759">developer console that we're </span><span class="line" data-startTime="759">looking in through today. </span> <span class="line" data-startTime="763">We have another console that I </span><span class="line" data-startTime="763">think you might have seen some </span><span class="line" data-startTime="766">other screenshots of this week </span><span class="line" data-startTime="766">if you've been through some of </span><span class="line" data-startTime="768">the other Cloud Platform </span><span class="line" data-startTime="768">sessions. </span> <span class="line" data-startTime="770">It's called the Cloud Console. </span> <span class="line" data-startTime="772">These are essentially </span><span class="line" data-startTime="772">equivalent. </span> <span class="line" data-startTime="774">The same functionality is fairly </span><span class="line" data-startTime="774">much present in each. </span> <span class="line" data-startTime="776">Cloud Console is what we're </span><span class="line" data-startTime="776">moving towards for Cloud, but </span><span class="line" data-startTime="779">it's still not quite has all of </span><span class="line" data-startTime="779">the authentication things </span><span class="line" data-startTime="783">that we're going </span><span class="line" data-startTime="783">to show today. </span></p>

<p><span class="line" data-startTime="785">So that's why I'm still </span><span class="line" data-startTime="785">using the old UI. </span> <span class="line" data-startTime="787">If you do use the new UI to </span><span class="line" data-startTime="787">create a project &mdash; and I do </span><span class="line" data-startTime="789">actually recommend doing that, </span><span class="line" data-startTime="789">because it has a nice tie-in </span><span class="line" data-startTime="791">with Google App Engine </span><span class="line" data-startTime="791">that we can talk </span><span class="line" data-startTime="793">about in detail later &mdash; </span><span class="line" data-startTime="795">you can still click back through </span><span class="line" data-startTime="795">to the developer </span><span class="line" data-startTime="797">console and see that data. </span> <span class="line" data-startTime="798">It's stored in the same spot. </span> <span class="line" data-startTime="799">You can manipulate with </span><span class="line" data-startTime="799">either user interface. </span> <span class="line" data-startTime="803">Let's keep going. </span> <span class="line" data-startTime="803">We've enabled the service. </span> <span class="line" data-startTime="806">Now we need to do </span><span class="line" data-startTime="806">something called </span><span class="line" data-startTime="807">create a service account. </span> <span class="line" data-startTime="810">Now, let's think about what </span><span class="line" data-startTime="810">happens when you run a process </span><span class="line" data-startTime="814">on your local workstation. </span> <span class="line" data-startTime="817">You log into your operating </span><span class="line" data-startTime="817">system as a user, and when you </span><span class="line" data-startTime="819">start a process, it's associated </span><span class="line" data-startTime="819">with your user ID. </span> <span class="line" data-startTime="824">What that means is that when you </span><span class="line" data-startTime="824">try and, say, open a file </span><span class="line" data-startTime="828">from within your application, </span><span class="line" data-startTime="828">your operating </span><span class="line" data-startTime="831">system will do a check. </span> <span class="line" data-startTime="833">It knows what file you're trying </span><span class="line" data-startTime="833">to access, it knows </span><span class="line" data-startTime="836">what user the application is </span><span class="line" data-startTime="836">running in, and then it does a </span><span class="line" data-startTime="839">check to make sure that the user </span><span class="line" data-startTime="839">ID has access to the file </span><span class="line" data-startTime="843">that you're reading. </span></p>

<p><span class="line" data-startTime="845">Now, if you were to deploy that </span><span class="line" data-startTime="845">same application into a </span><span class="line" data-startTime="848">production environment, </span><span class="line" data-startTime="848">typically you wouldn't run it </span><span class="line" data-startTime="850">as your personal account. </span> <span class="line" data-startTime="852">You might set up </span><span class="line" data-startTime="852">a role account. </span> <span class="line" data-startTime="854">Let's say you're running </span><span class="line" data-startTime="854">Apache in production. </span> <span class="line" data-startTime="856">You might use the Nobody </span><span class="line" data-startTime="856">account on a box. </span> <span class="line" data-startTime="860">So when you run that </span><span class="line" data-startTime="860">application, you </span><span class="line" data-startTime="862">assign it an identity. </span> <span class="line" data-startTime="863">You might use pseudo and </span><span class="line" data-startTime="863">[INAUDIBLE] and swap it and </span><span class="line" data-startTime="866">run it out as a Nobody user. </span></p>

<p><span class="line" data-startTime="868">Similarly, when you access a </span><span class="line" data-startTime="868">Google API, we need to know </span><span class="line" data-startTime="872">who your application is. </span> <span class="line" data-startTime="875">The user ID associated </span><span class="line" data-startTime="875">with the process &mdash; </span><span class="line" data-startTime="877">that doesn't mean anything to </span><span class="line" data-startTime="877">us, when you're accessing </span><span class="line" data-startTime="880">across the internet </span><span class="line" data-startTime="880">to our services. </span> <span class="line" data-startTime="882">So instead, what we have you do </span><span class="line" data-startTime="882">is we have you assign your </span><span class="line" data-startTime="884">application a service account. </span> <span class="line" data-startTime="887">And a service account is very </span><span class="line" data-startTime="887">similar to a role account. </span> <span class="line" data-startTime="890">It's our way of knowing who </span><span class="line" data-startTime="890">your application is. </span> <span class="line" data-startTime="893">So we have a couple of </span><span class="line" data-startTime="893">different ways of </span><span class="line" data-startTime="894">setting this up. </span> <span class="line" data-startTime="895">We have some neat tricks </span><span class="line" data-startTime="895">[INAUDIBLE] </span><span class="line" data-startTime="897">App Engine, but right now, </span><span class="line" data-startTime="897">we're going to create a </span><span class="line" data-startTime="900">service account that has a </span><span class="line" data-startTime="900">private key that we can then </span><span class="line" data-startTime="902">download and put into our </span><span class="line" data-startTime="902">application to access APIs. </span> <span class="line" data-startTime="908">So the very first time we click </span><span class="line" data-startTime="908">through this flow, we do </span><span class="line" data-startTime="911">get prompted to enter some </span><span class="line" data-startTime="911">branding information about our </span><span class="line" data-startTime="914">application. </span></p>

<p><span class="line" data-startTime="915">This is really useful if we were </span><span class="line" data-startTime="915">accessing one of those </span><span class="line" data-startTime="918">APIs like Drive API, where we </span><span class="line" data-startTime="918">need to pop a consent screen </span><span class="line" data-startTime="921">up to users, and they need to </span><span class="line" data-startTime="921">see some information about who </span><span class="line" data-startTime="924">is this crazy app that's trying </span><span class="line" data-startTime="924">to access my data? </span><span class="line" data-startTime="926">This is completely irrelevant to </span><span class="line" data-startTime="926">the Cloud Platform in terms </span><span class="line" data-startTime="930">of service accounts. </span> <span class="line" data-startTime="931">So skip this screen, fill in the </span><span class="line" data-startTime="931">[INAUDIBLE] field, which </span><span class="line" data-startTime="933">is the name, and </span><span class="line" data-startTime="933">then continue. </span> <span class="line" data-startTime="936">Service accounts, they don't </span><span class="line" data-startTime="936">get consent screens. </span> <span class="line" data-startTime="938">There's no human associated </span><span class="line" data-startTime="938">with it. </span> <span class="line" data-startTime="940">There's nothing for them to </span><span class="line" data-startTime="940">click, so just ignore this </span><span class="line" data-startTime="942">screen and move back on. </span> <span class="line" data-startTime="945">So now we have an opportunity </span><span class="line" data-startTime="945">where we can select what type </span><span class="line" data-startTime="948">of client are we creating, or </span><span class="line" data-startTime="948">what type of application are </span><span class="line" data-startTime="950">we registering? </span><span class="line" data-startTime="952">And here, if I was doing one of </span><span class="line" data-startTime="952">the consent driven flows, I </span><span class="line" data-startTime="955">might pick a web application. </span> <span class="line" data-startTime="958">Because I want a service </span><span class="line" data-startTime="958">account, I want an identity </span><span class="line" data-startTime="960">for my application. </span></p>

<p><span class="line" data-startTime="961">We hit service account, and </span><span class="line" data-startTime="961">then we generate a public </span><span class="line" data-startTime="964">private key on our service. </span> <span class="line" data-startTime="966">We throw away the private </span><span class="line" data-startTime="966">key component. </span> <span class="line" data-startTime="968">Well, we don't throw it away. </span> <span class="line" data-startTime="969">We let you download it, and </span><span class="line" data-startTime="969">then we throw it away. </span> <span class="line" data-startTime="971">We just then keep the public </span><span class="line" data-startTime="971">component off that. </span> <span class="line" data-startTime="974">We give you a file that </span><span class="line" data-startTime="974">you download. </span> <span class="line" data-startTime="975">This is essentially your </span><span class="line" data-startTime="975">password, or your credentials </span><span class="line" data-startTime="978">that you'll use when you access </span><span class="line" data-startTime="978">our services on behalf </span><span class="line" data-startTime="981">of your application. </span> <span class="line" data-startTime="984">We do actually encrypt. </span></p>

<p><span class="line" data-startTime="985">We use a PKCS12 format, which </span><span class="line" data-startTime="985">is an encrypted private key </span><span class="line" data-startTime="989">format, and it has a password </span><span class="line" data-startTime="989">of notasecret. </span> <span class="line" data-startTime="994">So don't tell anyone, but write </span><span class="line" data-startTime="994">that down, and we'll use </span><span class="line" data-startTime="996">that for the next step. </span> <span class="line" data-startTime="1000">When we create that </span><span class="line" data-startTime="1000">service account &mdash; </span><span class="line" data-startTime="1003">they never take screenshots of </span><span class="line" data-startTime="1003">my username that I've created </span><span class="line" data-startTime="1006">on my service account here. </span> <span class="line" data-startTime="1007">But we get an email address </span><span class="line" data-startTime="1007">associated with that as well. </span> <span class="line" data-startTime="1011">And that email address, again, </span><span class="line" data-startTime="1011">is not a human user. </span> <span class="line" data-startTime="1014">Don't try and add that </span><span class="line" data-startTime="1014">to your G+ posts. </span> <span class="line" data-startTime="1016">They don't post very often. </span> <span class="line" data-startTime="1018">But you do need to take note of </span><span class="line" data-startTime="1018">that email address, because </span><span class="line" data-startTime="1020">when we try and set access </span><span class="line" data-startTime="1020">control up later, we use that </span><span class="line" data-startTime="1023">email address to represent </span><span class="line" data-startTime="1023">this is the user that I'm </span><span class="line" data-startTime="1026">trying to access, even though </span><span class="line" data-startTime="1026">that user is an application. </span></p>

<p><span class="line" data-startTime="1030">There are also some options </span><span class="line" data-startTime="1030">here for rotating </span><span class="line" data-startTime="1032">that private key. </span> <span class="line" data-startTime="1033">You can create a new one. </span> <span class="line" data-startTime="1035">So if you do accidentally lose </span><span class="line" data-startTime="1035">that private key file, you can </span><span class="line" data-startTime="1039">create a new one here, and </span><span class="line" data-startTime="1039">then disable the old one. </span> <span class="line" data-startTime="1045">So we talked through how </span><span class="line" data-startTime="1045">to configure a project. </span> <span class="line" data-startTime="1048">We set a project up, we've </span><span class="line" data-startTime="1048">created a service account, </span><span class="line" data-startTime="1050">we've download a private key, </span><span class="line" data-startTime="1050">we have an email address </span><span class="line" data-startTime="1053">associated with it, and now </span><span class="line" data-startTime="1053">we're ready to use it. </span> <span class="line" data-startTime="1056">I'm going to hand off to Ben, </span><span class="line" data-startTime="1056">who's now going to show us how </span><span class="line" data-startTime="1058">to write some code to use </span><span class="line" data-startTime="1058">that service account </span><span class="line" data-startTime="1060">to access an API. </span> <span class="line" data-startTime="1063">BEN WILEY SITTLER: </span><span class="line" data-startTime="1063">Thank you, Adam. </span> <span class="line" data-startTime="1064">So let's get an access token. </span></p>

<p><span class="line" data-startTime="1067">Now, remember that we have an </span><span class="line" data-startTime="1067">email address that represents </span><span class="line" data-startTime="1073">our surface account &mdash; our </span><span class="line" data-startTime="1073">application's identity. </span> <span class="line" data-startTime="1076">We also have an API we're </span><span class="line" data-startTime="1076">trying to access &mdash; </span><span class="line" data-startTime="1078">in this case, Big Query. </span> <span class="line" data-startTime="1080">And for each of the Cloud APIs, </span><span class="line" data-startTime="1080">there's typically a </span><span class="line" data-startTime="1083">scope, or two different scopes, </span><span class="line" data-startTime="1083">for the API &mdash; a full </span><span class="line" data-startTime="1086">access scope and a </span><span class="line" data-startTime="1086">read only scope. </span> <span class="line" data-startTime="1089">For Big Query we'll use </span><span class="line" data-startTime="1089">the full access scope. </span> <span class="line" data-startTime="1091">Now, to actually get an </span><span class="line" data-startTime="1091">access token, we need </span><span class="line" data-startTime="1094">to create an assertion. </span></p>

<p><span class="line" data-startTime="1097">To do this, we created a JSON </span><span class="line" data-startTime="1097">object, which describes who we </span><span class="line" data-startTime="1102">are, what we're asking for, and </span><span class="line" data-startTime="1102">who we're sending this to, </span><span class="line" data-startTime="1105">and how long the assertion </span><span class="line" data-startTime="1105">is good for. </span> <span class="line" data-startTime="1108">We need to make sure that </span><span class="line" data-startTime="1108">someone can't take this </span><span class="line" data-startTime="1109">assertion and replay it later. </span> <span class="line" data-startTime="1113">We then JSON encode this, base </span><span class="line" data-startTime="1113">64, URL safe encode it, strip </span><span class="line" data-startTime="1121">off the equals signs, </span><span class="line" data-startTime="1121">and sign it. </span> <span class="line" data-startTime="1126">The signing uses the key that </span><span class="line" data-startTime="1126">Adam showed you earlier, with </span><span class="line" data-startTime="1130">the password notasecret. </span></p>

<p><span class="line" data-startTime="1135">So in this case, we're going to </span><span class="line" data-startTime="1135">use the open SSL library to </span><span class="line" data-startTime="1139">sign it, reusing RSA to sign </span><span class="line" data-startTime="1139">and a SHA256 signature. </span> <span class="line" data-startTime="1147">And once we append that to our </span><span class="line" data-startTime="1147">earlier assertion, it's ready </span><span class="line" data-startTime="1154">to send to Google. </span> <span class="line" data-startTime="1156">So we send this to </span><span class="line" data-startTime="1156">accounts.google.com, and this </span><span class="line" data-startTime="1163">assertion gives us back </span><span class="line" data-startTime="1163">an access token. </span> <span class="line" data-startTime="1167">It looks like this. </span> <span class="line" data-startTime="1168">Or rather, we get a </span><span class="line" data-startTime="1168">JSON object that </span><span class="line" data-startTime="1170">includes an access token. </span> <span class="line" data-startTime="1174">This, you may notice, </span><span class="line" data-startTime="1174">has an expires_in. </span> <span class="line" data-startTime="1177">This access token, if someone </span><span class="line" data-startTime="1177">else intercepts it, will only </span><span class="line" data-startTime="1181">be good for them for an hour. </span> <span class="line" data-startTime="1183">Of course, you should be using </span><span class="line" data-startTime="1183">SSL everywhere, and make sure </span><span class="line" data-startTime="1186">that no one can intercept it. </span> <span class="line" data-startTime="1187">But regardless, at the end of </span><span class="line" data-startTime="1187">the hour, you'll need to get </span><span class="line" data-startTime="1190">another one. </span> <span class="line" data-startTime="1192">So go ahead. </span></p>

<p><span class="line" data-startTime="1193">Store this in your mem cache. </span> <span class="line" data-startTime="1196">Share it across the instances </span><span class="line" data-startTime="1196">of your application. </span> <span class="line" data-startTime="1199">Create multiple of them </span><span class="line" data-startTime="1199">if you need to. </span> <span class="line" data-startTime="1203">Now, let's use this. </span> <span class="line" data-startTime="1205">To actually access the API, we </span><span class="line" data-startTime="1205">would like to put that access </span><span class="line" data-startTime="1211">token we just got into the HTTP </span><span class="line" data-startTime="1211">authorization header. </span> <span class="line" data-startTime="1215">This is fairly straightforward. </span> <span class="line" data-startTime="1218">We access our project's </span><span class="line" data-startTime="1218">big store data sets, </span><span class="line" data-startTime="1222">and we get back this. </span> <span class="line" data-startTime="1224">Not very exciting, but that is </span><span class="line" data-startTime="1224">not what you were looking for. </span> <span class="line" data-startTime="1227">You were looking for working. </span> <span class="line" data-startTime="1231">Now, this can be even easier. </span> <span class="line" data-startTime="1234">We have client libraries </span><span class="line" data-startTime="1234">for a variety of </span><span class="line" data-startTime="1236">platforms and languages. </span></p>

<p><span class="line" data-startTime="1239">Here, we're going </span><span class="line" data-startTime="1239">to show Python. </span> <span class="line" data-startTime="1240">And in this case, we still need </span><span class="line" data-startTime="1240">those same three pieces </span><span class="line" data-startTime="1244">of information &mdash; </span><span class="line" data-startTime="1245">your service account's email </span><span class="line" data-startTime="1245">address, its private key, and </span><span class="line" data-startTime="1251">the API scope we're </span><span class="line" data-startTime="1251">trying to access. </span> <span class="line" data-startTime="1254">We use the </span><span class="line" data-startTime="1254">SignedJwtAssertionCredentials </span><span class="line" data-startTime="1257">class, and we use this to </span><span class="line" data-startTime="1257">authorize an HTTP object. </span> <span class="line" data-startTime="1262">Now, you may wonder what's </span><span class="line" data-startTime="1262">going on here. </span> <span class="line" data-startTime="1264">What this will give us is an </span><span class="line" data-startTime="1264">HTTP object, as you may </span><span class="line" data-startTime="1267">already be comfortable </span><span class="line" data-startTime="1267">using in Python. </span> <span class="line" data-startTime="1271">But unlike other HTTP objects, </span><span class="line" data-startTime="1271">this one is wrapped and sends </span><span class="line" data-startTime="1275">along that authorization header </span><span class="line" data-startTime="1275">automatically with </span><span class="line" data-startTime="1277">every request. </span> <span class="line" data-startTime="1280">So what do we get back? </span><span class="line" data-startTime="1283">An HTTP object we can use </span><span class="line" data-startTime="1283">to access that same API. </span> <span class="line" data-startTime="1289">And indeed, we get back exactly </span><span class="line" data-startTime="1289">the same answer. </span></p>

<p><span class="line" data-startTime="1292">Perhaps a boring, but </span><span class="line" data-startTime="1292">it works, and </span><span class="line" data-startTime="1295">that's what you want. </span> <span class="line" data-startTime="1297">Now, we also have something </span><span class="line" data-startTime="1297">called the discovery API. </span> <span class="line" data-startTime="1301">The discovery API gives back a </span><span class="line" data-startTime="1301">JSON introspection for each of </span><span class="line" data-startTime="1307">the API versions that </span><span class="line" data-startTime="1307">Google publishes. </span> <span class="line" data-startTime="1310">We have not just Cloud APIs. </span> <span class="line" data-startTime="1312">We have a wide variety </span><span class="line" data-startTime="1312">of APIs, as </span><span class="line" data-startTime="1314">Adam mentioned earlier. </span> <span class="line" data-startTime="1316">But for all of these APIs, this </span><span class="line" data-startTime="1316">discovery API returns the </span><span class="line" data-startTime="1320">methods, the parameters, and </span><span class="line" data-startTime="1320">how to encode the requests, </span><span class="line" data-startTime="1323">and how to read back </span><span class="line" data-startTime="1323">the responses. </span> <span class="line" data-startTime="1327">In this case, we are looking for </span><span class="line" data-startTime="1327">the data sets API from Big </span><span class="line" data-startTime="1331">Query, and in particular, we're </span><span class="line" data-startTime="1331">looking for the list </span><span class="line" data-startTime="1336">method with the project </span><span class="line" data-startTime="1336">ID mentioned earlier. </span> <span class="line" data-startTime="1340">And note that once you call </span><span class="line" data-startTime="1340">that list method, you're </span><span class="line" data-startTime="1343">getting back a request object. </span></p>

<p><span class="line" data-startTime="1345">But nothing has actually been </span><span class="line" data-startTime="1345">sent to a server yet. </span> <span class="line" data-startTime="1347">For that, you need </span><span class="line" data-startTime="1347">to call execute. </span> <span class="line" data-startTime="1348">And here is where special </span><span class="line" data-startTime="1348">HTTP object comes in. </span> <span class="line" data-startTime="1351">When we call execute, we pass in </span><span class="line" data-startTime="1351">our decorated HTTP object, </span><span class="line" data-startTime="1356">and this means the request </span><span class="line" data-startTime="1356">will be executed with the </span><span class="line" data-startTime="1358">authorization header. </span> <span class="line" data-startTime="1361">Indeed, response is as before. </span> <span class="line" data-startTime="1365">Now, we also have Google </span><span class="line" data-startTime="1365">hosted environments. </span> <span class="line" data-startTime="1369">I'm sure you've all heard of App </span><span class="line" data-startTime="1369">Engine and Compute Engine. </span> <span class="line" data-startTime="1372">And we can make this </span><span class="line" data-startTime="1372">even easier. </span> <span class="line" data-startTime="1376">Remember earlier, we had three </span><span class="line" data-startTime="1376">pieces of information. </span> <span class="line" data-startTime="1381">Adam's going to tell you more </span><span class="line" data-startTime="1381">about how we use this. </span> <span class="line" data-startTime="1383">ADAM EIJDENBERG: </span><span class="line" data-startTime="1383">Thank you, Ben. </span></p>

<p><span class="line" data-startTime="1384">So what Ben's gone through and </span><span class="line" data-startTime="1384">shown us is how to use that </span><span class="line" data-startTime="1387">private key that we created </span><span class="line" data-startTime="1387">before, and how to then use </span><span class="line" data-startTime="1390">that to generate what we call an </span><span class="line" data-startTime="1390">assertion, and then how to </span><span class="line" data-startTime="1393">sign that assertion with </span><span class="line" data-startTime="1393">that private key, </span><span class="line" data-startTime="1395">send that to Google &mdash; </span><span class="line" data-startTime="1396">now we have an access token. </span> <span class="line" data-startTime="1398">We're ready for business. </span> <span class="line" data-startTime="1398">Once we have that access token, </span><span class="line" data-startTime="1398">we can hit those APIs. </span> <span class="line" data-startTime="1403">We can do exactly the same thing </span><span class="line" data-startTime="1403">in Compute Engine and </span><span class="line" data-startTime="1406">Google App Engine. </span> <span class="line" data-startTime="1407">The neat thing about Compute </span><span class="line" data-startTime="1407">Engine and App Engine is they </span><span class="line" data-startTime="1410">are already running on Google's </span><span class="line" data-startTime="1410">infrastructure. </span> <span class="line" data-startTime="1412">Because they're running in </span><span class="line" data-startTime="1412">our data center on our </span><span class="line" data-startTime="1414">infrastructure, we know </span><span class="line" data-startTime="1414">who they are. </span></p>

<p><span class="line" data-startTime="1416">We can prove that that app is </span><span class="line" data-startTime="1416">your app, and that app is </span><span class="line" data-startTime="1421">belonging to another project. </span> <span class="line" data-startTime="1422">We know this. </span> <span class="line" data-startTime="1423">And so what that means is that </span><span class="line" data-startTime="1423">we still use a surface account </span><span class="line" data-startTime="1426">to access APIs, but we use a </span><span class="line" data-startTime="1426">surface account that has built </span><span class="line" data-startTime="1429">credentials. </span> <span class="line" data-startTime="1430">So what that means is that </span><span class="line" data-startTime="1430">when you start a Compute </span><span class="line" data-startTime="1433">Engine virtual machine, you can </span><span class="line" data-startTime="1433">tell it to use a surface </span><span class="line" data-startTime="1437">account, and here are the </span><span class="line" data-startTime="1437">scopes that I want. </span> <span class="line" data-startTime="1440">And then from within that </span><span class="line" data-startTime="1440">virtual machine, we can make </span><span class="line" data-startTime="1442">access tokens available directly </span><span class="line" data-startTime="1442">to your application </span><span class="line" data-startTime="1445">without ever needing to </span><span class="line" data-startTime="1445">see a private key. </span></p>

<p><span class="line" data-startTime="1448">And exactly the same </span><span class="line" data-startTime="1448">with an App Engine. </span> <span class="line" data-startTime="1449">When you create an App Engine </span><span class="line" data-startTime="1449">app, we create a service </span><span class="line" data-startTime="1452">account associated with that App </span><span class="line" data-startTime="1452">Engine app, and then you </span><span class="line" data-startTime="1455">can use that. </span> <span class="line" data-startTime="1455">You can add that to access </span><span class="line" data-startTime="1455">control lists for other </span><span class="line" data-startTime="1457">services and other projects, </span><span class="line" data-startTime="1457">and then you can get access </span><span class="line" data-startTime="1460">tokens for that straightaway. </span> <span class="line" data-startTime="1462">And so Ben's going to now </span><span class="line" data-startTime="1462">show us how to do that. </span> <span class="line" data-startTime="1465">BEN WILEY SITTLER: </span><span class="line" data-startTime="1465">Thank you, Adam. </span> <span class="line" data-startTime="1467">So let's start with </span><span class="line" data-startTime="1467">App Engine. </span> <span class="line" data-startTime="1470">Now, before, remember, we </span><span class="line" data-startTime="1470">needed three pieces of </span><span class="line" data-startTime="1472">information. </span> <span class="line" data-startTime="1473">We needed the email address for </span><span class="line" data-startTime="1473">our service account, we </span><span class="line" data-startTime="1476">needed a private key, and </span><span class="line" data-startTime="1476">we needed an API scope. </span> <span class="line" data-startTime="1479">Only the last one </span><span class="line" data-startTime="1479">is needed here. </span></p>

<p><span class="line" data-startTime="1483">We use the App Identity API </span><span class="line" data-startTime="1483">to get an access token. </span> <span class="line" data-startTime="1487">You notice we did not </span><span class="line" data-startTime="1487">sign an assertion. </span> <span class="line" data-startTime="1490">We didn't have to make </span><span class="line" data-startTime="1490">an HTTP request to </span><span class="line" data-startTime="1492">get our access token. </span> <span class="line" data-startTime="1494">This is all handled for </span><span class="line" data-startTime="1494">us by App Engine. </span> <span class="line" data-startTime="1498">Now, our client libraries </span><span class="line" data-startTime="1498">also make this easy. </span> <span class="line" data-startTime="1502">You can use the app assertion </span><span class="line" data-startTime="1502">credentials class to get the </span><span class="line" data-startTime="1506">same effect, and this gets you </span><span class="line" data-startTime="1506">back a decorated HTTP object </span><span class="line" data-startTime="1511">very similar to the </span><span class="line" data-startTime="1511">one we saw before. </span> <span class="line" data-startTime="1513">In fact, we can do </span><span class="line" data-startTime="1513">the same thing in </span><span class="line" data-startTime="1516">Google Compute Engine. </span></p>

<p><span class="line" data-startTime="1518">As Adam mentioned, you need to </span><span class="line" data-startTime="1518">tell Compute Engine which </span><span class="line" data-startTime="1521">scopes your VM is allowed </span><span class="line" data-startTime="1521">to access. </span> <span class="line" data-startTime="1523">So in this case, we're </span><span class="line" data-startTime="1523">going to let instance </span><span class="line" data-startTime="1526">foobar access Big Query. </span> <span class="line" data-startTime="1532">To fetch a token in </span><span class="line" data-startTime="1532">Compute Engine is </span><span class="line" data-startTime="1534">actually an HTTP request. </span> <span class="line" data-startTime="1536">We can talk to the metadata </span><span class="line" data-startTime="1536">server and get back an access </span><span class="line" data-startTime="1539">token, just as before. </span> <span class="line" data-startTime="1544">Now, once again, you can use our </span><span class="line" data-startTime="1544">client libraries to make </span><span class="line" data-startTime="1547">this even easier. </span> <span class="line" data-startTime="1550">We have an app assertion </span><span class="line" data-startTime="1550">credentials once again, but </span><span class="line" data-startTime="1553">this one's from the </span><span class="line" data-startTime="1553">oath2client.gce package rather </span><span class="line" data-startTime="1557">than for App Engine. </span></p>

<p><span class="line" data-startTime="1559">And it gives you, likewise, </span><span class="line" data-startTime="1559">an HTTP object, which is </span><span class="line" data-startTime="1563">automatically adding </span><span class="line" data-startTime="1563">authorization headers. </span></p>

<p class="speaker"><span class="line" data-starttime="1573"><span class="speakerName">Adam Eijdenberg</span>: So Ben showed </span><span class="line" data-startTime="1573">us a number of different ways </span><span class="line" data-startTime="1575">to get those access tokens from </span><span class="line" data-startTime="1575">him, but all we need is </span><span class="line" data-startTime="1578">one access token. </span> <span class="line" data-startTime="1579">That's all we need to actually </span><span class="line" data-startTime="1579">access an API. </span> <span class="line" data-startTime="1582">And I think we've gone through </span><span class="line" data-startTime="1582">three different ways. </span> <span class="line" data-startTime="1585">We have doing it from first </span><span class="line" data-startTime="1585">principles, we have using part </span><span class="line" data-startTime="1588">of our client library &mdash; </span><span class="line" data-startTime="1588">the oauth part </span><span class="line" data-startTime="1590">of our client library. </span> <span class="line" data-startTime="1591">And that oath part &mdash; it gives </span><span class="line" data-startTime="1591">us those HTTP objects back. </span> <span class="line" data-startTime="1595">And to me, that's probably </span><span class="line" data-startTime="1595">my favorite part. </span> <span class="line" data-startTime="1597">We have these special HTTP </span><span class="line" data-startTime="1597">objects that's like an HTTP </span><span class="line" data-startTime="1600">object with benefits, right? </span><span class="line" data-startTime="1602">I can use that object the same </span><span class="line" data-startTime="1602">way that I'm used to making </span><span class="line" data-startTime="1604">regular HTTP requests, but it </span><span class="line" data-startTime="1604">automatically adds that </span><span class="line" data-startTime="1608">authorization header for us. </span> <span class="line" data-startTime="1609">And even better, it'll </span><span class="line" data-startTime="1609">detect when my access </span><span class="line" data-startTime="1611">token is going to expire. </span> <span class="line" data-startTime="1613">It'll get me a new one. </span></p>

<p><span class="line" data-startTime="1614">So I don't have to write code </span><span class="line" data-startTime="1614">in my app to do that for me. </span> <span class="line" data-startTime="1618">In addition, if for any other </span><span class="line" data-startTime="1618">reason, the access token </span><span class="line" data-startTime="1620">doesn't work, it'll get a new </span><span class="line" data-startTime="1620">one for me automatically. </span> <span class="line" data-startTime="1623">So I think that's a really </span><span class="line" data-startTime="1623">powerful way of taking </span><span class="line" data-startTime="1625">advantage of being able to use </span><span class="line" data-startTime="1625">those client libraries to </span><span class="line" data-startTime="1628">access our APIs, even </span><span class="line" data-startTime="1628">if you don't use </span><span class="line" data-startTime="1630">the rest of the stack. </span> <span class="line" data-startTime="1631">Even if you don't use the full </span><span class="line" data-startTime="1631">discovery API as well, which </span><span class="line" data-startTime="1635">is also a very useful part of </span><span class="line" data-startTime="1635">the library, especially when </span><span class="line" data-startTime="1638">you're getting started with an </span><span class="line" data-startTime="1638">API and you're trying to learn </span><span class="line" data-startTime="1640">about what the different </span><span class="line" data-startTime="1640">methods are that exist. </span></p>

<p><span class="line" data-startTime="1643">So when we run an application, </span><span class="line" data-startTime="1643">we assign </span><span class="line" data-startTime="1644">it a service account. </span> <span class="line" data-startTime="1645">We give it an identity. </span> <span class="line" data-startTime="1647">That's how we do it. </span> <span class="line" data-startTime="1648">We can use built in credentials </span><span class="line" data-startTime="1648">in App Engine and </span><span class="line" data-startTime="1650">Compute Engine. </span> <span class="line" data-startTime="1652">But when you're running </span><span class="line" data-startTime="1652">elsewhere &mdash; </span><span class="line" data-startTime="1653">and this includes when you're </span><span class="line" data-startTime="1653">doing local development with </span><span class="line" data-startTime="1656">App Engine, where we don't know </span><span class="line" data-startTime="1656">who your application is, </span><span class="line" data-startTime="1659">because it's running on </span><span class="line" data-startTime="1659">your workstation &mdash; </span><span class="line" data-startTime="1660">we give you the downloadable </span><span class="line" data-startTime="1660">private keys that you can then </span><span class="line" data-startTime="1663">associate with your </span><span class="line" data-startTime="1663">application to </span><span class="line" data-startTime="1664">give it that identity. </span> <span class="line" data-startTime="1668">So that's kind of the first part </span><span class="line" data-startTime="1668">of the presentation on </span><span class="line" data-startTime="1671">authentication and how we </span><span class="line" data-startTime="1671">authenticate your app, where </span><span class="line" data-startTime="1673">we need to write code </span><span class="line" data-startTime="1673">to do that. </span> <span class="line" data-startTime="1675">The second part, I'm going to </span><span class="line" data-startTime="1675">talk a little bit about </span><span class="line" data-startTime="1677">authorization and how to </span><span class="line" data-startTime="1677">configure your project so that </span><span class="line" data-startTime="1681">once you know who your </span><span class="line" data-startTime="1681">application is, we then let it </span><span class="line" data-startTime="1683">actually proceed with </span><span class="line" data-startTime="1683">the request. </span> <span class="line" data-startTime="1685">And what I'm really going to go </span><span class="line" data-startTime="1685">through is just sort of hit </span><span class="line" data-startTime="1687">off on a couple of points on how </span><span class="line" data-startTime="1687">we process that request so </span><span class="line" data-startTime="1690">that if you get an error back </span><span class="line" data-startTime="1690">saying access not configured </span><span class="line" data-startTime="1693">correctly or similar, you know </span><span class="line" data-startTime="1693">what steps to do to fix it. </span></p>

<p><span class="line" data-startTime="1697">So if you remember before, </span><span class="line" data-startTime="1697">our access token &mdash; </span><span class="line" data-startTime="1699">three main parts. </span> <span class="line" data-startTime="1700">The client that's making the </span><span class="line" data-startTime="1700">request, the user associated </span><span class="line" data-startTime="1703">with the request, and the scopes </span><span class="line" data-startTime="1703">that are associated </span><span class="line" data-startTime="1705">with the request. </span> <span class="line" data-startTime="1707">Now, let's see how </span><span class="line" data-startTime="1707">we use those. </span> <span class="line" data-startTime="1710">Now, primarily the authorization </span><span class="line" data-startTime="1710">is done </span><span class="line" data-startTime="1712">based on the user. </span> <span class="line" data-startTime="1714">We look at the user associated </span><span class="line" data-startTime="1714">with the token, we look at the </span><span class="line" data-startTime="1717">resource that they are trying to </span><span class="line" data-startTime="1717">access, and then we look at </span><span class="line" data-startTime="1720">the project associated with </span><span class="line" data-startTime="1720">that resource that they're </span><span class="line" data-startTime="1722">trying to access. </span> <span class="line" data-startTime="1724">And then we make sure that that </span><span class="line" data-startTime="1724">user is on the team for </span><span class="line" data-startTime="1726">that project. </span> <span class="line" data-startTime="1728">Different services have slightly </span><span class="line" data-startTime="1728">different semantics </span><span class="line" data-startTime="1730">for what the different roles </span><span class="line" data-startTime="1730">in a project mean. </span> <span class="line" data-startTime="1734">I'm showing the project team </span><span class="line" data-startTime="1734">page up there right now. </span> <span class="line" data-startTime="1737">We have can edit, can </span><span class="line" data-startTime="1737">view, and owner. </span></p>

<p><span class="line" data-startTime="1739">Each service has a slightly </span><span class="line" data-startTime="1739">different interpretation of </span><span class="line" data-startTime="1741">what those mean, but generally </span><span class="line" data-startTime="1741">the edit can write objects, </span><span class="line" data-startTime="1744">the read can view objects, </span><span class="line" data-startTime="1744">and owner can do </span><span class="line" data-startTime="1746">anything to those objects. </span> <span class="line" data-startTime="1748">Some services, like Cloud </span><span class="line" data-startTime="1748">Storage, let you go a little </span><span class="line" data-startTime="1751">bit deeper and set access </span><span class="line" data-startTime="1751">control entries on individual </span><span class="line" data-startTime="1753">objects and individual </span><span class="line" data-startTime="1753">buckets. </span> <span class="line" data-startTime="1755">But essentially, they default </span><span class="line" data-startTime="1755">to these parameters here. </span> <span class="line" data-startTime="1758">So the first thing you want to </span><span class="line" data-startTime="1758">do is make sure that the </span><span class="line" data-startTime="1761">object that you're trying to </span><span class="line" data-startTime="1761">access &mdash; that the project it </span><span class="line" data-startTime="1763">belongs to has the application </span><span class="line" data-startTime="1763">on the team. </span> <span class="line" data-startTime="1767">And that's done automatically </span><span class="line" data-startTime="1767">for service accounts that you </span><span class="line" data-startTime="1769">create within a project. </span> <span class="line" data-startTime="1771">But if you do you create an </span><span class="line" data-startTime="1771">App Engine app, and then </span><span class="line" data-startTime="1773">separately, you create a project </span><span class="line" data-startTime="1773">in the developer </span><span class="line" data-startTime="1775">console, they are different. </span></p>

<p><span class="line" data-startTime="1777">So you will need to get the </span><span class="line" data-startTime="1777">email address associated with </span><span class="line" data-startTime="1779">that App Engine service account </span><span class="line" data-startTime="1779">and add that to the </span><span class="line" data-startTime="1782">team in the developer's </span><span class="line" data-startTime="1782">console. </span> <span class="line" data-startTime="1784">If you use the new Cloud </span><span class="line" data-startTime="1784">Console, a lot of that's </span><span class="line" data-startTime="1786">handled automatically for you. </span> <span class="line" data-startTime="1788">We then look at the scopes </span><span class="line" data-startTime="1788">that are in the request. </span> <span class="line" data-startTime="1791">So once we figured out that the </span><span class="line" data-startTime="1791">user is allowed to access </span><span class="line" data-startTime="1795">the object, we then check to see </span><span class="line" data-startTime="1795">what scopes are associated </span><span class="line" data-startTime="1799">with that API call. </span> <span class="line" data-startTime="1801">And if you don't have those </span><span class="line" data-startTime="1801">scopes associated with that </span><span class="line" data-startTime="1803">access token, we won't let that </span><span class="line" data-startTime="1804">request go through, either. </span> <span class="line" data-startTime="1805">So make sure that you request </span><span class="line" data-startTime="1805">via the appropriate scope with </span><span class="line" data-startTime="1808">your access token. </span></p>

<p><span class="line" data-startTime="1809">And those scopes can be found in </span><span class="line" data-startTime="1809">the documentation for each </span><span class="line" data-startTime="1811">of the APIs. </span> <span class="line" data-startTime="1815">The second part is based </span><span class="line" data-startTime="1815">on the client. </span> <span class="line" data-startTime="1817">So we do most the authorization </span><span class="line" data-startTime="1817">based on the </span><span class="line" data-startTime="1820">user, but there are a bunch of </span><span class="line" data-startTime="1820">other things that we do based </span><span class="line" data-startTime="1823">on the client. </span> <span class="line" data-startTime="1824">And the client, remember, that's </span><span class="line" data-startTime="1824">the application that </span><span class="line" data-startTime="1826">you register with Google. </span> <span class="line" data-startTime="1827">And there's a few things </span><span class="line" data-startTime="1827">we check there. </span> <span class="line" data-startTime="1829">And they're not strictly </span><span class="line" data-startTime="1829">authorization, but I call them </span><span class="line" data-startTime="1832">out here, because you'll get a </span><span class="line" data-startTime="1832">very similar error message </span><span class="line" data-startTime="1834">back if it's not configured </span><span class="line" data-startTime="1834">correctly. </span> <span class="line" data-startTime="1836">First, we make sure that the </span><span class="line" data-startTime="1836">service that you're trying to </span><span class="line" data-startTime="1839">access is actually enabled </span><span class="line" data-startTime="1839">in the project. </span></p>

<p><span class="line" data-startTime="1841">And the project that we're </span><span class="line" data-startTime="1841">concerned about there is the </span><span class="line" data-startTime="1843">project associated with the </span><span class="line" data-startTime="1843">client that you created. </span> <span class="line" data-startTime="1847">So when you create a client that </span><span class="line" data-startTime="1847">belongs to a project, you </span><span class="line" data-startTime="1849">need to make sure that the </span><span class="line" data-startTime="1849">service or the API you're </span><span class="line" data-startTime="1852">trying to access is turned </span><span class="line" data-startTime="1852">on for that project. </span> <span class="line" data-startTime="1855">If it's an API that requires </span><span class="line" data-startTime="1855">a credit card or a form of </span><span class="line" data-startTime="1859">payment &mdash; some do and some </span><span class="line" data-startTime="1859">don't &mdash; you need to make sure </span><span class="line" data-startTime="1861">that that billing is enabled </span><span class="line" data-startTime="1861">and set up on that project. </span> <span class="line" data-startTime="1866">And we also will do checks </span><span class="line" data-startTime="1866">against quota. </span> <span class="line" data-startTime="1868">You might see a quota error come </span><span class="line" data-startTime="1868">back from time to time. </span> <span class="line" data-startTime="1870">And that can come back primarily </span><span class="line" data-startTime="1870">for two reasons. </span></p>

<p><span class="line" data-startTime="1874">Some projects will have a free </span><span class="line" data-startTime="1874">quota, and then after that, </span><span class="line" data-startTime="1876">it's paid, and maybe </span><span class="line" data-startTime="1876">the billing </span><span class="line" data-startTime="1878">information isn't set up. </span> <span class="line" data-startTime="1880">And we also have the ability for </span><span class="line" data-startTime="1880">you to be able to specify </span><span class="line" data-startTime="1883">a per user quota. </span> <span class="line" data-startTime="1886">The per user quota here is </span><span class="line" data-startTime="1886">probably more useful when </span><span class="line" data-startTime="1890">you're building an application </span><span class="line" data-startTime="1890">using, say, a drive API or a </span><span class="line" data-startTime="1893">calendar API, where you have </span><span class="line" data-startTime="1893">individual users who are </span><span class="line" data-startTime="1897">accessing data using </span><span class="line" data-startTime="1897">your application. </span> <span class="line" data-startTime="1900">And then you can configure </span><span class="line" data-startTime="1900">a per user quota </span><span class="line" data-startTime="1901">that gets set up there. </span></p>

<p><span class="line" data-startTime="1903">I just mentioned this. </span> <span class="line" data-startTime="1904">These are places to check. </span> <span class="line" data-startTime="1905">There's a quotas tab in </span><span class="line" data-startTime="1905">the developer console. </span> <span class="line" data-startTime="1908">These are places to check if </span><span class="line" data-startTime="1908">you're having any errors </span><span class="line" data-startTime="1911">accessing the API. </span> <span class="line" data-startTime="1914">And finally &mdash; </span><span class="line" data-startTime="1914">and this is fairly specific </span><span class="line" data-startTime="1914">to Cloud &mdash; </span><span class="line" data-startTime="1917">all of these checks are </span><span class="line" data-startTime="1917">generally based on the project </span><span class="line" data-startTime="1922">associated with the credentials </span><span class="line" data-startTime="1922">of the client that </span><span class="line" data-startTime="1924">you've created. </span></p>

<p><span class="line" data-startTime="1926">When you're accessing a resource </span><span class="line" data-startTime="1926">that belongs to </span><span class="line" data-startTime="1928">another project, we check </span><span class="line" data-startTime="1928">in both places. </span> <span class="line" data-startTime="1933">So if you have project A and </span><span class="line" data-startTime="1933">project B, and you have an </span><span class="line" data-startTime="1936">application registered here and </span><span class="line" data-startTime="1936">a resource in Project B, </span><span class="line" data-startTime="1939">we'll do the checks </span><span class="line" data-startTime="1939">in both places. </span> <span class="line" data-startTime="1942">So make sure [INAUDIBLE] </span><span class="line" data-startTime="1943">set up. </span> <span class="line" data-startTime="1944">A lot of the use cases </span><span class="line" data-startTime="1944">we see are </span><span class="line" data-startTime="1946">typically within one project. </span> <span class="line" data-startTime="1947">I just mention that </span><span class="line" data-startTime="1947">for completeness. </span> <span class="line" data-startTime="1951">So to finish off, to access any </span><span class="line" data-startTime="1951">of our APIs, you need to </span><span class="line" data-startTime="1955">give us an access token. </span> <span class="line" data-startTime="1957">We use service accounts to get </span><span class="line" data-startTime="1957">those for Cloud resources, and </span><span class="line" data-startTime="1960">then make sure that that </span><span class="line" data-startTime="1960">user is authorized. </span></p>

<p><span class="line" data-startTime="1962">Make sure it's added </span><span class="line" data-startTime="1962">to the right team. </span> <span class="line" data-startTime="1965">Yeah, we have a fairly active </span><span class="line" data-startTime="1965">community in our developer </span><span class="line" data-startTime="1967">relations group, and others </span><span class="line" data-startTime="1967">watching Stack Overflow. </span> <span class="line" data-startTime="1970">That's a great spot </span><span class="line" data-startTime="1970">to ask for help. </span> <span class="line" data-startTime="1971">If you're struggling to access </span><span class="line" data-startTime="1971">an API, come and ask for help </span><span class="line" data-startTime="1974">there, and we will try </span><span class="line" data-startTime="1974">and help you out. </span> <span class="line" data-startTime="1977">And I think what I'd like to </span><span class="line" data-startTime="1977">finish on saying is, I don't </span><span class="line" data-startTime="1982">think successfully </span><span class="line" data-startTime="1982">authenticating an API call is </span><span class="line" data-startTime="1985">the exciting part of being a </span><span class="line" data-startTime="1985">developer on Cloud Platform. </span> <span class="line" data-startTime="1989">I don't think that's </span><span class="line" data-startTime="1989">that exciting. </span></p>

<p><span class="line" data-startTime="1991">To me, what is exciting is being </span><span class="line" data-startTime="1991">able to get past that </span><span class="line" data-startTime="1994">step and get to those APIs and </span><span class="line" data-startTime="1994">start building my app. </span> <span class="line" data-startTime="1997">Because if you're stuck for </span><span class="line" data-startTime="1997">three or four hours trying to </span><span class="line" data-startTime="2000">authenticate, that's a lot of </span><span class="line" data-startTime="2000">wasted time, and I don't think </span><span class="line" data-startTime="2003">it's that interesting. </span> <span class="line" data-startTime="2005">Once you get past that, once </span><span class="line" data-startTime="2005">you get that successful API </span><span class="line" data-startTime="2008">call, I think that's a </span><span class="line" data-startTime="2008">really good feeling. </span> <span class="line" data-startTime="2012">But even though you and I might </span><span class="line" data-startTime="2012">not be that interested </span><span class="line" data-startTime="2014">in the authentication part, </span><span class="line" data-startTime="2014">at Google, we're lucky. </span></p>

<p><span class="line" data-startTime="2018">We're a big company. </span> <span class="line" data-startTime="2018">We have over 250 full-time </span><span class="line" data-startTime="2018">engineers whose job is to work </span><span class="line" data-startTime="2023">on security, and their job is </span><span class="line" data-startTime="2023">to work on security of your </span><span class="line" data-startTime="2027">data in our data centers. </span> <span class="line" data-startTime="2029">And they care about this a lot, </span><span class="line" data-startTime="2029">and they spend a lot of </span><span class="line" data-startTime="2033">time and effort on </span><span class="line" data-startTime="2033">these details. </span> <span class="line" data-startTime="2035">When I first started using some </span><span class="line" data-startTime="2035">of our APIs, I kind of </span><span class="line" data-startTime="2039">felt there were a lot of </span><span class="line" data-startTime="2039">hoops to jump through. </span> <span class="line" data-startTime="2040">It kind of seemed </span><span class="line" data-startTime="2040">a bit strange. </span> <span class="line" data-startTime="2042">I had to download these private </span><span class="line" data-startTime="2042">keys, and create these </span><span class="line" data-startTime="2044">assertions, and send them off, </span><span class="line" data-startTime="2044">and get access tokens back. </span> <span class="line" data-startTime="2047">But what I discovered was, </span><span class="line" data-startTime="2047">talking to people like Ben, </span><span class="line" data-startTime="2051">talking with people on our </span><span class="line" data-startTime="2051">security team, is that each of </span><span class="line" data-startTime="2054">those hoops is there for a </span><span class="line" data-startTime="2054">reason, and most of those </span><span class="line" data-startTime="2057">reasons are actually </span><span class="line" data-startTime="2057">good ones. </span></p>

<p><span class="line" data-startTime="2059">And that once I could convince </span><span class="line" data-startTime="2059">myself that there's no magic </span><span class="line" data-startTime="2063">actually going on in the </span><span class="line" data-startTime="2063">client libraries, it's </span><span class="line" data-startTime="2064">actually a pretty simple flow </span><span class="line" data-startTime="2064">to make those requests &mdash; </span><span class="line" data-startTime="2067">once I figured out, hey, now </span><span class="line" data-startTime="2067">I understand it, I get it. </span> <span class="line" data-startTime="2070">Now I'm just going to use the </span><span class="line" data-startTime="2070">client libraries, and use </span><span class="line" data-startTime="2071">those to make my calls. </span> <span class="line" data-startTime="2073">And once you get that API call </span><span class="line" data-startTime="2073">done, you're an auth ninja. </span> <span class="line" data-startTime="2076">And the best thing about being </span><span class="line" data-startTime="2076">an auth ninja on one of our </span><span class="line" data-startTime="2079">APIs is there's then another 60 </span><span class="line" data-startTime="2079">different APIs that you can </span><span class="line" data-startTime="2082">go out and try, and you've </span><span class="line" data-startTime="2082">already figured out the </span><span class="line" data-startTime="2084">hardest part, which </span><span class="line" data-startTime="2084">is authentication. </span> <span class="line" data-startTime="2087">So thank you very much </span><span class="line" data-startTime="2087">for coming out today. </span></p>

<p><span class="line" data-startTime="2089">We've got a couple minutes now </span><span class="line" data-startTime="2089">for Q and A. Ben and I will be </span><span class="line" data-startTime="2093">around outside at Cloud Platform </span><span class="line" data-startTime="2093">Sandbox afterwards. </span> <span class="line" data-startTime="2096">We also have &mdash; </span><span class="line" data-startTime="2097">I don't know if Ryan Boyd is </span><span class="line" data-startTime="2097">in the audience right now. </span> <span class="line" data-startTime="2100">Ryan has just written a book on </span><span class="line" data-startTime="2100">oauth, and I think he might </span><span class="line" data-startTime="2102">be doing book signings </span><span class="line" data-startTime="2102">a little bit </span><span class="line" data-startTime="2104">later there as well. </span> <span class="line" data-startTime="2105">So, any questions? </span><span class="line" data-startTime="2110">Yes? </span></p>

<p class="speaker"><span class="line" data-starttime="2110"><span class="speakerName">Audience</span>: A couple over here. </span><span class="line" data-startTime="2113">One is around the concept of </span><span class="line" data-startTime="2113">a client versus a project. </span><span class="line" data-startTime="2117">I'm still not quite clear in </span><span class="line" data-startTime="2117">terms of their relationship, </span><span class="line" data-startTime="2120">whether it's a many to many </span><span class="line" data-startTime="2120">relationship, or it's a parent </span><span class="line" data-startTime="2122">child relationship. </span><span class="line" data-startTime="2124">That's first. </span><span class="line" data-startTime="2125">And then the second part of it </span><span class="line" data-startTime="2125">is around token management. </span><span class="line" data-startTime="2128">Is there any facility provided </span><span class="line" data-startTime="2128">by Google that allows me to </span><span class="line" data-startTime="2132">deactivate or invalidate </span><span class="line" data-startTime="2132">a token that I've </span><span class="line" data-startTime="2135">given up in the past? </span></p>

<p class="speaker"><span class="line" data-starttime="2137"><span class="speakerName">Adam Eijdenberg</span>: OK, </span><span class="line" data-startTime="2137">so I'll answer the </span><span class="line" data-startTime="2138">first part of the question. </span><span class="line" data-startTime="2139">I'll defer to Ben </span><span class="line" data-startTime="2139">on the second. </span><span class="line" data-startTime="2140">I see the relationship between </span><span class="line" data-startTime="2140">the client and the project as </span><span class="line" data-startTime="2142">parent child. </span><span class="line" data-startTime="2143">See, clients belong </span><span class="line" data-startTime="2143">to one project. </span><span class="line" data-startTime="2145">A project may have multiple </span><span class="line" data-startTime="2145">clients as children. </span><span class="line" data-startTime="2148">And Ben, on the token </span><span class="line" data-startTime="2148">management? </span><span class="line" data-startTime="2151">BEN WILEY SITTLER: So anytime </span><span class="line" data-startTime="2151">you have an access token, you </span><span class="line" data-startTime="2155">can send it to our standard </span><span class="line" data-startTime="2155">OAuth 2 token verification </span><span class="line" data-startTime="2158">endpoint, and it will stop </span><span class="line" data-startTime="2158">working after that. </span></p>

<p class="speaker"><span class="line" data-starttime="2163"><span class="speakerName">Adam Eijdenberg</span>: You can </span><span class="line" data-startTime="2163">also wait one hour. </span><span class="line" data-startTime="2166">Yes? </span><span class="line" data-startTime="2167">BEN WILEY SITTLER: </span><span class="line" data-startTime="2167">Can you come to </span><span class="line" data-startTime="2168">the microphone, please? </span></p>

<p class="speaker"><span class="line" data-starttime="2170"><span class="speakerName">Adam Eijdenberg</span>: Just because </span><span class="line" data-startTime="2170">the session's being recorded. </span><span class="line" data-startTime="2172">I know we have a lot of folks </span><span class="line" data-startTime="2172">that aren't in the room today. </span></p>

<p class="speaker"><span class="line" data-starttime="2176"><span class="speakerName">Audience</span>: Supposing if I'm using </span><span class="line" data-startTime="2176">your OAuth token, but I </span><span class="line" data-startTime="2179">also want to implement a two </span><span class="line" data-startTime="2179">level, like sending the code &mdash; </span><span class="line" data-startTime="2183">like how Gmail does it &mdash; </span><span class="line" data-startTime="2185">the code instantly, </span><span class="line" data-startTime="2185">whenever I log in. </span><span class="line" data-startTime="2186">If I want to put that also </span><span class="line" data-startTime="2186">in my application, </span><span class="line" data-startTime="2189">what I should do? </span><span class="line" data-startTime="2191">Like, the instant code, </span><span class="line" data-startTime="2191">I get it, right? </span><span class="line" data-startTime="2194">Supposing if I have a two level </span><span class="line" data-startTime="2194">authentication, I have </span><span class="line" data-startTime="2197">the user name and </span><span class="line" data-startTime="2197">then password. </span><span class="line" data-startTime="2198">Afterwards, I'll ask for </span><span class="line" data-startTime="2198">the code, you know? </span><span class="line" data-startTime="2201">So the Google sends me the code </span><span class="line" data-startTime="2201">through SMS or something. </span><span class="line" data-startTime="2203">So if I want to put also </span><span class="line" data-startTime="2203">in my application, </span><span class="line" data-startTime="2205">how should I do it? </span><span class="line" data-startTime="2206">Along with OAuth, what </span><span class="line" data-startTime="2206">should I do? </span></p>

<p class="speaker"><span class="line" data-starttime="2208"><span class="speakerName">Adam Eijdenberg</span>: So I think what </span><span class="line" data-startTime="2208">you're talking about is </span><span class="line" data-startTime="2209">probably what we refer to as </span><span class="line" data-startTime="2209">two factor authentication, </span><span class="line" data-startTime="2212">which, by the way, if anyone </span><span class="line" data-startTime="2212">here does not have two factor </span><span class="line" data-startTime="2214">authentication set up, </span><span class="line" data-startTime="2214">set it up right away. </span> <span class="line" data-startTime="2216">It is a fantastic way to keep </span><span class="line" data-startTime="2216">your account secure. </span> <span class="line" data-startTime="2219">And if you don't know what two </span><span class="line" data-startTime="2219">factor is, what it is &mdash; </span><span class="line" data-startTime="2222">normally, when you log into a </span><span class="line" data-startTime="2222">Google account, you give your </span><span class="line" data-startTime="2225">email address and a password. </span> <span class="line" data-startTime="2227">What two factor does is once </span><span class="line" data-startTime="2227">you put your email and </span><span class="line" data-startTime="2229">password in, it will then send </span><span class="line" data-startTime="2229">you, either via an SMS or via </span><span class="line" data-startTime="2233">an app we have on Android, </span><span class="line" data-startTime="2233">a six digit code. </span> <span class="line" data-startTime="2236">And you need to put that in. </span> <span class="line" data-startTime="2237">You only need to do about </span><span class="line" data-startTime="2237">once a month or so. </span> <span class="line" data-startTime="2239">It can be a little bit </span><span class="line" data-startTime="2239">frustrating that once a month </span><span class="line" data-startTime="2241">when you do it, but on the plus </span><span class="line" data-startTime="2241">side, if someone gets </span><span class="line" data-startTime="2244">your password &mdash; because </span><span class="line" data-startTime="2244">maybe you've reused </span><span class="line" data-startTime="2246">it somewhere else &mdash; </span><span class="line" data-startTime="2247">then they can't actually </span><span class="line" data-startTime="2247">access your account. </span></p>

<p><span class="line" data-startTime="2249">Now, back to the question </span><span class="line" data-startTime="2249">in terms of how does </span><span class="line" data-startTime="2251">that relate to OAuth? </span><span class="line" data-startTime="2252">So for the service account use </span><span class="line" data-startTime="2252">case, it doesn't apply at all. </span> <span class="line" data-startTime="2256">The service account just </span><span class="line" data-startTime="2256">has a private key. </span> <span class="line" data-startTime="2258">It's your application. </span> <span class="line" data-startTime="2259">For a more traditional &mdash; </span><span class="line" data-startTime="2260">let's say I'm using a Google </span><span class="line" data-startTime="2260">API to access. </span> <span class="line" data-startTime="2264">Let's say we're using </span><span class="line" data-startTime="2264">the Drive example. </span> <span class="line" data-startTime="2266">You're building an application, </span><span class="line" data-startTime="2266">and you wanted to </span><span class="line" data-startTime="2268">access a user's data. </span> <span class="line" data-startTime="2270">This is actually one of the </span><span class="line" data-startTime="2270">great things about using OAuth </span><span class="line" data-startTime="2272">instead of taking the user's </span><span class="line" data-startTime="2272">username and password and </span><span class="line" data-startTime="2276">sending it on. </span></p>

<p><span class="line" data-startTime="2278">You do a redirect back to a </span><span class="line" data-startTime="2278">Google screen, and what that </span><span class="line" data-startTime="2281">means is that all of the </span><span class="line" data-startTime="2281">functionality that's on the </span><span class="line" data-startTime="2283">regular Google login screen is </span><span class="line" data-startTime="2283">available to the user that's </span><span class="line" data-startTime="2287">entering their credentials. </span> <span class="line" data-startTime="2288">They'll put their username and </span><span class="line" data-startTime="2288">password in if they're not </span><span class="line" data-startTime="2290">already authenticated in </span><span class="line" data-startTime="2290">the browser window. </span> <span class="line" data-startTime="2292">Then they'll have to go through </span><span class="line" data-startTime="2292">two factor, if they </span><span class="line" data-startTime="2294">haven't already done </span><span class="line" data-startTime="2294">that recently. </span> <span class="line" data-startTime="2297">Then they all see a screen </span><span class="line" data-startTime="2297">saying, hey, this app wants to </span><span class="line" data-startTime="2300">access your drive data. </span> <span class="line" data-startTime="2302">Allow or deny? </span><span class="line" data-startTime="2302">When they hit allow, that will </span><span class="line" data-startTime="2302">then send an authorization </span><span class="line" data-startTime="2305">code back to your application, </span><span class="line" data-startTime="2305">which you can then use to </span><span class="line" data-startTime="2308">exchange and get an </span><span class="line" data-startTime="2308">access token. </span> <span class="line" data-startTime="2309">And we didn't cover that flow </span><span class="line" data-startTime="2309">today, but hopefully, that </span><span class="line" data-startTime="2312">answers that question. </span> <span class="line" data-startTime="2314">Sorry, a question </span><span class="line" data-startTime="2314">on this side? </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2316"><span class="speakerName">Audience</span>: Adam, thanks. </span> <span class="line" data-startTime="2317">I'll try to be as concise </span><span class="line" data-startTime="2317">as possible. </span> <span class="line" data-startTime="2320">I'm going to imagine </span><span class="line" data-startTime="2320">an imaginary app </span><span class="line" data-startTime="2322">that I want to make. </span> <span class="line" data-startTime="2324">Let's say I wanted to have a </span><span class="line" data-startTime="2324">Chrome extension that did </span><span class="line" data-startTime="2329">something like take the URL or </span><span class="line" data-startTime="2329">something, put it up on your </span><span class="line" data-startTime="2332">Drive, of whoever's </span><span class="line" data-startTime="2332">logged in there. </span> <span class="line" data-startTime="2334">So like you had just said for </span><span class="line" data-startTime="2334">the previous one, there's the </span><span class="line" data-startTime="2338">client side authentication to </span><span class="line" data-startTime="2338">say which Google Drive are </span><span class="line" data-startTime="2341">you, if you're not already </span><span class="line" data-startTime="2341">there, and then </span><span class="line" data-startTime="2342">it gives you that. </span> <span class="line" data-startTime="2343">But for this project that I </span><span class="line" data-startTime="2343">have, let's say I go through </span><span class="line" data-startTime="2346">and I make the project </span><span class="line" data-startTime="2346">for myself. </span> <span class="line" data-startTime="2350">I enable it for Google </span><span class="line" data-startTime="2350">Drive Service. </span> <span class="line" data-startTime="2353">I create a Service account, </span><span class="line" data-startTime="2353">and I generate a </span><span class="line" data-startTime="2356">private key, then. </span> <span class="line" data-startTime="2358">And then I can, at run time, </span><span class="line" data-startTime="2358">get an access token to use. </span> <span class="line" data-startTime="2363">It all works great. </span></p>

<p><span class="line" data-startTime="2364">I put this up as an extension, </span><span class="line" data-startTime="2364">and millions of people </span><span class="line" data-startTime="2367">download it everywhere. </span> <span class="line" data-startTime="2368">And then all of a sudden, </span><span class="line" data-startTime="2368">now I've got </span><span class="line" data-startTime="2369">problems with the quota. </span> <span class="line" data-startTime="2374">ADAM EIJDENBERG: [INAUDIBLE] </span><span class="line" data-startTime="2374">millions of people with access </span><span class="line" data-startTime="2374">to your private key. </span></p>

<p class="speaker"><span class="line" data-starttime="2376"><span class="speakerName">Audience</span>: So is there, </span><span class="line" data-startTime="2376">I guess, maybe &mdash; </span><span class="line" data-startTime="2379">is there an API that we can have </span><span class="line" data-startTime="2379">for generating these API </span><span class="line" data-startTime="2384">tokens so that every single </span><span class="line" data-startTime="2384">person who downloads the </span><span class="line" data-startTime="2388">extension can have their own </span><span class="line" data-startTime="2388">token, let's say, for </span><span class="line" data-startTime="2394">themselves as a developer, </span><span class="line" data-startTime="2394">when they're really not </span><span class="line" data-startTime="2396">developers, but that way, they </span><span class="line" data-startTime="2396">have their own quota for every </span><span class="line" data-startTime="2399">person that downloads it? </span><span class="line" data-startTime="2400">I'm not sure if there's </span><span class="line" data-startTime="2400">an API for these APIs. </span></p>

<p class="speaker"><span class="line" data-starttime="2402"><span class="speakerName">Adam Eijdenberg</span>: It sounds to </span><span class="line" data-startTime="2402">me like that's probably more </span><span class="line" data-startTime="2405">of a case for what we call the </span><span class="line" data-startTime="2405">three legged authentication </span><span class="line" data-startTime="2407">flow, where you have the </span><span class="line" data-startTime="2407">user consenting to </span><span class="line" data-startTime="2410">access their data. </span> <span class="line" data-startTime="2412">In which case we don't </span><span class="line" data-startTime="2412">use the private key. </span> <span class="line" data-startTime="2415">We don't need to generate </span><span class="line" data-startTime="2415">a private key. </span> <span class="line" data-startTime="2416">We'd probably use &mdash; </span><span class="line" data-startTime="2418">and I should probably defer to </span><span class="line" data-startTime="2418">Ben pretty quickly here. </span> <span class="line" data-startTime="2420">I was going to say web </span><span class="line" data-startTime="2420">application flow. </span> <span class="line" data-startTime="2421">Do we have something special </span><span class="line" data-startTime="2421">for Chrome extensions? </span><span class="line" data-startTime="2425">BEN WILEY SITTLER: I think </span><span class="line" data-startTime="2425">Chrome extensions &mdash; </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2426"><span class="speakerName">Audience</span>: Well, I just </span><span class="line" data-startTime="2426">made that up. </span><span class="line" data-startTime="2427">Let's just say it's not </span><span class="line" data-startTime="2427">a Chrome extension. </span><span class="line" data-startTime="2429">It's an executable that I make </span><span class="line" data-startTime="2429">freely available, and they </span><span class="line" data-startTime="2432">download that there. </span><span class="line" data-startTime="2433">But it would be the same </span><span class="line" data-startTime="2433">question I have, is how does </span><span class="line" data-startTime="2435">that throttling happen when </span><span class="line" data-startTime="2435">it's just out there and </span><span class="line" data-startTime="2441">everybody's using it </span><span class="line" data-startTime="2441">for their own? </span></p>

<p class="speaker"><span class="line" data-starttime="2443"><span class="speakerName">Adam Eijdenberg</span>: I can give you </span><span class="line" data-startTime="2443">a very concrete example. </span> <span class="line" data-startTime="2445">So if you look at gcutil or </span><span class="line" data-startTime="2445">gsutil, and those are </span><span class="line" data-startTime="2448">utilities that Google provides </span><span class="line" data-startTime="2448">for managing Compute Engine </span><span class="line" data-startTime="2451">and Cloud Storage </span><span class="line" data-startTime="2451">respectively. </span> <span class="line" data-startTime="2453">That's a binary, essentially, </span><span class="line" data-startTime="2453">that we distribute. </span> <span class="line" data-startTime="2455">And when you download and run </span><span class="line" data-startTime="2455">that binary &mdash; and by the way, </span><span class="line" data-startTime="2457">it's using all of </span><span class="line" data-startTime="2457">our public APIs. </span> <span class="line" data-startTime="2459">But when you run that binary, </span><span class="line" data-startTime="2459">the user is presented with a </span><span class="line" data-startTime="2463">URL that's opened automatically </span><span class="line" data-startTime="2463">in the browser </span><span class="line" data-startTime="2464">for them that allows them to </span><span class="line" data-startTime="2464">consent to manage their cloud </span><span class="line" data-startTime="2468">storage objects or their virtual </span><span class="line" data-startTime="2468">machine objects on </span><span class="line" data-startTime="2470">their behalf. </span> <span class="line" data-startTime="2472">And that, then returns, </span><span class="line" data-startTime="2472">actually, what we call a </span><span class="line" data-startTime="2473">refresh token, which is like an </span><span class="line" data-startTime="2473">access token, but it's one </span><span class="line" data-startTime="2476">that we can use to get more </span><span class="line" data-startTime="2476">access tokens after an hour </span><span class="line" data-startTime="2478">when it expires. </span></p>

<p><span class="line" data-startTime="2481">You would then store that </span><span class="line" data-startTime="2481">locally on their machine, and </span><span class="line" data-startTime="2484">then you can use that to </span><span class="line" data-startTime="2484">make subsequent calls. </span> <span class="line" data-startTime="2487">And that's when those per user </span><span class="line" data-startTime="2487">quotas come into effect. </span> <span class="line" data-startTime="2491">So that's where you can then </span><span class="line" data-startTime="2491">throttle users &mdash; make sure </span><span class="line" data-startTime="2493">that one user doesn't ruin it </span><span class="line" data-startTime="2493">for everyone else by doing </span><span class="line" data-startTime="2495">thousands and thousands </span><span class="line" data-startTime="2495">of API calls. </span></p>

<p class="speaker"><span class="line" data-starttime="2497"><span class="speakerName">Audience</span>: But if someone does do </span><span class="line" data-startTime="2497">that &mdash; like, what if there </span><span class="line" data-startTime="2501">is people who then use this new </span><span class="line" data-startTime="2501">thing you've made and you </span><span class="line" data-startTime="2505">can't guarantee that other </span><span class="line" data-startTime="2505">people who've downloaded it </span><span class="line" data-startTime="2507">won't have had the quota taken </span><span class="line" data-startTime="2507">up by someone they don't know. </span></p>

<p class="speaker"><span class="line" data-starttime="2511"><span class="speakerName">Adam Eijdenberg</span>: Yes. </span> <span class="line" data-startTime="2512">So it actually is a per user </span><span class="line" data-startTime="2512">quota that you can set. </span> <span class="line" data-startTime="2515">So you can set it so that each </span><span class="line" data-startTime="2515">user might only be able to do </span><span class="line" data-startTime="2518">10 requests per second, or </span><span class="line" data-startTime="2518">some limit like that. </span> <span class="line" data-startTime="2521">So I think we're running </span><span class="line" data-startTime="2521">out of time. </span> <span class="line" data-startTime="2524">I'm getting the get off the </span><span class="line" data-startTime="2524">stage signal from the back. </span> <span class="line" data-startTime="2525">Please come and find us after, </span><span class="line" data-startTime="2525">because we're going to be </span><span class="line" data-startTime="2527">around until about 10:30 at </span><span class="line" data-startTime="2527">the Cloud Platform booth. </span> <span class="line" data-startTime="2531">Thank you, everyone, </span><span class="line" data-startTime="2531">for coming today. </span> <span class="line" data-startTime="2533">If you did enjoy the session, </span><span class="line" data-startTime="2533">if you do want Ben and I to </span><span class="line" data-startTime="2535">come back next year and tell you </span><span class="line" data-startTime="2535">more about authentication, </span><span class="line" data-startTime="2538">please write the session at </span><span class="line" data-startTime="2538">the back, and there's a </span><span class="line" data-startTime="2540">feedback QR code over there. </span></p>

<p><span class="line" data-startTime="2542">If you didn't like the session, </span><span class="line" data-startTime="2542">if we just wasted 45 </span><span class="line" data-startTime="2544">minutes of your time, no one </span><span class="line" data-startTime="2544">reads the feedback, so don't </span><span class="line" data-startTime="2546">worry about it. </span> <span class="line" data-startTime="2547">Thank you. </span></p></div>