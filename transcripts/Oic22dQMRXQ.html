<p class="speaker"><span class="line" data-starttime="5"><span class="speakerName">Jake Archibald</span>: Good </span><span class="line" data-startTime="5">morning, everyone. </span> <span class="line" data-startTime="6">Welcome to the offline </span><span class="line" data-startTime="6">part of the day. </span> <span class="line" data-startTime="11">So my involvement with all the </span><span class="line" data-startTime="11">offline stuff started a year </span><span class="line" data-startTime="14">and a half ago when </span><span class="line" data-startTime="14">I joined Lanyard. </span> <span class="line" data-startTime="16">And when I joined Lanyard &mdash; </span><span class="line" data-startTime="25">so can everyone hear me? </span><span class="line" data-startTime="27">Right, OK. </span> <span class="line" data-startTime="27">I'll stay at this level. </span> <span class="line" data-startTime="28">So a year and a half ago, </span><span class="line" data-startTime="28">I started at Lanyard. </span> <span class="line" data-startTime="31">When I started, they were </span><span class="line" data-startTime="31">building an iPhone app. </span> <span class="line" data-startTime="34">And they were doing this mainly </span><span class="line" data-startTime="34">just to get a presence </span><span class="line" data-startTime="36">in the App Store, but also </span><span class="line" data-startTime="36">because it gave them the </span><span class="line" data-startTime="40">opportunity to make data </span><span class="line" data-startTime="40">available offline. </span></p>

<p><span class="line" data-startTime="42">And offline is important to </span><span class="line" data-startTime="42">conference delegates because </span><span class="line" data-startTime="45">you're quite often on a plane </span><span class="line" data-startTime="45">on the way there, so you've </span><span class="line" data-startTime="47">mostly got no connection </span><span class="line" data-startTime="47">there. </span> <span class="line" data-startTime="49">Or when you arrive in a foreign </span><span class="line" data-startTime="49">country, you might be </span><span class="line" data-startTime="52">data roaming. </span> <span class="line" data-startTime="53">So we don't want you to have to </span><span class="line" data-startTime="53">pay a lot of money just to </span><span class="line" data-startTime="56">find out where the conference </span><span class="line" data-startTime="56">is or what the sessions are. </span> <span class="line" data-startTime="59">And even when you're at the </span><span class="line" data-startTime="59">conference, obviously </span><span class="line" data-startTime="62">conferences have Wi-Fi. </span> <span class="line" data-startTime="64">But it's a special brand of </span><span class="line" data-startTime="64">Wi-Fi known as conference </span><span class="line" data-startTime="66">Wi-Fi, which is like Wi-Fi, </span><span class="line" data-startTime="66">but it doesn't work. </span> <span class="line" data-startTime="69">So you can't rely on </span><span class="line" data-startTime="69">the connection. </span></p>

<p><span class="line" data-startTime="71">But obviously not everyone </span><span class="line" data-startTime="71">has an iPhone. </span> <span class="line" data-startTime="73">People have lots of different </span><span class="line" data-startTime="73">kinds of devices. </span> <span class="line" data-startTime="75">And we wanted Lanyard to </span><span class="line" data-startTime="75">work on there as well. </span> <span class="line" data-startTime="78">But most of these, quite a few </span><span class="line" data-startTime="78">of these don't have an app </span><span class="line" data-startTime="81">platform, and we didn't have the </span><span class="line" data-startTime="81">resource to go and build </span><span class="line" data-startTime="84">apps for all of then either. </span> <span class="line" data-startTime="85">So we wanted to make a web </span><span class="line" data-startTime="85">version of the app, and that </span><span class="line" data-startTime="88">was what I was there to do. </span> <span class="line" data-startTime="90">And when I was given this task, </span><span class="line" data-startTime="90">I was like, well, I </span><span class="line" data-startTime="92">really want to work offline </span><span class="line" data-startTime="92">work in the </span><span class="line" data-startTime="94">web version as well. </span> <span class="line" data-startTime="95">And I had this recollection of </span><span class="line" data-startTime="95">this thing called AppCache. </span> <span class="line" data-startTime="98">And I went and did some </span><span class="line" data-startTime="98">preliminary research into it. </span> <span class="line" data-startTime="101">And it looked really good. </span></p>

<p><span class="line" data-startTime="102">I could just add a </span><span class="line" data-startTime="102">reference to a </span><span class="line" data-startTime="104">manifest on the HTML elements. </span> <span class="line" data-startTime="106">And I could just list </span><span class="line" data-startTime="106">all the stuff that I </span><span class="line" data-startTime="109">want to work offline. </span> <span class="line" data-startTime="110">And it works. </span> <span class="line" data-startTime="112">And I could also capture a set </span><span class="line" data-startTime="112">of URLs, like everything that </span><span class="line" data-startTime="115">begins with avatars &mdash; images, </span><span class="line" data-startTime="115">avatars &mdash; and then say, well, </span><span class="line" data-startTime="118">if you're offline, I want you </span><span class="line" data-startTime="118">to serve that instead. </span> <span class="line" data-startTime="120">And I was like, wow, </span><span class="line" data-startTime="120">this sounds like </span><span class="line" data-startTime="121">a really good solution. </span> <span class="line" data-startTime="123">It seemed like the API was this </span><span class="line" data-startTime="123">big, cuddly teddy bear. </span> <span class="line" data-startTime="127">And I kind of ran up and I </span><span class="line" data-startTime="127">hugged the teddy bear and </span><span class="line" data-startTime="129">thought, together, we're going </span><span class="line" data-startTime="129">to get through this. </span></p>

<p><span class="line" data-startTime="132">We can make the web </span><span class="line" data-startTime="132">work offline. </span> <span class="line" data-startTime="135">Of course it soon became obvious </span><span class="line" data-startTime="135">that the lovely teddy </span><span class="line" data-startTime="138">bear that I was cuddling </span><span class="line" data-startTime="138">was filled with </span><span class="line" data-startTime="140">razor blades and bees. </span> <span class="line" data-startTime="143">And I got stung many, </span><span class="line" data-startTime="143">many times. </span> <span class="line" data-startTime="147">And the razor blades </span><span class="line" data-startTime="147">dug into my skin. </span> <span class="line" data-startTime="149">And I got the whole alphabet </span><span class="line" data-startTime="149">of hepatitis. </span> <span class="line" data-startTime="151">And it was a really </span><span class="line" data-startTime="151">nasty experience. </span> <span class="line" data-startTime="155">So you hear the word "gotcha" </span><span class="line" data-startTime="155">a lot with AppCache. </span> <span class="line" data-startTime="159">And the spec does seem </span><span class="line" data-startTime="159">to do the unexpected. </span></p>

<p class="speaker"><span class="line" data-starttime="164"><span class="speakerName">Male Speaker</span>: I think </span><span class="line" data-startTime="164">your mic is on. </span></p>

<p class="speaker"><span class="line" data-starttime="166"><span class="speakerName">Jake Archibald</span>: Ah, yeah. </span> <span class="line" data-startTime="166">That would help. </span> <span class="line" data-startTime="167">OK. </span> <span class="line" data-startTime="169">Oh, that's nicer. </span> <span class="line" data-startTime="170">OK, so when something is cached, </span><span class="line" data-startTime="170">it will always come </span><span class="line" data-startTime="175">from the cache. </span> <span class="line" data-startTime="176">If the AppCache has something to </span><span class="line" data-startTime="176">give you, it will serve it </span><span class="line" data-startTime="178">straight from the cache. </span> <span class="line" data-startTime="179">And so even if you're online, </span><span class="line" data-startTime="179">you're going to get those </span><span class="line" data-startTime="182">cached assets. </span> <span class="line" data-startTime="184">And the cache is only updated </span><span class="line" data-startTime="184">if the manifest file itself </span><span class="line" data-startTime="187">changes, just a character </span><span class="line" data-startTime="187">changes, even if that </span><span class="line" data-startTime="189">character is inside a comment. </span> <span class="line" data-startTime="191">And the cache only updates if </span><span class="line" data-startTime="191">all of the things you listed </span><span class="line" data-startTime="194">downloads successfully. </span></p>

<p><span class="line" data-startTime="195">If one of them 404s or 500s, </span><span class="line" data-startTime="195">then the whole thing fails. </span> <span class="line" data-startTime="201">I started drawing this diagram </span><span class="line" data-startTime="201">to try and make sense of what </span><span class="line" data-startTime="205">AppCache was actually doing, </span><span class="line" data-startTime="205">what the flow of information </span><span class="line" data-startTime="207">was, how it worked. </span> <span class="line" data-startTime="209">And I did some talks based on </span><span class="line" data-startTime="209">this, and I'm showing this </span><span class="line" data-startTime="212">diagram, going, look &mdash; </span><span class="line" data-startTime="213">look how terrible </span><span class="line" data-startTime="213">that cache is. </span> <span class="line" data-startTime="214">Look how complicated it is. </span> <span class="line" data-startTime="217">But if you think about some code </span><span class="line" data-startTime="217">you've written recently &mdash; </span><span class="line" data-startTime="219">even something fairly simple, </span><span class="line" data-startTime="219">like, I don't know, form </span><span class="line" data-startTime="221">validation &mdash; </span><span class="line" data-startTime="223">if you drew it as </span><span class="line" data-startTime="223">a flow chart, it </span><span class="line" data-startTime="225">would look like this. </span> <span class="line" data-startTime="227">It would look this complicated, </span><span class="line" data-startTime="227">probably more </span><span class="line" data-startTime="229">complicated. </span> <span class="line" data-startTime="230">And that doesn't </span><span class="line" data-startTime="230">make it wrong. </span> <span class="line" data-startTime="232">And that doesn't make it </span><span class="line" data-startTime="232">difficult to read. </span> <span class="line" data-startTime="234">And that doesn't make </span><span class="line" data-startTime="234">it hard to maintain. </span></p>

<p><span class="line" data-startTime="236">A lot of the gotchas that </span><span class="line" data-startTime="236">AppCache has are actually </span><span class="line" data-startTime="239">quite sensible. </span> <span class="line" data-startTime="240">So the cache is used even if </span><span class="line" data-startTime="240">you're online, and that </span><span class="line" data-startTime="243">happens because it's really, </span><span class="line" data-startTime="243">really fast. </span> <span class="line" data-startTime="245">The exception is in fallback. </span> <span class="line" data-startTime="247">So if it tries to request an </span><span class="line" data-startTime="247">avatar, it's going to go to </span><span class="line" data-startTime="250">the network. </span> <span class="line" data-startTime="250">And it's only going to </span><span class="line" data-startTime="250">serve this if the </span><span class="line" data-startTime="252">network request fails. </span> <span class="line" data-startTime="254">And that's really quick, in this </span><span class="line" data-startTime="254">case, because you can go </span><span class="line" data-startTime="257">and get the avatar from the </span><span class="line" data-startTime="257">network, and that's going to </span><span class="line" data-startTime="259">be really fast. </span> <span class="line" data-startTime="260">It's even faster in this case </span><span class="line" data-startTime="260">because it's going to fail </span><span class="line" data-startTime="263">really, really quickly. </span></p>

<p><span class="line" data-startTime="264">And you'll get the fallback </span><span class="line" data-startTime="264">avatar instead. </span> <span class="line" data-startTime="266">The problem case is this, </span><span class="line" data-startTime="266">which I like to </span><span class="line" data-startTime="268">call the real world. </span> <span class="line" data-startTime="270">And when your phone's in this </span><span class="line" data-startTime="270">kind of state, it's like a </span><span class="line" data-startTime="276">one-legged dog. </span> <span class="line" data-startTime="278">It thinks it can still play </span><span class="line" data-startTime="278">fetch, but it can't. </span> <span class="line" data-startTime="284">And you have to watch it drag </span><span class="line" data-startTime="284">itself along the floor with </span><span class="line" data-startTime="287">its one leg. </span> <span class="line" data-startTime="289">And it's heartbreaking. </span> <span class="line" data-startTime="291">And with your phone it's really, </span><span class="line" data-startTime="291">really irritating. </span> <span class="line" data-startTime="292">Because you know that on the </span><span class="line" data-startTime="292">device, on there is the data </span><span class="line" data-startTime="296">that is good enough </span><span class="line" data-startTime="296">for you right now. </span> <span class="line" data-startTime="299">But it won't give you it. </span></p>

<p><span class="line" data-startTime="300">It has to wait for minutes </span><span class="line" data-startTime="300">before it decides it really </span><span class="line" data-startTime="302">can't make this connection. </span> <span class="line" data-startTime="304">The spec doesn't really mention </span><span class="line" data-startTime="304">offline very much. </span> <span class="line" data-startTime="306">It only talks about connections </span><span class="line" data-startTime="306">that succeeded or </span><span class="line" data-startTime="308">failed, all past tense. </span> <span class="line" data-startTime="310">It doesn't try and predict </span><span class="line" data-startTime="310">the state of the network. </span> <span class="line" data-startTime="314">So cached data at first is good, </span><span class="line" data-startTime="314">because it doesn't have </span><span class="line" data-startTime="317">any expectation of the network, </span><span class="line" data-startTime="317">and that's great. </span> <span class="line" data-startTime="320">And that's how apps behave. </span> <span class="line" data-startTime="321">If you open Twitter on </span><span class="line" data-startTime="321">your phone, you've </span><span class="line" data-startTime="324">got old data there. </span> <span class="line" data-startTime="325">And then it goes and fetches new </span><span class="line" data-startTime="325">data if it can, if there's </span><span class="line" data-startTime="327">a network connection. </span></p>

<p><span class="line" data-startTime="329">So complexity isn't </span><span class="line" data-startTime="329">the problem here. </span> <span class="line" data-startTime="332">What is the problem? </span><span class="line" data-startTime="333">Well, what is the AppCache </span><span class="line" data-startTime="333">made of? </span><span class="line" data-startTime="335">There's a request cache. </span> <span class="line" data-startTime="337">And we can add, remove, and </span><span class="line" data-startTime="337">update items from this. </span> <span class="line" data-startTime="340">And those updates are </span><span class="line" data-startTime="340">transactional. </span> <span class="line" data-startTime="341">It's all atomic. </span> <span class="line" data-startTime="342">And it's pretty sensible. </span> <span class="line" data-startTime="344">There's also a router. </span> <span class="line" data-startTime="345">The router takes a network </span><span class="line" data-startTime="345">connection and decides what it </span><span class="line" data-startTime="348">should do with it. </span> <span class="line" data-startTime="350">So it can just serve stuff </span><span class="line" data-startTime="350">straight from the cache </span><span class="line" data-startTime="352">without going to network, or </span><span class="line" data-startTime="352">it can go to network, give </span><span class="line" data-startTime="355">that a go, and serve something </span><span class="line" data-startTime="355">from the cache if that fails. </span> <span class="line" data-startTime="357">And that's all quite </span><span class="line" data-startTime="357">sensible as well. </span></p>

<p><span class="line" data-startTime="360">But what's our API into this? </span><span class="line" data-startTime="363">Our API is the manifest. </span> <span class="line" data-startTime="366">So if I do this, I add </span><span class="line" data-startTime="366">an empty manifest &mdash; </span><span class="line" data-startTime="368">well, just with the words </span><span class="line" data-startTime="368">cache manifest &mdash; </span><span class="line" data-startTime="370">what this will do is it'll take </span><span class="line" data-startTime="370">index.html and it will </span><span class="line" data-startTime="373">put that into the cache. </span> <span class="line" data-startTime="375">And it will set up a routing </span><span class="line" data-startTime="375">rule that says if that page is </span><span class="line" data-startTime="377">requested, serve it straight </span><span class="line" data-startTime="377">from the cache. </span> <span class="line" data-startTime="382">Really? </span><span class="line" data-startTime="382">Did I just tell it to </span><span class="line" data-startTime="382">do all that, just </span><span class="line" data-startTime="384">with this empty file? </span><span class="line" data-startTime="387">Here I'm adding a lot more </span><span class="line" data-startTime="387">static routes, and here I'm </span><span class="line" data-startTime="389">saying, hey, with this one line, </span><span class="line" data-startTime="389">take fallback PNG, make </span><span class="line" data-startTime="393">that a cache entry, put </span><span class="line" data-startTime="393">that into the cache. </span> <span class="line" data-startTime="395">And if any of these URLs are </span><span class="line" data-startTime="395">requested, set up a routing </span><span class="line" data-startTime="398">rule, try and fetch it from the </span><span class="line" data-startTime="398">network first, and if that </span><span class="line" data-startTime="402">fails, then use this instead, </span><span class="line" data-startTime="402">fallback PNG. </span> <span class="line" data-startTime="406">And a failure means any HTTP </span><span class="line" data-startTime="406">status code that starts with </span><span class="line" data-startTime="409">4, 404, anything that starts </span><span class="line" data-startTime="409">with 5, or if there's a </span><span class="line" data-startTime="413">redirect to another domain. </span></p>

<p><span class="line" data-startTime="417">Did I really tell it to do </span><span class="line" data-startTime="417">that with this one line? </span><span class="line" data-startTime="420">That's a lot of assumptions </span><span class="line" data-startTime="420">to make. </span> <span class="line" data-startTime="423">And if I, say, have on my HTML </span><span class="line" data-startTime="423">page a link, an image to a </span><span class="line" data-startTime="429">picture of your cat from </span><span class="line" data-startTime="429">Flickr &mdash; do you have a cat? </span><span class="line" data-startTime="435">Who has a cat? </span><span class="line" data-startTime="437">Your cat &mdash; good, Bruce's cat. </span> <span class="line" data-startTime="439">What happens to the </span><span class="line" data-startTime="439">image of that cat? </span><span class="line" data-startTime="442">OK, so an index.html file </span><span class="line" data-startTime="442">is a get request. </span> <span class="line" data-startTime="445">That's fine. </span> <span class="line" data-startTime="446">Is it associated with manifest? </span><span class="line" data-startTime="447">Yes it is. </span> <span class="line" data-startTime="448">We're going to use that. </span> <span class="line" data-startTime="449">Is the URL AppCached? </span><span class="line" data-startTime="450">Yes it is. </span> <span class="line" data-startTime="451">So it comes straight </span><span class="line" data-startTime="451">from the cache. </span> <span class="line" data-startTime="453">That's fine. </span> <span class="line" data-startTime="454">Is it HTML? </span><span class="line" data-startTime="454">Yes it is. </span> <span class="line" data-startTime="455">So for each get request on </span><span class="line" data-startTime="455">the page, we're going </span><span class="line" data-startTime="458">to go back up here. </span> <span class="line" data-startTime="458">And that's going to include </span><span class="line" data-startTime="458">the picture of your cat. </span></p>

<p><span class="line" data-startTime="460">So is the URL AppCached? </span><span class="line" data-startTime="462">No. </span> <span class="line" data-startTime="463">Is the URL in the network </span><span class="line" data-startTime="463">section of the manifest? </span><span class="line" data-startTime="466">No. </span> <span class="line" data-startTime="467">Does the URL match a </span><span class="line" data-startTime="467">fallback prefix? </span><span class="line" data-startTime="469">No. </span> <span class="line" data-startTime="470">We've got one for avatars </span><span class="line" data-startTime="470">but not one for </span><span class="line" data-startTime="472">Bruce's cat, so no. </span> <span class="line" data-startTime="474">Is there a star in the </span><span class="line" data-startTime="474">network section? </span><span class="line" data-startTime="476">No. </span> <span class="line" data-startTime="478">So the image will fail. </span> <span class="line" data-startTime="479">And the picture of Bruce's </span><span class="line" data-startTime="479">cat will not appear. </span> <span class="line" data-startTime="482">It will appear as if there </span><span class="line" data-startTime="482">was no network. </span> <span class="line" data-startTime="483">Even if you're online, the </span><span class="line" data-startTime="483">picture of that cat will fail </span><span class="line" data-startTime="487">to download. </span> <span class="line" data-startTime="488">There is nothing here to me that </span><span class="line" data-startTime="488">suggests that picture of </span><span class="line" data-startTime="492">Bruce's cat should not load. </span> <span class="line" data-startTime="495">I don't know what the AppCache </span><span class="line" data-startTime="495">has against Bruce's cat, but </span><span class="line" data-startTime="498">even online it's not </span><span class="line" data-startTime="498">going to work. </span></p>

<p><span class="line" data-startTime="502">This is a downfall API. </span> <span class="line" data-startTime="503">And by downfall, I don't mean </span><span class="line" data-startTime="503">the shouty Hitler thing. </span> <span class="line" data-startTime="507">I'm not suggesting AppCache </span><span class="line" data-startTime="507">is like Hitler &mdash; </span><span class="line" data-startTime="509">although it is a bit. </span> <span class="line" data-startTime="511">No, I mean the old board game. </span> <span class="line" data-startTime="513">I don't know how people have </span><span class="line" data-startTime="513">played this, but this is what </span><span class="line" data-startTime="515">I feel like when I'm dealing </span><span class="line" data-startTime="515">with AppCache. </span> <span class="line" data-startTime="517">I know what I'm trying to do. </span> <span class="line" data-startTime="518">I'm trying to get my pieces </span><span class="line" data-startTime="518">to the bottom. </span> <span class="line" data-startTime="520">And I have a very limited set </span><span class="line" data-startTime="520">of controls for that. </span> <span class="line" data-startTime="522">But when I'm doing this, all </span><span class="line" data-startTime="522">kinds of shit's happening in </span><span class="line" data-startTime="526">the background. </span> <span class="line" data-startTime="527">And I don't know what's going </span><span class="line" data-startTime="527">on until bits start falling </span><span class="line" data-startTime="529">out of the bottom that </span><span class="line" data-startTime="529">I didn't expect. </span></p>

<p><span class="line" data-startTime="533">And I don't know which of my </span><span class="line" data-startTime="533">actions actually contributed </span><span class="line" data-startTime="535">to that happening. </span> <span class="line" data-startTime="537">I know the last one that </span><span class="line" data-startTime="537">happens, but I don't </span><span class="line" data-startTime="538">everything that happened </span><span class="line" data-startTime="538">before that. </span> <span class="line" data-startTime="541">The manifest is simple in terms </span><span class="line" data-startTime="541">of the character count, </span><span class="line" data-startTime="544">but there's too much implicit </span><span class="line" data-startTime="544">going on here. </span> <span class="line" data-startTime="546">A better API may involve more </span><span class="line" data-startTime="546">typing but might set out </span><span class="line" data-startTime="550">exactly what's supposed </span><span class="line" data-startTime="550">to happen. </span></p>

<p><span class="line" data-startTime="551">What if in your HTML you could </span><span class="line" data-startTime="551">say, I want to register a </span><span class="line" data-startTime="555">JavaScript controller. </span> <span class="line" data-startTime="558">This controllers going to take </span><span class="line" data-startTime="558">care of all URLs on the </span><span class="line" data-startTime="561">origin, just slash-star. </span> <span class="line" data-startTime="562">And here's my JavaScript file. </span> <span class="line" data-startTime="564">And that was going to run </span><span class="line" data-startTime="564">in some kind of worker. </span> <span class="line" data-startTime="566">And here I could just say, so </span><span class="line" data-startTime="566">for all these files, when the </span><span class="line" data-startTime="569">cache is supposed to update </span><span class="line" data-startTime="569">itself, I want you to define a </span><span class="line" data-startTime="572">cache called static, and I want </span><span class="line" data-startTime="572">you to cache all of those </span><span class="line" data-startTime="574">static URLs and do </span><span class="line" data-startTime="574">it atomically. </span> <span class="line" data-startTime="576">And then when there's a request, </span><span class="line" data-startTime="576">I want you to have a </span><span class="line" data-startTime="580">look and see in the static cache </span><span class="line" data-startTime="580">if there's something </span><span class="line" data-startTime="582">that matches the incoming URL. </span></p>

<p><span class="line" data-startTime="584">And if there is a resource, </span><span class="line" data-startTime="584">prevent default. </span> <span class="line" data-startTime="586">Don't do the default </span><span class="line" data-startTime="586">browser action. </span> <span class="line" data-startTime="588">Respond with that resource </span><span class="line" data-startTime="588">from the cache. </span> <span class="line" data-startTime="591">This is a lot more typing than </span><span class="line" data-startTime="591">the equivalent that you did in </span><span class="line" data-startTime="596">the manifest, but it's </span><span class="line" data-startTime="596">really explicit. </span> <span class="line" data-startTime="598">You're setting up exactly </span><span class="line" data-startTime="598">what you want to happen. </span> <span class="line" data-startTime="601">There's no magic here. </span> <span class="line" data-startTime="604">You can define your own magic. </span> <span class="line" data-startTime="605">This is a bring your </span><span class="line" data-startTime="605">own unicorn API. </span> <span class="line" data-startTime="608">You do all that stuff </span><span class="line" data-startTime="608">yourself. </span> <span class="line" data-startTime="611">What if I could say, OK, I'm </span><span class="line" data-startTime="611">going to set up a route for </span><span class="line" data-startTime="614">get requests. </span> <span class="line" data-startTime="615">Anything that starts with </span><span class="line" data-startTime="615">avatars, prevent the default. </span></p>

<p><span class="line" data-startTime="618">I want you to try and get </span><span class="line" data-startTime="618">it from the network. </span> <span class="line" data-startTime="620">But on an error, I want you to </span><span class="line" data-startTime="620">see if we've got something, </span><span class="line" data-startTime="623">the fallback PNG in </span><span class="line" data-startTime="623">the resource. </span> <span class="line" data-startTime="626">And if there is, I'm </span><span class="line" data-startTime="626">going to serve it. </span> <span class="line" data-startTime="627">So that's the equivalent of </span><span class="line" data-startTime="627">your fallback, but you're </span><span class="line" data-startTime="629">telling it exactly what to do. </span> <span class="line" data-startTime="632">What if I could listen to </span><span class="line" data-startTime="632">messages from the web page </span><span class="line" data-startTime="636">that's happening? </span><span class="line" data-startTime="636">So imagine something like DFT, </span><span class="line" data-startTime="636">where there's issues. </span> <span class="line" data-startTime="639">And the user might have said, </span><span class="line" data-startTime="639">I want to cache this issue. </span> <span class="line" data-startTime="641">So he posted a message saying, </span><span class="line" data-startTime="641">cache the issue. </span></p>

<p><span class="line" data-startTime="644">And [INAUDIBLE] </span><span class="line" data-startTime="644">receives that, caches define </span><span class="line" data-startTime="644">issue, and then the issue </span><span class="line" data-startTime="647">number, and the URLs </span><span class="line" data-startTime="647">to cache for that. </span> <span class="line" data-startTime="649">And then when those requests </span><span class="line" data-startTime="649">come in, anything that's URL </span><span class="line" data-startTime="652">issue and a number, we're </span><span class="line" data-startTime="652">going to deal with that. </span> <span class="line" data-startTime="654">We're going to say get me the </span><span class="line" data-startTime="654">cache for that issue. </span> <span class="line" data-startTime="657">If we have that cached and we </span><span class="line" data-startTime="657">have a URL inside that cache </span><span class="line" data-startTime="660">that matches what's being </span><span class="line" data-startTime="660">requested, serve it. </span> <span class="line" data-startTime="662">Otherwise, if the request type </span><span class="line" data-startTime="662">is a navigate, as in, someone </span><span class="line" data-startTime="665">is changing page, it's going to </span><span class="line" data-startTime="665">be a full reload, prevent </span><span class="line" data-startTime="668">the default. </span> <span class="line" data-startTime="669">Respond &mdash; </span><span class="line" data-startTime="669">try and fetch it from the </span><span class="line" data-startTime="669">network as normal. </span> <span class="line" data-startTime="672">And if that fails, and the </span><span class="line" data-startTime="672">status code was zero, which </span><span class="line" data-startTime="674">suggests a lack of network </span><span class="line" data-startTime="674">connection, then serve a thing </span><span class="line" data-startTime="678">from the cache saying, no, I'm </span><span class="line" data-startTime="678">afraid you don't have that </span><span class="line" data-startTime="680">issue cached, here's why. </span></p>

<p><span class="line" data-startTime="682">And that's something we can't </span><span class="line" data-startTime="682">do with AppCache now. </span> <span class="line" data-startTime="685">Maybe you could do stuff like </span><span class="line" data-startTime="685">get stuff from local storage </span><span class="line" data-startTime="688">and then use Mustache to </span><span class="line" data-startTime="688">render it, or whatever </span><span class="line" data-startTime="691">templating language </span><span class="line" data-startTime="691">you included. </span> <span class="line" data-startTime="692">We could just completely build </span><span class="line" data-startTime="692">an app up from this experience </span><span class="line" data-startTime="695">and completely define how </span><span class="line" data-startTime="695">it should behave. </span> <span class="line" data-startTime="697">So even someone who is </span><span class="line" data-startTime="697">unfamiliar with the API would </span><span class="line" data-startTime="699">have a good idea of </span><span class="line" data-startTime="699">what it's doing. </span> <span class="line" data-startTime="701">They wouldn't have to read a </span><span class="line" data-startTime="701">whole spec to understand </span><span class="line" data-startTime="702">what's going on. </span> <span class="line" data-startTime="703">What if we could do that? </span><span class="line" data-startTime="706">And I think that's what we're </span><span class="line" data-startTime="706">going to discuss, or </span><span class="line" data-startTime="708">things around it. </span></p>

<p><span class="line" data-startTime="711">I don't how this transition &mdash; </span><span class="line" data-startTime="711">you have to clap. </span> <span class="line" data-startTime="713">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="730"><span class="speakerName">Jake Archibald</span>: Watch </span><span class="line" data-startTime="730">out, watch out. </span><span class="line" data-startTime="731">I think that's Andrew's </span><span class="line" data-startTime="731">seat, isn't it? </span></p>

<p class="speaker"><span class="line" data-starttime="741"><span class="speakerName">Andrew Bettis</span>: Right. </span> <span class="line" data-startTime="744">So I realized when Jake started </span><span class="line" data-startTime="744">that I completely </span><span class="line" data-startTime="748">forgot to big up all </span><span class="line" data-startTime="748">the people on the </span><span class="line" data-startTime="750">panel before we started. </span> <span class="line" data-startTime="752">So we have Jake, who's obviously </span><span class="line" data-startTime="752">just given his talk. </span> <span class="line" data-startTime="757">He's now developed relations </span><span class="line" data-startTime="757">for Google, </span><span class="line" data-startTime="760">formerly from Lanyard. </span> <span class="line" data-startTime="761">Mark Christian from Twitter, </span><span class="line" data-startTime="761">who also created one of the </span><span class="line" data-startTime="766">first informative sites about </span><span class="line" data-startTime="766">AppCache, appcachefaqs.info. </span> <span class="line" data-startTime="769">Alex Russell, also from Google, </span><span class="line" data-startTime="769">who is co-author of </span><span class="line" data-startTime="774">the proposal that Jake was just </span><span class="line" data-startTime="774">talking about, with the </span><span class="line" data-startTime="778">navigation controller. </span> <span class="line" data-startTime="780">And Jonas Sicking from Mozilla, </span><span class="line" data-startTime="780">who has very kindly </span><span class="line" data-startTime="783">signed up at the very last </span><span class="line" data-startTime="783">minute to replace [INAUDIBLE] </span><span class="line" data-startTime="785">Tobie Langel, who's </span><span class="line" data-startTime="785">unfortunately unable to make </span><span class="line" data-startTime="787">it because he's ill. </span> <span class="line" data-startTime="790">So let's get started. </span></p>

<p><span class="line" data-startTime="794">So we have loads of questions </span><span class="line" data-startTime="794">in moderator about offline. </span> <span class="line" data-startTime="797">And I think the most burning </span><span class="line" data-startTime="797">one for me, and I think the </span><span class="line" data-startTime="802">one that's most relevant to </span><span class="line" data-startTime="802">DFT is why is there such a </span><span class="line" data-startTime="808">constraint on what we </span><span class="line" data-startTime="808">can do offline? </span><span class="line" data-startTime="810">Why do we have such tiny limits </span><span class="line" data-startTime="810">on what we can store? </span><span class="line" data-startTime="815">And is this a problem that we </span><span class="line" data-startTime="815">need to solve at the spec </span><span class="line" data-startTime="818">level, or do we need an entire </span><span class="line" data-startTime="818">new technology to solve it? </span><span class="line" data-startTime="824">Jake, why don't you start? </span></p>

<p class="speaker"><span class="line" data-starttime="826"><span class="speakerName">Jake Archibald</span>: OK, so if you're </span><span class="line" data-startTime="826">building something, </span><span class="line" data-startTime="830">it's going to be running </span><span class="line" data-startTime="830">on multiple devices. </span> <span class="line" data-startTime="832">So you can't make too many </span><span class="line" data-startTime="832">expectations of the amount of </span><span class="line" data-startTime="837">data that you would be able to </span><span class="line" data-startTime="837">store on a particular device. </span> <span class="line" data-startTime="839">That said, one of the things </span><span class="line" data-startTime="839">we were looking at is the </span><span class="line" data-startTime="842">ability to request a </span><span class="line" data-startTime="842">permanent cache. </span> <span class="line" data-startTime="847">Because one of the problems </span><span class="line" data-startTime="847">we've got with the current </span><span class="line" data-startTime="848">cache is the browser may </span><span class="line" data-startTime="848">object at any point. </span> <span class="line" data-startTime="852">Has my microphone </span><span class="line" data-startTime="852">gone off again? </span><span class="line" data-startTime="854">Oh, whatever. </span> <span class="line" data-startTime="855">So the browser can just get </span><span class="line" data-startTime="855">rid of it at any point. </span> <span class="line" data-startTime="858">Oh, hello. </span> <span class="line" data-startTime="861">So what AppCache gives you is </span><span class="line" data-startTime="861">it says, one of these assets </span><span class="line" data-startTime="865">is not going to be ejected </span><span class="line" data-startTime="865">from the cache. </span> <span class="line" data-startTime="867">If anything's going to be </span><span class="line" data-startTime="867">ejected, they're all going to </span><span class="line" data-startTime="869">be ejected together. </span></p>

<p><span class="line" data-startTime="870">And the spec doesn't say that </span><span class="line" data-startTime="870">this stuff's going to be </span><span class="line" data-startTime="872">around forever. </span> <span class="line" data-startTime="873">So the idea is if we could </span><span class="line" data-startTime="873">make it where you would </span><span class="line" data-startTime="876">request a permanent cache, maybe </span><span class="line" data-startTime="876">of a particular size, </span><span class="line" data-startTime="880">then you could do </span><span class="line" data-startTime="880">that and that. </span> <span class="line" data-startTime="882">And because a user would agree </span><span class="line" data-startTime="882">to give you that, they are </span><span class="line" data-startTime="885">also now in control of </span><span class="line" data-startTime="885">uninstalling something. </span> <span class="line" data-startTime="887">So if there is a lack of space, </span><span class="line" data-startTime="887">like they run out of </span><span class="line" data-startTime="891">space on their phone, then it's </span><span class="line" data-startTime="891">down to them to decide </span><span class="line" data-startTime="894">what to keep and what to lose. </span> <span class="line" data-startTime="895">So they might go and say, well, </span><span class="line" data-startTime="895">this small FT app is </span><span class="line" data-startTime="899">very important to me, whereas </span><span class="line" data-startTime="899">these big game apps are not. </span> <span class="line" data-startTime="902">And it's their decision </span><span class="line" data-startTime="902">of what to do? </span></p>

<p class="speaker"><span class="line" data-starttime="905"><span class="speakerName">Andrew Bettis</span>: So what's the </span><span class="line" data-startTime="905">limit on what's reasonable? </span><span class="line" data-startTime="908">What's reasonable for an app </span><span class="line" data-startTime="908">to acclaim for its own </span><span class="line" data-startTime="911">exclusive use? </span></p>

<p class="speaker"><span class="line" data-starttime="913"><span class="speakerName">Ale Russell</span>: How is </span><span class="line" data-startTime="913">that a question </span><span class="line" data-startTime="914">for the app to answer? </span><span class="line" data-startTime="916">It's usually a question for </span><span class="line" data-startTime="916">the user to answer. </span> <span class="line" data-startTime="918">This is about the user agent </span><span class="line" data-startTime="918">mediating the conversation </span><span class="line" data-startTime="921">between the app developer and </span><span class="line" data-startTime="921">the user, who is the owner of </span><span class="line" data-startTime="925">the device. </span> <span class="line" data-startTime="926">And so you're trying to enable </span><span class="line" data-startTime="926">that conversation to happen in </span><span class="line" data-startTime="929">an informed way. </span> <span class="line" data-startTime="931">And usually that doesn't </span><span class="line" data-startTime="931">mean, can I </span><span class="line" data-startTime="932">have some bit of storage. </span></p>

<p><span class="line" data-startTime="935">It's usually did I mean </span><span class="line" data-startTime="935">to install this thing? </span><span class="line" data-startTime="937">Did I mean to turn this into </span><span class="line" data-startTime="937">a real thing that's not an </span><span class="line" data-startTime="939">ephemeral page that I happen </span><span class="line" data-startTime="939">to load and unload. </span> <span class="line" data-startTime="942">The question is, have my </span><span class="line" data-startTime="942">expectations been violated by </span><span class="line" data-startTime="946">navigating naked </span><span class="line" data-startTime="946">to a web page. </span> <span class="line" data-startTime="948">Did that imply that </span><span class="line" data-startTime="948">100 megabytes was </span><span class="line" data-startTime="950">taken on disk per page? </span><span class="line" data-startTime="953">If I'm going to Facebook every </span><span class="line" data-startTime="953">day, maybe it does. </span> <span class="line" data-startTime="955">Maybe that's a reasonable </span><span class="line" data-startTime="955">thing to do. </span> <span class="line" data-startTime="957">If I go to Twitter and I like </span><span class="line" data-startTime="957">to see all my history, maybe </span><span class="line" data-startTime="959">that's the most reasonable </span><span class="line" data-startTime="959">thing I </span><span class="line" data-startTime="960">could possibly imagine. </span> <span class="line" data-startTime="961">But that's a decision that </span><span class="line" data-startTime="961">I as a user should be </span><span class="line" data-startTime="964">at least part of. </span></p>

<p><span class="line" data-startTime="965">And so today we don't have </span><span class="line" data-startTime="965">that way to mediate it. </span> <span class="line" data-startTime="968">And so I [INAUDIBLE] </span><span class="line" data-startTime="969">there was an additional proposal </span><span class="line" data-startTime="969">yesterday that Jonas </span><span class="line" data-startTime="974">and others at Mozilla were </span><span class="line" data-startTime="974">working on to layer on top of </span><span class="line" data-startTime="978">this API that we have shown a </span><span class="line" data-startTime="978">little bit of, the idea of a </span><span class="line" data-startTime="984">more declarative manifest that </span><span class="line" data-startTime="984">has more to say about what the </span><span class="line" data-startTime="989">thing is that you would </span><span class="line" data-startTime="989">take an action on. </span></p>

<p class="speaker"><span class="line" data-starttime="992"><span class="speakerName">Jonas Sicking</span>: There's </span><span class="line" data-startTime="992">a few things here. </span> <span class="line" data-startTime="997">First of all, you shouldn't </span><span class="line" data-startTime="997">think of the web as being </span><span class="line" data-startTime="1000">different from native </span><span class="line" data-startTime="1000">applications. </span> <span class="line" data-startTime="1001">Native applications, once you </span><span class="line" data-startTime="1001">install a native application, </span><span class="line" data-startTime="1004">it can write as much </span><span class="line" data-startTime="1004">as it wants. </span> <span class="line" data-startTime="1005">Why should the web not be able </span><span class="line" data-startTime="1005">to do that, assuming the </span><span class="line" data-startTime="1008">user's fine with it. </span> <span class="line" data-startTime="1009">So we need to have some way of </span><span class="line" data-startTime="1009">communicating between the </span><span class="line" data-startTime="1013">application and the user that </span><span class="line" data-startTime="1013">the user thinks this website </span><span class="line" data-startTime="1019">is important and then wants to </span><span class="line" data-startTime="1019">enable it to store data on the </span><span class="line" data-startTime="1025">local device. </span> <span class="line" data-startTime="1028">So that is really something </span><span class="line" data-startTime="1028">we would need to enable. </span> <span class="line" data-startTime="1033">Google actually has some </span><span class="line" data-startTime="1033">interesting ideas here in the </span><span class="line" data-startTime="1037">[INAUDIBLE] </span><span class="line" data-startTime="1037">API, where they have this </span><span class="line" data-startTime="1037">concept of temporary storage </span><span class="line" data-startTime="1041">and permanent storage. </span> <span class="line" data-startTime="1042">That concept is something we </span><span class="line" data-startTime="1042">are working on expanding so </span><span class="line" data-startTime="1045">you can use that storage area to </span><span class="line" data-startTime="1045">store essentially anything </span><span class="line" data-startTime="1049">that you can store locally, you </span><span class="line" data-startTime="1049">can choose to [INAUDIBLE] </span><span class="line" data-startTime="1051">store permanently </span><span class="line" data-startTime="1051">or temporary. </span></p>

<p><span class="line" data-startTime="1053">And the user can then </span><span class="line" data-startTime="1053">be involved. </span> <span class="line" data-startTime="1055">And we can also use heuristics </span><span class="line" data-startTime="1055">in the browser. </span> <span class="line" data-startTime="1058">Like, if we know that the user </span><span class="line" data-startTime="1058">is using a website a lot, we </span><span class="line" data-startTime="1062">can grant that website more </span><span class="line" data-startTime="1062">implicit storage, and we can </span><span class="line" data-startTime="1065">be more careful about when </span><span class="line" data-startTime="1065">we eject that data. </span> <span class="line" data-startTime="1068">Or we can also enable the </span><span class="line" data-startTime="1068">website to say, I want to </span><span class="line" data-startTime="1071">really lock this down. </span> <span class="line" data-startTime="1072">And then once the user's OK with </span><span class="line" data-startTime="1072">that, we can guarantee </span><span class="line" data-startTime="1076">that certain data is </span><span class="line" data-startTime="1076">available offline. </span> <span class="line" data-startTime="1078">So the goal should really be </span><span class="line" data-startTime="1078">that anything that native </span><span class="line" data-startTime="1081">applications can do when it </span><span class="line" data-startTime="1081">comes to sorting data locally, </span><span class="line" data-startTime="1084">the web should be able to do. </span> <span class="line" data-startTime="1085">And that shouldn't be </span><span class="line" data-startTime="1085">hard to accomplish. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1089"><span class="speakerName">Andrew Bettis</span>: Is it currently </span><span class="line" data-startTime="1089">a problem that a user giving </span><span class="line" data-startTime="1093">explicit consent to store </span><span class="line" data-startTime="1093">something as an explicit </span><span class="line" data-startTime="1098">intention to store, but </span><span class="line" data-startTime="1098">then the browser can </span><span class="line" data-startTime="1100">implicitly purge it? </span><span class="line" data-startTime="1101">Is that a bug, do you think, </span><span class="line" data-startTime="1101">currently in implementation? </span><span class="line" data-startTime="1105">Should it be the case that </span><span class="line" data-startTime="1105">anything that's explicitly </span><span class="line" data-startTime="1107">given permission to be stored </span><span class="line" data-startTime="1107">should be explicitly removed </span><span class="line" data-startTime="1111">by the user? </span></p>

<p class="speaker"><span class="line" data-starttime="1113"><span class="speakerName">Jonas Sicking</span>: I think we need </span><span class="line" data-startTime="1113">to enable the scenario where </span><span class="line" data-startTime="1118">you're guaranteed that </span><span class="line" data-startTime="1118">something is wrong. </span> <span class="line" data-startTime="1121">The only way to guarantee that </span><span class="line" data-startTime="1121">something is wrong is to take </span><span class="line" data-startTime="1125">up storage on the user's device, </span><span class="line" data-startTime="1125">which means taking </span><span class="line" data-startTime="1129">resource away from the user. </span> <span class="line" data-startTime="1130">And so the user needs to be </span><span class="line" data-startTime="1130">involved in that decision. </span> <span class="line" data-startTime="1133">But in many cases, you don't </span><span class="line" data-startTime="1133">need that level of guarantee. </span> <span class="line" data-startTime="1136">And you could probably build </span><span class="line" data-startTime="1136">pretty good heuristics so that </span><span class="line" data-startTime="1140">things mostly work without </span><span class="line" data-startTime="1140">the user being involved. </span> <span class="line" data-startTime="1143">But I also think that we need </span><span class="line" data-startTime="1143">to enable websites to say, </span><span class="line" data-startTime="1148">hey, I really want to be able to </span><span class="line" data-startTime="1148">guarantee this to the user, </span><span class="line" data-startTime="1150">in which case we can </span><span class="line" data-startTime="1150">have interaction. </span> <span class="line" data-startTime="1153">We can have a security </span><span class="line" data-startTime="1153">dialogue. </span> <span class="line" data-startTime="1155">But as long as we make that </span><span class="line" data-startTime="1155">flow nice and don't ask &mdash; </span><span class="line" data-startTime="1158">like Firefox currently does, </span><span class="line" data-startTime="1158">asks you three times before it </span><span class="line" data-startTime="1164">grants you that permission. </span></p>

<p><span class="line" data-startTime="1166">It should be within the control </span><span class="line" data-startTime="1166">of the website when to </span><span class="line" data-startTime="1169">ask the user. </span> <span class="line" data-startTime="1170">And it should only </span><span class="line" data-startTime="1170">be one question. </span> <span class="line" data-startTime="1172">The user should just say, yeah, </span><span class="line" data-startTime="1172">I'm OK with giving this </span><span class="line" data-startTime="1174">website a little bit </span><span class="line" data-startTime="1174">more information. </span> <span class="line" data-startTime="1177">And we shouldn't need to ask </span><span class="line" data-startTime="1177">about individual [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="1181"><span class="speakerName">Andrew Bettis</span>: So can </span><span class="line" data-startTime="1181">I just a quick poll? </span><span class="line" data-startTime="1183">Who here has run out of space </span><span class="line" data-startTime="1183">when they were building an </span><span class="line" data-startTime="1186">offline app? </span><span class="line" data-startTime="1188">So we have a few </span><span class="line" data-startTime="1188">people who've &mdash; </span><span class="line" data-startTime="1191">OK, interesting. </span></p>

<p class="speaker"><span class="line" data-starttime="1193"><span class="speakerName">Alex Russell</span>: I think it's </span><span class="line" data-startTime="1193">also a UX issue. </span> <span class="line" data-startTime="1195">There's the what is it </span><span class="line" data-startTime="1195">that I'm doing here? </span><span class="line" data-startTime="1198">Are we going to ask users </span><span class="line" data-startTime="1198">honestly to go reason about </span><span class="line" data-startTime="1201">their storage independently of </span><span class="line" data-startTime="1201">what the application is? </span><span class="line" data-startTime="1205">I don't think that people, </span><span class="line" data-startTime="1205">generally speaking &mdash; certainly </span><span class="line" data-startTime="1207">not the app platform models </span><span class="line" data-startTime="1207">that we have today &mdash; </span><span class="line" data-startTime="1213">I don't think people reason </span><span class="line" data-startTime="1213">about them independently. </span> <span class="line" data-startTime="1215">You have an application, and </span><span class="line" data-startTime="1215">that means that you have its </span><span class="line" data-startTime="1217">data as well. </span> <span class="line" data-startTime="1219">And we don't really have a </span><span class="line" data-startTime="1219">reified idea of what an </span><span class="line" data-startTime="1222">application is. </span> <span class="line" data-startTime="1223">That's the thing that we don't </span><span class="line" data-startTime="1223">have, as a unit of something </span><span class="line" data-startTime="1228">that we can communicate </span><span class="line" data-startTime="1228">to end users today. </span> <span class="line" data-startTime="1230">And Mozilla's building an app </span><span class="line" data-startTime="1230">platform, and we're building </span><span class="line" data-startTime="1232">an app platform. </span> <span class="line" data-startTime="1233">And they helped unify </span><span class="line" data-startTime="1233">that concept. </span></p>

<p><span class="line" data-startTime="1235">And it feels to me like </span><span class="line" data-startTime="1235">helping to make that </span><span class="line" data-startTime="1238">transition from I've got a page </span><span class="line" data-startTime="1238">to look, it's also an </span><span class="line" data-startTime="1241">application &mdash; </span><span class="line" data-startTime="1242">I think that's really the big </span><span class="line" data-startTime="1242">transition for everyone who's </span><span class="line" data-startTime="1245">building apps, both conceptually </span><span class="line" data-startTime="1245">as you're </span><span class="line" data-startTime="1248">building them and for users </span><span class="line" data-startTime="1248">who are consuming them. </span> <span class="line" data-startTime="1251">I'd like to talk more at some </span><span class="line" data-startTime="1251">point about what it means to </span><span class="line" data-startTime="1253">transition as a builder thinking </span><span class="line" data-startTime="1253">about an app &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="1255"><span class="speakerName">Andrew Bettis</span>: Well, your </span><span class="line" data-startTime="1255">microphone's not working. </span><span class="line" data-startTime="1257">So next time you want to speak, </span><span class="line" data-startTime="1257">just let me know. </span><span class="line" data-startTime="1258">And you can speak into mine. </span></p>

<p class="speaker"><span class="line" data-starttime="1261"><span class="speakerName">Male Speaker</span>: His </span><span class="line" data-startTime="1261">mic works fine. </span><span class="line" data-startTime="1262">But he can't talk over his </span><span class="line" data-startTime="1262">shoulder to Andrew. </span><span class="line" data-startTime="1264">He's got to talk directly </span><span class="line" data-startTime="1264">[INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="1266"><span class="speakerName">Alex Russell</span>: Sorry </span><span class="line" data-startTime="1266">about that. </span></p>

<p class="speaker"><span class="line" data-starttime="1267"><span class="speakerName">Mark Christian</span>: So I think that </span><span class="line" data-startTime="1267">part of the problem with </span><span class="line" data-startTime="1269">the situation right now is that </span><span class="line" data-startTime="1269">web applications feel a </span><span class="line" data-startTime="1273">little bit different than </span><span class="line" data-startTime="1273">websites, but they're all </span><span class="line" data-startTime="1274">running in the same universe. </span> <span class="line" data-startTime="1276">And when you're building an </span><span class="line" data-startTime="1276">application, you want to have </span><span class="line" data-startTime="1278">quite a bit of control over </span><span class="line" data-startTime="1278">how you're storing your </span><span class="line" data-startTime="1281">resources and managing the </span><span class="line" data-startTime="1281">user data, whereas </span><span class="line" data-startTime="1283">historically, web APIs have been </span><span class="line" data-startTime="1283">more like suggestions to </span><span class="line" data-startTime="1286">the user agent. </span> <span class="line" data-startTime="1287">It's up to the user agent to </span><span class="line" data-startTime="1287">interpret what's going on and </span><span class="line" data-startTime="1290">deal with it appropriately. </span></p>

<p><span class="line" data-startTime="1292">AppCache demonstrates that </span><span class="line" data-startTime="1292">there's a lot of assumptions </span><span class="line" data-startTime="1295">built into that that don't </span><span class="line" data-startTime="1295">always work, and it makes it </span><span class="line" data-startTime="1297">difficult to have a consistent </span><span class="line" data-startTime="1297">experience. </span> <span class="line" data-startTime="1298">So I think part of the problem </span><span class="line" data-startTime="1298">is actually philosophical. </span> <span class="line" data-startTime="1301">As we go forward and build a new </span><span class="line" data-startTime="1301">API, how much control do </span><span class="line" data-startTime="1306">we want to let these </span><span class="line" data-startTime="1306">applications have? </span><span class="line" data-startTime="1308">And it's a trust </span><span class="line" data-startTime="1308">issue as well. </span> <span class="line" data-startTime="1310">Going to a random website, how </span><span class="line" data-startTime="1310">much trust does that actually </span><span class="line" data-startTime="1313">imply that user has? </span></p>

<p class="speaker"><span class="line" data-starttime="1315"><span class="speakerName">Jake Archibald</span>: I think we could </span><span class="line" data-startTime="1315">spend the whole of today </span><span class="line" data-startTime="1318">trying to work out what the </span><span class="line" data-startTime="1318">difference between a website </span><span class="line" data-startTime="1320">and a web app is. </span> <span class="line" data-startTime="1320">And I think at the end of it, </span><span class="line" data-startTime="1320">we'd say, well, does it </span><span class="line" data-startTime="1324">actually matter? </span><span class="line" data-startTime="1326">Once we've made that decision, </span><span class="line" data-startTime="1326">what would we do differently? </span><span class="line" data-startTime="1330">So I think this API we're making </span><span class="line" data-startTime="1330">now would work fine for </span><span class="line" data-startTime="1334">sites and work fine for apps. </span> <span class="line" data-startTime="1338">What do you see as the </span><span class="line" data-startTime="1338">difference between the two? </span></p>

<p class="speaker"><span class="line" data-starttime="1341"><span class="speakerName">Mark Christian</span>: Probably </span><span class="line" data-startTime="1341">persistence of storage and </span><span class="line" data-startTime="1344">amount of storage. </span><span class="line" data-startTime="1345">Those are the characteristics. </span><span class="line" data-startTime="1346">Do you want a random website to </span><span class="line" data-startTime="1346">be able to dump a gigabyte </span><span class="line" data-startTime="1349">of data onto your hard drive? </span></p>

<p class="speaker"><span class="line" data-starttime="1351"><span class="speakerName">Jake Archibald</span>: Well, I might </span><span class="line" data-startTime="1351">if it's Wikipedia. </span><span class="line" data-startTime="1352">I might want to download </span><span class="line" data-startTime="1352">Wikipedia as a site. </span></p>

<p class="speaker"><span class="line" data-starttime="1355"><span class="speakerName">Mark Christian</span>: Yeah, </span><span class="line" data-startTime="1355">I might too. </span><span class="line" data-startTime="1356">But there's no good model for </span><span class="line" data-startTime="1356">letting a user illustrate that </span><span class="line" data-startTime="1359">that's actually what </span><span class="line" data-startTime="1359">they really wanted. </span></p>

<p class="speaker"><span class="line" data-starttime="1363"><span class="speakerName">Jonas Sicking</span>: I think one </span><span class="line" data-startTime="1363">problem we have is that </span><span class="line" data-startTime="1366">historically websites have been </span><span class="line" data-startTime="1366">these things where, as a </span><span class="line" data-startTime="1371">browser, we treat them as &mdash; </span><span class="line" data-startTime="1371">we have no idea if this is </span><span class="line" data-startTime="1374">something that the user </span><span class="line" data-startTime="1374">actually likes. </span> <span class="line" data-startTime="1376">It might be just some random </span><span class="line" data-startTime="1376">website that the user found </span><span class="line" data-startTime="1379">through a link in </span><span class="line" data-startTime="1379">a spam email. </span> <span class="line" data-startTime="1381">And so we have this very </span><span class="line" data-startTime="1381">distrusting relationship of </span><span class="line" data-startTime="1384">the website. </span> <span class="line" data-startTime="1385">And as we're trying to expand </span><span class="line" data-startTime="1385">the web into being able to do </span><span class="line" data-startTime="1389">more things, we have to enable </span><span class="line" data-startTime="1389">the user to indicate, I </span><span class="line" data-startTime="1394">actually trust this website. </span> <span class="line" data-startTime="1396">I actually enjoy this website. </span> <span class="line" data-startTime="1398">I want this website to be able </span><span class="line" data-startTime="1398">to do things that [INAUDIBLE] </span><span class="line" data-startTime="1402">shouldn't be able to do. </span> <span class="line" data-startTime="1404">So we need some way, some </span><span class="line" data-startTime="1404">UX to enable the user to </span><span class="line" data-startTime="1408">communicate to the browser that, </span><span class="line" data-startTime="1408">hey, it's OK for this </span><span class="line" data-startTime="1412">website to get some extra </span><span class="line" data-startTime="1412">capabilities. </span></p>

<p><span class="line" data-startTime="1417">So one way of doing this is </span><span class="line" data-startTime="1417">app platforms that both </span><span class="line" data-startTime="1421">Firefox and Chrome OS is having, </span><span class="line" data-startTime="1421">which enables the </span><span class="line" data-startTime="1427">users to go through this install </span><span class="line" data-startTime="1427">flow, at which point, </span><span class="line" data-startTime="1429">you indicated that yeah, I trust </span><span class="line" data-startTime="1429">this website enough that </span><span class="line" data-startTime="1434">I have installed it. </span> <span class="line" data-startTime="1436">We should enable those </span><span class="line" data-startTime="1436">capabilities not just through </span><span class="line" data-startTime="1439">install flow but also through </span><span class="line" data-startTime="1439">other means where it's still a </span><span class="line" data-startTime="1442">website, UX-wise, but you've </span><span class="line" data-startTime="1442">indicated some other way that </span><span class="line" data-startTime="1447">it's OK for this guy to </span><span class="line" data-startTime="1447">use more resources. </span> <span class="line" data-startTime="1450">The two things in Firefox OS </span><span class="line" data-startTime="1450">that we're giving a website </span><span class="line" data-startTime="1454">once it's installed is ability </span><span class="line" data-startTime="1454">to use resources and ability </span><span class="line" data-startTime="1457">to annoy the user. </span></p>

<p><span class="line" data-startTime="1458">So on the web, we built </span><span class="line" data-startTime="1458">pop-up blockers. </span> <span class="line" data-startTime="1463">We tried to disable this ability </span><span class="line" data-startTime="1463">of disabling the </span><span class="line" data-startTime="1466">context menu. </span> <span class="line" data-startTime="1467">And a lot of the things that </span><span class="line" data-startTime="1467">it's really nice if the good </span><span class="line" data-startTime="1469">guys can do but we don't want </span><span class="line" data-startTime="1469">the bad guys to do. </span> <span class="line" data-startTime="1472">And so if we can have some way </span><span class="line" data-startTime="1472">to use UX to indicate that </span><span class="line" data-startTime="1478">this website should be able to </span><span class="line" data-startTime="1478">do things, then we can enable </span><span class="line" data-startTime="1481">much more [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="1482"><span class="speakerName">Andrew Bettis</span>: Do you think that </span><span class="line" data-startTime="1482">using app runtimes as a </span><span class="line" data-startTime="1487">solution to offline problems </span><span class="line" data-startTime="1487">is good enough? </span><span class="line" data-startTime="1491">Or do you think that we ought </span><span class="line" data-startTime="1491">to be able to solve these </span><span class="line" data-startTime="1493">problems without using </span><span class="line" data-startTime="1493">app runtime? </span></p>

<p class="speaker"><span class="line" data-starttime="1496"><span class="speakerName">Jonas Sicking</span>: I think app </span><span class="line" data-startTime="1496">runtimes is a good way for us </span><span class="line" data-startTime="1498">to experiment, but </span><span class="line" data-startTime="1498">it's an easy out. </span><span class="line" data-startTime="1503">We have this traditional sense </span><span class="line" data-startTime="1503">of what an application is. </span><span class="line" data-startTime="1506">And traditional users know what </span><span class="line" data-startTime="1506">it means to install an </span><span class="line" data-startTime="1511">application, as far as I know </span><span class="line" data-startTime="1511">that this enables this </span><span class="line" data-startTime="1514">application to do more things. </span><span class="line" data-startTime="1517">I shouldn't install </span><span class="line" data-startTime="1517">it if I hate it. </span><span class="line" data-startTime="1520">So it gives us an easy </span><span class="line" data-startTime="1520">out, but it's </span><span class="line" data-startTime="1523">definitely not good enough. </span><span class="line" data-startTime="1525">There needs to be a fluid </span><span class="line" data-startTime="1525">transition from being a </span><span class="line" data-startTime="1529">potentially evil spam website </span><span class="line" data-startTime="1529">that the user has navigated to </span><span class="line" data-startTime="1532">being a fully-trusted </span><span class="line" data-startTime="1532">installed app. </span><span class="line" data-startTime="1535">It's a smooth transition. </span><span class="line" data-startTime="1536">And the user, as you're slowly </span><span class="line" data-startTime="1536">getting more and more familiar </span><span class="line" data-startTime="1539">with the website, it shouldn't </span><span class="line" data-startTime="1539">be a hard path. </span><span class="line" data-startTime="1541">It should be, you trust it more </span><span class="line" data-startTime="1541">and more, and it gets </span><span class="line" data-startTime="1544">more and more capabilities as </span><span class="line" data-startTime="1544">the user gives it more and </span><span class="line" data-startTime="1547">more trust. </span><span class="line" data-startTime="1549">App runtimes is definitely </span><span class="line" data-startTime="1549">not enough of an answer. </span></p>

<p class="speaker"><span class="line" data-starttime="1553"><span class="speakerName">Jake Archibald</span>: Yeah, we've been </span><span class="line" data-startTime="1553">through that same problem </span><span class="line" data-startTime="1554">before with Flash. </span><span class="line" data-startTime="1556">I mean, we went for so long with </span><span class="line" data-startTime="1556">not adding these APIs to </span><span class="line" data-startTime="1559">HTML, saying, oh, if you want </span><span class="line" data-startTime="1559">those kind of capabilities, do </span><span class="line" data-startTime="1561">it in a plug-in. </span><span class="line" data-startTime="1562">And we're seeing the same again </span><span class="line" data-startTime="1562">with, oh, if you want </span><span class="line" data-startTime="1564">those kind of things, just </span><span class="line" data-startTime="1564">do it in an app. </span><span class="line" data-startTime="1567">We shouldn't let that stop us </span><span class="line" data-startTime="1567">making the platform better. </span></p>

<p class="speaker"><span class="line" data-starttime="1570"><span class="speakerName">Andrew Bettis</span>: Jake and Alex, </span><span class="line" data-startTime="1570">you're proposing actually a </span><span class="line" data-startTime="1574">controller that gives the </span><span class="line" data-startTime="1574">developer a lot of flexibility </span><span class="line" data-startTime="1578">over how they respond to </span><span class="line" data-startTime="1578">offline situations. </span><span class="line" data-startTime="1584">There's a great question in </span><span class="line" data-startTime="1584">Moderator which is, how would </span><span class="line" data-startTime="1587">you propose to use that </span><span class="line" data-startTime="1587">to handle the </span><span class="line" data-startTime="1590">one-legged dog scenario? </span></p>

<p class="speaker"><span class="line" data-starttime="1592"><span class="speakerName">Alex Russell</span>: So I think </span><span class="line" data-startTime="1592">the answer to this is &mdash; </span><span class="line" data-startTime="1597">it's a little bit circuitous, </span><span class="line" data-startTime="1597">so stick with me. </span> <span class="line" data-startTime="1600">The way AppCache works, </span><span class="line" data-startTime="1600">generally speaking, when it </span><span class="line" data-startTime="1603">works, is to help you take the </span><span class="line" data-startTime="1603">shell of an application, the </span><span class="line" data-startTime="1607">thing that will load content </span><span class="line" data-startTime="1607">and then display it to you </span><span class="line" data-startTime="1609">while your offline, package that </span><span class="line" data-startTime="1609">up, and make it available </span><span class="line" data-startTime="1612">to you at all points. </span> <span class="line" data-startTime="1614">What Jake showed you was a great </span><span class="line" data-startTime="1614">way for you to package </span><span class="line" data-startTime="1616">up the shell of a content </span><span class="line" data-startTime="1616">application using AppCache. </span> <span class="line" data-startTime="1620">There's a related question, </span><span class="line" data-startTime="1620">which is inflated by the API </span><span class="line" data-startTime="1624">of AppCache, unfortunately, </span><span class="line" data-startTime="1624">which is, how do I then deal </span><span class="line" data-startTime="1627">with the content that I'm </span><span class="line" data-startTime="1627">loading inside this shell? </span><span class="line" data-startTime="1630">Because every app you </span><span class="line" data-startTime="1630">load in native </span><span class="line" data-startTime="1631">environment has this duality. </span></p>

<p><span class="line" data-startTime="1632">I've got shell, and I've got a </span><span class="line" data-startTime="1632">library of content that I'm </span><span class="line" data-startTime="1635">navigating. </span> <span class="line" data-startTime="1636">And if you think about the way </span><span class="line" data-startTime="1636">you're building things on the </span><span class="line" data-startTime="1637">server, you do exactly </span><span class="line" data-startTime="1637">the same thing. </span> <span class="line" data-startTime="1639">You've got this node graph of </span><span class="line" data-startTime="1639">content that you're allowing </span><span class="line" data-startTime="1644">users to transition through, </span><span class="line" data-startTime="1644">and they're </span><span class="line" data-startTime="1645">all mapped to URLs. </span> <span class="line" data-startTime="1647">But you usually take the little </span><span class="line" data-startTime="1647">bit of content that's </span><span class="line" data-startTime="1649">unique to that URL, and you </span><span class="line" data-startTime="1649">smash a gigantic template </span><span class="line" data-startTime="1652">thing around it, and you spit </span><span class="line" data-startTime="1652">it all out as a string, and </span><span class="line" data-startTime="1654">then you rehydrate it </span><span class="line" data-startTime="1654">on the client side. </span> <span class="line" data-startTime="1657">But that isn't what the URL </span><span class="line" data-startTime="1657">is really addressing. </span> <span class="line" data-startTime="1659">The URL addresses that little </span><span class="line" data-startTime="1659">bit of content, that unique </span><span class="line" data-startTime="1661">bit of indivisible content </span><span class="line" data-startTime="1661">that you're </span><span class="line" data-startTime="1664">serving at that URL. </span> <span class="line" data-startTime="1665">And it may be multiple nodes all </span><span class="line" data-startTime="1665">joined into one particular </span><span class="line" data-startTime="1669">serialization. </span></p>

<p><span class="line" data-startTime="1670">But that's sort of the idea. </span> <span class="line" data-startTime="1672">So the question is, how do </span><span class="line" data-startTime="1672">we enable people to build </span><span class="line" data-startTime="1675">application architectures </span><span class="line" data-startTime="1675">offline, which easily give you </span><span class="line" data-startTime="1679">that shell and the ability to </span><span class="line" data-startTime="1679">cache resources which you will </span><span class="line" data-startTime="1683">load inside that shell, so that </span><span class="line" data-startTime="1683">you can discover them, so </span><span class="line" data-startTime="1685">you can load them, you can </span><span class="line" data-startTime="1685">provide the fallback </span><span class="line" data-startTime="1686">experience if you </span><span class="line" data-startTime="1686">don't have them. </span> <span class="line" data-startTime="1688">Today, AppCache rolls them </span><span class="line" data-startTime="1688">all into one manifest. </span> <span class="line" data-startTime="1691">Because today, if you actually </span><span class="line" data-startTime="1691">take the AppCache to its </span><span class="line" data-startTime="1694">logical conclusion, what you </span><span class="line" data-startTime="1694">realize at the end of this </span><span class="line" data-startTime="1696">long, painful journey &mdash; which </span><span class="line" data-startTime="1696">Jake took, and which the Gmail </span><span class="line" data-startTime="1698">team took, and which a lot of </span><span class="line" data-startTime="1698">people who have been building </span><span class="line" data-startTime="1701">offline apps have taken </span><span class="line" data-startTime="1701">independently &mdash; </span><span class="line" data-startTime="1703">is that AppCache is the </span><span class="line" data-startTime="1703">thing that you use </span><span class="line" data-startTime="1704">to cache the shell. </span></p>

<p><span class="line" data-startTime="1706">And for all other content, which </span><span class="line" data-startTime="1706">you would have liked to </span><span class="line" data-startTime="1708">have given a nice URL, what you </span><span class="line" data-startTime="1708">do is you build an ad hoc </span><span class="line" data-startTime="1711">synchronization protocol, you </span><span class="line" data-startTime="1711">put it in Web SQL Database or </span><span class="line" data-startTime="1714">IndexDB or local storage. </span> <span class="line" data-startTime="1716">And then every time someone </span><span class="line" data-startTime="1716">navigates to that URL, you try </span><span class="line" data-startTime="1718">to override what the browser </span><span class="line" data-startTime="1718">was going to do to navigate </span><span class="line" data-startTime="1721">you, go get it out of the local </span><span class="line" data-startTime="1721">storage if you have it, </span><span class="line" data-startTime="1724">and then perform your </span><span class="line" data-startTime="1724">own synchronization </span><span class="line" data-startTime="1725">on that data model. </span> <span class="line" data-startTime="1726">So you have a data model which </span><span class="line" data-startTime="1726">is not represented at those </span><span class="line" data-startTime="1728">URLs anymore. </span></p>

<p><span class="line" data-startTime="1730">So the default model is </span><span class="line" data-startTime="1730">effectively URL hostile. </span> <span class="line" data-startTime="1733">And the only thing that's helped </span><span class="line" data-startTime="1733">by having it at a URL </span><span class="line" data-startTime="1735">is loading the initial shell, </span><span class="line" data-startTime="1735">which is the least meaningful </span><span class="line" data-startTime="1738">thing in terms of URL space. </span> <span class="line" data-startTime="1740">So what you'd really like to </span><span class="line" data-startTime="1740">do in all this is to help </span><span class="line" data-startTime="1745">application owners understand </span><span class="line" data-startTime="1745">through the API that your </span><span class="line" data-startTime="1748">caching two separate </span><span class="line" data-startTime="1748">sets of things. </span> <span class="line" data-startTime="1750">There's a shell, which is your </span><span class="line" data-startTime="1750">browser for your content. </span> <span class="line" data-startTime="1753">There's the browser that </span><span class="line" data-startTime="1753">you browse to different </span><span class="line" data-startTime="1755">sites and apps with. </span> <span class="line" data-startTime="1756">But there's the browser that you </span><span class="line" data-startTime="1756">build for the content that </span><span class="line" data-startTime="1759">you're surfacing inside </span><span class="line" data-startTime="1759">your app. </span> <span class="line" data-startTime="1761">And then there's the </span><span class="line" data-startTime="1761">content of the app. </span> <span class="line" data-startTime="1763">You need to treat them </span><span class="line" data-startTime="1763">independently, but you'd like </span><span class="line" data-startTime="1764">them both to be cacheable </span><span class="line" data-startTime="1764">as HTTP resources. </span></p>

<p><span class="line" data-startTime="1767">So the way to get there is </span><span class="line" data-startTime="1767">to change expectations. </span> <span class="line" data-startTime="1770">There's no app that you're </span><span class="line" data-startTime="1770">going to build that's </span><span class="line" data-startTime="1772">meaningful that's not </span><span class="line" data-startTime="1772">offline by default. </span> <span class="line" data-startTime="1775">AppCache gets you part of the </span><span class="line" data-startTime="1775">way there, because it makes </span><span class="line" data-startTime="1777">the resources for your app </span><span class="line" data-startTime="1777">shell offline by default. </span> <span class="line" data-startTime="1780">But it doesn't necessarily do </span><span class="line" data-startTime="1780">anything particular for the </span><span class="line" data-startTime="1783">resources that you would like </span><span class="line" data-startTime="1783">to load inside that shell. </span> <span class="line" data-startTime="1786">So we have to make this </span><span class="line" data-startTime="1786">transition in thinking about </span><span class="line" data-startTime="1788">building apps in this world, </span><span class="line" data-startTime="1788">which is, we're not building a </span><span class="line" data-startTime="1792">series of HTML pages that you're </span><span class="line" data-startTime="1792">going to serialize at a </span><span class="line" data-startTime="1795">URL fully formed from the server </span><span class="line" data-startTime="1795">side as strings that </span><span class="line" data-startTime="1800">you're going to put back </span><span class="line" data-startTime="1800">into the cache. </span> <span class="line" data-startTime="1801">It's nonsensical. </span></p>

<p><span class="line" data-startTime="1802">It doesn't work. </span> <span class="line" data-startTime="1804">Instead what you're going to do </span><span class="line" data-startTime="1804">is you're going to assume </span><span class="line" data-startTime="1805">that there's a shell that's </span><span class="line" data-startTime="1805">booted, and you're moving </span><span class="line" data-startTime="1807">between the cached resources, </span><span class="line" data-startTime="1807">and if you can get to them, </span><span class="line" data-startTime="1810">the uncached ones. </span> <span class="line" data-startTime="1811">And that means that you're </span><span class="line" data-startTime="1811">always working from this local </span><span class="line" data-startTime="1814">store of your shell and your </span><span class="line" data-startTime="1814">content in order to do </span><span class="line" data-startTime="1817">everything. </span> <span class="line" data-startTime="1818">And that's the big transition </span><span class="line" data-startTime="1818">that has been conflated with </span><span class="line" data-startTime="1822">the use of AppCache over time. </span> <span class="line" data-startTime="1825">And everyone discovers that </span><span class="line" data-startTime="1825">that's what AppCache implies, </span><span class="line" data-startTime="1827">but it's not clear. </span> <span class="line" data-startTime="1829">And it's not clear that that's </span><span class="line" data-startTime="1829">how you have to build your </span><span class="line" data-startTime="1831">application to be successful. </span></p>

<p class="speaker"><span class="line" data-starttime="1832"><span class="speakerName">Jake Archibald</span>: So I would see </span><span class="line" data-startTime="1832">the model working if you </span><span class="line" data-startTime="1835">imagine an app &mdash; </span><span class="line" data-startTime="1836">I think I'm all right. </span> <span class="line" data-startTime="1837">If you imagine an app &mdash; </span><span class="line" data-startTime="1837">no, I'm not. </span> <span class="line" data-startTime="1840">If you imagine an app where it's </span><span class="line" data-startTime="1840">a series of messages from </span><span class="line" data-startTime="1844">people you're subscribed to &mdash; </span><span class="line" data-startTime="1845">basically Twitter &mdash; </span><span class="line" data-startTime="1847">if you visit the page and you </span><span class="line" data-startTime="1847">don't have a controller </span><span class="line" data-startTime="1849">installed, and you don't have </span><span class="line" data-startTime="1849">JavaScript, the server is </span><span class="line" data-startTime="1851">going to construct all </span><span class="line" data-startTime="1851">of this stuff. </span> <span class="line" data-startTime="1852">You'll have to wait for a </span><span class="line" data-startTime="1852">network who responds, and </span><span class="line" data-startTime="1854">you'll get it how internet </span><span class="line" data-startTime="1854">should work today. </span> <span class="line" data-startTime="1858">If you have a controller </span><span class="line" data-startTime="1858">installed, it's going to </span><span class="line" data-startTime="1860">respond with an empty content </span><span class="line" data-startTime="1860">shell of the UI, it's going to </span><span class="line" data-startTime="1864">kick off an XHR or request on </span><span class="line" data-startTime="1864">your page, but it's going to </span><span class="line" data-startTime="1868">have a header or query </span><span class="line" data-startTime="1868">strings saying, I'm </span><span class="line" data-startTime="1870">OK with cached data. </span> <span class="line" data-startTime="1872">The controller is going to </span><span class="line" data-startTime="1872">see that and return the </span><span class="line" data-startTime="1875">last data you saw. </span> <span class="line" data-startTime="1876">You're going to build </span><span class="line" data-startTime="1876">up the page. </span> <span class="line" data-startTime="1877">And that's going to </span><span class="line" data-startTime="1877">happen instantly. </span></p>

<p><span class="line" data-startTime="1879">But then it will set off another </span><span class="line" data-startTime="1879">XHR, something in a </span><span class="line" data-startTime="1881">query string, saying, I want </span><span class="line" data-startTime="1881">this data to come from online. </span> <span class="line" data-startTime="1885">And that connection will either </span><span class="line" data-startTime="1885">succeed, in which case </span><span class="line" data-startTime="1888">you'll replace the content on </span><span class="line" data-startTime="1888">the screen with the new stuff, </span><span class="line" data-startTime="1891">or it will fail, and you'll </span><span class="line" data-startTime="1891">fail silently. </span> <span class="line" data-startTime="1892">And that's your offline </span><span class="line" data-startTime="1892">experience. </span></p>

<p class="speaker"><span class="line" data-starttime="1895"><span class="speakerName">Andrew Bettis</span>: Can I pick up &mdash; </span><span class="line" data-startTime="1897">you were talking about the </span><span class="line" data-startTime="1897">failure scenario of trying to </span><span class="line" data-startTime="1900">load content and then it failing </span><span class="line" data-startTime="1900">and falling back to </span><span class="line" data-startTime="1903">content from cache. </span><span class="line" data-startTime="1904">So the biggest problem we have </span><span class="line" data-startTime="1904">with AppCache with the </span><span class="line" data-startTime="1907">fallback is that you can't </span><span class="line" data-startTime="1907">control that timeout. </span><span class="line" data-startTime="1909">You can't determine how long </span><span class="line" data-startTime="1909">that's going to be, and it's </span><span class="line" data-startTime="1911">usually longer than a user </span><span class="line" data-startTime="1911">is prepared to wait. </span><span class="line" data-startTime="1913">So in the scenario of using a </span><span class="line" data-startTime="1913">navigation controller, in </span><span class="line" data-startTime="1916">which you'd be able to configure </span><span class="line" data-startTime="1916">what that timeout </span><span class="line" data-startTime="1918">is, how long are you </span><span class="line" data-startTime="1918">prepared to wait? </span></p>

<p class="speaker"><span class="line" data-starttime="1923"><span class="speakerName">Alex Russell</span>: You have explicit </span><span class="line" data-startTime="1923">control under the </span><span class="line" data-startTime="1924">controller scenario over </span><span class="line" data-startTime="1924">the loading process. </span> <span class="line" data-startTime="1927">So you are able to make </span><span class="line" data-startTime="1927">a decision when you're </span><span class="line" data-startTime="1931">dispatching the request in the </span><span class="line" data-startTime="1931">first place, do I know that </span><span class="line" data-startTime="1934">I'm offline? </span><span class="line" data-startTime="1935">The only thing that we can </span><span class="line" data-startTime="1935">actually tell you from the </span><span class="line" data-startTime="1936">browser's perspective about </span><span class="line" data-startTime="1936">your online versus offline </span><span class="line" data-startTime="1939">state is that you are </span><span class="line" data-startTime="1939">definitively not connected to </span><span class="line" data-startTime="1941">any network. </span> <span class="line" data-startTime="1942">We can't tell you whether or not </span><span class="line" data-startTime="1942">you can hit your server. </span> <span class="line" data-startTime="1944">We can't tell you anything about </span><span class="line" data-startTime="1944">what's reasonable in </span><span class="line" data-startTime="1945">terms of expectation for </span><span class="line" data-startTime="1945">hitting your server. </span></p>

<p><span class="line" data-startTime="1947">We can tell you if you're behind </span><span class="line" data-startTime="1947">a hostile proxy or </span><span class="line" data-startTime="1949">inside of a captive portal </span><span class="line" data-startTime="1949">from some Wi-Fi thing. </span> <span class="line" data-startTime="1953">We can't tell you any of that. </span> <span class="line" data-startTime="1954">That's going to be up to </span><span class="line" data-startTime="1954">your application to </span><span class="line" data-startTime="1955">have to figure out. </span> <span class="line" data-startTime="1956">And the way you do that is by </span><span class="line" data-startTime="1956">making one these requests and </span><span class="line" data-startTime="1959">then watching what happens. </span> <span class="line" data-startTime="1960">So yes, you'll be able to cancel </span><span class="line" data-startTime="1960">the request and respond </span><span class="line" data-startTime="1965">with I have no idea </span><span class="line" data-startTime="1965">what's going on. </span> <span class="line" data-startTime="1968">And it's going to be explicitly </span><span class="line" data-startTime="1968">under your control, </span><span class="line" data-startTime="1970">which is to say that you'll </span><span class="line" data-startTime="1970">explicitly have to provide </span><span class="line" data-startTime="1972">that functionality. </span></p>

<p><span class="line" data-startTime="1973">But that's a damn sight better </span><span class="line" data-startTime="1973">than trying to have to figure </span><span class="line" data-startTime="1977">out a way to make AppCache </span><span class="line" data-startTime="1977">do it right now. </span></p>

<p class="speaker"><span class="line" data-starttime="1980"><span class="speakerName">Andrew Bettis</span>: And here's </span><span class="line" data-startTime="1980">another quick </span><span class="line" data-startTime="1982">question from Moderator. </span><span class="line" data-startTime="1984">Is there scope for a standard </span><span class="line" data-startTime="1984">way of synchronizing content </span><span class="line" data-startTime="1988">from server to client </span><span class="line" data-startTime="1988">and vice versa? </span></p>

<p class="speaker"><span class="line" data-starttime="1992"><span class="speakerName">Jonas Sicking</span>: So </span><span class="line" data-startTime="1992">synchronization is really hard. </span> <span class="line" data-startTime="1994">Once you get into two-way </span><span class="line" data-startTime="1994">synchronization, which is what </span><span class="line" data-startTime="1997">you often get into, there's </span><span class="line" data-startTime="1997">no standard way of </span><span class="line" data-startTime="2001">synchronizing data. </span> <span class="line" data-startTime="2003">It's very, very application </span><span class="line" data-startTime="2003">specific, how you deal with </span><span class="line" data-startTime="2007">merged conflicts. </span> <span class="line" data-startTime="2010">So one answer is simply no, </span><span class="line" data-startTime="2010">we can't solve this. </span> <span class="line" data-startTime="2016">There are some interesting </span><span class="line" data-startTime="2016">approaches that may work. </span> <span class="line" data-startTime="2019">So Couch, for example, does this </span><span class="line" data-startTime="2019">thing where it allows you </span><span class="line" data-startTime="2022">to synchronize data, but </span><span class="line" data-startTime="2022">it doesn't actually </span><span class="line" data-startTime="2024">deal with the merging. </span> <span class="line" data-startTime="2024">So you can pull down data, and </span><span class="line" data-startTime="2024">the local data that you end up </span><span class="line" data-startTime="2028">with explicitly contains </span><span class="line" data-startTime="2028">the conflict. </span> <span class="line" data-startTime="2032">And then after the fact, once </span><span class="line" data-startTime="2032">you run code, then you can </span><span class="line" data-startTime="2036">deal with that conflict. </span></p>

<p><span class="line" data-startTime="2037">And so potentially we can build </span><span class="line" data-startTime="2040">something around that model. </span> <span class="line" data-startTime="2043">But I think dealing with </span><span class="line" data-startTime="2043">synchronization is really, </span><span class="line" data-startTime="2046">really hard. </span> <span class="line" data-startTime="2046">I think in the beginning </span><span class="line" data-startTime="2046">we need to just. </span></p>

<p class="speaker"><span class="line" data-starttime="2049"><span class="speakerName">Andrew Bettis</span>: Are we just </span><span class="line" data-startTime="2049">asking for trouble here? </span><span class="line" data-startTime="2050">I mean, are we just asking </span><span class="line" data-startTime="2050">to build something that </span><span class="line" data-startTime="2053">developers will say, that </span><span class="line" data-startTime="2053">doesn't quite work the way I </span><span class="line" data-startTime="2055">want it to, so I'm going </span><span class="line" data-startTime="2055">to build my own? </span></p>

<p class="speaker"><span class="line" data-starttime="2057"><span class="speakerName">Alex Russell</span>: I think the thing </span><span class="line" data-startTime="2057">that will get you in </span><span class="line" data-startTime="2060">trouble is making assumptions </span><span class="line" data-startTime="2060">about the developers' data </span><span class="line" data-startTime="2063">model, which were not </span><span class="line" data-startTime="2063">collaborative. </span> <span class="line" data-startTime="2065">So if we provide developers a </span><span class="line" data-startTime="2065">data model which we constrain </span><span class="line" data-startTime="2071">tightly, like, if we provide </span><span class="line" data-startTime="2071">a straight transition chart </span><span class="line" data-startTime="2074">system that you can then speak </span><span class="line" data-startTime="2074">in high-level terms about the </span><span class="line" data-startTime="2079">changes between the states of </span><span class="line" data-startTime="2079">your applications, and then we </span><span class="line" data-startTime="2081">can watch those in a way that, </span><span class="line" data-startTime="2081">say, a SQL database watches </span><span class="line" data-startTime="2085">the SQL queries that come in and </span><span class="line" data-startTime="2085">the transactions and the </span><span class="line" data-startTime="2087">commits and you can then make a </span><span class="line" data-startTime="2087">binary log of them, then you </span><span class="line" data-startTime="2089">can start to do something about </span><span class="line" data-startTime="2089">the synchronization of </span><span class="line" data-startTime="2091">the high-level application </span><span class="line" data-startTime="2091">semantics. </span> <span class="line" data-startTime="2093">But as much as people would like </span><span class="line" data-startTime="2093">to pretend that HTML is </span><span class="line" data-startTime="2097">semantic, it ain't. </span></p>

<p><span class="line" data-startTime="2099">HTML today, in most of its use </span><span class="line" data-startTime="2099">cases, ain't semantic. </span> <span class="line" data-startTime="2102">You're not saying anything more </span><span class="line" data-startTime="2102">meaningful than div, div, </span><span class="line" data-startTime="2104">div, div, div. </span> <span class="line" data-startTime="2106">And your mutations of HTML are </span><span class="line" data-startTime="2106">no more meaningful that show </span><span class="line" data-startTime="2109">or hide this particular </span><span class="line" data-startTime="2109">piece of UI. </span> <span class="line" data-startTime="2110">They don't relate specifically, </span><span class="line" data-startTime="2110">in most cases, </span><span class="line" data-startTime="2113">except in a tangential way, to </span><span class="line" data-startTime="2113">I'm changing this particular </span><span class="line" data-startTime="2116">piece of state in my data model, </span><span class="line" data-startTime="2116">which is what you're </span><span class="line" data-startTime="2120">trying to synchronize. </span> <span class="line" data-startTime="2121">And so we don't have a local </span><span class="line" data-startTime="2121">idea of a data model. </span> <span class="line" data-startTime="2124">Therefore we can't really cons </span><span class="line" data-startTime="2124">up the idea of a local </span><span class="line" data-startTime="2126">synchronization store. </span> <span class="line" data-startTime="2128">I think that the next iteration </span><span class="line" data-startTime="2128">of the library wars </span><span class="line" data-startTime="2131">will be about data models </span><span class="line" data-startTime="2131">locally and synchronization. </span></p>

<p><span class="line" data-startTime="2134">My guess is that people are </span><span class="line" data-startTime="2134">going to start doing </span><span class="line" data-startTime="2136">operational transform libraries </span><span class="line" data-startTime="2136">out of the woodwork. </span> <span class="line" data-startTime="2138">It's going to be amazing. </span> <span class="line" data-startTime="2140">We're starting to see this a </span><span class="line" data-startTime="2140">little bit with Meteor and </span><span class="line" data-startTime="2142">some other libraries that are </span><span class="line" data-startTime="2142">starting to apply some good </span><span class="line" data-startTime="2145">computer science to the </span><span class="line" data-startTime="2145">question of how do I </span><span class="line" data-startTime="2148">differentiate what's happening </span><span class="line" data-startTime="2148">when I change it? </span><span class="line" data-startTime="2150">How do I prevent merge conflicts </span><span class="line" data-startTime="2150">in the first place, </span><span class="line" data-startTime="2153">by dealing in high-level </span><span class="line" data-startTime="2153">operations, and not in, oh </span><span class="line" data-startTime="2156">look, some field was </span><span class="line" data-startTime="2156">added or removed? </span><span class="line" data-startTime="2158">And we're starting to add good </span><span class="line" data-startTime="2158">support for being able to </span><span class="line" data-startTime="2161">build these libraries into both </span><span class="line" data-startTime="2161">the language and the DOM. </span></p>

<p><span class="line" data-startTime="2164">There's something called </span><span class="line" data-startTime="2164">object.observe and mutation </span><span class="line" data-startTime="2166">observers, which are way of </span><span class="line" data-startTime="2166">observing those changes as </span><span class="line" data-startTime="2168">they happen and responding to </span><span class="line" data-startTime="2168">high-level events and not the </span><span class="line" data-startTime="2171">low-level primitives changing </span><span class="line" data-startTime="2171">out from underneath you. </span> <span class="line" data-startTime="2174">But we've got a very long way </span><span class="line" data-startTime="2174">collectively to go to get to </span><span class="line" data-startTime="2177">an agreement whereby we as </span><span class="line" data-startTime="2177">browser vendors would feel, I </span><span class="line" data-startTime="2180">think, reasonably comfortable </span><span class="line" data-startTime="2180">in blessing one particulars </span><span class="line" data-startTime="2184">strategy for describing your </span><span class="line" data-startTime="2184">data and then another strategy </span><span class="line" data-startTime="2187">for synchronizing it. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2191"><span class="speakerName">Andrew Bettis</span>: So has anyone </span><span class="line" data-startTime="2191">here implemented any kind of </span><span class="line" data-startTime="2193">offline sync, any kind </span><span class="line" data-startTime="2193">of ability to </span><span class="line" data-startTime="2196">synchronize data to browser? </span></p>

<p class="speaker"><span class="line" data-starttime="2198"><span class="speakerName">Male Speaker</span>: Yeah. </span></p>

<p class="speaker"><span class="line" data-starttime="2198"><span class="speakerName">Andrew Bettis</span>: OK, so what's </span><span class="line" data-startTime="2198">your use case? </span></p>

<p class="speaker"><span class="line" data-starttime="2210"><span class="speakerName">Male Speaker</span>: It's exactly how </span><span class="line" data-startTime="2210">you just described it. </span><span class="line" data-startTime="2214">The AppCache hosts the shell, </span><span class="line" data-startTime="2214">and everything else comes from </span><span class="line" data-startTime="2218">local storage. </span><span class="line" data-startTime="2220">So local storage is the user </span><span class="line" data-startTime="2220">data, AppCache is the shell. </span><span class="line" data-startTime="2224">And it assumes from the </span><span class="line" data-startTime="2224">beginning that the user is </span><span class="line" data-startTime="2226">going to have no data and then </span><span class="line" data-startTime="2226">tries to fetch over an AJAX </span><span class="line" data-startTime="2232">request and feeds into </span><span class="line" data-startTime="2232">local storage. </span></p>

<p class="speaker"><span class="line" data-starttime="2238"><span class="speakerName">Mark Christian</span>: I think most </span><span class="line" data-startTime="2238">of the problems with </span><span class="line" data-startTime="2240">synchronization are less data </span><span class="line" data-startTime="2240">model than we would think. </span><span class="line" data-startTime="2244">I feel like it's actually </span><span class="line" data-startTime="2244">a feasible problem. </span><span class="line" data-startTime="2248">If you look at stuff like </span><span class="line" data-startTime="2248">iCloud, you can offer a couple </span><span class="line" data-startTime="2250">of pretty basic data </span><span class="line" data-startTime="2250">strategies. </span><span class="line" data-startTime="2253">Like, I've got a key value </span><span class="line" data-startTime="2253">store, or I've </span><span class="line" data-startTime="2255">got a record store. </span><span class="line" data-startTime="2256">You don't need to build up </span><span class="line" data-startTime="2256">particularly complex models in </span><span class="line" data-startTime="2259">the browser to actually </span><span class="line" data-startTime="2259">be able to support &mdash; </span><span class="line" data-startTime="2262">there's this thing, it has a </span><span class="line" data-startTime="2262">GUID, and you can say whatever </span><span class="line" data-startTime="2267">the most recent changed </span><span class="line" data-startTime="2267">version is works. </span></p>

<p class="speaker"><span class="line" data-starttime="2270"><span class="speakerName">Alex Russell</span>: So you're positing </span><span class="line" data-startTime="2270">that one default </span><span class="line" data-startTime="2272">strategy across multi-tenant </span><span class="line" data-startTime="2272">synchronization will work, </span><span class="line" data-startTime="2275">that there's only a single user, </span><span class="line" data-startTime="2275">and that user's last </span><span class="line" data-startTime="2278">change is going to be </span><span class="line" data-startTime="2278">synchronized and timed </span><span class="line" data-startTime="2279">correctly across multiple </span><span class="line" data-startTime="2279">systems. </span> <span class="line" data-startTime="2282">And you're saying that there's </span><span class="line" data-startTime="2282">a closed form over the </span><span class="line" data-startTime="2284">operations that I can take. </span> <span class="line" data-startTime="2286">You do need the closed form, but </span><span class="line" data-startTime="2286">you need the ability for </span><span class="line" data-startTime="2288">applications to specify the </span><span class="line" data-startTime="2288">operations that they will </span><span class="line" data-startTime="2291">allow on their data and what it </span><span class="line" data-startTime="2291">means for them to change a </span><span class="line" data-startTime="2294">piece of data. </span> <span class="line" data-startTime="2296">Yes, you can bring users down to </span><span class="line" data-startTime="2296">one model of mutating data </span><span class="line" data-startTime="2300">and what that semantic </span><span class="line" data-startTime="2300">is for mutation. </span> <span class="line" data-startTime="2304">And you can constrain the set of </span><span class="line" data-startTime="2304">things that they will then </span><span class="line" data-startTime="2307">reasonably be able to do in </span><span class="line" data-startTime="2307">the app without hitting </span><span class="line" data-startTime="2309">synchronization issues </span><span class="line" data-startTime="2309">based on this policy. </span></p>

<p><span class="line" data-startTime="2311">You could do that, but I don't </span><span class="line" data-startTime="2311">feel like it's our job as a </span><span class="line" data-startTime="2315">platform right now to make that </span><span class="line" data-startTime="2315">kind of a call in quite </span><span class="line" data-startTime="2319">such a closed way. </span> <span class="line" data-startTime="2320">Because I don't think that we've </span><span class="line" data-startTime="2320">got the experience in </span><span class="line" data-startTime="2321">our community for that's </span><span class="line" data-startTime="2321">the right thing to do. </span> <span class="line" data-startTime="2323">I can tell you right now that </span><span class="line" data-startTime="2323">that would not work for Gmail. </span> <span class="line" data-startTime="2326">It honestly would not </span><span class="line" data-startTime="2326">work for Gmail. </span> <span class="line" data-startTime="2327">It wouldn't work for Sync. </span> <span class="line" data-startTime="2328">It wouldn't have worked </span><span class="line" data-startTime="2328">for Wave. </span> <span class="line" data-startTime="2330">It doesn't work for Plus. </span> <span class="line" data-startTime="2331">It won't fly. </span></p>

<p class="speaker"><span class="line" data-starttime="2333"><span class="speakerName">Andrew Bettis</span>: Mark, can you </span><span class="line" data-startTime="2333">tell us why Twitter doesn't </span><span class="line" data-startTime="2335">currently use offline? </span></p>

<p class="speaker"><span class="line" data-starttime="2337"><span class="speakerName">Mark Christian</span>: Well, Twitter's </span><span class="line" data-startTime="2337">web platform is in a </span><span class="line" data-startTime="2339">bit of flux. </span><span class="line" data-startTime="2341">We're moving towards </span><span class="line" data-startTime="2341">a server as the </span><span class="line" data-startTime="2343">ultimate source of truth. </span><span class="line" data-startTime="2344">So we actually don't do any </span><span class="line" data-startTime="2344">client side rendering at all. </span><span class="line" data-startTime="2347">So any navigation event, even </span><span class="line" data-startTime="2347">though it's happening AJAXly, </span><span class="line" data-startTime="2351">is actually just injecting a </span><span class="line" data-startTime="2351">response from the server. </span><span class="line" data-startTime="2354">So you can't really cache that </span><span class="line" data-startTime="2354">nearly as efficiently as you </span><span class="line" data-startTime="2358">could a series of JSON </span><span class="line" data-startTime="2358">responses, for example, </span><span class="line" data-startTime="2360">because they're full-page </span><span class="line" data-startTime="2360">responses. </span><span class="line" data-startTime="2362">So not every AJAX model is going </span><span class="line" data-startTime="2362">to work as well with </span><span class="line" data-startTime="2366">that sort of a strategy. </span><span class="line" data-startTime="2369">Whether that changes </span><span class="line" data-startTime="2369">in the future, TBD. </span><span class="line" data-startTime="2371">But basically, two competing </span><span class="line" data-startTime="2371">styles of how you want to have </span><span class="line" data-startTime="2375">a fast responsive app, you have </span><span class="line" data-startTime="2375">something that lives on </span><span class="line" data-startTime="2377">the server, something that lives </span><span class="line" data-startTime="2377">entirely on the client. </span><span class="line" data-startTime="2379">And having something that can </span><span class="line" data-startTime="2379">react to both is actually a </span><span class="line" data-startTime="2383">messy, terrible proposition </span><span class="line" data-startTime="2383">right now. </span></p>

<p class="speaker"><span class="line" data-starttime="2388"><span class="speakerName">Jake Archibald</span>: The way we did </span><span class="line" data-startTime="2388">that at Lanyard was we were </span><span class="line" data-startTime="2391">rendering on the server with </span><span class="line" data-startTime="2391">Mustache and some data. </span> <span class="line" data-startTime="2395">And then when we were doing the </span><span class="line" data-startTime="2395">same on the client with </span><span class="line" data-startTime="2397">offline, we were using the same </span><span class="line" data-startTime="2397">Mustache templates, and </span><span class="line" data-startTime="2400">we were caching the same data </span><span class="line" data-startTime="2400">model in local storage, the </span><span class="line" data-startTime="2404">same as you were. </span> <span class="line" data-startTime="2404">And obviously we'd rather be </span><span class="line" data-startTime="2404">doing that in AppCache. </span> <span class="line" data-startTime="2407">So yeah, you can still do the </span><span class="line" data-startTime="2407">progressive enhancement thing </span><span class="line" data-startTime="2412">and have a client-based </span><span class="line" data-startTime="2412">app, and you're not </span><span class="line" data-startTime="2414">duplicating too much data. </span> <span class="line" data-startTime="2416">And did anyone see the "B&B" </span><span class="line" data-startTime="2416">article recently where they </span><span class="line" data-startTime="2421">were talking about, hey, we've </span><span class="line" data-startTime="2421">decided to try this new, </span><span class="line" data-startTime="2425">exciting idea. </span> <span class="line" data-startTime="2426">And what we're going to do is </span><span class="line" data-startTime="2426">we're going to render content </span><span class="line" data-startTime="2427">on the server, and we're </span><span class="line" data-startTime="2427">going to send out an </span><span class="line" data-startTime="2430">HTML string of content. </span></p>

<p><span class="line" data-startTime="2433">And it's amazingly fast. </span> <span class="line" data-startTime="2434">You guys should all </span><span class="line" data-startTime="2434">be doing this. </span> <span class="line" data-startTime="2438">Yeah, we've been calling that </span><span class="line" data-startTime="2438">progressive enhancement. </span></p>

<p class="speaker"><span class="line" data-starttime="2441"><span class="speakerName">Mark Christian</span>: Well, that's </span><span class="line" data-startTime="2441">sort of our model too. </span><span class="line" data-startTime="2443">Twitter's famously, remember, </span><span class="line" data-startTime="2443">the hashbang website a couple </span><span class="line" data-startTime="2446">of years ago. </span><span class="line" data-startTime="2447">It was actually pretty speedy </span><span class="line" data-startTime="2447">if you were on a MacBook Pro </span><span class="line" data-startTime="2449">with the latest version </span><span class="line" data-startTime="2449">of Chrome. </span><span class="line" data-startTime="2450">But if you were using IE7 in </span><span class="line" data-startTime="2450">Bangalore, it was actually an </span><span class="line" data-startTime="2455">atrocious experience. </span><span class="line" data-startTime="2456">And so the server side model </span><span class="line" data-startTime="2456">ends up working a lot better </span><span class="line" data-startTime="2458">on the low end. </span><span class="line" data-startTime="2459">And the problem with having two </span><span class="line" data-startTime="2459">rendering stacks, even if </span><span class="line" data-startTime="2463">they're sharing templates, is </span><span class="line" data-startTime="2463">that you've got quirks between </span><span class="line" data-startTime="2466">your view implementation. </span><span class="line" data-startTime="2467">And that is a great way to kill </span><span class="line" data-startTime="2467">yourself with 1,000 paper </span><span class="line" data-startTime="2469">cuts, especially if you're on </span><span class="line" data-startTime="2469">a large dev team with a few </span><span class="line" data-startTime="2472">dozen developers trying to </span><span class="line" data-startTime="2472">keep it all in sync. </span></p>

<p class="speaker"><span class="line" data-starttime="2475"><span class="speakerName">Jake Archibald</span>: No, I completely </span><span class="line" data-startTime="2475">agree with that. </span><span class="line" data-startTime="2476">Because we were using Mustache, </span><span class="line" data-startTime="2476">and we ended up </span><span class="line" data-startTime="2478">pretty much owning, or making </span><span class="line" data-startTime="2478">massive contributions to about </span><span class="line" data-startTime="2482">four different implementations </span><span class="line" data-startTime="2482">of Mustache the Python one, </span><span class="line" data-startTime="2484">the Java one, the IOS one, </span><span class="line" data-startTime="2484">and the JavaScript one. </span></p>

<p class="speaker"><span class="line" data-starttime="2490"><span class="speakerName">Mark Christian</span>: There's one </span><span class="line" data-startTime="2490">developer at Twitter who's </span><span class="line" data-startTime="2491">single-handedly written </span><span class="line" data-startTime="2491">two from scratch &mdash; </span><span class="line" data-startTime="2493">Hogan and Eckersley &mdash; </span><span class="line" data-startTime="2494">just because most of the </span><span class="line" data-startTime="2494">implementations had </span><span class="line" data-startTime="2497">some sort of issue. </span></p>

<p class="speaker"><span class="line" data-starttime="2498"><span class="speakerName">Andrew Bettis</span>: So are you </span><span class="line" data-startTime="2498">saying, then, that the only </span><span class="line" data-startTime="2499">real use case for offline </span><span class="line" data-startTime="2499">technologies is when you </span><span class="line" data-startTime="2502">actually want to build an </span><span class="line" data-startTime="2502">offline app rather than to </span><span class="line" data-startTime="2504">improve the performance </span><span class="line" data-startTime="2504">of your app? </span></p>

<p class="speaker"><span class="line" data-starttime="2505"><span class="speakerName">Mark Christian</span>: Well, </span><span class="line" data-startTime="2505">application versus website &mdash; </span><span class="line" data-startTime="2508">it's the same thing I </span><span class="line" data-startTime="2508">mentioned earlier. </span><span class="line" data-startTime="2511">I feel like the offline </span><span class="line" data-startTime="2511">technologies are really good </span><span class="line" data-startTime="2513">for building an app, like </span><span class="line" data-startTime="2513">the Lanyard thing. </span><span class="line" data-startTime="2515">But they don't really map very </span><span class="line" data-startTime="2515">well towards a Twitter or even </span><span class="line" data-startTime="2518">a Wikipedia kind of example. </span><span class="line" data-startTime="2520">They just don't feel like a very </span><span class="line" data-startTime="2520">good fit for something </span><span class="line" data-startTime="2522">where you're always pulling </span><span class="line" data-startTime="2522">in new data, and it's an </span><span class="line" data-startTime="2524">unbounded amount of content </span><span class="line" data-startTime="2524">that you might </span><span class="line" data-startTime="2526">want to pull in. </span></p>

<p class="speaker"><span class="line" data-starttime="2528"><span class="speakerName">Jake Archibald</span>: If you're </span><span class="line" data-startTime="2528">just looking to improve </span><span class="line" data-startTime="2529">performance, that's what </span><span class="line" data-startTime="2529">the HTTP cache is for. </span><span class="line" data-startTime="2532">The application cache is for </span><span class="line" data-startTime="2532">caching applications &mdash; </span><span class="line" data-startTime="2536">it's for making it </span><span class="line" data-startTime="2536">work offline. </span><span class="line" data-startTime="2539">If you can get a performance </span><span class="line" data-startTime="2539">benefit out of using it, then </span><span class="line" data-startTime="2542">fair enough. </span><span class="line" data-startTime="2542">But you are buying into making </span><span class="line" data-startTime="2542">an offline-first experience. </span></p>

<p class="speaker"><span class="line" data-starttime="2548"><span class="speakerName">Alex Russell</span>: To be clear, </span><span class="line" data-startTime="2548">though, the new proposal would </span><span class="line" data-startTime="2551">be a reasonable accelerator. </span><span class="line" data-startTime="2553">If you don't ever handle any </span><span class="line" data-startTime="2553">navigation events but only </span><span class="line" data-startTime="2555">resources, you could certainly </span><span class="line" data-startTime="2555">build a local high performance </span><span class="line" data-startTime="2560">cache system to improve website </span><span class="line" data-startTime="2560">performance without </span><span class="line" data-startTime="2564">biting off any offline </span><span class="line" data-startTime="2564">capability at all. </span></p>

<p class="speaker"><span class="line" data-starttime="2567"><span class="speakerName">Andrew Bettis</span>: In what situation </span><span class="line" data-startTime="2567">would you want to do </span><span class="line" data-startTime="2568">that versus using </span><span class="line" data-startTime="2568">the HTTP cache? </span></p>

<p class="speaker"><span class="line" data-starttime="2572"><span class="speakerName">Alex Russell</span>: We've had good </span><span class="line" data-startTime="2572">input from the folks at </span><span class="line" data-startTime="2574">Facebook that this is their core </span><span class="line" data-startTime="2574">use case for AppCache, is </span><span class="line" data-startTime="2577">actually making things &mdash; </span><span class="line" data-startTime="2579">or not a core. </span><span class="line" data-startTime="2579">One of their most important use </span><span class="line" data-startTime="2579">cases was making things </span><span class="line" data-startTime="2582">available faster. </span><span class="line" data-startTime="2585">And at Google, I know that our </span><span class="line" data-startTime="2585">global teams have had similar </span><span class="line" data-startTime="2590">needs, and AppCache </span><span class="line" data-startTime="2590">hasn't met them. </span><span class="line" data-startTime="2592">So hopefully this new API </span><span class="line" data-startTime="2592">will meet those two. </span></p>

<p class="speaker"><span class="line" data-starttime="2595"><span class="speakerName">Jonas Sicking</span>: Yeah, I think the </span><span class="line" data-startTime="2595">mental model that I've had </span><span class="line" data-startTime="2598">recently is that it would be </span><span class="line" data-startTime="2598">great if we can make it work </span><span class="line" data-startTime="2603">so that the online case </span><span class="line" data-startTime="2603">is very similar </span><span class="line" data-startTime="2606">to the offline case. </span><span class="line" data-startTime="2608">It's more a difference between </span><span class="line" data-startTime="2608">are you seeing controller </span><span class="line" data-startTime="2613">slash app cache or you're not. </span><span class="line" data-startTime="2616">So if we can make it so that </span><span class="line" data-startTime="2616">when you are using these new </span><span class="line" data-startTime="2620">features for enabling offline </span><span class="line" data-startTime="2620">but you happen to be online, </span><span class="line" data-startTime="2624">you can still download the data </span><span class="line" data-startTime="2624">and just download the </span><span class="line" data-startTime="2629">data part and not the template </span><span class="line" data-startTime="2629">and the static content and use </span><span class="line" data-startTime="2633">that cached version of that </span><span class="line" data-startTime="2633">increase performance. </span><span class="line" data-startTime="2636">I'm definitely hoping that that </span><span class="line" data-startTime="2636">is a model we can get to, </span><span class="line" data-startTime="2640">to basically make the online </span><span class="line" data-startTime="2640">application experience be more </span><span class="line" data-startTime="2643">competitive with native &mdash; </span><span class="line" data-startTime="2643">where on native you're </span><span class="line" data-startTime="2646">downloading your shell once. </span><span class="line" data-startTime="2649">And then as you're using it, </span><span class="line" data-startTime="2649">you're just downloading the </span><span class="line" data-startTime="2651">incremental data. </span><span class="line" data-startTime="2653">We should be able to make the </span><span class="line" data-startTime="2653">same thing possible on the web </span><span class="line" data-startTime="2655">to increase performance. </span></p>

<p class="speaker"><span class="line" data-starttime="2659"><span class="speakerName">Jake Archibald</span>: So the HTTP </span><span class="line" data-startTime="2659">cache is like this really busy </span><span class="line" data-startTime="2661">room, and everyone's in there. </span> <span class="line" data-startTime="2663">And the browser's having to be </span><span class="line" data-startTime="2663">the bouncer at the door. </span> <span class="line" data-startTime="2666">And when other people want into </span><span class="line" data-startTime="2666">the room, the bouncer's </span><span class="line" data-startTime="2670">going, look, you've had </span><span class="line" data-startTime="2670">too much to drink. </span> <span class="line" data-startTime="2674">You should get out. </span> <span class="line" data-startTime="2675">And then what Facebook have done </span><span class="line" data-startTime="2675">is gone, ah, but there's </span><span class="line" data-startTime="2678">this quieter bar around </span><span class="line" data-startTime="2678">the corner. </span> <span class="line" data-startTime="2681">We're going to go there. </span> <span class="line" data-startTime="2683">But the thing is, if everyone </span><span class="line" data-startTime="2683">starts doing that, then that </span><span class="line" data-startTime="2685">bar is going to have to hire a </span><span class="line" data-startTime="2685">bouncer, and they're going to </span><span class="line" data-startTime="2687">start kicking people </span><span class="line" data-startTime="2687">out as well. </span> <span class="line" data-startTime="2690">It seems like a nice performance </span><span class="line" data-startTime="2690">enhancement now. </span></p>

<p><span class="line" data-startTime="2692">But I think if everyone started </span><span class="line" data-startTime="2692">using it, we're going </span><span class="line" data-startTime="2693">to get the same issues where if </span><span class="line" data-startTime="2693">everyone's stuffing fonts </span><span class="line" data-startTime="2696">and images into local storage, </span><span class="line" data-startTime="2696">there's going to have to be a </span><span class="line" data-startTime="2699">bouncer there that kicks </span><span class="line" data-startTime="2699">people out &mdash; unless the </span><span class="line" data-startTime="2702">website asked for a </span><span class="line" data-startTime="2702">permanent cache. </span> <span class="line" data-startTime="2704">But I don't think we want a </span><span class="line" data-startTime="2704">web where you just visit </span><span class="line" data-startTime="2707">Facebook because you want to </span><span class="line" data-startTime="2707">look at a thing, and it's </span><span class="line" data-startTime="2708">saying, Facebook wants to </span><span class="line" data-startTime="2708">install 5 megabytes worth of </span><span class="line" data-startTime="2711">stuff just so you can see it. </span> <span class="line" data-startTime="2713">It's not for an offline </span><span class="line" data-startTime="2713">experience, it's just to look </span><span class="line" data-startTime="2715">at the site. </span></p>

<p class="speaker"><span class="line" data-starttime="2716"><span class="speakerName">Mark Christian</span>: The interesting </span><span class="line" data-startTime="2716">characteristic </span><span class="line" data-startTime="2717">about using AppCache for storing </span><span class="line" data-startTime="2717">the outer shell is </span><span class="line" data-startTime="2721">that it lets you have a cache </span><span class="line" data-startTime="2721">where it's totally happy to </span><span class="line" data-startTime="2724">start rendering the page with </span><span class="line" data-startTime="2724">the old version, without even </span><span class="line" data-startTime="2726">going to see if there's </span><span class="line" data-startTime="2726">a new one. </span> <span class="line" data-startTime="2728">And that's something that HTTP </span><span class="line" data-startTime="2728">caching could theoretically be </span><span class="line" data-startTime="2730">modified to have but doesn't. </span> <span class="line" data-startTime="2733">And it's an interesting </span><span class="line" data-startTime="2733">characteristic all its own. </span> <span class="line" data-startTime="2735">HTTP caching in general is best </span><span class="line" data-startTime="2735">described as bewildering. </span> <span class="line" data-startTime="2739">There's just so many options, </span><span class="line" data-startTime="2739">and it never quite does what </span><span class="line" data-startTime="2741">you expect. </span></p>

<p><span class="line" data-startTime="2742">And with all of AppCache's </span><span class="line" data-startTime="2742">problems, one thing that we </span><span class="line" data-startTime="2745">can say is at least we can </span><span class="line" data-startTime="2745">expect that the data will be </span><span class="line" data-startTime="2747">there when we ask </span><span class="line" data-startTime="2747">for it again. </span></p>

<p class="speaker"><span class="line" data-starttime="2754"><span class="speakerName">Jonas Sicking</span>: I don't think the </span><span class="line" data-startTime="2754">bar around the corner is </span><span class="line" data-startTime="2755">necessarily going to get </span><span class="line" data-startTime="2755">as packed as the </span><span class="line" data-startTime="2758">initial HTTP cache bar. </span><span class="line" data-startTime="2761">Because if we are good enough </span><span class="line" data-startTime="2761">at building the heuristics </span><span class="line" data-startTime="2765">where maybe we don't download </span><span class="line" data-startTime="2765">AppCache the first time you </span><span class="line" data-startTime="2768">visit a website. </span><span class="line" data-startTime="2769">But if we see that you visit a </span><span class="line" data-startTime="2769">website every day, then we'll </span><span class="line" data-startTime="2773">download the AppCache and we'll </span><span class="line" data-startTime="2773">keep it more tightly. </span><span class="line" data-startTime="2776">So I think if we're more clever </span><span class="line" data-startTime="2776">than we are with HTTP </span><span class="line" data-startTime="2780">cache, then I think we </span><span class="line" data-startTime="2780">can keep the good </span><span class="line" data-startTime="2784">people in that bar. </span></p>

<p class="speaker"><span class="line" data-starttime="2785"><span class="speakerName">Andrew Bettis</span>: Why do we need </span><span class="line" data-startTime="2785">another bar at all? </span><span class="line" data-startTime="2788">Just hypothetically, why do we </span><span class="line" data-startTime="2788">not just have an extra cache </span><span class="line" data-startTime="2791">control directive that gives </span><span class="line" data-startTime="2791">enhanced persistence within </span><span class="line" data-startTime="2794">the HTTP cache? </span></p>

<p class="speaker"><span class="line" data-starttime="2795"><span class="speakerName">Alex Russell</span>: I try to rephrase </span><span class="line" data-startTime="2795">this as, why is there </span><span class="line" data-startTime="2798">no priority system? </span><span class="line" data-startTime="2799">Why is their no user expressible </span><span class="line" data-startTime="2799">and collaborative </span><span class="line" data-startTime="2802">priority system? </span><span class="line" data-startTime="2803">So many of the cases where we </span><span class="line" data-startTime="2803">wind up fighting the browser </span><span class="line" data-startTime="2806">as developers are cases where if </span><span class="line" data-startTime="2806">we could express our intent </span><span class="line" data-startTime="2810">more clearly to the browser, the </span><span class="line" data-startTime="2810">browser could collaborate </span><span class="line" data-startTime="2813">with the user to have </span><span class="line" data-startTime="2813">a better experience </span><span class="line" data-startTime="2815">provided in many cases. </span> <span class="line" data-startTime="2817">We could then use the browser </span><span class="line" data-startTime="2817">to help express to the user, </span><span class="line" data-startTime="2820">hey, this is what we're </span><span class="line" data-startTime="2820">trying to do here. </span> <span class="line" data-startTime="2821">And if you say to the browser, </span><span class="line" data-startTime="2821">listen, these resources are </span><span class="line" data-startTime="2825">really dear to me, these are </span><span class="line" data-startTime="2825">slightly less dear, and these </span><span class="line" data-startTime="2827">are totally ephemeral, I don't </span><span class="line" data-startTime="2827">really need them &mdash; </span><span class="line" data-startTime="2831">the work that the folks are </span><span class="line" data-startTime="2831">doing on Quota API for the </span><span class="line" data-startTime="2839">file system points in this </span><span class="line" data-startTime="2839">direction, where you're </span><span class="line" data-startTime="2842">getting to a point where you can </span><span class="line" data-startTime="2842">start to collaborate with </span><span class="line" data-startTime="2844">the system and say listen, these </span><span class="line" data-startTime="2844">are really important to </span><span class="line" data-startTime="2846">me, these are less important. </span></p>

<p><span class="line" data-startTime="2847">And I don't think we need to </span><span class="line" data-startTime="2847">back ourselves into hard </span><span class="line" data-startTime="2850">guarantees, as long as we're </span><span class="line" data-startTime="2850">able to say that, by default, </span><span class="line" data-startTime="2853">you're in the less privileged </span><span class="line" data-startTime="2853">group until you ask for a </span><span class="line" data-startTime="2857">privilege, in which case you </span><span class="line" data-startTime="2857">take on responsibility to </span><span class="line" data-startTime="2860">collaborate. </span> <span class="line" data-startTime="2861">You might be evicted. </span> <span class="line" data-startTime="2862">You might get events about </span><span class="line" data-startTime="2862">whether or not eviction is </span><span class="line" data-startTime="2864">about to happen, and maybe you </span><span class="line" data-startTime="2864">should offer up some other </span><span class="line" data-startTime="2866">thing to remove or try to remove </span><span class="line" data-startTime="2866">stuff for yourself. </span> <span class="line" data-startTime="2869">This is a well-worn path in </span><span class="line" data-startTime="2869">a lot of other operating </span><span class="line" data-startTime="2871">systems, where you'll say, </span><span class="line" data-startTime="2871">hey, dear plug-in or dear </span><span class="line" data-startTime="2875">application, we're running </span><span class="line" data-startTime="2875">low on storage. </span></p>

<p><span class="line" data-startTime="2877">Can you please clean </span><span class="line" data-startTime="2877">some stuff up? </span><span class="line" data-startTime="2879">Or where the OS tries to clean </span><span class="line" data-startTime="2879">things up for you if it winds </span><span class="line" data-startTime="2882">up under pressure. </span> <span class="line" data-startTime="2883">At that point, you have to </span><span class="line" data-startTime="2883">have a conversation. </span> <span class="line" data-startTime="2885">And today we have no way to </span><span class="line" data-startTime="2885">have that conversation. </span> <span class="line" data-startTime="2887">So it's not that we necessarily </span><span class="line" data-startTime="2887">need a different </span><span class="line" data-startTime="2889">bar or a different bouncer, but </span><span class="line" data-startTime="2889">I think those are just one </span><span class="line" data-startTime="2892">way of saying we need multiple </span><span class="line" data-startTime="2892">levels of collaboration and </span><span class="line" data-startTime="2895">cooperation, and we don't have </span><span class="line" data-startTime="2895">any of that right now. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2897"><span class="speakerName">Mark Christian</span>: This goes to the </span><span class="line" data-startTime="2897">philosophical web idea of </span><span class="line" data-startTime="2900">the user agent knows best. </span><span class="line" data-startTime="2902">Even when we talk about some </span><span class="line" data-startTime="2902">of the new ideas, there's </span><span class="line" data-startTime="2904">these heuristics on caching. </span><span class="line" data-startTime="2905">And we've never really decided </span><span class="line" data-startTime="2905">to empower the app developer </span><span class="line" data-startTime="2908">to have much of a say in this. </span></p>

<p class="speaker"><span class="line" data-starttime="2910"><span class="speakerName">Alex Russell</span>: Well, </span><span class="line" data-startTime="2910">let's be clear. </span><span class="line" data-startTime="2911">The user agent is in control. </span><span class="line" data-startTime="2913">It may not know best, but it's </span><span class="line" data-startTime="2913">certainly in control, because </span><span class="line" data-startTime="2915">we're putting users in control </span><span class="line" data-startTime="2915">of their system and their </span><span class="line" data-startTime="2918">experience. </span><span class="line" data-startTime="2919">So the imperative for the user </span><span class="line" data-startTime="2919">agent to have the last say is </span><span class="line" data-startTime="2924">all about giving users </span><span class="line" data-startTime="2924">the last say. </span><span class="line" data-startTime="2925">And so that's an inviolable </span><span class="line" data-startTime="2925">principle of a safe web. </span><span class="line" data-startTime="2929">The answer was, well, shouldn't </span><span class="line" data-startTime="2929">we just count on </span><span class="line" data-startTime="2932">everyone being nice? </span><span class="line" data-startTime="2933">And the answer is, </span><span class="line" data-startTime="2933">no, advertisers. </span><span class="line" data-startTime="2934">Duh. </span></p>

<p class="speaker"><span class="line" data-starttime="2937"><span class="speakerName">Mark Christian</span>: It's still a </span><span class="line" data-startTime="2937">very different model than </span><span class="line" data-startTime="2939">native apps, though. </span><span class="line" data-startTime="2940">And I'm not saying it's a </span><span class="line" data-startTime="2940">bad model, but it's just </span><span class="line" data-startTime="2942">interesting that native apps </span><span class="line" data-startTime="2942">don't have the same set of </span><span class="line" data-startTime="2945">constraints on them. </span><span class="line" data-startTime="2945">Once they're on the app, then </span><span class="line" data-startTime="2945">they can do all of these </span><span class="line" data-startTime="2948">things within the sandbox. </span><span class="line" data-startTime="2949">And in general, the sandbox that </span><span class="line" data-startTime="2949">you'll get on a native </span><span class="line" data-startTime="2951">platform is very much wider than </span><span class="line" data-startTime="2951">the sandbox that you'll </span><span class="line" data-startTime="2955">get as a random website. </span></p>

<p class="speaker"><span class="line" data-starttime="2956"><span class="speakerName">Jonas Sicking</span>: Yeah, but there's </span><span class="line" data-startTime="2956">still a very big </span><span class="line" data-startTime="2959">difference from a random website </span><span class="line" data-startTime="2959">and a native app. </span> <span class="line" data-startTime="2961">Within a native app, the user </span><span class="line" data-startTime="2961">has made a decision that I </span><span class="line" data-startTime="2965">care about this app, at the very </span><span class="line" data-startTime="2965">least enough to bother </span><span class="line" data-startTime="2970">with download time. </span> <span class="line" data-startTime="2972">But it's even more to the point </span><span class="line" data-startTime="2972">that the user has said, </span><span class="line" data-startTime="2976">I trust this website to </span><span class="line" data-startTime="2976">do a lot of things. </span> <span class="line" data-startTime="2980">Most native apps can take </span><span class="line" data-startTime="2980">over your system. </span> <span class="line" data-startTime="2982">So the user has clearly </span><span class="line" data-startTime="2982">indicated that there's some </span><span class="line" data-startTime="2985">amount of trust. </span></p>

<p><span class="line" data-startTime="2986">And so we can't really ever give </span><span class="line" data-startTime="2986">the random website that </span><span class="line" data-startTime="2990">the user's visiting the first </span><span class="line" data-startTime="2990">time the same amount of trust </span><span class="line" data-startTime="2993">as a native app has. </span> <span class="line" data-startTime="2994">But this is where I think this </span><span class="line" data-startTime="2994">smooth transition from going </span><span class="line" data-startTime="2998">from untrusted to trusted </span><span class="line" data-startTime="2998">needs to happen. </span></p>

<p class="speaker"><span class="line" data-starttime="3001"><span class="speakerName">Andrew Bettis</span>: Is it ever </span><span class="line" data-startTime="3001">reasonable that you could </span><span class="line" data-startTime="3003">visit a random website and it </span><span class="line" data-startTime="3003">could prompt you saying, this </span><span class="line" data-startTime="3005">website wants to completely take </span><span class="line" data-startTime="3005">over your computer, do </span><span class="line" data-startTime="3007">you want to allow this? </span></p>

<p class="speaker"><span class="line" data-starttime="3008"><span class="speakerName">Alex Russell</span>: Sure, we </span><span class="line" data-startTime="3008">have that today. </span></p>

<p class="speaker"><span class="line" data-starttime="3010"><span class="speakerName">Jonas Sicking</span>: I don't think we </span><span class="line" data-startTime="3010">should have the question to </span><span class="line" data-startTime="3016">the user, click the yes button </span><span class="line" data-startTime="3016">if you want your system </span><span class="line" data-startTime="3019">entirely taken over, click </span><span class="line" data-startTime="3019">the no button if not. </span><span class="line" data-startTime="3021">Because some people will click </span><span class="line" data-startTime="3021">the yes button not knowing </span><span class="line" data-startTime="3024">what their doing. </span><span class="line" data-startTime="3025">So we need to be more </span><span class="line" data-startTime="3025">careful than that. </span></p>

<p class="speaker"><span class="line" data-starttime="3028"><span class="speakerName">Alex Russell</span>: I like to think </span><span class="line" data-startTime="3028">about this as what are you </span><span class="line" data-startTime="3030">getting back for friction? </span><span class="line" data-startTime="3032">So in native apps, there's </span><span class="line" data-startTime="3032">much more friction to </span><span class="line" data-startTime="3035">discovery and use. </span> <span class="line" data-startTime="3037">I have to know that I want it </span><span class="line" data-startTime="3037">or be told that I want it or </span><span class="line" data-startTime="3040">be advertised to as something I </span><span class="line" data-startTime="3040">should want and then go buy </span><span class="line" data-startTime="3044">it off the friction of </span><span class="line" data-startTime="3044">finding this thing. </span> <span class="line" data-startTime="3046">Whereas the web has this amazing </span><span class="line" data-startTime="3046">model where there's a </span><span class="line" data-startTime="3048">zero friction to navigate </span><span class="line" data-startTime="3048">and use a new thing. </span> <span class="line" data-startTime="3052">Identity is a problem. </span> <span class="line" data-startTime="3053">We've got a lot of other things </span><span class="line" data-startTime="3053">which add incidental </span><span class="line" data-startTime="3055">friction over time, but </span><span class="line" data-startTime="3055">generally speaking, we have </span><span class="line" data-startTime="3058">paid application developers back </span><span class="line" data-startTime="3058">1,000 fold for putting </span><span class="line" data-startTime="3063">something on the web by reducing </span><span class="line" data-startTime="3063">the friction to using </span><span class="line" data-startTime="3065">to almost nothing. </span> <span class="line" data-startTime="3067">And native app models induce </span><span class="line" data-startTime="3067">this friction. </span></p>

<p><span class="line" data-startTime="3069">And I think that Jonas is </span><span class="line" data-startTime="3069">entirely correct that that </span><span class="line" data-startTime="3072">smooth transition needs to get </span><span class="line" data-startTime="3072">you to a point where in order </span><span class="line" data-startTime="3075">to get the same capabilities </span><span class="line" data-startTime="3075">that you would give to a </span><span class="line" data-startTime="3077">native app, you have to have </span><span class="line" data-startTime="3077">the same level of friction. </span> <span class="line" data-startTime="3079">Because the constraints that you </span><span class="line" data-startTime="3079">impose at those points are </span><span class="line" data-startTime="3084">reasonable, and both sets of </span><span class="line" data-startTime="3084">system authors have made </span><span class="line" data-startTime="3088">choices about which constraints </span><span class="line" data-startTime="3088">are going to </span><span class="line" data-startTime="3089">impose at each level of friction </span><span class="line" data-startTime="3089">under all the same </span><span class="line" data-startTime="3094">considerations. </span></p>

<p><span class="line" data-startTime="3095">They're saying, if you browse to </span><span class="line" data-startTime="3095">an ephemeral web page, then </span><span class="line" data-startTime="3098">you get whatever level </span><span class="line" data-startTime="3098">of effort you put </span><span class="line" data-startTime="3101">into browsing there. </span> <span class="line" data-startTime="3102">And if you install something, </span><span class="line" data-startTime="3102">you get maybe more privilege </span><span class="line" data-startTime="3105">and more process available </span><span class="line" data-startTime="3105">to you. </span> <span class="line" data-startTime="3107">And I think that's </span><span class="line" data-startTime="3107">the right model. </span> <span class="line" data-startTime="3109">And so yeah, I think that's </span><span class="line" data-startTime="3109">going to be the endpoint, is </span><span class="line" data-startTime="3112">well, it will have that </span><span class="line" data-startTime="3112">much friction. </span> <span class="line" data-startTime="3113">And having that much friction </span><span class="line" data-startTime="3113">will get you that much. </span></p>

<p class="speaker"><span class="line" data-starttime="3115"><span class="speakerName">Mark Christian</span>: The smooth </span><span class="line" data-startTime="3115">gradient's a really </span><span class="line" data-startTime="3116">interesting model. </span><span class="line" data-startTime="3117">But I just think that as we're </span><span class="line" data-startTime="3117">designing new APIs, we should </span><span class="line" data-startTime="3120">make sure that we actually try </span><span class="line" data-startTime="3120">to figure out, what does that </span><span class="line" data-startTime="3123">smooth gradient look like? </span><span class="line" data-startTime="3124">And how can we make the APIs </span><span class="line" data-startTime="3124">flexible enough to have a </span><span class="line" data-startTime="3127">difference between it's either </span><span class="line" data-startTime="3127">working completely or it </span><span class="line" data-startTime="3130">doesn't work at all? </span></p>

<p class="speaker"><span class="line" data-starttime="3132"><span class="speakerName">Andrew Bettis</span>: I think we should </span><span class="line" data-startTime="3132">probably move on and </span><span class="line" data-startTime="3133">talk about what we can do today </span><span class="line" data-startTime="3133">rather than what we </span><span class="line" data-startTime="3136">should be doing tomorrow. </span><span class="line" data-startTime="3136">So one of the most popular </span><span class="line" data-startTime="3136">questions we have is &mdash; </span><span class="line" data-startTime="3142">a lot of people are stuffing </span><span class="line" data-startTime="3142">fonts, images, and JavaScript </span><span class="line" data-startTime="3144">in local storage for </span><span class="line" data-startTime="3144">fasting loading. </span><span class="line" data-startTime="3146">Should we be discouraging </span><span class="line" data-startTime="3146">this, which is something </span><span class="line" data-startTime="3151">[INAUDIBLE] </span><span class="line" data-startTime="3152">was saying at [INAUDIBLE] </span><span class="line" data-startTime="3153">and us as well. </span><span class="line" data-startTime="3154">So what would you say </span><span class="line" data-startTime="3154">to that, Alex? </span></p>

<p class="speaker"><span class="line" data-starttime="3158"><span class="speakerName">Alex Russell</span>: Is it </span><span class="line" data-startTime="3158">working for you? </span><span class="line" data-startTime="3159">If so, go for it. </span><span class="line" data-startTime="3162">I mean, I come from a dirty </span><span class="line" data-startTime="3162">JavaScript hacker background. </span><span class="line" data-startTime="3164">Man, if it works, run. </span><span class="line" data-startTime="3167">Run with it as far as it goes. </span><span class="line" data-startTime="3168">But measure. </span><span class="line" data-startTime="3168">Measure, measure, measure. </span><span class="line" data-startTime="3169">If it's actually faster, </span><span class="line" data-startTime="3169">heck yes. </span><span class="line" data-startTime="3172">Make the web faster. </span><span class="line" data-startTime="3172">Go, do it. </span></p>

<p class="speaker"><span class="line" data-starttime="3174"><span class="speakerName">Andrew Bettis</span>: So do we need </span><span class="line" data-startTime="3174">to be aware of what pain </span><span class="line" data-startTime="3177">that's storing up for </span><span class="line" data-startTime="3177">us in the future? </span><span class="line" data-startTime="3178">And how much pain is that </span><span class="line" data-startTime="3178">storing up for us in future? </span></p>

<p class="speaker"><span class="line" data-starttime="3181"><span class="speakerName">Alex Russell</span>: A lot. </span><span class="line" data-startTime="3182">So let me tell you </span><span class="line" data-startTime="3182">all about it. </span><span class="line" data-startTime="3187">So you'll notice if you're </span><span class="line" data-startTime="3187">stuffing a lot of stuff into </span><span class="line" data-startTime="3191">local storage that you'll see </span><span class="line" data-startTime="3191">some really strange behavioral </span><span class="line" data-startTime="3194">differences between IE9 and 10, </span><span class="line" data-startTime="3194">and Firefox and Chrome, </span><span class="line" data-startTime="3199">with regards to potentially </span><span class="line" data-startTime="3199">getting out of sync across </span><span class="line" data-startTime="3203">tabs or across Windows with </span><span class="line" data-startTime="3203">regards to try to communicate </span><span class="line" data-startTime="3206">over a local storage. </span><span class="line" data-startTime="3207">Well, why is that? </span><span class="line" data-startTime="3208">Local storage is a </span><span class="line" data-startTime="3208">synchronous API. </span><span class="line" data-startTime="3210">This is generally speaking in </span><span class="line" data-startTime="3210">terms of web API design a </span><span class="line" data-startTime="3213">terrible, terrible thing. </span><span class="line" data-startTime="3214">This is a bad thing. </span><span class="line" data-startTime="3216">It's the reason that IndexDB </span><span class="line" data-startTime="3216">is coming along &mdash; </span><span class="line" data-startTime="3219">which is available, I think, in </span><span class="line" data-startTime="3219">IE10 and it's available in </span><span class="line" data-startTime="3221">Chrome and it's coming along </span><span class="line" data-startTime="3221">in other places, too. </span></p>

<p class="speaker"><span class="line" data-starttime="3224"><span class="speakerName">Jake Archibald</span>: Another </span><span class="line" data-startTime="3224">terrible, terrible thing. </span></p>

<p class="speaker"><span class="line" data-starttime="3225"><span class="speakerName">Alex Russell</span>: I know. </span> <span class="line" data-startTime="3225">It's harder to use, right? </span><span class="line" data-startTime="3228">So that was the pain. </span> <span class="line" data-startTime="3229">So that pain generated this new </span><span class="line" data-startTime="3229">system which isn't widely </span><span class="line" data-startTime="3235">enough deployed yet. </span> <span class="line" data-startTime="3236">And so folks find out that </span><span class="line" data-startTime="3236">there's an implicit cross tab </span><span class="line" data-startTime="3242">synchronization issue with local </span><span class="line" data-startTime="3242">storage because the API </span><span class="line" data-startTime="3245">is synchronous for all the tabs </span><span class="line" data-startTime="3245">that can see the same </span><span class="line" data-startTime="3247">local store. </span> <span class="line" data-startTime="3248">This isn't great. </span> <span class="line" data-startTime="3249">This is actually relatively </span><span class="line" data-startTime="3249">terrible. </span> <span class="line" data-startTime="3251">So we need an asynchronous </span><span class="line" data-startTime="3251">version of local storage. </span> <span class="line" data-startTime="3252">So one of these you're biting </span><span class="line" data-startTime="3252">off is a huge performance </span><span class="line" data-startTime="3254">issue because you'll start </span><span class="line" data-startTime="3254">loading your web page, you'll </span><span class="line" data-startTime="3257">ask local storage early in the </span><span class="line" data-startTime="3257">document load to go grab you </span><span class="line" data-startTime="3260">some resource, and you </span><span class="line" data-startTime="3260">think it's fast. </span> <span class="line" data-startTime="3262">Except we're brand </span><span class="line" data-startTime="3262">new to this. </span> <span class="line" data-startTime="3265">We might have put this in a </span><span class="line" data-startTime="3265">SQLite database on a per local </span><span class="line" data-startTime="3267">store or per origin basis. </span></p>

<p><span class="line" data-startTime="3269">We have to go do synchronize IO </span><span class="line" data-startTime="3269">to go load that database, </span><span class="line" data-startTime="3272">block that web page, by the way, </span><span class="line" data-startTime="3272">while we're doing this, </span><span class="line" data-startTime="3274">block the main thread, go do a </span><span class="line" data-startTime="3274">bunch of IO, and then give you </span><span class="line" data-startTime="3278">the answer. </span> <span class="line" data-startTime="3279">This is terrible for </span><span class="line" data-startTime="3279">performance. </span></p>

<p class="speaker"><span class="line" data-starttime="3281"><span class="speakerName">Andrew Bettis</span>: OK, so I get it. </span><span class="line" data-startTime="3281">I get it. </span><span class="line" data-startTime="3282">It's painful. </span><span class="line" data-startTime="3282">So should we just not do it </span><span class="line" data-startTime="3282">and wait for this amazing </span><span class="line" data-startTime="3286">navigation controller </span><span class="line" data-startTime="3286">to appear? </span></p>

<p class="speaker"><span class="line" data-starttime="3287"><span class="speakerName">Alex Russell</span>: No, you </span><span class="line" data-startTime="3287">should measure. </span><span class="line" data-startTime="3288">You should measure, </span><span class="line" data-startTime="3288">measure, measure. </span><span class="line" data-startTime="3289">And once you've measured, you'll </span><span class="line" data-startTime="3289">have an answer about </span><span class="line" data-startTime="3291">whether or not it's </span><span class="line" data-startTime="3291">better or worse. </span><span class="line" data-startTime="3292">But you won't until </span><span class="line" data-startTime="3292">you measure. </span></p>

<p class="speaker"><span class="line" data-starttime="3297"><span class="speakerName">Jonas Sicking</span>: So I </span><span class="line" data-startTime="3297">think there's two </span><span class="line" data-startTime="3299">separate questions here. </span> <span class="line" data-startTime="3301">Taking resources and storing </span><span class="line" data-startTime="3301">them locally on the client </span><span class="line" data-startTime="3305">side, I think, it's a good </span><span class="line" data-startTime="3305">workaround to do until we get </span><span class="line" data-startTime="3309">things like this controller </span><span class="line" data-startTime="3309">thing, until we fix AppCache, </span><span class="line" data-startTime="3314">until we get other mechanisms in </span><span class="line" data-startTime="3314">place that actually make it </span><span class="line" data-startTime="3317">a pleasurable experience to </span><span class="line" data-startTime="3317">develop these solutions. </span> <span class="line" data-startTime="3325">So the local storage issue of </span><span class="line" data-startTime="3325">being asynchronous API &mdash; </span><span class="line" data-startTime="3330">please to measure it, but it's </span><span class="line" data-startTime="3330">actually really, really hard </span><span class="line" data-startTime="3332">to measure. </span></p>

<p><span class="line" data-startTime="3333">The problem is that what a lot </span><span class="line" data-startTime="3333">of asynchronous IO, which A, </span><span class="line" data-startTime="3339">is very, very dependent </span><span class="line" data-startTime="3339">on a device. </span> <span class="line" data-startTime="3341">You can't measure it locally. </span> <span class="line" data-startTime="3342">You need to measure it on </span><span class="line" data-startTime="3342">your users' devices. </span> <span class="line" data-startTime="3346">The other problem is that it's </span><span class="line" data-startTime="3346">not a performance hit that </span><span class="line" data-startTime="3351">happens every time you </span><span class="line" data-startTime="3351">use local storage. </span> <span class="line" data-startTime="3354">It happens probably the </span><span class="line" data-startTime="3354">first time you see it. </span> <span class="line" data-startTime="3357">And even just like calling &mdash; </span><span class="line" data-startTime="3359">we've had some benchmarks that </span><span class="line" data-startTime="3359">the first thing it does, it </span><span class="line" data-startTime="3361">calls localStorage.clear </span><span class="line" data-startTime="3361">and then it </span><span class="line" data-startTime="3363">starts using local storage. </span></p>

<p><span class="line" data-startTime="3364">But at the time you called the </span><span class="line" data-startTime="3364">localStorage.clear, that's </span><span class="line" data-startTime="3367">actually when the performance </span><span class="line" data-startTime="3367">hit happens. </span> <span class="line" data-startTime="3368">Local storage, I would say, </span><span class="line" data-startTime="3368">is hard enough to measure </span><span class="line" data-startTime="3371">performance of that </span><span class="line" data-startTime="3371">you probably </span><span class="line" data-startTime="3372">will not get it right. </span> <span class="line" data-startTime="3373">What we're doing in Firefox at </span><span class="line" data-startTime="3373">22, 21 or something is we're </span><span class="line" data-startTime="3378">actually going to pre-load local </span><span class="line" data-startTime="3378">storage before we're </span><span class="line" data-startTime="3380">even running scripts. </span> <span class="line" data-startTime="3382">So that performance hit </span><span class="line" data-startTime="3382">is not something </span><span class="line" data-startTime="3383">you can't even measure. </span> <span class="line" data-startTime="3385">And the reason we're doing that </span><span class="line" data-startTime="3385">is because hopefully in </span><span class="line" data-startTime="3388">those cases, we can do this </span><span class="line" data-startTime="3388">IO before we're even </span><span class="line" data-startTime="3391">attempting to use it. </span> <span class="line" data-startTime="3394">It does have the effect that </span><span class="line" data-startTime="3394">we're going to do more IO for </span><span class="line" data-startTime="3399">each and every page on your </span><span class="line" data-startTime="3399">website as soon as you use </span><span class="line" data-startTime="3403">local storage. </span></p>

<p><span class="line" data-startTime="3404">But that's to avoid halting </span><span class="line" data-startTime="3404">the thread and having your </span><span class="line" data-startTime="3409">site look up while you're </span><span class="line" data-startTime="3409">doing this IO. </span> <span class="line" data-startTime="3412">So local storage's performance </span><span class="line" data-startTime="3412">is really, really tricky. </span> <span class="line" data-startTime="3415">So IndexDB has issues. </span> <span class="line" data-startTime="3420">Those are, in big </span><span class="line" data-startTime="3420">part, my fault. </span> <span class="line" data-startTime="3422">I'm one of the editors </span><span class="line" data-startTime="3422">for that spec. </span> <span class="line" data-startTime="3425">We do need something like </span><span class="line" data-startTime="3425">asynchronous local storage, </span><span class="line" data-startTime="3427">which is as simple as local </span><span class="line" data-startTime="3427">storage but doesn't have the </span><span class="line" data-startTime="3430">synchronous problem. </span> <span class="line" data-startTime="3432">So that hopefully </span><span class="line" data-startTime="3432">will come soon. </span></p>

<p class="speaker"><span class="line" data-starttime="3435"><span class="speakerName">Alex Russell</span>: I'm hoping </span><span class="line" data-startTime="3435">for that, too. </span></p>

<p class="speaker"><span class="line" data-starttime="3438"><span class="speakerName">Andrew Bettis</span>: OK, so in the </span><span class="line" data-startTime="3438">meantime, do you think that </span><span class="line" data-startTime="3443">the fact that developers love </span><span class="line" data-startTime="3443">local storage and don't like </span><span class="line" data-startTime="3448">APIs like IndexDB is an </span><span class="line" data-startTime="3448">indication that we need to </span><span class="line" data-startTime="3452">simplify IndexDB and Web SQL </span><span class="line" data-startTime="3452">and those sort of APIs? </span></p>

<p class="speaker"><span class="line" data-starttime="3459"><span class="speakerName">Alex Russell</span>: Yes, absolutely. </span> <span class="line" data-startTime="3460">So one of the things that I've </span><span class="line" data-startTime="3460">been working on over the last </span><span class="line" data-startTime="3462">couple of months is to add </span><span class="line" data-startTime="3462">a futures primitive. </span> <span class="line" data-startTime="3466">So you might have promises </span><span class="line" data-startTime="3466">in your libraries. </span> <span class="line" data-startTime="3468">We're just going to ignore the </span><span class="line" data-startTime="3468">fight over what it means to </span><span class="line" data-startTime="3470">have a promise. </span> <span class="line" data-startTime="3471">We're going to call </span><span class="line" data-startTime="3471">it a future. </span> <span class="line" data-startTime="3472">It's a different thing. </span> <span class="line" data-startTime="3473">Same API. </span> <span class="line" data-startTime="3474">.then, and then you can add </span><span class="line" data-startTime="3474">whatever callbacks you want to </span><span class="line" data-startTime="3477">success and failure, </span><span class="line" data-startTime="3477">accept or reject. </span></p>

<p><span class="line" data-startTime="3479">OK, cool. </span> <span class="line" data-startTime="3480">So we're building a spec for </span><span class="line" data-startTime="3480">futures for DOM, so we can </span><span class="line" data-startTime="3483">start to reinterpret a lot of </span><span class="line" data-startTime="3483">these asynchronous things in a </span><span class="line" data-startTime="3486">more unified way. </span> <span class="line" data-startTime="3487">Because events aren't really the </span><span class="line" data-startTime="3487">right model for something </span><span class="line" data-startTime="3489">that is a single request. </span> <span class="line" data-startTime="3492">If I get one thing out of local </span><span class="line" data-startTime="3492">storage, I'm only asking </span><span class="line" data-startTime="3494">for one thing back. </span> <span class="line" data-startTime="3495">I'm not asking for a potential </span><span class="line" data-startTime="3495">stream of things to happen </span><span class="line" data-startTime="3497">zero or more times in </span><span class="line" data-startTime="3497">the future, which </span><span class="line" data-startTime="3499">is the event model. </span> <span class="line" data-startTime="3500">So I have hope that we'll be </span><span class="line" data-startTime="3500">able to build a saner version </span><span class="line" data-startTime="3505">of a lot of these APIs to stop </span><span class="line" data-startTime="3505">using events and stop using </span><span class="line" data-startTime="3508">implicit asynchronicity and end </span><span class="line" data-startTime="3508">of term behavior and make </span><span class="line" data-startTime="3512">it much more explicit in the </span><span class="line" data-startTime="3512">APIs, do an asynchronous local </span><span class="line" data-startTime="3516">storage on top of something like </span><span class="line" data-startTime="3516">this, and then Web Crypto </span><span class="line" data-startTime="3520">and IndexDB, I think all these </span><span class="line" data-startTime="3520">APIs can be retrofitted with </span><span class="line" data-startTime="3525">this model so that we get a </span><span class="line" data-startTime="3525">much more rational API. </span> <span class="line" data-startTime="3528">I think a lot of this is down to </span><span class="line" data-startTime="3528">the APIs not really having </span><span class="line" data-startTime="3531">great idioms baked into them. </span> <span class="line" data-startTime="3533">And it's one of these </span><span class="line" data-startTime="3533">traditional DOM versus the </span><span class="line" data-startTime="3535">rest of the JavaScript world </span><span class="line" data-startTime="3535">discussions, which I'm happy </span><span class="line" data-startTime="3538">to talk to you about over </span><span class="line" data-startTime="3538">beer endlessly. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="3540"><span class="speakerName">Andrew Bettis</span>: So how long </span><span class="line" data-startTime="3540">until we get navigation </span><span class="line" data-startTime="3541">controller? </span></p>

<p class="speaker"><span class="line" data-starttime="3547"><span class="speakerName">Jake Archibald</span>: I'm not taking </span><span class="line" data-startTime="3547">responsibility for that. </span></p>

<p class="speaker"><span class="line" data-starttime="3549"><span class="speakerName">Jonas Sicking</span>: So the space of </span><span class="line" data-startTime="3549">fixing the AppCache where </span><span class="line" data-startTime="3554">navigation controller is a very </span><span class="line" data-startTime="3554">interesting proposal is </span><span class="line" data-startTime="3559">something that for some reason </span><span class="line" data-startTime="3559">we had a very, very hard time </span><span class="line" data-startTime="3564">actually getting to the point </span><span class="line" data-startTime="3564">of having proposals. </span> <span class="line" data-startTime="3566">I would say we've been working </span><span class="line" data-startTime="3566">on this for well over a year </span><span class="line" data-startTime="3569">and a half, probably two years, </span><span class="line" data-startTime="3569">on just people ranting </span><span class="line" data-startTime="3573">about how much AppCache </span><span class="line" data-startTime="3573">sucks, but there has </span><span class="line" data-startTime="3575">not been any proposals. </span> <span class="line" data-startTime="3576">There are now two proposals. </span></p>

<p><span class="line" data-startTime="3578">There's the controller thing. </span> <span class="line" data-startTime="3579">Mozilla also has a proposal that </span><span class="line" data-startTime="3579">we're hopefully going to </span><span class="line" data-startTime="3582">present very soon. </span> <span class="line" data-startTime="3585">And I think that's an enormously </span><span class="line" data-startTime="3585">good first step. </span> <span class="line" data-startTime="3587">What we need to do once we have </span><span class="line" data-startTime="3587">these proposals is to get </span><span class="line" data-startTime="3592">feedback from everyone </span><span class="line" data-startTime="3592">that has been </span><span class="line" data-startTime="3594">complaining about AppCache. </span> <span class="line" data-startTime="3599">The two proposals are actually </span><span class="line" data-startTime="3599">very complementary, so they </span><span class="line" data-startTime="3601">actually combine very well. </span> <span class="line" data-startTime="3604">If you had these two </span><span class="line" data-startTime="3604">things, would </span><span class="line" data-startTime="3606">that solve your problems? </span><span class="line" data-startTime="3607">Or would this just be </span><span class="line" data-startTime="3607">a less sucky way? </span><span class="line" data-startTime="3611">So we have a very </span><span class="line" data-startTime="3611">good first step. </span></p>

<p><span class="line" data-startTime="3615">It will take a little bit to </span><span class="line" data-startTime="3615">get this stuff implemented, </span><span class="line" data-startTime="3617">but I think it'll take a lot </span><span class="line" data-startTime="3617">less than the well over a year </span><span class="line" data-startTime="3622">that we've been complaining </span><span class="line" data-startTime="3622">about AppCache. </span></p>

<p class="speaker"><span class="line" data-starttime="3626"><span class="speakerName">Jake Archibald</span>: So on the </span><span class="line" data-startTime="3626">simple APIs, do we build </span><span class="line" data-startTime="3629">something really low level and </span><span class="line" data-startTime="3629">maybe a bit more complicated </span><span class="line" data-startTime="3632">to deal with, or do </span><span class="line" data-startTime="3632">we just try and go </span><span class="line" data-startTime="3633">as simple as possible? </span><span class="line" data-startTime="3635">We want something as simple </span><span class="line" data-startTime="3635">as possible, but look what </span><span class="line" data-startTime="3638">happened to AppCache. </span> <span class="line" data-startTime="3639">They made something that was </span><span class="line" data-startTime="3639">really, really simple, but </span><span class="line" data-startTime="3642">they didn't know what people </span><span class="line" data-startTime="3642">really wanted to do with it, </span><span class="line" data-startTime="3644">so they made some things </span><span class="line" data-startTime="3644">simple and useless. </span> <span class="line" data-startTime="3648">Whereas with local storage, that </span><span class="line" data-startTime="3648">was the simple and easy </span><span class="line" data-startTime="3652">to use but had massive </span><span class="line" data-startTime="3652">performance problems. </span> <span class="line" data-startTime="3655">So I like the world where you </span><span class="line" data-startTime="3655">might have something like </span><span class="line" data-startTime="3658">IndexDB, where it's what you can </span><span class="line" data-startTime="3658">do with it &mdash; there's loads </span><span class="line" data-startTime="3661">you can do with it &mdash; </span><span class="line" data-startTime="3662">but then have a look at what </span><span class="line" data-startTime="3662">the use cases are. </span> <span class="line" data-startTime="3664">See what code you see people </span><span class="line" data-startTime="3664">repeating over and over. </span> <span class="line" data-startTime="3666">What are people using libraries </span><span class="line" data-startTime="3666">for, and how can we </span><span class="line" data-startTime="3668">get that into the problem? </span><span class="line" data-startTime="3669">You see that happening </span><span class="line" data-startTime="3669">with the DOM now. </span> <span class="line" data-startTime="3671">querySelectorAll was one </span><span class="line" data-startTime="3671">of those things. </span></p>

<p><span class="line" data-startTime="3673">We see jQuery doing it. </span> <span class="line" data-startTime="3675">We can make jQuery faster by </span><span class="line" data-startTime="3675">having that on the platform, </span><span class="line" data-startTime="3677">and people maybe wouldn't </span><span class="line" data-startTime="3677">have to use jQuery </span><span class="line" data-startTime="3680">if that's the case. </span> <span class="line" data-startTime="3681">So that's what I see going </span><span class="line" data-startTime="3681">with the navigation </span><span class="line" data-startTime="3684">controller. </span> <span class="line" data-startTime="3685">Some of the code that I showed </span><span class="line" data-startTime="3685">on there was stuff I made up. </span> <span class="line" data-startTime="3688">There was a routing function, </span><span class="line" data-startTime="3688">which is something that </span><span class="line" data-startTime="3691">probably won't be there in the </span><span class="line" data-startTime="3691">initial spec, but it's </span><span class="line" data-startTime="3693">something you can create </span><span class="line" data-startTime="3693">yourself or something a </span><span class="line" data-startTime="3696">library can give you. </span> <span class="line" data-startTime="3699">And we'll be able to see what </span><span class="line" data-startTime="3699">people are doing and if </span><span class="line" data-startTime="3703">there's common patterns or a lot </span><span class="line" data-startTime="3703">of repeated code, then we </span><span class="line" data-startTime="3705">can put that in the platform and </span><span class="line" data-startTime="3705">make it quicker and make </span><span class="line" data-startTime="3709">it less typing. </span></p>

<p class="speaker"><span class="line" data-starttime="3710"><span class="speakerName">Mark Christian</span>: Yeah, we can </span><span class="line" data-startTime="3710">trust that libraries will come </span><span class="line" data-startTime="3712">into existence. </span><span class="line" data-startTime="3712">It's something that we can </span><span class="line" data-startTime="3712">rely on on the web. </span><span class="line" data-startTime="3714">So we should build for </span><span class="line" data-startTime="3714">flexibility instead of stupid </span><span class="line" data-startTime="3718">simplicity. </span></p>

<p class="speaker"><span class="line" data-starttime="3720"><span class="speakerName">Andrew Bettis</span>: Well, </span><span class="line" data-startTime="3720">we're out of time. </span><span class="line" data-startTime="3721">So thanks, everyone. </span><span class="line" data-startTime="3723">And that's the end </span><span class="line" data-startTime="3723">of the panel. </span><span class="line" data-startTime="3723">[APPLAUSE] </span></p>