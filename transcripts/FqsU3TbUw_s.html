<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Dart for the modern web developer &mdash; Chrome Dev Summit 2013 (Seth Ladd, Kasper Lund)</h1>

<h2>Jake Archibald, Seth Ladd, Kasper Lund</h2>

<a class="video" href="http://youtu.be/FqsU3TbUw_s">youtu.be/FqsU3TbUw_s</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="0"><span class="speakerName">Jake Archibald</span>: So back </span><span class="line" data-startTime="0">in 1995, JavaScript </span><span class="line" data-startTime="2">was created by Brendan Eich. </span> <span class="line" data-startTime="4">And he did it in 10 days, which </span><span class="line" data-startTime="4">is pretty crazy, that it's </span><span class="line" data-startTime="8">what most of the </span><span class="line" data-startTime="8">web is built of now. </span> <span class="line" data-startTime="10">JavaScript is 18 </span><span class="line" data-startTime="10">years old now, so it's </span><span class="line" data-startTime="13">legal to drink in </span><span class="line" data-startTime="13">some countries. </span> <span class="line" data-startTime="15">It's also on Twitter, </span><span class="line" data-startTime="15">saying that they </span><span class="line" data-startTime="18">think they've seen JavaScript </span><span class="line" data-startTime="18">drunk many years ago, </span><span class="line" data-startTime="22">a lot of the time </span><span class="line" data-startTime="22">quite like that. </span> <span class="line" data-startTime="25">But in 2010, another team set </span><span class="line" data-startTime="25">about making a new language. </span> <span class="line" data-startTime="29">And from what we know </span><span class="line" data-startTime="29">now of the web &mdash; we </span><span class="line" data-startTime="31">know how the whole web is put </span><span class="line" data-startTime="31">together and the kind of tools </span><span class="line" data-startTime="34">we need. </span></p>

<p><span class="line" data-startTime="35">And that team is the </span><span class="line" data-startTime="35">Dart team, and here </span><span class="line" data-startTime="36">to talk about it &mdash; </span><span class="line" data-startTime="36">big warm welcome </span><span class="line" data-startTime="38">to Seth Ladd and Kasper Lund. </span></p>

<p class="speaker"><span class="line" data-starttime="45"><span class="speakerName">Seth Ladd</span>: Thanks Jake. </span><span class="line" data-startTime="46">So we won't be </span><span class="line" data-startTime="46">playing the Kenny G. </span><span class="line" data-startTime="47">We don't want you </span><span class="line" data-startTime="47">guys to fall asleep. </span><span class="line" data-startTime="49">This is Dart for the </span><span class="line" data-startTime="49">modern web developer. </span><span class="line" data-startTime="52">My name is Seth Ladd. </span><span class="line" data-startTime="52">I'm a developer advocate with </span><span class="line" data-startTime="52">the Chrome and Dart team. </span></p>

<p class="speaker"><span class="line" data-starttime="55"><span class="speakerName">Kasper Lund</span>: And </span><span class="line" data-startTime="55">I'm Kasper Lund. </span><span class="line" data-startTime="56">I'm an engineer here at Google. </span><span class="line" data-startTime="58">I work as a tech lead </span><span class="line" data-startTime="58">on the Dart platform. </span><span class="line" data-startTime="60">And before I ventured </span><span class="line" data-startTime="60">into Dart territory, </span><span class="line" data-startTime="63">I spent a lot of </span><span class="line" data-startTime="63">years on optimizing V8 </span><span class="line" data-startTime="66">and the optimizing </span><span class="line" data-startTime="66">compiler in there. </span></p>

<p class="speaker"><span class="line" data-starttime="69"><span class="speakerName">Seth Ladd</span>: OK. </span> <span class="line" data-startTime="69">So many of you know </span><span class="line" data-startTime="69">Dart as a language. </span> <span class="line" data-startTime="71">And sure it's a structured, </span><span class="line" data-startTime="71">scalable, familiar language, </span><span class="line" data-startTime="74">but it's also &mdash; I like to think </span><span class="line" data-startTime="74">of it as a batteries included </span><span class="line" data-startTime="77">platform. </span> <span class="line" data-startTime="77">There's a great core set </span><span class="line" data-startTime="77">of libraries &mdash; things </span><span class="line" data-startTime="80">like collections, things like </span><span class="line" data-startTime="80">asynchronous programming, </span><span class="line" data-startTime="83">futures, streams, </span><span class="line" data-startTime="83">things like numbers, </span><span class="line" data-startTime="85">booleans, dates, times. </span> <span class="line" data-startTime="87">We also ship a collection </span><span class="line" data-startTime="87">of productive tools &mdash; </span><span class="line" data-startTime="89">a Dart Editor, an analyzer to </span><span class="line" data-startTime="89">give you warnings and errors, </span><span class="line" data-startTime="93">a package manager we </span><span class="line" data-startTime="93">affectionately call Pub, </span><span class="line" data-startTime="96">because you play darts in a pub. </span></p>

<p><span class="line" data-startTime="98">We also ship a virtual machine </span><span class="line" data-startTime="98">which runs Dart code natively. </span> <span class="line" data-startTime="101">You can run that VM on a </span><span class="line" data-startTime="101">command line or on the server, </span><span class="line" data-startTime="104">and you can also embed </span><span class="line" data-startTime="104">it in client browsers. </span> <span class="line" data-startTime="106">But probably most </span><span class="line" data-startTime="106">importantly, we </span><span class="line" data-startTime="109">ship a Compiler to JavaScript. </span> <span class="line" data-startTime="111">So the Dart code </span><span class="line" data-startTime="111">you see here today, </span><span class="line" data-startTime="113">and the Dart apps that </span><span class="line" data-startTime="113">you'll be writing, </span><span class="line" data-startTime="114">you can compile that down </span><span class="line" data-startTime="114">to essentially ECMAScript </span><span class="line" data-startTime="117">5, and run it across modern </span><span class="line" data-startTime="117">browsers, desktop and laptop. </span> <span class="line" data-startTime="122">You might have heard recently, </span><span class="line" data-startTime="122">we launched Dart 1.0. </span> <span class="line" data-startTime="124">It was a big milestone </span><span class="line" data-startTime="124">for us, hopefully exciting </span><span class="line" data-startTime="126">for you guys. </span></p>

<p><span class="line" data-startTime="127">The big point of this, really &mdash; </span><span class="line" data-startTime="129">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="129"><span class="speakerName">Seth Ladd</span>: Thank you. </span> <span class="line" data-startTime="133">The journey starts </span><span class="line" data-startTime="133">here, really, for us. </span> <span class="line" data-startTime="135">The big point here, </span><span class="line" data-startTime="135">the big take away, </span><span class="line" data-startTime="137">is it's now stability </span><span class="line" data-startTime="137">you can count on. </span> <span class="line" data-startTime="140">We've been open source </span><span class="line" data-startTime="140">since about October 2011, </span><span class="line" data-startTime="142">and gotten tons of feedback </span><span class="line" data-startTime="142">from internal developers, </span><span class="line" data-startTime="145">external developers, </span><span class="line" data-startTime="145">hackathons, code labs. </span> <span class="line" data-startTime="147">And we've collected </span><span class="line" data-startTime="147">that all and launched </span><span class="line" data-startTime="149">what is now a stable language, </span><span class="line" data-startTime="149">stable core libraries for you </span><span class="line" data-startTime="152">to build production apps on. </span> <span class="line" data-startTime="154">So now is the right </span><span class="line" data-startTime="154">time to try it. </span> <span class="line" data-startTime="156">OK. </span> <span class="line" data-startTime="157">So when I said you </span><span class="line" data-startTime="157">can use Dart today, </span><span class="line" data-startTime="159">I think I actually mean you can </span><span class="line" data-startTime="159">use Dart like in the next hour. </span> <span class="line" data-startTime="162">So we're going to do a lightning </span><span class="line" data-startTime="162">tour of the syntax structure </span><span class="line" data-startTime="165">and semantics to show </span><span class="line" data-startTime="165">you how familiar and easy </span><span class="line" data-startTime="167">it is to get started. </span></p>

<p><span class="line" data-startTime="169">So Dart, by design, </span><span class="line" data-startTime="169">is very easy to learn. </span> <span class="line" data-startTime="172">We have semi-colons. </span> <span class="line" data-startTime="173">We have curly braces. </span> <span class="line" data-startTime="174">In fact, we got a little flak </span><span class="line" data-startTime="174">when we first launched Dart. </span> <span class="line" data-startTime="176">People were like, why don't </span><span class="line" data-startTime="176">you make the next big Haskell? </span><span class="line" data-startTime="179">And we're like, we want </span><span class="line" data-startTime="179">more than five users. </span> <span class="line" data-startTime="181">And so we wanted to make sure </span><span class="line" data-startTime="181">that you guys can totally </span><span class="line" data-startTime="183">understand this code. </span> <span class="line" data-startTime="184">We've run hackathons </span><span class="line" data-startTime="184">and code labs. </span> <span class="line" data-startTime="186">People get it. </span> <span class="line" data-startTime="187">So familiar, classes. </span></p>

<p><span class="line" data-startTime="189">But just because it's </span><span class="line" data-startTime="189">a familiar language </span><span class="line" data-startTime="191">you can dive into </span><span class="line" data-startTime="191">in about an hour, </span><span class="line" data-startTime="192">doesn't mean we can't </span><span class="line" data-startTime="192">take this opportunity </span><span class="line" data-startTime="194">to introduce new features, for </span><span class="line" data-startTime="194">instance, with constructors. </span> <span class="line" data-startTime="197">What do we always </span><span class="line" data-startTime="197">do in constructors? </span><span class="line" data-startTime="198">This dot x equals x. </span> <span class="line" data-startTime="199">This dot y equals y. </span> <span class="line" data-startTime="200">This is getting boring. </span> <span class="line" data-startTime="201">So Dart says, hey, if </span><span class="line" data-startTime="201">the name of the field </span><span class="line" data-startTime="203">is the same as the </span><span class="line" data-startTime="203">constructor parameter, just </span><span class="line" data-startTime="205">say, this.strength in this case. </span> <span class="line" data-startTime="207">And that will desugar to </span><span class="line" data-startTime="207">this.strength equals strength. </span> <span class="line" data-startTime="210">Just those nice </span><span class="line" data-startTime="210">additions that make this </span><span class="line" data-startTime="211">feel more terse, more scripty. </span> <span class="line" data-startTime="214">Speaking of scripty, Dart </span><span class="line" data-startTime="214">has operator overriding. </span> <span class="line" data-startTime="218">So plus, minus, et cetera, </span><span class="line" data-startTime="218">that's in this language. </span> <span class="line" data-startTime="221">We also named </span><span class="line" data-startTime="221">optional parameters. </span> <span class="line" data-startTime="223">Again, it's a </span><span class="line" data-startTime="223">structure language. </span></p>

<p><span class="line" data-startTime="225">It may look like the structure </span><span class="line" data-startTime="225">language you've been using, </span><span class="line" data-startTime="227">but it has those </span><span class="line" data-startTime="227">features that allow </span><span class="line" data-startTime="229">you to have a terse programming </span><span class="line" data-startTime="229">experience that you might </span><span class="line" data-startTime="231">be more familiar with </span><span class="line" data-startTime="231">than scripting languages. </span> <span class="line" data-startTime="233">In fact, this case here, hands </span><span class="line" data-startTime="233">is an optional parameter, </span><span class="line" data-startTime="235">but also has a </span><span class="line" data-startTime="235">default value of one. </span> <span class="line" data-startTime="237">So say more without typing more. </span> <span class="line" data-startTime="241">We also support </span><span class="line" data-startTime="241">one-line functions. </span> <span class="line" data-startTime="242">This is critical. </span> <span class="line" data-startTime="242">There's a lot of callbacks </span><span class="line" data-startTime="242">going on in web programming, </span><span class="line" data-startTime="245">and a lot of times </span><span class="line" data-startTime="245">you want to do </span><span class="line" data-startTime="246">really small, inline </span><span class="line" data-startTime="246">function literals. </span> <span class="line" data-startTime="249">We support that with </span><span class="line" data-startTime="249">the fat arrow syntax. </span> <span class="line" data-startTime="252">And we also have </span><span class="line" data-startTime="252">string interpolation, </span><span class="line" data-startTime="254">making it very easy and quick </span><span class="line" data-startTime="254">to create strings, just dollar </span><span class="line" data-startTime="256">sign, variable, or expression. </span></p>

<p><span class="line" data-startTime="258">And it's right there. </span> <span class="line" data-startTime="259">It's a lot easier than doing </span><span class="line" data-startTime="259">string builders or string </span><span class="line" data-startTime="261">concatenation. </span> <span class="line" data-startTime="263">So Dart is its own language. </span> <span class="line" data-startTime="266">It's not just the syntax </span><span class="line" data-startTime="266">that masks another syntax. </span> <span class="line" data-startTime="269">We have our own clean semantics. </span> <span class="line" data-startTime="271">So we want to turn more of these </span><span class="line" data-startTime="271">"wat" moments, which I'm not </span><span class="line" data-startTime="274">even sure what's going </span><span class="line" data-startTime="274">on here, into the totally </span><span class="line" data-startTime="277">awesome atomic </span><span class="line" data-startTime="277">dinosaur nuclear rocks. </span> <span class="line" data-startTime="278">We want you to have more on </span><span class="line" data-startTime="278">the right, less on the left. </span> <span class="line" data-startTime="283">Some examples of the cleaned </span><span class="line" data-startTime="283">up semantics that give you </span><span class="line" data-startTime="285">a more logical programming </span><span class="line" data-startTime="285">experience in Dart &mdash; only true </span><span class="line" data-startTime="288">is truthy. </span></p>

<p><span class="line" data-startTime="289">There you go. </span> <span class="line" data-startTime="290">Now you know the truthy rules. </span> <span class="line" data-startTime="291">Good job. </span> <span class="line" data-startTime="292">There is no </span><span class="line" data-startTime="292">undefined, only null. </span> <span class="line" data-startTime="295">Yes, totally, cleaned up. </span> <span class="line" data-startTime="299">No type coercion with things </span><span class="line" data-startTime="299">like double equals and plus. </span> <span class="line" data-startTime="302">So when you try to do something </span><span class="line" data-startTime="302">funky, we're going to tell you. </span> <span class="line" data-startTime="306">Pop quiz time. </span> <span class="line" data-startTime="307">Here's a string "hello" </span><span class="line" data-startTime="307">we call .missing, </span><span class="line" data-startTime="309">which obviously does </span><span class="line" data-startTime="309">not exist on string. </span> <span class="line" data-startTime="311">What would you want to </span><span class="line" data-startTime="311">happen at this point? </span><span class="line" data-startTime="315">Undefined? </span><span class="line" data-startTime="316">I don't want undefined. </span> <span class="line" data-startTime="317">I want to be told that there's </span><span class="line" data-startTime="317">no missing method on string. </span></p>

<p><span class="line" data-startTime="321">And sure enough, at runtime, </span><span class="line" data-startTime="321">when you hit code like this, </span><span class="line" data-startTime="323">the program tells you </span><span class="line" data-startTime="323">with a very clean error. </span> <span class="line" data-startTime="326">So a much more logical </span><span class="line" data-startTime="326">programming experience. </span> <span class="line" data-startTime="328">If you were to compare </span><span class="line" data-startTime="328">'hello', which is a string, </span><span class="line" data-startTime="331">is it greater than one? </span><span class="line" data-startTime="332">I think this returns </span><span class="line" data-startTime="332">false, but actually I'm </span><span class="line" data-startTime="334">not really sure why. </span> <span class="line" data-startTime="336">So what would you </span><span class="line" data-startTime="336">want this to happen? </span><span class="line" data-startTime="340">You want an error. </span> <span class="line" data-startTime="341">You want to be &mdash; </span><span class="line" data-startTime="341">hey, man, string </span><span class="line" data-startTime="342">does not have an instance </span><span class="line" data-startTime="342">method greater than. </span> <span class="line" data-startTime="344">You get told at runtime exactly </span><span class="line" data-startTime="344">where the problem happened. </span> <span class="line" data-startTime="347">Much more logical </span><span class="line" data-startTime="347">programming experience. </span> <span class="line" data-startTime="350">Variable scope. </span> <span class="line" data-startTime="351">This one's a little bit </span><span class="line" data-startTime="351">longer, so take a look at this. </span> <span class="line" data-startTime="353">We have a main function. </span> <span class="line" data-startTime="354">if(true), there's foo, </span><span class="line" data-startTime="354">and then print(foo), </span><span class="line" data-startTime="356">but there's also </span><span class="line" data-startTime="356">a top level foo. </span></p>

<p><span class="line" data-startTime="358">So the question I have for </span><span class="line" data-startTime="358">you is &mdash; when I run this, </span><span class="line" data-startTime="360">what will it print? </span></p>

<p class="speaker"><span class="line" data-starttime="363"><span class="speakerName">Kasper Lund</span>: Any takers? </span></p>

<p class="speaker"><span class="line" data-starttime="364"><span class="speakerName">Seth Ladd</span>: It's 50/50 chance. </span> <span class="line" data-startTime="367">Top top-level. </span> <span class="line" data-startTime="367">Right. </span> <span class="line" data-startTime="368">This prints top-level in </span><span class="line" data-startTime="368">Dart, no variable hoisting. </span> <span class="line" data-startTime="371">It's a totally logical </span><span class="line" data-startTime="371">lexical scope &mdash; lexical </span><span class="line" data-startTime="374">analysis &mdash; of what's going on. </span> <span class="line" data-startTime="375">If you hand most </span><span class="line" data-startTime="375">developers this code, </span><span class="line" data-startTime="377">they'll be able to understand </span><span class="line" data-startTime="377">what's going on here. </span> <span class="line" data-startTime="380">Speaking of lexical </span><span class="line" data-startTime="380">scope, even this </span><span class="line" data-startTime="383">is lexically scoped in Dart. </span> <span class="line" data-startTime="384">This is one of the things that </span><span class="line" data-startTime="384">totally tripped me up earlier. </span> <span class="line" data-startTime="386">Here's a class AwesomeButton. </span> <span class="line" data-startTime="388">And in its constructor you </span><span class="line" data-startTime="388">set up a Click Handler. </span></p>

<p><span class="line" data-startTime="391">And when the button is clicked, </span><span class="line" data-startTime="391">call this.atomicDinosaurRock. </span> <span class="line" data-startTime="393">Well, what is this </span><span class="line" data-startTime="393">at this point? </span><span class="line" data-startTime="395">The lexically </span><span class="line" data-startTime="395">scoped this that is </span><span class="line" data-startTime="397">an instance of AwesomeButton. </span> <span class="line" data-startTime="398">You give most people this </span><span class="line" data-startTime="398">code and they will tell you </span><span class="line" data-startTime="400">what method this is calling </span><span class="line" data-startTime="400">on, which is, I think, </span><span class="line" data-startTime="403">a pretty big improvement. </span> <span class="line" data-startTime="406">So that's a little </span><span class="line" data-startTime="406">bit on the semantics, </span><span class="line" data-startTime="408">and a little bit on the syntax. </span> <span class="line" data-startTime="410">But Dart is also </span><span class="line" data-startTime="410">designed to scale </span><span class="line" data-startTime="412">from just a couple </span><span class="line" data-startTime="412">lines of code. </span> <span class="line" data-startTime="413">You could certainly write </span><span class="line" data-startTime="413">a ten line Dart script </span><span class="line" data-startTime="415">and have it look very scripty. </span></p>

<p><span class="line" data-startTime="416">But you can scale all way up </span><span class="line" data-startTime="416">to millions of lines of code. </span> <span class="line" data-startTime="420">Now we saw functions. </span> <span class="line" data-startTime="421">We saw classes. </span> <span class="line" data-startTime="422">We have mixins. </span> <span class="line" data-startTime="423">We have interfaces. </span> <span class="line" data-startTime="424">I want to talk about libraries, </span><span class="line" data-startTime="424">which is a nice piece </span><span class="line" data-startTime="426">to help you </span><span class="line" data-startTime="426">modularize your code. </span> <span class="line" data-startTime="428">Dart libraries </span><span class="line" data-startTime="428">are very flexible. </span> <span class="line" data-startTime="429">You simply define a </span><span class="line" data-startTime="429">file as a library. </span> <span class="line" data-startTime="431">You can import libraries </span><span class="line" data-startTime="431">from the core SDK. </span> <span class="line" data-startTime="433">You can import libraries from </span><span class="line" data-startTime="433">other people, or other files. </span> <span class="line" data-startTime="436">And then you can define any </span><span class="line" data-startTime="436">number of top level constructs </span><span class="line" data-startTime="439">in a library. </span> <span class="line" data-startTime="440">So no more one public </span><span class="line" data-startTime="440">class per file thing, </span><span class="line" data-startTime="442">if you come from Java. </span> <span class="line" data-startTime="443">So in this case, two classes </span><span class="line" data-startTime="443">and even a top level function. </span> <span class="line" data-startTime="446">In Dart, you don't have to </span><span class="line" data-startTime="446">wrap everything in a class </span><span class="line" data-startTime="448">if you don't want to. </span></p>

<p><span class="line" data-startTime="449">So nice, scalable </span><span class="line" data-startTime="449">structure for you to grow. </span> <span class="line" data-startTime="453">Hopefully, you </span><span class="line" data-startTime="453">guys saw that this </span><span class="line" data-startTime="455">is a language you can </span><span class="line" data-startTime="455">start using right away. </span> <span class="line" data-startTime="457">But of course, we use </span><span class="line" data-startTime="457">Dart to get onto the web. </span> <span class="line" data-startTime="460">And to get on the web, you have </span><span class="line" data-startTime="460">to compile Dart to JavaScript. </span> <span class="line" data-startTime="462">And to do that and to </span><span class="line" data-startTime="462">show you how it works, </span><span class="line" data-startTime="465">I'll turn it over to Kasper </span><span class="line" data-startTime="465">to tell you all about dart2js. </span></p>

<p class="speaker"><span class="line" data-starttime="467"><span class="speakerName">Kasper Lund</span>: Thank you Seth. </span> <span class="line" data-startTime="468">So finally, now I </span><span class="line" data-startTime="468">can say something. </span> <span class="line" data-startTime="470">It's wonderful. </span> <span class="line" data-startTime="471">I'm going to tell you </span><span class="line" data-startTime="471">a little bit about how </span><span class="line" data-startTime="473">we compile to </span><span class="line" data-startTime="473">efficient JavaScript. </span> <span class="line" data-startTime="475">And it's very, very </span><span class="line" data-startTime="475">important to us to make sure </span><span class="line" data-startTime="478">that Dart runs really well </span><span class="line" data-startTime="478">on all modern browsers, </span><span class="line" data-startTime="480">so we put a lot of </span><span class="line" data-startTime="480">effort into that area. </span> <span class="line" data-startTime="483">Our goals are fairly simple. </span> <span class="line" data-startTime="485">We want to generate small code, </span><span class="line" data-startTime="485">we want to generate fast code, </span><span class="line" data-startTime="487">and we want to make </span><span class="line" data-startTime="487">sure that we retain </span><span class="line" data-startTime="489">the nice, clean proper Dart </span><span class="line" data-startTime="489">semantics while doing so. </span> <span class="line" data-startTime="493">So simple goals is a </span><span class="line" data-startTime="493">good starting point. </span> <span class="line" data-startTime="496">But to do this, and </span><span class="line" data-startTime="496">to do it efficiently, </span><span class="line" data-startTime="498">we need a real </span><span class="line" data-startTime="498">optimizing compiler, </span><span class="line" data-startTime="500">something that </span><span class="line" data-startTime="500">doesn't just do a one </span><span class="line" data-startTime="502">to one translation </span><span class="line" data-startTime="502">in a simple way. </span></p>

<p><span class="line" data-startTime="504">We actually need a lot of </span><span class="line" data-startTime="504">the neat, modern compiling </span><span class="line" data-startTime="507">techniques we've learned </span><span class="line" data-startTime="507">to love from other more </span><span class="line" data-startTime="511">involved projects, like V8. </span> <span class="line" data-startTime="513">So we need function inlining. </span> <span class="line" data-startTime="515">We need loop-invariant </span><span class="line" data-startTime="515">code motion. </span> <span class="line" data-startTime="517">We need global value numbering. </span> <span class="line" data-startTime="518">We need a lot of these </span><span class="line" data-startTime="518">things &mdash; type propagation, </span><span class="line" data-startTime="520">redundant lode elimination, </span><span class="line" data-startTime="520">dead code elimination, </span><span class="line" data-startTime="523">and much, much more. </span> <span class="line" data-startTime="524">So we need a lot of </span><span class="line" data-startTime="524">things in this compiler. </span> <span class="line" data-startTime="525">We want to do a good job </span><span class="line" data-startTime="525">in optimizing your code, </span><span class="line" data-startTime="528">so you don't have </span><span class="line" data-startTime="528">to worry about it. </span> <span class="line" data-startTime="530">So let's take a look at a </span><span class="line" data-startTime="530">very simple Dart method, just </span><span class="line" data-startTime="532">to give you an impression </span><span class="line" data-startTime="532">of what we actually </span><span class="line" data-startTime="534">translate the code to. </span> <span class="line" data-startTime="536">Here's a main method that </span><span class="line" data-startTime="536">allocates a few points, </span><span class="line" data-startTime="538">and then we compute the </span><span class="line" data-startTime="538">distance between these points. </span></p>

<p><span class="line" data-startTime="540">Very simple code. </span> <span class="line" data-startTime="541">Luckily, a simple </span><span class="line" data-startTime="541">Dart method actually </span><span class="line" data-startTime="543">compiles to relatively </span><span class="line" data-startTime="543">simple JavaScript too. </span> <span class="line" data-startTime="545">So you will allocate </span><span class="line" data-startTime="545">points the same way </span><span class="line" data-startTime="548">as you would expect it to. </span> <span class="line" data-startTime="549">The only real difference </span><span class="line" data-startTime="549">here is that when </span><span class="line" data-startTime="551">you call the distanceTo </span><span class="line" data-startTime="551">method, we actually </span><span class="line" data-startTime="553">encode the arity, the </span><span class="line" data-startTime="553">number of parameters passed, </span><span class="line" data-startTime="557">in the method name. </span> <span class="line" data-startTime="558">Now why do we do that? </span><span class="line" data-startTime="559">The reason why we do that is </span><span class="line" data-startTime="559">because in JavaScript, we're </span><span class="line" data-startTime="561">allowed to pass any </span><span class="line" data-startTime="561">number of arguments. </span> <span class="line" data-startTime="563">Too few or too many, it </span><span class="line" data-startTime="563">doesn't really matter. </span> <span class="line" data-startTime="566">But usually it leads to </span><span class="line" data-startTime="566">weird and surprising behavior </span><span class="line" data-startTime="569">at runtime if you </span><span class="line" data-startTime="569">do that, so we want </span><span class="line" data-startTime="570">to be a little bit </span><span class="line" data-startTime="570">stricter there. </span> <span class="line" data-startTime="572">So to live by Dart's proper </span><span class="line" data-startTime="572">semantics rules there, </span><span class="line" data-startTime="575">we actually have to </span><span class="line" data-startTime="575">check that you're </span><span class="line" data-startTime="576">calling with the right </span><span class="line" data-startTime="576">number of parameters. </span></p>

<p><span class="line" data-startTime="578">And the fastest </span><span class="line" data-startTime="578">way of doing that </span><span class="line" data-startTime="579">is just encoding it </span><span class="line" data-startTime="579">in the method name. </span> <span class="line" data-startTime="581">If you call with </span><span class="line" data-startTime="581">too many parameters, </span><span class="line" data-startTime="582">you'll get an error that </span><span class="line" data-startTime="582">that method doesn't exist. </span> <span class="line" data-startTime="586">So when you have </span><span class="line" data-startTime="586">large applications, </span><span class="line" data-startTime="589">you need some sort </span><span class="line" data-startTime="589">of tool to make sure </span><span class="line" data-startTime="591">that you're not </span><span class="line" data-startTime="591">actually shipping </span><span class="line" data-startTime="592">too much code to your clients. </span> <span class="line" data-startTime="594">In particular, in </span><span class="line" data-startTime="594">the set up where </span><span class="line" data-startTime="595">you have a nice, rich </span><span class="line" data-startTime="595">set of core libraries </span><span class="line" data-startTime="597">and a nice set of third party </span><span class="line" data-startTime="597">libraries you can include, </span><span class="line" data-startTime="599">you want to make </span><span class="line" data-startTime="599">sure that whatever </span><span class="line" data-startTime="601">you ship to your clients </span><span class="line" data-startTime="601">is only the needed </span><span class="line" data-startTime="602">bits, not all the other stuff. </span></p>

<p><span class="line" data-startTime="604">To do that, we have </span><span class="line" data-startTime="604">an implementation </span><span class="line" data-startTime="606">of an algorithm called tree </span><span class="line" data-startTime="606">shaking in the compiler. </span> <span class="line" data-startTime="609">It works a little </span><span class="line" data-startTime="609">something like this. </span> <span class="line" data-startTime="611">If you have an application that </span><span class="line" data-startTime="611">has a main method, and perhaps </span><span class="line" data-startTime="614">a few other methods </span><span class="line" data-startTime="614">close by, foo and baz, </span><span class="line" data-startTime="617">but it's only calling </span><span class="line" data-startTime="617">the foo method, </span><span class="line" data-startTime="620">and maybe the foo </span><span class="line" data-startTime="620">method in return </span><span class="line" data-startTime="621">calls code pulled in </span><span class="line" data-startTime="621">from another library &mdash; </span><span class="line" data-startTime="624">the bar method </span><span class="line" data-startTime="624">down on the right &mdash; </span><span class="line" data-startTime="626">the library may actually have </span><span class="line" data-startTime="626">unused parts too like the boo </span><span class="line" data-startTime="629">function here &mdash; we want </span><span class="line" data-startTime="629">the dart2js compiler </span><span class="line" data-startTime="632">to actually take </span><span class="line" data-startTime="632">this set of methods </span><span class="line" data-startTime="637">like the transitive </span><span class="line" data-startTime="637">closure of everything </span><span class="line" data-startTime="639">that you have available to </span><span class="line" data-startTime="639">you, and shake it really good </span><span class="line" data-startTime="641">and get all this stuff </span><span class="line" data-startTime="641">that you're actually </span><span class="line" data-startTime="643">not using out of the system. </span></p>

<p><span class="line" data-startTime="644">It's a process </span><span class="line" data-startTime="644">called tree shaking. </span> <span class="line" data-startTime="646">We do that and the </span><span class="line" data-startTime="646">result is a lot smaller. </span> <span class="line" data-startTime="649">It only contains main, foo, </span><span class="line" data-startTime="649">and bar, the needed parts. </span> <span class="line" data-startTime="652">So to implement this </span><span class="line" data-startTime="652">in the compiler, </span><span class="line" data-startTime="654">we actually go </span><span class="line" data-startTime="654">through a few steps. </span> <span class="line" data-startTime="656">First we read all </span><span class="line" data-startTime="656">your Dart sources. </span> <span class="line" data-startTime="658">We don't actually </span><span class="line" data-startTime="658">parse them fully. </span> <span class="line" data-startTime="661">We don't look into </span><span class="line" data-startTime="661">all the methods. </span></p>

<p><span class="line" data-startTime="662">We just look at the </span><span class="line" data-startTime="662">structure of your code, </span><span class="line" data-startTime="664">find all the imports, </span><span class="line" data-startTime="664">look at the libraries </span><span class="line" data-startTime="666">that you depend on, </span><span class="line" data-startTime="666">and read those in too. </span> <span class="line" data-startTime="669">When we have everything </span><span class="line" data-startTime="669">read in that way, </span><span class="line" data-startTime="671">and we know the </span><span class="line" data-startTime="671">structure of your code, </span><span class="line" data-startTime="672">we can actually start doing this </span><span class="line" data-startTime="672">first level of tree shaking. </span> <span class="line" data-startTime="677">We have two levels. </span> <span class="line" data-startTime="678">This is the first </span><span class="line" data-startTime="678">one, and this actually </span><span class="line" data-startTime="680">is what we call the </span><span class="line" data-startTime="680">resolution tree shaking. </span> <span class="line" data-startTime="682">And resolution is the process </span><span class="line" data-startTime="682">of not really compiling </span><span class="line" data-startTime="685">code, but just trying to figure </span><span class="line" data-startTime="685">out what you're referring to </span><span class="line" data-startTime="687">at certain points in the code. </span></p>

<p><span class="line" data-startTime="689">So it actually starts by </span><span class="line" data-startTime="689">looking at the main function, </span><span class="line" data-startTime="691">and look at what kind of classes </span><span class="line" data-startTime="691">or instances of which classes </span><span class="line" data-startTime="694">you allocate in there, and which </span><span class="line" data-startTime="694">other methods you're calling. </span> <span class="line" data-startTime="696">All those methods need </span><span class="line" data-startTime="696">to go into a queue </span><span class="line" data-startTime="698">so we can process them, parse </span><span class="line" data-startTime="698">them, get them resolved. </span> <span class="line" data-startTime="701">And you just keep doing that </span><span class="line" data-startTime="701">until nothing new is added </span><span class="line" data-startTime="703">to the queue, and </span><span class="line" data-startTime="703">then you're done. </span> <span class="line" data-startTime="705">It's relatively </span><span class="line" data-startTime="705">simple to do this, </span><span class="line" data-startTime="707">and it gives us a </span><span class="line" data-startTime="707">good approximation </span><span class="line" data-startTime="708">of cutting down everything, </span><span class="line" data-startTime="708">but only based on method names. </span> <span class="line" data-startTime="712">We can do a little bit better. </span> <span class="line" data-startTime="713">So once we're done </span><span class="line" data-startTime="713">with that, we actually </span><span class="line" data-startTime="715">start the process all over </span><span class="line" data-startTime="715">again in the compilation queue. </span> <span class="line" data-startTime="717">And this is where </span><span class="line" data-startTime="717">we actually will </span><span class="line" data-startTime="719">start looking at what you </span><span class="line" data-startTime="719">really put inside your methods, </span><span class="line" data-startTime="723">and do data-flow </span><span class="line" data-startTime="723">analysis, and we </span><span class="line" data-startTime="725">will track how types </span><span class="line" data-startTime="725">flow through that code. </span></p>

<p><span class="line" data-startTime="727">And that gives us </span><span class="line" data-startTime="727">more information </span><span class="line" data-startTime="728">about what you're </span><span class="line" data-startTime="728">actually needing to emit. </span> <span class="line" data-startTime="731">And we do the last level of </span><span class="line" data-startTime="731">the tree shaking at that point. </span> <span class="line" data-startTime="734">The end result is that we do a </span><span class="line" data-startTime="734">really good job of making sure </span><span class="line" data-startTime="737">that things that you </span><span class="line" data-startTime="737">really don't need </span><span class="line" data-startTime="738">are not pulled into </span><span class="line" data-startTime="738">your application. </span> <span class="line" data-startTime="741">Finally, we actually emit </span><span class="line" data-startTime="741">the code to a single JS file. </span> <span class="line" data-startTime="745">So you can run it </span><span class="line" data-startTime="745">in your browser. </span> <span class="line" data-startTime="746">Fairly simple stuff. </span></p>

<p class="speaker"><span class="line" data-starttime="747"><span class="speakerName">Seth Ladd</span>: I love this because </span><span class="line" data-startTime="747">this is the tools helping me. </span><span class="line" data-startTime="749">I don't need to be </span><span class="line" data-startTime="749">crafting my application. </span><span class="line" data-startTime="751">I just let the tool analyze </span><span class="line" data-startTime="751">my program, take care of it. </span></p>

<p class="speaker"><span class="line" data-starttime="754"><span class="speakerName">Kasper Lund</span>: That's </span><span class="line" data-startTime="754">the way it should be. </span> <span class="line" data-startTime="755">So let's take a look at how </span><span class="line" data-startTime="755">this actually works in practice. </span> <span class="line" data-startTime="759">Just to give you a feel for </span><span class="line" data-startTime="759">how dart2js does its magic, </span><span class="line" data-startTime="762">I'm going to dive into </span><span class="line" data-startTime="762">a well-known algorithm. </span> <span class="line" data-startTime="766">It's a constraint </span><span class="line" data-startTime="766">solving algorithm. </span> <span class="line" data-startTime="768">The reason why I'm </span><span class="line" data-startTime="768">choosing this one </span><span class="line" data-startTime="769">is it's a well </span><span class="line" data-startTime="769">understood piece of code. </span> <span class="line" data-startTime="773">It's been used to benchmark </span><span class="line" data-startTime="773">lots of different language </span><span class="line" data-startTime="775">limitations over the years. </span> <span class="line" data-startTime="777">It's actually part of </span><span class="line" data-startTime="777">the Octane benchmark </span><span class="line" data-startTime="779">Linus mentioned this morning. </span> <span class="line" data-startTime="781">So it's a well-known </span><span class="line" data-startTime="781">piece of code. </span></p>

<p><span class="line" data-startTime="782">It is structured. </span> <span class="line" data-startTime="783">It has inheritance, and </span><span class="line" data-startTime="783">classes, and everything </span><span class="line" data-startTime="787">we need to actually do a </span><span class="line" data-startTime="787">good job in making your code </span><span class="line" data-startTime="789">run fast. </span> <span class="line" data-startTime="790">So let's take a look at it. </span> <span class="line" data-startTime="791">DeltaBlue is a </span><span class="line" data-startTime="791">constraint solver. </span> <span class="line" data-startTime="793">What does that mean? </span><span class="line" data-startTime="794">Well, basically, it's </span><span class="line" data-startTime="794">a fairly abstract thing </span><span class="line" data-startTime="796">that works on </span><span class="line" data-startTime="796">constraints on variables. </span> <span class="line" data-startTime="800">Constraints can be </span><span class="line" data-startTime="800">one way or two way. </span> <span class="line" data-startTime="803">There are binary or unary </span><span class="line" data-startTime="803">constraints of different kinds. </span> <span class="line" data-startTime="806">And they can be used </span><span class="line" data-startTime="806">to, for instance, </span><span class="line" data-startTime="808">model the constraints </span><span class="line" data-startTime="808">involving laying out something </span><span class="line" data-startTime="811">on your screen. </span></p>

<p><span class="line" data-startTime="811">I'm pretty sure that some of </span><span class="line" data-startTime="811">the things you just heard about </span><span class="line" data-startTime="814">from Eric actually use </span><span class="line" data-startTime="814">this constraint to think </span><span class="line" data-startTime="816">of that internally </span><span class="line" data-startTime="816">when building layouts. </span> <span class="line" data-startTime="818">So doesn't lose an </span><span class="line" data-startTime="818">implementation of such a beast. </span> <span class="line" data-startTime="821">It uses constraints and there's </span><span class="line" data-startTime="821">a nice hierarchy of them </span><span class="line" data-startTime="823">with unary and binary </span><span class="line" data-startTime="823">constraints and variables. </span> <span class="line" data-startTime="826">Let me show you a piece </span><span class="line" data-startTime="826">of code from this thing, </span><span class="line" data-startTime="829">to make it a little </span><span class="line" data-startTime="829">bit more concrete. </span> <span class="line" data-startTime="831">This is a function from </span><span class="line" data-startTime="831">the DeltaBlue algorithm. </span> <span class="line" data-startTime="834">It's fairly simple. </span> <span class="line" data-startTime="835">You don't have to understand </span><span class="line" data-startTime="835">all the details here, but just </span><span class="line" data-startTime="838">note that the way it works here </span><span class="line" data-startTime="838">is that you take a variable v, </span><span class="line" data-startTime="842">and you try to figure out all </span><span class="line" data-startTime="842">the constraints that actually </span><span class="line" data-startTime="844">consume that </span><span class="line" data-startTime="844">variable, and put them </span><span class="line" data-startTime="847">in a list that is also </span><span class="line" data-startTime="847">passed in as a parameter. </span> <span class="line" data-startTime="850">Hopefully this code is </span><span class="line" data-startTime="850">reasonably readable to you. </span></p>

<p><span class="line" data-startTime="853">It's Dart code and to me </span><span class="line" data-startTime="853">this looks like what I &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="856"><span class="speakerName">Seth Ladd</span>: Kind of </span><span class="line" data-startTime="856">representative of code a lot </span><span class="line" data-startTime="858">of us would write. </span></p>

<p class="speaker"><span class="line" data-starttime="858"><span class="speakerName">Kasper Lund</span>: Yeah. </span><span class="line" data-startTime="859">So in Dart, we have an </span><span class="line" data-startTime="859">optional aesthetic type system. </span><span class="line" data-startTime="862">So you do not have to write </span><span class="line" data-startTime="862">the types if you really </span><span class="line" data-startTime="864">don't want to. </span><span class="line" data-startTime="865">Sometimes it's nice to </span><span class="line" data-startTime="865">have the document what </span><span class="line" data-startTime="867">a parameter means, which </span><span class="line" data-startTime="867">is why I've done it here. </span><span class="line" data-startTime="870">But it's important to </span><span class="line" data-startTime="870">us to make it clear </span><span class="line" data-startTime="872">that the types that you put </span><span class="line" data-startTime="872">in are not actually used </span><span class="line" data-startTime="876">for up optimization purposes, </span><span class="line" data-startTime="876">because we don't really </span><span class="line" data-startTime="878">know if you want </span><span class="line" data-startTime="878">to type them in. </span><span class="line" data-startTime="880">So we don't want to force you </span><span class="line" data-startTime="880">into typing them in the places </span><span class="line" data-startTime="883">where you don't want to. </span><span class="line" data-startTime="884">So I can go ahead </span><span class="line" data-startTime="884">and remove them. </span></p>

<p class="speaker"><span class="line" data-starttime="886"><span class="speakerName">Seth Ladd</span>: And they </span><span class="line" data-startTime="886">might also be incorrect. </span></p>

<p class="speaker"><span class="line" data-starttime="887"><span class="speakerName">Kasper Lund</span>: They </span><span class="line" data-startTime="887">could be incorrect. </span> <span class="line" data-startTime="889">Anyway, I've gone ahead </span><span class="line" data-startTime="889">and removed the types. </span> <span class="line" data-startTime="891">The semantics of this </span><span class="line" data-startTime="891">algorithm is exactly the same, </span><span class="line" data-startTime="894">no differences at all. </span> <span class="line" data-startTime="895">It's just a little bit shorter, </span><span class="line" data-startTime="895">and maybe a little bit harder </span><span class="line" data-startTime="897">to understand. </span> <span class="line" data-startTime="898">But anyway, the code is </span><span class="line" data-startTime="898">there, it's the same thing, </span><span class="line" data-startTime="900">and this is what we're </span><span class="line" data-startTime="900">going to try to optimize. </span> <span class="line" data-startTime="903">So first attempt at </span><span class="line" data-startTime="903">actually compiling this code </span><span class="line" data-startTime="906">to JavaScript is somewhat large. </span> <span class="line" data-startTime="909">So this is the </span><span class="line" data-startTime="909">unoptimized version </span><span class="line" data-startTime="911">of the method you just saw. </span> <span class="line" data-startTime="913">It compiled to 500 and </span><span class="line" data-startTime="913">something characters. </span></p>

<p><span class="line" data-startTime="917">It's a little bit too long. </span> <span class="line" data-startTime="918">I'm not even sure you can read </span><span class="line" data-startTime="918">it in the back of the hall </span><span class="line" data-startTime="922">here. </span> <span class="line" data-startTime="922">But it works. </span> <span class="line" data-startTime="924">It has the right semantics. </span> <span class="line" data-startTime="925">Everything works as specified. </span> <span class="line" data-startTime="927">And it runs reasonably well. </span> <span class="line" data-startTime="930">But it's &mdash; I hope you agree &mdash; </span><span class="line" data-startTime="930">it's simply not good enough. </span> <span class="line" data-startTime="933">We want to do a lot better. </span> <span class="line" data-startTime="934">So let's try to dive into </span><span class="line" data-startTime="934">how we actually do better </span><span class="line" data-startTime="937">than just this blob of code. </span> <span class="line" data-startTime="939">Even though the semantics </span><span class="line" data-startTime="939">is really important to us, </span><span class="line" data-startTime="941">we also really care </span><span class="line" data-startTime="941">about performance. </span> <span class="line" data-startTime="944">So what makes this big? </span><span class="line" data-startTime="946">Well, this is just </span><span class="line" data-startTime="946">one of the examples </span><span class="line" data-startTime="949">of why this code is little bit </span><span class="line" data-startTime="949">bigger than what we'd like. </span> <span class="line" data-startTime="951">So as Seth mentioned, </span><span class="line" data-startTime="951">we have strict semantics </span><span class="line" data-startTime="954">about what you can compare </span><span class="line" data-startTime="954">to numbers, for instance. </span></p>

<p><span class="line" data-startTime="956">So we don't want to run </span><span class="line" data-startTime="956">into issues when you end up </span><span class="line" data-startTime="959">emitting JavaScript code that </span><span class="line" data-startTime="959">just ends up comparing numbers </span><span class="line" data-startTime="962">and strengths for instance, </span><span class="line" data-startTime="962">because we don't really </span><span class="line" data-startTime="964">want to rely on that behavior. </span> <span class="line" data-startTime="966">So in this case </span><span class="line" data-startTime="966">we're reading &mdash; see </span><span class="line" data-startTime="968">if I can get this to </span><span class="line" data-startTime="968">progress, there we </span><span class="line" data-startTime="970">go &mdash; so we're reading the length </span><span class="line" data-startTime="970">of something that probably </span><span class="line" data-startTime="973">is an array, but </span><span class="line" data-startTime="973">we're not quite sure. </span> <span class="line" data-startTime="975">So we don't know that the </span><span class="line" data-startTime="975">length is actually a number. </span> <span class="line" data-startTime="977">So before we continue </span><span class="line" data-startTime="977">to actually compare </span><span class="line" data-startTime="980">this length against </span><span class="line" data-startTime="980">a real number, </span><span class="line" data-startTime="982">we have to make sure that </span><span class="line" data-startTime="982">it actually is a number. </span> <span class="line" data-startTime="985">So we insert an explicit </span><span class="line" data-startTime="985">check in the code that </span><span class="line" data-startTime="989">makes sure that we don't end </span><span class="line" data-startTime="989">up relying on this somewhat </span><span class="line" data-startTime="992">surprising behavior </span><span class="line" data-startTime="992">of JavaScript, </span><span class="line" data-startTime="994">where you can compare </span><span class="line" data-startTime="994">numbers against strengths </span><span class="line" data-startTime="996">and get some result out. </span> <span class="line" data-startTime="997">So this adds code &mdash; more checks. </span> <span class="line" data-startTime="1000">So our challenge </span><span class="line" data-startTime="1000">is fairly simple. </span></p>

<p><span class="line" data-startTime="1002">We want to have clean semantics, </span><span class="line" data-startTime="1002">unsurprising behavior, </span><span class="line" data-startTime="1005">but we do not really </span><span class="line" data-startTime="1005">want those extra checks </span><span class="line" data-startTime="1007">when we're compiling </span><span class="line" data-startTime="1007">to JavaScript. </span> <span class="line" data-startTime="1008">So how can we go </span><span class="line" data-startTime="1008">about doing that? </span><span class="line" data-startTime="1011">The trick is right behind </span><span class="line" data-startTime="1011">me &mdash; global optimizations. </span> <span class="line" data-startTime="1014">So we really need </span><span class="line" data-startTime="1014">to do better, and we </span><span class="line" data-startTime="1018">need to do more aggressive </span><span class="line" data-startTime="1018">optimizations in the code </span><span class="line" data-startTime="1020">to make it end up being </span><span class="line" data-startTime="1020">very fast and very good. </span> <span class="line" data-startTime="1023">So let's look at that. </span> <span class="line" data-startTime="1025">First up &mdash; Dart is structured. </span> <span class="line" data-startTime="1028">It has classes. </span> <span class="line" data-startTime="1029">It has methods. </span></p>

<p><span class="line" data-startTime="1030">It has a good structure. </span> <span class="line" data-startTime="1031">We can actually do </span><span class="line" data-startTime="1031">whole program analysis. </span> <span class="line" data-startTime="1034">So when we compile </span><span class="line" data-startTime="1034">the program, we </span><span class="line" data-startTime="1035">can look at every </span><span class="line" data-startTime="1035">single bit in it, </span><span class="line" data-startTime="1037">and we can actually </span><span class="line" data-startTime="1037">understand what's going on. </span> <span class="line" data-startTime="1039">That's a huge win for us. </span> <span class="line" data-startTime="1040">This allows us to actually </span><span class="line" data-startTime="1040">do code navigation </span><span class="line" data-startTime="1042">and great refactoring tools. </span> <span class="line" data-startTime="1044">But maybe even more </span><span class="line" data-startTime="1044">dear to my heart </span><span class="line" data-startTime="1047">is that we can also do a global </span><span class="line" data-startTime="1047">compile-time optimizations. </span> <span class="line" data-startTime="1050">So we can actually </span><span class="line" data-startTime="1050">analyze your code, </span><span class="line" data-startTime="1051">understand the dependencies </span><span class="line" data-startTime="1051">between things, </span><span class="line" data-startTime="1053">maybe, to a certain extent, </span><span class="line" data-startTime="1053">better than what you actually </span><span class="line" data-startTime="1056">care to do yourself, </span><span class="line" data-startTime="1056">as a developer. </span> <span class="line" data-startTime="1058">And then we can </span><span class="line" data-startTime="1058">optimize based on that. </span> <span class="line" data-startTime="1060">It's pretty powerful. </span></p>

<p><span class="line" data-startTime="1061">One of things that we </span><span class="line" data-startTime="1061">do, and one of the things </span><span class="line" data-startTime="1063">that really work well for </span><span class="line" data-startTime="1063">something like DeltaBlue </span><span class="line" data-startTime="1065">and for most </span><span class="line" data-startTime="1065">applications in general, </span><span class="line" data-startTime="1067">is that we infer types. </span> <span class="line" data-startTime="1069">We compute what </span><span class="line" data-startTime="1069">types we actually </span><span class="line" data-startTime="1070">will see at runtime at </span><span class="line" data-startTime="1070">different points in the code. </span> <span class="line" data-startTime="1074">And the way that </span><span class="line" data-startTime="1074">works is &mdash; Here's </span><span class="line" data-startTime="1076">a simple example </span><span class="line" data-startTime="1076">of how that works. </span> <span class="line" data-startTime="1078">Main function calls </span><span class="line" data-startTime="1078">foo, that calls bar, </span><span class="line" data-startTime="1081">that calls foo again, basically. </span> <span class="line" data-startTime="1082">So a bunch of functions </span><span class="line" data-startTime="1082">calling each other. </span> <span class="line" data-startTime="1084">So how do we infer types for </span><span class="line" data-startTime="1084">the parameters of these things? </span><span class="line" data-startTime="1087">How do we get the </span><span class="line" data-startTime="1087">compiler more information? </span><span class="line" data-startTime="1088">Well, we start by </span><span class="line" data-startTime="1088">looking at main. </span> <span class="line" data-startTime="1090">So it's very simple. </span></p>

<p><span class="line" data-startTime="1092">And by analyzing main we </span><span class="line" data-startTime="1092">can see that foo is actually </span><span class="line" data-startTime="1094">called with an </span><span class="line" data-startTime="1094">integer parameter. </span> <span class="line" data-startTime="1095">OK, so far, so good. </span> <span class="line" data-startTime="1097">So we analyze foo, </span><span class="line" data-startTime="1097">under the assumption </span><span class="line" data-startTime="1099">that this called the </span><span class="line" data-startTime="1099">integer parameter. </span> <span class="line" data-startTime="1100">Do we learn something from that? </span><span class="line" data-startTime="1101">Sure. </span> <span class="line" data-startTime="1102">Bar is apparently also called </span><span class="line" data-startTime="1102">with an integer parameter. </span> <span class="line" data-startTime="1104">So far, so good. </span> <span class="line" data-startTime="1105">We can finish this </span><span class="line" data-startTime="1105">game a little bit. </span> <span class="line" data-startTime="1106">So we end up in bar. </span> <span class="line" data-startTime="1108">And we realize that if bar </span><span class="line" data-startTime="1108">is called with an integer </span><span class="line" data-startTime="1111">parameter, then it </span><span class="line" data-startTime="1111">ends up calling foo </span><span class="line" data-startTime="1113">with a string </span><span class="line" data-startTime="1113">interpolated version </span><span class="line" data-startTime="1114">of that parameter, </span><span class="line" data-startTime="1114">which is a string. </span> <span class="line" data-startTime="1117">So foo is now </span><span class="line" data-startTime="1117">called with a string </span><span class="line" data-startTime="1118">too, so we have to </span><span class="line" data-startTime="1118">go back and iterate. </span></p>

<p><span class="line" data-startTime="1121">So foo is now apparently </span><span class="line" data-startTime="1121">also called with a string. </span> <span class="line" data-startTime="1123">That means bar is called </span><span class="line" data-startTime="1123">with a string too. </span> <span class="line" data-startTime="1125">And finally, inside </span><span class="line" data-startTime="1125">the bar method, </span><span class="line" data-startTime="1127">we realize that that means that </span><span class="line" data-startTime="1127">print is called with a string. </span> <span class="line" data-startTime="1130">So far so good. </span> <span class="line" data-startTime="1131">All in all, the </span><span class="line" data-startTime="1131">compiler can actually </span><span class="line" data-startTime="1133">conclude that x and y are both </span><span class="line" data-startTime="1133">either integers or strings. </span> <span class="line" data-startTime="1138">This is a very, </span><span class="line" data-startTime="1138">very simple example, </span><span class="line" data-startTime="1140">but it actually works really </span><span class="line" data-startTime="1140">well in practice for large apps </span><span class="line" data-startTime="1143">too. </span> <span class="line" data-startTime="1145">So let's look at </span><span class="line" data-startTime="1145">DeltaBlue and see </span><span class="line" data-startTime="1146">how that actually works there. </span></p>

<p><span class="line" data-startTime="1147">It's pretty simple. </span> <span class="line" data-startTime="1148">So there are a </span><span class="line" data-startTime="1148">couple of things here </span><span class="line" data-startTime="1150">we want to infer types for. </span> <span class="line" data-startTime="1151">For instance, the two </span><span class="line" data-startTime="1151">parameters, like v and coll. </span> <span class="line" data-startTime="1155">And the infer actually </span><span class="line" data-startTime="1155">does that by looking </span><span class="line" data-startTime="1157">at all the coll sites that </span><span class="line" data-startTime="1157">call addConstraintsConsumingTo. </span> <span class="line" data-startTime="1160">And we actually learned that v </span><span class="line" data-startTime="1160">is either null or a variable, </span><span class="line" data-startTime="1164">and that coll cannot be null. </span> <span class="line" data-startTime="1166">It always is a JavaScript </span><span class="line" data-startTime="1166">array, containing </span><span class="line" data-startTime="1168">only subclasses of </span><span class="line" data-startTime="1168">the class constraint. </span></p>

<p><span class="line" data-startTime="1171">That's pretty powerful. </span> <span class="line" data-startTime="1172">So that's good to know for us. </span> <span class="line" data-startTime="1175">The rest of the method </span><span class="line" data-startTime="1175">here can also be analyzed, </span><span class="line" data-startTime="1177">and we can learn something about </span><span class="line" data-startTime="1177">all these constructs in there. </span> <span class="line" data-startTime="1180">So we can actually get </span><span class="line" data-startTime="1180">a pretty full picture </span><span class="line" data-startTime="1181">of what the types in here are. </span> <span class="line" data-startTime="1183">So I just listed them here. </span> <span class="line" data-startTime="1185">You don't have to look </span><span class="line" data-startTime="1185">at all the details, </span><span class="line" data-startTime="1186">but this is very good </span><span class="line" data-startTime="1186">information for our compiler </span><span class="line" data-startTime="1188">to have. </span></p>

<p class="speaker"><span class="line" data-starttime="1188"><span class="speakerName">Seth Ladd</span>: And it does this </span><span class="line" data-startTime="1188">without running a program, </span><span class="line" data-startTime="1190">just statically </span><span class="line" data-startTime="1190">looking at the program. </span></p>

<p class="speaker"><span class="line" data-starttime="1192"><span class="speakerName">Kasper Lund</span>: This is global </span><span class="line" data-startTime="1192">analysis at compile time. </span> <span class="line" data-startTime="1195">So let's make this </span><span class="line" data-startTime="1195">play to our advantage. </span> <span class="line" data-startTime="1199">So here's the code </span><span class="line" data-startTime="1199">again without type </span><span class="line" data-startTime="1201">inferencing &mdash; 526 characters. </span> <span class="line" data-startTime="1204">So first thing off, we know v </span><span class="line" data-startTime="1204">is either null or a variable. </span> <span class="line" data-startTime="1207">So we can do a little </span><span class="line" data-startTime="1207">bit better than just </span><span class="line" data-startTime="1209">calling this getter on it. </span> <span class="line" data-startTime="1210">So we can actually </span><span class="line" data-startTime="1210">see that it always </span><span class="line" data-startTime="1212">has a property determined </span><span class="line" data-startTime="1212">by, we just fetch it. </span></p>

<p><span class="line" data-startTime="1214">Simple stuff. </span> <span class="line" data-startTime="1215">There are other </span><span class="line" data-startTime="1215">things that we can </span><span class="line" data-startTime="1217">win even more by recognizing. </span> <span class="line" data-startTime="1218">For instance, v, the </span><span class="line" data-startTime="1218">variable dot constraints. </span> <span class="line" data-startTime="1221">Since v is a variable, </span><span class="line" data-startTime="1221">the constraints in there </span><span class="line" data-startTime="1223">is always an array </span><span class="line" data-startTime="1223">of the constraints. </span> <span class="line" data-startTime="1226">So we don't have to go through </span><span class="line" data-startTime="1226">this calling a lengths getter </span><span class="line" data-startTime="1229">and calling an index operator. </span> <span class="line" data-startTime="1230">We can just do the </span><span class="line" data-startTime="1230">real JavaScript way. </span> <span class="line" data-startTime="1233">Just fetch the length and </span><span class="line" data-startTime="1233">just index into the array. </span> <span class="line" data-startTime="1235">Simple stuff. </span> <span class="line" data-startTime="1237">Even better, we know that </span><span class="line" data-startTime="1237">v.constraints, that length </span><span class="line" data-startTime="1240">is actually an integer. </span> <span class="line" data-startTime="1242">So this whole notion of checking </span><span class="line" data-startTime="1242">whether or not it's a number </span><span class="line" data-startTime="1245">goes away. </span></p>

<p><span class="line" data-startTime="1246">So that is a helpful thing. </span> <span class="line" data-startTime="1248">It's starting to improve. </span> <span class="line" data-startTime="1251">Now the condition that we have </span><span class="line" data-startTime="1251">in the loop is turning simpler. </span> <span class="line" data-startTime="1254">We can change the </span><span class="line" data-startTime="1254">y-limit to a for-loop. </span> <span class="line" data-startTime="1256">And at that point we're </span><span class="line" data-startTime="1256">already down to 33% </span><span class="line" data-startTime="1259">smaller than the original </span><span class="line" data-startTime="1259">code I showed you. </span> <span class="line" data-startTime="1261">We have more to go, but </span><span class="line" data-startTime="1261">it's pretty simple stuff. </span> <span class="line" data-startTime="1264">coll is an array. </span> <span class="line" data-startTime="1265">So this calling add </span><span class="line" data-startTime="1265">on it, in a weird way, </span><span class="line" data-startTime="1268">is not really necessary. </span> <span class="line" data-startTime="1269">So we can just use </span><span class="line" data-startTime="1269">the JavaScript push </span><span class="line" data-startTime="1270">method to do that for you. </span> <span class="line" data-startTime="1272">Looks good. </span> <span class="line" data-startTime="1273">Even further, the t1 is </span><span class="line" data-startTime="1273">initialized in a simple way, </span><span class="line" data-startTime="1277">so that can just move </span><span class="line" data-startTime="1277">into the for-loop. </span> <span class="line" data-startTime="1278">And we're down to 41% smaller </span><span class="line" data-startTime="1278">than the original JS output. </span> <span class="line" data-startTime="1281">We're starting to get there. </span> <span class="line" data-startTime="1284">c is known to be a </span><span class="line" data-startTime="1284">subclasses constraint, </span><span class="line" data-startTime="1285">and it cannot be nulled. </span></p>

<p><span class="line" data-startTime="1286">We've inferred that. </span> <span class="line" data-startTime="1287">So this whole notion of checking </span><span class="line" data-startTime="1287">whether or not c is nulled </span><span class="line" data-startTime="1290">before doing a comparison &mdash; this </span><span class="line" data-startTime="1290">is necessary because of null </span><span class="line" data-startTime="1293">and undefined in </span><span class="line" data-startTime="1293">JavaScript by the way &mdash; </span><span class="line" data-startTime="1295">we don't have to worry about </span><span class="line" data-startTime="1295">that because at least c cannot </span><span class="line" data-startTime="1297">be null. </span> <span class="line" data-startTime="1298">So we can simplify the code. </span> <span class="line" data-startTime="1300">It's a good thing. </span> <span class="line" data-startTime="1301">Finally, we know that calling is </span><span class="line" data-startTime="1301">satisfied on c, actually always </span><span class="line" data-startTime="1305">returns a boolean. </span> <span class="line" data-startTime="1306">And true is the only </span><span class="line" data-startTime="1306">truthy value in Dart, </span><span class="line" data-startTime="1309">so usually we have to compare </span><span class="line" data-startTime="1309">against true before we </span><span class="line" data-startTime="1311">branch on it. </span> <span class="line" data-startTime="1312">But because a boolean is </span><span class="line" data-startTime="1312">always either true or false, </span><span class="line" data-startTime="1315">it's just fine. </span> <span class="line" data-startTime="1316">We can get rid of </span><span class="line" data-startTime="1316">that last thing. </span> <span class="line" data-startTime="1317">And there you have it &mdash; </span><span class="line" data-startTime="1317">an optimized version </span><span class="line" data-startTime="1320">of this method that runs fast. </span> <span class="line" data-startTime="1322">It's much smaller, but it still </span><span class="line" data-startTime="1322">has exactly the same semantics. </span></p>

<p><span class="line" data-startTime="1325">It's just we've proven we didn't </span><span class="line" data-startTime="1325">need some of these checks. </span> <span class="line" data-startTime="1329">So what's that do </span><span class="line" data-startTime="1329">to performance? </span><span class="line" data-startTime="1331">Well, here's the graph </span><span class="line" data-startTime="1331">of that over time. </span> <span class="line" data-startTime="1333">So the top line is </span><span class="line" data-startTime="1333">the native Dart VM </span><span class="line" data-startTime="1336">running the DeltaBlue algorithm. </span> <span class="line" data-startTime="1338">So you see that that's the </span><span class="line" data-startTime="1338">best performance we have. </span> <span class="line" data-startTime="1340">And it really </span><span class="line" data-startTime="1340">comes from the fact </span><span class="line" data-startTime="1342">that Dart is </span><span class="line" data-startTime="1342">designed from the get </span><span class="line" data-startTime="1343">go to be an efficient language. </span> <span class="line" data-startTime="1345">So we have a very good </span><span class="line" data-startTime="1345">implementation of that. </span> <span class="line" data-startTime="1347">The next two lines might be more </span><span class="line" data-startTime="1347">interesting in this context. </span> <span class="line" data-startTime="1349">The yellowish line </span><span class="line" data-startTime="1349">is actually V8 </span><span class="line" data-startTime="1351">running a handwritten version </span><span class="line" data-startTime="1351">of the DeltaBlue benchmark. </span> <span class="line" data-startTime="1354">This is the Octane version </span><span class="line" data-startTime="1354">of the DeltaBlue benchmark </span><span class="line" data-startTime="1356">that you might have </span><span class="line" data-startTime="1356">seen in other places. </span> <span class="line" data-startTime="1359">As you can see, V8 improves </span><span class="line" data-startTime="1359">on that over time, slowly, </span><span class="line" data-startTime="1361">and that's a very good </span><span class="line" data-startTime="1361">thing for the entire web. </span></p>

<p><span class="line" data-startTime="1364">Maybe more interesting </span><span class="line" data-startTime="1364">to me, at least, </span><span class="line" data-startTime="1366">is that the dart2js </span><span class="line" data-startTime="1366">generated code </span><span class="line" data-startTime="1367">has improved a lot </span><span class="line" data-startTime="1367">on this benchmark. </span> <span class="line" data-startTime="1369">It's still the same </span><span class="line" data-startTime="1369">V8 that runs it, </span><span class="line" data-startTime="1371">it's just that the </span><span class="line" data-startTime="1371">code we generate </span><span class="line" data-startTime="1372">is actually a little bit faster </span><span class="line" data-startTime="1372">than the handwritten version. </span> <span class="line" data-startTime="1375">How could that be? </span><span class="line" data-startTime="1376">Well basically, </span><span class="line" data-startTime="1376">we do optimization </span><span class="line" data-startTime="1378">that you probably don't </span><span class="line" data-startTime="1378">want to do by hand. </span> <span class="line" data-startTime="1380">Because we know the entire </span><span class="line" data-startTime="1380">structure of the app, </span><span class="line" data-startTime="1382">we can do some inlining for you, </span><span class="line" data-startTime="1382">and some code motion and things </span><span class="line" data-startTime="1387">like that for your </span><span class="line" data-startTime="1387">loops that you probably </span><span class="line" data-startTime="1388">don't care to do by hand. </span> <span class="line" data-startTime="1390">So it's a little bit faster. </span> <span class="line" data-startTime="1391">In general, what </span><span class="line" data-startTime="1391">we see is that we </span><span class="line" data-startTime="1392">were very close to handwritten </span><span class="line" data-startTime="1392">dart2js performance </span><span class="line" data-startTime="1394">on everything. </span></p>

<p><span class="line" data-startTime="1396">There are cases </span><span class="line" data-startTime="1396">where we're faster. </span> <span class="line" data-startTime="1397">And unfortunately, </span><span class="line" data-startTime="1397">there are cases </span><span class="line" data-startTime="1398">where we're a little bit slower. </span> <span class="line" data-startTime="1400">So anyway, the performance </span><span class="line" data-startTime="1400">looks really promising </span><span class="line" data-startTime="1402">and it's nice to be able to </span><span class="line" data-startTime="1402">write in a very clean language </span><span class="line" data-startTime="1405">and get good performance. </span> <span class="line" data-startTime="1406">So let's take a look </span><span class="line" data-startTime="1406">at how you actually </span><span class="line" data-startTime="1409">go about using this Dart </span><span class="line" data-startTime="1409">thing in a real setting. </span></p>

<p class="speaker"><span class="line" data-starttime="1412"><span class="speakerName">Seth Ladd</span>: Yeah, thanks Kasper. </span> <span class="line" data-startTime="1414">So that's dart2js. </span> <span class="line" data-startTime="1415">A little bit about </span><span class="line" data-startTime="1415">the workflow &mdash; </span><span class="line" data-startTime="1416">how and when do you apply that? </span><span class="line" data-startTime="1418">Compiling JavaScript </span><span class="line" data-startTime="1418">of course is great, </span><span class="line" data-startTime="1420">but I don't want to </span><span class="line" data-startTime="1420">do that every time. </span> <span class="line" data-startTime="1421">I want those quick iterations </span><span class="line" data-startTime="1421">that the web is known for. </span> <span class="line" data-startTime="1426">So what does it look like? </span><span class="line" data-startTime="1427">Well, we have a </span><span class="line" data-startTime="1427">build of Chromium </span><span class="line" data-startTime="1429">with the Dart virtual </span><span class="line" data-startTime="1429">machine embedded in it </span><span class="line" data-startTime="1431">we've actually called Dartium. </span> <span class="line" data-startTime="1432">And that's where you </span><span class="line" data-startTime="1432">spend most of your time. </span> <span class="line" data-startTime="1434">Those are your quick </span><span class="line" data-startTime="1434">edit reload cycles. </span></p>

<p><span class="line" data-startTime="1436">So let's look at </span><span class="line" data-startTime="1436">what that feels like. </span> <span class="line" data-startTime="1438">Here's a build of Dart Editor. </span> <span class="line" data-startTime="1440">You don't have to </span><span class="line" data-startTime="1440">use Dart Editor, </span><span class="line" data-startTime="1441">but it does ship </span><span class="line" data-startTime="1441">with the project. </span> <span class="line" data-startTime="1443">It's a stripped down </span><span class="line" data-startTime="1443">version of Eclipse. </span> <span class="line" data-startTime="1445">In fact, I like to show this. </span> <span class="line" data-startTime="1446">I showed this screen to </span><span class="line" data-startTime="1446">somebody, and they're like, </span><span class="line" data-startTime="1447">oh you have a bug? </span><span class="line" data-startTime="1448">You're missing like 78 </span><span class="line" data-startTime="1448">more preferences in there? </span><span class="line" data-startTime="1450">Like, no, no actually, </span><span class="line" data-startTime="1450">we took those out. </span> <span class="line" data-startTime="1453">So it's optimized for </span><span class="line" data-startTime="1453">writing Dart code. </span> <span class="line" data-startTime="1455">Probably the best </span><span class="line" data-startTime="1455">way to get started </span><span class="line" data-startTime="1457">is &mdash; let's just </span><span class="line" data-startTime="1457">create a sample app. </span> <span class="line" data-startTime="1459">So luckily, Eric showed </span><span class="line" data-startTime="1459">us Polymer before. </span> <span class="line" data-startTime="1463">Dart has been porting </span><span class="line" data-startTime="1463">Polymer, polymer.dart. </span> <span class="line" data-startTime="1465">So we're totally in bed with </span><span class="line" data-startTime="1465">this web components things. </span> <span class="line" data-startTime="1468">We think it's the bee's knees. </span></p>

<p><span class="line" data-startTime="1470">Here is a sample application. </span> <span class="line" data-startTime="1471">You get all the </span><span class="line" data-startTime="1471">skeleton for you. </span> <span class="line" data-startTime="1472">You've got the HTML. </span> <span class="line" data-startTime="1474">You've got the custom </span><span class="line" data-startTime="1474">elements, the CSS. </span> <span class="line" data-startTime="1476">So let's just run this </span><span class="line" data-startTime="1476">here to see what it's like. </span> <span class="line" data-startTime="1478">It's very simple here, but </span><span class="line" data-startTime="1478">we're going to run in Dartium. </span> <span class="line" data-startTime="1481">See, it pops right up. </span> <span class="line" data-startTime="1482">No compiles time needed. </span> <span class="line" data-startTime="1484">Click me, OK button. </span> <span class="line" data-startTime="1486">Click counter. </span> <span class="line" data-startTime="1486">OK, cool. </span> <span class="line" data-startTime="1487">So it gives you just the </span><span class="line" data-startTime="1487">core to get started with. </span> <span class="line" data-startTime="1489">Let's look a little bit at how </span><span class="line" data-startTime="1489">this application is written. </span> <span class="line" data-startTime="1493">Hopefully you can see this. </span> <span class="line" data-startTime="1494">So the polymer </span><span class="line" data-startTime="1494">element looks pretty </span><span class="line" data-startTime="1497">much like what Eric was </span><span class="line" data-startTime="1497">showing you earlier. </span> <span class="line" data-startTime="1499">So the HTML aspects of building </span><span class="line" data-startTime="1499">highly declarative apps </span><span class="line" data-startTime="1502">with Dart are very similar </span><span class="line" data-startTime="1502">to the JavaScript side. </span></p>

<p><span class="line" data-startTime="1505">The difference though, instead </span><span class="line" data-startTime="1505">of implementing the custom </span><span class="line" data-startTime="1507">element with JavaScript, you </span><span class="line" data-startTime="1507">can implement it with Dart. </span> <span class="line" data-startTime="1509">Dart has classes, so it makes a </span><span class="line" data-startTime="1509">ton of sense to be able to say, </span><span class="line" data-startTime="1512">one class for one </span><span class="line" data-startTime="1512">custom element. </span> <span class="line" data-startTime="1515">So this is cool. </span> <span class="line" data-startTime="1516">And I'll show you a couple </span><span class="line" data-startTime="1516">other features, because Dart </span><span class="line" data-startTime="1517">is structured, and </span><span class="line" data-startTime="1517">this editor gives you </span><span class="line" data-startTime="1519">some nice productivity benefits. </span> <span class="line" data-startTime="1521">Let's say I want to add a reset </span><span class="line" data-startTime="1521">count, and then a method here. </span> <span class="line" data-startTime="1527">OK. </span> <span class="line" data-startTime="1528">Code completion. </span> <span class="line" data-startTime="1529">Because we can statically </span><span class="line" data-startTime="1529">analyze your program, </span><span class="line" data-startTime="1531">we know what you </span><span class="line" data-startTime="1531">can call right here. </span> <span class="line" data-startTime="1533">And it's real time. </span></p>

<p><span class="line" data-startTime="1534">So that's pretty awesome. </span> <span class="line" data-startTime="1535">Now I'll also go in and infer </span><span class="line" data-startTime="1535">the local stuff as well. </span> <span class="line" data-startTime="1538">OK, that's pretty cool. </span> <span class="line" data-startTime="1539">Now, the other neat thing about </span><span class="line" data-startTime="1539">statically analyzable language </span><span class="line" data-startTime="1542">is it can understand </span><span class="line" data-startTime="1542">your program. </span> <span class="line" data-startTime="1544">So let's look at </span><span class="line" data-startTime="1544">this field count. </span> <span class="line" data-startTime="1546">Notice how it only highlights </span><span class="line" data-startTime="1546">the uses of that field. </span> <span class="line" data-startTime="1549">It's not doing a string </span><span class="line" data-startTime="1549">search and replace here. </span> <span class="line" data-startTime="1551">So it leaves out some </span><span class="line" data-startTime="1551">of the other accounts, </span><span class="line" data-startTime="1553">even though obviously </span><span class="line" data-startTime="1553">it's the same string. </span> <span class="line" data-startTime="1555">So we can rename. </span> <span class="line" data-startTime="1557">We can say my account. </span> <span class="line" data-startTime="1559">And it only renames actual </span><span class="line" data-startTime="1559">usages of that field, again </span><span class="line" data-startTime="1561">the power of a statically </span><span class="line" data-startTime="1561">analyzable language. </span> <span class="line" data-startTime="1563">I'm going to undo that </span><span class="line" data-startTime="1563">because I'm scared of bugs. </span> <span class="line" data-startTime="1566">OK, cool. </span></p>

<p><span class="line" data-startTime="1568">Once you're in an </span><span class="line" data-startTime="1568">editor, and you </span><span class="line" data-startTime="1570">have an actual virtual machine, </span><span class="line" data-startTime="1570">you can set breakpoints. </span> <span class="line" data-startTime="1572">So let's go back. </span> <span class="line" data-startTime="1574">We set a breakpoint there. </span> <span class="line" data-startTime="1575">We're going to re-run the app. </span> <span class="line" data-startTime="1576">And if I click the button, and </span><span class="line" data-startTime="1576">it all works &mdash; yes, OK, great. </span> <span class="line" data-startTime="1579">So it jumps back to </span><span class="line" data-startTime="1579">the editor, and you're </span><span class="line" data-startTime="1581">in the familiar </span><span class="line" data-startTime="1581">editing environment, </span><span class="line" data-startTime="1583">with full breakpoints. </span> <span class="line" data-startTime="1585">You can inspect. </span> <span class="line" data-startTime="1586">This is really cool. </span> <span class="line" data-startTime="1587">I can jump in here. </span></p>

<p><span class="line" data-startTime="1588">I want to inspect this instance. </span> <span class="line" data-startTime="1590">I don't know if you guys </span><span class="line" data-startTime="1590">can see this, actually. </span> <span class="line" data-startTime="1592">Trust me, that says </span><span class="line" data-startTime="1592">count and then five, </span><span class="line" data-startTime="1594">so it's a live object inspector. </span> <span class="line" data-startTime="1596">So that's really cool. </span> <span class="line" data-startTime="1599">Let's move on. </span> <span class="line" data-startTime="1600">This app was kind of neat, </span><span class="line" data-startTime="1600">but it's also kind of boring. </span> <span class="line" data-startTime="1603">So I think we can do </span><span class="line" data-startTime="1603">a little bit better. </span> <span class="line" data-startTime="1605">In fact, that gray button, </span><span class="line" data-startTime="1605">I want to make fancier. </span> <span class="line" data-startTime="1608">So this is where a package </span><span class="line" data-startTime="1608">management system comes in. </span> <span class="line" data-startTime="1611">Our package management </span><span class="line" data-startTime="1611">system, Pub &mdash; and let's </span><span class="line" data-startTime="1614">see if we can go here &mdash; </span><span class="line" data-startTime="1614">has over 500 packages in it </span><span class="line" data-startTime="1620">already from our open </span><span class="line" data-startTime="1620">source community, everything </span><span class="line" data-startTime="1622">from server-side stuff </span><span class="line" data-startTime="1622">to client-side stuff, </span><span class="line" data-startTime="1624">to game, crypto, you name it. </span></p>

<p><span class="line" data-startTime="1626">Ah, here, look at </span><span class="line" data-startTime="1626">this &mdash; fancy button. </span> <span class="line" data-startTime="1629">OK, so our Pub package </span><span class="line" data-startTime="1629">management system </span><span class="line" data-startTime="1631">also has custom elements in it. </span> <span class="line" data-startTime="1633">So if you like web components, </span><span class="line" data-startTime="1633">you want to reuse them, </span><span class="line" data-startTime="1636">package management system </span><span class="line" data-startTime="1636">is a great way to do that. </span> <span class="line" data-startTime="1638">So let's make our </span><span class="line" data-startTime="1638">button a little fancy. </span> <span class="line" data-startTime="1640">Let's load up the </span><span class="line" data-startTime="1640">pubspec.yaml file. </span> <span class="line" data-startTime="1643">This defines my application </span><span class="line" data-startTime="1643">and its dependencies. </span> <span class="line" data-startTime="1647">And certainly I </span><span class="line" data-startTime="1647">depend on polymer. </span> <span class="line" data-startTime="1648">Let's depend on fancy_button. </span></p>

<p><span class="line" data-startTime="1652">OK, great. </span> <span class="line" data-startTime="1653">So now the editor </span><span class="line" data-startTime="1653">is kicking off pub. </span> <span class="line" data-startTime="1654">He's going to go download </span><span class="line" data-startTime="1654">it, and install it, and make </span><span class="line" data-startTime="1656">sure it all works for my app. </span> <span class="line" data-startTime="1657">I'm a little </span><span class="line" data-startTime="1657">impatient, so I'm going </span><span class="line" data-startTime="1659">to go over here and show </span><span class="line" data-startTime="1659">you what that looks like. </span> <span class="line" data-startTime="1661">We're going to go </span><span class="line" data-startTime="1661">into click-counter. </span> <span class="line" data-startTime="1665">And just like regular web </span><span class="line" data-startTime="1665">components and HTML imports, </span><span class="line" data-startTime="1668">you can import the </span><span class="line" data-startTime="1668">definition of fancy button. </span> <span class="line" data-startTime="1670">You can say that this </span><span class="line" data-startTime="1670">button is a fancy button. </span> <span class="line" data-startTime="1674">Now this is all backed by Dart. </span></p>

<p><span class="line" data-startTime="1676">It's a real web component, </span><span class="line" data-startTime="1676">and it came to us </span><span class="line" data-startTime="1678">from that package </span><span class="line" data-startTime="1678">management system. </span> <span class="line" data-startTime="1680">Let's see if I indeed </span><span class="line" data-startTime="1680">made it a little fancier. </span> <span class="line" data-startTime="1682">So run in Dartium. </span> <span class="line" data-startTime="1684">And yes, awesome. </span> <span class="line" data-startTime="1685">OK. </span> <span class="line" data-startTime="1686">Pink, OK. </span> <span class="line" data-startTime="1687">So it's a nice </span><span class="line" data-startTime="1687">demonstration of how </span><span class="line" data-startTime="1689">you can use a package management </span><span class="line" data-startTime="1689">system and reuse code. </span> <span class="line" data-startTime="1692">Finally, we need to get </span><span class="line" data-startTime="1692">this out into the wild. </span> <span class="line" data-startTime="1694">It's one thing to iterate </span><span class="line" data-startTime="1694">very quickly in Dartium, </span><span class="line" data-startTime="1697">but it's another thing </span><span class="line" data-startTime="1697">to be able to &mdash; find </span><span class="line" data-startTime="1699">my original slides, boop, </span><span class="line" data-startTime="1699">OK &mdash; do your final testing </span><span class="line" data-startTime="1705">in production browsers like </span><span class="line" data-startTime="1705">Firefox and stable Chrome. </span> <span class="line" data-startTime="1708">And this is our pub </span><span class="line" data-startTime="1708">build system comes in. </span></p>

<p><span class="line" data-startTime="1710">So iterate very fast with </span><span class="line" data-startTime="1710">Dartium and the editor, </span><span class="line" data-startTime="1713">and then run a </span><span class="line" data-startTime="1713">nice build process. </span> <span class="line" data-startTime="1714">Now more and more </span><span class="line" data-startTime="1714">web developers are </span><span class="line" data-startTime="1716">moving to a build process that </span><span class="line" data-startTime="1716">does really nice optimizations. </span> <span class="line" data-startTime="1719">For one, ours runs dart2js. </span> <span class="line" data-startTime="1721">You saw some of the </span><span class="line" data-startTime="1721">nice optimizations </span><span class="line" data-startTime="1722">it can actually </span><span class="line" data-startTime="1722">do with your code. </span> <span class="line" data-startTime="1724">Tree shaking &mdash; it </span><span class="line" data-startTime="1724">can minify your app. </span> <span class="line" data-startTime="1725">If it totally knows </span><span class="line" data-startTime="1725">your entire application, </span><span class="line" data-startTime="1728">it can do a really smart </span><span class="line" data-startTime="1728">job at minification. </span> <span class="line" data-startTime="1730">It can also do concatenation. </span> <span class="line" data-startTime="1731">It can take all </span><span class="line" data-startTime="1731">your dependencies, </span><span class="line" data-startTime="1733">all your custom elements, </span><span class="line" data-startTime="1733">and jam them all in together </span><span class="line" data-startTime="1735">into one single file, making </span><span class="line" data-startTime="1735">the deployment and performance </span><span class="line" data-startTime="1739">very, very good. </span></p>

<p><span class="line" data-startTime="1740">In fact, in this </span><span class="line" data-startTime="1740">particular example, </span><span class="line" data-startTime="1741">you saw we had a lot of </span><span class="line" data-startTime="1741">dependencies, third party </span><span class="line" data-startTime="1743">stuff, custom libraries, </span><span class="line" data-startTime="1743">core libraries. </span> <span class="line" data-startTime="1746">This app compiles </span><span class="line" data-startTime="1746">them and gzips down </span><span class="line" data-startTime="1747">to smaller than some CSS </span><span class="line" data-startTime="1747">frameworks you guys use. </span> <span class="line" data-startTime="1750">So I think it's kind of cool. </span> <span class="line" data-startTime="1751">And just to show you </span><span class="line" data-startTime="1751">that that all works, </span><span class="line" data-startTime="1754">here we have it in Firefox. </span> <span class="line" data-startTime="1757">This is Dart, compiled </span><span class="line" data-startTime="1757">to JavaScript, </span><span class="line" data-startTime="1758">using web components deployable </span><span class="line" data-startTime="1758">to a production browser today. </span> <span class="line" data-startTime="1762">This stuff is real </span><span class="line" data-startTime="1762">and you can use it. </span></p>

<p><span class="line" data-startTime="1767">And then, when you're </span><span class="line" data-startTime="1767">finally ready to go, </span><span class="line" data-startTime="1768">you have a nice build </span><span class="line" data-startTime="1768">directory, which </span><span class="line" data-startTime="1770">has just the assets, just </span><span class="line" data-startTime="1770">those minified files, </span><span class="line" data-startTime="1773">in a very nice directory you can </span><span class="line" data-startTime="1773">pick up and put onto the web. </span> <span class="line" data-startTime="1776">All that concatenation, all </span><span class="line" data-startTime="1776">the minification, done for you. </span></p>

<p class="speaker"><span class="line" data-starttime="1779"><span class="speakerName">Kasper Lund</span>: Nice and simple. </span></p>

<p class="speaker"><span class="line" data-starttime="1780"><span class="speakerName">Seth Ladd</span>: Nice and simple. </span><span class="line" data-startTime="1781">So, how do you get started? </span><span class="line" data-startTime="1783">Well, we relaunched the website, </span><span class="line" data-startTime="1783">and we have a really nice code </span><span class="line" data-startTime="1785">lab. </span><span class="line" data-startTime="1785">It takes under an hour, </span><span class="line" data-startTime="1785">walks you through zero to 60. </span><span class="line" data-startTime="1788">You get to build a really cool </span><span class="line" data-startTime="1788">pirate name badge generator. </span><span class="line" data-startTime="1791">A really nice way </span><span class="line" data-startTime="1791">to try Dart, built </span><span class="line" data-startTime="1792">for if you don't know </span><span class="line" data-startTime="1792">anything about Dart. </span><span class="line" data-startTime="1794">And I want to leave </span><span class="line" data-startTime="1794">you with a reminder </span><span class="line" data-startTime="1796">that Dart 1.0 is </span><span class="line" data-startTime="1796">for the modern web. </span><span class="line" data-startTime="1799">It's a platform </span><span class="line" data-startTime="1799">you can use today. </span><span class="line" data-startTime="1802">It's easy to get started. </span><span class="line" data-startTime="1803">Go to dartlang.org. </span><span class="line" data-startTime="1804">We have APIs, code labs, </span><span class="line" data-startTime="1804">articles, tutorials. </span><span class="line" data-startTime="1807">And everything you saw here, </span><span class="line" data-startTime="1807">even the web component stuff, </span><span class="line" data-startTime="1810">all compiles to JavaScript. </span><span class="line" data-startTime="1812">So you can write </span><span class="line" data-startTime="1812">Dart, take advantage </span><span class="line" data-startTime="1813">of those great semantics, </span><span class="line" data-startTime="1813">language, and tools, </span><span class="line" data-startTime="1815">and still deploy </span><span class="line" data-startTime="1815">across the modern web. </span><span class="line" data-startTime="1818">So I think with that &mdash; I </span><span class="line" data-startTime="1818">think we're all ready to go. </span><span class="line" data-startTime="1823">Thank you very much. </span><span class="line" data-startTime="1824">Appreciate it. </span></p></div>