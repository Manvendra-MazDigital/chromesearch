<p class="speaker"><span class="line" data-starttime="8"><span class="speakerName">Colt McAnlis</span>: Better yet, I use </span><span class="line" data-startTime="8">Chrome OS, because I don't </span><span class="line" data-startTime="10">know what defrag is. </span></p>

<p class="speaker"><span class="line" data-starttime="11"><span class="speakerName">Noel Allen</span>: There you are. </span></p>

<p class="speaker"><span class="line" data-starttime="12"><span class="speakerName">Colt McAnlis</span>: There </span><span class="line" data-startTime="12">is actually. </span></p>

<p class="speaker"><span class="line" data-starttime="14"><span class="speakerName">Noel Allen</span>: Ooh. </span></p>

<p class="speaker"><span class="line" data-starttime="17"><span class="speakerName">Colt McAnlis</span>: All right. </span><span class="line" data-startTime="18">It looks like we are alive. </span><span class="line" data-startTime="20">Fantastic. </span><span class="line" data-startTime="21">Hello. </span><span class="line" data-startTime="21">Welcome, everyone. </span><span class="line" data-startTime="24">Wow. </span><span class="line" data-startTime="24">We have a post-lunch </span><span class="line" data-startTime="24">coma crowd. </span><span class="line" data-startTime="26">Hello, everyone! </span></p>

<p class="speaker"><span class="line" data-starttime="27"><span class="speakerName">Audience</span>: Hello! </span></p>

<p class="speaker"><span class="line" data-starttime="28"><span class="speakerName">Colt McAnlis</span>: Fantastic. </span><span class="line" data-startTime="29">Perfect. </span><span class="line" data-startTime="30">Guys, we're getting recorded on </span><span class="line" data-startTime="30">YouTube, and you're going </span><span class="line" data-startTime="31">to be like, no, let's not </span><span class="line" data-startTime="31">talk to the presenter. </span><span class="line" data-startTime="33">That's horrible. </span><span class="line" data-startTime="35">Your voice will be recorded </span><span class="line" data-startTime="35">and saved for </span><span class="line" data-startTime="36">the annals of time. </span><span class="line" data-startTime="39">Anyhow, hello everyone. </span><span class="line" data-startTime="40">Welcome today to Native </span><span class="line" data-startTime="40">Client Live. </span><span class="line" data-startTime="43">My name is Colt McAnlis. </span><span class="line" data-startTime="44">I'm a developer advocate </span><span class="line" data-startTime="44">at Google </span><span class="line" data-startTime="46">working on Native Client. </span></p>

<p class="speaker"><span class="line" data-starttime="48"><span class="speakerName">Noel Allen</span>: I'm Noel Allen, </span><span class="line" data-startTime="48">the SDK lead. </span></p>

<p class="speaker"><span class="line" data-starttime="50"><span class="speakerName">Colt McAnlis</span>: SDK lead. </span><span class="line" data-startTime="51">And we have fancy </span><span class="line" data-startTime="51">hats, as well. </span><span class="line" data-startTime="53">We figured these lights </span><span class="line" data-startTime="53">are actually </span><span class="line" data-startTime="55">pretty gnarly up here. </span><span class="line" data-startTime="56">We can't see people. </span><span class="line" data-startTime="56">So we're like, let's </span><span class="line" data-startTime="56">wear our hats. </span><span class="line" data-startTime="58">That'll be funny. </span></p>

<p class="speaker"><span class="line" data-starttime="59"><span class="speakerName">Noel Allen</span>: It actually kind </span><span class="line" data-startTime="59">of works, because it is a </span><span class="line" data-startTime="61">little bright. </span></p>

<p class="speaker"><span class="line" data-starttime="62"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="63">So what today's talk is about </span><span class="line" data-startTime="63">is, we're actually going to </span><span class="line" data-startTime="65">port an application to Native </span><span class="line" data-startTime="65">Client live in 60 minutes. </span> <span class="line" data-startTime="68">Now, just quick show of hands </span><span class="line" data-startTime="68">in here, how many have </span><span class="line" data-startTime="70">actually played with </span><span class="line" data-startTime="70">Native Client? </span><span class="line" data-startTime="72">Wow. </span> <span class="line" data-startTime="73">That's actually a surprising </span><span class="line" data-startTime="73">amount of people. </span> <span class="line" data-startTime="75">I'm very encouraged </span><span class="line" data-startTime="75">by that, actually. </span> <span class="line" data-startTime="77">They'll know what we're </span><span class="line" data-startTime="77">talking about today. </span> <span class="line" data-startTime="79">Funny story is we actually </span><span class="line" data-startTime="79">decided to sign off to do this </span><span class="line" data-startTime="83">about three to four </span><span class="line" data-startTime="83">months ago. </span></p>

<p><span class="line" data-startTime="86">And we actually walked into </span><span class="line" data-startTime="86">Noel's office, and I was like, </span><span class="line" data-startTime="88">hey, we're going to give a talk </span><span class="line" data-startTime="88">at Google I/O, and we're </span><span class="line" data-startTime="91">going to port something </span><span class="line" data-startTime="91">to Native </span><span class="line" data-startTime="92">Client live in 60 minutes. </span> <span class="line" data-startTime="93">And he was like, uh, </span><span class="line" data-startTime="93">no you're not. </span> <span class="line" data-startTime="95">And I said, yes, yes we are. </span> <span class="line" data-startTime="96">So we got him to </span><span class="line" data-startTime="96">sign off on it. </span> <span class="line" data-startTime="97">I convinced him with alcohol </span><span class="line" data-startTime="97">or something else. </span> <span class="line" data-startTime="99">And we started going through </span><span class="line" data-startTime="99">the process. </span> <span class="line" data-startTime="101">And the truth was, we failed. </span></p>

<p><span class="line" data-startTime="103">We failed a lot. </span> <span class="line" data-startTime="104">Horribly. </span> <span class="line" data-startTime="105">Like crash and burn style. </span></p>

<p class="speaker"><span class="line" data-starttime="107"><span class="speakerName">Noel Allen</span>: You failed </span><span class="line" data-startTime="107">before I started. </span><span class="line" data-startTime="108">Let's just get that clear. </span></p>

<p class="speaker"><span class="line" data-starttime="110"><span class="speakerName">Colt McAnlis</span>: Fair enough, </span><span class="line" data-startTime="110">fair enough. </span><span class="line" data-startTime="111">That is true. </span><span class="line" data-startTime="112">The original port of the </span><span class="line" data-startTime="112">application we're going to </span><span class="line" data-startTime="114">show you today actually took </span><span class="line" data-startTime="114">about 2.5 weeks the very first </span><span class="line" data-startTime="117">time we did it, which was kind </span><span class="line" data-startTime="117">of embarrassing on our side, </span><span class="line" data-startTime="119">because it's a very simple </span><span class="line" data-startTime="119">piece of technology we're </span><span class="line" data-startTime="120">going to look at today. </span><span class="line" data-startTime="122">But the good news is that we </span><span class="line" data-startTime="122">actually learned from that. </span><span class="line" data-startTime="125">We said, where are we. </span><span class="line" data-startTime="126">This isn't good for </span><span class="line" data-startTime="126">our developers. </span><span class="line" data-startTime="128">Let's improve the process. </span><span class="line" data-startTime="129">Let's improve the SDK, </span><span class="line" data-startTime="129">the workflow. </span><span class="line" data-startTime="131">And what we're going to talk </span><span class="line" data-startTime="131">about today is the learn-ins, </span><span class="line" data-startTime="134">the learn-ins of those things. </span><span class="line" data-startTime="136">So how you should view </span><span class="line" data-startTime="136">today's class session </span><span class="line" data-startTime="139">is a cooking show. </span><span class="line" data-startTime="140">How many people watch </span><span class="line" data-startTime="140">late night cooking? </span><span class="line" data-startTime="143">Really? </span><span class="line" data-startTime="144">That's it? </span><span class="line" data-startTime="145">The rest of you are liars, and </span><span class="line" data-startTime="145">you're dirty, filthy liars. </span><span class="line" data-startTime="148">If you do not watch </span><span class="line" data-startTime="148">Iron Chef there is </span><span class="line" data-startTime="150">something wrong with you. </span><span class="line" data-startTime="151">That is an amazing show. </span><span class="line" data-startTime="156">When did &mdash; </span><span class="line" data-startTime="156">OK &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="157"><span class="speakerName">Noel Allen</span>: You kept changing </span><span class="line" data-startTime="157">the slides on me. </span><span class="line" data-startTime="159">I figured I'd have </span><span class="line" data-startTime="159">some fun too. </span></p>

<p class="speaker"><span class="line" data-starttime="161"><span class="speakerName">Colt McAnlis</span>: That's new. </span> <span class="line" data-startTime="163">OK. </span> <span class="line" data-startTime="164">We're going there. </span> <span class="line" data-startTime="164">Today is a cooking show, </span><span class="line" data-startTime="164">and we have Chef </span><span class="line" data-startTime="167">Noel Allen over here. </span> <span class="line" data-startTime="170">In these shows, you usually have </span><span class="line" data-startTime="170">some very peppy person </span><span class="line" data-startTime="173">standing up there showing you </span><span class="line" data-startTime="173">how they're going to make a </span><span class="line" data-startTime="175">lamb sorbet, which is normally </span><span class="line" data-startTime="175">like a nine-day endeavor. </span> <span class="line" data-startTime="179">And they're going to do it in 30 </span><span class="line" data-startTime="179">minutes and show you how to </span><span class="line" data-startTime="182">do it, too. </span> <span class="line" data-startTime="182">Well, we're going to do the </span><span class="line" data-startTime="182">same process today. </span></p>

<p><span class="line" data-startTime="184">We're going to take the </span><span class="line" data-startTime="184">knowledge and everything we've </span><span class="line" data-startTime="186">learned in the past couple of </span><span class="line" data-startTime="186">months and dissect it down. </span> <span class="line" data-startTime="188">Now, we've had to pre-chop some </span><span class="line" data-startTime="188">onions so that we can get </span><span class="line" data-startTime="191">this in our 60 minute window </span><span class="line" data-startTime="191">here, but we'll be sure to </span><span class="line" data-startTime="194">call that out so you know what </span><span class="line" data-startTime="194">was pre-chopped, what was </span><span class="line" data-startTime="196">canned, and what was actually </span><span class="line" data-startTime="196">fresh tuna fish </span><span class="line" data-startTime="198">for our lamb sorbet. </span> <span class="line" data-startTime="200">And that hat is awesome. </span> <span class="line" data-startTime="201">Where did you even find that? </span></p>

<p class="speaker"><span class="line" data-starttime="203"><span class="speakerName">Noel Allen</span>: I got </span><span class="line" data-startTime="203">it at the store. </span></p>

<p class="speaker"><span class="line" data-starttime="205"><span class="speakerName">Colt McAnlis</span>: You have two? </span><span class="line" data-startTime="206">Sweet. </span><span class="line" data-startTime="207">Sorry, guys. </span><span class="line" data-startTime="210">I'm getting fired. </span><span class="line" data-startTime="211">This is going to be awesome. </span><span class="line" data-startTime="212">How does it look? </span></p>

<p class="speaker"><span class="line" data-starttime="213"><span class="speakerName">Noel Allen</span>: Very nice. </span><span class="line" data-startTime="215">Very convincing. </span></p>

<p class="speaker"><span class="line" data-starttime="215"><span class="speakerName">Colt McAnlis</span>: I feel like </span><span class="line" data-startTime="215">I have a pope hat. </span><span class="line" data-startTime="218">Is this even on right? </span></p>

<p class="speaker"><span class="line" data-starttime="220"><span class="speakerName">Noel Allen</span>: I can't tell. </span><span class="line" data-startTime="221">I don't know what it's supposed </span><span class="line" data-startTime="221">to look like. </span></p>

<p class="speaker"><span class="line" data-starttime="222"><span class="speakerName">Colt McAnlis</span>: OK, cool. </span><span class="line" data-startTime="223">All right. </span><span class="line" data-startTime="223">We're wearing these now. </span><span class="line" data-startTime="224">Fantastic. </span><span class="line" data-startTime="225">I'm sure the YouTube </span><span class="line" data-startTime="225">guys love this. </span><span class="line" data-startTime="226">OK. </span><span class="line" data-startTime="227">This is a cooking show </span><span class="line" data-startTime="227">with your chefs. </span><span class="line" data-startTime="229">So let's get started and talk </span><span class="line" data-startTime="229">about Native Client a little </span><span class="line" data-startTime="231">bit, sort of set the groundwork </span><span class="line" data-startTime="231">and the ecosystem </span><span class="line" data-startTime="233">of we're talking about today. </span><span class="line" data-startTime="235">Native Client is a technology </span><span class="line" data-startTime="235">that allows you to run C and </span><span class="line" data-startTime="239">C++ code in a web page with the </span><span class="line" data-startTime="239">same safety as JavaScript. </span><span class="line" data-startTime="244">And here's the really cool part, </span><span class="line" data-startTime="244">is that the user is not </span><span class="line" data-startTime="247">required to install a plug-in. </span><span class="line" data-startTime="249">So what we've seen is that with </span><span class="line" data-startTime="249">a lot of technologies out </span><span class="line" data-startTime="252">there, you can actually run C </span><span class="line" data-startTime="252">and C++ code in a web browser, </span><span class="line" data-startTime="255">but the user gets this really </span><span class="line" data-startTime="255">scary pop-up that's like, hey, </span><span class="line" data-startTime="258">you're about to install a </span><span class="line" data-startTime="258">plug-in that's going to </span><span class="line" data-startTime="259">violate every piece of data you </span><span class="line" data-startTime="259">have on your hard drive. </span><span class="line" data-startTime="262">What we've been seeing over time </span><span class="line" data-startTime="262">is that that, of course, </span><span class="line" data-startTime="265">affects user retention rates. </span></p>

<p class="speaker"><span class="line" data-starttime="267"><span class="speakerName">Noel Allen</span>: And installation. </span></p>

<p class="speaker"><span class="line" data-starttime="268"><span class="speakerName">Colt McAnlis</span>: Say again? </span></p>

<p class="speaker"><span class="line" data-starttime="269"><span class="speakerName">Noel Allen</span>: And installation. </span></p>

<p class="speaker"><span class="line" data-starttime="269"><span class="speakerName">Colt McAnlis</span>: And installation. </span> <span class="line" data-startTime="270">Exactly. </span> <span class="line" data-startTime="271">So users get there, and they </span><span class="line" data-startTime="271">go, hey, this is too scary. </span> <span class="line" data-startTime="274">And they move on. </span> <span class="line" data-startTime="274">And so this means that high </span><span class="line" data-startTime="274">performance applications that </span><span class="line" data-startTime="276">want to run C++ code in a web </span><span class="line" data-startTime="276">page really lose a lot of </span><span class="line" data-startTime="280">their users to this </span><span class="line" data-startTime="280">scary dialogue. </span> <span class="line" data-startTime="282">Now, with Native Client, C++ </span><span class="line" data-startTime="282">and the fact it can be run </span><span class="line" data-startTime="285">safely in the web browser and </span><span class="line" data-startTime="285">they're not prompted to </span><span class="line" data-startTime="288">install a plug-in, means that </span><span class="line" data-startTime="288">your C++ code can actually </span><span class="line" data-startTime="291">bridge a lot of ecosystems </span><span class="line" data-startTime="291">and a lot of platforms. </span> <span class="line" data-startTime="295">So predominantly, C++ code was </span><span class="line" data-startTime="295">in the realm of game consoles, </span><span class="line" data-startTime="299">PC development mobile. </span> <span class="line" data-startTime="300">And now you can actually use </span><span class="line" data-startTime="300">your same code base right in </span><span class="line" data-startTime="302">the web, which is fantastic </span><span class="line" data-startTime="302">for a lot of companies and </span><span class="line" data-startTime="305">studios who spend a lot of time </span><span class="line" data-startTime="305">not only training their </span><span class="line" data-startTime="308">engineers in C++ code, but also, </span><span class="line" data-startTime="308">you have legacy code. </span></p>

<p><span class="line" data-startTime="312">You've got 10 years of C++ </span><span class="line" data-startTime="312">memory management code, STL </span><span class="line" data-startTime="316">containers sitting around, </span><span class="line" data-startTime="316">and you don't want to </span><span class="line" data-startTime="318">throw all that out. </span> <span class="line" data-startTime="320">Now, we had our official Native </span><span class="line" data-startTime="320">Client launch event in </span><span class="line" data-startTime="323">December of last year. </span> <span class="line" data-startTime="324">In truth, Native Client was out </span><span class="line" data-startTime="324">for quite a while before </span><span class="line" data-startTime="327">that, but we decided to snazzy </span><span class="line" data-startTime="327">it up and actually have some </span><span class="line" data-startTime="329">hors d'oeuvres and call </span><span class="line" data-startTime="329">it a launch event. </span> <span class="line" data-startTime="331">Since then, NaCl has been </span><span class="line" data-startTime="331">doing fantastic. </span> <span class="line" data-startTime="333">We've seen already 27 titles, </span><span class="line" data-startTime="333">actual products, ship with </span><span class="line" data-startTime="337">Native Client since </span><span class="line" data-startTime="337">the announcement. </span> <span class="line" data-startTime="339">In addition to that, we've </span><span class="line" data-startTime="339">seen that game developers </span><span class="line" data-startTime="342">predominantly love </span><span class="line" data-startTime="342">Native Client. </span></p>

<p><span class="line" data-startTime="344">We see a lot of technology </span><span class="line" data-startTime="344">middleware for games on the </span><span class="line" data-startTime="348">side there. </span> <span class="line" data-startTime="349">They're finding that Native </span><span class="line" data-startTime="349">Client provides them this nice </span><span class="line" data-startTime="353">little niche between performance </span><span class="line" data-startTime="353">and reach. </span> <span class="line" data-startTime="356">You can run all of your code </span><span class="line" data-startTime="356">extremely fast and reach all </span><span class="line" data-startTime="360">of the 310 million users </span><span class="line" data-startTime="360">that Chrome has active. </span> <span class="line" data-startTime="365">That was a new stat today. </span> <span class="line" data-startTime="366">Watch the keynote. </span> <span class="line" data-startTime="367">So let's talk about what </span><span class="line" data-startTime="367">we're cooking today. </span> <span class="line" data-startTime="368">Let's switch this over to you. </span></p>

<p><span class="line" data-startTime="369">So Chef Noel, can you show us </span><span class="line" data-startTime="369">what our lamb sorbet looks </span><span class="line" data-startTime="373">like today? </span></p>

<p class="speaker"><span class="line" data-starttime="373"><span class="speakerName">Noel Allen</span>: Absolutely. </span><span class="line" data-startTime="374">So for today, we have a fabulous </span><span class="line" data-startTime="374">spinning cube. </span></p>

<p class="speaker"><span class="line" data-starttime="381"><span class="speakerName">Colt McAnlis</span>: That wasn't what </span><span class="line" data-startTime="381">we looked at yesterday. </span><span class="line" data-startTime="384">What &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="384"><span class="speakerName">Noel Allen</span>: Well, we still had </span><span class="line" data-startTime="384">a couple, you know, bugs. </span><span class="line" data-startTime="386">Issues. </span></p>

<p class="speaker"><span class="line" data-starttime="386"><span class="speakerName">Colt McAnlis</span>: You didn't </span><span class="line" data-startTime="386">fix the bugs? </span><span class="line" data-startTime="388">We were supposed to have &mdash; </span><span class="line" data-startTime="388">you were buying the hats. </span></p>

<p class="speaker"><span class="line" data-starttime="389"><span class="speakerName">Noel Allen</span>: I was busy. </span><span class="line" data-startTime="390">I had stuff to do. </span><span class="line" data-startTime="391">I had a new Nexus </span><span class="line" data-startTime="391">to play with. </span></p>

<p class="speaker"><span class="line" data-starttime="392"><span class="speakerName">Colt McAnlis</span>: Fair enough. </span><span class="line" data-startTime="394">Cool. </span><span class="line" data-startTime="395">You had a new Nexus. </span><span class="line" data-startTime="395">Awesome. </span><span class="line" data-startTime="395">So we're doing a </span><span class="line" data-startTime="395">spinning cube. </span><span class="line" data-startTime="396">So what is this thing actually </span><span class="line" data-startTime="396">doing behind the scenes? </span></p>

<p class="speaker"><span class="line" data-starttime="398"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="399">So this is an open GL demo. </span><span class="line" data-startTime="401">It's a kind of standard demo </span><span class="line" data-startTime="401">that you do, make sure your </span><span class="line" data-startTime="403">graphics engine is rendering </span><span class="line" data-startTime="403">correctly, hence the arrows </span><span class="line" data-startTime="406">and the lighting and whatnot. </span><span class="line" data-startTime="408">So this is a standard Windows </span><span class="line" data-startTime="408">32 application. </span><span class="line" data-startTime="411">And we're going to port </span><span class="line" data-startTime="411">that to Native Client. </span></p>

<p class="speaker"><span class="line" data-starttime="413"><span class="speakerName">Colt McAnlis</span>: And so this is </span><span class="line" data-startTime="413">doing just standard rendering. </span><span class="line" data-startTime="414">So we're [? reading ?] in some </span><span class="line" data-startTime="414">shaders, reading some </span><span class="line" data-startTime="416">textures, doing some </span><span class="line" data-startTime="416">a platform calls. </span></p>

<p class="speaker"><span class="line" data-starttime="418"><span class="speakerName">Noel Allen</span>: Exactly. </span></p>

<p class="speaker"><span class="line" data-starttime="418"><span class="speakerName">Colt McAnlis</span>: This is </span><span class="line" data-startTime="418">our lamb sorbet. </span> <span class="line" data-startTime="420">Fantastic. </span> <span class="line" data-startTime="421">So with that spinning cube up </span><span class="line" data-startTime="421">and running over there to </span><span class="line" data-startTime="423">distract all of you, I'm going </span><span class="line" data-startTime="423">to point over this way with </span><span class="line" data-startTime="424">sock puppets. </span> <span class="line" data-startTime="425">Let's talk about our kitchen. </span> <span class="line" data-startTime="427">Let's talk about what </span><span class="line" data-startTime="427">development with Native Client </span><span class="line" data-startTime="428">should actually look like </span><span class="line" data-startTime="428">today for most of you. </span> <span class="line" data-startTime="431">So, when porting to Native </span><span class="line" data-startTime="431">Client, you need to approach </span><span class="line" data-startTime="434">it from the concept of </span><span class="line" data-startTime="434">any other ports. </span> <span class="line" data-startTime="436">So let's say you're actually </span><span class="line" data-startTime="436">porting an application from </span><span class="line" data-startTime="438">Windows to Linux. </span> <span class="line" data-startTime="440">This is going to have a specific </span><span class="line" data-startTime="440">set of processes that </span><span class="line" data-startTime="442">you're going to need </span><span class="line" data-startTime="442">to go through. </span></p>

<p><span class="line" data-startTime="444">First off, you're going to need </span><span class="line" data-startTime="444">to actually change over </span><span class="line" data-startTime="446">from using DirectX to OpenGL. </span> <span class="line" data-startTime="448">That's actually a big set of </span><span class="line" data-startTime="448">code, different APIs that </span><span class="line" data-startTime="450">aren't available on the </span><span class="line" data-startTime="450">Linux machines. </span> <span class="line" data-startTime="452">Also some APIs are only </span><span class="line" data-startTime="452">available on Windows for the </span><span class="line" data-startTime="455">same process. </span> <span class="line" data-startTime="456">So you want to spawn </span><span class="line" data-startTime="456">up a thread. </span> <span class="line" data-startTime="457">Well on Windows, you'd use </span><span class="line" data-startTime="457">beginthread or beginthreadex. </span> <span class="line" data-startTime="461">On Linux, you would have to use </span><span class="line" data-startTime="461">sort of a more POSIX style </span><span class="line" data-startTime="463">pthread_create. </span> <span class="line" data-startTime="465">And for other things, Windows </span><span class="line" data-startTime="465">actually provides a very rich </span><span class="line" data-startTime="467">ecosystem for UI components that </span><span class="line" data-startTime="467">you can use as part of </span><span class="line" data-startTime="470">their platform that may </span><span class="line" data-startTime="470">not exist on other </span><span class="line" data-startTime="472">platforms like Linux. </span></p>

<p><span class="line" data-startTime="473">So instead of being able to </span><span class="line" data-startTime="473">actually use the message box </span><span class="line" data-startTime="476">function directly, you'd have to </span><span class="line" data-startTime="476">get shifted over to printf. </span> <span class="line" data-startTime="479">Right? </span><span class="line" data-startTime="480">So viewing your port to Native </span><span class="line" data-startTime="480">Client should be the same way. </span> <span class="line" data-startTime="484">You should view it like porting </span><span class="line" data-startTime="484">from anything to </span><span class="line" data-startTime="486">another platform. </span> <span class="line" data-startTime="487">But with Native Client, what </span><span class="line" data-startTime="487">you're actually porting to are </span><span class="line" data-startTime="489">these specific functions. </span> <span class="line" data-startTime="490">You're actually porting to </span><span class="line" data-startTime="490">an API we call Pepper. </span> <span class="line" data-startTime="493">Now, what Pepper is, is it's </span><span class="line" data-startTime="493">actually a plug-in API that </span><span class="line" data-startTime="497">Chrome provides that allows </span><span class="line" data-startTime="497">plug-ins to interact with </span><span class="line" data-startTime="501">lower-level system resources </span><span class="line" data-startTime="501">like FileIO, rendering, audio, </span><span class="line" data-startTime="505">and even the ability to </span><span class="line" data-startTime="505">communicate directly to the </span><span class="line" data-startTime="507">JavaScript page. </span> <span class="line" data-startTime="508">And it allows it to do this </span><span class="line" data-startTime="508">inside of the Chrome sandbox, </span><span class="line" data-startTime="511">which means that these </span><span class="line" data-startTime="511">plug-ins are actually </span><span class="line" data-startTime="513">communicating through the same </span><span class="line" data-startTime="513">exact code paths that </span><span class="line" data-startTime="517">JavaScript is communicating </span><span class="line" data-startTime="517">to, to do the same </span><span class="line" data-startTime="519">functionality. </span></p>

<p><span class="line" data-startTime="520">This hat is awesome, </span><span class="line" data-startTime="520">by the way. </span> <span class="line" data-startTime="522">I'm not sure &mdash; </span><span class="line" data-startTime="522">I need an ear-in. </span> <span class="line" data-startTime="523">It's popping over my head. </span> <span class="line" data-startTime="526">Anyhow, Native Client should be </span><span class="line" data-startTime="526">viewed as a plug-in that's </span><span class="line" data-startTime="529">provided with Chrome. </span> <span class="line" data-startTime="530">It's compiled with Chrome. </span> <span class="line" data-startTime="532">It's shipped with Chrome. </span> <span class="line" data-startTime="533">And what Native Client allows </span><span class="line" data-startTime="533">you to do is it allows you to </span><span class="line" data-startTime="536">load pre-compiled executable </span><span class="line" data-startTime="536">code that can then target the </span><span class="line" data-startTime="540">Pepper APIs. </span> <span class="line" data-startTime="541">It'll load it up, execute the </span><span class="line" data-startTime="541">code, and allow that code to </span><span class="line" data-startTime="545">actually, directly trampoline </span><span class="line" data-startTime="545">over and get access to these </span><span class="line" data-startTime="548">lower-level system resources. </span></p>

<p><span class="line" data-startTime="550">How this works at a developer </span><span class="line" data-startTime="550">level starts with the </span><span class="line" data-startTime="552">original C++ code. </span> <span class="line" data-startTime="554">The C++ code is then sent </span><span class="line" data-startTime="554">through our custom GCC </span><span class="line" data-startTime="557">compiler, provided by the SDK. </span> <span class="line" data-startTime="559">This spits out a set </span><span class="line" data-startTime="559">of NEXE files, or </span><span class="line" data-startTime="561">Native Client exe files. </span> <span class="line" data-startTime="563">These have been munged </span><span class="line" data-startTime="563">and messed </span><span class="line" data-startTime="566">around a bit to ensure &mdash; </span><span class="line" data-startTime="567">well, to do the best we </span><span class="line" data-startTime="567">can to ensure safety. </span> <span class="line" data-startTime="569">We remove a lot of malicious </span><span class="line" data-startTime="569">codes that may cause security </span><span class="line" data-startTime="573">vulnerabilities and some other </span><span class="line" data-startTime="573">fun stuff that we'll talk </span><span class="line" data-startTime="575">about later. </span> <span class="line" data-startTime="577">You take this data that's </span><span class="line" data-startTime="577">actually generated from the </span><span class="line" data-startTime="579">toolchain, and with a simple </span><span class="line" data-startTime="579">HTML embed tag, you can </span><span class="line" data-startTime="582">actually get it running right </span><span class="line" data-startTime="582">in your web page. </span> <span class="line" data-startTime="584">So what you're actually seeing </span><span class="line" data-startTime="584">on the screen there is a </span><span class="line" data-startTime="586">screenshot from a game </span><span class="line" data-startTime="586">called From Dust. </span> <span class="line" data-startTime="588">From Dust was actually an Xbox </span><span class="line" data-startTime="588">360 title that was ported over </span><span class="line" data-startTime="592">to Native Client that we </span><span class="line" data-startTime="592">unveiled earlier this year. </span></p>

<p><span class="line" data-startTime="594">Now, this is running the same </span><span class="line" data-startTime="594">shaders, the same code. </span> <span class="line" data-startTime="597">It's actually doing </span><span class="line" data-startTime="597">quite amazing. </span> <span class="line" data-startTime="598">I think I have this backwards. </span> <span class="line" data-startTime="600">How about that? </span><span class="line" data-startTime="600">Is that better? </span></p>

<p class="speaker"><span class="line" data-starttime="601"><span class="speakerName">Noel Allen</span>: You're going to </span><span class="line" data-startTime="601">fiddle with this the whole </span><span class="line" data-startTime="603">presentation, aren't you? </span></p>

<p class="speaker"><span class="line" data-starttime="603"><span class="speakerName">Colt McAnlis</span>: It's </span><span class="line" data-startTime="603">annoying me. </span> <span class="line" data-startTime="604">My head's too small and </span><span class="line" data-startTime="604">my ears are too big. </span> <span class="line" data-startTime="606">That's the problem. </span> <span class="line" data-startTime="607">So let's talk a little </span><span class="line" data-startTime="607">bit about the SDK. </span> <span class="line" data-startTime="609">The SDK itself allows for cross </span><span class="line" data-startTime="609">platform development on </span><span class="line" data-startTime="612">platforms for Linux, </span><span class="line" data-startTime="612">Windows and Mac. </span> <span class="line" data-startTime="615">And we do this through providing </span><span class="line" data-startTime="615">a simple command </span><span class="line" data-startTime="617">line GCC compiler. </span> <span class="line" data-startTime="618">So the compiler itself is just </span><span class="line" data-startTime="618">simple command line. </span> <span class="line" data-startTime="620">Everybody in here has probably </span><span class="line" data-startTime="620">used GCC at one time in your </span><span class="line" data-startTime="623">programming life. </span> <span class="line" data-startTime="624">We also provide a full set of </span><span class="line" data-startTime="624">working code examples so that </span><span class="line" data-startTime="627">you can actually see how to </span><span class="line" data-startTime="627">properly use Pepper and how to </span><span class="line" data-startTime="629">use Native Client and </span><span class="line" data-startTime="629">best practices </span><span class="line" data-startTime="630">involved with that process. </span></p>

<p><span class="line" data-startTime="632">And then in addition to that, we </span><span class="line" data-startTime="632">also provide debugging and </span><span class="line" data-startTime="635">profiling tools that </span><span class="line" data-startTime="635">are currently an </span><span class="line" data-startTime="637">AlphaRev of our SDK. </span> <span class="line" data-startTime="639">Now, this takes a little </span><span class="line" data-startTime="639">bit to understand. </span> <span class="line" data-startTime="641">So you need to know that when </span><span class="line" data-startTime="641">we generate these Native </span><span class="line" data-startTime="644">Client executables, the NEXE </span><span class="line" data-startTime="644">files, it's not your </span><span class="line" data-startTime="646">standard x86 code. </span> <span class="line" data-startTime="648">We've got a lot of paperwork </span><span class="line" data-startTime="648">that we're not going to talk </span><span class="line" data-startTime="650">about today so much. </span> <span class="line" data-startTime="653">It actually isn't an exe that </span><span class="line" data-startTime="653">you can just double click on </span><span class="line" data-startTime="656">your desktop and run. </span></p>

<p><span class="line" data-startTime="657">It's actually a modified </span><span class="line" data-startTime="657">DWARF file. </span> <span class="line" data-startTime="659">Right? </span></p>

<p class="speaker"><span class="line" data-starttime="660"><span class="speakerName">Noel Allen</span>: Correct. </span><span class="line" data-startTime="661">DWARF and ELF. </span></p>

<p class="speaker"><span class="line" data-starttime="661"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="662">Fantastic. </span> <span class="line" data-startTime="663">Which means that debugging </span><span class="line" data-startTime="663">systems work a little bit </span><span class="line" data-startTime="665">differently. </span> <span class="line" data-startTime="666">You don't have a PDB file </span><span class="line" data-startTime="666">full of symbols and </span><span class="line" data-startTime="668">all these other things. </span> <span class="line" data-startTime="669">It requires some massaging. </span> <span class="line" data-startTime="673">Now with these things in mind, </span><span class="line" data-startTime="673">let's talk about actually </span><span class="line" data-startTime="675">porting, because we've only </span><span class="line" data-startTime="675">got 47 minutes left. </span> <span class="line" data-startTime="677">And my hat is funny. </span> <span class="line" data-startTime="678">And I'm running on </span><span class="line" data-startTime="678">reserve power. </span> <span class="line" data-startTime="680">This isn't even plugged in. </span> <span class="line" data-startTime="684">If it was a perfect demo, </span><span class="line" data-startTime="684">we wouldn't do it. </span> <span class="line" data-startTime="687">So here's our plan </span><span class="line" data-startTime="687">of attack today. </span> <span class="line" data-startTime="688">First, what we're going to do </span><span class="line" data-startTime="688">is we're actually going to </span><span class="line" data-startTime="690">build as a Pepper </span><span class="line" data-startTime="690">plug-in first. </span> <span class="line" data-startTime="692">Pepper's a fantastic API, but </span><span class="line" data-startTime="692">we're going to actually ignore </span><span class="line" data-startTime="694">the Native Client part of the </span><span class="line" data-startTime="694">equation and just migrate over </span><span class="line" data-startTime="697">our platform-specific APIs over </span><span class="line" data-startTime="697">to the Pepper APIs first. </span> <span class="line" data-startTime="701">And then as a last step, we'll </span><span class="line" data-startTime="701">actually do the generation of </span><span class="line" data-startTime="704">the Native Client exe. </span> <span class="line" data-startTime="705">This allows us to actually use </span><span class="line" data-startTime="705">our plug-in system in an </span><span class="line" data-startTime="710">existing IDE of choice. </span></p>

<p><span class="line" data-startTime="711">So standard plug-in development </span><span class="line" data-startTime="711">is pretty much </span><span class="line" data-startTime="713">exposed in every </span><span class="line" data-startTime="713">IDE out there. </span> <span class="line" data-startTime="715">It's a standard loop. </span> <span class="line" data-startTime="716">You create a DLL or an SO. </span> <span class="line" data-startTime="718">The external application </span><span class="line" data-startTime="718">loads it up. </span> <span class="line" data-startTime="720">You can set break points, </span><span class="line" data-startTime="720">see memory, all </span><span class="line" data-startTime="722">this other fun stuff. </span> <span class="line" data-startTime="723">Now to facilitate this, and </span><span class="line" data-startTime="723">this is one of the biggest </span><span class="line" data-startTime="725">things that we learned in our </span><span class="line" data-startTime="725">failures that I mentioned </span><span class="line" data-startTime="727">earlier in this project, was </span><span class="line" data-startTime="727">that we really didn't have </span><span class="line" data-startTime="729">good integration into </span><span class="line" data-startTime="729">existing IDEs at the </span><span class="line" data-startTime="732">level we wanted to. </span> <span class="line" data-startTime="733">So today we're actually really </span><span class="line" data-startTime="733">excited to announce that we're </span><span class="line" data-startTime="735">actually providing a Visual </span><span class="line" data-startTime="735">Studio 2010 plug-in for Native </span><span class="line" data-startTime="738">Client and Pepper. </span></p>

<p><span class="line" data-startTime="739">And we'll actually </span><span class="line" data-startTime="739">provide this &mdash; </span><span class="line" data-startTime="741">Please. </span> <span class="line" data-startTime="741">Yes, applause. </span> <span class="line" data-startTime="742">Yeah. </span> <span class="line" data-startTime="743">That's cool. </span> <span class="line" data-startTime="745">Add-ins are awesome. </span> <span class="line" data-startTime="747">This will be available </span><span class="line" data-startTime="747">in the Pepper 22 SDK. </span> <span class="line" data-startTime="749">So if you guys go to GoNaCl.com, </span><span class="line" data-startTime="749">grab the SDK </span><span class="line" data-startTime="752">chain, you'll actually </span><span class="line" data-startTime="752">get a preview. </span> <span class="line" data-startTime="753">Because we actually </span><span class="line" data-startTime="753">have a few Peppers </span><span class="line" data-startTime="755">ahead of stable available. </span> <span class="line" data-startTime="757">Right? </span><span class="line" data-startTime="757">Canary builds and </span><span class="line" data-startTime="757">the other stuff. </span></p>

<p class="speaker"><span class="line" data-starttime="758"><span class="speakerName">Noel Allen</span>: Yes. </span></p>

<p class="speaker"><span class="line" data-starttime="758"><span class="speakerName">Colt McAnlis</span>: So this is </span><span class="line" data-startTime="758">actually available, and you </span><span class="line" data-startTime="760">guys can totally take </span><span class="line" data-startTime="760">a look at it. </span><span class="line" data-startTime="761">So we're really excited about </span><span class="line" data-startTime="761">that, because it really helps </span><span class="line" data-startTime="763">with ease of use. </span><span class="line" data-startTime="764">Now, what chef Noel is going </span><span class="line" data-startTime="764">to do today for us, can you </span><span class="line" data-startTime="768">walk us through some of the </span><span class="line" data-startTime="768">things that the add-in does </span><span class="line" data-startTime="771">inside of Visual Studio? </span></p>

<p class="speaker"><span class="line" data-starttime="771"><span class="speakerName">Noel Allen</span>: Sure. </span><span class="line" data-startTime="772">Absolutely. </span><span class="line" data-startTime="773">So I have already created some </span><span class="line" data-startTime="773">different configurations. </span><span class="line" data-startTime="777">We can see a Native Client </span><span class="line" data-startTime="777">configuration, a Pepper </span><span class="line" data-startTime="780">configuration, and the </span><span class="line" data-startTime="780">original Windows 32 </span><span class="line" data-startTime="782">configuration. </span><span class="line" data-startTime="783">So what the add-in is doing is </span><span class="line" data-startTime="783">we can go over here and &mdash; </span><span class="line" data-startTime="793">so the add-in drives </span><span class="line" data-startTime="793">the compiler. </span><span class="line" data-startTime="795">Now for the Pepper </span><span class="line" data-startTime="795">configuration, it's actually </span><span class="line" data-startTime="797">pretty straightforward. </span><span class="line" data-startTime="798">All we're actually going to </span><span class="line" data-startTime="798">do is convert from an </span><span class="line" data-startTime="801">executable to a DLL. </span><span class="line" data-startTime="803">So Chrome's going to load this </span><span class="line" data-startTime="803">and run it as a plug-in. </span><span class="line" data-startTime="807">Very little change. </span><span class="line" data-startTime="808">I'm just going to go ahead and </span><span class="line" data-startTime="808">point my Include Directories </span><span class="line" data-startTime="811">to the Pepper SDK. </span><span class="line" data-startTime="813">I'm going to create a macro for </span><span class="line" data-startTime="813">Pepper so that I know in </span><span class="line" data-startTime="817">my code which particular view </span><span class="line" data-startTime="817">of the code I'm looking at. </span><span class="line" data-startTime="821">And that's pretty much it. </span><span class="line" data-startTime="822">I'm ready to go. </span></p>

<p class="speaker"><span class="line" data-starttime="823"><span class="speakerName">Colt McAnlis</span>: OK. </span><span class="line" data-startTime="823">Fantastic. </span><span class="line" data-startTime="824">So you set up these properties, </span><span class="line" data-startTime="824">so you create the </span><span class="line" data-startTime="827">platform, and then </span><span class="line" data-startTime="827">you compile. </span><span class="line" data-startTime="828">And what happens here? </span></p>

<p class="speaker"><span class="line" data-starttime="829"><span class="speakerName">Noel Allen</span>: Right. </span><span class="line" data-startTime="830">So now I'm going to switch to </span><span class="line" data-startTime="830">the Pepper configuration, and </span><span class="line" data-startTime="832">I'm going to go ahead </span><span class="line" data-startTime="832">and re-launch. </span><span class="line" data-startTime="834">Now, I did actually do one other </span><span class="line" data-startTime="834">thing, which is for the </span><span class="line" data-startTime="837">sake of debugging, I set this </span><span class="line" data-startTime="837">up to launch Chrome for me. </span></p>

<p class="speaker"><span class="line" data-starttime="842"><span class="speakerName">Colt McAnlis</span>: Oh. </span><span class="line" data-startTime="843">Now, I see some other </span><span class="line" data-startTime="843">flags in there. </span><span class="line" data-startTime="844">Can you walk us through what </span><span class="line" data-startTime="844">exactly is going on? </span></p>

<p class="speaker"><span class="line" data-starttime="845"><span class="speakerName">Noel Allen</span>: Sure. </span><span class="line" data-startTime="846">So there's a couple flags in </span><span class="line" data-startTime="846">here that make things a little </span><span class="line" data-startTime="848">bit easier for you. </span><span class="line" data-startTime="849">So I am setting user data </span><span class="line" data-startTime="849">dir to not pollute </span><span class="line" data-startTime="852">my normal user settings. </span><span class="line" data-startTime="855">I have Incognito to let Chrome </span><span class="line" data-startTime="855">forget what I've done, so we </span><span class="line" data-startTime="859">don't actually get </span><span class="line" data-startTime="859">caching effects. </span><span class="line" data-startTime="861">And then, register </span><span class="line" data-startTime="861">Pepper plug-in. </span><span class="line" data-startTime="863">Here's the interesting one where </span><span class="line" data-startTime="863">I am telling Chrome, </span><span class="line" data-startTime="867">please load this plug-in, and </span><span class="line" data-startTime="867">then I want you to answer any </span><span class="line" data-startTime="872">request to the particular MIME </span><span class="line" data-startTime="872">type I have described here, </span><span class="line" data-startTime="875">which in this case is </span><span class="line" data-startTime="875">application xNaCl. </span></p>

<p class="speaker"><span class="line" data-starttime="878"><span class="speakerName">Colt McAnlis</span>: Interesting. </span><span class="line" data-startTime="879">So to be very clear about this, </span><span class="line" data-startTime="879">what happens is, any </span><span class="line" data-startTime="881">time Chrome actually encounters </span><span class="line" data-startTime="881">the MIME type </span><span class="line" data-startTime="883">application NaCl, it'll actually </span><span class="line" data-startTime="883">go load the Native </span><span class="line" data-startTime="885">Client exe and pass the </span><span class="line" data-startTime="885">data over to it. </span><span class="line" data-startTime="888">What this command line option </span><span class="line" data-startTime="888">allows us to do is override </span><span class="line" data-startTime="891">that process. </span><span class="line" data-startTime="891">And so instead of actually </span><span class="line" data-startTime="891">finding MIME type NaCl and </span><span class="line" data-startTime="895">running NaCl, it's going to </span><span class="line" data-startTime="895">run our plug-in instead. </span></p>

<p class="speaker"><span class="line" data-starttime="897"><span class="speakerName">Noel Allen</span>: Exactly. </span><span class="line" data-startTime="898">So we can go ahead </span><span class="line" data-startTime="898">and launch that. </span><span class="line" data-startTime="906">And it helps if I start </span><span class="line" data-startTime="906">the web server first. </span><span class="line" data-startTime="910">Always useful. </span><span class="line" data-startTime="913">All right. </span><span class="line" data-startTime="913">Now, it couldn't find </span><span class="line" data-startTime="913">the plug-in. </span></p>

<p class="speaker"><span class="line" data-starttime="917"><span class="speakerName">Colt McAnlis</span>: So why is it </span><span class="line" data-startTime="917">saying that, though? </span></p>

<p class="speaker"><span class="line" data-starttime="920"><span class="speakerName">Noel Allen</span>: Well, I am missing </span><span class="line" data-startTime="920">the components that let Pepper </span><span class="line" data-startTime="923">talk to the plug-in. </span></p>

<p class="speaker"><span class="line" data-starttime="925"><span class="speakerName">Colt McAnlis</span>: I see. </span><span class="line" data-startTime="926">So we had our Win32 codes. </span><span class="line" data-startTime="927">So even though we've compiled it </span><span class="line" data-startTime="927">as a DLL, we haven't added </span><span class="line" data-startTime="929">the hooks, the API hooks, </span><span class="line" data-startTime="929">for Pepper for </span><span class="line" data-startTime="931">Chrome to actually load. </span></p>

<p class="speaker"><span class="line" data-starttime="932"><span class="speakerName">Noel Allen</span>: Exactly. </span></p>

<p class="speaker"><span class="line" data-starttime="932"><span class="speakerName">Colt McAnlis</span>: So where </span><span class="line" data-startTime="932">do we get those, and </span><span class="line" data-startTime="933">how do we get those? </span></p>

<p class="speaker"><span class="line" data-starttime="934"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="934">Well, the easiest thing to do is </span><span class="line" data-startTime="934">I am just going to sit here </span><span class="line" data-startTime="938">and go over to one of the </span><span class="line" data-startTime="938">examples that we ship, and </span><span class="line" data-startTime="941">just copy and paste it in, </span><span class="line" data-startTime="941">so that I have all </span><span class="line" data-startTime="943">that start-up code. </span></p>

<p class="speaker"><span class="line" data-starttime="944"><span class="speakerName">Colt McAnlis</span>: I like </span><span class="line" data-startTime="944">your style. </span><span class="line" data-startTime="945">What is that they say? </span><span class="line" data-startTime="946">That good programmers code and </span><span class="line" data-startTime="946">great programmers reuse? </span><span class="line" data-startTime="949">I like it. </span></p>

<p class="speaker"><span class="line" data-starttime="950"><span class="speakerName">Noel Allen</span>: So if we take this </span><span class="line" data-startTime="950">Hello World example, And I'm </span><span class="line" data-startTime="955">going to select that, and paste </span><span class="line" data-startTime="955">it here into the bottom, </span><span class="line" data-startTime="960">and then run again. </span><span class="line" data-startTime="965">So now we can see the Hello </span><span class="line" data-startTime="965">World demo that </span><span class="line" data-startTime="967">ships with the SDK. </span></p>

<p class="speaker"><span class="line" data-starttime="968"><span class="speakerName">Colt McAnlis</span>: And then that's </span><span class="line" data-startTime="968">running in our existing code? </span></p>

<p class="speaker"><span class="line" data-starttime="970"><span class="speakerName">Noel Allen</span>: Correct. </span></p>

<p class="speaker"><span class="line" data-starttime="971"><span class="speakerName">Colt McAnlis</span>: So, but where'd </span><span class="line" data-startTime="971">the spinning cube go? </span></p>

<p class="speaker"><span class="line" data-starttime="973"><span class="speakerName">Noel Allen</span>: Well, we haven't </span><span class="line" data-startTime="973">called it yet. </span><span class="line" data-startTime="974">So we haven't actually called </span><span class="line" data-startTime="974">any of the original </span><span class="line" data-startTime="976">code that we had. </span></p>

<p class="speaker"><span class="line" data-starttime="977"><span class="speakerName">Colt McAnlis</span>: Can you? </span></p>

<p class="speaker"><span class="line" data-starttime="978"><span class="speakerName">Noel Allen</span>: I can do </span><span class="line" data-startTime="978">that real quick. </span></p>

<p class="speaker"><span class="line" data-starttime="979"><span class="speakerName">Colt McAnlis</span>: OK. </span><span class="line" data-startTime="979">You do that. </span><span class="line" data-startTime="980">Awesome. </span></p>

<p class="speaker"><span class="line" data-starttime="983"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="984">So if I come up here </span><span class="line" data-startTime="984">and just say &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="990"><span class="speakerName">Colt McAnlis</span>: Now, really quick </span><span class="line" data-startTime="990">while you're scrolling </span><span class="line" data-startTime="992">up here, what are these </span><span class="line" data-startTime="992">functions we're looking at? </span><span class="line" data-startTime="993">These are Pepper functions, </span><span class="line" data-startTime="993">right? </span></p>

<p class="speaker"><span class="line" data-starttime="994"><span class="speakerName">Noel Allen</span>: So these are </span><span class="line" data-startTime="994">Pepper functions. </span><span class="line" data-startTime="995">So as I said, there's three </span><span class="line" data-startTime="995">functions that we look at. </span><span class="line" data-startTime="999">We have a module initialization, </span><span class="line" data-startTime="999">we have an API </span><span class="line" data-startTime="1002">request, and we have a </span><span class="line" data-startTime="1002">shut down function. </span><span class="line" data-startTime="1006">One of the APIs that gets </span><span class="line" data-startTime="1006">requested is an </span><span class="line" data-startTime="1009">API for your interface. </span><span class="line" data-startTime="1010">So you're going to provide </span><span class="line" data-startTime="1010">functions that Chrome can call </span><span class="line" data-startTime="1013">into to do things. </span><span class="line" data-startTime="1015">And one of those is this Did </span><span class="line" data-startTime="1015">Create, which is very similar </span><span class="line" data-startTime="1018">to the regular Main function. </span><span class="line" data-startTime="1020">So from there I'm actually </span><span class="line" data-startTime="1020">going to call into the </span><span class="line" data-startTime="1025">original WinMain. </span><span class="line" data-startTime="1030">And now we've got our </span><span class="line" data-startTime="1030">box, but no alert. </span></p>

<p class="speaker"><span class="line" data-starttime="1033"><span class="speakerName">Colt McAnlis</span>: Interesting. </span><span class="line" data-startTime="1033">OK, so what we're seeing here </span><span class="line" data-startTime="1033">though is really cool, because </span><span class="line" data-startTime="1036">we're actually seeing Win32 code </span><span class="line" data-startTime="1036">running side by side as </span><span class="line" data-startTime="1039">launched from a plug-in </span><span class="line" data-startTime="1039">inside of Chrome. </span><span class="line" data-startTime="1042">So now we can call this code, </span><span class="line" data-startTime="1042">because we're actually running </span><span class="line" data-startTime="1044">on a Windows system. </span></p>

<p class="speaker"><span class="line" data-starttime="1045"><span class="speakerName">Noel Allen</span>: Exactly. </span></p>

<p class="speaker"><span class="line" data-starttime="1045"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="1047">So the goal here is to actually </span><span class="line" data-startTime="1047">get that spinning </span><span class="line" data-startTime="1049">cube running in the web page. </span> <span class="line" data-startTime="1049">So we've got all that </span><span class="line" data-startTime="1049">stuff set up. </span> <span class="line" data-startTime="1051">The next step for us is to </span><span class="line" data-startTime="1051">actually port over to Pepper. </span> <span class="line" data-startTime="1055">Now, when understanding the </span><span class="line" data-startTime="1055">Pepper API, it's important to </span><span class="line" data-startTime="1058">understand how an application </span><span class="line" data-startTime="1058">communicates with a plug-in to </span><span class="line" data-startTime="1062">kind of give a little </span><span class="line" data-startTime="1062">bit more visibility </span><span class="line" data-startTime="1063">into what it's doing. </span> <span class="line" data-startTime="1064">So let's say we've got our </span><span class="line" data-startTime="1064">Chrome, and let's say we've </span><span class="line" data-startTime="1066">got our plug-in. </span> <span class="line" data-startTime="1067">Chrome, of course, will call </span><span class="line" data-startTime="1067">init, like it did. </span> <span class="line" data-startTime="1069">And then the plug-in will </span><span class="line" data-startTime="1069">go do some processing. </span></p>

<p><span class="line" data-startTime="1071">Now, in order for the plug-in </span><span class="line" data-startTime="1071">to get a sort of persistent </span><span class="line" data-startTime="1073">heartbeat &mdash; </span><span class="line" data-startTime="1074">right, because this </span><span class="line" data-startTime="1074">is a plug-in. </span> <span class="line" data-startTime="1075">We can't just allow yourself </span><span class="line" data-startTime="1075">to go call code into it, </span><span class="line" data-startTime="1078">otherwise you'll never </span><span class="line" data-startTime="1078">receive execution </span><span class="line" data-startTime="1080">control back into Chrome. </span> <span class="line" data-startTime="1081">So once the plug-in's done, it </span><span class="line" data-startTime="1081">can actually tell Chrome, hey, </span><span class="line" data-startTime="1084">can you call me again in </span><span class="line" data-startTime="1084">10 minutes, or whenever </span><span class="line" data-startTime="1088">you get some time. </span> <span class="line" data-startTime="1089">And so what'll happen is </span><span class="line" data-startTime="1089">the plug-in, and Pepper </span><span class="line" data-startTime="1091">specifically, provides APIs </span><span class="line" data-startTime="1091">that allow you to push a </span><span class="line" data-startTime="1094">callback up into Chrome. </span></p>

<p><span class="line" data-startTime="1096">And then Chrome can run off, do </span><span class="line" data-startTime="1096">some processing, render a </span><span class="line" data-startTime="1099">web page, check your local </span><span class="line" data-startTime="1099">listings for cars and salty </span><span class="line" data-startTime="1104">pork products. </span> <span class="line" data-startTime="1106">And then when it gets around </span><span class="line" data-startTime="1106">to it, it can actually call </span><span class="line" data-startTime="1108">that callback, giving execution </span><span class="line" data-startTime="1110">control back your plug-in. </span> <span class="line" data-startTime="1111">And then of course, your plug-in </span><span class="line" data-startTime="1111">does some processing </span><span class="line" data-startTime="1113">and the cycle repeats. </span> <span class="line" data-startTime="1114">And this is as close as you </span><span class="line" data-startTime="1114">can get actually having a </span><span class="line" data-startTime="1117">while loop inside of Pepper </span><span class="line" data-startTime="1117">or inside of a plug-in. </span> <span class="line" data-startTime="1119">We allow you to get this </span><span class="line" data-startTime="1119">processing over time. </span> <span class="line" data-startTime="1124">Now, let's talk about a couple </span><span class="line" data-startTime="1124">road blocks you're going to </span><span class="line" data-startTime="1126">run into when working </span><span class="line" data-startTime="1126">with Pepper. </span> <span class="line" data-startTime="1127">First off, all of the APIs for </span><span class="line" data-startTime="1127">Pepper are non-blocking. </span></p>

<p><span class="line" data-startTime="1130">And you can see why </span><span class="line" data-startTime="1130">when looking at it </span><span class="line" data-startTime="1132">as a plug-in API. </span> <span class="line" data-startTime="1133">If one of these APIs were </span><span class="line" data-startTime="1133">blocking, what would occur is </span><span class="line" data-startTime="1137">that you can effectively stall </span><span class="line" data-startTime="1137">out all of Chrome, because </span><span class="line" data-startTime="1140">execution control goes into </span><span class="line" data-startTime="1140">the plug-in and then they, </span><span class="line" data-startTime="1143">Chrome, won't get any more time </span><span class="line" data-startTime="1143">slices to give to v8 or </span><span class="line" data-startTime="1146">anything else. </span> <span class="line" data-startTime="1147">And so you get that nice, </span><span class="line" data-startTime="1147">little aw snap </span><span class="line" data-startTime="1148">little sad face dude. </span> <span class="line" data-startTime="1150">My heart always breaks </span><span class="line" data-startTime="1150">when I see him. </span> <span class="line" data-startTime="1151">I'm like, aw, he's so sad. </span></p>

<p><span class="line" data-startTime="1153">Don't worry, the internet </span><span class="line" data-startTime="1153">is still there. </span> <span class="line" data-startTime="1155">Anyhow, second off is that </span><span class="line" data-startTime="1155">Pepper APIs can only be called </span><span class="line" data-startTime="1158">from the main thread. </span> <span class="line" data-startTime="1159">This is another restriction </span><span class="line" data-startTime="1159">that we enforce to ensure </span><span class="line" data-startTime="1162">stability and security </span><span class="line" data-startTime="1162">over time. </span> <span class="line" data-startTime="1164">And then finally, that there's </span><span class="line" data-startTime="1164">really no main loop in Pepper. </span> <span class="line" data-startTime="1167">As you can see, based upon the </span><span class="line" data-startTime="1167">APIs, that you can't actually </span><span class="line" data-startTime="1170">just create a while loop </span><span class="line" data-startTime="1170">and sit there and spin. </span> <span class="line" data-startTime="1172">Now, I want to point out that </span><span class="line" data-startTime="1172">this is sort of temporary </span><span class="line" data-startTime="1174">restrictions as of Pepper 21. </span> <span class="line" data-startTime="1177">The team is working very, very </span><span class="line" data-startTime="1177">hard at removing these </span><span class="line" data-startTime="1180">restrictions, including the </span><span class="line" data-startTime="1180">ability to call Pepper from </span><span class="line" data-startTime="1182">any thread in your environment, </span><span class="line" data-startTime="1182">which would be a </span><span class="line" data-startTime="1184">huge step forward for those of </span><span class="line" data-startTime="1184">you who've done development. </span> <span class="line" data-startTime="1188">So let's talk about the call </span><span class="line" data-startTime="1188">loop a little bit more, and </span><span class="line" data-startTime="1189">why exactly we didn't </span><span class="line" data-startTime="1189">see the plug-in, but </span><span class="line" data-startTime="1192">we did see the cube. </span> <span class="line" data-startTime="1193">So what exactly happened was </span><span class="line" data-startTime="1193">this, Chrome called init and </span><span class="line" data-startTime="1195">gave execution control </span><span class="line" data-startTime="1195">to the plug-in. </span></p>

<p><span class="line" data-startTime="1197">Well, the plug-in at that point </span><span class="line" data-startTime="1197">actually called into </span><span class="line" data-startTime="1199">Windows and said, hey, </span><span class="line" data-startTime="1199">let's go run this. </span> <span class="line" data-startTime="1201">Now, Windows being Windows code </span><span class="line" data-startTime="1201">effectively sucked up all </span><span class="line" data-startTime="1205">of the processing time. </span> <span class="line" data-startTime="1206">And we actually didn't ever give </span><span class="line" data-startTime="1206">execution control back </span><span class="line" data-startTime="1209">into Chrome. </span> <span class="line" data-startTime="1210">So WinMain has a little while </span><span class="line" data-startTime="1210">loop in there where it </span><span class="line" data-startTime="1213">processes events and message </span><span class="line" data-startTime="1213">pumps and everything else that </span><span class="line" data-startTime="1215">it passes to the window. </span> <span class="line" data-startTime="1216">And we were never actually </span><span class="line" data-startTime="1216">able to give </span><span class="line" data-startTime="1218">control back into Chrome. </span> <span class="line" data-startTime="1219">So we starved it out. </span></p>

<p><span class="line" data-startTime="1220">But you guys didn't see the aw </span><span class="line" data-startTime="1220">snap sad face, because we </span><span class="line" data-startTime="1224">didn't hit the time out </span><span class="line" data-startTime="1224">period for the demo. </span> <span class="line" data-startTime="1226">Our floppy hats kept </span><span class="line" data-startTime="1226">us from doing that. </span> <span class="line" data-startTime="1228">So in order to fix this though, </span><span class="line" data-startTime="1228">Chef Noel, Chef </span><span class="line" data-startTime="1231">Noelington III, can you show us </span><span class="line" data-startTime="1231">how you address this issue? </span></p>

<p class="speaker"><span class="line" data-starttime="1235"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="1236">So here are a couple of changes </span><span class="line" data-startTime="1236">that I'm making. </span><span class="line" data-startTime="1238">So we want to break that main </span><span class="line" data-startTime="1238">loop into two separate pieces, </span><span class="line" data-startTime="1242">the initialization piece </span><span class="line" data-startTime="1242">and the actual loop. </span><span class="line" data-startTime="1245">So I am going to ifdef out the </span><span class="line" data-startTime="1245">loop and instead put it in a </span><span class="line" data-startTime="1249">new function. </span><span class="line" data-startTime="1251">And I'm going to have that </span><span class="line" data-startTime="1251">function request to get more </span><span class="line" data-startTime="1254">execution time by asking Pepper, </span><span class="line" data-startTime="1254">please call on the </span><span class="line" data-startTime="1258">main thread this function </span><span class="line" data-startTime="1258">again at a later time. </span></p>

<p class="speaker"><span class="line" data-starttime="1261"><span class="speakerName">Colt McAnlis</span>: And so this is the </span><span class="line" data-startTime="1261">function that effectively </span><span class="line" data-startTime="1263">pushes the function pointer </span><span class="line" data-startTime="1263">back into Chrome. </span></p>

<p class="speaker"><span class="line" data-starttime="1265"><span class="speakerName">Noel Allen</span>: Correct. </span></p>

<p class="speaker"><span class="line" data-starttime="1266"><span class="speakerName">Colt McAnlis</span>: Excellent. </span><span class="line" data-startTime="1267">So then, what's this </span><span class="line" data-startTime="1267">look like? </span></p>

<p class="speaker"><span class="line" data-starttime="1269"><span class="speakerName">Noel Allen</span>: Well, let's </span><span class="line" data-startTime="1269">fire that up. </span></p>

<p class="speaker"><span class="line" data-starttime="1274"><span class="speakerName">Colt McAnlis</span>: So we get the pop </span><span class="line" data-startTime="1274">up and we get the cube. </span> <span class="line" data-startTime="1276">So the execution happened </span><span class="line" data-startTime="1276">side by side. </span> <span class="line" data-startTime="1278">Fantastic. </span> <span class="line" data-startTime="1279">So now that that's handled and </span><span class="line" data-startTime="1279">we know that we're actually </span><span class="line" data-startTime="1282">not stalling out Chrome and we </span><span class="line" data-startTime="1282">have execution control being </span><span class="line" data-startTime="1284">handed back to the main </span><span class="line" data-startTime="1284">application, let's actually </span><span class="line" data-startTime="1286">talk about loading files. </span> <span class="line" data-startTime="1288">Now, Native Client is an </span><span class="line" data-startTime="1288">internet technology, which </span><span class="line" data-startTime="1291">means that it's served from a </span><span class="line" data-startTime="1291">web server somewhere and the </span><span class="line" data-startTime="1293">client is going to make a </span><span class="line" data-startTime="1293">request to pull things down. </span> <span class="line" data-startTime="1295">Now, any time you have </span><span class="line" data-startTime="1295">communication between client </span><span class="line" data-startTime="1298">and server with a web browser &mdash; </span><span class="line" data-startTime="1298">we'll talk about </span><span class="line" data-startTime="1300">Chrome just to limit our scope </span><span class="line" data-startTime="1300">of discussion here &mdash; </span><span class="line" data-startTime="1303">when a page load request </span><span class="line" data-startTime="1303">occurs, Chrome, on your </span><span class="line" data-startTime="1305">behalf, will go ahead and fetch </span><span class="line" data-startTime="1305">specific files and store </span><span class="line" data-startTime="1308">them in Chrome's cache. </span></p>

<p><span class="line" data-startTime="1309">Which means it'll grab HTML </span><span class="line" data-startTime="1309">files, it'll grab NEXE files </span><span class="line" data-startTime="1313">and the Native Client Manifest </span><span class="line" data-startTime="1313">file, the NMF file. </span> <span class="line" data-startTime="1315">Now, this'll be stored </span><span class="line" data-startTime="1315">in the cache on your </span><span class="line" data-startTime="1316">behalf, which is fantastic. </span> <span class="line" data-startTime="1318">Because if you have executable </span><span class="line" data-startTime="1318">code sitting on a server </span><span class="line" data-startTime="1321">somewhere, it's probably </span><span class="line" data-startTime="1321">between the </span><span class="line" data-startTime="1323">range of 5 to 13 megabytes. </span> <span class="line" data-startTime="1325">And you don't want the user to </span><span class="line" data-startTime="1325">have to keep grabbing that </span><span class="line" data-startTime="1327">code and pulling it down every </span><span class="line" data-startTime="1327">time they hit refresh. </span> <span class="line" data-startTime="1329">Now, the bad part about this, </span><span class="line" data-startTime="1329">though, is that Chrome won't </span><span class="line" data-startTime="1332">go fetch all of those other </span><span class="line" data-startTime="1332">files which are usually </span><span class="line" data-startTime="1334">required by your application. </span> <span class="line" data-startTime="1336">You've usually got a bunch </span><span class="line" data-startTime="1336">of binary data. </span> <span class="line" data-startTime="1338">If you're a game developer, </span><span class="line" data-startTime="1338">you've got textures, assets, </span><span class="line" data-startTime="1341">map data, XML information, all </span><span class="line" data-startTime="1341">this other sort of stuff. </span> <span class="line" data-startTime="1344">Now, to grab that data &mdash; </span><span class="line" data-startTime="1346">that's specifically what we're </span><span class="line" data-startTime="1346">going to focus on today &mdash; </span><span class="line" data-startTime="1348">Pepper provides an API </span><span class="line" data-startTime="1348">called GetURL. </span></p>

<p><span class="line" data-startTime="1351">GetURL, again being an internet </span><span class="line" data-startTime="1351">technology, says, </span><span class="line" data-startTime="1356">hey, here's a URL, go fetch </span><span class="line" data-startTime="1356">me the bits of this. </span> <span class="line" data-startTime="1358">So in JavaScript, this would </span><span class="line" data-startTime="1358">be equivalent to </span><span class="line" data-startTime="1360">an XHR, XHTTP request. </span> <span class="line" data-startTime="1362">So everyone in here is </span><span class="line" data-startTime="1362">a net developer. </span> <span class="line" data-startTime="1364">You should grock that. </span> <span class="line" data-startTime="1366">I see one head nodding. </span> <span class="line" data-startTime="1367">I like your style. </span> <span class="line" data-startTime="1369">Can I nod with this and </span><span class="line" data-startTime="1369">that actually work? </span><span class="line" data-startTime="1371">Maybe. </span> <span class="line" data-startTime="1371">Everyone on YouTube </span><span class="line" data-startTime="1371">just jumped. </span> <span class="line" data-startTime="1373">Cool. </span> <span class="line" data-startTime="1374">In addition to that, because </span><span class="line" data-startTime="1374">you can actually pull down </span><span class="line" data-startTime="1376">this data, again, that's not </span><span class="line" data-startTime="1376">cached on your behalf. </span></p>

<p><span class="line" data-startTime="1379">So you actually have to have </span><span class="line" data-startTime="1379">an answer for that. </span> <span class="line" data-startTime="1381">Because, again, if the user </span><span class="line" data-startTime="1381">reloads your page, you're </span><span class="line" data-startTime="1383">going to have to go grab another </span><span class="line" data-startTime="1383">40 megs worth of data </span><span class="line" data-startTime="1385">every time they do that. </span> <span class="line" data-startTime="1386">To address this, Pepper actually </span><span class="line" data-startTime="1386">provides another API </span><span class="line" data-startTime="1388">called the FileStore API. </span> <span class="line" data-startTime="1390">So you can actually grab your </span><span class="line" data-startTime="1390">data and write it to the </span><span class="line" data-startTime="1392">Persistent Sandbox file </span><span class="line" data-startTime="1392">storage on disk. </span> <span class="line" data-startTime="1394">This way, when the user closes </span><span class="line" data-startTime="1394">Chrome, reloads the page, goes </span><span class="line" data-startTime="1398">on vacation for 15 days, that </span><span class="line" data-startTime="1398">data will still stay on disk </span><span class="line" data-startTime="1402">that you can pick up </span><span class="line" data-startTime="1402">and grab later. </span> <span class="line" data-startTime="1403">So this is a great place </span><span class="line" data-startTime="1403">to put save state, user </span><span class="line" data-startTime="1406">preferences that you may not </span><span class="line" data-startTime="1406">want to sync to the cloud, or </span><span class="line" data-startTime="1409">just, again, the 80 megs of </span><span class="line" data-startTime="1409">binary data that's needed for </span><span class="line" data-startTime="1413">your application. </span> <span class="line" data-startTime="1414">Now, one thing we talked about </span><span class="line" data-startTime="1414">earlier was that the Pepper </span><span class="line" data-startTime="1418">APIs are non-blocking. </span></p>

<p><span class="line" data-startTime="1420">So for all of you who have used </span><span class="line" data-startTime="1420">fread, we can't use that </span><span class="line" data-startTime="1423">in Native Client, because that </span><span class="line" data-startTime="1423">would actually stall the </span><span class="line" data-startTime="1425">system, wouldn't relinquish </span><span class="line" data-startTime="1425">control back to Chrome. </span> <span class="line" data-startTime="1428">So we actually don't allow </span><span class="line" data-startTime="1428">you to use that command. </span> <span class="line" data-startTime="1429">You have to use GetURL. </span> <span class="line" data-startTime="1431">And any of you who have done </span><span class="line" data-startTime="1431">asynchronous file loading know </span><span class="line" data-startTime="1433">what this looks like. </span> <span class="line" data-startTime="1434">Effectively, we have </span><span class="line" data-startTime="1434">an init phase. </span> <span class="line" data-startTime="1436">The init phase will kick off an </span><span class="line" data-startTime="1436">open URL command to Chrome </span><span class="line" data-startTime="1441">and say, hey, go </span><span class="line" data-startTime="1441">load some data. </span> <span class="line" data-startTime="1443">Then our plug-in will actually </span><span class="line" data-startTime="1443">go into a loader loop phase. </span> <span class="line" data-startTime="1446">What we're going to do is we're </span><span class="line" data-startTime="1447">effectively going to spin &mdash; </span><span class="line" data-startTime="1448">well, we can't exactly spin, but </span><span class="line" data-startTime="1448">we're going to go through </span><span class="line" data-startTime="1450">a process of allowing Chrome to </span><span class="line" data-startTime="1450">do call on main thread and </span><span class="line" data-startTime="1453">allowing the plug-in to </span><span class="line" data-startTime="1453">relinquish control, gain </span><span class="line" data-startTime="1456">control, et cetera, et cetera, </span><span class="line" data-startTime="1456">until Chrome actually tells us </span><span class="line" data-startTime="1458">the file has actually </span><span class="line" data-startTime="1458">been opened. </span> <span class="line" data-startTime="1460">Chrome will signal to us and </span><span class="line" data-startTime="1460">give us a specific call. </span> <span class="line" data-startTime="1463">Once we've received the file </span><span class="line" data-startTime="1463">open command, we then can </span><span class="line" data-startTime="1465">issue a read bytes and say, hey, </span><span class="line" data-startTime="1465">you've opened the file. </span></p>

<p><span class="line" data-startTime="1467">Please give me some data. </span> <span class="line" data-startTime="1469">And then we can continue this </span><span class="line" data-startTime="1469">loop until the data's actually </span><span class="line" data-startTime="1471">been fetched. </span> <span class="line" data-startTime="1471">And this is the standard loader </span><span class="line" data-startTime="1471">loop that we're going </span><span class="line" data-startTime="1473">to work through here. </span> <span class="line" data-startTime="1474">Once the data's been fetched or </span><span class="line" data-startTime="1474">pre-loaded everything, you </span><span class="line" data-startTime="1477">can then move on to your actual </span><span class="line" data-startTime="1477">render loop and start </span><span class="line" data-startTime="1479">drawing the cube </span><span class="line" data-startTime="1479">on the screen. </span> <span class="line" data-startTime="1481">So you haven't seen that </span><span class="line" data-startTime="1481">one yet, have you? </span></p>

<p class="speaker"><span class="line" data-starttime="1484"><span class="speakerName">Noel Allen</span>: You know I'm </span><span class="line" data-startTime="1484">allergic to fish. </span></p>

<p class="speaker"><span class="line" data-starttime="1486"><span class="speakerName">Colt McAnlis</span>: Really? </span><span class="line" data-startTime="1487">That makes it even awesomer. </span></p>

<p class="speaker"><span class="line" data-starttime="1487"><span class="speakerName">Noel Allen</span>: I'm going to itch. </span></p>

<p class="speaker"><span class="line" data-starttime="1489"><span class="speakerName">Colt McAnlis</span>: So by the way, </span><span class="line" data-startTime="1489">don't Google man hugging fish. </span><span class="line" data-startTime="1493">Different sort of results </span><span class="line" data-startTime="1493">that you get there. </span><span class="line" data-startTime="1496">Anyhow, your royal majesty </span><span class="line" data-startTime="1496">Noelington Chefton III, can </span><span class="line" data-startTime="1502">you please walk us through what </span><span class="line" data-startTime="1502">this FileIO asynchronous </span><span class="line" data-startTime="1506">stuff looks like in our demo. </span></p>

<p class="speaker"><span class="line" data-starttime="1507"><span class="speakerName">Noel Allen</span>: Sure. </span> <span class="line" data-startTime="1509">So what we're going to do is </span><span class="line" data-startTime="1509">we are going to request for </span><span class="line" data-startTime="1516">these assets to get loaded </span><span class="line" data-startTime="1516">in the background. </span> <span class="line" data-startTime="1518">And we're going to do that by </span><span class="line" data-startTime="1518">first issuing an Open, as you </span><span class="line" data-startTime="1525">described, which is basically </span><span class="line" data-startTime="1525">a Get request to the asset. </span> <span class="line" data-startTime="1530">Once that open completes, it's </span><span class="line" data-startTime="1530">going to call us back. </span> <span class="line" data-startTime="1533">And then in that callback </span><span class="line" data-startTime="1533">function, we're going to </span><span class="line" data-startTime="1535">record the size of the object </span><span class="line" data-startTime="1535">that we're getting, we're </span><span class="line" data-startTime="1538">going to allocate memory for </span><span class="line" data-startTime="1538">it, and then we're going to </span><span class="line" data-startTime="1541">start reading bites. </span> <span class="line" data-startTime="1542">And again, this happens </span><span class="line" data-startTime="1542">as a callback. </span></p>

<p><span class="line" data-startTime="1544">So every time we get some bites </span><span class="line" data-startTime="1544">back, we're then going </span><span class="line" data-startTime="1547">to call this other function, </span><span class="line" data-startTime="1547">which is going to store it in </span><span class="line" data-startTime="1552">that block of memory </span><span class="line" data-startTime="1552">that I allocated. </span> <span class="line" data-startTime="1555">And eventually, when I get </span><span class="line" data-startTime="1555">enough of it, I'm going to go </span><span class="line" data-startTime="1558">ahead and give myself a </span><span class="line" data-startTime="1558">call back to let me </span><span class="line" data-startTime="1560">know that it's there. </span> <span class="line" data-startTime="1562">And when it's there, I'm simply </span><span class="line" data-startTime="1562">going to increment a </span><span class="line" data-startTime="1565">global counter that says, hey, </span><span class="line" data-startTime="1565">I got another asset. </span></p>

<p class="speaker"><span class="line" data-starttime="1567"><span class="speakerName">Colt McAnlis</span>: Now, to be very </span><span class="line" data-startTime="1567">clear, we know that all of you </span><span class="line" data-startTime="1570">have very sophisticated code </span><span class="line" data-startTime="1570">bases, and asynchronous file </span><span class="line" data-startTime="1572">loading is probably part of your </span><span class="line" data-startTime="1572">general platform library. </span> <span class="line" data-startTime="1575">We are not at all advocating </span><span class="line" data-startTime="1575">this as best practices for </span><span class="line" data-startTime="1578">loading files on the internet. </span> <span class="line" data-startTime="1579">Please write a good asset </span><span class="line" data-startTime="1579">manager with mutexes and </span><span class="line" data-startTime="1582">callbacks and everything else. </span> <span class="line" data-startTime="1583">Don't just use a counter. </span> <span class="line" data-startTime="1584">That's really just a bad idea. </span> <span class="line" data-startTime="1586">Sorry. </span> <span class="line" data-startTime="1586">I had to give the disclaimer, </span><span class="line" data-startTime="1586">otherwise it'll show up like, </span><span class="line" data-startTime="1589">Google says you should just use </span><span class="line" data-startTime="1589">a counter to load all of </span><span class="line" data-startTime="1591">your files with Native Client. </span></p>

<p class="speaker"><span class="line" data-starttime="1592"><span class="speakerName">Noel Allen</span>: Yes. </span><span class="line" data-startTime="1592">Well the ugly counter hack </span><span class="line" data-startTime="1592">is, in fact, right here. </span><span class="line" data-startTime="1597">We're going to call the </span><span class="line" data-startTime="1597">initialization programs. </span><span class="line" data-startTime="1599">I've changed this main loop. </span><span class="line" data-startTime="1601">So we do the initialization. </span><span class="line" data-startTime="1604">And then once we actually </span><span class="line" data-startTime="1604">discover three assets, then </span><span class="line" data-startTime="1606">we're going to switch </span><span class="line" data-startTime="1606">to rendering. </span><span class="line" data-startTime="1608">But in either case, we're just </span><span class="line" data-startTime="1608">going to go back and ask for </span><span class="line" data-startTime="1612">more processing time </span><span class="line" data-startTime="1612">every time we go </span><span class="line" data-startTime="1613">through the loop as normal. </span></p>

<p class="speaker"><span class="line" data-starttime="1614"><span class="speakerName">Colt McAnlis</span>: So effectively, </span><span class="line" data-startTime="1614">if we haven't loaded it yet, </span><span class="line" data-startTime="1616">we still submit our call on </span><span class="line" data-startTime="1616">main thread so we can get </span><span class="line" data-startTime="1618">processing in the future to </span><span class="line" data-startTime="1618">determine if it's all loaded? </span></p>

<p class="speaker"><span class="line" data-starttime="1620"><span class="speakerName">Noel Allen</span>: Correct. </span></p>

<p class="speaker"><span class="line" data-starttime="1621"><span class="speakerName">Colt McAnlis</span>: And then once the </span><span class="line" data-startTime="1621">things are loaded, we go </span><span class="line" data-startTime="1623">to our render loop </span><span class="line" data-startTime="1623">at that point. </span></p>

<p class="speaker"><span class="line" data-starttime="1624"><span class="speakerName">Noel Allen</span>: Exactly. </span></p>

<p class="speaker"><span class="line" data-starttime="1624"><span class="speakerName">Colt McAnlis</span>: And so </span><span class="line" data-startTime="1624">this has changed. </span><span class="line" data-startTime="1626">Let's see this live. </span></p>

<p class="speaker"><span class="line" data-starttime="1631"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="1632">So it looks much the same. </span><span class="line" data-startTime="1634">But if we go over here and look </span><span class="line" data-startTime="1634">at the web server, you </span><span class="line" data-startTime="1638">can see that originally </span><span class="line" data-startTime="1638">we were getting &mdash; </span><span class="line" data-startTime="1643">hold on. </span><span class="line" data-startTime="1644">Ran the wrong file. </span></p>

<p class="speaker"><span class="line" data-starttime="1648"><span class="speakerName">Colt McAnlis</span>: Stop it. </span><span class="line" data-startTime="1649">Stop it all. </span><span class="line" data-startTime="1649">Hit buttons. </span></p>

<p class="speaker"><span class="line" data-starttime="1650"><span class="speakerName">Noel Allen</span>: Please stop. </span></p>

<p class="speaker"><span class="line" data-starttime="1651"><span class="speakerName">Colt McAnlis</span>: Click more. </span><span class="line" data-startTime="1653">Panic click. </span><span class="line" data-startTime="1654">Panic click. </span><span class="line" data-startTime="1655">Take evasive action. </span><span class="line" data-startTime="1656">Scatter. </span></p>

<p class="speaker"><span class="line" data-starttime="1657"><span class="speakerName">Noel Allen</span>: You're not </span><span class="line" data-startTime="1657">being helpful. </span></p>

<p class="speaker"><span class="line" data-starttime="1658"><span class="speakerName">Colt McAnlis</span>: I know. </span></p>

<p class="speaker"><span class="line" data-starttime="1659"><span class="speakerName">Noel Allen</span>: I want you to know, </span><span class="line" data-startTime="1660">you're not being helpful. </span><span class="line" data-startTime="1661">So as we can see here, we now </span><span class="line" data-startTime="1661">actually see the requests for </span><span class="line" data-startTime="1666">those assets coming into </span><span class="line" data-startTime="1666">the web server. </span><span class="line" data-startTime="1669">So we have successfully moved </span><span class="line" data-startTime="1669">over to serving the </span><span class="line" data-startTime="1671">data from the web. </span></p>

<p class="speaker"><span class="line" data-starttime="1672"><span class="speakerName">Colt McAnlis</span>: Awesome. </span><span class="line" data-startTime="1673">So as a Pepper plug-in, we were </span><span class="line" data-startTime="1673">actually able to just use </span><span class="line" data-startTime="1675">fread and actually </span><span class="line" data-startTime="1675">load the data. </span><span class="line" data-startTime="1677">But as part of the Pepper API, </span><span class="line" data-startTime="1677">you can see that we're </span><span class="line" data-startTime="1679">fetching it right </span><span class="line" data-startTime="1679">from the server. </span><span class="line" data-startTime="1682">You need to nod with </span><span class="line" data-startTime="1682">authority. </span></p>

<p class="speaker"><span class="line" data-starttime="1684"><span class="speakerName">Noel Allen</span>: Is my hat </span><span class="line" data-startTime="1684">not correctly &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="1685"><span class="speakerName">Colt McAnlis</span>: Well, you have </span><span class="line" data-startTime="1685">hair, and so it keeps it from </span><span class="line" data-startTime="1687">sliding around. </span> <span class="line" data-startTime="1687">That my problem, is </span><span class="line" data-startTime="1687">the balding thing. </span> <span class="line" data-startTime="1691">So once we've got a rendering </span><span class="line" data-startTime="1691">with our simple example, the </span><span class="line" data-startTime="1693">next step is actually to get us </span><span class="line" data-startTime="1693">porting from OpenGL, which </span><span class="line" data-startTime="1696">is desktop GL, to GLES2, which </span><span class="line" data-startTime="1696">is the API that we provide in </span><span class="line" data-startTime="1699">Native Client that allows you to </span><span class="line" data-startTime="1699">do fancy rendering of cube </span><span class="line" data-startTime="1702">with arrow texture. </span> <span class="line" data-startTime="1704">I really think we should have </span><span class="line" data-startTime="1704">done the other demo. </span> <span class="line" data-startTime="1706">You should have fixed stuff </span><span class="line" data-startTime="1706">instead of playing with your </span><span class="line" data-startTime="1707">new hardware. </span> <span class="line" data-startTime="1708">So what we're going to do today </span><span class="line" data-startTime="1708">is we're not going to </span><span class="line" data-startTime="1710">talk about the actual porting </span><span class="line" data-startTime="1710">process of GL to GLES. </span></p>

<p><span class="line" data-startTime="1713">There's a lot of documentation </span><span class="line" data-startTime="1713">out there on how to actually </span><span class="line" data-startTime="1716">do this process. </span> <span class="line" data-startTime="1717">GLES2.0 is very dominant on </span><span class="line" data-startTime="1717">mobile devices right now. </span> <span class="line" data-startTime="1721">And if you just Google </span><span class="line" data-startTime="1721">for &mdash; don't Google </span><span class="line" data-startTime="1722">for man hugs fish. </span> <span class="line" data-startTime="1723">Instead, Google for desktop GL2, </span><span class="line" data-startTime="1723">GLES2, you'll find much </span><span class="line" data-startTime="1726">more useful information </span><span class="line" data-startTime="1726">in that process. </span> <span class="line" data-startTime="1728">We are going to note a couple </span><span class="line" data-startTime="1728">things that are different </span><span class="line" data-startTime="1730">between the two. </span> <span class="line" data-startTime="1731">Just so if you've never </span><span class="line" data-startTime="1731">actually dealt with </span><span class="line" data-startTime="1733">OpenGLES2.0, you're aware of </span><span class="line" data-startTime="1733">some of the things you're </span><span class="line" data-startTime="1735">going to run into </span><span class="line" data-startTime="1735">moving forward. </span> <span class="line" data-startTime="1737">First off, they are not </span><span class="line" data-startTime="1737">the same thing. </span> <span class="line" data-startTime="1739">The predominant one is that </span><span class="line" data-startTime="1739">GLES2 could be considered a </span><span class="line" data-startTime="1742">subset of GL. </span> <span class="line" data-startTime="1743">The most shocking change there </span><span class="line" data-startTime="1743">is that GLES2.0 has no fixed </span><span class="line" data-startTime="1748">function of support. </span></p>

<p><span class="line" data-startTime="1748">So in order to draw a polygon or </span><span class="line" data-startTime="1748">set some state or even get </span><span class="line" data-startTime="1752">a texture on screen, you have to </span><span class="line" data-startTime="1752">provide a vertex shader and </span><span class="line" data-startTime="1755">a pixel shader. </span> <span class="line" data-startTime="1756">If you've never written a </span><span class="line" data-startTime="1756">vertex shader or a pixel </span><span class="line" data-startTime="1757">shader, don't worry. </span> <span class="line" data-startTime="1758">The internet can help you. </span> <span class="line" data-startTime="1759">Which I find I need on </span><span class="line" data-startTime="1759">my business card. </span> <span class="line" data-startTime="1761">Don't worry. </span> <span class="line" data-startTime="1761">The internet can help you. </span> <span class="line" data-startTime="1764">In addition to that, there's </span><span class="line" data-startTime="1764">a different shader syntax. </span> <span class="line" data-startTime="1766">When you actually do write your </span><span class="line" data-startTime="1766">shader for the system, </span><span class="line" data-startTime="1768">because standard GL does support </span><span class="line" data-startTime="1768">shaders, the syntax </span><span class="line" data-startTime="1771">itself is different. </span> <span class="line" data-startTime="1772">So you have to set different </span><span class="line" data-startTime="1772">precision values for your </span><span class="line" data-startTime="1776">pixel shaders, as well as some </span><span class="line" data-startTime="1776">other nuances with how you </span><span class="line" data-startTime="1779">handle skinning and constant </span><span class="line" data-startTime="1779">register access. </span></p>

<p><span class="line" data-startTime="1783">And probably one of the </span><span class="line" data-startTime="1783">interesting things is because </span><span class="line" data-startTime="1785">GLES2.0 is actually a subset of </span><span class="line" data-startTime="1785">GL, some things that you'd </span><span class="line" data-startTime="1789">normally have to go to GL and </span><span class="line" data-startTime="1789">fetch extensions for you no </span><span class="line" data-startTime="1792">longer have to. </span> <span class="line" data-startTime="1793">So with standard desktop GL, you </span><span class="line" data-startTime="1793">would have to go grab an </span><span class="line" data-startTime="1796">extension to actually do </span><span class="line" data-startTime="1796">multiple render targets or to </span><span class="line" data-startTime="1799">do deferred rendering or some </span><span class="line" data-startTime="1799">other interesting things. </span> <span class="line" data-startTime="1802">With GLES2, a lot of that </span><span class="line" data-startTime="1802">stuff is just provided </span><span class="line" data-startTime="1804">natively, which is fantastic. </span> <span class="line" data-startTime="1807">There is one API we're going to </span><span class="line" data-startTime="1807">talk about today, though. </span> <span class="line" data-startTime="1810">And this is really the only </span><span class="line" data-startTime="1810">thing that's Pepper specific </span><span class="line" data-startTime="1813">in the translation </span><span class="line" data-startTime="1813">from GL to GLES. </span> <span class="line" data-startTime="1816">And that is a function </span><span class="line" data-startTime="1816">called SwapBuffers. </span> <span class="line" data-startTime="1818">So what happens is, when you're </span><span class="line" data-startTime="1818">doing your render loop </span><span class="line" data-startTime="1820">you're going to render some </span><span class="line" data-startTime="1820">polygons, you're going to set </span><span class="line" data-startTime="1823">some textures, blow up some </span><span class="line" data-startTime="1823">aliens, do really cool stuff. </span> <span class="line" data-startTime="1826">From there, you're actually </span><span class="line" data-startTime="1826">going to call </span><span class="line" data-startTime="1827">the SwapBuffers API. </span></p>

<p><span class="line" data-startTime="1828">Now typically, what SwapBuffers </span><span class="line" data-startTime="1828">will do with the </span><span class="line" data-startTime="1831">GL API is it'll actually trigger </span><span class="line" data-startTime="1831">off a command to the </span><span class="line" data-startTime="1835">device driver and to the GPU to </span><span class="line" data-startTime="1835">swap the front screen with </span><span class="line" data-startTime="1839">the back screen. </span> <span class="line" data-startTime="1840">So when you actually do your </span><span class="line" data-startTime="1840">rendering, all of the commands </span><span class="line" data-startTime="1842">are actually compositing to a </span><span class="line" data-startTime="1842">buffer that's not currently </span><span class="line" data-startTime="1845">displayed to the user. </span> <span class="line" data-startTime="1846">And the swap screen command </span><span class="line" data-startTime="1846">tells it to say, hey, swap it </span><span class="line" data-startTime="1849">so the user can see the work </span><span class="line" data-startTime="1849">that you've all done. </span> <span class="line" data-startTime="1851">The SwapBuffers command provided </span><span class="line" data-startTime="1851">with Pepper, part of </span><span class="line" data-startTime="1855">our header suite, actually </span><span class="line" data-startTime="1855">contains a function that </span><span class="line" data-startTime="1860">allows you to actually kick </span><span class="line" data-startTime="1860">off your callback. </span> <span class="line" data-startTime="1862">So typically, like we said </span><span class="line" data-startTime="1862">before, you're going to need </span><span class="line" data-startTime="1864">to use a call on main thread so </span><span class="line" data-startTime="1864">that sometime in the future </span><span class="line" data-startTime="1867">you'll get called again. </span> <span class="line" data-startTime="1869">The SwapBuffers API sort of </span><span class="line" data-startTime="1869">encapsulates these two </span><span class="line" data-startTime="1872">concepts into a single call. </span> <span class="line" data-startTime="1873">So you can actually kick off </span><span class="line" data-startTime="1873">your SwapBuffer call as well </span><span class="line" data-startTime="1876">as push your function pointer </span><span class="line" data-startTime="1876">back into Chrome. </span></p>

<p><span class="line" data-startTime="1878">Now, if you're doing rendering, </span><span class="line" data-startTime="1878">you should consider </span><span class="line" data-startTime="1880">this the end of your </span><span class="line" data-startTime="1880">Pepper frame. </span> <span class="line" data-startTime="1882">Because if you've called </span><span class="line" data-startTime="1882">SwapBuffers it's time to </span><span class="line" data-startTime="1884">relinquish control </span><span class="line" data-startTime="1884">off to Chrome. </span> <span class="line" data-startTime="1886">Chrome's going to do some cool </span><span class="line" data-startTime="1886">stuff, fix the internet, make </span><span class="line" data-startTime="1888">everything amazing, and </span><span class="line" data-startTime="1888">do it really fast. </span> <span class="line" data-startTime="1891">And then eventually it'll come </span><span class="line" data-startTime="1891">back and call your function, </span><span class="line" data-startTime="1893">because you've passed it off. </span> <span class="line" data-startTime="1894">And that's your start </span><span class="line" data-startTime="1894">of your frame again. </span> <span class="line" data-startTime="1896">So this is really the </span><span class="line" data-startTime="1896">only difference. </span> <span class="line" data-startTime="1898">Everything else is a standard </span><span class="line" data-startTime="1898">GL to GLES port. </span> <span class="line" data-startTime="1901">This is the one thing you </span><span class="line" data-startTime="1901">need to be aware of. </span></p>

<p><span class="line" data-startTime="1903">So we're not talking </span><span class="line" data-startTime="1903">about GL to GLES. </span> <span class="line" data-startTime="1907">So this is the chopped onions </span><span class="line" data-startTime="1907">part of the talk. </span> <span class="line" data-startTime="1910">We're not going to walk you </span><span class="line" data-startTime="1910">through that change. </span> <span class="line" data-startTime="1911">We've already got it live. </span> <span class="line" data-startTime="1913">Can you show us what </span><span class="line" data-startTime="1913">that looks like? </span></p>

<p class="speaker"><span class="line" data-starttime="1913"><span class="speakerName">Noel Allen</span>: Sure thing. </span><span class="line" data-startTime="1916">So here is the change that we </span><span class="line" data-startTime="1916">discussed, the SwapBuffer. </span><span class="line" data-startTime="1919">And I am going to go </span><span class="line" data-startTime="1919">ahead and run this. </span></p>

<p class="speaker"><span class="line" data-starttime="1929"><span class="speakerName">Colt McAnlis</span>: Very cool. </span><span class="line" data-startTime="1930">So we're actually running </span><span class="line" data-startTime="1930">in the web page. </span></p>

<p class="speaker"><span class="line" data-starttime="1931"><span class="speakerName">Noel Allen</span>: We now have our </span><span class="line" data-startTime="1931">cube in the web page. </span></p>

<p class="speaker"><span class="line" data-starttime="1934"><span class="speakerName">Colt McAnlis</span>: Very cool. </span><span class="line" data-startTime="1935">I like that. </span><span class="line" data-startTime="1936">So now, quick question here. </span><span class="line" data-startTime="1937">If we actually are creating a </span><span class="line" data-startTime="1937">Pepper plug-in, and we can </span><span class="line" data-startTime="1941">actually get it to run in the </span><span class="line" data-startTime="1941">web page like this and do full </span><span class="line" data-startTime="1943">graphics and high precision </span><span class="line" data-startTime="1943">timing and everything, why are </span><span class="line" data-startTime="1946">we even messing with NaCl? </span><span class="line" data-startTime="1948">Why don't we just ship </span><span class="line" data-startTime="1948">a Pepper plug-in </span><span class="line" data-startTime="1950">and that's our product? </span></p>

<p class="speaker"><span class="line" data-starttime="1951"><span class="speakerName">Noel Allen</span>: Well first, Chrome </span><span class="line" data-startTime="1951">isn't going to let you just </span><span class="line" data-startTime="1953">load some random plug-in. </span><span class="line" data-startTime="1956">Native code is kind of an ugly, </span><span class="line" data-startTime="1956">unsafe thing, so we want </span><span class="line" data-startTime="1961">to make sure that we take </span><span class="line" data-startTime="1961">care of it correctly. </span><span class="line" data-startTime="1963">So in order to use that C and </span><span class="line" data-startTime="1963">C++ code, you're going to want </span><span class="line" data-startTime="1967">to ship that as a NEXE so that </span><span class="line" data-startTime="1967">you get that extra protection. </span></p>

<p class="speaker"><span class="line" data-starttime="1971"><span class="speakerName">Colt McAnlis</span>: So you're saying </span><span class="line" data-startTime="1971">that me downloading an </span><span class="line" data-startTime="1974">arbitrary plug-in from Bob's </span><span class="line" data-startTime="1974">hugging fish website is not </span><span class="line" data-startTime="1977">necessarily a safe </span><span class="line" data-startTime="1977">thing to do? </span></p>

<p class="speaker"><span class="line" data-starttime="1978"><span class="speakerName">Noel Allen</span>: Yes. </span><span class="line" data-startTime="1979">Especially not the websites </span><span class="line" data-startTime="1979">you go to. </span></p>

<p class="speaker"><span class="line" data-starttime="1981"><span class="speakerName">Colt McAnlis</span>: Let's edit that </span><span class="line" data-startTime="1981">part out of YouTube, please. </span> <span class="line" data-startTime="1985">So the next step then, since </span><span class="line" data-startTime="1985">we actually don't want to </span><span class="line" data-startTime="1987">provide just a plug-in to the </span><span class="line" data-startTime="1987">masses, because, again, </span><span class="line" data-startTime="1989">that'll come back to the point, </span><span class="line" data-startTime="1989">the user will get that </span><span class="line" data-startTime="1991">really nasty pop-up that says, </span><span class="line" data-startTime="1991">hey, Bob's Hugging Fish </span><span class="line" data-startTime="1994">Basement would really </span><span class="line" data-startTime="1994">like to install some </span><span class="line" data-startTime="1996">things on your computer. </span> <span class="line" data-startTime="1997">Which, never click OK to that. </span> <span class="line" data-startTime="1998">What we're going to do now is </span><span class="line" data-startTime="1998">we're actually going to do the </span><span class="line" data-startTime="1999">final step of our process of </span><span class="line" data-startTime="1999">creating our lamb sorbet and </span><span class="line" data-startTime="2003">actually go and compile our </span><span class="line" data-startTime="2003">code with Native Client, </span><span class="line" data-startTime="2005">generating the proper NEXE files </span><span class="line" data-startTime="2005">that can be distributed </span><span class="line" data-startTime="2008">on the internet. </span> <span class="line" data-startTime="2009">So now, recall this graph here </span><span class="line" data-startTime="2009">is that Native Client is a </span><span class="line" data-startTime="2012">plug-in that's provided with </span><span class="line" data-startTime="2012">Chrome that allows external </span><span class="line" data-startTime="2015">compiled code to effectively </span><span class="line" data-startTime="2015">call the APIs that allow </span><span class="line" data-startTime="2019">secure sandbox execution to </span><span class="line" data-startTime="2019">lower-level system resources. </span></p>

<p><span class="line" data-startTime="2023">Now, the add-in for Visual </span><span class="line" data-startTime="2023">Studio provides some specific </span><span class="line" data-startTime="2029">nuances that we should </span><span class="line" data-startTime="2029">talk about here. </span> <span class="line" data-startTime="2030">What the Visual Studio plug-in </span><span class="line" data-startTime="2030">does at this point in time, </span><span class="line" data-startTime="2033">because debugging and profiling </span><span class="line" data-startTime="2033">support is still in </span><span class="line" data-startTime="2036">alpha, the add-in actually </span><span class="line" data-startTime="2036">doesn't allow you to set break </span><span class="line" data-startTime="2038">points and do debugging inside </span><span class="line" data-startTime="2038">of Native Client. </span> <span class="line" data-startTime="2040">Yet. </span> <span class="line" data-startTime="2041">That's coming soon. </span> <span class="line" data-startTime="2042">Stay tuned. </span> <span class="line" data-startTime="2043">Follow me on G+. </span> <span class="line" data-startTime="2045">What it does now though is </span><span class="line" data-startTime="2045">it'll actually scrape the </span><span class="line" data-startTime="2047">Visual Studio properties on </span><span class="line" data-startTime="2047">your behalf and create the </span><span class="line" data-startTime="2050">proper command line that's </span><span class="line" data-startTime="2050">required to send off to GCC. </span></p>

<p><span class="line" data-startTime="2053">GCC, of course, will then </span><span class="line" data-startTime="2053">produce the NEXE from our SDK </span><span class="line" data-startTime="2057">and then output any information </span><span class="line" data-startTime="2057">for command line </span><span class="line" data-startTime="2059">errors or processes back </span><span class="line" data-startTime="2059">to Visual Studio. </span> <span class="line" data-startTime="2062">So the good thing is if you are </span><span class="line" data-startTime="2062">a Visual Studio developer, </span><span class="line" data-startTime="2064">you've got a lot of legacy code </span><span class="line" data-startTime="2064">there, this allows you to </span><span class="line" data-startTime="2067">operate and compile with Native </span><span class="line" data-startTime="2067">Client in a way that </span><span class="line" data-startTime="2069">feels very natural to you, save </span><span class="line" data-startTime="2069">for the break points and </span><span class="line" data-startTime="2073">the debugging. </span> <span class="line" data-startTime="2073">But again, that's in alpha. </span> <span class="line" data-startTime="2074">We're working very </span><span class="line" data-startTime="2074">hard on that. </span> <span class="line" data-startTime="2075">Right, Noel? </span></p>

<p class="speaker"><span class="line" data-starttime="2076"><span class="speakerName">Noel Allen</span>: Exactly. </span></p>

<p class="speaker"><span class="line" data-starttime="2076"><span class="speakerName">Colt McAnlis</span>: Noel's actually </span><span class="line" data-startTime="2076">the guy heading that up. </span><span class="line" data-startTime="2078">Right? </span></p>

<p class="speaker"><span class="line" data-starttime="2078"><span class="speakerName">Noel Allen</span>: Yes. </span></p>

<p class="speaker"><span class="line" data-starttime="2079"><span class="speakerName">Colt McAnlis</span>: Your hat is </span><span class="line" data-startTime="2079">heading that up, actually. </span></p>

<p class="speaker"><span class="line" data-starttime="2080"><span class="speakerName">Noel Allen</span>: My hat </span><span class="line" data-startTime="2080">is in charge. </span></p>

<p class="speaker"><span class="line" data-starttime="2082"><span class="speakerName">Colt McAnlis</span>: Your hat is </span><span class="line" data-startTime="2082">in charge of debugging. </span><span class="line" data-startTime="2084">It's still floppy. </span><span class="line" data-startTime="2085">I don't know what to do. </span><span class="line" data-startTime="2089">Anyhow, this is actually my </span><span class="line" data-startTime="2089">favorite picture in the deck, </span><span class="line" data-startTime="2091">by the way. </span></p>

<p class="speaker"><span class="line" data-starttime="2091"><span class="speakerName">Noel Allen</span>: Thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="2094"><span class="speakerName">Colt McAnlis</span>: It's </span><span class="line" data-startTime="2094">the salt head. </span><span class="line" data-startTime="2095">We did a rehearsal of this a </span><span class="line" data-startTime="2095">couple weeks ago, and someone </span><span class="line" data-startTime="2097">said, you should probably </span><span class="line" data-startTime="2097">Photoshop some </span><span class="line" data-startTime="2098">salt shakers in there. </span><span class="line" data-startTime="2099">And I was like, well, </span><span class="line" data-startTime="2099">here's a salt head. </span><span class="line" data-startTime="2102">So part of our add-in allows </span><span class="line" data-startTime="2102">the Pepper configuration as </span><span class="line" data-startTime="2106">well as the NaCl </span><span class="line" data-startTime="2106">configuration. </span><span class="line" data-startTime="2107">So can you show us the NaCl </span><span class="line" data-startTime="2107">config and what it does? </span></p>

<p class="speaker"><span class="line" data-starttime="2110"><span class="speakerName">Noel Allen</span>: Absolutely. </span><span class="line" data-startTime="2112">OK. </span><span class="line" data-startTime="2113">So again from the add-in that </span><span class="line" data-startTime="2113">you'll get in Pepper 22, you </span><span class="line" data-startTime="2116">can go ahead and set up for a </span><span class="line" data-startTime="2116">Native Client configuration. </span><span class="line" data-startTime="2121">And as Colt said, this is </span><span class="line" data-startTime="2121">going to drive that GCC </span><span class="line" data-startTime="2124">toolchain for you. </span><span class="line" data-startTime="2126">And then we have the </span><span class="line" data-startTime="2126">standard settings. </span><span class="line" data-startTime="2129">Again, I'm going to use Chrome </span><span class="line" data-startTime="2129">as the application that I'm </span><span class="line" data-startTime="2132">actually going to run. </span><span class="line" data-startTime="2134">And I am going to set some </span><span class="line" data-startTime="2134">additional flags. </span><span class="line" data-startTime="2137">I'm going to set my include </span><span class="line" data-startTime="2137">directories. </span><span class="line" data-startTime="2139">I'm going to set my </span><span class="line" data-startTime="2139">library paths. </span><span class="line" data-startTime="2142">All the standard things </span><span class="line" data-startTime="2142">that you would set </span><span class="line" data-startTime="2147">for using an SDK. </span><span class="line" data-startTime="2150">And we can take a </span><span class="line" data-startTime="2150">look at that. </span></p>

<p class="speaker"><span class="line" data-starttime="2152"><span class="speakerName">Colt McAnlis</span>: So now, once you </span><span class="line" data-startTime="2152">create the configuration is </span><span class="line" data-startTime="2156">there anything else? </span><span class="line" data-startTime="2156">Or can we actually </span><span class="line" data-startTime="2156">just run live? </span><span class="line" data-startTime="2158">Will it do a lot of automation </span><span class="line" data-startTime="2158">for you? </span></p>

<p class="speaker"><span class="line" data-starttime="2159"><span class="speakerName">Noel Allen</span>: Well, what'll end </span><span class="line" data-startTime="2159">up happening is if we try to </span><span class="line" data-startTime="2161">run it right now, we still have </span><span class="line" data-startTime="2161">that Windows window and </span><span class="line" data-startTime="2165">some other stuff that </span><span class="line" data-startTime="2165">we need to clean up. </span><span class="line" data-startTime="2166">So we'd actually get a lot of </span><span class="line" data-startTime="2166">compile errors or link errors </span><span class="line" data-startTime="2169">or whatnot. </span><span class="line" data-startTime="2170">So we still have to get rid of </span><span class="line" data-startTime="2170">those platform specific things </span><span class="line" data-startTime="2173">to Windows. </span></p>

<p class="speaker"><span class="line" data-starttime="2174"><span class="speakerName">Colt McAnlis</span>: OK. </span><span class="line" data-startTime="2175">Let's take a look at that. </span><span class="line" data-startTime="2176">Or at least, can you point </span><span class="line" data-startTime="2176">them out or make </span><span class="line" data-startTime="2177">[? the right ?] </span><span class="line" data-startTime="2177">change, or &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="2178"><span class="speakerName">Noel Allen</span>: Sure. </span> <span class="line" data-startTime="2178">So let me show you the changes </span><span class="line" data-startTime="2178">that we had to do here. </span> <span class="line" data-startTime="2181">So we need to obviously no </span><span class="line" data-startTime="2181">longer include the Windows </span><span class="line" data-startTime="2185">header, because that's </span><span class="line" data-startTime="2185">not going to work, </span><span class="line" data-startTime="2187">or the Windows libraries. </span> <span class="line" data-startTime="2190">We need to stop calling main, </span><span class="line" data-startTime="2190">because that had a lot of </span><span class="line" data-startTime="2193">Windows code in it. </span> <span class="line" data-startTime="2194">So instead, we just call the </span><span class="line" data-startTime="2195">initialization function directly. </span> <span class="line" data-startTime="2197">And we need to no longer use </span><span class="line" data-startTime="2197">those old GL calls and things </span><span class="line" data-startTime="2203">that were pointing to screen </span><span class="line" data-startTime="2203">resolution and things like </span><span class="line" data-startTime="2207">that that were described </span><span class="line" data-startTime="2207">in Windows, so </span><span class="line" data-startTime="2209">basically the WGL calls. </span></p>

<p class="speaker"><span class="line" data-starttime="2210"><span class="speakerName">Colt McAnlis</span>: Got it. </span></p>

<p class="speaker"><span class="line" data-starttime="2212"><span class="speakerName">Noel Allen</span>: So once those have </span><span class="line" data-startTime="2212">all been ifdeffed out, then </span><span class="line" data-startTime="2215">we're actually ready to </span><span class="line" data-startTime="2215">make that change. </span></p>

<p class="speaker"><span class="line" data-starttime="2217"><span class="speakerName">Colt McAnlis</span>: Cool. </span><span class="line" data-startTime="2217">So we've converted all of our </span><span class="line" data-startTime="2217">stuff over to Pepper. </span><span class="line" data-startTime="2220">So we're using those </span><span class="line" data-startTime="2220">API calls. </span><span class="line" data-startTime="2222">We've also removed any platform </span><span class="line" data-startTime="2222">specific code from </span><span class="line" data-startTime="2225">our application at this point. </span><span class="line" data-startTime="2226">That's the good thing. </span><span class="line" data-startTime="2227">And so now we can </span><span class="line" data-startTime="2227">actually run &mdash; ? </span></p>

<p class="speaker"><span class="line" data-starttime="2229"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="2229">So this is the Pepper version. </span><span class="line" data-startTime="2231">And now I'm going to switch to </span><span class="line" data-startTime="2231">the Native Client version. </span><span class="line" data-startTime="2236">Rebuild, and you can see in </span><span class="line" data-startTime="2236">the output window the </span><span class="line" data-startTime="2240">toolchain running. </span><span class="line" data-startTime="2242">And now we have the cube </span><span class="line" data-startTime="2242">actually running as a Native </span><span class="line" data-startTime="2245">Client module. </span></p>

<p class="speaker"><span class="line" data-starttime="2246"><span class="speakerName">Colt McAnlis</span>: Fantastic. </span><span class="line" data-startTime="2247">Perfect. </span><span class="line" data-startTime="2248">That's cool. </span></p>

<p class="speaker"><span class="line" data-starttime="2250"><span class="speakerName">Noel Allen</span>: And you can </span><span class="line" data-startTime="2250">see the load is </span><span class="line" data-startTime="2254">right here of the NEXE. </span></p>

<p class="speaker"><span class="line" data-starttime="2255"><span class="speakerName">Colt McAnlis</span>: Excellent. </span><span class="line" data-startTime="2256">Excellent. </span><span class="line" data-startTime="2256">So now with the Visual </span><span class="line" data-startTime="2256">Studio plug-in &mdash; </span><span class="line" data-startTime="2259">because we want to empower </span><span class="line" data-startTime="2259">developers to do great </span><span class="line" data-startTime="2261">things &mdash; you can actually swap </span><span class="line" data-startTime="2261">back and run the original </span><span class="line" data-startTime="2263">Win32 as well still. </span><span class="line" data-startTime="2264">Right? </span></p>

<p class="speaker"><span class="line" data-starttime="2265"><span class="speakerName">Noel Allen</span>: Exactly. </span><span class="line" data-startTime="2266">So the Windows 32 version </span><span class="line" data-startTime="2266">is still available. </span><span class="line" data-startTime="2268">So I will switch back to that. </span><span class="line" data-startTime="2273">And here we are. </span></p>

<p class="speaker"><span class="line" data-starttime="2276"><span class="speakerName">Colt McAnlis</span>: Really? </span><span class="line" data-startTime="2282">You honestly went to my G+ </span><span class="line" data-startTime="2282">stream and pulled down a </span><span class="line" data-startTime="2284">picture of me eating barbecue </span><span class="line" data-startTime="2284">in Austin, Texas? </span></p>

<p class="speaker"><span class="line" data-starttime="2286"><span class="speakerName">Noel Allen</span>: You put </span><span class="line" data-startTime="2286">it up there. </span><span class="line" data-startTime="2287">Anybody can get access to it. </span><span class="line" data-startTime="2288">What do you want? </span></p>

<p class="speaker"><span class="line" data-starttime="2292"><span class="speakerName">Colt McAnlis</span>: There's </span><span class="line" data-startTime="2292">a great &mdash; </span><span class="line" data-startTime="2294">you didn't do this yesterday. </span><span class="line" data-startTime="2296">OK. </span><span class="line" data-startTime="2296">Awesome. </span><span class="line" data-startTime="2297">That's a great barbecue place </span><span class="line" data-startTime="2297">in Austin, Texas. </span><span class="line" data-startTime="2299">I highly recommend </span><span class="line" data-startTime="2299">you going to it. </span><span class="line" data-startTime="2303">Stop going to my G+ page. </span><span class="line" data-startTime="2305">I'm going to put you in </span><span class="line" data-startTime="2305">a separate Circle. </span><span class="line" data-startTime="2307">You don't get any access </span><span class="line" data-startTime="2307">to photos. </span><span class="line" data-startTime="2310">I lost myself. </span><span class="line" data-startTime="2310">What are we talking about? </span><span class="line" data-startTime="2312">OK. </span><span class="line" data-startTime="2312">Win32. </span><span class="line" data-startTime="2313">So this is the original </span><span class="line" data-startTime="2313">Win32 application. </span><span class="line" data-startTime="2315">Fantastic. </span><span class="line" data-startTime="2317">OK. </span><span class="line" data-startTime="2317">It's mesmerizing. </span></p>

<p class="speaker"><span class="line" data-starttime="2319"><span class="speakerName">Noel Allen</span>: Actually, </span><span class="line" data-startTime="2319">I find it a </span><span class="line" data-startTime="2321">little disturbing, myself. </span></p>

<p class="speaker"><span class="line" data-starttime="2323"><span class="speakerName">Colt McAnlis</span>: I'm very </span><span class="line" data-startTime="2323">disturbed right now. </span> <span class="line" data-startTime="2325">So, fantastic. </span> <span class="line" data-startTime="2326">So we've done the port. </span> <span class="line" data-startTime="2327">We actually have, according to </span><span class="line" data-startTime="2327">that timer back there, we've </span><span class="line" data-startTime="2329">got 20 minutes left. </span> <span class="line" data-startTime="2330">So even with me blathering on </span><span class="line" data-startTime="2330">about all this other stuff </span><span class="line" data-startTime="2332">about Native Client, we've been </span><span class="line" data-startTime="2332">able to chop some onions, </span><span class="line" data-startTime="2334">dice some things up. </span> <span class="line" data-startTime="2335">The power of the Visual Studio </span><span class="line" data-startTime="2335">add-in actually propelled us </span><span class="line" data-startTime="2338">to do a lot of these things &mdash; </span><span class="line" data-startTime="2340">do it in a faster manner. </span> <span class="line" data-startTime="2341">A lot of the heavy lifting </span><span class="line" data-startTime="2341">was done by the add-in. </span> <span class="line" data-startTime="2345">Pepper was really the hard place </span><span class="line" data-startTime="2345">that we had to do some </span><span class="line" data-startTime="2347">API conversions. </span></p>

<p><span class="line" data-startTime="2348">Now, what we didn't talk about </span><span class="line" data-startTime="2348">today was anything under the </span><span class="line" data-startTime="2352">hood of Native Client. </span> <span class="line" data-startTime="2353">Today's talk has been </span><span class="line" data-startTime="2353">specifically focusing on the </span><span class="line" data-startTime="2356">developer side of things. </span> <span class="line" data-startTime="2357">Now, if you're interested in </span><span class="line" data-startTime="2357">what Native Client is doing </span><span class="line" data-startTime="2360">under the hood, to make sure </span><span class="line" data-startTime="2360">that you can run native code </span><span class="line" data-startTime="2363">in a browser with the same </span><span class="line" data-startTime="2363">security and safety as </span><span class="line" data-startTime="2366">JavaScript, I highly recommend </span><span class="line" data-startTime="2366">you check out Nick Bray's talk </span><span class="line" data-startTime="2369">on Life of Native Client </span><span class="line" data-startTime="2369">Instruction. </span> <span class="line" data-startTime="2371">It's happening today, in fact. </span> <span class="line" data-startTime="2373">He is actually going to pull </span><span class="line" data-startTime="2373">back the mask of running x86 </span><span class="line" data-startTime="2376">code in the web and talk about </span><span class="line" data-startTime="2376">all the bad things it can do </span><span class="line" data-startTime="2379">and how Native Client addresses </span><span class="line" data-startTime="2379">those issues. </span></p>

<p><span class="line" data-startTime="2381">So I highly recommend checking </span><span class="line" data-startTime="2381">out his talk. </span> <span class="line" data-startTime="2384">So what did we learn today? </span><span class="line" data-startTime="2385">Let's talk about this, </span><span class="line" data-startTime="2385">the leftovers. </span> <span class="line" data-startTime="2387">So develop as a Pepper </span><span class="line" data-startTime="2387">plug-in first. </span> <span class="line" data-startTime="2390">This is going to allow you </span><span class="line" data-startTime="2390">to use your existing IDE. </span> <span class="line" data-startTime="2393">It's going to allow you to </span><span class="line" data-startTime="2393">develop as a plug-in, which a </span><span class="line" data-startTime="2395">lot of developers are </span><span class="line" data-startTime="2395">familiar with. </span> <span class="line" data-startTime="2398">And it's going to allow you to </span><span class="line" data-startTime="2398">use the debugger properly. </span></p>

<p><span class="line" data-startTime="2400">Now, again you can use debugging </span><span class="line" data-startTime="2400">and profiling with </span><span class="line" data-startTime="2402">Native Client, but they're </span><span class="line" data-startTime="2402">very alpha right now. </span> <span class="line" data-startTime="2404">So if you're used to using </span><span class="line" data-startTime="2404">Visual Studio all the time, </span><span class="line" data-startTime="2408">you're probably going to have </span><span class="line" data-startTime="2408">a lot of teeth gnashing in </span><span class="line" data-startTime="2409">that process. </span> <span class="line" data-startTime="2410">Instead, use your IDE, get </span><span class="line" data-startTime="2410">everything ported over to </span><span class="line" data-startTime="2412">Pepper, make your big </span><span class="line" data-startTime="2412">code changes there. </span> <span class="line" data-startTime="2416">Never underestimate the power </span><span class="line" data-startTime="2416">of a good platform wrapper. </span> <span class="line" data-startTime="2418">Right? </span><span class="line" data-startTime="2418">Because all the platform code </span><span class="line" data-startTime="2418">that effectively you're using </span><span class="line" data-startTime="2421">for Pepper, you should properly </span><span class="line" data-startTime="2421">abstract out. </span> <span class="line" data-startTime="2424">So when you're about to jump in </span><span class="line" data-startTime="2424">the code and be like, I'm </span><span class="line" data-startTime="2425">going to do Native Client, </span><span class="line" data-startTime="2425">stop, hammer </span><span class="line" data-startTime="2428">time, think about it. </span></p>

<p><span class="line" data-startTime="2429">And then write a good wrapper </span><span class="line" data-startTime="2429">so you can actually maintain </span><span class="line" data-startTime="2432">your backward compatibility to </span><span class="line" data-startTime="2432">the other [? SKUs ?] that </span><span class="line" data-startTime="2434">you're targeting. </span> <span class="line" data-startTime="2435">We ported FileIO. </span> <span class="line" data-startTime="2437">We ported GL to GLES. </span> <span class="line" data-startTime="2439">And then we remove all of our </span><span class="line" data-startTime="2439">platform specific stuff from </span><span class="line" data-startTime="2441">NaCl, and we did it with really </span><span class="line" data-startTime="2441">cool looking hats. </span> <span class="line" data-startTime="2444">I'm still amazed you </span><span class="line" data-startTime="2444">found these. </span> <span class="line" data-startTime="2447">And with that, we're </span><span class="line" data-startTime="2447">done with the port. </span> <span class="line" data-startTime="2449">I'm Colt McAnlis. </span></p>

<p class="speaker"><span class="line" data-starttime="2450"><span class="speakerName">Noel Allen</span>: I'm Noel Allen. </span></p>

<p class="speaker"><span class="line" data-starttime="2450"><span class="speakerName">Colt McAnlis</span>: That's porting </span><span class="line" data-startTime="2450">in 60 minutes. </span><span class="line" data-startTime="2452">And we'll open the floor for </span><span class="line" data-startTime="2452">some questions right now. </span><span class="line" data-startTime="2458">You did good. </span><span class="line" data-startTime="2461">I don't know if I </span><span class="line" data-startTime="2461">should curtsy. </span></p>

<p class="speaker"><span class="line" data-starttime="2462"><span class="speakerName">Noel Allen</span>: I don't </span><span class="line" data-startTime="2462">do that funny bow. </span><span class="line" data-startTime="2464">I'd probably just </span><span class="line" data-startTime="2464">fall right over. </span></p>

<p class="speaker"><span class="line" data-starttime="2465"><span class="speakerName">Colt McAnlis</span>: Probably. </span><span class="line" data-startTime="2465">We're a little bit top heavy. </span><span class="line" data-startTime="2466">So there's some microphones </span><span class="line" data-startTime="2466">here. </span><span class="line" data-startTime="2468">If you've got some questions, </span><span class="line" data-startTime="2468">please feel free to speak up. </span><span class="line" data-startTime="2471">Yes, sir. </span><span class="line" data-startTime="2472">No, the guy behind you. </span><span class="line" data-startTime="2473">No, I'm just messing with you. </span><span class="line" data-startTime="2474">Sorry. </span><span class="line" data-startTime="2475">The hat, it gives me power. </span></p>

<p class="speaker"><span class="line" data-starttime="2477"><span class="speakerName">Audience</span>: I was wondering if </span><span class="line" data-startTime="2477">there are any plans to be able </span><span class="line" data-startTime="2480">to target Pepper to native </span><span class="line" data-startTime="2480">binaries so that I could use </span><span class="line" data-startTime="2484">the same APIs for deploying to </span><span class="line" data-startTime="2484">NaCl and to deploying to just </span><span class="line" data-startTime="2488">an application running on </span><span class="line" data-startTime="2488">there and not have that, </span><span class="line" data-startTime="2491">ifdeffed out Win32 code. </span></p>

<p class="speaker"><span class="line" data-starttime="2493"><span class="speakerName">Colt McAnlis</span>: That's actually </span><span class="line" data-startTime="2493">a great question. </span><span class="line" data-startTime="2495">I'm going to let </span><span class="line" data-startTime="2495">you field this. </span></p>

<p class="speaker"><span class="line" data-starttime="2497"><span class="speakerName">Noel Allen</span>: Actually, could </span><span class="line" data-startTime="2497">you repeat that again? </span><span class="line" data-startTime="2499">I'm not sure exactly what </span><span class="line" data-startTime="2499">you were asking there. </span><span class="line" data-startTime="2501">Can you take a binary that's </span><span class="line" data-startTime="2501">already compiled? </span></p>

<p class="speaker"><span class="line" data-starttime="2504"><span class="speakerName">Audience</span>: So no. </span><span class="line" data-startTime="2505">So the question is you've been </span><span class="line" data-startTime="2505">porting the app to use these </span><span class="line" data-startTime="2508">Pepper APIs instead of using </span><span class="line" data-startTime="2508">the native Windows APIs. </span><span class="line" data-startTime="2512">Is there any plans to create </span><span class="line" data-startTime="2512">kind of a wrapper that is the </span><span class="line" data-startTime="2516">Pepper API but it targets </span><span class="line" data-startTime="2516">Windows functions instead of </span><span class="line" data-startTime="2519">the Chrome functions? </span></p>

<p class="speaker"><span class="line" data-starttime="2520"><span class="speakerName">Colt McAnlis</span>: So we could use </span><span class="line" data-startTime="2520">fread, and under the hood it </span><span class="line" data-startTime="2521">would do the right </span><span class="line" data-startTime="2521">Pepper thing. </span></p>

<p class="speaker"><span class="line" data-starttime="2522"><span class="speakerName">Audience</span>: Right. </span></p>

<p class="speaker"><span class="line" data-starttime="2523"><span class="speakerName">Noel Allen</span>: Gotcha. </span> <span class="line" data-startTime="2524">Yes. </span> <span class="line" data-startTime="2524">So actually, there's some stuff </span><span class="line" data-startTime="2524">already out there that </span><span class="line" data-startTime="2528">other people have developed. </span> <span class="line" data-startTime="2530">But we are actually putting in </span><span class="line" data-startTime="2530">a subset of that into the SDK </span><span class="line" data-startTime="2533">as we speak. </span> <span class="line" data-startTime="2535">So you can expect to see things </span><span class="line" data-startTime="2535">like pthread wrappers, </span><span class="line" data-startTime="2539">access to fread open, closed, </span><span class="line" data-startTime="2539">the standard POSIX-y things, </span><span class="line" data-startTime="2544">except running in Win32 so that </span><span class="line" data-startTime="2544">you can take that Native </span><span class="line" data-startTime="2548">Client application and then run </span><span class="line" data-startTime="2548">it as a Pepper plug-in so </span><span class="line" data-startTime="2551">that you can do your </span><span class="line" data-startTime="2551">development </span><span class="line" data-startTime="2553">a little bit easier. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2557"><span class="speakerName">Audience</span>: So the question I have </span><span class="line" data-startTime="2557">is about the transition </span><span class="line" data-startTime="2559">from the no sandbox </span><span class="line" data-startTime="2559">to the sandbox. </span><span class="line" data-startTime="2562">So basically, obviously, since </span><span class="line" data-startTime="2562">you are using Windows calls, </span><span class="line" data-startTime="2565">you used the no sandbox call </span><span class="line" data-startTime="2565">initially when you just made </span><span class="line" data-startTime="2569">it a Pepper plug-in. </span><span class="line" data-startTime="2573">So where does the transition </span><span class="line" data-startTime="2573">happen? </span><span class="line" data-startTime="2574">So when you actually make it a </span><span class="line" data-startTime="2574">NEXE and when you download it, </span><span class="line" data-startTime="2579">is it that the MIME type is </span><span class="line" data-startTime="2579">handled by the Native Client? </span><span class="line" data-startTime="2584">Where does the transition </span><span class="line" data-startTime="2584">to the sandbox happen? </span><span class="line" data-startTime="2586">When you ran it finally, </span><span class="line" data-startTime="2586">did you also </span><span class="line" data-startTime="2588">run it with no sandbox? </span></p>

<p class="speaker"><span class="line" data-starttime="2589"><span class="speakerName">Noel Allen</span>: OK. </span><span class="line" data-startTime="2590">So what the no sandbox does </span><span class="line" data-startTime="2590">is it takes out that </span><span class="line" data-startTime="2594">outer Chrome sandbox. </span></p>

<p class="speaker"><span class="line" data-starttime="2595"><span class="speakerName">Audience</span>: I know what </span><span class="line" data-startTime="2595">no sandbox does. </span></p>

<p class="speaker"><span class="line" data-starttime="2596"><span class="speakerName">Noel Allen</span>: I was just </span><span class="line" data-startTime="2596">explaining it </span><span class="line" data-startTime="2598">for everybody else. </span></p>

<p class="speaker"><span class="line" data-starttime="2599"><span class="speakerName">Colt McAnlis</span>: There's a lot of </span><span class="line" data-startTime="2599">other people in the room who </span><span class="line" data-startTime="2600">may not know. </span></p>

<p class="speaker"><span class="line" data-starttime="2601"><span class="speakerName">Noel Allen</span>: But what that outer </span><span class="line" data-startTime="2601">sandbox does is it gives </span><span class="line" data-startTime="2605">you that OS protection. </span><span class="line" data-startTime="2606">So it interferes with things </span><span class="line" data-startTime="2606">like debugging. </span><span class="line" data-startTime="2609">So I have the no sandbox off to </span><span class="line" data-startTime="2609">enable me to debug at every </span><span class="line" data-startTime="2613">single step. </span><span class="line" data-startTime="2614">Now, when you actually deploy </span><span class="line" data-startTime="2614">it &mdash; so if I took this </span><span class="line" data-startTime="2616">application, I can switch it </span><span class="line" data-startTime="2616">back to Native Client. </span><span class="line" data-startTime="2619">Go over here to Properties, </span><span class="line" data-startTime="2619">Debugging. </span><span class="line" data-startTime="2622">And as you can see, </span><span class="line" data-startTime="2622">I do not have No </span><span class="line" data-startTime="2625">Sandbox set at this point. </span><span class="line" data-startTime="2627">So I'm actually running it </span><span class="line" data-startTime="2627">with the sandbox on. </span></p>

<p class="speaker"><span class="line" data-starttime="2629"><span class="speakerName">Audience</span>: Right. </span><span class="line" data-startTime="2630">So that was my question. </span><span class="line" data-startTime="2632">So how does this actually </span><span class="line" data-startTime="2632">work in the sense that &mdash; </span><span class="line" data-startTime="2634">so when the page actually loads, </span><span class="line" data-startTime="2634">does it have a MIME </span><span class="line" data-startTime="2637">type that is whatever </span><span class="line" data-startTime="2637">application slash xNaCl, and </span><span class="line" data-startTime="2641">that's handled by whatever the </span><span class="line" data-startTime="2641">NaCl processor inside Chrome? </span></p>

<p class="speaker"><span class="line" data-starttime="2644"><span class="speakerName">Colt McAnlis</span>: Yes. </span><span class="line" data-startTime="2645">So remember early on in the </span><span class="line" data-startTime="2645">talk, we talked about using </span><span class="line" data-startTime="2647">the embed tag to actually </span><span class="line" data-startTime="2647">signify and point to the </span><span class="line" data-startTime="2649">Native Client manifest. </span><span class="line" data-startTime="2650">And we defined the </span><span class="line" data-startTime="2650">MIME type there. </span><span class="line" data-startTime="2652">And then, when the page is </span><span class="line" data-startTime="2652">parsed by Chrome, it'll say, </span><span class="line" data-startTime="2655">hey, we found this MIME type. </span><span class="line" data-startTime="2657">And it has a table that says, </span><span class="line" data-startTime="2657">load this plug-in to handle </span><span class="line" data-startTime="2660">this MIME type. </span></p>

<p class="speaker"><span class="line" data-starttime="2661"><span class="speakerName">Noel Allen</span>: Correct. </span><span class="line" data-startTime="2661">So, the application xNaCl </span><span class="line" data-startTime="2661">typically points to the Native </span><span class="line" data-startTime="2666">Client plug-in. </span><span class="line" data-startTime="2668">But we were overwriting that for </span><span class="line" data-startTime="2668">the purpose of developing </span><span class="line" data-startTime="2672">as a Pepper plug-in </span><span class="line" data-startTime="2672">to make it easier. </span></p>

<p class="speaker"><span class="line" data-starttime="2674"><span class="speakerName">Colt McAnlis</span>: We were </span><span class="line" data-startTime="2674">hacking the planet. </span></p>

<p class="speaker"><span class="line" data-starttime="2676"><span class="speakerName">Audience</span>: Thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="2676"><span class="speakerName">Colt McAnlis</span>: No problem. </span></p>

<p class="speaker"><span class="line" data-starttime="2683"><span class="speakerName">Audience</span>: I was wondering if </span><span class="line" data-startTime="2683">there's plans to get this in </span><span class="line" data-startTime="2686">the mobile version of Chrome. </span><span class="line" data-startTime="2688">And if so, when? </span></p>

<p class="speaker"><span class="line" data-starttime="2692"><span class="speakerName">Noel Allen</span>: I actually </span><span class="line" data-startTime="2692">don't know. </span><span class="line" data-startTime="2694">I'll leave that to you. </span></p>

<p class="speaker"><span class="line" data-starttime="2697"><span class="speakerName">Colt McAnlis</span>: Next question. </span><span class="line" data-startTime="2700">I've got no answers </span><span class="line" data-startTime="2700">for you today. </span><span class="line" data-startTime="2702">I'm sorry. </span></p>

<p class="speaker"><span class="line" data-starttime="2703"><span class="speakerName">Audience</span>: Then maybe &mdash; </span><span class="line" data-startTime="2704">the NEXE format very </span><span class="line" data-startTime="2704">specific to x86. </span><span class="line" data-startTime="2707">Or is it something like LLVM </span><span class="line" data-startTime="2707">that might be able to be </span><span class="line" data-startTime="2711">compiled for an ARM? </span></p>

<p class="speaker"><span class="line" data-starttime="2713"><span class="speakerName">Noel Allen</span>: So let me rephrase </span><span class="line" data-startTime="2713">that question. </span> <span class="line" data-startTime="2717">So what you're looking at right </span><span class="line" data-startTime="2717">now is specifically an </span><span class="line" data-startTime="2722">x86, 64-bit binary that was </span><span class="line" data-startTime="2722">generated by the toolchains. </span> <span class="line" data-startTime="2726">OK? </span><span class="line" data-startTime="2727">So if someone had a 32-bit </span><span class="line" data-startTime="2727">version of the browser, then </span><span class="line" data-startTime="2730">they would be using the </span><span class="line" data-startTime="2730">32-bit version. </span> <span class="line" data-startTime="2732">Or if they had an ARM, they'd </span><span class="line" data-startTime="2732">be using the ARM version. </span> <span class="line" data-startTime="2736">Now, we are working on a </span><span class="line" data-startTime="2736">portable version that will, in </span><span class="line" data-startTime="2740">fact, use LLVM to generate </span><span class="line" data-startTime="2740">bitcode. </span> <span class="line" data-startTime="2743">And then we will do </span><span class="line" data-startTime="2743">the translation at </span><span class="line" data-startTime="2746">the browser for you. </span> <span class="line" data-startTime="2747">So you can expect that to be </span><span class="line" data-startTime="2747">coming around like, say, end </span><span class="line" data-startTime="2750">of the year. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2751"><span class="speakerName">Audience</span>: Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="2754"><span class="speakerName">Audience</span>: Hi there. </span><span class="line" data-startTime="2755">If I have a pretty sophisticated </span><span class="line" data-startTime="2755">Pepper plug-in </span><span class="line" data-startTime="2758">already made &mdash; </span><span class="line" data-startTime="2760">Well, I guess my question is do </span><span class="line" data-startTime="2760">I have full access to all </span><span class="line" data-startTime="2763">the Pepper APIs inside NaCl, </span><span class="line" data-startTime="2763">or is it some subset? </span></p>

<p class="speaker"><span class="line" data-starttime="2766"><span class="speakerName">Noel Allen</span>: It is a subset, </span><span class="line" data-startTime="2766">but it's almost all. </span><span class="line" data-startTime="2773">So there's a few private </span><span class="line" data-startTime="2773">interfaces that are only </span><span class="line" data-startTime="2778">usable by a few different </span><span class="line" data-startTime="2778">plug-ins. </span><span class="line" data-startTime="2781">So unless you were one of those </span><span class="line" data-startTime="2781">special cases already, </span><span class="line" data-startTime="2784">you wouldn't have had </span><span class="line" data-startTime="2784">access to it. </span></p>

<p class="speaker"><span class="line" data-starttime="2785"><span class="speakerName">Audience</span>: OK, thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="2790"><span class="speakerName">Audience</span>: I noticed you took </span><span class="line" data-startTime="2790">out two of the libs. </span><span class="line" data-startTime="2793">If I have an external lib, </span><span class="line" data-startTime="2793">I need to recompile </span><span class="line" data-startTime="2797">that lib as a NaCl. </span><span class="line" data-startTime="2798">Is that correct? </span><span class="line" data-startTime="2799">And then statically link it? </span></p>

<p class="speaker"><span class="line" data-starttime="2800"><span class="speakerName">Colt McAnlis</span>: Yes. </span></p>

<p class="speaker"><span class="line" data-starttime="2801"><span class="speakerName">Noel Allen</span>: Yes. </span><span class="line" data-startTime="2801">So you're asking what </span><span class="line" data-startTime="2801">do you have to do </span><span class="line" data-startTime="2805">with the two libraries. </span><span class="line" data-startTime="2805">So the libraries that we see </span><span class="line" data-startTime="2805">here, that I took out, is the </span><span class="line" data-startTime="2810">Windows GL libraries. </span><span class="line" data-startTime="2813">Since we're GLES, you're </span><span class="line" data-startTime="2813">going to be using GLES. </span><span class="line" data-startTime="2817">Now, as you can see here, what </span><span class="line" data-startTime="2817">I'm doing is I am loading the </span><span class="line" data-startTime="2822">PPAPI version of the </span><span class="line" data-startTime="2822">GLES2 library. </span><span class="line" data-startTime="2826">So you will get this in the </span><span class="line" data-startTime="2826">SDK in the native form for </span><span class="line" data-startTime="2831">your platform. </span><span class="line" data-startTime="2831">So Windows, Mac, Linux. </span><span class="line" data-startTime="2835">And of course, the </span><span class="line" data-startTime="2835">GCC toolchain </span><span class="line" data-startTime="2837">ships with it as well. </span><span class="line" data-startTime="2838">So you'll have it on </span><span class="line" data-startTime="2838">all the platforms. </span><span class="line" data-startTime="2841">And we do actually ship the </span><span class="line" data-startTime="2841">source for this library. </span><span class="line" data-startTime="2843">So you could actually recompile </span><span class="line" data-startTime="2843">it yourself, if you </span><span class="line" data-startTime="2845">wanted to as well. </span></p>

<p class="speaker"><span class="line" data-starttime="2845"><span class="speakerName">Colt McAnlis</span>: And If you have </span><span class="line" data-startTime="2845">libraries, you do have to </span><span class="line" data-startTime="2847">recompile them, because </span><span class="line" data-startTime="2847">otherwise it may have unsafe </span><span class="line" data-startTime="2850">code or it may use fread or try </span><span class="line" data-startTime="2850">to open a window and that </span><span class="line" data-startTime="2854">would, of course, fail </span><span class="line" data-startTime="2854">the validation. </span></p>

<p class="speaker"><span class="line" data-starttime="2856"><span class="speakerName">Audience</span>: I'm sure there's </span><span class="line" data-startTime="2856">an example I can follow. </span><span class="line" data-startTime="2858">That sounds great. </span><span class="line" data-startTime="2859">The other question was, now that </span><span class="line" data-startTime="2859">Chrome is in Android 4.1, </span><span class="line" data-startTime="2865">is Native Client also runnable </span><span class="line" data-startTime="2865">through that Chrome version? </span></p>

<p class="speaker"><span class="line" data-starttime="2869"><span class="speakerName">Colt McAnlis</span>: I believe the </span><span class="line" data-startTime="2869">correct answer is no. </span><span class="line" data-startTime="2873">Because remember Chrome on </span><span class="line" data-startTime="2873">Android doesn't have all of </span><span class="line" data-startTime="2876">the big wizbang features </span><span class="line" data-startTime="2876">today. </span><span class="line" data-startTime="2877">We want to, of course, as </span><span class="line" data-startTime="2877">Chrome, move towards having </span><span class="line" data-startTime="2880">feature parity in as many </span><span class="line" data-startTime="2880">places as we do. </span><span class="line" data-startTime="2882">Right now, we actually </span><span class="line" data-startTime="2882">don't have Native </span><span class="line" data-startTime="2883">Client running on Chrome. </span></p>

<p class="speaker"><span class="line" data-starttime="2884"><span class="speakerName">Noel Allen</span>: Yes. </span><span class="line" data-startTime="2885">Currently, this is </span><span class="line" data-startTime="2885">a desktop only &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="2886"><span class="speakerName">Colt McAnlis</span>: Yes. </span><span class="line" data-startTime="2887">Currently desktop only. </span><span class="line" data-startTime="2890">Fantastic. </span><span class="line" data-startTime="2891">Going once, going twice. </span><span class="line" data-startTime="2893">Thank you, guys, for your </span><span class="line" data-startTime="2893">attention today. </span><span class="line" data-startTime="2894">We appreciate it. </span><span class="line" data-startTime="2895">Thank you. </span></p>