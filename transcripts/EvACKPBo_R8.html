<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Google I/O 2012 &mdash; Migrating Code from GWT to Dart</h1>

<h2>Ray Cromwell, Vijay Menon</h2>

<a class="video" href="http://youtu.be/EvACKPBo_R8">youtu.be/EvACKPBo_R8</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="8"><span class="speakerName">Ray Cromwell</span>: Good afternoon. </span> <span class="line" data-startTime="10">How you guys doing? </span><span class="line" data-startTime="12">I'm looking around the room and </span><span class="line" data-startTime="12">I'm seeing a lot of people </span><span class="line" data-startTime="15">who I think are either </span><span class="line" data-startTime="15">passionate about GWT or Dart, </span><span class="line" data-startTime="18">because you could have been </span><span class="line" data-startTime="18">downstairs getting your Nexus </span><span class="line" data-startTime="21">7, your Galaxy Nexus, and </span><span class="line" data-startTime="21">your Nexus Q, but </span><span class="line" data-startTime="24">you're here in my session. </span> <span class="line" data-startTime="25">So thanks for coming. </span> <span class="line" data-startTime="28">This session is titled </span><span class="line" data-startTime="28">"Migrating Code from GWT to </span><span class="line" data-startTime="31">Dart." And if you </span><span class="line" data-startTime="31">might notice &mdash; </span><span class="line" data-startTime="34">I'm tech lead for GWT. </span> <span class="line" data-startTime="36">My name is Ray Cromwell. </span> <span class="line" data-startTime="37">So the first thing you might be </span><span class="line" data-startTime="37">asking &mdash; and I get this a </span><span class="line" data-startTime="39">lot &mdash; before the session even </span><span class="line" data-startTime="39">starts, is why Dart? </span><span class="line" data-startTime="42">Why am I even giving a Dart </span><span class="line" data-startTime="42">session in the first place? </span><span class="line" data-startTime="44">I'm tech lead on GWT. </span></p>

<p><span class="line" data-startTime="46">Well first of all, actually, </span><span class="line" data-startTime="46">I think Dart's </span><span class="line" data-startTime="48">a really cool language. </span> <span class="line" data-startTime="49">And I'm a compiler geek so I </span><span class="line" data-startTime="49">tend to like languages and </span><span class="line" data-startTime="53">language-oriented stuff. </span> <span class="line" data-startTime="54">So I volunteered to give this </span><span class="line" data-startTime="54">session, because to me, </span><span class="line" data-startTime="58">learning programming languages </span><span class="line" data-startTime="58">is not about discussing which </span><span class="line" data-startTime="60">language is best, whether Dart </span><span class="line" data-startTime="60">is better than JavaScript or </span><span class="line" data-startTime="65">better than Java and so on. </span> <span class="line" data-startTime="66">Because every language that you </span><span class="line" data-startTime="66">encounter has things that </span><span class="line" data-startTime="70">are good about them and </span><span class="line" data-startTime="70">things that people </span><span class="line" data-startTime="72">will complain about. </span> <span class="line" data-startTime="74">And so for each type of </span><span class="line" data-startTime="74">application, there's always </span><span class="line" data-startTime="77">sort of a sweet spot, and Dart </span><span class="line" data-startTime="77">is no exception to that. </span></p>

<p><span class="line" data-startTime="81">But it is a very cool language, </span><span class="line" data-startTime="81">and it takes some of </span><span class="line" data-startTime="84">the best features from </span><span class="line" data-startTime="84">JavaScript and Java and </span><span class="line" data-startTime="88">combines them into one. </span> <span class="line" data-startTime="89">And I'll get to that later. </span> <span class="line" data-startTime="91">I also think learning </span><span class="line" data-startTime="91">new languages is </span><span class="line" data-startTime="93">good for your brain. </span> <span class="line" data-startTime="93">Just like bilingualism and </span><span class="line" data-startTime="93">spoken languages, if you learn </span><span class="line" data-startTime="96">multiple programming languages, </span><span class="line" data-startTime="96">it's going to be </span><span class="line" data-startTime="97">good for your career. </span> <span class="line" data-startTime="99">It's going to make you think </span><span class="line" data-startTime="99">in different ways. </span> <span class="line" data-startTime="100">And hopefully exposure to Dart </span><span class="line" data-startTime="100">will make you think about </span><span class="line" data-startTime="103">designing web applications in </span><span class="line" data-startTime="103">different ways, perhaps ways </span><span class="line" data-startTime="105">that are more structured, if </span><span class="line" data-startTime="105">you're not a Java programmer. </span> <span class="line" data-startTime="112">And finally, I don't really </span><span class="line" data-startTime="112">think that you can evaluate a </span><span class="line" data-startTime="114">language unless you've </span><span class="line" data-startTime="114">developed using it. </span></p>

<p><span class="line" data-startTime="117">A lot of times, you're online </span><span class="line" data-startTime="117">and you'll see people having </span><span class="line" data-startTime="120">wars over programming </span><span class="line" data-startTime="120">languages. </span> <span class="line" data-startTime="122">My language is better </span><span class="line" data-startTime="122">than yours. </span> <span class="line" data-startTime="124">They'll microcriticize various </span><span class="line" data-startTime="124">parts of the spec. </span> <span class="line" data-startTime="126">But really, you'll never know </span><span class="line" data-startTime="126">what's cool about a language </span><span class="line" data-startTime="130">or what sucks about it unless </span><span class="line" data-startTime="130">you actually develop with it. </span> <span class="line" data-startTime="133">And so this presentation is </span><span class="line" data-startTime="133">designed to help you utilize </span><span class="line" data-startTime="137">what you already know, which is </span><span class="line" data-startTime="137">hopefully Java and GWT, and </span><span class="line" data-startTime="142">get you up to speed on Dart as </span><span class="line" data-startTime="142">fast as possible so you can </span><span class="line" data-startTime="146">try that experiment </span><span class="line" data-startTime="146">out for yourself. </span> <span class="line" data-startTime="148">And then you can make the </span><span class="line" data-startTime="148">decision whether or not you </span><span class="line" data-startTime="151">think Dart is a good language </span><span class="line" data-startTime="151">for you or GWT is a good </span><span class="line" data-startTime="153">language for you, or hand-coded </span><span class="line" data-startTime="153">JavaScript's a good </span><span class="line" data-startTime="155">language for you. </span></p>

<p><span class="line" data-startTime="157">And so I want to try to map </span><span class="line" data-startTime="157">concepts that you already know </span><span class="line" data-startTime="160">from Java and GWT into Dart so </span><span class="line" data-startTime="160">that you'll understand things </span><span class="line" data-startTime="164">faster and quicker. </span> <span class="line" data-startTime="165">I want to try to teach you some </span><span class="line" data-startTime="165">Dart idioms and to get </span><span class="line" data-startTime="169">your feet wet in terms of </span><span class="line" data-startTime="169">porting some existing GWT </span><span class="line" data-startTime="172">application constructs </span><span class="line" data-startTime="172">into Dart. </span> <span class="line" data-startTime="176">So what is Dart? </span><span class="line" data-startTime="178">We say it's a structured </span><span class="line" data-startTime="178">language for web applications. </span> <span class="line" data-startTime="181">But it's more than that, because </span><span class="line" data-startTime="181">on the surface, it has </span><span class="line" data-startTime="184">the appearance of </span><span class="line" data-startTime="184">being Java-like. </span> <span class="line" data-startTime="186">But underneath it's a </span><span class="line" data-startTime="186">dynamically typed language. </span> <span class="line" data-startTime="189">So what does that mean? </span><span class="line" data-startTime="190">If you think of JavaScript &mdash; </span><span class="line" data-startTime="192">it means that you can refer to </span><span class="line" data-startTime="192">things on an object, fields or </span><span class="line" data-startTime="196">invoke methods and so on, </span><span class="line" data-startTime="196">regardless of what the </span><span class="line" data-startTime="198">declared type is. </span></p>

<p><span class="line" data-startTime="199">You might say it's a customer </span><span class="line" data-startTime="199">object, but at run time you </span><span class="line" data-startTime="203">can still refer to that object </span><span class="line" data-startTime="203">as if it was a totally </span><span class="line" data-startTime="205">different type. </span> <span class="line" data-startTime="206">The type doesn't restrict </span><span class="line" data-startTime="206">you from shooting </span><span class="line" data-startTime="209">yourself in the foot. </span> <span class="line" data-startTime="211">But Dart goes a little bit </span><span class="line" data-startTime="211">further, because although you </span><span class="line" data-startTime="215">can do that, you can also run, </span><span class="line" data-startTime="215">optionally, your application </span><span class="line" data-startTime="219">in checked mode. </span> <span class="line" data-startTime="220">And in checked mode, the </span><span class="line" data-startTime="220">types do have meaning. </span> <span class="line" data-startTime="223">And you will get runtime errors </span><span class="line" data-startTime="223">if you, for example, </span><span class="line" data-startTime="225">try to access something on an </span><span class="line" data-startTime="225">object or a class that wasn't </span><span class="line" data-startTime="228">there in that type. </span> <span class="line" data-startTime="230">But in general, when you're </span><span class="line" data-startTime="230">programing in Dart, unlike in </span><span class="line" data-startTime="232">Java, you should treat the </span><span class="line" data-startTime="232">types like annotation or </span><span class="line" data-startTime="235">documentation for both people </span><span class="line" data-startTime="235">reading the code and for </span><span class="line" data-startTime="239">machines that are processing </span><span class="line" data-startTime="239">it, like tools. </span></p>

<p><span class="line" data-startTime="241">Dart's also a class-based </span><span class="line" data-startTime="243">object-oriented programming language. </span> <span class="line" data-startTime="244">It's not a prototype-based </span><span class="line" data-startTime="244">language. </span> <span class="line" data-startTime="246">It's not functional language. </span> <span class="line" data-startTime="247">It's class-based </span><span class="line" data-startTime="247">object-oriented. </span> <span class="line" data-startTime="251">But because it has a type </span><span class="line" data-startTime="251">system and it's </span><span class="line" data-startTime="254">OO, it's very toolable. </span> <span class="line" data-startTime="256">So one of the things you'll be </span><span class="line" data-startTime="256">able to do is you'll be able </span><span class="line" data-startTime="258">to go out and get things like </span><span class="line" data-startTime="258">the Dart Editor, which is </span><span class="line" data-startTime="261">based on the Eclipse framework, </span><span class="line" data-startTime="261">or the latest </span><span class="line" data-startTime="264">IntelliJ plugin, and you'll </span><span class="line" data-startTime="264">actually be able to get all of </span><span class="line" data-startTime="267">this nice stuff that you </span><span class="line" data-startTime="267">like in Java in Dart. </span> <span class="line" data-startTime="270">Command method completion, field </span><span class="line" data-startTime="270">completion, refactoring, </span><span class="line" data-startTime="274">go to declaration &mdash; </span><span class="line" data-startTime="275">all those things are there. </span> <span class="line" data-startTime="275">Things that are actually </span><span class="line" data-startTime="275">typically hard to do in </span><span class="line" data-startTime="278">dynamic languages with </span><span class="line" data-startTime="278">IDEs, you can do </span><span class="line" data-startTime="283">quite easily with Dart. </span></p>

<p><span class="line" data-startTime="284">And Dart has the option of </span><span class="line" data-startTime="284">running either natively in the </span><span class="line" data-startTime="287">Dart VM or in any other browser </span><span class="line" data-startTime="287">by using a Dart-to-JS </span><span class="line" data-startTime="291">compiler, which compiles </span><span class="line" data-startTime="291">the JS just like GWT. </span> <span class="line" data-startTime="295">So let's dive right in. </span> <span class="line" data-startTime="297">Rather than teaching the </span><span class="line" data-startTime="297">language spec, if you haven't </span><span class="line" data-startTime="299">seen any of the other sessions, </span><span class="line" data-startTime="299">I'm just going to </span><span class="line" data-startTime="302">start off with Java and try to </span><span class="line" data-startTime="302">transmorgify it into Dart. </span> <span class="line" data-startTime="306">Let's see how that works out. </span> <span class="line" data-startTime="308">So the first thing that's </span><span class="line" data-startTime="308">different between Dart and </span><span class="line" data-startTime="311">Java is basically, there's no </span><span class="line" data-startTime="311">access modifier keywords. </span> <span class="line" data-startTime="315">So you can basically just remove </span><span class="line" data-startTime="315">the private and public </span><span class="line" data-startTime="318">declarations and the code </span><span class="line" data-startTime="318">will continue to work. </span></p>

<p><span class="line" data-startTime="321">The next thing is that </span><span class="line" data-startTime="321">types are optional. </span> <span class="line" data-startTime="323">So it's not &mdash; we don't always </span><span class="line" data-startTime="323">recommend removing types. </span> <span class="line" data-startTime="327">I think well-written library </span><span class="line" data-startTime="327">code should have the types </span><span class="line" data-startTime="330">there so when other people are </span><span class="line" data-startTime="330">reading your code, they'll </span><span class="line" data-startTime="331">actually kind of know </span><span class="line" data-startTime="331">the intent. </span> <span class="line" data-startTime="333">But just to show you, we </span><span class="line" data-startTime="333">can remove that string </span><span class="line" data-startTime="335">declaration, that Boolean field </span><span class="line" data-startTime="335">declaration, and we end </span><span class="line" data-startTime="339">up with that. </span> <span class="line" data-startTime="341">The other thing is that &mdash; </span><span class="line" data-startTime="343">and I actually like </span><span class="line" data-startTime="343">this feature. </span> <span class="line" data-startTime="344">This is one of my favorite </span><span class="line" data-startTime="344">features of Dart. </span> <span class="line" data-startTime="347">In Java, you write the same code </span><span class="line" data-startTime="347">over and over and over </span><span class="line" data-startTime="350">again for initializing </span><span class="line" data-startTime="350">constructors. </span> <span class="line" data-startTime="352">You have a constructor. </span> <span class="line" data-startTime="353">It takes three parameters. </span> <span class="line" data-startTime="355">What is the first thing you </span><span class="line" data-startTime="355">do in the body of the </span><span class="line" data-startTime="356">constructor? </span><span class="line" data-startTime="357">This dot x equals y, this dot a </span><span class="line" data-startTime="357">equals b, and so on, right? </span><span class="line" data-startTime="360">The same thing &mdash; </span><span class="line" data-startTime="362">and a lot of languages have </span><span class="line" data-startTime="362">this problem too, but Dart </span><span class="line" data-startTime="365">actually has a little bit of </span><span class="line" data-startTime="365">syntactic sugar for this. </span></p>

<p><span class="line" data-startTime="368">So if you want to auto-assign </span><span class="line" data-startTime="368">a parameter to a field, then </span><span class="line" data-startTime="372">you refer to the field in the </span><span class="line" data-startTime="372">constructor parameter </span><span class="line" data-startTime="375">declaration with a </span><span class="line" data-startTime="375">this qualifier. </span> <span class="line" data-startTime="378">So here I'm saying this.name </span><span class="line" data-startTime="378">and that's it, in the </span><span class="line" data-startTime="382">constructor parameter list. </span> <span class="line" data-startTime="383">And basically the Dart VM or the </span><span class="line" data-startTime="383">Dart compiler knows that </span><span class="line" data-startTime="388">that refers to the field name, </span><span class="line" data-startTime="388">which has a string type, and </span><span class="line" data-startTime="392">it's going to autogenerate </span><span class="line" data-startTime="392">this.name equals name for you. </span> <span class="line" data-startTime="400">In Java, if you have a block of </span><span class="line" data-startTime="400">code in an if statement or </span><span class="line" data-startTime="406">a for statement that only has </span><span class="line" data-startTime="406">one line, you now that you can </span><span class="line" data-startTime="408">eliminate the curly braces </span><span class="line" data-startTime="408">and just put a semicolon. </span></p>

<p><span class="line" data-startTime="411">In Dart, even for method </span><span class="line" data-startTime="411">declarations, you can </span><span class="line" data-startTime="414">eliminate the curly braces. </span> <span class="line" data-startTime="416">So here is a method that only </span><span class="line" data-startTime="416">has one line of code in it. </span> <span class="line" data-startTime="421">And so the cat constructor just </span><span class="line" data-startTime="421">equals greater-than and </span><span class="line" data-startTime="424">then an expression to </span><span class="line" data-startTime="424">the right of it. </span> <span class="line" data-startTime="429">So Dart doesn't have packages. </span> <span class="line" data-startTime="431">It has something that's not </span><span class="line" data-startTime="431">exactly like a package. </span> <span class="line" data-startTime="434">It's called a library. </span> <span class="line" data-startTime="435">And so here we just delete </span><span class="line" data-startTime="435">package com.foo and we just </span><span class="line" data-startTime="438">use #library('foo'), which is </span><span class="line" data-startTime="438">basically saying the code </span><span class="line" data-startTime="441">below it is part of </span><span class="line" data-startTime="441">that library. </span></p>

<p><span class="line" data-startTime="445">Now I said that Dart doesn't </span><span class="line" data-startTime="445">have access qualifiers, like </span><span class="line" data-startTime="449">public and private. </span> <span class="line" data-startTime="450">But you can hide things </span><span class="line" data-startTime="450">within a library. </span> <span class="line" data-startTime="454">So you can make it so that no </span><span class="line" data-startTime="454">one outside of the library foo </span><span class="line" data-startTime="457">can see a particular variable. </span> <span class="line" data-startTime="458">And the way you do that is by </span><span class="line" data-startTime="458">putting a leading underscore </span><span class="line" data-startTime="462">on the field name. </span> <span class="line" data-startTime="463">So in this example, _name and </span><span class="line" data-startTime="463">_iCanHazMeme are only visible </span><span class="line" data-startTime="468">to classes within </span><span class="line" data-startTime="468">the library foo. </span> <span class="line" data-startTime="473">So Dart doesn't have an import </span><span class="line" data-startTime="473">statement like Java, but it </span><span class="line" data-startTime="475">does have #import. </span> <span class="line" data-startTime="477">And with #import, basically, </span><span class="line" data-startTime="477">you import libraries. </span> <span class="line" data-startTime="480">And this is the syntax for it. </span></p>

<p><span class="line" data-startTime="482">So we're getting there. </span> <span class="line" data-startTime="484">We're almost fully converted. </span> <span class="line" data-startTime="486">So Dart has final fields, </span><span class="line" data-startTime="486">but they're initialized </span><span class="line" data-startTime="490">differently than Java. </span> <span class="line" data-startTime="491">They're using the C++-style </span><span class="line" data-startTime="491">initializer list. </span> <span class="line" data-startTime="493">So if you have some final </span><span class="line" data-startTime="493">fields, they have to be </span><span class="line" data-startTime="496">assigned during construction. </span> <span class="line" data-startTime="498">And so the way you do it is </span><span class="line" data-startTime="498">you put a colon after the </span><span class="line" data-startTime="500">constructor and then a </span><span class="line" data-startTime="500">comma-separated list of </span><span class="line" data-startTime="503">assignments. </span> <span class="line" data-startTime="507">Dart also has static fields. </span> <span class="line" data-startTime="509">So you can see in this example, </span><span class="line" data-startTime="509">UBER_CAT, we want it </span><span class="line" data-startTime="511">be a static, final, immutable </span><span class="line" data-startTime="511">Cat, right, </span><span class="line" data-startTime="515">that everyone sees. </span> <span class="line" data-startTime="519">And you can initialize them to </span><span class="line" data-startTime="519">be immutable or singleton &mdash; </span><span class="line" data-startTime="523">think of string interning </span><span class="line" data-startTime="523">in Java &mdash; </span><span class="line" data-startTime="525">by using something Dart has </span><span class="line" data-startTime="525">called a const constructor. </span> <span class="line" data-startTime="530">So if you put the const keyword </span><span class="line" data-startTime="530">in front of the Cat </span><span class="line" data-startTime="533">constructor, essentially what </span><span class="line" data-startTime="533">this is saying is that there's </span><span class="line" data-startTime="536">only ever one instance of that </span><span class="line" data-startTime="536">Cat with that parameter name. </span> <span class="line" data-startTime="542">So if you construct a Cat and </span><span class="line" data-startTime="542">the name is Mr. Tibbles, then </span><span class="line" data-startTime="549">there's only one instance </span><span class="line" data-startTime="549">of Mr. Tibbles. </span></p>

<p><span class="line" data-startTime="550">And the next time you try to </span><span class="line" data-startTime="550">allocate one, you'll still get </span><span class="line" data-startTime="553">the same instance. </span> <span class="line" data-startTime="554">That means you can </span><span class="line" data-startTime="554">use a reference </span><span class="line" data-startTime="556">comparison, for example. </span> <span class="line" data-startTime="559">Another biggie, and this'll </span><span class="line" data-startTime="559">probably be the biggest shock </span><span class="line" data-startTime="562">if you're coming from Java or </span><span class="line" data-startTime="562">GWT, is that there's no </span><span class="line" data-startTime="564">function overloading in Dart. </span> <span class="line" data-startTime="567">And so here's a typical </span><span class="line" data-startTime="567">example of Java &mdash; </span><span class="line" data-startTime="570">the Money class, where it's </span><span class="line" data-startTime="570">storing things as a </span><span class="line" data-startTime="574">fixed-point integer. </span></p>

<p><span class="line" data-startTime="575">Let's say multiplied by 100, </span><span class="line" data-startTime="575">so it's in pennies. </span> <span class="line" data-startTime="578">And so someone might have </span><span class="line" data-startTime="578">three constructors. </span> <span class="line" data-startTime="580">One that takes an int, one that </span><span class="line" data-startTime="580">takes a string, and one </span><span class="line" data-startTime="582">that takes a double. </span> <span class="line" data-startTime="584">And they might have some </span><span class="line" data-startTime="584">overloaded methods. </span> <span class="line" data-startTime="585">So down at the bottom we </span><span class="line" data-startTime="585">have two add methods. </span> <span class="line" data-startTime="588">One takes another Money class, </span><span class="line" data-startTime="588">and one takes another Money </span><span class="line" data-startTime="591">class but optionally charges tax </span><span class="line" data-startTime="591">before it adds the money. </span> <span class="line" data-startTime="597">So Dart works around this </span><span class="line" data-startTime="597">problem by introducing named </span><span class="line" data-startTime="601">constructors. </span> <span class="line" data-startTime="602">So in Dart, your constructor </span><span class="line" data-startTime="602">does not always have to have </span><span class="line" data-startTime="605">the same name as your </span><span class="line" data-startTime="605">class itself. </span> <span class="line" data-startTime="607">In Java, your constructor </span><span class="line" data-startTime="607">for the Cat class is </span><span class="line" data-startTime="609">always called Cat. </span> <span class="line" data-startTime="610">In Dart, you have a </span><span class="line" data-startTime="610">constructor called </span><span class="line" data-startTime="613">Money.fromDouble and </span><span class="line" data-startTime="613">Money.fromString. </span></p>

<p><span class="line" data-startTime="616">So the actual qualified </span><span class="line" data-startTime="616">constructor name is itself an </span><span class="line" data-startTime="620">constructor. </span> <span class="line" data-startTime="621">So someone, if they wanted to </span><span class="line" data-startTime="621">create Money from a double, </span><span class="line" data-startTime="624">they'd say new Money.fromDouble </span><span class="line" data-startTime="626">and then the value. </span> <span class="line" data-startTime="629">Likewise, for the overloaded </span><span class="line" data-startTime="629">method case, what we can do is </span><span class="line" data-startTime="633">we can collapse those two </span><span class="line" data-startTime="633">methods into a single method </span><span class="line" data-startTime="635">because Dart has optional </span><span class="line" data-startTime="635">parameters. </span> <span class="line" data-startTime="638">So all you do to make a </span><span class="line" data-startTime="638">parameter optional is you </span><span class="line" data-startTime="640">enclose it in square brackets. </span> <span class="line" data-startTime="642">So now the original Money </span><span class="line" data-startTime="642">class, which had two </span><span class="line" data-startTime="646">parameters, and then another </span><span class="line" data-startTime="646">specialized version, which had </span><span class="line" data-startTime="649">the emitted parameter is </span><span class="line" data-startTime="649">collapsed into a single method </span><span class="line" data-startTime="652">which has the optional </span><span class="line" data-startTime="652">parameter. </span></p>

<p><span class="line" data-startTime="656">And you could specify default </span><span class="line" data-startTime="656">values for the parameters. </span> <span class="line" data-startTime="659">So typically in Java, if you </span><span class="line" data-startTime="659">have this case where you have </span><span class="line" data-startTime="662">two overloads, and one of them </span><span class="line" data-startTime="662">is just an overload because </span><span class="line" data-startTime="664">you want to allow the person to </span><span class="line" data-startTime="664">emit an optional parameter, </span><span class="line" data-startTime="667">you'd typically have one method </span><span class="line" data-startTime="667">call the other and pass </span><span class="line" data-startTime="671">in the default value. </span> <span class="line" data-startTime="672">Here you can just specify </span><span class="line" data-startTime="672">the value. </span> <span class="line" data-startTime="674">So I say in the default, </span><span class="line" data-startTime="674">if you don't specify </span><span class="line" data-startTime="676">chargeTax is true. </span> <span class="line" data-startTime="679">The government's gonna </span><span class="line" data-startTime="679">love that. </span> <span class="line" data-startTime="682">As a bonus, all optional </span><span class="line" data-startTime="682">parameters are named </span><span class="line" data-startTime="685">parameters. </span> <span class="line" data-startTime="685">So if you have a list of like </span><span class="line" data-startTime="685">five optional parameters, and </span><span class="line" data-startTime="688">maybe you don't memorize the API </span><span class="line" data-startTime="688">but you happen to know the </span><span class="line" data-startTime="691">names of the parameters, you </span><span class="line" data-startTime="691">can specify the optional </span><span class="line" data-startTime="694">parameter by putting a colon </span><span class="line" data-startTime="694">in front of its name. </span></p>

<p><span class="line" data-startTime="697">So I'm passing the chargeTax </span><span class="line" data-startTime="697">parameter by </span><span class="line" data-startTime="699">saying chargeTax: false. </span> <span class="line" data-startTime="705">Here's an interesting thing. </span> <span class="line" data-startTime="707">A lot of people complain about </span><span class="line" data-startTime="707">Java, of people creating tons </span><span class="line" data-startTime="710">of factory service locator, </span><span class="line" data-startTime="710">factory factory classes, and </span><span class="line" data-startTime="713">things like that. </span> <span class="line" data-startTime="714">And factories and dependency </span><span class="line" data-startTime="714">injection are very, very </span><span class="line" data-startTime="717">common in Java. </span> <span class="line" data-startTime="718">And I think Dart recognized </span><span class="line" data-startTime="718">this and said, we should </span><span class="line" data-startTime="721">provide a solution for </span><span class="line" data-startTime="721">this that doesn't </span><span class="line" data-startTime="724">add a lot of bloat. </span> <span class="line" data-startTime="725">And so what you can do is you </span><span class="line" data-startTime="725">can designate a constructor as </span><span class="line" data-startTime="728">a factory constructor. </span> <span class="line" data-startTime="730">So here we're saying the Money </span><span class="line" data-startTime="730">constructor that takes an </span><span class="line" data-startTime="733">amount is a factory </span><span class="line" data-startTime="733">constructor. </span></p>

<p><span class="line" data-startTime="736">And what it does is it says, </span><span class="line" data-startTime="736">if the amount is equal to </span><span class="line" data-startTime="739">zero, then return this static </span><span class="line" data-startTime="739">final interned instance of </span><span class="line" data-startTime="742">zero, else return a new </span><span class="line" data-startTime="742">Money object that's </span><span class="line" data-startTime="745">constructed on the fly. </span> <span class="line" data-startTime="747">And typically you might do this </span><span class="line" data-startTime="747">if you want to use zero </span><span class="line" data-startTime="749">as a special value to use </span><span class="line" data-startTime="749">reference equality. </span> <span class="line" data-startTime="753">There's only ever one Money </span><span class="line" data-startTime="753">object representing zero </span><span class="line" data-startTime="756">money, but other ones actually </span><span class="line" data-startTime="756">have differing values. </span> <span class="line" data-startTime="760">And so what happens is, when </span><span class="line" data-startTime="760">you new the Money object it </span><span class="line" data-startTime="762">actually calls this method, and </span><span class="line" data-startTime="762">the method actually can </span><span class="line" data-startTime="765">return a different object, </span><span class="line" data-startTime="765">unlike a typical Java </span><span class="line" data-startTime="768">constructor. </span> <span class="line" data-startTime="768">You can't return something from </span><span class="line" data-startTime="768">the constructor that's </span><span class="line" data-startTime="771">different than the </span><span class="line" data-startTime="771">object itself. </span></p>

<p><span class="line" data-startTime="775">And Dart also has operator </span><span class="line" data-startTime="775">overloading. </span> <span class="line" data-startTime="777">So we can make that Money class </span><span class="line" data-startTime="777">a little easier to use </span><span class="line" data-startTime="780">by overwriting operator+ </span><span class="line" data-startTime="780">on it. </span> <span class="line" data-startTime="783">And now you can just say </span><span class="line" data-startTime="783">money+money instead of </span><span class="line" data-startTime="786">money.add(money). </span> <span class="line" data-startTime="791">And finally, Dart has </span><span class="line" data-startTime="791">getters and setters. </span> <span class="line" data-startTime="795">So this is a typical </span><span class="line" data-startTime="795">POJO, Plain Old Job </span><span class="line" data-startTime="798">Object bean, in Java. </span> <span class="line" data-startTime="800">And so we have a field called </span><span class="line" data-startTime="800">Amount, so naturally we have </span><span class="line" data-startTime="803">to write an int get amount that </span><span class="line" data-startTime="803">returns _amount, and a </span><span class="line" data-startTime="805">setter for it. </span> <span class="line" data-startTime="807">And then on the bottom, you </span><span class="line" data-startTime="807">see method calls from it. </span> <span class="line" data-startTime="810">Whereas in Dart, what you can </span><span class="line" data-startTime="810">do is you can put a get </span><span class="line" data-startTime="815">keyword in front of the function </span><span class="line" data-startTime="815">name and a set </span><span class="line" data-startTime="818">keyword in front </span><span class="line" data-startTime="818">of the setter. </span> <span class="line" data-startTime="819">And then what happens is you can </span><span class="line" data-startTime="819">reference the object as if </span><span class="line" data-startTime="822">those were field references, </span><span class="line" data-startTime="822">not method calls. </span></p>

<p><span class="line" data-startTime="825">And Dart will actually invoke </span><span class="line" data-startTime="825">the getter methods for you. </span> <span class="line" data-startTime="828">So this is kind of a less </span><span class="line" data-startTime="828">boilerplate-y way of setting </span><span class="line" data-startTime="831">up fields with getters and </span><span class="line" data-startTime="831">setters or properties. </span> <span class="line" data-startTime="837">Let's talk about the type </span><span class="line" data-startTime="837">system differences. </span> <span class="line" data-startTime="843">So there's really only five </span><span class="line" data-startTime="843">built-in types you need to </span><span class="line" data-startTime="845">worry about. </span> <span class="line" data-startTime="846">There are two numeric types. </span> <span class="line" data-startTime="848">There's int and double. </span> <span class="line" data-startTime="850">And yes, you're reading </span><span class="line" data-startTime="850">that right. </span> <span class="line" data-startTime="851">The integer is infinite </span><span class="line" data-startTime="851">precision, so you never have </span><span class="line" data-startTime="854">to worry about overflow </span><span class="line" data-startTime="854">in your code. </span> <span class="line" data-startTime="858">If you want to compute &mdash; </span><span class="line" data-startTime="860">boy, don't try to compute </span><span class="line" data-startTime="860">Google because </span><span class="line" data-startTime="863">you'll run out of memory. </span></p>

<p><span class="line" data-startTime="864">But if you want to compute a </span><span class="line" data-startTime="864">very large number, you can use </span><span class="line" data-startTime="867">integers to do it. </span> <span class="line" data-startTime="869">Doubles are 64-bit IEEE-754 </span><span class="line" data-startTime="869">goodness. </span> <span class="line" data-startTime="872">Typically you might have a </span><span class="line" data-startTime="872">game or a lot of math or </span><span class="line" data-startTime="876">physics code, and they're </span><span class="line" data-startTime="876">great to use for that. </span> <span class="line" data-startTime="878">Dart does have a String. </span> <span class="line" data-startTime="879">Class It has a bool type &mdash; </span><span class="line" data-startTime="881">not Boolean, but bool. </span> <span class="line" data-startTime="882">And it has two fundamental </span><span class="line" data-startTime="882">collection types that </span><span class="line" data-startTime="886">everybody uses, hopefully, </span><span class="line" data-startTime="886">which is List and Map. </span> <span class="line" data-startTime="889">And like every other language </span><span class="line" data-startTime="889">except for Java, they have </span><span class="line" data-startTime="892">first-class support. </span> <span class="line" data-startTime="894">So there are literals </span><span class="line" data-startTime="894">for maps and lists </span><span class="line" data-startTime="899">built into the language. </span> <span class="line" data-startTime="900">So you define a List literal </span><span class="line" data-startTime="900">with square brackets, and you </span><span class="line" data-startTime="902">define a map with curly braces, </span><span class="line" data-startTime="902">much like JSON and </span><span class="line" data-startTime="906">JavaScript. </span></p>

<p><span class="line" data-startTime="908">There's some big differences </span><span class="line" data-startTime="908">with strings </span><span class="line" data-startTime="910">between Java and Dart. </span> <span class="line" data-startTime="912">String support interpolation </span><span class="line" data-startTime="912">in Dart &mdash; so you can put a </span><span class="line" data-startTime="917">dollar sign and then a variable </span><span class="line" data-startTime="917">name inside of any </span><span class="line" data-startTime="921">string, and Dart will substitute </span><span class="line" data-startTime="921">that with the </span><span class="line" data-startTime="925">variable of the same name that's </span><span class="line" data-startTime="925">in the same scope. </span> <span class="line" data-startTime="929">But you can go a little </span><span class="line" data-startTime="929">bit further, too. </span> <span class="line" data-startTime="930">You could put a curly brace. </span> <span class="line" data-startTime="931">And for example, you can invoke </span><span class="line" data-startTime="931">a method call on that. </span> <span class="line" data-startTime="936">If this looks familiar to you, </span><span class="line" data-startTime="936">it looks very much like the </span><span class="line" data-startTime="938">expression language that's often </span><span class="line" data-startTime="938">in many Java frameworks, </span><span class="line" data-startTime="941">like JSP and JSS and things </span><span class="line" data-startTime="941">like that, or like Apache </span><span class="line" data-startTime="945">property substitution. </span> <span class="line" data-startTime="948">One of the features I love most, </span><span class="line" data-startTime="948">actually, is heredocs, </span><span class="line" data-startTime="952">and Dart was very good </span><span class="line" data-startTime="952">to add that. </span></p>

<p><span class="line" data-startTime="954">And it's basically multi-line </span><span class="line" data-startTime="954">strings that you can include </span><span class="line" data-startTime="957">verbatim in the code. </span> <span class="line" data-startTime="960">And that's really, really useful </span><span class="line" data-startTime="960">if you want to bake in </span><span class="line" data-startTime="962">some HTML or some CSS into your </span><span class="line" data-startTime="962">app, and you don't have </span><span class="line" data-startTime="965">to worry about going in and </span><span class="line" data-startTime="965">escaping every new line and </span><span class="line" data-startTime="969">all the other kind of stuff. </span> <span class="line" data-startTime="969">You can kind of structure </span><span class="line" data-startTime="969">DSL-specific syntaxes right </span><span class="line" data-startTime="973">into your Dart source code, </span><span class="line" data-startTime="973">just by putting </span><span class="line" data-startTime="975">in a multiline string. </span> <span class="line" data-startTime="977">And if you don't want </span><span class="line" data-startTime="977">interpolation, because maybe </span><span class="line" data-startTime="980">you want literal dollar signs, </span><span class="line" data-startTime="980">just put an @ in front of the </span><span class="line" data-startTime="982">string, and it turns it </span><span class="line" data-startTime="982">off for that string. </span></p>

<p><span class="line" data-startTime="986">I don't want to say a </span><span class="line" data-startTime="986">lot about generics. </span> <span class="line" data-startTime="989">Dart does have generics, but </span><span class="line" data-startTime="989">they are radically simplified </span><span class="line" data-startTime="992">generics, which is </span><span class="line" data-startTime="992">a good thing. </span> <span class="line" data-startTime="994">Because Java generics &mdash; </span><span class="line" data-startTime="997">I mean, if anybody's played </span><span class="line" data-startTime="997">around in Scala, this sounds </span><span class="line" data-startTime="999">like somebody whining, but Java </span><span class="line" data-startTime="999">generics are actually </span><span class="line" data-startTime="1001">kind of complicated, and a lot </span><span class="line" data-startTime="1001">of people don't understand the </span><span class="line" data-startTime="1003">difference between covariants, </span><span class="line" data-startTime="1003">invariants, contravariants, </span><span class="line" data-startTime="1007">wild cards, and things </span><span class="line" data-startTime="1007">like that. </span> <span class="line" data-startTime="1009">And as a result, most people </span><span class="line" data-startTime="1009">don't even use those features. </span> <span class="line" data-startTime="1011">I mean, if you're Joshua Bloch, </span><span class="line" data-startTime="1011">you use them in the </span><span class="line" data-startTime="1013">Java collections classes, but if </span><span class="line" data-startTime="1013">you go look at most regular </span><span class="line" data-startTime="1016">Java programmers, they </span><span class="line" data-startTime="1016">hardly ever use most </span><span class="line" data-startTime="1019">of these extra features. </span> <span class="line" data-startTime="1020">And so Dart basically said, </span><span class="line" data-startTime="1020">why add all this extra </span><span class="line" data-startTime="1023">complexity? </span><span class="line" data-startTime="1024">Most people would just use </span><span class="line" data-startTime="1024">Foo if T So Dart only has </span><span class="line" data-startTime="1027">covariants for generics. </span> <span class="line" data-startTime="1031">But Dart does not use erasure. </span> <span class="line" data-startTime="1033">So generics in Dart are </span><span class="line" data-startTime="1033">actual reified. </span></p>

<p><span class="line" data-startTime="1037">You can check the </span><span class="line" data-startTime="1037">runtime types. </span> <span class="line" data-startTime="1039">So a Foo or a list of int &mdash; </span><span class="line" data-startTime="1039">you can actually check </span><span class="line" data-startTime="1043">it to see what it is. </span> <span class="line" data-startTime="1045">And if you try to say, </span><span class="line" data-startTime="1045">is this a foo of </span><span class="line" data-startTime="1047">string, it will say false. </span> <span class="line" data-startTime="1048">That's not the case in Java, </span><span class="line" data-startTime="1048">where if you have a list of T, </span><span class="line" data-startTime="1051">a list of anything, basically </span><span class="line" data-startTime="1051">it's only really a list, and </span><span class="line" data-startTime="1054">you actually cannot check </span><span class="line" data-startTime="1054">what it is at runtime. </span> <span class="line" data-startTime="1058">But in general, I would </span><span class="line" data-startTime="1058">say, don't worry </span><span class="line" data-startTime="1059">too much about this. </span> <span class="line" data-startTime="1060">Things just kind of work, and </span><span class="line" data-startTime="1060">you don't have to worry too </span><span class="line" data-startTime="1064">much about it. </span></p>

<p><span class="line" data-startTime="1066">Generics in Dart are simple and </span><span class="line" data-startTime="1066">they work out of the box. </span> <span class="line" data-startTime="1068">And don't get yourself worried </span><span class="line" data-startTime="1068">about what's being left out. </span> <span class="line" data-startTime="1076">The other &mdash; and I want to say </span><span class="line" data-startTime="1076">the third favorite feature of </span><span class="line" data-startTime="1078">mine is finally lexically </span><span class="line" data-startTime="1078">scoped closures. </span> <span class="line" data-startTime="1083">I wish Java had them. </span> <span class="line" data-startTime="1084">I wish Java 8 will have them. </span> <span class="line" data-startTime="1086">Hopefully they will. </span> <span class="line" data-startTime="1086">But yes. </span> <span class="line" data-startTime="1089">Bye-bye, anonymous classes, </span><span class="line" data-startTime="1089">and hello function types. </span> <span class="line" data-startTime="1091">So here is an example of </span><span class="line" data-startTime="1091">an apply function. </span> <span class="line" data-startTime="1094">It takes a list of integers and </span><span class="line" data-startTime="1094">applies the function to </span><span class="line" data-startTime="1096">each thing in the list and </span><span class="line" data-startTime="1096">returns a new list. </span></p>

<p><span class="line" data-startTime="1098">And so at the bottom I just </span><span class="line" data-startTime="1098">show a simple example. </span> <span class="line" data-startTime="1101">Apply an inline literal list of </span><span class="line" data-startTime="1101">1, 2, 3, 4, 5, a function </span><span class="line" data-startTime="1106">which basically doubles </span><span class="line" data-startTime="1106">its input. </span> <span class="line" data-startTime="1109">So what you do to declare a </span><span class="line" data-startTime="1109">closure is you basically put </span><span class="line" data-startTime="1115">the parameters in parentheses </span><span class="line" data-startTime="1115">with optional types, and then </span><span class="line" data-startTime="1119">you put =>, and then the </span><span class="line" data-startTime="1119">expression to be evaluated, </span><span class="line" data-startTime="1122">the function body. </span> <span class="line" data-startTime="1123">You can use curly braces </span><span class="line" data-startTime="1123">there too if you want. </span> <span class="line" data-startTime="1130">And you can make things a </span><span class="line" data-startTime="1130">little bit more readable </span><span class="line" data-startTime="1131">because Dart has typedefs. </span> <span class="line" data-startTime="1133">So often, these function </span><span class="line" data-startTime="1133">declarations, if they're </span><span class="line" data-startTime="1136">really complicated and take a </span><span class="line" data-startTime="1136">lot of parameters &mdash; maybe have </span><span class="line" data-startTime="1138">a function which takes functions </span><span class="line" data-startTime="1138">to functions, and </span><span class="line" data-startTime="1140">things like that &mdash; </span><span class="line" data-startTime="1142">you want to break them down </span><span class="line" data-startTime="1142">into separate steps. </span></p>

<p><span class="line" data-startTime="1144">And with typedefs, </span><span class="line" data-startTime="1144">you can do that. </span> <span class="line" data-startTime="1145">So here I'm basically saying </span><span class="line" data-startTime="1145">that there is a function that </span><span class="line" data-startTime="1151">takes an int and returns an int, </span><span class="line" data-startTime="1151">and I'm going to give it </span><span class="line" data-startTime="1154">the name Transformer. </span> <span class="line" data-startTime="1156">And then my apply function </span><span class="line" data-startTime="1156">now, rather than saying &mdash; </span><span class="line" data-startTime="1159">if you look at the previous </span><span class="line" data-startTime="1159">slide, it's int f(int arg)) </span><span class="line" data-startTime="1164">Now this says Transformer bay. </span> <span class="line" data-startTime="1169">Maybe some of you get the </span><span class="line" data-startTime="1169">reference to that. </span> <span class="line" data-startTime="1171">And so then at the bottom, I </span><span class="line" data-startTime="1171">have another one where I say </span><span class="line" data-startTime="1173">Transformer prime </span><span class="line" data-startTime="1173">= (x) => 2 * x. </span> <span class="line" data-startTime="1178">And so it looks a little </span><span class="line" data-startTime="1178">more readable. </span> <span class="line" data-startTime="1180">You can document the typedef </span><span class="line" data-startTime="1180">and things like that. </span> <span class="line" data-startTime="1184">OK so that kind of covers the </span><span class="line" data-startTime="1184">language syntax case. </span></p>

<p><span class="line" data-startTime="1189">Now I'm going to cover just some </span><span class="line" data-startTime="1189">of the API differences. </span> <span class="line" data-startTime="1191">So Dart has two collection </span><span class="line" data-startTime="1191">classes, as I mentioned </span><span class="line" data-startTime="1195">before, and they </span><span class="line" data-startTime="1195">are generified. </span> <span class="line" data-startTime="1197">That's List and Map. </span> <span class="line" data-startTime="1199">And so in Dart, you can create </span><span class="line" data-startTime="1199">them in two ways. </span> <span class="line" data-startTime="1202">You can new them, with the new </span><span class="line" data-startTime="1202">operator, or you can construct </span><span class="line" data-startTime="1206">them inline with literals, </span><span class="line" data-startTime="1206">which a lot of people do. </span> <span class="line" data-startTime="1209">That's a very common </span><span class="line" data-startTime="1209">thing to do. </span> <span class="line" data-startTime="1213">And you don't actually have to </span><span class="line" data-startTime="1213">worry about the underlying </span><span class="line" data-startTime="1215">concrete types. </span> <span class="line" data-startTime="1216">So Map and List will be abstract </span><span class="line" data-startTime="1216">classes and there </span><span class="line" data-startTime="1219">might be multiple </span><span class="line" data-startTime="1219">implementations of Map and </span><span class="line" data-startTime="1221">List, but Dart will </span><span class="line" data-startTime="1221">pick a default </span><span class="line" data-startTime="1222">implementation for you. </span> <span class="line" data-startTime="1223">In Java, you have to think, </span><span class="line" data-startTime="1223">am I going to use HashMap? </span><span class="line" data-startTime="1226">Am I going to use </span><span class="line" data-startTime="1226">LinkedHashMap? </span><span class="line" data-startTime="1227">And things like that. </span> <span class="line" data-startTime="1230">And then iteration &mdash; </span><span class="line" data-startTime="1231">you have multiple </span><span class="line" data-startTime="1231">choices, right? </span><span class="line" data-startTime="1232">So you can use what's called </span><span class="line" data-startTime="1232">external iteration, where you </span><span class="line" data-startTime="1235">basically have your own for </span><span class="line" data-startTime="1235">loop, you ask for the length </span><span class="line" data-startTime="1237">of the list, and you iterate </span><span class="line" data-startTime="1237">over it and you index into it </span><span class="line" data-startTime="1240">like an array, like List[i]. </span></p>

<p><span class="line" data-startTime="1242">No operator overloading to </span><span class="line" data-startTime="1242">access list members. </span> <span class="line" data-startTime="1245">You don't have to </span><span class="line" data-startTime="1245">say List.get(i). </span> <span class="line" data-startTime="1248">Or you could use the </span><span class="line" data-startTime="1248">For In operators. </span> <span class="line" data-startTime="1251">You could say for (value </span><span class="line" data-startTime="1251">in list) {doSomething}. </span> <span class="line" data-startTime="1255">Or you can use an internal </span><span class="line" data-startTime="1255">iterator, which is basically, </span><span class="line" data-startTime="1259">you pass a closure to the </span><span class="line" data-startTime="1259">forEach method, and it will </span><span class="line" data-startTime="1262">loop over the collection </span><span class="line" data-startTime="1262">internally and call your </span><span class="line" data-startTime="1265">function for each member </span><span class="line" data-startTime="1265">of the list. </span> <span class="line" data-startTime="1267">And then there's equivalent </span><span class="line" data-startTime="1267">methods for Map. </span> <span class="line" data-startTime="1270">It's just that they take two </span><span class="line" data-startTime="1270">parameters for the forEach </span><span class="line" data-startTime="1273">method, key and value, or you </span><span class="line" data-startTime="1273">have to get the set of keys </span><span class="line" data-startTime="1276">and the set of values </span><span class="line" data-startTime="1276">to iterate over. </span> <span class="line" data-startTime="1280">All right. </span></p>

<p><span class="line" data-startTime="1280">So now let's actually move on </span><span class="line" data-startTime="1280">to converting the actual GWT </span><span class="line" data-startTime="1283">code over to Dart. </span> <span class="line" data-startTime="1285">And so let's first convert </span><span class="line" data-startTime="1285">a really simple example. </span> <span class="line" data-startTime="1288">Here's a "Hello World" in GWT. </span> <span class="line" data-startTime="1290">You have the onModuleLoad </span><span class="line" data-startTime="1290">function, and I'm going to </span><span class="line" data-startTime="1292">call window.alert("Hello </span><span class="line" data-startTime="1292">World"). </span> <span class="line" data-startTime="1295">What would this look </span><span class="line" data-startTime="1295">like in Dart? </span><span class="line" data-startTime="1298">Really, really compact. </span> <span class="line" data-startTime="1299">So first thing is we import the </span><span class="line" data-startTime="1299">Dart HTML library so we </span><span class="line" data-startTime="1303">can get the window function, </span><span class="line" data-startTime="1303">the alert function. </span> <span class="line" data-startTime="1306">Secondly, Dart's EntryPoint, </span><span class="line" data-startTime="1306">is the main function. </span> <span class="line" data-startTime="1310">So &mdash; </span><span class="line" data-startTime="1311">whoops &mdash; </span><span class="line" data-startTime="1313">what? </span><span class="line" data-startTime="1313">There we go. </span> <span class="line" data-startTime="1316">Let me restart. </span></p>

<p><span class="line" data-startTime="1318">I don't know why </span><span class="line" data-startTime="1318">that happened. </span> <span class="line" data-startTime="1322">Let's go back. </span> <span class="line" data-startTime="1332">I have a lot of slides. </span> <span class="line" data-startTime="1333">OK. </span> <span class="line" data-startTime="1336">There we go. </span> <span class="line" data-startTime="1337">This one. </span> <span class="line" data-startTime="1338">And so if you look at this, you </span><span class="line" data-startTime="1338">have to declare a class. </span> <span class="line" data-startTime="1341">You have to implement </span><span class="line" data-startTime="1341">EntryPoint. </span> <span class="line" data-startTime="1342">You have to have an onModuleLoad </span><span class="line" data-startTime="1342">function with </span><span class="line" data-startTime="1344">access qualifiers. </span> <span class="line" data-startTime="1345">And then you call </span><span class="line" data-startTime="1345">window.alert. </span> <span class="line" data-startTime="1347">Here you just declare a main </span><span class="line" data-startTime="1347">function and that basically </span><span class="line" data-startTime="1349">runs whatever code </span><span class="line" data-startTime="1349">is specified. </span> <span class="line" data-startTime="1352">But a lot of times people are </span><span class="line" data-startTime="1352">going to structure a little </span><span class="line" data-startTime="1355">more, because you don't want </span><span class="line" data-startTime="1355">everything running in main. </span></p>

<p><span class="line" data-startTime="1357">So people might decide </span><span class="line" data-startTime="1357">to declare a class. </span> <span class="line" data-startTime="1360">So here I have a class called </span><span class="line" data-startTime="1360">Hello, and my equivalent of </span><span class="line" data-startTime="1363">onModuleLoad is the </span><span class="line" data-startTime="1363">go function. </span> <span class="line" data-startTime="1365">And from main, I just </span><span class="line" data-startTime="1365">create that Hello </span><span class="line" data-startTime="1368">instance and invoke go. </span> <span class="line" data-startTime="1372">So this is a really important </span><span class="line" data-startTime="1372">point right now. </span> <span class="line" data-startTime="1376">So you know, Dart is </span><span class="line" data-startTime="1376">bleeding edge. </span> <span class="line" data-startTime="1379">And we're working hard on </span><span class="line" data-startTime="1379">it, and we're working </span><span class="line" data-startTime="1382">as fast as we can. </span> <span class="line" data-startTime="1382">But we don't yet have a widget </span><span class="line" data-startTime="1382">library in the SDK that you </span><span class="line" data-startTime="1386">can download today. </span></p>

<p><span class="line" data-startTime="1387">One will be available soon. </span> <span class="line" data-startTime="1388">If you've seen some of the other </span><span class="line" data-startTime="1388">demos, like the Swarm </span><span class="line" data-startTime="1391">app, there's some really </span><span class="line" data-startTime="1391">slick stuff going on. </span> <span class="line" data-startTime="1392">And that knowledge will </span><span class="line" data-startTime="1392">translate into an awesome </span><span class="line" data-startTime="1396">widget library. </span> <span class="line" data-startTime="1397">But for now, we just have </span><span class="line" data-startTime="1397">DOM programming. </span> <span class="line" data-startTime="1399">And so I'm going to compare GWT </span><span class="line" data-startTime="1399">DOM program versus Dart </span><span class="line" data-startTime="1404">DOM programming. </span> <span class="line" data-startTime="1404">So here is an example. </span> <span class="line" data-startTime="1408">I might have a div tag with </span><span class="line" data-startTime="1408">ID "button" in the HTML. </span> <span class="line" data-startTime="1411">So I'm going to add an </span><span class="line" data-startTime="1411">EventListener, a click </span><span class="line" data-startTime="1414">EventListener, to </span><span class="line" data-startTime="1414">that div tag. </span></p>

<p><span class="line" data-startTime="1416">And so here's the GWT </span><span class="line" data-startTime="1416">code that you have </span><span class="line" data-startTime="1418">to write to do that. </span> <span class="line" data-startTime="1420">So you have to look it up by </span><span class="line" data-startTime="1420">going Document.get, which gets </span><span class="line" data-startTime="1422">the document element. </span> <span class="line" data-startTime="1423">Then getElementByID </span><span class="line" data-startTime="1423">and the button. </span> <span class="line" data-startTime="1425">Then you have to sink the event </span><span class="line" data-startTime="1425">type event you want to </span><span class="line" data-startTime="1427">listen to, so you use </span><span class="line" data-startTime="1427">DOM.sinkEvents. </span> <span class="line" data-startTime="1430">Then you have to set the </span><span class="line" data-startTime="1430">EventListener callback, </span><span class="line" data-startTime="1433">DOM.setEventListener, and have </span><span class="line" data-startTime="1433">an anonymous inner class </span><span class="line" data-startTime="1436">callback with a function </span><span class="line" data-startTime="1436">declared in it, which then has </span><span class="line" data-startTime="1440">window.alert. </span> <span class="line" data-startTime="1442">So what would that look </span><span class="line" data-startTime="1442">like in Dart? </span><span class="line" data-startTime="1445">You just say Query </span><span class="line" data-startTime="1445">("#ID").on.click.add and then </span><span class="line" data-startTime="1450">a closure for the </span><span class="line" data-startTime="1450">EventHandler. </span> <span class="line" data-startTime="1451">Now there's a couple </span><span class="line" data-startTime="1451">of interesting </span><span class="line" data-startTime="1452">things going on here. </span></p>

<p><span class="line" data-startTime="1453">First of all, Dart has global </span><span class="line" data-startTime="1453">functions, and so not every </span><span class="line" data-startTime="1458">method has to be part </span><span class="line" data-startTime="1458">of a class. </span> <span class="line" data-startTime="1459">So there's a global top-level </span><span class="line" data-startTime="1459">query function, and basically </span><span class="line" data-startTime="1464">it kind of acts like the </span><span class="line" data-startTime="1464">dollar-sign function in </span><span class="line" data-startTime="1466">jQuery, if you want to think </span><span class="line" data-startTime="1466">of it like that. </span> <span class="line" data-startTime="1467">So I'm looking up the button </span><span class="line" data-startTime="1467">with ID "button." And I'm </span><span class="line" data-startTime="1471">going to get back an element. </span> <span class="line" data-startTime="1472">Now the element going to have a </span><span class="line" data-startTime="1472">magic field in it called on. </span> <span class="line" data-startTime="1476">And on is going to have a bunch </span><span class="line" data-startTime="1476">of setter properties &mdash; </span><span class="line" data-startTime="1479">like I showed you setters </span><span class="line" data-startTime="1479">earlier &mdash; </span><span class="line" data-startTime="1481">for each type of event. </span></p>

<p><span class="line" data-startTime="1482">So here we've got one </span><span class="line" data-startTime="1482">called click &mdash; </span><span class="line" data-startTime="1485">a setter. </span> <span class="line" data-startTime="1485">We've got one called mouseOver </span><span class="line" data-startTime="1485">and things like that. </span> <span class="line" data-startTime="1488">And each one of those is going </span><span class="line" data-startTime="1488">to have an add method on it. </span> <span class="line" data-startTime="1491">And so now, I'm just saying &mdash; </span><span class="line" data-startTime="1494">for the element that I got back, </span><span class="line" data-startTime="1494">on click, give me back </span><span class="line" data-startTime="1498">this click thing, which can then </span><span class="line" data-startTime="1498">allow me to add a closure </span><span class="line" data-startTime="1502">to it, which will be called. </span> <span class="line" data-startTime="1504">And so that's basically how you </span><span class="line" data-startTime="1504">would write the same code. </span> <span class="line" data-startTime="1507">You look at it again &mdash; </span><span class="line" data-startTime="1511">it looks a lot more readable. </span></p>

<p><span class="line" data-startTime="1516">So that's basically converting </span><span class="line" data-startTime="1516">a Hello World and some simple </span><span class="line" data-startTime="1519">DOM programming. </span> <span class="line" data-startTime="1521">This is kind of where </span><span class="line" data-startTime="1521">Dart is today. </span> <span class="line" data-startTime="1523">As I said, there's high-level </span><span class="line" data-startTime="1523">libraries that are on the way </span><span class="line" data-startTime="1526">real soon now. </span> <span class="line" data-startTime="1528">But for now, it's really an </span><span class="line" data-startTime="1528">HTML5 experience, which is not </span><span class="line" data-startTime="1530">always the worst thing. </span> <span class="line" data-startTime="1531">But here's the sort of </span><span class="line" data-startTime="1531">high-level mapping of what API </span><span class="line" data-startTime="1536">in GWT corresponds to what </span><span class="line" data-startTime="1536">you have to do in Dart. </span> <span class="line" data-startTime="1538">So if you're using </span><span class="line" data-startTime="1538">com.google.gwt.dom, you're </span><span class="line" data-startTime="1540">going to import the </span><span class="line" data-startTime="1540">dart:html library. </span> <span class="line" data-startTime="1543">If you're using UIBinder and </span><span class="line" data-startTime="1543">SafeHTMLTemplates and </span><span class="line" data-startTime="1546">[INAUDIBLE] messages from GWT, </span><span class="line" data-startTime="1546">you're probably just going to </span><span class="line" data-startTime="1549">use Dart string interpolation </span><span class="line" data-startTime="1549">to do the same thing. </span> <span class="line" data-startTime="1553">If you're doing server </span><span class="line" data-startTime="1553">communication, like GWT RPC or </span><span class="line" data-startTime="1556">Request Factory, in Dart, right </span><span class="line" data-startTime="1556">now, today, you're going </span><span class="line" data-startTime="1558">to use XMLHttpRequest. </span></p>

<p><span class="line" data-startTime="1561">For widgets, of course, </span><span class="line" data-startTime="1561">GWT has widgets. </span> <span class="line" data-startTime="1563">For Dart, real soon now </span><span class="line" data-startTime="1563">there's going to </span><span class="line" data-startTime="1565">be some cool stuff. </span> <span class="line" data-startTime="1566">And in multi-process, for using </span><span class="line" data-startTime="1566">WebWorkers, GWT has some </span><span class="line" data-startTime="1573">third-party hacks that add </span><span class="line" data-startTime="1573">WebWorker support to GWT. </span> <span class="line" data-startTime="1576">Dart actually has WebWorkers </span><span class="line" data-startTime="1576">built in to the language as a </span><span class="line" data-startTime="1580">first-class construct. </span> <span class="line" data-startTime="1583">They're called isolates. </span> <span class="line" data-startTime="1585">And so doing multi-process stuff </span><span class="line" data-startTime="1585">within Dart really has </span><span class="line" data-startTime="1589">no equal anywhere. </span> <span class="line" data-startTime="1590">They make it really </span><span class="line" data-startTime="1590">easy to use. </span> <span class="line" data-startTime="1594">So let's try to get a little </span><span class="line" data-startTime="1594">more deeper and port something </span><span class="line" data-startTime="1596">more complex. </span> <span class="line" data-startTime="1597">Let's try to port a widget. </span> <span class="line" data-startTime="1601">Now widgets are written in many </span><span class="line" data-startTime="1601">different ways in GWT. </span> <span class="line" data-startTime="1603">I'm just going to focus on the </span><span class="line" data-startTime="1603">modern way people do widgets </span><span class="line" data-startTime="1606">with GWT, which is </span><span class="line" data-startTime="1606">with UIBinder. </span></p>

<p><span class="line" data-startTime="1609">And so the idea here is just </span><span class="line" data-startTime="1609">how can I take a GWT widget </span><span class="line" data-startTime="1612">that I've written that uses </span><span class="line" data-startTime="1612">UIBinder to define its HTML </span><span class="line" data-startTime="1616">structure and port that </span><span class="line" data-startTime="1616">over to Dart? </span><span class="line" data-startTime="1619">And the general idea here is </span><span class="line" data-startTime="1619">just to take the UIBinder </span><span class="line" data-startTime="1622">template and enclose it in </span><span class="line" data-startTime="1622">a multi-line string. </span> <span class="line" data-startTime="1626">Convert any of the ui:field </span><span class="line" data-startTime="1626">attributes to just be ID </span><span class="line" data-startTime="1631">attributes on the elements. </span> <span class="line" data-startTime="1632">Then build a Dart class to </span><span class="line" data-startTime="1632">represent normally what GWT </span><span class="line" data-startTime="1636">would generate to bind that </span><span class="line" data-startTime="1636">template, which is basically </span><span class="line" data-startTime="1638">looking up the IDs and assigning </span><span class="line" data-startTime="1638">them to fields in </span><span class="line" data-startTime="1641">your object. </span> <span class="line" data-startTime="1643">And then you'll have to </span><span class="line" data-startTime="1643">basically move the raw HTML </span><span class="line" data-startTime="1645">resources, like CssResource, to </span><span class="line" data-startTime="1645">be external CSS by using a </span><span class="line" data-startTime="1650">link tag to include the CSS. </span></p>

<p><span class="line" data-startTime="1653">It's not a perfect solution, but </span><span class="line" data-startTime="1653">it's not horribly bad to </span><span class="line" data-startTime="1657">port code like this. </span> <span class="line" data-startTime="1658">So here's an example. </span> <span class="line" data-startTime="1661">This is how it looks in Java. </span> <span class="line" data-startTime="1663">I have a UIBinder template </span><span class="line" data-startTime="1663">with a div tag. </span> <span class="line" data-startTime="1665">It says, Hello, <span ui: </span><span class="line" data-startTime="1665">field = 'nameSpan' /> . </span> <span class="line" data-startTime="1669">And then here I have a little </span><span class="line" data-startTime="1669">bit of code which basically </span><span class="line" data-startTime="1673">calls setElement(UIBin </span><span class="line" data-startTime="1673">der.CreateandBindUi(this)). </span> <span class="line" data-startTime="1677">Now if you're GWT programmer, </span><span class="line" data-startTime="1677">you know </span><span class="line" data-startTime="1679">this works some magic. </span></p>

<p><span class="line" data-startTime="1680">And what happens is, is it </span><span class="line" data-startTime="1680">basically generates some code </span><span class="line" data-startTime="1684">behind the scenes that will take </span><span class="line" data-startTime="1684">that UIBinder template, </span><span class="line" data-startTime="1689">create a div tag, and inject </span><span class="line" data-startTime="1689">that HTML source, as an inner </span><span class="line" data-startTime="1693">HTML, into it. </span> <span class="line" data-startTime="1695">And put it into the document. </span> <span class="line" data-startTime="1696">And then the next thing it will </span><span class="line" data-startTime="1696">do is it will go through </span><span class="line" data-startTime="1699">and it will look up </span><span class="line" data-startTime="1699">that field, that </span><span class="line" data-startTime="1701">UI field, the nameSpan. </span> <span class="line" data-startTime="1703">And when it finds that element, </span><span class="line" data-startTime="1703">it will store it in </span><span class="line" data-startTime="1705">the field on your class. </span> <span class="line" data-startTime="1707">You can see here, this </span><span class="line" data-startTime="1707">nameSpan attribute. </span></p>

<p><span class="line" data-startTime="1710">So this element will be looked </span><span class="line" data-startTime="1710">up in the DOM with </span><span class="line" data-startTime="1713">getElementById and then </span><span class="line" data-startTime="1713">put there for you. </span> <span class="line" data-startTime="1716">So kind of like a dependency </span><span class="line" data-startTime="1716">injection. </span> <span class="line" data-startTime="1718">So we want to get </span><span class="line" data-startTime="1718">that into Dart. </span> <span class="line" data-startTime="1720">So how can we emulate that? </span><span class="line" data-startTime="1722">So the first thing is, we remove </span><span class="line" data-startTime="1722">the top and bottom XML </span><span class="line" data-startTime="1725">tags and replace them </span><span class="line" data-startTime="1725">with triple-quote. </span> <span class="line" data-startTime="1726">And so now we've just put it </span><span class="line" data-startTime="1726">into a multi-line string. </span> <span class="line" data-startTime="1730">And we replace the ui:field </span><span class="line" data-startTime="1730">with just id='nameSpan'. </span> <span class="line" data-startTime="1736">And then secondly, the next step </span><span class="line" data-startTime="1736">that we'd do is we would </span><span class="line" data-startTime="1741">write a function &mdash; </span><span class="line" data-startTime="1742">that you can see right here &mdash; </span><span class="line" data-startTime="1744">which will first create a new </span><span class="line" data-startTime="1744">HTML element with the </span><span class="line" data-startTime="1751">template, which we </span><span class="line" data-startTime="1751">defined up here. </span> <span class="line" data-startTime="1753">And what this new Element.html </span><span class="line" data-startTime="1753">does is it actually kind of </span><span class="line" data-startTime="1758">creates a div and injects the </span><span class="line" data-startTime="1758">string as the innerHTML of it. </span> <span class="line" data-startTime="1761">So what you get back, basically, </span><span class="line" data-startTime="1761">is essentially what </span><span class="line" data-startTime="1764">UIBinder was doing as a div </span><span class="line" data-startTime="1764">element with the HTML in it. </span></p>

<p><span class="line" data-startTime="1767">And then once we get that, we </span><span class="line" data-startTime="1767">input it into the DOM, the </span><span class="line" data-startTime="1772">next thing we're going to do is </span><span class="line" data-startTime="1772">run element.query on it and </span><span class="line" data-startTime="1775">look up id nameSpan and then </span><span class="line" data-startTime="1775">assign it to the field </span><span class="line" data-startTime="1779">nameSpan here. </span> <span class="line" data-startTime="1780">So GWT kind of automates that </span><span class="line" data-startTime="1780">part of it, which is </span><span class="line" data-startTime="1784">automatically looking up the </span><span class="line" data-startTime="1784">element for you and then </span><span class="line" data-startTime="1786">signing it. </span> <span class="line" data-startTime="1786">So you actually have to write </span><span class="line" data-startTime="1786">that code yourself here, but </span><span class="line" data-startTime="1789">it's not too bad. </span> <span class="line" data-startTime="1791">But you could make it </span><span class="line" data-startTime="1791">expandable, extensible. </span> <span class="line" data-startTime="1794">So here I have one where we have </span><span class="line" data-startTime="1794">two nameSpan tags in my </span><span class="line" data-startTime="1799">template and I would have </span><span class="line" data-startTime="1799">two fields, like a </span><span class="line" data-startTime="1803">nameSpan1 and a nameSpan2. </span></p>

<p><span class="line" data-startTime="1804">Instead of having fields on my </span><span class="line" data-startTime="1804">object, I use a map, a map </span><span class="line" data-startTime="1808">from the id to the element. </span> <span class="line" data-startTime="1811">And then what I do is I extend </span><span class="line" data-startTime="1811">my setElementByTemplate </span><span class="line" data-startTime="1815">function to take the template, </span><span class="line" data-startTime="1815">which was from up here, and </span><span class="line" data-startTime="1818">take a list of ids to look </span><span class="line" data-startTime="1818">up, which were up here. </span> <span class="line" data-startTime="1823">And then what this is going to </span><span class="line" data-startTime="1823">do is it's going to inject </span><span class="line" data-startTime="1825">this and then document.query </span><span class="line" data-startTime="1825">look up each one of those and </span><span class="line" data-startTime="1829">inject them into </span><span class="line" data-startTime="1829">the map for me. </span> <span class="line" data-startTime="1830">And that's what this basically </span><span class="line" data-startTime="1830">does here. </span> <span class="line" data-startTime="1833">It loops over for each ID and </span><span class="line" data-startTime="1833">then it injects into the map, </span><span class="line" data-startTime="1838">calling element.query </span><span class="line" data-startTime="1838">with the id. </span> <span class="line" data-startTime="1841">And so that's a way to sort </span><span class="line" data-startTime="1841">of make it extensible. </span> <span class="line" data-startTime="1844">So you could have an arbitrary </span><span class="line" data-startTime="1844">number of elements that are </span><span class="line" data-startTime="1847">looked up and automatically </span><span class="line" data-startTime="1847">injected for you, so you can </span><span class="line" data-startTime="1851">cache them and look </span><span class="line" data-startTime="1851">them up later. </span></p>

<p><span class="line" data-startTime="1855">What about instantiated widgets, </span><span class="line" data-startTime="1855">though, right? </span><span class="line" data-startTime="1857">So I just showed you </span><span class="line" data-startTime="1857">HTML tags that </span><span class="line" data-startTime="1859">are in UIBinder templates. </span> <span class="line" data-startTime="1861">But you know that GWT </span><span class="line" data-startTime="1861">does a lot more. </span> <span class="line" data-startTime="1862">So for example, you might use </span><span class="line" data-startTime="1862">HTMLPanel, or Menu item, or </span><span class="line" data-startTime="1866">Tree item, and things </span><span class="line" data-startTime="1866">like that. </span> <span class="line" data-startTime="1868">Well, if it's a basic leaf </span><span class="line" data-startTime="1868">widget in GWT, like an input, </span><span class="line" data-startTime="1872">or a checkbox, or a text area, </span><span class="line" data-startTime="1872">or something, you can just </span><span class="line" data-startTime="1876">replace those with the </span><span class="line" data-startTime="1876">HTML5 equivalents. </span> <span class="line" data-startTime="1879">In fact for GWT, even, we </span><span class="line" data-startTime="1879">recommend actually not using </span><span class="line" data-startTime="1881">heavyweight widgets for stuff </span><span class="line" data-startTime="1881">that's just basic HTML5. </span> <span class="line" data-startTime="1885">It's just too much overhead. </span> <span class="line" data-startTime="1888">But if you have something like a </span><span class="line" data-startTime="1888">composite type that's really </span><span class="line" data-startTime="1891">complex, like a menu </span><span class="line" data-startTime="1891">or a tree &mdash; </span><span class="line" data-startTime="1895">yes, right now, you're going </span><span class="line" data-startTime="1895">to actually need to code </span><span class="line" data-startTime="1897">replacements. </span></p>

<p><span class="line" data-startTime="1898">The good news is you're only </span><span class="line" data-startTime="1898">going to do it once, but yeah, </span><span class="line" data-startTime="1900">you're going to have to write </span><span class="line" data-startTime="1900">your own tree for now. </span> <span class="line" data-startTime="1901">And I expect that as Dart gets a </span><span class="line" data-startTime="1901">larger and larger community, </span><span class="line" data-startTime="1905">even if Dart provides its own </span><span class="line" data-startTime="1905">widget library, probably other </span><span class="line" data-startTime="1909">people are going to </span><span class="line" data-startTime="1909">write their own </span><span class="line" data-startTime="1910">widget libraries too. </span> <span class="line" data-startTime="1911">Someone will have a fancy tree </span><span class="line" data-startTime="1911">or a fancy carousel widget or </span><span class="line" data-startTime="1915">something that is not included </span><span class="line" data-startTime="1915">in the library. </span> <span class="line" data-startTime="1917">So for now, it's an HTML </span><span class="line" data-startTime="1917">experience, but things will </span><span class="line" data-startTime="1924">get better. </span> <span class="line" data-startTime="1925">But if you think it's too hard </span><span class="line" data-startTime="1925">to port widgets, then there's </span><span class="line" data-startTime="1929">an alternate pattern that </span><span class="line" data-startTime="1929">you can use to get your </span><span class="line" data-startTime="1932">feet wet with Dart. </span> <span class="line" data-startTime="1933">Let's say you have an existing </span><span class="line" data-startTime="1933">GWT application and you want </span><span class="line" data-startTime="1939">to kind of try out Dart. </span></p>

<p><span class="line" data-startTime="1940">Maybe you want to write </span><span class="line" data-startTime="1940">a new page. </span> <span class="line" data-startTime="1941">You want to add a new page to </span><span class="line" data-startTime="1941">your application, like a </span><span class="line" data-startTime="1944">settings screen or like a </span><span class="line" data-startTime="1944">feedback page or something. </span> <span class="line" data-startTime="1948">And you want to write that part </span><span class="line" data-startTime="1948">in Dart, but the entire </span><span class="line" data-startTime="1951">rest of the part, you </span><span class="line" data-startTime="1951">want to keep in GWT. </span> <span class="line" data-startTime="1952">So you want to keep your </span><span class="line" data-startTime="1952">application running at all </span><span class="line" data-startTime="1954">times and not throw everything </span><span class="line" data-startTime="1954">away and start from scratch. </span> <span class="line" data-startTime="1958">The good news is that if you use </span><span class="line" data-startTime="1958">the Activities and Places </span><span class="line" data-startTime="1960">model that's been in GWT for a </span><span class="line" data-startTime="1960">while, or if you've always </span><span class="line" data-startTime="1963">been using history tag routing, </span><span class="line" data-startTime="1963">then you could do </span><span class="line" data-startTime="1968">this quite easily. </span> <span class="line" data-startTime="1969">And the way you could </span><span class="line" data-startTime="1969">do it is this. </span> <span class="line" data-startTime="1971">You have your GWT application </span><span class="line" data-startTime="1971">look for history state changes </span><span class="line" data-startTime="1975">in the hashtag. </span> <span class="line" data-startTime="1976">And if the history change is </span><span class="line" data-startTime="1976">one of the things that your </span><span class="line" data-startTime="1979">app understands, then route the </span><span class="line" data-startTime="1979">event to the existing GWT </span><span class="line" data-startTime="1983">code that's going to </span><span class="line" data-startTime="1983">put up that page. </span> <span class="line" data-startTime="1985">But if it's something you don't </span><span class="line" data-startTime="1985">understand, then send a </span><span class="line" data-startTime="1988">message or let it fall through </span><span class="line" data-startTime="1988">to a Dart application that's </span><span class="line" data-startTime="1992">running in the same page. </span></p>

<p><span class="line" data-startTime="1993">So you've source-scripted in the </span><span class="line" data-startTime="1993">GWT module and you've also </span><span class="line" data-startTime="1995">source-scripted in your Dart </span><span class="line" data-startTime="1995">app, and they're both looking </span><span class="line" data-startTime="1997">at the history. </span> <span class="line" data-startTime="1999">And if they agree not to step </span><span class="line" data-startTime="1999">on each other's toes, this </span><span class="line" data-startTime="2001">could work very well. </span> <span class="line" data-startTime="2002">The Dart code could look at </span><span class="line" data-startTime="2002">it and go, well, I don't </span><span class="line" data-startTime="2004">understand that history tag, so </span><span class="line" data-startTime="2004">GWT can probably take care </span><span class="line" data-startTime="2008">of that one. </span> <span class="line" data-startTime="2008">But I see one that's destined </span><span class="line" data-startTime="2008">for me, like the feedback </span><span class="line" data-startTime="2011">page, the new feedback page, so </span><span class="line" data-startTime="2011">I'm basically going to take </span><span class="line" data-startTime="2015">over the main content </span><span class="line" data-startTime="2015">area of the page and </span><span class="line" data-startTime="2018">replace it with my UI. </span></p>

<p><span class="line" data-startTime="2020">Right? </span><span class="line" data-startTime="2021">And so that gives you kind of a </span><span class="line" data-startTime="2021">very high-level integration </span><span class="line" data-startTime="2028">point for putting Dart pages </span><span class="line" data-startTime="2028">into your existing GWT apps. </span> <span class="line" data-startTime="2033">You could migrate page </span><span class="line" data-startTime="2033">at a time that way. </span> <span class="line" data-startTime="2036">Here's a picture, like you </span><span class="line" data-startTime="2036">might have a banking </span><span class="line" data-startTime="2038">application. </span> <span class="line" data-startTime="2040">And so maybe you have an </span><span class="line" data-startTime="2040">existing bill payment service, </span><span class="line" data-startTime="2043">and #billpay on the URL will </span><span class="line" data-startTime="2043">send you to the bill pay </span><span class="line" data-startTime="2046">activity in the GWT app. </span> <span class="line" data-startTime="2048">But you're adding a new page, </span><span class="line" data-startTime="2048">which is banking, like maybe </span><span class="line" data-startTime="2051">bank transfers. </span> <span class="line" data-startTime="2052">And so you've written </span><span class="line" data-startTime="2052">that one in Dart. </span> <span class="line" data-startTime="2054">So what you do is you just have </span><span class="line" data-startTime="2054">the Dart part of the app </span><span class="line" data-startTime="2057">that's sitting in the page look </span><span class="line" data-startTime="2057">for #banking in the URL. </span></p>

<p><span class="line" data-startTime="2060">And that's the signal for it </span><span class="line" data-startTime="2060">to actually take over the </span><span class="line" data-startTime="2064">content area and install </span><span class="line" data-startTime="2064">its view. </span> <span class="line" data-startTime="2068">But if you do this, the very </span><span class="line" data-startTime="2068">next thing you're going to run </span><span class="line" data-startTime="2070">into is, how do you share </span><span class="line" data-startTime="2070">application state? </span><span class="line" data-startTime="2073">I mean, maybe the GWT app just </span><span class="line" data-startTime="2073">did something and now the Dart </span><span class="line" data-startTime="2076">app actually has to get </span><span class="line" data-startTime="2076">what was changed. </span> <span class="line" data-startTime="2079">And so there are a number </span><span class="line" data-startTime="2079">of options for this. </span> <span class="line" data-startTime="2082">One option is, use </span><span class="line" data-startTime="2082">browser storage. </span></p>

<p><span class="line" data-startTime="2085">So you could use IndexDB, </span><span class="line" data-startTime="2085">SessionStorage, or cookies and </span><span class="line" data-startTime="2090">have GWT commit transient </span><span class="line" data-startTime="2090">session-oriented data, let's </span><span class="line" data-startTime="2094">say the current account or </span><span class="line" data-startTime="2094">profile representing the user. </span> <span class="line" data-startTime="2098">Have it committed to IndexDB </span><span class="line" data-startTime="2098">storage in the browser. </span> <span class="line" data-startTime="2101">And then when Dart goes to kick </span><span class="line" data-startTime="2101">off its view, like you </span><span class="line" data-startTime="2103">navigate to the banking page, </span><span class="line" data-startTime="2103">then it's going to read from </span><span class="line" data-startTime="2108">the database and get things </span><span class="line" data-startTime="2108">related to the user, like his </span><span class="line" data-startTime="2111">name, his current account, </span><span class="line" data-startTime="2111">authentication tokens to let </span><span class="line" data-startTime="2114">him make transfers, and </span><span class="line" data-startTime="2114">things like that. </span> <span class="line" data-startTime="2117">The other option is, you could </span><span class="line" data-startTime="2117">put serialized data objects </span><span class="line" data-startTime="2119">into the DOM. </span></p>

<p><span class="line" data-startTime="2120">So if you want Dart to pick up </span><span class="line" data-startTime="2120">something that GWT has to send </span><span class="line" data-startTime="2125">to it, one option is just create </span><span class="line" data-startTime="2125">an element, like a div </span><span class="line" data-startTime="2127">element, use display none, and </span><span class="line" data-startTime="2127">put some data in there. </span> <span class="line" data-startTime="2131">And then give it an </span><span class="line" data-startTime="2131">id, like an id = </span><span class="line" data-startTime="2134">data object or something. </span> <span class="line" data-startTime="2135">And then just have Dart </span><span class="line" data-startTime="2135">look it up and parse </span><span class="line" data-startTime="2137">the JSON out of it. </span> <span class="line" data-startTime="2138">That's another option. </span> <span class="line" data-startTime="2140">Probably the cleanest mechanism </span><span class="line" data-startTime="2143">is just to use messaging. </span> <span class="line" data-startTime="2144">So in the new HTML5 browsers. </span> <span class="line" data-startTime="2144">you have window.postMessage(). </span> <span class="line" data-startTime="2147">So you can use this </span><span class="line" data-startTime="2147">for communication </span><span class="line" data-startTime="2149">between GWT and Dart. </span> <span class="line" data-startTime="2150">Have Dart listen on window </span><span class="line" data-startTime="2150">object for messages and just </span><span class="line" data-startTime="2152">have GWT post messages, so you </span><span class="line" data-startTime="2152">can transfer data back and </span><span class="line" data-startTime="2155">forth between the two running </span><span class="line" data-startTime="2155">apps that way. </span> <span class="line" data-startTime="2161">So one thing, as a GWT </span><span class="line" data-startTime="2161">programmer, you're probably </span><span class="line" data-startTime="2165">wondering about is something </span><span class="line" data-startTime="2165">like JSNI. </span></p>

<p><span class="line" data-startTime="2168">And we got a lot of mileage </span><span class="line" data-startTime="2168">out of that with GWT. </span> <span class="line" data-startTime="2171">Early on in GWT's adoption, </span><span class="line" data-startTime="2171">there were a lot of JavaScript </span><span class="line" data-startTime="2174">libraries out there. </span> <span class="line" data-startTime="2175">We didn't have really </span><span class="line" data-startTime="2175">killer widgets. </span> <span class="line" data-startTime="2177">GWT widgets really looked </span><span class="line" data-startTime="2177">terrible out of the box. </span> <span class="line" data-startTime="2179">And so people we're going and </span><span class="line" data-startTime="2179">picking up jQuery or picking </span><span class="line" data-startTime="2182">up Ext JS and things like </span><span class="line" data-startTime="2182">that and they were </span><span class="line" data-startTime="2184">wrapping them with GWT. </span> <span class="line" data-startTime="2185">And that really held people over </span><span class="line" data-startTime="2185">until we could actually </span><span class="line" data-startTime="2188">deliver better widgets </span><span class="line" data-startTime="2188">in later versions. </span> <span class="line" data-startTime="2189">And so you might be thinking, </span><span class="line" data-startTime="2189">well I'll do that for Dart. </span> <span class="line" data-startTime="2192">I'll use Dart and I'll wrap some </span><span class="line" data-startTime="2192">cool widgets until the </span><span class="line" data-startTime="2196">Dart team delivers the </span><span class="line" data-startTime="2196">better widget set. </span></p>

<p><span class="line" data-startTime="2198">Unfortunately, Dart does </span><span class="line" data-startTime="2198">not have JSNI. </span> <span class="line" data-startTime="2201">And there's a very good </span><span class="line" data-startTime="2201">reason for that. </span> <span class="line" data-startTime="2203">And so you might think of </span><span class="line" data-startTime="2203">Dart as it is today as </span><span class="line" data-startTime="2206">a Dart-to-JS compiler. </span> <span class="line" data-startTime="2208">But Dart as it's envisioned is </span><span class="line" data-startTime="2208">actually a virtual machine </span><span class="line" data-startTime="2212">that runs just like V8 does, </span><span class="line" data-startTime="2212">but it runs Dart code. </span> <span class="line" data-startTime="2216">And so because it's another </span><span class="line" data-startTime="2216">virtual machine in the </span><span class="line" data-startTime="2218">browser, it's separate </span><span class="line" data-startTime="2218">from V8. </span> <span class="line" data-startTime="2220">It has a separate heap. </span> <span class="line" data-startTime="2221">So you can't just pass an object </span><span class="line" data-startTime="2221">reference from one to </span><span class="line" data-startTime="2223">the other, because they live </span><span class="line" data-startTime="2223">in different memory spaces. </span> <span class="line" data-startTime="2226">Probably even different </span><span class="line" data-startTime="2226">process sandboxes. </span> <span class="line" data-startTime="2228">So that wouldn't be very </span><span class="line" data-startTime="2228">efficient, even if you could </span><span class="line" data-startTime="2232">pull it off. </span> <span class="line" data-startTime="2234">But there still is a need for </span><span class="line" data-startTime="2234">you to make calls from Dart to </span><span class="line" data-startTime="2239">JavaScript and vice versa. </span></p>

<p><span class="line" data-startTime="2240">There's no question </span><span class="line" data-startTime="2240">about that. </span> <span class="line" data-startTime="2242">There is a need to do that. </span> <span class="line" data-startTime="2243">Like, you might want to interact </span><span class="line" data-startTime="2243">with the Maps API </span><span class="line" data-startTime="2245">from Google, and there's </span><span class="line" data-startTime="2245">no Dart Maps API yet. </span> <span class="line" data-startTime="2249">And so there has to be </span><span class="line" data-startTime="2249">a way to do this. </span> <span class="line" data-startTime="2251">And fortunately, there </span><span class="line" data-startTime="2251">is a way to do it. </span> <span class="line" data-startTime="2254">There's an unofficial way &mdash; </span><span class="line" data-startTime="2257">quite a few, actually, which </span><span class="line" data-startTime="2257">I'm going to show you. </span> <span class="line" data-startTime="2259">And I'm going to make you a </span><span class="line" data-startTime="2259">promise that we're actually </span><span class="line" data-startTime="2261">working on it, and actually, a </span><span class="line" data-startTime="2261">real nice solution will be </span><span class="line" data-startTime="2264">coming later down the pipe. </span> <span class="line" data-startTime="2266">So what are the ways </span><span class="line" data-startTime="2266">we can do this? </span><span class="line" data-startTime="2269">Well one way is this </span><span class="line" data-startTime="2269">postMessage() communication, </span><span class="line" data-startTime="2271">like I just discussed. </span> <span class="line" data-startTime="2273">So what you could do is you </span><span class="line" data-startTime="2273">could have JavaScript listen </span><span class="line" data-startTime="2277">for window.onmessage, and </span><span class="line" data-startTime="2277">anything that basically comes </span><span class="line" data-startTime="2281">in through a message, you </span><span class="line" data-startTime="2281">just run eval on it. </span> <span class="line" data-startTime="2284">And then likewise, in </span><span class="line" data-startTime="2284">the Dart world &mdash; </span><span class="line" data-startTime="2287">this is Dart code here &mdash; </span><span class="line" data-startTime="2289">you do postMessage, and in </span><span class="line" data-startTime="2289">there you put JavaScript. </span></p>

<p><span class="line" data-startTime="2291">And then so the JavaScript event </span><span class="line" data-startTime="2291">handler gets triggered </span><span class="line" data-startTime="2294">and it just runs eval. </span> <span class="line" data-startTime="2295">So I've made a call from Dart </span><span class="line" data-startTime="2295">to JavaScript in that way. </span> <span class="line" data-startTime="2300">It's not pretty, but it works. </span> <span class="line" data-startTime="2302">Another solution that people do, </span><span class="line" data-startTime="2302">because you have a little </span><span class="line" data-startTime="2306">bit more control, is script </span><span class="line" data-startTime="2306">tag injections. </span> <span class="line" data-startTime="2308">So in Dart code, you could just </span><span class="line" data-startTime="2308">create a script tag, set </span><span class="line" data-startTime="2312">its text attribute to be the </span><span class="line" data-startTime="2312">JavaScript text, and insert it </span><span class="line" data-startTime="2316">into the body of the browser </span><span class="line" data-startTime="2316">document, and it </span><span class="line" data-startTime="2319">will just be evaluated. </span> <span class="line" data-startTime="2321">But that's only uni-directional </span><span class="line" data-startTime="2321">communication, </span><span class="line" data-startTime="2325">and you can't build an API if </span><span class="line" data-startTime="2325">you can't get any values back </span><span class="line" data-startTime="2330">after you evaluate the code. </span> <span class="line" data-startTime="2333">You could have bi-directional </span><span class="line" data-startTime="2333">messaging. </span></p>

<p><span class="line" data-startTime="2335">So I could send the message to </span><span class="line" data-startTime="2335">JavaScript, and it'll say, </span><span class="line" data-startTime="2337">call this method on Google </span><span class="line" data-startTime="2337">Maps for me. </span> <span class="line" data-startTime="2340">Google Maps dot </span><span class="line" data-startTime="2340">setCurrentLongitude = 10. </span> <span class="line" data-startTime="2343">But the problem is, I can't get </span><span class="line" data-startTime="2343">any return value from that </span><span class="line" data-startTime="2347">function back. </span> <span class="line" data-startTime="2348">You could make the JavaScript </span><span class="line" data-startTime="2348">then post the message back to </span><span class="line" data-startTime="2350">Dart and have Dart listen for a </span><span class="line" data-startTime="2350">message, which then has the </span><span class="line" data-startTime="2353">return value in it. </span> <span class="line" data-startTime="2354">And in that case, it would </span><span class="line" data-startTime="2354">look very much like </span><span class="line" data-startTime="2356">asynchronous JSON-RPC back and </span><span class="line" data-startTime="2356">forth between the server. </span> <span class="line" data-startTime="2362">But the API that could be built </span><span class="line" data-startTime="2362">around that would look </span><span class="line" data-startTime="2366">pretty nasty. </span> <span class="line" data-startTime="2366">For example, every getter and </span><span class="line" data-startTime="2366">setter would have to take a </span><span class="line" data-startTime="2369">closure that would be called </span><span class="line" data-startTime="2369">back into with the return </span><span class="line" data-startTime="2373">value when it was ready. </span> <span class="line" data-startTime="2375">You have got to remember, </span><span class="line" data-startTime="2375">the browser isn't always </span><span class="line" data-startTime="2377">synchronous. </span> <span class="line" data-startTime="2377">So if you ask the browser to do </span><span class="line" data-startTime="2377">something, it could do it </span><span class="line" data-startTime="2380">immediately, or actually, </span><span class="line" data-startTime="2380">it could do it </span><span class="line" data-startTime="2382">at next event loop. </span></p>

<p><span class="line" data-startTime="2384">And so you have to basically </span><span class="line" data-startTime="2384">pass it a callback because it </span><span class="line" data-startTime="2388">could be executed </span><span class="line" data-startTime="2388">at a later time. </span> <span class="line" data-startTime="2390">And so this would lead to a </span><span class="line" data-startTime="2390">really poor API experience. </span> <span class="line" data-startTime="2395">But it turns out, there's </span><span class="line" data-startTime="2395">actually an API in a browser. </span> <span class="line" data-startTime="2399">It's one of the very few </span><span class="line" data-startTime="2399">synchronous XHRs or another </span><span class="line" data-startTime="2402">that actually is synchronous, </span><span class="line" data-startTime="2402">meaning it actually blocks </span><span class="line" data-startTime="2407">until it finishes executing. </span> <span class="line" data-startTime="2410">And it's called dispatchEvent(). </span> <span class="line" data-startTime="2412">And what it allows you to do is </span><span class="line" data-startTime="2412">to fire off an event, like </span><span class="line" data-startTime="2415">onClick or something like that, </span><span class="line" data-startTime="2415">and it will be handled </span><span class="line" data-startTime="2418">immediately. </span> <span class="line" data-startTime="2419">Not the next time the browser </span><span class="line" data-startTime="2419">goes to the event loop, or </span><span class="line" data-startTime="2423">after all the set timeouts </span><span class="line" data-startTime="2423">run, but right now. </span> <span class="line" data-startTime="2426">And so that gives us a hack or </span><span class="line" data-startTime="2426">sort of a doorway to get true </span><span class="line" data-startTime="2430">synchronous bi-directional </span><span class="line" data-startTime="2430">messaging between Dart and </span><span class="line" data-startTime="2433">JavaScript. </span></p>

<p><span class="line" data-startTime="2434">And the essential way you'll </span><span class="line" data-startTime="2434">do it is this. </span> <span class="line" data-startTime="2437">You're going to invent a </span><span class="line" data-startTime="2437">new custom event name. </span> <span class="line" data-startTime="2443">And you can do that </span><span class="line" data-startTime="2443">in JavaScript. </span> <span class="line" data-startTime="2444">You can make your own events. </span> <span class="line" data-startTime="2445">You don't have to just use </span><span class="line" data-startTime="2445">onClick or mouseover. </span> <span class="line" data-startTime="2447">And I'll call it 'dartjsni', </span><span class="line" data-startTime="2447">just for GWT'S sake. </span> <span class="line" data-startTime="2452">And then what you're going to do </span><span class="line" data-startTime="2452">is you're going to register </span><span class="line" data-startTime="2454">an event listener in Dart via </span><span class="line" data-startTime="2454">window.addEventListener and </span><span class="line" data-startTime="2457">look for this 'dartjsni' event </span><span class="line" data-startTime="2457">to happen, and do something </span><span class="line" data-startTime="2463">when it does happen. </span> <span class="line" data-startTime="2464">And then you're going to </span><span class="line" data-startTime="2464">construct a serialization </span><span class="line" data-startTime="2466">format for RPC calls. </span></p>

<p><span class="line" data-startTime="2467">Maybe you just take the method </span><span class="line" data-startTime="2467">name and all the arguments </span><span class="line" data-startTime="2469">that you want to call and you </span><span class="line" data-startTime="2469">serialize them in a JSON </span><span class="line" data-startTime="2471">object or something. </span> <span class="line" data-startTime="2473">And you have the callback </span><span class="line" data-startTime="2473">that's looking for that </span><span class="line" data-startTime="2476">'dartjsni' event deserialize </span><span class="line" data-startTime="2476">it and evaluate it. </span> <span class="line" data-startTime="2480">Then you're going to invent </span><span class="line" data-startTime="2480">another event name &mdash; let's </span><span class="line" data-startTime="2482">call it 'returnjsni' &mdash; </span><span class="line" data-startTime="2484">and it's going to take the </span><span class="line" data-startTime="2484">return value, serialize it, </span><span class="line" data-startTime="2486">and then fire via </span><span class="line" data-startTime="2486">window.dispatchEvent this </span><span class="line" data-startTime="2488">'returnjsni' event. </span> <span class="line" data-startTime="2492">And then in the Dart code, </span><span class="line" data-startTime="2492">you're going to be looking for </span><span class="line" data-startTime="2494">window.OnDartjsni event handler, </span><span class="line" data-startTime="2494">and that's going to </span><span class="line" data-startTime="2500">be the return value. </span></p>

<p><span class="line" data-startTime="2502">And what makes this all work </span><span class="line" data-startTime="2502">is that when both sides use </span><span class="line" data-startTime="2504">dispatchEvent(), there </span><span class="line" data-startTime="2504">is no asynchronicity. </span> <span class="line" data-startTime="2508">You fire the event and it </span><span class="line" data-startTime="2508">immediately evokes the </span><span class="line" data-startTime="2510">callback on the JavaScript </span><span class="line" data-startTime="2510">side. </span> <span class="line" data-startTime="2511">The JavaScript side does the </span><span class="line" data-startTime="2511">evaluation and invokes </span><span class="line" data-startTime="2514">dispatchEvent for 'returnjsni' </span><span class="line" data-startTime="2514">and it immediately runs the </span><span class="line" data-startTime="2516">Dart event handler, all in </span><span class="line" data-startTime="2516">one synchronous loop. </span> <span class="line" data-startTime="2522">This is just a picture of it. </span> <span class="line" data-startTime="2523">It's probably not very </span><span class="line" data-startTime="2523">useful for you. </span> <span class="line" data-startTime="2525">But I tried to draw </span><span class="line" data-startTime="2525">how it would work. </span> <span class="line" data-startTime="2530">I'm just going to skip </span><span class="line" data-startTime="2530">that picture for now. </span></p>

<p><span class="line" data-startTime="2532">So you could make the </span><span class="line" data-startTime="2532">JSNI mappings even </span><span class="line" data-startTime="2536">more natural, right? </span><span class="line" data-startTime="2537">Like what if you just wanted </span><span class="line" data-startTime="2537">to have a Dart object, and </span><span class="line" data-startTime="2541">when you refer on that Dart </span><span class="line" data-startTime="2541">object to any field or any </span><span class="line" data-startTime="2544">method, it actually is kind of </span><span class="line" data-startTime="2544">a mirror or a proxy directly </span><span class="line" data-startTime="2547">into JavaScript. </span> <span class="line" data-startTime="2548">It kind of represents a </span><span class="line" data-startTime="2548">JavaScript object on the other </span><span class="line" data-startTime="2550">side of the fence. </span> <span class="line" data-startTime="2552">And so Dart has two features </span><span class="line" data-startTime="2552">that actually almost make this </span><span class="line" data-startTime="2555">look completely natural and </span><span class="line" data-startTime="2555">almost like the JavaScript's </span><span class="line" data-startTime="2559">not even involved. </span> <span class="line" data-startTime="2559">The first is operator </span><span class="line" data-startTime="2559">overloading. </span></p>

<p><span class="line" data-startTime="2562">So you can implement </span><span class="line" data-startTime="2562">the operator[] &mdash; </span><span class="line" data-startTime="2565">and here I have a class </span><span class="line" data-startTime="2565">called JsProxy &mdash; </span><span class="line" data-startTime="2567">and it takes a field name. </span> <span class="line" data-startTime="2569">And then what you do is you </span><span class="line" data-startTime="2569">make that synchronous call </span><span class="line" data-startTime="2572">over using that Dart </span><span class="line" data-startTime="2572">JSNI method I just </span><span class="line" data-startTime="2574">described how you'd do. </span> <span class="line" data-startTime="2576">And you index the field name on </span><span class="line" data-startTime="2576">the object reference that </span><span class="line" data-startTime="2580">you're holding on to, that this </span><span class="line" data-startTime="2580">proxy object represents. </span> <span class="line" data-startTime="2584">Dart has another feature I </span><span class="line" data-startTime="2584">haven't described yet. </span> <span class="line" data-startTime="2586">Because it's a dynamic language, </span><span class="line" data-startTime="2586">what I said earlier </span><span class="line" data-startTime="2590">was is that you can try to </span><span class="line" data-startTime="2590">access or invoke anything on </span><span class="line" data-startTime="2594">an object, even though it's the </span><span class="line" data-startTime="2594">wrong type, and it will </span><span class="line" data-startTime="2596">still try it. </span> <span class="line" data-startTime="2597">And if it fails, it doesn't </span><span class="line" data-startTime="2597">fail completely. </span></p>

<p><span class="line" data-startTime="2600">What it does is it invokes </span><span class="line" data-startTime="2600">noSuchMethod. </span> <span class="line" data-startTime="2602">So it's a magical method. </span> <span class="line" data-startTime="2604">You could put it on a Dart class </span><span class="line" data-startTime="2604">to override it, and it </span><span class="line" data-startTime="2607">will be called for any method </span><span class="line" data-startTime="2607">that it can't find, that </span><span class="line" data-startTime="2609">someone tried to invoke. </span> <span class="line" data-startTime="2610">And so in this way, you could </span><span class="line" data-startTime="2610">make a JsProxy class that can </span><span class="line" data-startTime="2615">invoke any JavaScript method </span><span class="line" data-startTime="2615">that exists in the JSVM by </span><span class="line" data-startTime="2620">defining a noSuchMethod. </span> <span class="line" data-startTime="2622">It takes the name of the method </span><span class="line" data-startTime="2622">someone's trying to </span><span class="line" data-startTime="2623">invoke and a list of the </span><span class="line" data-startTime="2623">arguments, and then you just </span><span class="line" data-startTime="2625">make a synchronous call using </span><span class="line" data-startTime="2625">what I just described in the </span><span class="line" data-startTime="2628">previous slide. </span></p>

<p><span class="line" data-startTime="2629">And it will return the value as </span><span class="line" data-startTime="2629">if that method existed on </span><span class="line" data-startTime="2633">the JsProxy object by going to </span><span class="line" data-startTime="2633">JavaScript and asking it to </span><span class="line" data-startTime="2637">evaluate it. </span> <span class="line" data-startTime="2639">So that's another interesting </span><span class="line" data-startTime="2639">idiom or </span><span class="line" data-startTime="2641">example you could use. </span> <span class="line" data-startTime="2644">And if you wanted to invoke GWT </span><span class="line" data-startTime="2644">code directly from Dart or </span><span class="line" data-startTime="2648">vice versa, I would advocate </span><span class="line" data-startTime="2648">using a library I wrote called </span><span class="line" data-startTime="2651">GWT Exporter. </span> <span class="line" data-startTime="2652">And what that allows you to do </span><span class="line" data-startTime="2652">is to put @Export annotations </span><span class="line" data-startTime="2656">on your classes and </span><span class="line" data-startTime="2656">Java methods. </span> <span class="line" data-startTime="2658">And what it does is it manually </span><span class="line" data-startTime="2658">declares JavaScript </span><span class="line" data-startTime="2663">exports in the top-level window </span><span class="line" data-startTime="2663">object of the page. </span> <span class="line" data-startTime="2667">And then once you've got those </span><span class="line" data-startTime="2667">things exposed to JavaScript, </span><span class="line" data-startTime="2669">then you can use the Dart JSNI </span><span class="line" data-startTime="2669">method technique I showed you </span><span class="line" data-startTime="2672">to just call directly </span><span class="line" data-startTime="2672">into GWT. </span></p>

<p><span class="line" data-startTime="2675">Likewise, if you wanted to do </span><span class="line" data-startTime="2675">it the other way around, you </span><span class="line" data-startTime="2678">could export Dart functions into </span><span class="line" data-startTime="2678">JavaScript by writing a </span><span class="line" data-startTime="2682">JavaScript function which, when </span><span class="line" data-startTime="2682">invoked, uses the Dart </span><span class="line" data-startTime="2686">JSNI mechanism to send a message </span><span class="line" data-startTime="2686">over to Dart and say, </span><span class="line" data-startTime="2689">I'm invoking this method </span><span class="line" data-startTime="2689">on this Dart class. </span> <span class="line" data-startTime="2692">However what I've just shown </span><span class="line" data-startTime="2692">you, it's really complicated </span><span class="line" data-startTime="2697">and it's kind of a hack. </span> <span class="line" data-startTime="2698">And I would not advocate using </span><span class="line" data-startTime="2698">it, except for specialized </span><span class="line" data-startTime="2701">scenarios like trying to create </span><span class="line" data-startTime="2701">a really nice mapping </span><span class="line" data-startTime="2704">for, like, the Google Maps </span><span class="line" data-startTime="2704">library or some other </span><span class="line" data-startTime="2706">JavaScript library, where it </span><span class="line" data-startTime="2706">would be painful to have an </span><span class="line" data-startTime="2709">asynchronous approach. </span> <span class="line" data-startTime="2711">Otherwise, I would suggest, </span><span class="line" data-startTime="2711">just use postMessage. </span></p>

<p><span class="line" data-startTime="2713">It's the easiest thing and </span><span class="line" data-startTime="2713">the least likely to fail. </span> <span class="line" data-startTime="2717">And for the record, we actually </span><span class="line" data-startTime="2717">don't know how much </span><span class="line" data-startTime="2720">longer dispatch will </span><span class="line" data-startTime="2720">be around. </span> <span class="line" data-startTime="2721">It could very well be that the </span><span class="line" data-startTime="2721">HTML5 committee could say </span><span class="line" data-startTime="2724">tomorrow, we're removing that. </span> <span class="line" data-startTime="2728">So in summary I just wanted to </span><span class="line" data-startTime="2728">say that Dart is a cool new </span><span class="line" data-startTime="2733">dynamic language. </span> <span class="line" data-startTime="2735">It takes some of the best things </span><span class="line" data-startTime="2735">from JavaScript, which </span><span class="line" data-startTime="2737">is the ability to start up </span><span class="line" data-startTime="2737">quickly without a compile </span><span class="line" data-startTime="2740">pass, to have the program </span><span class="line" data-startTime="2740">run even though </span><span class="line" data-startTime="2744">the types are wrong. </span></p>

<p><span class="line" data-startTime="2745">So you can iterate on </span><span class="line" data-startTime="2745">something, even </span><span class="line" data-startTime="2747">if you've got errors. </span> <span class="line" data-startTime="2749">But also to allow the language </span><span class="line" data-startTime="2749">to be tooled and tested with </span><span class="line" data-startTime="2753">compile-time static </span><span class="line" data-startTime="2753">tool chains. </span> <span class="line" data-startTime="2756">It offers a lightweight DOM </span><span class="line" data-startTime="2756">programming library for now, </span><span class="line" data-startTime="2760">but later on, it will have </span><span class="line" data-startTime="2760">a very rich library. </span> <span class="line" data-startTime="2762">That's the whole point of </span><span class="line" data-startTime="2762">having a structured </span><span class="line" data-startTime="2764">programming language. </span> <span class="line" data-startTime="2765">They invented all of this new </span><span class="line" data-startTime="2765">syntax for a type system. </span> <span class="line" data-startTime="2768">They're going to build </span><span class="line" data-startTime="2768">a really rich </span><span class="line" data-startTime="2769">library to support it. </span> <span class="line" data-startTime="2771">It's not going to be very raw </span><span class="line" data-startTime="2771">and basic like JavaScript. </span> <span class="line" data-startTime="2775">Try converting some simple </span><span class="line" data-startTime="2775">GWT libraries. </span> <span class="line" data-startTime="2777">Get your feet wet. </span> <span class="line" data-startTime="2778">Pick the simplest thing in your </span><span class="line" data-startTime="2778">project and say, what </span><span class="line" data-startTime="2780">would this look like in Dart? </span><span class="line" data-startTime="2781">Just play around with it. </span> <span class="line" data-startTime="2782">Have some fun. </span> <span class="line" data-startTime="2783">Or integrate &mdash; </span><span class="line" data-startTime="2784">try to add a new page your app </span><span class="line" data-startTime="2784">by basically writing it in </span><span class="line" data-startTime="2787">Dart and using the hashtag </span><span class="line" data-startTime="2787">history routing to integrate </span><span class="line" data-startTime="2790">it into the page. </span></p>

<p><span class="line" data-startTime="2793">I would advocate, even if you're </span><span class="line" data-startTime="2793">not going to use Dart, </span><span class="line" data-startTime="2795">to look at the GWT Activities </span><span class="line" data-startTime="2795">and Places model if you're not </span><span class="line" data-startTime="2798">using it already. </span> <span class="line" data-startTime="2798">Because it will help </span><span class="line" data-startTime="2798">you in the future. </span> <span class="line" data-startTime="2801">And finally, if you're really </span><span class="line" data-startTime="2801">adventurous, try hacking a </span><span class="line" data-startTime="2805">Dart JSNI library. </span> <span class="line" data-startTime="2808">You could probably release it, </span><span class="line" data-startTime="2808">and if you do it quick enough, </span><span class="line" data-startTime="2811">everyone might use it. </span> <span class="line" data-startTime="2814">So that's my presentation. </span> <span class="line" data-startTime="2816">Hope you guys got something </span><span class="line" data-startTime="2816">out of it. </span> <span class="line" data-startTime="2818">And I'm open to taking </span><span class="line" data-startTime="2818">some questions. </span> <span class="line" data-startTime="2820">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="2828"><span class="speakerName">Audience</span>: Yeah. </span><span class="line" data-startTime="2829">You mentioned </span><span class="line" data-startTime="2829">internationalization and </span><span class="line" data-startTime="2832">string interpolation. </span></p>

<p class="speaker"><span class="line" data-starttime="2833"><span class="speakerName">Ray Cromwell</span>: Yes. </span></p>

<p class="speaker"><span class="line" data-starttime="2835"><span class="speakerName">Audience</span>: I wonder, do you have </span><span class="line" data-startTime="2835">an example of that, like </span><span class="line" data-startTime="2839">how it works in Dart? </span><span class="line" data-startTime="2841">I'm using it in GWT, but to </span><span class="line" data-startTime="2841">migrate some stuff, I'm going </span><span class="line" data-startTime="2843">to need to move it do Dart. </span></p>

<p class="speaker"><span class="line" data-starttime="2845"><span class="speakerName">Ray Cromwell</span>: Yeah, that's </span><span class="line" data-startTime="2845">a good question for me. </span><span class="line" data-startTime="2847">[INAUDIBLE], do you happen </span><span class="line" data-startTime="2847">to know the idiom for </span><span class="line" data-startTime="2850">doing that in Dart? </span></p>

<p class="speaker"><span class="line" data-starttime="2851"><span class="speakerName">Audience</span>: [INAUDIBLE] </span></p>

<p class="speaker"><span class="line" data-starttime="2854"><span class="speakerName">Ray Cromwell</span>: What I was </span><span class="line" data-startTime="2854">thinking of, when I wrote </span><span class="line" data-startTime="2855">that, was basically using the </span><span class="line" data-startTime="2855">string interpolation to define </span><span class="line" data-startTime="2859">the templates like you would do </span><span class="line" data-startTime="2859">it in a Messages class in </span><span class="line" data-startTime="2863">GWT and basically create the </span><span class="line" data-startTime="2863">equivalent of a Dart </span><span class="line" data-startTime="2868">ResourceBundle but using </span><span class="line" data-startTime="2868">JSON structures. </span><span class="line" data-startTime="2871">And then write in a little </span><span class="line" data-startTime="2871">utility library to basically </span><span class="line" data-startTime="2874">perform the equivalent of what </span><span class="line" data-startTime="2874">gets code generated in GWT, </span><span class="line" data-startTime="2876">which is to take the template </span><span class="line" data-startTime="2876">and basically apply the JSON </span><span class="line" data-startTime="2880">to it to fill out </span><span class="line" data-startTime="2880">the template. </span><span class="line" data-startTime="2882">Yeah, sorry. </span><span class="line" data-startTime="2883">I probably should have fleshed </span><span class="line" data-startTime="2883">that out more. </span><span class="line" data-startTime="2885">I probably ran out of time, </span><span class="line" data-startTime="2885">doing my slides. </span></p>

<p class="speaker"><span class="line" data-starttime="2888"><span class="speakerName">Audience</span>: That's fine. </span><span class="line" data-startTime="2889">And I'm looking for something a </span><span class="line" data-startTime="2889">little bit more formal with </span><span class="line" data-startTime="2893">the Places and Activities. </span><span class="line" data-startTime="2894">Is there something like </span><span class="line" data-startTime="2894">that planned for Dart? </span><span class="line" data-startTime="2896">Or is it just like window.on </span><span class="line" data-startTime="2896">listening </span><span class="line" data-startTime="2901">for that native event? </span></p>

<p class="speaker"><span class="line" data-starttime="2902"><span class="speakerName">Ray Cromwell</span>: Yeah I don't </span><span class="line" data-startTime="2902">know the answer to that. </span><span class="line" data-startTime="2904">But I believe the Dart team is </span><span class="line" data-startTime="2904">working on rich object models. </span><span class="line" data-startTime="2908">And they're probably looking </span><span class="line" data-startTime="2908">at MBC or MBP. </span><span class="line" data-startTime="2910">Do you happen to know, Vijay? </span><span class="line" data-startTime="2912">VIJAY:MENON: [INAUDIBLE] </span></p>

<p class="speaker"><span class="line" data-starttime="2933"><span class="speakerName">Ray Cromwell</span>: So just in case no </span><span class="line" data-startTime="2933">one heard that, they built </span><span class="line" data-startTime="2935">a really nice application </span><span class="line" data-startTime="2935">called Swarm. </span> <span class="line" data-startTime="2937">And what they're doing is </span><span class="line" data-startTime="2937">they're taking the lessons </span><span class="line" data-startTime="2939">learned from building that rich </span><span class="line" data-startTime="2939">UI and the way they've </span><span class="line" data-startTime="2942">organized it and basically </span><span class="line" data-startTime="2942">trying to extract the </span><span class="line" data-startTime="2945">libraries and the patterns out </span><span class="line" data-startTime="2945">of it that they're going to </span><span class="line" data-startTime="2948">use for Dart. </span> <span class="line" data-startTime="2949">And so I don't think that </span><span class="line" data-startTime="2949">they have anything </span><span class="line" data-startTime="2951">today that's concrete. </span> <span class="line" data-startTime="2952">But I do believe that &mdash; because </span><span class="line" data-startTime="2952">Seth Ladd is heavily </span><span class="line" data-startTime="2958">involved in interacting with </span><span class="line" data-startTime="2958">the community who's </span><span class="line" data-startTime="2963">dealing with Dart. </span> <span class="line" data-startTime="2964">And Seth is a really big fan </span><span class="line" data-startTime="2964">of MBC and MBP stuff. </span></p>

<p><span class="line" data-startTime="2968">So there probably will be </span><span class="line" data-startTime="2968">something that great. </span> <span class="line" data-startTime="2971">But sorry, I don't </span><span class="line" data-startTime="2971">know the answer. </span></p>

<p class="speaker"><span class="line" data-starttime="2973"><span class="speakerName">Audience</span>: That's OK. </span><span class="line" data-startTime="2973">Last question, I promise. </span><span class="line" data-startTime="2975">When I last looked at Dart, </span><span class="line" data-startTime="2975">it said "Alpha" on it. </span><span class="line" data-startTime="2978">Do we know when it's going </span><span class="line" data-startTime="2978">to be promoted? </span></p>

<p class="speaker"><span class="line" data-starttime="2982"><span class="speakerName">Ray Cromwell</span>: Is Lars </span><span class="line" data-startTime="2982">or Vijay here? </span><span class="line" data-startTime="2984">Vijay, do you want </span><span class="line" data-startTime="2984">to take that? </span><span class="line" data-startTime="2986">VIJAY MENON: [INAUDIBLE] </span></p>

<p class="speaker"><span class="line" data-starttime="2989"><span class="speakerName">Ray Cromwell</span>: I'll </span><span class="line" data-startTime="2989">just repeat you. </span></p>

<p class="speaker"><span class="line" data-starttime="2990"><span class="speakerName">Vijay Menon</span>: You can get an </span><span class="line" data-startTime="2990">official answer from Lars. </span><span class="line" data-startTime="2993">[INAUDIBLE] </span></p>

<p class="speaker"><span class="line" data-starttime="2996"><span class="speakerName">Ray Cromwell</span>: Ah. </span></p>

<p class="speaker"><span class="line" data-starttime="2997"><span class="speakerName">Vijay Menon</span>: My understanding </span><span class="line" data-startTime="2997">is that later this year, </span><span class="line" data-startTime="3000">there'll be more of an official </span><span class="line" data-startTime="3000">release, but I'm not </span><span class="line" data-startTime="3003">exactly sure we've said </span><span class="line" data-startTime="3003">what the date is </span><span class="line" data-startTime="3005">going to be on that. </span></p>

<p class="speaker"><span class="line" data-starttime="3006"><span class="speakerName">Audience</span>: OK. </span></p>

<p class="speaker"><span class="line" data-starttime="3007"><span class="speakerName">Ray Cromwell</span>: So later this </span><span class="line" data-startTime="3007">year, there will be an </span><span class="line" data-startTime="3008">official answer. </span><span class="line" data-startTime="3009">But if you go talk to Lars, </span><span class="line" data-startTime="3009">just track him down &mdash; </span><span class="line" data-startTime="3011">he's kind of a very tall </span><span class="line" data-startTime="3011">guy with glasses &mdash; </span><span class="line" data-startTime="3014">he could probably give you </span><span class="line" data-startTime="3014">a more concrete answer. </span><span class="line" data-startTime="3016">But I do believe, at least </span><span class="line" data-startTime="3016">from my own personal </span><span class="line" data-startTime="3017">experience, the language spec </span><span class="line" data-startTime="3017">seems to be settling down very </span><span class="line" data-startTime="3020">nicely now. </span><span class="line" data-startTime="3021">And so it's probably </span><span class="line" data-startTime="3021">going to exit the </span><span class="line" data-startTime="3023">Alpha phase very soon. </span></p>

<p class="speaker"><span class="line" data-starttime="3025"><span class="speakerName">Audience</span>: Great. </span><span class="line" data-startTime="3025">Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="3025"><span class="speakerName">Ray Cromwell</span>: But that shouldn't </span><span class="line" data-startTime="3025">dissuade you from </span><span class="line" data-startTime="3027">trying it, right? </span><span class="line" data-startTime="3028">Have some fun with it. </span></p>

<p class="speaker"><span class="line" data-starttime="3030"><span class="speakerName">Vijay Menon</span>: OK. </span><span class="line" data-startTime="3030">Sorry. </span><span class="line" data-startTime="3031">Just to add in &mdash; we do have </span><span class="line" data-startTime="3031">teams in Google who are </span><span class="line" data-startTime="3033">starting to use Dart. </span><span class="line" data-startTime="3034">So even though we're still </span><span class="line" data-startTime="3034">working on it, it's pretty </span><span class="line" data-startTime="3037">usable today. </span><span class="line" data-startTime="3039">They wouldn't be using </span><span class="line" data-startTime="3039">it if it wasn't. </span></p>

<p class="speaker"><span class="line" data-starttime="3043"><span class="speakerName">Audience</span>: Hi there. </span><span class="line" data-startTime="3043">Are there any legs to the rumor </span><span class="line" data-startTime="3043">that GWT is looking for </span><span class="line" data-startTime="3046">new intermediate language, and </span><span class="line" data-startTime="3046">that intermediate language </span><span class="line" data-startTime="3048">might be Dart? </span></p>

<p class="speaker"><span class="line" data-starttime="3052"><span class="speakerName">Ray Cromwell</span>: Yeah, there's </span><span class="line" data-startTime="3052">nothing official. </span> <span class="line" data-startTime="3053">There's been some </span><span class="line" data-startTime="3053">talk about that. </span> <span class="line" data-startTime="3055">I know I've thought about it </span><span class="line" data-startTime="3055">personally, of building a Dart </span><span class="line" data-startTime="3057">back end for GWT. </span> <span class="line" data-startTime="3058">So if and when Chrome actually </span><span class="line" data-startTime="3058">has the Dart VM built into it, </span><span class="line" data-startTime="3064">it might be the case that </span><span class="line" data-startTime="3064">either one of two </span><span class="line" data-startTime="3066">things might happen. </span> <span class="line" data-startTime="3067">Either someone might build a </span><span class="line" data-startTime="3067">back-end for GWT that emits </span><span class="line" data-startTime="3070">Dart code, compiles the Dart, </span><span class="line" data-startTime="3070">just to take advantage of the </span><span class="line" data-startTime="3072">speed and start-up time </span><span class="line" data-startTime="3072">improvements that the Dart VM </span><span class="line" data-startTime="3075">will have over V8. </span> <span class="line" data-startTime="3076">The other option, actually, and </span><span class="line" data-startTime="3076">I think this is probably </span><span class="line" data-startTime="3078">more likely, is that someone </span><span class="line" data-startTime="3078">will build a tool that </span><span class="line" data-startTime="3081">actually will help migrate Java </span><span class="line" data-startTime="3081">code to Dart in case you </span><span class="line" data-startTime="3085">want to basically port </span><span class="line" data-startTime="3085">some code over. </span></p>

<p><span class="line" data-startTime="3088">There are some difficulties in </span><span class="line" data-startTime="3088">compiling GWT code to Dart </span><span class="line" data-startTime="3090">because of JavaScript. </span> <span class="line" data-startTime="3092">So you can imagine, any large </span><span class="line" data-startTime="3092">GWT application at sort of the </span><span class="line" data-startTime="3096">leaves of the program, deepest </span><span class="line" data-startTime="3096">down, is going to have JSNI </span><span class="line" data-startTime="3099">method calls to deal </span><span class="line" data-startTime="3099">with the browser. </span> <span class="line" data-startTime="3100">And so those would have to be </span><span class="line" data-startTime="3100">replaced with the Dart library </span><span class="line" data-startTime="3104">equivalents. </span> <span class="line" data-startTime="3104">So if someone's calling, like, </span><span class="line" data-startTime="3104">dom.getElementById, rather </span><span class="line" data-startTime="3108">than making a JSNI call there, </span><span class="line" data-startTime="3108">which would have to use this </span><span class="line" data-startTime="3112">hack, it would have to replace </span><span class="line" data-startTime="3112">it with the equivalent </span><span class="line" data-startTime="3114">dart:html library and call </span><span class="line" data-startTime="3114">the actual Dart method. </span></p>

<p><span class="line" data-startTime="3118">And it's certainly possible to </span><span class="line" data-startTime="3118">do that, but it would actually </span><span class="line" data-startTime="3120">be a lot of mapping work. </span> <span class="line" data-startTime="3123">But yeah. </span> <span class="line" data-startTime="3124">We've talked about it. </span> <span class="line" data-startTime="3125">If I have nothing </span><span class="line" data-startTime="3125">official to say. </span></p>

<p class="speaker"><span class="line" data-starttime="3127"><span class="speakerName">Audience</span>: Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="3129"><span class="speakerName">Audience</span>: Do you think </span><span class="line" data-startTime="3129">there's going to &mdash; </span><span class="line" data-startTime="3131">when they finally get </span><span class="line" data-startTime="3131">to release, will </span><span class="line" data-startTime="3133">they have the widgets? </span><span class="line" data-startTime="3134">And will they be similar to </span><span class="line" data-startTime="3134">what GWT has already? </span></p>

<p class="speaker"><span class="line" data-starttime="3138"><span class="speakerName">Ray Cromwell</span>: They </span><span class="line" data-startTime="3138">probably will be. </span> <span class="line" data-startTime="3139">So I don't know, actually, the </span><span class="line" data-startTime="3139">timeline on the widgets. </span> <span class="line" data-startTime="3141">But I know what their philosophy </span><span class="line" data-startTime="3141">and intention is. </span> <span class="line" data-startTime="3144">And so their philosophy and </span><span class="line" data-startTime="3144">intention is actually to </span><span class="line" data-startTime="3146">deliver widgets that probably </span><span class="line" data-startTime="3146">go far beyond what GWT has. </span> <span class="line" data-startTime="3149">So GWT, when it started, </span><span class="line" data-startTime="3149">basically they wanted it to be </span><span class="line" data-startTime="3153">more like JavaScript. </span> <span class="line" data-startTime="3154">We didn't want to be very </span><span class="line" data-startTime="3154">opinionated about what the </span><span class="line" data-startTime="3156">widgets looked like, so the </span><span class="line" data-startTime="3156">first GWT widgets were very </span><span class="line" data-startTime="3158">ugly out of the box. </span> <span class="line" data-startTime="3160">They didn't provide very </span><span class="line" data-startTime="3160">much styling at all. </span> <span class="line" data-startTime="3161">Later, we got some sense </span><span class="line" data-startTime="3161">knocked into us, and we </span><span class="line" data-startTime="3163">realized most programmers </span><span class="line" data-startTime="3163">can't take the time to </span><span class="line" data-startTime="3165">actually style all </span><span class="line" data-startTime="3165">their widgets. </span> <span class="line" data-startTime="3166">We should provide some default </span><span class="line" data-startTime="3166">that actually looks </span><span class="line" data-startTime="3168">reasonable. </span> <span class="line" data-startTime="3169">And we did that. </span> <span class="line" data-startTime="3170">But still, it's nothing compared </span><span class="line" data-startTime="3170">to what Sencha has, </span><span class="line" data-startTime="3172">for example. </span></p>

<p><span class="line" data-startTime="3173">Right? </span><span class="line" data-startTime="3174">And so that was probably </span><span class="line" data-startTime="3174">a mistake </span><span class="line" data-startTime="3176">early in the GWT design. </span> <span class="line" data-startTime="3178">The Dart team, I think, is </span><span class="line" data-startTime="3178">eyeing the fact that people </span><span class="line" data-startTime="3182">want to design apps and they </span><span class="line" data-startTime="3182">want to design them to be </span><span class="line" data-startTime="3184">productive, and they want </span><span class="line" data-startTime="3184">to wow their consumers. </span> <span class="line" data-startTime="3186">And so you need not just </span><span class="line" data-startTime="3186">a widget library. </span> <span class="line" data-startTime="3188">You need a very sexy widget </span><span class="line" data-startTime="3188">library out of the box. </span> <span class="line" data-startTime="3190">And so they're actually aiming </span><span class="line" data-startTime="3190">to make something that's very </span><span class="line" data-startTime="3194">lickable, something that </span><span class="line" data-startTime="3194">you're going to </span><span class="line" data-startTime="3195">love out of the box. </span> <span class="line" data-startTime="3196">And it's going to be </span><span class="line" data-startTime="3196">very opinionated. </span></p>

<p><span class="line" data-startTime="3198">So the slider widget is going </span><span class="line" data-startTime="3198">to look the way the Dart </span><span class="line" data-startTime="3200">user-interface designer </span><span class="line" data-startTime="3200">wants it to look. </span> <span class="line" data-startTime="3203">And it might not look the way </span><span class="line" data-startTime="3203">you want it to look, but it's </span><span class="line" data-startTime="3205">probably going to look </span><span class="line" data-startTime="3205">really sweet. </span> <span class="line" data-startTime="3206">And so that's basically what </span><span class="line" data-startTime="3206">they're looking at. </span> <span class="line" data-startTime="3209">Am I summarizing correctly, </span><span class="line" data-startTime="3209">Vijay? </span><span class="line" data-startTime="3212">OK. </span> <span class="line" data-startTime="3213">I'm actually not part of the </span><span class="line" data-startTime="3213">Dart team, so I don't want to </span><span class="line" data-startTime="3215">speak too much about it. </span> <span class="line" data-startTime="3215">But I overheard some </span><span class="line" data-startTime="3215">conversations. </span> <span class="line" data-startTime="3218">OK? </span><span class="line" data-startTime="3218">You have another? </span></p>

<p class="speaker"><span class="line" data-starttime="3219"><span class="speakerName">Audience</span>: Also, I've got a lot </span><span class="line" data-startTime="3219">of applications on App Engine. </span><span class="line" data-startTime="3222">And is there a pattern or </span><span class="line" data-startTime="3222">something that I can use to </span><span class="line" data-startTime="3228">migrate it to that? </span></p>

<p class="speaker"><span class="line" data-starttime="3230"><span class="speakerName">Ray Cromwell</span>: You're talking </span><span class="line" data-startTime="3230">about App Engine? </span></p>

<p class="speaker"><span class="line" data-starttime="3231"><span class="speakerName">Audience</span>: App Engine using </span><span class="line" data-startTime="3231">RequestFactory. </span></p>

<p class="speaker"><span class="line" data-starttime="3234"><span class="speakerName">Ray Cromwell</span>: Oh, yeah. </span><span class="line" data-startTime="3235">I actually was going to </span><span class="line" data-startTime="3235">discuss this in the </span><span class="line" data-startTime="3238">presentation, but I realized </span><span class="line" data-startTime="3238">later I had too many slides </span><span class="line" data-startTime="3240">and I ran out of time. </span><span class="line" data-startTime="3241">But if you're using </span><span class="line" data-startTime="3241">RequestFactory, actually &mdash; </span><span class="line" data-startTime="3245">I should take this offline. </span><span class="line" data-startTime="3245">There's an extra bonus. </span><span class="line" data-startTime="3246">Because RequestFactory's </span><span class="line" data-startTime="3246">JSON-based, it's very possible </span><span class="line" data-startTime="3249">to make Dart client code work </span><span class="line" data-startTime="3249">with JSON RequestFactory stuff </span><span class="line" data-startTime="3253">on the server. </span><span class="line" data-startTime="3254">It's not true for GWT-RPC. </span><span class="line" data-startTime="3255">GWT-RPC is very tightly tied </span><span class="line" data-startTime="3255">in to the Java type system. </span><span class="line" data-startTime="3258">RequestFactory isn't. </span><span class="line" data-startTime="3259">So actually, it's possible </span><span class="line" data-startTime="3259">to make a Dart code call </span><span class="line" data-startTime="3262">server-side Java RequestFactory </span><span class="line" data-startTime="3262">code. </span><span class="line" data-startTime="3265">And so maybe I can catch you </span><span class="line" data-startTime="3265">offline and discuss that. </span></p>

<p class="speaker"><span class="line" data-starttime="3269"><span class="speakerName">Audience</span>: Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="3271"><span class="speakerName">Audience</span>: OK. </span><span class="line" data-startTime="3272">So my question would be about </span><span class="line" data-startTime="3272">GWT-RPC, so you already </span><span class="line" data-startTime="3275">answered it. </span><span class="line" data-startTime="3276">So there's some way to </span><span class="line" data-startTime="3276">invoke GWT-RPC calls? </span></p>

<p class="speaker"><span class="line" data-starttime="3283"><span class="speakerName">Ray Cromwell</span>: Yes. </span> <span class="line" data-startTime="3284">That would be kind of difficult </span><span class="line" data-startTime="3284">to pull off. </span> <span class="line" data-startTime="3287">I could see you constructing </span><span class="line" data-startTime="3287">something that would invoke </span><span class="line" data-startTime="3289">it, but I would see it being </span><span class="line" data-startTime="3289">hard to actually deal with the </span><span class="line" data-startTime="3293">return value. </span> <span class="line" data-startTime="3294">So there are Android clients </span><span class="line" data-startTime="3294">that actually invoke GWT-RPC </span><span class="line" data-startTime="3300">because Android also is Java, so </span><span class="line" data-startTime="3300">they can deal with the fact </span><span class="line" data-startTime="3303">that when the return value comes </span><span class="line" data-startTime="3303">back and it says, like, </span><span class="line" data-startTime="3305">it's an array list of doubles or </span><span class="line" data-startTime="3305">something, the classes for </span><span class="line" data-startTime="3309">decoding an array list of </span><span class="line" data-startTime="3309">doubles are already present in </span><span class="line" data-startTime="3311">the runtime of Dalvik, right? </span><span class="line" data-startTime="3313">With Dart, if you invoke some </span><span class="line" data-startTime="3313">server-side call and you get </span><span class="line" data-startTime="3316">back an array of things that are </span><span class="line" data-startTime="3316">Java types, right, there's </span><span class="line" data-startTime="3320">not necessarily something to </span><span class="line" data-startTime="3320">map to decode those and </span><span class="line" data-startTime="3322">demarshal them into </span><span class="line" data-startTime="3322">on the Dart side. </span></p>

<p><span class="line" data-startTime="3325">So it's a little </span><span class="line" data-startTime="3325">more difficult. </span> <span class="line" data-startTime="3326">But invoking I could see. </span> <span class="line" data-startTime="3328">As long as your API actually </span><span class="line" data-startTime="3328">uses mostly primitive things, </span><span class="line" data-startTime="3331">like longs, and integers, and </span><span class="line" data-startTime="3331">strings, and so on, or maybe </span><span class="line" data-startTime="3334">POJOs, I think you could </span><span class="line" data-startTime="3334">pull it off. </span> <span class="line" data-startTime="3336">But if you catch me outside, I </span><span class="line" data-startTime="3336">might have some suggestions. </span></p>

<p class="speaker"><span class="line" data-starttime="3339"><span class="speakerName">Audience</span>: OK. </span><span class="line" data-startTime="3339">Cool. </span><span class="line" data-startTime="3339">Thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="3342"><span class="speakerName">Ray Cromwell</span>: OK. </span></p>

<p class="speaker"><span class="line" data-starttime="3343"><span class="speakerName">Audience</span>: Hello? </span><span class="line" data-startTime="3344">At [INAUDIBLE] </span><span class="line" data-startTime="3345">Google our [INAUDIBLE] </span><span class="line" data-startTime="3346">we have many talks about Google </span><span class="line" data-startTime="3346">Web Toolkit and we have </span><span class="line" data-startTime="3349">a separate section in </span><span class="line" data-startTime="3349">developers' handbooks about </span><span class="line" data-startTime="3353">Google Web Toolkit. </span><span class="line" data-startTime="3355">And now it seems [INAUDIBLE] </span><span class="line" data-startTime="3358">session, which mentioned </span><span class="line" data-startTime="3358">Google Web Toolkit. </span><span class="line" data-startTime="3362">So I want to ask, </span><span class="line" data-startTime="3362">is GWT is dead? </span></p>

<p class="speaker"><span class="line" data-starttime="3366"><span class="speakerName">Ray Cromwell</span>: No. </span> <span class="line" data-startTime="3368">I been asked this </span><span class="line" data-startTime="3368">question a lot. </span> <span class="line" data-startTime="3369">And if you look at Google, for </span><span class="line" data-startTime="3369">example, a lot of Google's top </span><span class="line" data-startTime="3375">properties, actually, </span><span class="line" data-startTime="3375">like AdWords &mdash; </span><span class="line" data-startTime="3377">97% of their revenue comes </span><span class="line" data-startTime="3377">from the AdWords team. </span> <span class="line" data-startTime="3381">And AdWords uses GWT for their </span><span class="line" data-startTime="3381">campaign management tool. </span> <span class="line" data-startTime="3384">And so it's impractical for us </span><span class="line" data-startTime="3384">to say that GWT was dead, </span><span class="line" data-startTime="3386">first of all. </span> <span class="line" data-startTime="3388">Second of all, Google </span><span class="line" data-startTime="3388">is about choice. </span> <span class="line" data-startTime="3391">The company's about choice. </span> <span class="line" data-startTime="3392">You know, App Engine, </span><span class="line" data-startTime="3392">for example. </span></p>

<p><span class="line" data-startTime="3392">We offer Java. </span> <span class="line" data-startTime="3394">We offer Go. </span> <span class="line" data-startTime="3396">We offer Python. </span> <span class="line" data-startTime="3397">Well, we released Go </span><span class="line" data-startTime="3397">recently, right? </span><span class="line" data-startTime="3399">Does that mean that Guido van </span><span class="line" data-startTime="3399">Rossum is out of a job and </span><span class="line" data-startTime="3402">Python is dead? </span><span class="line" data-startTime="3402">No. </span> <span class="line" data-startTime="3403">It just means that there's </span><span class="line" data-startTime="3403">another option for developers. </span> <span class="line" data-startTime="3405">And so what I would say for GWT </span><span class="line" data-startTime="3405">is that we're not going to </span><span class="line" data-startTime="3408">take GWT away from you. </span> <span class="line" data-startTime="3409">And we're still going to support </span><span class="line" data-startTime="3409">JavaScript development </span><span class="line" data-startTime="3412">for V8, and we're still going </span><span class="line" data-startTime="3412">to support GWT development. </span> <span class="line" data-startTime="3416">But we're also offering this new </span><span class="line" data-startTime="3416">option that might entice </span><span class="line" data-startTime="3419">some people, maybe some people </span><span class="line" data-startTime="3419">who don't like JavaScript. </span> <span class="line" data-startTime="3421">Or maybe they're people who like </span><span class="line" data-startTime="3421">JavaScript, but they want </span><span class="line" data-startTime="3423">better tools for JavaScript. </span></p>

<p><span class="line" data-startTime="3424">They want a really nice </span><span class="line" data-startTime="3424">IDE for something </span><span class="line" data-startTime="3427">that's a dynamic language. </span> <span class="line" data-startTime="3428">There's Dart for you. </span> <span class="line" data-startTime="3429">Or maybe they like Java, but </span><span class="line" data-startTime="3429">maybe they're getting tired of </span><span class="line" data-startTime="3432">doing enterprise apps. </span> <span class="line" data-startTime="3433">So nothing's changing </span><span class="line" data-startTime="3433">with GWT. </span> <span class="line" data-startTime="3437">In fact, if you attend my </span><span class="line" data-startTime="3437">session on Friday, there is </span><span class="line" data-startTime="3440">actually some nice news that's </span><span class="line" data-startTime="3440">going to be announced with </span><span class="line" data-startTime="3443">respect to GWT's future. </span></p>

<p class="speaker"><span class="line" data-starttime="3446"><span class="speakerName">Audience</span>: OK. </span></p>

<p class="speaker"><span class="line" data-starttime="3448"><span class="speakerName">Ray Cromwell</span>: Anything else? </span><span class="line" data-startTime="3451">OK. </span><span class="line" data-startTime="3451">Thanks for coming, and &mdash; </span><span class="line" data-startTime="3453">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="3457"><span class="speakerName">Ray Cromwell</span>: You're welcome. </span><span class="line" data-startTime="3458">Be safe on your way down rushing </span><span class="line" data-startTime="3458">to get your devices. </span><span class="line" data-startTime="3461">Don't trip and fall. </span></p></div>