<p class="speaker"><span class="line" data-starttime="1"><span class="speakerName">Paul Lewis</span>: So this </span><span class="line" data-startTime="1">is device agnostic development and I'm Paul </span><span class="line" data-startTime="7">Lewis. I'm the guy looking confused over on </span><span class="line" data-startTime="7">the left. Mostly on the right right now. I </span><span class="line" data-startTime="14">spend &mdash; I'm on the Chrome developer relations </span><span class="line" data-startTime="14">team. I spend my days at talking about and </span><span class="line" data-startTime="19">rendering performance. </span></p>

<p class="speaker"><span class="line" data-starttime="19"><span class="speakerName">Peter Beverloo</span>: I'm Peter Beverloo. I'm a </span><span class="line" data-startTime="21">software engineer on the Chrome team. I work </span><span class="line" data-startTime="21">on Chrome for Android. I mostly spend my time </span><span class="line" data-startTime="26">pushing the web platform forward. </span></p>

<p class="speaker"><span class="line" data-starttime="26"><span class="speakerName">Paul Lewis</span>: So we ran a small survey and </span><span class="line" data-startTime="33">we asked developers two questions amongst </span><span class="line" data-startTime="33">many. The questions we asked them were, which </span><span class="line" data-startTime="39">form factors do you support versus prioritize? </span><span class="line" data-startTime="39">Not surprisingly, 96% of people said we support </span><span class="line" data-startTime="49">desktop. Pretty much everybody. Two-thirds </span><span class="line" data-startTime="49">of people went for phone and tablet. As you </span><span class="line" data-startTime="54">can see on the prioritization side, 81% of </span><span class="line" data-startTime="54">the 200 or so developers that we asked said, </span><span class="line" data-startTime="61">you know what, desktop is our top priority. </span> <span class="line" data-startTime="61">This leads us to a question, if we prioritize </span><span class="line" data-startTime="75">a single form factor, what happens? The answer </span><span class="line" data-startTime="75">is probably quite obvious, right? We start </span><span class="line" data-startTime="80">to build on the expectations of capability. </span></p>

<p><span class="line" data-startTime="80">We build expecting that we're going to have </span><span class="line" data-startTime="88">desktop-like performance. That we're going </span><span class="line" data-startTime="88">to expect to see big screens, good GPs, good </span><span class="line" data-startTime="93">CPs, a lot of memory. All those kinds of things. </span></p>

<p class="speaker"><span class="line" data-starttime="93"><span class="speakerName">Peter Beverloo</span>: So along comes new form factor. </span> <span class="line" data-startTime="100">Such as mobile. What does this mean? Well, </span><span class="line" data-startTime="100">we have been creating web sites for desktop </span><span class="line" data-startTime="106">experiences for quite a long time now. Desktop </span><span class="line" data-startTime="106">experiences give us a number of advantages </span><span class="line" data-startTime="111">over more limited platforms such as mobile </span><span class="line" data-startTime="111">devices. As an example, there's this big screen </span><span class="line" data-startTime="118">available to you which has a lot of space </span><span class="line" data-startTime="118">for you to put content on or to put data on. </span> <span class="line" data-startTime="124">But on mobile, there's a difference. It's </span><span class="line" data-startTime="124">not just a screen size, which is different. </span> <span class="line" data-startTime="129">It's a lot smaller. But it's also in terms </span><span class="line" data-startTime="129">of a number of additional constraints such </span><span class="line" data-startTime="134">computational power. We create web sites using </span><span class="line" data-startTime="134">a lot of JavaScript, for example, for scrolling </span><span class="line" data-startTime="138">or concordance, and while this works fine </span><span class="line" data-startTime="138">and acceptable on a desktop machine, on a </span><span class="line" data-startTime="143">mobile, this will look janky. So along comes </span><span class="line" data-startTime="143">new form factor. It's not just about desktop </span><span class="line" data-startTime="157">and mobile. The web actually goes quite a </span><span class="line" data-startTime="157">bit further than that. This is something we've </span><span class="line" data-startTime="161">only started to see quite recently. Back in </span><span class="line" data-startTime="161">the days, there used to be mobile devices </span><span class="line" data-startTime="167">which were capable of internet using imodes </span><span class="line" data-startTime="167">or similar systems. They weren't really internet. </span> <span class="line" data-startTime="173">You could see a web page. You could talk to </span><span class="line" data-startTime="173">a server but the experience was quite limited. </span></p>

<p><span class="line" data-startTime="177">These days, mobile devices such as phones </span><span class="line" data-startTime="177">and tablets, they are basically on par with </span><span class="line" data-startTime="182">desktop devices and they just work just like </span><span class="line" data-startTime="182">a desktop machine. Of course, with a number </span><span class="line" data-startTime="187">of additional constraints. Now, we're see </span><span class="line" data-startTime="187">more and more come to televisions or consoles. </span> <span class="line" data-startTime="194">On a television, the screen is a lot bigger </span><span class="line" data-startTime="194">but we also know the user is sitting away </span><span class="line" data-startTime="198">from the screen quite a bit further than is </span><span class="line" data-startTime="198">the case with mobile device and desktop machine. </span> <span class="line" data-startTime="204">Which means that as developers we actually </span><span class="line" data-startTime="204">have to change how we create web sites. With </span><span class="line" data-startTime="209">console, be it a portable one or be it a stationary </span><span class="line" data-startTime="209">one next to your television, the story changes </span><span class="line" data-startTime="216">completely altogether again and with portable </span><span class="line" data-startTime="216">devices, such as consoles, they can be similar </span><span class="line" data-startTime="224">to mobile, like a telephone. But they could </span><span class="line" data-startTime="224">be entirely different as well with different </span><span class="line" data-startTime="229">forms of inputs and different types of managing </span><span class="line" data-startTime="229">your data which come with it. We really don't </span><span class="line" data-startTime="235">know. Like what is the next device? We've </span><span class="line" data-startTime="235">got desktops, mobile, televisions, consoles. </span></p>

<p><span class="line" data-startTime="240">What will come next? Are there going to be </span><span class="line" data-startTime="240">wearable computers? Could be anything. </span></p>

<p class="speaker"><span class="line" data-starttime="246"><span class="speakerName">Paul Lewis</span>: So the point we are trying to </span><span class="line" data-startTime="246">make with all this is that it's just the web. </span> <span class="line" data-startTime="252">Okay? We have this propensity for talking </span><span class="line" data-startTime="252">about the mobile web. We don't talk about </span><span class="line" data-startTime="257">the desktop web or the TV web or the console </span><span class="line" data-startTime="257">web. We just talk about the mobile web. That's </span><span class="line" data-startTime="262">fair enough to some degree. What we need to </span><span class="line" data-startTime="262">start realizing, I think, is it's just the </span><span class="line" data-startTime="267">web. It's consumed through a number different </span><span class="line" data-startTime="267">devices. A good experience matters no matter </span><span class="line" data-startTime="273">what the device. So then, becoming device </span><span class="line" data-startTime="273">agnostic. If we figure we will have people </span><span class="line" data-startTime="282">connecting to size and applications through </span><span class="line" data-startTime="282">a bunch of different devices, how can we start </span><span class="line" data-startTime="287">actually being device agnostic? So the grand </span><span class="line" data-startTime="287">unified theory of devices. Sounds good. We </span><span class="line" data-startTime="297">figured we can actually turn this on its head. </span> <span class="line" data-startTime="297">We can actually start figuring out what the </span><span class="line" data-startTime="303">constraints are. Okay? Instead of device capability, </span><span class="line" data-startTime="303">what about looking at the device constraint? </span><span class="line" data-startTime="310">We figured there are these three constraints. </span> <span class="line" data-startTime="310">We can assess every device we know about, </span><span class="line" data-startTime="315">and the ones we don't know about, the ones </span><span class="line" data-startTime="315">coming tomorrow, in the same way. Network. </span></p>

<p><span class="line" data-startTime="320">How quickly can it pull stuff down on the </span><span class="line" data-startTime="320">wire? What's the latency? What's the bandwidth? </span><span class="line" data-startTime="324">It it's network constraint, it's going to </span><span class="line" data-startTime="324">be slow. </span> <span class="line" data-startTime="329">Compute constraint. So how quickly can it </span><span class="line" data-startTime="329">process information? How much memory has it </span><span class="line" data-startTime="333">got? Is it good at calculating my styles and </span><span class="line" data-startTime="333">laying out my page? What's the CPU like? The </span><span class="line" data-startTime="340">last one is a giant, shiny monkey head. How </span><span class="line" data-startTime="340">quickly can it push pixels around the screen? </span><span class="line" data-startTime="348">Does it have a good GPU? When we start actually </span><span class="line" data-startTime="348">start looking at it from this perspective, </span><span class="line" data-startTime="355">what we can start to realize is if we distance </span><span class="line" data-startTime="355">ourselves from these constraints, if we start </span><span class="line" data-startTime="359">planning for these constraints, then what </span><span class="line" data-startTime="359">we realize is that we are, in effect, becoming </span><span class="line" data-startTime="365">agnostic to them. So that when we hit a device </span><span class="line" data-startTime="365">with one or more of these constraints, that </span><span class="line" data-startTime="370">we are not actually as bothered by it. So </span><span class="line" data-startTime="370">instead of relying on the capabilities of </span><span class="line" data-startTime="375">a desktop, we are now going to spin it on </span><span class="line" data-startTime="375">its head, look at these constraints in turn, </span><span class="line" data-startTime="379">figure out what comes up and how we can distance </span><span class="line" data-startTime="379">ourselves from them. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="384"><span class="speakerName">Peter Beverloo</span>: So let's look at a few of </span><span class="line" data-startTime="384">these device types and map them against constraints. </span> <span class="line" data-startTime="391">This creates quite an interesting matrix. </span> <span class="line" data-startTime="391">I apologize to those of you in the back. It </span><span class="line" data-startTime="396">will be extremely hard to read. I'll just </span><span class="line" data-startTime="396">name what's on the slides. On a desktop machine, </span><span class="line" data-startTime="401">the network will generally be quite good. </span> <span class="line" data-startTime="401">You will be connected to your home DSL connection </span><span class="line" data-startTime="406">which will be quite performant. Computational </span><span class="line" data-startTime="406">power will be decent, even for older desktop </span><span class="line" data-startTime="412">machines while they are still better than </span><span class="line" data-startTime="412">mobile. Rendering performance will be decent </span><span class="line" data-startTime="416">because they are multipurpose machines. They </span><span class="line" data-startTime="416">are not just created for a single, streaming </span><span class="line" data-startTime="421">video. So they will be able to display web </span><span class="line" data-startTime="421">sites. And the screen is big. Maybe not as </span><span class="line" data-startTime="427">big as a television in terms of physical size </span><span class="line" data-startTime="427">but often you have a monitor of maybe 20 or </span><span class="line" data-startTime="432">24 inches width and, as a developer, that </span><span class="line" data-startTime="432">gives you a lot of space to play with. On </span><span class="line" data-startTime="438">mobile it's a little bit different. With a </span><span class="line" data-startTime="438">mobile device you can be on the move at any </span><span class="line" data-startTime="444">random time and you cannot rely on a network </span><span class="line" data-startTime="444">connection to always be available. So network </span><span class="line" data-startTime="451">conditions are quite bad. Computational power </span><span class="line" data-startTime="451">can be okay. There's different classes of </span><span class="line" data-startTime="456">mobile devices. Tablets are, of course, entirely </span><span class="line" data-startTime="456">different from phones. But even within a single </span><span class="line" data-startTime="463">class, such as a phone, there can be quite </span><span class="line" data-startTime="463">a lot of differences. We've got phones over </span><span class="line" data-startTime="468">$500, $600. There's phones for $50, and computational </span><span class="line" data-startTime="468">power will rely a lot on the capabilities </span><span class="line" data-startTime="475">of the actual device. Rendering performance </span><span class="line" data-startTime="475">will be quite bad. We are trying to get to </span><span class="line" data-startTime="481">60 frames per second, but it turns out to </span><span class="line" data-startTime="481">be really difficult to get there on any platform. </span></p>

<p><span class="line" data-startTime="486">And the screen is quite small. That's the </span><span class="line" data-startTime="486">physical screen size. While the actual logical </span><span class="line" data-startTime="492">screen size, so the number of pixels which </span><span class="line" data-startTime="492">have to be shown to the user can be a lot </span><span class="line" data-startTime="496">bigger because we have got all these high </span><span class="line" data-startTime="496">resolution fonts. For televisions, well, they </span><span class="line" data-startTime="502">are standing in your house. I don't often </span><span class="line" data-startTime="502">walk around with a television behind my arm. </span></p>

<p class="speaker"><span class="line" data-starttime="507"><span class="speakerName">Paul Lewis</span>: What? I do. </span></p>

<p class="speaker"><span class="line" data-starttime="507"><span class="speakerName">Peter Beverloo</span>: Okay. So the network conditions </span><span class="line" data-startTime="513">will generally be similar to your normal desktop </span><span class="line" data-startTime="513">computer. Computational power is bad. It's </span><span class="line" data-startTime="517">meant for showing video, not for showing web </span><span class="line" data-startTime="517">sites. Rendering performance will be bad for </span><span class="line" data-startTime="522">the same reasons because the device really </span><span class="line" data-startTime="522">has been made for a single purpose. And the </span><span class="line" data-startTime="527">screen is pretty big but the resolution can </span><span class="line" data-startTime="527">be smaller and in some cases even smaller </span><span class="line" data-startTime="531">than a mobile device. Now, for consoles, it's </span><span class="line" data-startTime="531">quite similar to mobile. It depends on the </span><span class="line" data-startTime="537">kind of console really. You can be on the </span><span class="line" data-startTime="537">move at all times. Computational power, they </span><span class="line" data-startTime="541">are meant for games for interactive imaging </span><span class="line" data-startTime="541">while web sites can be static content. Rendering </span><span class="line" data-startTime="548">performance, again, it really depends on the </span><span class="line" data-startTime="548">device. And the same goes for screen size. </span></p>

<p><span class="line" data-startTime="554">And for the new class of devices, we just </span><span class="line" data-startTime="554">don't know. We have no idea what's it going </span><span class="line" data-startTime="559">to get us. </span></p>

<p class="speaker"><span class="line" data-starttime="559"><span class="speakerName">Paul Lewis</span>: Actually, to be fair. If we </span><span class="line" data-startTime="562">take a step back. We actually don't know on </span><span class="line" data-startTime="562">any of these because let's say desktop, take </span><span class="line" data-startTime="567">that for a second, it could be a laptop as </span><span class="line" data-startTime="567">well. Now, we said good Internet network, </span><span class="line" data-startTime="572">but what if you have tethered your phone? </span></p>

<p class="speaker"><span class="line" data-starttime="572"><span class="speakerName">Peter Beverloo</span>: Or what if you have a dial-up </span><span class="line" data-startTime="575">Internet connection? </span></p>

<p class="speaker"><span class="line" data-starttime="575"><span class="speakerName">Paul Lewis</span>: Yeah. So at this point actually </span><span class="line" data-startTime="578">all bets are off, right? Because on any of </span><span class="line" data-startTime="578">these you can find an exception. Okay? </span></p>

<p class="speaker"><span class="line" data-starttime="584"><span class="speakerName">Peter Beverloo</span>: So to set reality is that </span><span class="line" data-startTime="584">everything in this matrix is a maybe. We just </span><span class="line" data-startTime="590">don't know. And the only real way to figure </span><span class="line" data-startTime="590">out what you need to optimize for your web </span><span class="line" data-startTime="595">site is not to just blindly apply all the </span><span class="line" data-startTime="595">best practices you can find around the Internet. </span> <span class="line" data-startTime="600">You need to measure and you need to look at </span><span class="line" data-startTime="600">your statistics. Go to whatever statistics </span><span class="line" data-startTime="605">you have. Look at the devices which your visitors </span><span class="line" data-startTime="605">are actually using. Optimize for these devices. </span> <span class="line" data-startTime="611">Use the number of available APIs which we </span><span class="line" data-startTime="611">will come back to later in the presentation. </span> <span class="line" data-startTime="615">Actually measure what your performance bottlenecks </span><span class="line" data-startTime="615">are. One way of measure what's going on are </span><span class="line" data-startTime="624">your Chrome DevTools. This is built into Google </span><span class="line" data-startTime="624">Chrome in all the release channels. It makes </span><span class="line" data-startTime="630">it entirely possible to accurately measure </span><span class="line" data-startTime="630">any aspect at any time what's happening on </span><span class="line" data-startTime="636">your page in terms of network computational </span><span class="line" data-startTime="636">requirements and rendering as well. We've </span><span class="line" data-startTime="642">got a series of videos available on YouTube. </span></p>

<p><span class="line" data-startTime="642">Called the breakpoints. The screen shot here </span><span class="line" data-startTime="647">is showing Paul Irish on the first few seconds </span><span class="line" data-startTime="647">of a presentation which gives you a video </span><span class="line" data-startTime="654">introduction to a number of the features available </span><span class="line" data-startTime="654">on DevTools. There was a talk yesterday about </span><span class="line" data-startTime="659">Chrome DevTools resolution which will have </span><span class="line" data-startTime="659">shown you about a number of new features which </span><span class="line" data-startTime="665">have recently become available. And we've </span><span class="line" data-startTime="665">recently updated the DevTools documentation </span><span class="line" data-startTime="670">which you can definitely check out as well </span><span class="line" data-startTime="670">and which contains a lot of information about </span><span class="line" data-startTime="674">how to measure exactly what's going on on </span><span class="line" data-startTime="674">your pages. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="677"><span class="speakerName">Paul Lewis</span>: Okay. So we've established that </span><span class="line" data-startTime="677">we can be on any device and we can't really </span><span class="line" data-startTime="685">predict exactly what the constraints are going </span><span class="line" data-startTime="685">to be for that device. Now let's step into </span><span class="line" data-startTime="690">network computer rendering. This is actually </span><span class="line" data-startTime="690">essentially a performance talk by the back </span><span class="line" data-startTime="695">door. If you have been up to the third floor </span><span class="line" data-startTime="695">and seen in the Chrome area, we have a performance </span><span class="line" data-startTime="700">area and network computer rendering are in, </span><span class="line" data-startTime="700">in fact, three areas. If you have not been, </span><span class="line" data-startTime="703">you should stop by. But what we are going </span><span class="line" data-startTime="703">do is we are going to step through the common </span><span class="line" data-startTime="707">issues that we see on each of these three </span><span class="line" data-startTime="707">areas and we are going to try to find ways </span><span class="line" data-startTime="711">of distancing ourselves from those constraints </span><span class="line" data-startTime="711">so that irrespective of which device we are </span><span class="line" data-startTime="716">actually hitting, if we have hit that constraint </span><span class="line" data-startTime="716">we have done everything that we possibly can </span><span class="line" data-startTime="720">to try to make that a non-issue. </span></p>

<p class="speaker"><span class="line" data-starttime="720"><span class="speakerName">Peter Beverloo</span>: So the first thing to keep </span><span class="line" data-startTime="726">in mind is the page load time. This basically </span><span class="line" data-startTime="726">describes the time it takes for the user to </span><span class="line" data-startTime="732">start a navigation action like clicking on </span><span class="line" data-startTime="732">a link or entering a link interbrowser address </span><span class="line" data-startTime="737">bar until the time that they see the page </span><span class="line" data-startTime="737">and that they are actually able to use it. </span> <span class="line" data-startTime="742">Now, you've got all your visitors. If your </span><span class="line" data-startTime="742">page on a mobile device takes more than three </span><span class="line" data-startTime="748">seconds to load, 57% of your visitors will </span><span class="line" data-startTime="748">go away. They will just leave. They will go </span><span class="line" data-startTime="756">elsewhere. They might search for an alternative. </span> <span class="line" data-startTime="756">They may know of an alternative and they are </span><span class="line" data-startTime="760">gone for the day basically. Now it gets worse. </span> <span class="line" data-startTime="760">For all these visitors, if your page takes </span><span class="line" data-startTime="767">more than three seconds to load, 46% will </span><span class="line" data-startTime="767">not return. They will find a competitor of </span><span class="line" data-startTime="774">yours. They will find an alternative source </span><span class="line" data-startTime="774">of the data or the information which are giving </span><span class="line" data-startTime="778">to them and start preferring the other web </span><span class="line" data-startTime="778">site just because it loads a little bit faster. </span></p>

<p><span class="line" data-startTime="784">And probably the worst statistic is that 22% </span><span class="line" data-startTime="784">of your visitors will tell their friends to </span><span class="line" data-startTime="791">not use your web site. Now, let that sink </span><span class="line" data-startTime="791">in for a little bit. That means that over </span><span class="line" data-startTime="797">one in five visitors of your mobile web site </span><span class="line" data-startTime="797">will tell their friends to not visit your </span><span class="line" data-startTime="803">site if your page takes more than three seconds </span><span class="line" data-startTime="803">to load. That's quite a lot of impact and </span><span class="line" data-startTime="810">one thing to keep in mind here is that the </span><span class="line" data-startTime="810">perceived loading time of a web page is actually </span><span class="line" data-startTime="815">15% higher than the actual loading time. And </span><span class="line" data-startTime="815">it gets worse because when they are talking </span><span class="line" data-startTime="820">to their friends about this, they will remember </span><span class="line" data-startTime="820">loading time which is up to 35% slower of </span><span class="line" data-startTime="826">what it actually was. So while it actually </span><span class="line" data-startTime="826">could have been three seconds, in their memory </span><span class="line" data-startTime="831">it may be up to five seconds or more. So there </span><span class="line" data-startTime="831">are a few things we can do. Probably the biggest </span><span class="line" data-startTime="839">contributor to having a big load time for </span><span class="line" data-startTime="839">your web pages is having a huge number of </span><span class="line" data-startTime="845">requests on your page. Now, for every request </span><span class="line" data-startTime="845">to your page, we can look at costs implied </span><span class="line" data-startTime="853">by it and we can split it up in three different </span><span class="line" data-startTime="853">ones. Firstly, there is the latency cost. </span></p>

<p><span class="line" data-startTime="858">For each of these requests, for the resources </span><span class="line" data-startTime="858">which could be an image or style sheet, we </span><span class="line" data-startTime="863">need to make a connection to the server &mdash; well, </span><span class="line" data-startTime="863">in some cases because in other cases we may </span><span class="line" data-startTime="868">be able to re-use the connection. We need </span><span class="line" data-startTime="868">to request the resource, get a reply and that </span><span class="line" data-startTime="873">could take a little bit of time, especially </span><span class="line" data-startTime="873">if the resource is hosted on a different server, </span><span class="line" data-startTime="878">in which case a DNS lookup might be necessary. </span> <span class="line" data-startTime="878">Now, for big resources such as images, bandwidth </span><span class="line" data-startTime="884">may be a constraint. If I am on a 3G connection </span><span class="line" data-startTime="884">and I'm sitting on a train, then it will take </span><span class="line" data-startTime="893">a while for that image to be available on </span><span class="line" data-startTime="893">my mobile device. Of course, there is a financial </span><span class="line" data-startTime="899">cost. This is not just about visitors which </span><span class="line" data-startTime="899">you may lose if your site takes quite a long </span><span class="line" data-startTime="905">time to load. But Paul and I are from the </span><span class="line" data-startTime="905">United Kingdom and if we want to use the mobile </span><span class="line" data-startTime="910">Internet on our normal phones here in the </span><span class="line" data-startTime="910">United States, then it costs us up to $8 per </span><span class="line" data-startTime="916">megabyte. You need to have a really good server </span><span class="line" data-startTime="916">or web site if I want to use it that cost. </span></p>

<p><span class="line" data-startTime="923">So probably the easiest thing to do here is </span><span class="line" data-startTime="923">obsolete a number of these requests. For every </span><span class="line" data-startTime="928">single one of the resources on your page, </span><span class="line" data-startTime="928">ask yourself, do you really need it? Can you </span><span class="line" data-startTime="934">maybe get around by inlining it on the page? </span><span class="line" data-startTime="934">By concatenating style sheets, so having several </span><span class="line" data-startTime="940">style sheets in a single file? Or can you </span><span class="line" data-startTime="940">perhaps minimize them to reduce bandwidth </span><span class="line" data-startTime="944">cost? And making optimizations such as these </span><span class="line" data-startTime="944">will often have a big impact in a base loading </span><span class="line" data-startTime="951">time performance of your web sites. </span></p>

<p class="speaker"><span class="line" data-starttime="951"><span class="speakerName">Paul Lewis</span>: Now, a lot of people already </span><span class="line" data-startTime="953">do this one, right? Most people when you speak </span><span class="line" data-startTime="953">to them, they say, yeah, we can concatenate </span><span class="line" data-startTime="958">min files. The next thing we want to talk </span><span class="line" data-startTime="958">about is reducing the image overhead. Statistic </span><span class="line" data-startTime="966">that you may have heard of and if you haven't </span><span class="line" data-startTime="966">and it's the first time, really good one to </span><span class="line" data-startTime="970">put in your head, 60% of web traffic, 60% </span><span class="line" data-startTime="970">of the average web page is images. And that </span><span class="line" data-startTime="978">gives us a huge opportunity for optimizing </span><span class="line" data-startTime="978">our network. Okay, can we change formats? </span><span class="line" data-startTime="984">Now, in the case of WebP, by switching to </span><span class="line" data-startTime="984">it, the Chrome web store saved several terabytes </span><span class="line" data-startTime="991">of transfer every day. Now, it may not be </span><span class="line" data-startTime="991">that it is going to save you that much of </span><span class="line" data-startTime="996">transfer. You can immediately realize that </span><span class="line" data-startTime="996">actually instead of JPEG I should be using </span><span class="line" data-startTime="1001">pings or pings instead of JPEG, or gifs maybe </span><span class="line" data-startTime="1001">or even WebP. It depends on the actual image </span><span class="line" data-startTime="1008">and what you are trying to achieve and so </span><span class="line" data-startTime="1008">forth. But spend some time figuring out whether </span><span class="line" data-startTime="1013">you can change formats, whether you can change </span><span class="line" data-startTime="1013">quality and that will potentially save you </span><span class="line" data-startTime="1017">an awful lot of data. The next thing is actually </span><span class="line" data-startTime="1017">request images of the size you need. Responsive </span><span class="line" data-startTime="1021">web design has become all the rage and it's </span><span class="line" data-startTime="1021">really quite cool. But there is this problem </span><span class="line" data-startTime="1029">with it which is that people often request </span><span class="line" data-startTime="1029">their full-size images and then the user ends </span><span class="line" data-startTime="1035">up paying a tax, as it were. We rely on client </span><span class="line" data-startTime="1035">side resizing to get it down but we end up </span><span class="line" data-startTime="1042">requesting a much larger file in some cases </span><span class="line" data-startTime="1042">than we actually need. There are loads of </span><span class="line" data-startTime="1047">things you can do on the server side to actually </span><span class="line" data-startTime="1047">let you scale down and cache a smaller version </span><span class="line" data-startTime="1052">of the image. If you are not doing that, take </span><span class="line" data-startTime="1052">a look at that one. The last one is, do you </span><span class="line" data-startTime="1055">even need an image? Controversial. You could </span><span class="line" data-startTime="1055">get away with SVG in some cases, web fonts </span><span class="line" data-startTime="1063">with icon glyphs. Have a look at those and </span><span class="line" data-startTime="1063">play around. See if you can actually get rid </span><span class="line" data-startTime="1070">of some of your images. 60% of the average </span><span class="line" data-startTime="1070">page is going to be images. So if you can </span><span class="line" data-startTime="1074">get rid of that, that saves us a ton. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1074"><span class="speakerName">Peter Beverloo</span>: One of the solutions available </span><span class="line" data-startTime="1081">to you if you have control over your server </span><span class="line" data-startTime="1081">itself, is that you can look into using mod </span><span class="line" data-startTime="1089">PageSpeed. Mod PageSpeed is a plug-in made </span><span class="line" data-startTime="1089">by Google which basically gives you a free </span><span class="line" data-startTime="1095">pass to a quicker web site. What it does, </span><span class="line" data-startTime="1095">it looks at your web page before sending it </span><span class="line" data-startTime="1100">to the user. It will look into ways to optimize </span><span class="line" data-startTime="1100">your page by inlining resources, by concatenating </span><span class="line" data-startTime="1106">style sheet files together and by doing a </span><span class="line" data-startTime="1106">number of number of optimization steps which </span><span class="line" data-startTime="1112">just generally make it faster. Of course, </span><span class="line" data-startTime="1112">this does require you to be in control of </span><span class="line" data-startTime="1117">your web page &mdash; of your web server, I'm sorry. </span> <span class="line" data-startTime="1117">If you are not, there's another tool available </span><span class="line" data-startTime="1124">called PageSpeed insights. Many of you will </span><span class="line" data-startTime="1124">work on the front end of a web site and this </span><span class="line" data-startTime="1131">tool is as simple as enter the URL of your </span><span class="line" data-startTime="1131">page, click on a button, it will start downloading </span><span class="line" data-startTime="1136">your page. It will start analyzing it. It </span><span class="line" data-startTime="1136">will show up with a number of suggestions </span><span class="line" data-startTime="1140">and how to optimize the page itself and make </span><span class="line" data-startTime="1140">it faster to load and dissipate to the user. </span></p>

<p><span class="line" data-startTime="1147">Now, of course these two tools will only do </span><span class="line" data-startTime="1147">&mdash; will only optimize your page to the best </span><span class="line" data-startTime="1154">of their abilities. But they do this by looking </span><span class="line" data-startTime="1154">at the average space, what they are doing, </span><span class="line" data-startTime="1159">and applying these rules of your site. Now, </span><span class="line" data-startTime="1159">your web sites are not average. They are special </span><span class="line" data-startTime="1166">because, in a way, there is no average web </span><span class="line" data-startTime="1166">site, and the only real way optimize the page </span><span class="line" data-startTime="1171">itself by doing it yourself and looking at </span><span class="line" data-startTime="1171">what pieces of information or resources on </span><span class="line" data-startTime="1177">your page actually impact or reduce performance. </span> <span class="line" data-startTime="1177">Now, we have already spoken a little bit about </span><span class="line" data-startTime="1183">DevTools which make it possible for you to </span><span class="line" data-startTime="1183">look at exactly which parts are taking a long </span><span class="line" data-startTime="1188">time in the loading process of the web page. </span></p>

<p><span class="line" data-startTime="1188">But then there are API available to you as </span><span class="line" data-startTime="1193">their resource timing API which exposes high-fidelity </span><span class="line" data-startTime="1193">information about most of the resources which </span><span class="line" data-startTime="1199">you have included on the page itself and gets </span><span class="line" data-startTime="1199">you insight into how long it took to actually </span><span class="line" data-startTime="1203">look up the DNS for that resource, to connect </span><span class="line" data-startTime="1203">to the server or to download to resource. </span> <span class="line" data-startTime="1210">And especially if you have blocking resources </span><span class="line" data-startTime="1210">such as scripts, it can be a great way to </span><span class="line" data-startTime="1214">actually figure out which script is blocking </span><span class="line" data-startTime="1214">your page from showing up quickly. </span></p>

<p class="speaker"><span class="line" data-starttime="1218"><span class="speakerName">Paul Lewis</span>: Okay. So we've talked about </span><span class="line" data-startTime="1218">the kind of things that you can get into for </span><span class="line" data-startTime="1224">actually transferring your sites and apps </span><span class="line" data-startTime="1224">down to end users. Now we actually step into </span><span class="line" data-startTime="1229">the runtime-y bit. It's actually running. </span> <span class="line" data-startTime="1229">And this is the bit where we talk about compute. </span> <span class="line" data-startTime="1236">So we've got everything downloaded or we've </span><span class="line" data-startTime="1236">got enough to get going, and now we want to </span><span class="line" data-startTime="1240">talk about what that actually involves to </span><span class="line" data-startTime="1240">solve for compute. </span> <span class="line" data-startTime="1244">So the first thing you need to do is define </span><span class="line" data-startTime="1244">this term "jank." Now, you've probably heard </span><span class="line" data-startTime="1248">it over the course of the last few days. Let's </span><span class="line" data-startTime="1248">define it again just in case. </span></p>

<p><span class="line" data-startTime="1252">Chrome is synchronized to the refresh rate </span><span class="line" data-startTime="1252">of the device. Now, that's 60 hertz. That </span><span class="line" data-startTime="1257">means you've got just about 16 1/2 milliseconds </span><span class="line" data-startTime="1257">to get everything done. And that includes </span><span class="line" data-startTime="1263">Chrome's housekeeping, it includes your code </span><span class="line" data-startTime="1263">&mdash; and that's a bunch of things like layout, </span><span class="line" data-startTime="1268">recalc style, paint, composite, JavaScript </span><span class="line" data-startTime="1268">&mdash; all that stuff. 16 milliseconds. I don't </span><span class="line" data-startTime="1274">get much done in 16 milliseconds, but Chrome </span><span class="line" data-startTime="1274">really, really does. </span> <span class="line" data-startTime="1278">We call this the frame budget, and if we don't </span><span class="line" data-startTime="1278">hit that frame budget, users notice. It's </span><span class="line" data-startTime="1285">kind of this hitching. You know, when they </span><span class="line" data-startTime="1285">scroll and it hitches and hiccups? That's </span><span class="line" data-startTime="1289">what we call "jank." </span><span class="line" data-startTime="1289">So when we talk about "jank" in the coming </span><span class="line" data-startTime="1293">slides, that's what we're referring to. We're </span><span class="line" data-startTime="1293">talking about busting that frame budget of </span><span class="line" data-startTime="1296">most likely 16 1/2 milliseconds. </span> <span class="line" data-startTime="1296">So the first thing I want to talk about in </span><span class="line" data-startTime="1304">the compute area is style recalculations. </span> <span class="line" data-startTime="1304">Now, it's very common when we do apps that </span><span class="line" data-startTime="1310">we change class on the body, okay? And you </span><span class="line" data-startTime="1310">do that for maybe state and you maybe even </span><span class="line" data-startTime="1315">do it for styling. The problem is, the size </span><span class="line" data-startTime="1315">of the tree that's affected can be huge. Now, </span><span class="line" data-startTime="1321">you see on the left-hand side &mdash; hopefully </span><span class="line" data-startTime="1321">you can see &mdash; I was changing a class on the </span><span class="line" data-startTime="1325">body and I was affecting nearly twenty- &mdash; just </span><span class="line" data-startTime="1325">over 23,000 elements by doing that. The recalculation </span><span class="line" data-startTime="1332">style effort then was 20 milliseconds. </span></p>

<p><span class="line" data-startTime="1332">Now, this is Canary that's telling us the </span><span class="line" data-startTime="1337">elements affected so if you haven't seen that </span><span class="line" data-startTime="1337">feature, it's a really useful thing when you're </span><span class="line" data-startTime="1340">trying to figure out kind of what was the </span><span class="line" data-startTime="1340">impact. </span> <span class="line" data-startTime="1342">There's a corresponding one for layout as </span><span class="line" data-startTime="1342">well which tells you the scope and the size </span><span class="line" data-startTime="1346">of the layout calculation. </span> <span class="line" data-startTime="1346">So we've changed the body, 23,000 elements, </span><span class="line" data-startTime="1350">20 milliseconds. </span> <span class="line" data-startTime="1350">I knew that I actually wanted to affect 6 </span><span class="line" data-startTime="1355">and when I did that, it was a fraction of </span><span class="line" data-startTime="1355">a millisecond. </span> <span class="line" data-startTime="1357">Now, it sounds obvious but only change the </span><span class="line" data-startTime="1357">things that you need to change. Go and have </span><span class="line" data-startTime="1362">a look at your app, see whether you're actually </span><span class="line" data-startTime="1362">overdoing your style recalculation. </span> <span class="line" data-startTime="1369">Layout thrashing. If you've not seen this </span><span class="line" data-startTime="1369">one before, this is quite a fascinating one, </span><span class="line" data-startTime="1374">really. </span> <span class="line" data-startTime="1374">So this little bit of JavaScript at the top </span><span class="line" data-startTime="1377">allows us to get the target &mdash; a thing called </span><span class="line" data-startTime="1377">"target" &mdash; from the DOM, and what we're going </span><span class="line" data-startTime="1382">to do is we're going to go through a bunch </span><span class="line" data-startTime="1382">of other elements and we're going to ask &mdash; we're </span><span class="line" data-startTime="1385">going to set their width to match the target's </span><span class="line" data-startTime="1385">width. Pretty trivial stuff to do. What is </span><span class="line" data-startTime="1389">that, three lines of code plus a comment? </span><span class="line" data-startTime="1389">Okay. The first thing we need to notice is </span><span class="line" data-startTime="1394">that asking for offset width is going to cause </span><span class="line" data-startTime="1394">Chrome to do a layout. </span></p>

<p><span class="line" data-startTime="1399">So it goes off and it says, "All right. What's </span><span class="line" data-startTime="1399">the left, the top, the width, the height? </span><span class="line" data-startTime="1402">What do I need to know about all the elements </span><span class="line" data-startTime="1402">in the page to be able to give you a good </span><span class="line" data-startTime="1406">answer on offset width?" </span><span class="line" data-startTime="1406">So it goes off and it does that. </span> <span class="line" data-startTime="1409">The next thing is, that first element gets </span><span class="line" data-startTime="1409">its style width value set to the target's </span><span class="line" data-startTime="1416">width. </span> <span class="line" data-startTime="1416">The problem is, by doing that, we just invalidated </span><span class="line" data-startTime="1420">the layout calculation that we've just done. </span> <span class="line" data-startTime="1420">So then the next time around the loop, we </span><span class="line" data-startTime="1424">ask Chrome to do a potentially very expensive </span><span class="line" data-startTime="1424">layout again. </span> <span class="line" data-startTime="1427">So we're doing this get, set, get, set, get, </span><span class="line" data-startTime="1427">set, get, set, get, set. And the problem is </span><span class="line" data-startTime="1433">this adds up really quickly. Especially when </span><span class="line" data-startTime="1433">layout is expensive. </span> <span class="line" data-startTime="1436">What we should be doing is getting once and </span><span class="line" data-startTime="1436">setting many. And it probably makes sense </span><span class="line" data-startTime="1442">when you hear it in that sense. </span> <span class="line" data-startTime="1442">The thing is to realize that offset width </span><span class="line" data-startTime="1447">is actually going to cause the layout to happen. </span></p>

<p><span class="line" data-startTime="1447">And you can Google that, how to not trigger </span><span class="line" data-startTime="1451">a layout in Webkit, and you'll see a very </span><span class="line" data-startTime="1451">good blog post that will tell you which ones </span><span class="line" data-startTime="1458">in Webkit and Blink will cause a layout to </span><span class="line" data-startTime="1458">happen. </span> <span class="line" data-startTime="1462">So avoid layout thrashing. </span> <span class="line" data-startTime="1462">Two very simple things there: Layout and style </span><span class="line" data-startTime="1466">calculations. </span></p>

<p class="speaker"><span class="line" data-starttime="1466"><span class="speakerName">Peter Beverloo</span>: So a browser has a very </span><span class="line" data-startTime="1472">particular set of skills. Skills it has acquired </span><span class="line" data-startTime="1472">over a short, but quite eventful, career. </span> <span class="line" data-startTime="1479">You should not do in JavaScript in an imperative </span><span class="line" data-startTime="1479">way what you can do in a declarative way. </span> <span class="line" data-startTime="1484">Animations and transitions are excellent examples </span><span class="line" data-startTime="1484">of that. Five years ago, six years ago, perhaps </span><span class="line" data-startTime="1490">even more, we had all these libraries such </span><span class="line" data-startTime="1490">as jQuery or Dojo, which are animation libraries, </span><span class="line" data-startTime="1496">and it allowed you to animate items on your </span><span class="line" data-startTime="1496">page. It allows you to change the left property </span><span class="line" data-startTime="1501">from &mdash; from zero to a thousand and move an </span><span class="line" data-startTime="1501">element horizontally over your page without </span><span class="line" data-startTime="1505">the user having to do anything at all, and </span><span class="line" data-startTime="1505">that's awesome. </span> <span class="line" data-startTime="1509">But this is really costly because every time </span><span class="line" data-startTime="1509">the frame does something &mdash; and often a library </span><span class="line" data-startTime="1516">internally sets the timer to try and match </span><span class="line" data-startTime="1516">the frame budget of the browser &mdash; it needs </span><span class="line" data-startTime="1521">to look at the position, it needs to do a </span><span class="line" data-startTime="1521">re-layout, and all of these are really expensive </span><span class="line" data-startTime="1525">operations. </span> <span class="line" data-startTime="1525">Now, there are excellent alternatives available </span><span class="line" data-startTime="1529">to this in CSS, to do it in a declarative </span><span class="line" data-startTime="1529">way, and by using a declarative way, you're </span><span class="line" data-startTime="1534">actually saying &mdash; telling the browser what </span><span class="line" data-startTime="1534">you want it to do instead of telling the browser </span><span class="line" data-startTime="1538">what it has to do. </span></p>

<p><span class="line" data-startTime="1538">And by telling the browser your goal, you're </span><span class="line" data-startTime="1544">basically saying, "Okay. I want you to do </span><span class="line" data-startTime="1544">this effect, but please do it in the best </span><span class="line" data-startTime="1549">way you can do it for me." And by using the </span><span class="line" data-startTime="1549">CSS transitions module or the CSS animation </span><span class="line" data-startTime="1556">module, the browser is actually able to optimize </span><span class="line" data-startTime="1556">all this transcript code away from you. It </span><span class="line" data-startTime="1562">can do these animations, in some cases, on </span><span class="line" data-startTime="1562">a different thread and this will look a lot </span><span class="line" data-startTime="1566">better and a lot less janky for the user, </span><span class="line" data-startTime="1566">while also taking a lot less CPU and, well, </span><span class="line" data-startTime="1573">it doesn't eat away from your frame budget </span><span class="line" data-startTime="1573">and it works regardless of many of the constraints </span><span class="line" data-startTime="1577">of the device. </span> <span class="line" data-startTime="1577">Up until a few years ago, fixed position was </span><span class="line" data-startTime="1583">unreliable. It kind of could stick around </span><span class="line" data-startTime="1583">in the viewport. It could be janky if you </span><span class="line" data-startTime="1589">were scrolling. Now, lately, in pretty much </span><span class="line" data-startTime="1589">all big mobile browsers, this has been fixed, </span><span class="line" data-startTime="1593">and of course it works in all desktop browsers </span><span class="line" data-startTime="1593">as well. </span> <span class="line" data-startTime="1596">So if you have an element which should always </span><span class="line" data-startTime="1596">be available in the viewport of the page itself, </span><span class="line" data-startTime="1600">just use position ficky &mdash; sticky &mdash; no, position </span><span class="line" data-startTime="1600">fixed and don't use JavaScript to keep it </span><span class="line" data-startTime="1607">in exactly that position, using the scrolling </span><span class="line" data-startTime="1607">position, for example. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1611"><span class="speakerName">Paul Lewis</span>: But you could use position sticky. </span><span class="line" data-startTime="1611">What would you use position sticky for? </span></p>

<p class="speaker"><span class="line" data-starttime="1614"><span class="speakerName">Peter Beverloo</span>: Well, position sticky actually </span><span class="line" data-startTime="1614">is a new experimental feature in Chrome. </span></p>

<p class="speaker"><span class="line" data-starttime="1617"><span class="speakerName">Paul Lewis</span>: Really? </span></p>

<p class="speaker"><span class="line" data-starttime="1617"><span class="speakerName">Peter Beverloo</span>: Yeah. You can go to the </span><span class="line" data-startTime="1619">Chrome flex page. You can enable it for Chrome </span><span class="line" data-startTime="1619">for Android as well. And position sticky is </span><span class="line" data-startTime="1625">somewhat like a fixed position element, but </span><span class="line" data-startTime="1625">if the parent element is not inside of the </span><span class="line" data-startTime="1630">viewport itself, so if it's scrolled away </span><span class="line" data-startTime="1630">somewhere, then it will just be an inflow </span><span class="line" data-startTime="1635">element. If the parent element comes in the </span><span class="line" data-startTime="1635">page, then it will make sure that the element </span><span class="line" data-startTime="1640">is &mdash; that the sticky positioned element is </span><span class="line" data-startTime="1640">visible. But if the parent element kind of </span><span class="line" data-startTime="1646">moves out of the viewport but still is visible, </span><span class="line" data-startTime="1646">then the element will stick around in the </span><span class="line" data-startTime="1652">viewport as if it was fixed position. And </span><span class="line" data-startTime="1652">an example you might know which uses this </span><span class="line" data-startTime="1658">quite a lot is an address book. If you have </span><span class="line" data-startTime="1658">a lot of names, then the header which contains </span><span class="line" data-startTime="1663">the first letter of the names which are currently </span><span class="line" data-startTime="1663">being displayed may stick around at the top </span><span class="line" data-startTime="1667">of the viewport for a little while until the </span><span class="line" data-startTime="1667">next letter is up. </span> <span class="line" data-startTime="1672">And the fourth big point is keep your invent </span><span class="line" data-startTime="1672">listener code to a minimum. Some event handlers </span><span class="line" data-startTime="1677">such as scrolling events will be called many, </span><span class="line" data-startTime="1677">many, many times per second, sometimes even </span><span class="line" data-startTime="1682">multiple times per frame, and any processing </span><span class="line" data-startTime="1682">you do in these handlers will eat away from </span><span class="line" data-startTime="1688">your frame budget and this will definitely </span><span class="line" data-startTime="1688">limit the time Chrome has to display your </span><span class="line" data-startTime="1694">Web page and, as a result, you might miss </span><span class="line" data-startTime="1694">frames. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1697"><span class="speakerName">Paul Lewis</span>: One thing you can definitely </span><span class="line" data-startTime="1697">do with that one is, say you're doing something </span><span class="line" data-startTime="1701">in your scroll handler. Just get it to store </span><span class="line" data-startTime="1701">the last known value. Okay? And then schedule </span><span class="line" data-startTime="1705">up a requestAnimationFrame. Because what will </span><span class="line" data-startTime="1705">happen is most of the time you have like four </span><span class="line" data-startTime="1709">or five of these running, okay? You get like </span><span class="line" data-startTime="1709">four or five in the frame, but you actually </span><span class="line" data-startTime="1713">only care about the last one, so you just </span><span class="line" data-startTime="1713">store the value and then set a requestAnimationFrame </span><span class="line" data-startTime="1718">to actually deal with the last known value. </span> <span class="line" data-startTime="1718">This is called de-bouncing in some places </span><span class="line" data-startTime="1721">or &mdash; yeah, "de-bouncing" is the most common </span><span class="line" data-startTime="1721">name for it. And just basically rather than </span><span class="line" data-startTime="1726">running that expensive code in your scroll </span><span class="line" data-startTime="1726">handler, just keep the value and run one handler </span><span class="line" data-startTime="1732">at the end. </span> <span class="line" data-startTime="1732">Okay. So we've talked about network, we've </span><span class="line" data-startTime="1737">talked about compute, so now let's take a </span><span class="line" data-startTime="1737">look at some of the stuff that happens inside </span><span class="line" data-startTime="1742">of render. </span> <span class="line" data-startTime="1742">Now, I have DevTools open here and it's captured </span><span class="line" data-startTime="1749">something which is quite expensive on the </span><span class="line" data-startTime="1749">paint side of things, and if you look, we've </span><span class="line" data-startTime="1754">twittled down one of the pane records and </span><span class="line" data-startTime="1754">we spent 13 milliseconds decoding a JPEG. </span></p>

<p><span class="line" data-startTime="1759">Now, we have 16 milliseconds to do everything, </span><span class="line" data-startTime="1759">not just paint. And then we spent a further </span><span class="line" data-startTime="1765">71 milliseconds dealing with the resize. </span> <span class="line" data-startTime="1765">Now, this is what I was talking about before </span><span class="line" data-startTime="1771">about responsive web design is that there's </span><span class="line" data-startTime="1771">potentially a second tax. And before, we talked </span><span class="line" data-startTime="1778">about reducing image overhead but we talked </span><span class="line" data-startTime="1778">about it from the network constraint. We also </span><span class="line" data-startTime="1781">have a render constraint because we actually </span><span class="line" data-startTime="1781">have to process these images. </span> <span class="line" data-startTime="1786">So actually, just getting the &mdash; the smallest </span><span class="line" data-startTime="1786">possible image and in the correct dimensions </span><span class="line" data-startTime="1791">is actually extremely advantageous. </span> <span class="line" data-startTime="1791">So check out DevTools if you've not seen that </span><span class="line" data-startTime="1798">feature. That's really useful to actually </span><span class="line" data-startTime="1798">find out your decodes and your resizes. </span></p>

<p><span class="line" data-startTime="1802">Paint costs. So whenever you scroll or you're </span><span class="line" data-startTime="1802">interacting with your page, the things that </span><span class="line" data-startTime="1808">change or the things that appear on screen, </span><span class="line" data-startTime="1808">they need to get painted. And since painting </span><span class="line" data-startTime="1813">is actually quite an expensive thing, depending </span><span class="line" data-startTime="1813">on the styles that you apply, we have to keep </span><span class="line" data-startTime="1817">it to a minimum. </span> <span class="line" data-startTime="1817">So there are two things that are actually </span><span class="line" data-startTime="1820">involved in reducing paint costs, the first </span><span class="line" data-startTime="1820">of which is actually reducing the size of </span><span class="line" data-startTime="1827">the area that got painted. </span> <span class="line" data-startTime="1827">So you see I've got show paint rectangle switched </span><span class="line" data-startTime="1830">on here. So you go into DevTools, hit the </span><span class="line" data-startTime="1830">cog, switch on show paint rectangles, and </span><span class="line" data-startTime="1835">then interact with your page. </span> <span class="line" data-startTime="1835">Now, as I roll over these elements, you can </span><span class="line" data-startTime="1837">see that they're flashing red which is Chrome's </span><span class="line" data-startTime="1837">saying, "I repainted those." </span><span class="line" data-startTime="1841">But watch there. When I scrolled, the whole </span><span class="line" data-startTime="1841">page flashed red. Now, that should be a warning </span><span class="line" data-startTime="1846">to you that the entire page needed painting, </span><span class="line" data-startTime="1846">and that's potentially an expensive thing </span><span class="line" data-startTime="1851">and it's the kind of thing that gives you </span><span class="line" data-startTime="1851">those big green bars, okay? Now, there's a </span><span class="line" data-startTime="1855">very specific reason for this one, but I'll </span><span class="line" data-startTime="1855">let you figure out what that is. </span> <span class="line" data-startTime="1861">The thing to know is that you're looking for </span><span class="line" data-startTime="1861">those smaller areas. The question you should </span><span class="line" data-startTime="1865">be asking yourself is, "Am I seeing the bits </span><span class="line" data-startTime="1865">that are getting repainted that I thought </span><span class="line" data-startTime="1869">were going to get repainted? Is it predictable </span><span class="line" data-startTime="1869">to me?" As in, "I rolled over this and I expected </span><span class="line" data-startTime="1873">it to repaint. Yes, it did." </span><span class="line" data-startTime="1873">When I scrolled, I didn't expect to see the </span><span class="line" data-startTime="1877">whole thing flash or the whole screen flash, </span><span class="line" data-startTime="1877">right? So there's something to look at there. </span></p>

<p><span class="line" data-startTime="1880">The second thing, once we've reduced the size </span><span class="line" data-startTime="1880">of the paint areas is to then reduce the complexity </span><span class="line" data-startTime="1887">of the paint areas, so we've got this other </span><span class="line" data-startTime="1887">tool that's fantastic. It's called &mdash; called </span><span class="line" data-startTime="1892">continuous page repainting. And what it does </span><span class="line" data-startTime="1892">is it puts Chrome into a mode where it forces </span><span class="line" data-startTime="1897">Chrome to repaint the whole page every frame. </span> <span class="line" data-startTime="1897">Okay? And you see it switched on there. It </span><span class="line" data-startTime="1902">puts this little chart in the top right-hand </span><span class="line" data-startTime="1902">corner with the number of milliseconds that </span><span class="line" data-startTime="1906">it took to paint the page. </span> <span class="line" data-startTime="1906">Now, what we can do is we start switching </span><span class="line" data-startTime="1909">off styles, and in this particular case, switching </span><span class="line" data-startTime="1909">off box shadow or border radius is the one </span><span class="line" data-startTime="1914">that's actually dropping that time to paint </span><span class="line" data-startTime="1914">really far down. </span> <span class="line" data-startTime="1918">Now, I'd much rather you didn't walk out of </span><span class="line" data-startTime="1918">here saying "Box shadow is bad. Border radius </span><span class="line" data-startTime="1923">is bad. We shan't do these." That's not what </span><span class="line" data-startTime="1923">we want you to do. What we want you to do </span><span class="line" data-startTime="1926">is realize that your styles have a corresponding </span><span class="line" data-startTime="1926">cost and there is a tool in DevTools that </span><span class="line" data-startTime="1932">will let you figure what the cost is. </span> <span class="line" data-startTime="1932">And you can use that to your advantage to </span><span class="line" data-startTime="1937">&mdash; to move away from that constraint so that </span><span class="line" data-startTime="1937">you're not render-bound, okay? So reduce the </span><span class="line" data-startTime="1942">paint size, then reduce the complexity of </span><span class="line" data-startTime="1942">your paints. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1946"><span class="speakerName">Peter Beverloo</span>: So far, we've talked about </span><span class="line" data-startTime="1946">technical constraints which apply to you as </span><span class="line" data-startTime="1952">the developer, but eventually what we really </span><span class="line" data-startTime="1952">want is to give the right user experience </span><span class="line" data-startTime="1957">to the end user, to the person who is actually </span><span class="line" data-startTime="1957">using your page. </span> <span class="line" data-startTime="1961">Now, one thing to realize is that the user </span><span class="line" data-startTime="1961">comes for your content. They come to your </span><span class="line" data-startTime="1967">Web site with a specific person &mdash; purpose. </span> <span class="line" data-startTime="1967">That could be to get information. That could </span><span class="line" data-startTime="1972">be to use your service. And they don't really </span><span class="line" data-startTime="1972">care about that big image header which you </span><span class="line" data-startTime="1979">had at all of the top of your pages, which </span><span class="line" data-startTime="1979">basically just means that they have to scroll </span><span class="line" data-startTime="1983">the page before they even get to the content. </span> <span class="line" data-startTime="1983">You, as the developer, have all these constraints, </span><span class="line" data-startTime="1989">but the user shouldn't have them. </span> <span class="line" data-startTime="1989">And the main thing here, the main takeaway, </span><span class="line" data-startTime="1995">is that if I, as a user, use my mobile device, </span><span class="line" data-startTime="1995">if I use a phone to look at your Web site, </span><span class="line" data-startTime="2000">I really don't care about how well it works </span><span class="line" data-startTime="2000">on a web &mdash; on a desktop machine because I </span><span class="line" data-startTime="2005">use a mobile device. And the other way around, </span><span class="line" data-startTime="2005">the same goes. </span> <span class="line" data-startTime="2010">And while you probably want to offer the same </span><span class="line" data-startTime="2010">&mdash; a different user experience, because after </span><span class="line" data-startTime="2016">all they are different classes of devices, </span><span class="line" data-startTime="2016">you should offer the same functionality. </span></p>

<p><span class="line" data-startTime="2021">And what this basically means is that the </span><span class="line" data-startTime="2021">content on your page, or the services, it's </span><span class="line" data-startTime="2025">fine to refactor them or to reshape them in </span><span class="line" data-startTime="2025">a way that's more optimized for the device, </span><span class="line" data-startTime="2030">as long as you don't offer that reduced functionality </span><span class="line" data-startTime="2030">such as a simple entry page, "Sorry, you can't </span><span class="line" data-startTime="2036">use this feature at this time because it's </span><span class="line" data-startTime="2036">not optimized for mobile. Please use a desktop." </span><span class="line" data-startTime="2042">That just scares away users. </span> <span class="line" data-startTime="2042">When you develop a Web site for a desktop </span><span class="line" data-startTime="2048">computer, you've got all this real estate </span><span class="line" data-startTime="2048">available to you. You can put content next </span><span class="line" data-startTime="2052">to each other, you can put it on top of each </span><span class="line" data-startTime="2052">other, in any form that you want, for &mdash; especially </span><span class="line" data-startTime="2057">for text. </span> <span class="line" data-startTime="2057">You can have a news article, you can have </span><span class="line" data-startTime="2060">a bold introduction, you can have related </span><span class="line" data-startTime="2060">information about the company or the people </span><span class="line" data-startTime="2064">who are mentioned in the article itself. </span> <span class="line" data-startTime="2064">And this is nice because on a desktop, because </span><span class="line" data-startTime="2069">there's all this space, even a relatively </span><span class="line" data-startTime="2069">big amount of text looks like moderate and </span><span class="line" data-startTime="2074">it doesn't fill up your screen. </span> <span class="line" data-startTime="2074">Now, for mobile devices, this is a problem. </span> <span class="line" data-startTime="2079">Or actually for devices with constrained screen </span><span class="line" data-startTime="2079">size this is a problem. Because if I look </span><span class="line" data-startTime="2084">at exactly the same text, or maybe even one </span><span class="line" data-startTime="2084">paragraph of text on my mobile phone, then </span><span class="line" data-startTime="2090">my entire screen is filled with text, and </span><span class="line" data-startTime="2090">that's quite intimidating. </span> <span class="line" data-startTime="2094">If I then start to scroll down and I get five </span><span class="line" data-startTime="2094">or six more paragraphs, then I have to scroll </span><span class="line" data-startTime="2099">for several seconds before the text stops. </span></p>

<p><span class="line" data-startTime="2099">Even at relatively high scroll speeds. </span> <span class="line" data-startTime="2105">And this is intimidating and this could easily </span><span class="line" data-startTime="2105">scare away users. </span> <span class="line" data-startTime="2109">Now, we know that you're not always in control </span><span class="line" data-startTime="2109">of your content, so changing the text itself </span><span class="line" data-startTime="2115">or changing the images might not always be </span><span class="line" data-startTime="2115">a feasible solution, but you can at least </span><span class="line" data-startTime="2119">pass on the message that the users care a </span><span class="line" data-startTime="2119">lot more about getting an optimized experience </span><span class="line" data-startTime="2124">and care about getting the same functionality </span><span class="line" data-startTime="2124">than they get for getting all of the text </span><span class="line" data-startTime="2130">and all of the site information. </span></p>

<p class="speaker"><span class="line" data-starttime="2130"><span class="speakerName">Paul Lewis</span>: And one thing to notice here, </span><span class="line" data-startTime="2132">just if you can go back, is at the bottom </span><span class="line" data-startTime="2132">of that that we've got an image that's kind </span><span class="line" data-startTime="2138">of suggesting something is not responsive. </span> <span class="line" data-startTime="2138">Just bear in mind if you do do this kind of </span><span class="line" data-startTime="2142">responsive thing, just watch out for that </span><span class="line" data-startTime="2142">tax that I told you about earlier about resizing </span><span class="line" data-startTime="2146">images down. Make sure you always request </span><span class="line" data-startTime="2146">the images at the right size. </span> <span class="line" data-startTime="2151">Okay. So we have a couple of suggestions, </span><span class="line" data-startTime="2151">as you've just seen, because we think it will </span><span class="line" data-startTime="2158">be good to give you a couple of &mdash; couple </span><span class="line" data-startTime="2158">of suggestions for your work workflow. </span> <span class="line" data-startTime="2162">The first one is assign somebody that you </span><span class="line" data-startTime="2162">used to like to your team as the sheriff. </span> <span class="line" data-startTime="2168">They'll probably become unpopular pretty quickly. </span></p>

<p><span class="line" data-startTime="2168">However, they perform a very important role </span><span class="line" data-startTime="2175">for you. </span> <span class="line" data-startTime="2175">As you can see, the idea is to clarify and </span><span class="line" data-startTime="2178">set some constraints before you start. How </span><span class="line" data-startTime="2178">much time are we going to spend in garbage </span><span class="line" data-startTime="2181">collection, paint, composite, layout, recalc </span><span class="line" data-startTime="2181">style? Where are we going to spend our time, </span><span class="line" data-startTime="2187">on the assumption that we've got a network-constrained </span><span class="line" data-startTime="2187">device or a render-constrained device. Where </span><span class="line" data-startTime="2191">are we actually going to spend our time? </span><span class="line" data-startTime="2191">Then that person is going to track it and </span><span class="line" data-startTime="2193">they're going to stop you from shipping if </span><span class="line" data-startTime="2193">you don't hit it. </span> <span class="line" data-startTime="2197">Now, the question then becomes, "Well, what </span><span class="line" data-startTime="2197">number should we have?" And the honest answer </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2201"><span class="speakerName">Paul Lewis</span>: It depends on your application. </span><span class="line" data-startTime="2201">But have that person &mdash; a lot of times when </span><span class="line" data-startTime="2207">we speak to developers, performance and this </span><span class="line" data-startTime="2207">&mdash; this kind of stuff is often a bit like </span><span class="line" data-startTime="2213">a unit test. Are we fast? No. Oops. </span><span class="line" data-startTime="2213">[ Laughter ] </span></p>

<p class="speaker"><span class="line" data-starttime="2219"><span class="speakerName">Paul Lewis</span>: What we're talking about is </span><span class="line" data-startTime="2219">building it in from the start so that it's </span><span class="line" data-startTime="2223">something that you're continually checking </span><span class="line" data-startTime="2223">all the way through and there's somebody who's </span><span class="line" data-startTime="2227">owning and is responsible for that for you </span><span class="line" data-startTime="2227">as a team. </span><span class="line" data-startTime="2232">Check out jankfree.org. That's a bunch of </span><span class="line" data-startTime="2232">slides. It's a bunch of articles. It's a bunch </span><span class="line" data-startTime="2239">of videos. All of which are designed to help </span><span class="line" data-startTime="2239">you with these &mdash; the things that we've talked </span><span class="line" data-startTime="2243">about and in a lot more detail than we've </span><span class="line" data-startTime="2243">been able to cover so that's a fantastic resource </span><span class="line" data-startTime="2247">that you can track. </span><span class="line" data-startTime="2247">So should we conclude? We should because it </span><span class="line" data-startTime="2252">says "Conclusion" on the screen. </span></p>

<p class="speaker"><span class="line" data-starttime="2252"><span class="speakerName">Peter Beverloo</span>: Yes. </span></p>

<p class="speaker"><span class="line" data-starttime="2254"><span class="speakerName">Paul Lewis</span>: Super. </span></p>

<p class="speaker"><span class="line" data-starttime="2254"><span class="speakerName">Peter Beverloo</span>: It's not about the device </span><span class="line" data-startTime="2257">which users are able to access your Web sites. </span><span class="line" data-startTime="2257">It's about the content and the experience </span><span class="line" data-startTime="2261">which you're delivering to them. And while </span><span class="line" data-startTime="2261">the content and the functionality should be </span><span class="line" data-startTime="2264">the same, you can optimize them to create </span><span class="line" data-startTime="2264">a user experience specific to the different </span><span class="line" data-startTime="2269">devices. </span></p>

<p class="speaker"><span class="line" data-starttime="2269"><span class="speakerName">Paul Lewis</span>: The devices you're going to </span><span class="line" data-startTime="2271">deal with, they're going to probably have </span><span class="line" data-startTime="2271">at least one constraint at some point. </span> <span class="line" data-startTime="2276">Even on a desktop you might have multiple </span><span class="line" data-startTime="2276">processes running. There's no guarantee that </span><span class="line" data-startTime="2280">you're going to be good. So you figure out </span><span class="line" data-startTime="2280">ways to actually just reduce the load, fight </span><span class="line" data-startTime="2284">against those constraints, and you will be </span><span class="line" data-startTime="2284">agnostic. Mostly, let the browser do what </span><span class="line" data-startTime="2290">it's good at doing. If you're doing stuff </span><span class="line" data-startTime="2290">with JavaScript and you don't need to do it, </span><span class="line" data-startTime="2293">don't do it. Let the browser do it for you. </span></p>

<p class="speaker"><span class="line" data-starttime="2293"><span class="speakerName">Peter Beverloo</span>: And just to reiterate on </span><span class="line" data-startTime="2298">the content a little bit more, users come </span><span class="line" data-startTime="2298">to your page for content. I've said it a number </span><span class="line" data-startTime="2303">of times and I just say it again. </span><span class="line" data-startTime="2303">Refactor your content in a more direct and </span><span class="line" data-startTime="2310">concise way to get it to them in the fastest </span><span class="line" data-startTime="2310">way possible, because, after all, that's why </span><span class="line" data-startTime="2315">they're there. </span></p>

<p class="speaker"><span class="line" data-starttime="2315"><span class="speakerName">Paul Lewis</span>: Thank you very much. </span><span class="line" data-startTime="2322">[ Applause ] </span></p>

<p class="speaker"><span class="line" data-starttime="2322"><span class="speakerName">Paul Lewis</span>: We have a tiny amount of time </span><span class="line" data-startTime="2327">for one or two questions, maybe, so if you </span><span class="line" data-startTime="2327">have a question, go up to the mic and we'll </span><span class="line" data-startTime="2331">see if we can get through any of them. And </span><span class="line" data-startTime="2331">then if you want to find us after, we're going </span><span class="line" data-startTime="2334">to be upstairs in the Chrome area, probably </span><span class="line" data-startTime="2334">in the &mdash; I'll at the for performance booth, </span><span class="line" data-startTime="2340">if you're interested. </span></p>

<p class="speaker"><span class="line" data-starttime="2340"><span class="speakerName">Audience member</span>: I'm curious. The last couple I/Os, we've </span><span class="line" data-startTime="2342">seen a lot about getting rid of jank and using </span><span class="line" data-startTime="2342">the de-bouncing technique that you guys have </span><span class="line" data-startTime="2346">talked to do so, which strikes me as a bug </span><span class="line" data-startTime="2346">in the spec because I don't know why anyone </span><span class="line" data-startTime="2352">would ever care about getting 200 touch or </span><span class="line" data-startTime="2352">scroll events per frame and yet every single </span><span class="line" data-startTime="2359">application that any developer here is going </span><span class="line" data-startTime="2359">to write means that we have to take all this </span><span class="line" data-startTime="2363">data, persist it somewhere, use it in yet </span><span class="line" data-startTime="2363">another function and let it be garbage collected </span><span class="line" data-startTime="2369">later. </span><span class="line" data-startTime="2369">Is that something that we should address at </span><span class="line" data-startTime="2370">a lower level than the JavaScript that we </span><span class="line" data-startTime="2370">write? </span></p>

<p class="speaker"><span class="line" data-starttime="2374"><span class="speakerName">Paul Lewis</span>: Well, I think if that's how </span><span class="line" data-startTime="2374">you feel, definitely involve yourself in the </span><span class="line" data-startTime="2377">spec process for sure. It's something that </span><span class="line" data-startTime="2377">we're trying to watch and I'm interested in </span><span class="line" data-startTime="2385">it because especially, as I said, I see a </span><span class="line" data-startTime="2385">lot of code going to scroll handlers and touch </span><span class="line" data-startTime="2389">handlers that doesn't need to be there. So </span><span class="line" data-startTime="2389">there's a certain amount of "should this be </span><span class="line" data-startTime="2394">spec, should this be developer required." </span><span class="line" data-startTime="2394">I haven't got a good use case for multiple </span><span class="line" data-startTime="2399">scroll handler &mdash; or multiple calls to the </span><span class="line" data-startTime="2399">scroll handler, for example, inside a single </span><span class="line" data-startTime="2404">frame, but I wouldn't like to presume that </span><span class="line" data-startTime="2404">nobody does, but I'm not saying that they </span><span class="line" data-startTime="2408">do either, so I guess it could be something </span><span class="line" data-startTime="2408">that should be spec'd, and I'd involve yourself </span><span class="line" data-startTime="2413">in the spec process and see if we can hash </span><span class="line" data-startTime="2413">it out. </span></p>

<p class="speaker"><span class="line" data-starttime="2415"><span class="speakerName">Peter Beverloo</span>: Well, a lot of specifications </span><span class="line" data-startTime="2415">already keep this in mind by offering asynchronous </span><span class="line" data-startTime="2419">functionality rather than synchronous ones. </span><span class="line" data-startTime="2419">And even though this is often not the case </span><span class="line" data-startTime="2423">for event handlers yet, for &mdash; for getting </span><span class="line" data-startTime="2423">many kinds of data, it will allow it to do </span><span class="line" data-startTime="2428">on the background thread, not block any other </span><span class="line" data-startTime="2428">processing and just come back when everything </span><span class="line" data-startTime="2433">is available. </span><span class="line" data-startTime="2433">We've gone a little bit over time. </span></p>

<p class="speaker"><span class="line" data-starttime="2436"><span class="speakerName">Paul Lewis</span>: Yeah. So I'm afraid if you've </span><span class="line" data-startTime="2436">got any questions, just come and find us upstairs. </span><span class="line" data-startTime="2440">Thank you. </span></p>