<p class="speaker"><span class="line" data-starttime="2"><span class="speakerName">Saurabh Gupta</span>: Good afternoon, </span><span class="line" data-startTime="2">and welcome to everyone in </span><span class="line" data-startTime="5">this room and watching on the </span><span class="line" data-startTime="5">Livestream and YouTube. </span><span class="line" data-startTime="8">My name is Saurabh Gupta. </span><span class="line" data-startTime="10">I'm Product Manager of </span><span class="line" data-startTime="10">Google Apps Script. </span></p>

<p class="speaker"><span class="line" data-starttime="12"><span class="speakerName">Jonathan Rascher</span>: I'm </span><span class="line" data-startTime="12">Jonathan Rascher. </span><span class="line" data-startTime="13">I'm a software engineer </span><span class="line" data-startTime="13">at Google Apps Script. </span></p>

<p class="speaker"><span class="line" data-starttime="15"><span class="speakerName">Saurabh Gupta</span>: And today, we are </span><span class="line" data-startTime="15">going to show you how you </span><span class="line" data-startTime="19">can extend Google Docs </span><span class="line" data-startTime="19">with Apps Script. </span> <span class="line" data-startTime="25">So with a show of hands, how </span><span class="line" data-startTime="25">many of you have heard of </span><span class="line" data-startTime="28">Google Docs or used </span><span class="line" data-startTime="28">Google Docs? </span><span class="line" data-startTime="31">Almost all of you. </span> <span class="line" data-startTime="32">I figured that much. </span> <span class="line" data-startTime="33">But for those of you who haven't </span><span class="line" data-startTime="33">or those of you who </span><span class="line" data-startTime="35">are watching on the Livestream, </span><span class="line" data-startTime="35">Google Docs is a </span><span class="line" data-startTime="38">word processing app </span><span class="line" data-startTime="38">in Google Drive. </span> <span class="line" data-startTime="43">Using Google Docs, you can </span><span class="line" data-startTime="43">create and share documents </span><span class="line" data-startTime="47">across devices &mdash; </span><span class="line" data-startTime="48">in your browser, on your iPhone </span><span class="line" data-startTime="48">or Android phone. </span> <span class="line" data-startTime="53">And yes, it works even when </span><span class="line" data-startTime="53">you are not connected. </span> <span class="line" data-startTime="56">It's really awesome. </span></p>

<p><span class="line" data-startTime="58">But you know what is </span><span class="line" data-startTime="58">even more awesome? </span><span class="line" data-startTime="61">Starting this week, </span><span class="line" data-startTime="61">you can use Apps </span><span class="line" data-startTime="65">Script in Google Docs. </span> <span class="line" data-startTime="67">That's awesome. </span> <span class="line" data-startTime="69">[APPLAUSE] </span><span class="line" data-startTime="70">Thank you. </span> <span class="line" data-startTime="73">And for those of you who do not </span><span class="line" data-startTime="73">know what Apps Script is, </span><span class="line" data-startTime="76">well, Apps Script is </span><span class="line" data-startTime="76">the JavaScript </span><span class="line" data-startTime="78">engine in the cloud. </span> <span class="line" data-startTime="79">And it lets you integrate and </span><span class="line" data-startTime="79">automate and make the most out </span><span class="line" data-startTime="83">of Google Apps. </span> <span class="line" data-startTime="85">So you might ask, well, that's </span><span class="line" data-startTime="85">all great and good and yeah, </span><span class="line" data-startTime="89">you can use the Apps Script in </span><span class="line" data-startTime="89">Google Docs, but what does </span><span class="line" data-startTime="91">that really mean? </span><span class="line" data-startTime="92">So just to elaborate on that, </span><span class="line" data-startTime="92">let me share a simple story. </span> <span class="line" data-startTime="96">And this happened a few months </span><span class="line" data-startTime="96">ago, and Jonathan will </span><span class="line" data-startTime="98">remember this. </span> <span class="line" data-startTime="99">Jonathan and I were hanging out </span><span class="line" data-startTime="99">with our friend, Bob, in a </span><span class="line" data-startTime="103">bistro a few months ago. </span> <span class="line" data-startTime="105">And Bob was talking about </span><span class="line" data-startTime="105">awesome research that he's </span><span class="line" data-startTime="109">doing and this great research </span><span class="line" data-startTime="109">paper that he's writing. </span></p>

<p><span class="line" data-startTime="113">And we were pretty excited </span><span class="line" data-startTime="113">because we know Bob is a </span><span class="line" data-startTime="116">Google Docs user. </span> <span class="line" data-startTime="118">So we were super excited </span><span class="line" data-startTime="118">about that. </span> <span class="line" data-startTime="121">And he was going on and </span><span class="line" data-startTime="121">on about his research. </span> <span class="line" data-startTime="123">But he had a slight problem. </span> <span class="line" data-startTime="125">He said, well, he is referring </span><span class="line" data-startTime="125">to a ton of sources &mdash; </span><span class="line" data-startTime="129">books, journals, articles, </span><span class="line" data-startTime="129">you name it. </span> <span class="line" data-startTime="132">And he's having a hard </span><span class="line" data-startTime="132">time keeping up. </span> <span class="line" data-startTime="135">And what's even more worrying </span><span class="line" data-startTime="135">for him was that he wanted to </span><span class="line" data-startTime="140">make sure that he's citing all </span><span class="line" data-startTime="140">these sources, he's giving </span><span class="line" data-startTime="143">credit where credit is due. </span> <span class="line" data-startTime="145">So this was a genuine </span><span class="line" data-startTime="145">problem for him. </span> <span class="line" data-startTime="147">So you know what </span><span class="line" data-startTime="147">happened next? </span><span class="line" data-startTime="149">Well, something that usually </span><span class="line" data-startTime="149">happens when you put a user, </span><span class="line" data-startTime="153">an engineer, and a product </span><span class="line" data-startTime="153">manager on the table. </span> <span class="line" data-startTime="155">A napkin comes out, and people </span><span class="line" data-startTime="155">start scribbling stuff. </span></p>

<p><span class="line" data-startTime="158">And that's what we </span><span class="line" data-startTime="158">exactly did. </span> <span class="line" data-startTime="160">And we drew something and said, </span><span class="line" data-startTime="160">hey Bob, you need a </span><span class="line" data-startTime="163">bibliography management </span><span class="line" data-startTime="163">app in Google Docs. </span> <span class="line" data-startTime="166">And Bob said, yeah, I want to be </span><span class="line" data-startTime="166">able to add sources to it &mdash; </span><span class="line" data-startTime="169">all of those sources </span><span class="line" data-startTime="169">that you just saw. </span> <span class="line" data-startTime="172">Not just that, I want to be able </span><span class="line" data-startTime="172">to cite those sources in </span><span class="line" data-startTime="175">my research paper. </span> <span class="line" data-startTime="177">And, at the end of it, I want to </span><span class="line" data-startTime="177">have a well-formatted, good </span><span class="line" data-startTime="181">looking bibliography in </span><span class="line" data-startTime="181">my research paper. </span> <span class="line" data-startTime="185">So he said, yes, exactly. </span></p>

<p><span class="line" data-startTime="187">This a great use case. </span> <span class="line" data-startTime="188">And right after the dinner, </span><span class="line" data-startTime="188">Jonathan and I went back to </span><span class="line" data-startTime="192">the office and said, hey, we've </span><span class="line" data-startTime="192">got to build our friend </span><span class="line" data-startTime="194">Bob this app. </span> <span class="line" data-startTime="197">And that's what we </span><span class="line" data-startTime="197">exactly did. </span> <span class="line" data-startTime="198">And you know what we built? </span><span class="line" data-startTime="200">We built an app called Bibstro </span><span class="line" data-startTime="200">using Google Apps Script. </span> <span class="line" data-startTime="203">And then you will ask, </span><span class="line" data-startTime="203">why Bibstro? </span><span class="line" data-startTime="205">Well, it's obvious. </span> <span class="line" data-startTime="206">In the moment of sobriety, we </span><span class="line" data-startTime="206">were sitting in a bistro, and </span><span class="line" data-startTime="210">we thought about </span><span class="line" data-startTime="211">bibliographies, so why not Bibstro? </span><span class="line" data-startTime="213">But the important thing here </span><span class="line" data-startTime="213">is that this app is built </span><span class="line" data-startTime="217">using Google Apps Script. </span> <span class="line" data-startTime="219">And what we are going to show </span><span class="line" data-startTime="219">you here in the next two </span><span class="line" data-startTime="223">minutes is a demo of Bibstro. </span></p>

<p><span class="line" data-startTime="225">And the point of the demo </span><span class="line" data-startTime="225">is that you can </span><span class="line" data-startTime="226">build your own app. </span> <span class="line" data-startTime="227">And we hope to give you some </span><span class="line" data-startTime="227">insights into how you can </span><span class="line" data-startTime="230">build your own app </span><span class="line" data-startTime="230">in Google Docs. </span> <span class="line" data-startTime="232">So let's get to the demo. </span> <span class="line" data-startTime="237">This is Google Docs, and this </span><span class="line" data-startTime="237">is Bob's research paper. </span> <span class="line" data-startTime="240">And as you can see, on the Menu </span><span class="line" data-startTime="240">left of Help, is a menu </span><span class="line" data-startTime="245">item called Bibstro. </span> <span class="line" data-startTime="247">So the first thing that </span><span class="line" data-startTime="247">Bob needs to do is </span><span class="line" data-startTime="249">configure this app. </span> <span class="line" data-startTime="251">And so he clicks on Bibstro, </span><span class="line" data-startTime="251">and he clicks on Settings. </span> <span class="line" data-startTime="258">And you can see there </span><span class="line" data-startTime="258">is a submenu, and </span><span class="line" data-startTime="259">he clicks on Configure. </span> <span class="line" data-startTime="260">And up comes a form, and he </span><span class="line" data-startTime="260">chooses a citation format, and </span><span class="line" data-startTime="264">he configures the app. </span> <span class="line" data-startTime="266">That's pretty straightforward. </span> <span class="line" data-startTime="268">The next thing, if you remember </span><span class="line" data-startTime="268">from the napkin that </span><span class="line" data-startTime="271">I was talking about, was he </span><span class="line" data-startTime="271">needs to add sources &mdash; </span><span class="line" data-startTime="273">all of those list of papers </span><span class="line" data-startTime="273">and journals and </span><span class="line" data-startTime="276">all of those articles. </span></p>

<p><span class="line" data-startTime="277">So he clicks on Bibstro, clicks </span><span class="line" data-startTime="277">on Add Source, and up </span><span class="line" data-startTime="280">comes another form. </span> <span class="line" data-startTime="281">And you can see how </span><span class="line" data-startTime="281">well-formatted and good </span><span class="line" data-startTime="284">looking UI it is. </span> <span class="line" data-startTime="285">And he starts adding all of </span><span class="line" data-startTime="285">these sources in this app. </span> <span class="line" data-startTime="290">And he collects a list of </span><span class="line" data-startTime="290">sources, and a bibliography </span><span class="line" data-startTime="295">gets generated for it. </span> <span class="line" data-startTime="297">So he adds a source, and the </span><span class="line" data-startTime="297">next thing he does is he </span><span class="line" data-startTime="300">scrolls all the way to the </span><span class="line" data-startTime="300">bottom of the document and </span><span class="line" data-startTime="302">sees that, hey, here's </span><span class="line" data-startTime="302">this bibliography &mdash; </span><span class="line" data-startTime="305">well-formatted according to the </span><span class="line" data-startTime="305">standard that he chose, </span><span class="line" data-startTime="309">and it's right there. </span> <span class="line" data-startTime="310">So that's awesome. </span> <span class="line" data-startTime="312">That's cool. </span></p>

<p><span class="line" data-startTime="312">So he gets a bibliography. </span> <span class="line" data-startTime="314">He is able to add sources. </span> <span class="line" data-startTime="316">The next thing he wants to do is </span><span class="line" data-startTime="316">be able to cite the source. </span> <span class="line" data-startTime="320">So he scrolls up in his </span><span class="line" data-startTime="320">document, locates the cursor </span><span class="line" data-startTime="325">wherever he wants to cite the </span><span class="line" data-startTime="325">source, then clicks on the </span><span class="line" data-startTime="327">menu item Bibstro and clicks </span><span class="line" data-startTime="327">on Add Inline Citation. </span> <span class="line" data-startTime="333">And now he can choose from any </span><span class="line" data-startTime="333">of the source and cite that </span><span class="line" data-startTime="337">source right in the document. </span> <span class="line" data-startTime="340">So this is awesome, and </span><span class="line" data-startTime="340">you can see the </span><span class="line" data-startTime="341">source is now cited. </span> <span class="line" data-startTime="343">So we met all of Bob's </span><span class="line" data-startTime="343">requirements and built this </span><span class="line" data-startTime="346">app using Google Apps Script. </span></p>

<p><span class="line" data-startTime="347">But Bob is our friend, and we </span><span class="line" data-startTime="347">wanted to throw in a little </span><span class="line" data-startTime="350">bit of extra. </span> <span class="line" data-startTime="352">So the extra that we wanted to </span><span class="line" data-startTime="352">throw in was, hey, what if Bob </span><span class="line" data-startTime="355">wants to see where a particular </span><span class="line" data-startTime="355">source is </span><span class="line" data-startTime="359">cited in the doc? </span><span class="line" data-startTime="361">So we built a capability </span><span class="line" data-startTime="361">called Manage Sources. </span> <span class="line" data-startTime="365">So Bob clicks on, again, Bibstro </span><span class="line" data-startTime="365">and says, OK, I want </span><span class="line" data-startTime="369">to manage a source. </span> <span class="line" data-startTime="370">And up comes on the right side </span><span class="line" data-startTime="370">a panel which shows a list of </span><span class="line" data-startTime="375">all of Bob's sources. </span></p>

<p><span class="line" data-startTime="378">And here, Bob can just say, </span><span class="line" data-startTime="378">OK, I want to highlight a </span><span class="line" data-startTime="381">particular source. </span> <span class="line" data-startTime="382">And you can see a source </span><span class="line" data-startTime="382">is highlighted. </span> <span class="line" data-startTime="384">And he can remove the source </span><span class="line" data-startTime="384">if he wants and do all of </span><span class="line" data-startTime="388">these kinds of interesting </span><span class="line" data-startTime="388">things. </span> <span class="line" data-startTime="389">But the one last thing that is </span><span class="line" data-startTime="389">pretty interesting is that he </span><span class="line" data-startTime="392">can scroll all the way to the </span><span class="line" data-startTime="392">bottom of his bibliography and </span><span class="line" data-startTime="395">say he just plays </span><span class="line" data-startTime="395">around with it. </span> <span class="line" data-startTime="397">Say he corrupts it </span><span class="line" data-startTime="397">or something. </span> <span class="line" data-startTime="399">Then he can just click on </span><span class="line" data-startTime="399">Refresh, and a bibliography </span><span class="line" data-startTime="403">gets refreshed. </span> <span class="line" data-startTime="404">So that's a very simple demo of </span><span class="line" data-startTime="404">a type of app you can build </span><span class="line" data-startTime="409">in Google Docs using </span><span class="line" data-startTime="409">Apps Script. </span></p>

<p><span class="line" data-startTime="412">And we want to make sure that </span><span class="line" data-startTime="412">yes, your app is also as </span><span class="line" data-startTime="417">awesome as this one using </span><span class="line" data-startTime="417">Google Apps Script. </span> <span class="line" data-startTime="420">So let's get started. </span> <span class="line" data-startTime="421">How do you build an </span><span class="line" data-startTime="421">app like that? </span><span class="line" data-startTime="423">Or rather, how did </span><span class="line" data-startTime="423">we build Bibstro? </span><span class="line" data-startTime="431">So there are four steps </span><span class="line" data-startTime="431">in building Bibstro. </span> <span class="line" data-startTime="434">The first step is that you </span><span class="line" data-startTime="434">want to be able to create </span><span class="line" data-startTime="438">scripts using the Script </span><span class="line" data-startTime="438">Editor in Google Docs. </span> <span class="line" data-startTime="442">So this is Google Docs. </span> <span class="line" data-startTime="445">You can see the Tools </span><span class="line" data-startTime="445">menu is expanded. </span> <span class="line" data-startTime="448">And in the Tools menu, </span><span class="line" data-startTime="448">you will see </span><span class="line" data-startTime="451">two new menu options &mdash; </span><span class="line" data-startTime="453">the Script Editor and </span><span class="line" data-startTime="453">the Script Manager. </span> <span class="line" data-startTime="457">Using the Script Editor, you </span><span class="line" data-startTime="457">can create container-bound </span><span class="line" data-startTime="460">scripts to Google Docs. </span> <span class="line" data-startTime="461">And you can learn a lot about </span><span class="line" data-startTime="461">container-bound scripts on our </span><span class="line" data-startTime="464">developer documentation. </span></p>

<p><span class="line" data-startTime="466">But the crux of it is that these </span><span class="line" data-startTime="466">scripts live and die </span><span class="line" data-startTime="470">with the document. </span> <span class="line" data-startTime="471">So this is the starting point. </span> <span class="line" data-startTime="472">You want to be able to create </span><span class="line" data-startTime="472">scripts in Document. </span> <span class="line" data-startTime="476">What's next? </span><span class="line" data-startTime="477">The second thing is you want </span><span class="line" data-startTime="477">to identify how you want to </span><span class="line" data-startTime="480">plug your app into the </span><span class="line" data-startTime="480">UI of Google Docs. </span> <span class="line" data-startTime="485">So again, this is Google Docs. </span> <span class="line" data-startTime="488">And anything that you want to </span><span class="line" data-startTime="488">do with Google Docs always </span><span class="line" data-startTime="491">starts with this class </span><span class="line" data-startTime="491">called DocumentApp. </span> <span class="line" data-startTime="494">If there is one thing that I </span><span class="line" data-startTime="494">want you to take away from </span><span class="line" data-startTime="497">this session, it's this &mdash; that </span><span class="line" data-startTime="497">DocumentApp is your starting </span><span class="line" data-startTime="502">point in building apps </span><span class="line" data-startTime="502">for Google Docs. </span> <span class="line" data-startTime="508">So this is Google Docs. </span> <span class="line" data-startTime="510">And what you see highlighted </span><span class="line" data-startTime="510">is the menu, or the UI. </span></p>

<p><span class="line" data-startTime="513">And it's very simple. </span> <span class="line" data-startTime="514">If you want to get a handle to </span><span class="line" data-startTime="514">the UI of Google Docs, just </span><span class="line" data-startTime="518">call DocumentApp.getUi. </span> <span class="line" data-startTime="520">It's that simple. </span> <span class="line" data-startTime="521">And then I'm going to show you </span><span class="line" data-startTime="521">some amazing things that you </span><span class="line" data-startTime="523">can do with the UI. </span> <span class="line" data-startTime="524">So first up is inserting a menu, </span><span class="line" data-startTime="524">and it's pretty simple. </span> <span class="line" data-startTime="529">As you can see on the code </span><span class="line" data-startTime="529">on the right, that </span><span class="line" data-startTime="533">DocumentApp.getUi.createMenu, </span><span class="line" data-startTime="533">and you can create a top level </span><span class="line" data-startTime="537">menu, then add items to it. </span> <span class="line" data-startTime="539">And you can even add </span><span class="line" data-startTime="539">submenus and so on. </span> <span class="line" data-startTime="542">But the idea is that </span><span class="line" data-startTime="542">DocumentApp.getUi gives you a </span><span class="line" data-startTime="545">handle to the different UI </span><span class="line" data-startTime="545">aspects of Google Docs. </span> <span class="line" data-startTime="549">So adding a menu is great. </span> <span class="line" data-startTime="550">What's next? </span><span class="line" data-startTime="553">Showing your app in a sidebar. </span> <span class="line" data-startTime="555">Now, if your app shows up in </span><span class="line" data-startTime="555">sidebar, that's great, because </span><span class="line" data-startTime="559">what users get with this is the </span><span class="line" data-startTime="559">opportunity to use your </span><span class="line" data-startTime="563">app while they're working with </span><span class="line" data-startTime="563">the document so it does not </span><span class="line" data-startTime="566">interrupt the flow </span><span class="line" data-startTime="566">of the user. </span></p>

<p><span class="line" data-startTime="567">So this is a natural place where </span><span class="line" data-startTime="567">your app shows and is </span><span class="line" data-startTime="572">very useful. </span> <span class="line" data-startTime="573">And again, using </span><span class="line" data-startTime="573">DocumentApp.getUi.showSidebar. </span> <span class="line" data-startTime="580">You can also surface your </span><span class="line" data-startTime="580">app in a dialog. </span> <span class="line" data-startTime="584">That interrupts the flow of the </span><span class="line" data-startTime="584">user, but it's perfect for </span><span class="line" data-startTime="587">forms and other things. </span> <span class="line" data-startTime="588">Again, using </span><span class="line" data-startTime="588">DocumentApp.getUi.showDialog. </span> <span class="line" data-startTime="592">It's quite similar to what </span><span class="line" data-startTime="592">you saw yesterday </span><span class="line" data-startTime="596">in the Forms session. </span> <span class="line" data-startTime="599">This was pretty similar where </span><span class="line" data-startTime="599">it was FormsApp.getUi and </span><span class="line" data-startTime="600">showDialog and all of that. </span> <span class="line" data-startTime="602">So there's a consistent theme </span><span class="line" data-startTime="602">around it as to how you get to </span><span class="line" data-startTime="605">the UI of Docs. </span> <span class="line" data-startTime="610">This example here is a little </span><span class="line" data-startTime="610">bit involved, but it shows you </span><span class="line" data-startTime="613">how you can serve your </span><span class="line" data-startTime="613">app in a dialog. </span> <span class="line" data-startTime="616">So say for instance, if you had </span><span class="line" data-startTime="616">a configdialog.html or an </span><span class="line" data-startTime="622">HTML file in your script project </span><span class="line" data-startTime="622">and that's the app </span><span class="line" data-startTime="626">that you wanted to show in a </span><span class="line" data-startTime="626">dialog, then you can very </span><span class="line" data-startTime="629">easily, using HTML service of </span><span class="line" data-startTime="629">Apps Script, create an HTML </span><span class="line" data-startTime="633">output object and just </span><span class="line" data-startTime="633">plug that in, in Show </span><span class="line" data-startTime="635">Dialog, and that's it. </span></p>

<p><span class="line" data-startTime="637">So you create an HTML output </span><span class="line" data-startTime="637">object using HTML service, and </span><span class="line" data-startTime="645">just paste that in Show </span><span class="line" data-startTime="645">Dialog, and your </span><span class="line" data-startTime="648">app as up and about. </span> <span class="line" data-startTime="651">So we talked about four steps, </span><span class="line" data-startTime="651">and we talked just two steps. </span> <span class="line" data-startTime="654">You can create scripts using </span><span class="line" data-startTime="654">the Script Editor. </span> <span class="line" data-startTime="658">You can extend the UI of Google </span><span class="line" data-startTime="658">Docs, plug into the UI. </span> <span class="line" data-startTime="663">The third thing you want to do </span><span class="line" data-startTime="663">is you want to wire your app </span><span class="line" data-startTime="666">into the Google Docs UI. </span> <span class="line" data-startTime="668">So the idea is your app should </span><span class="line" data-startTime="668">fire up somehow. </span> <span class="line" data-startTime="673">Or another way of asking this </span><span class="line" data-startTime="673">is, what is the Main </span><span class="line" data-startTime="676">equivalent, Main function, </span><span class="line" data-startTime="676">as you have in Java or C? </span><span class="line" data-startTime="680">What is the Main here? </span><span class="line" data-startTime="681">So let's look at how your </span><span class="line" data-startTime="681">app gets loaded up. </span></p>

<p><span class="line" data-startTime="684">So when a user opens a document, </span><span class="line" data-startTime="684">Apps Script looks in </span><span class="line" data-startTime="688">your code and looks for a </span><span class="line" data-startTime="688">function called onOpen. </span> <span class="line" data-startTime="692">So onOpen is sort of that </span><span class="line" data-startTime="692">equivalent of Main. </span> <span class="line" data-startTime="695">And once Apps Script finds </span><span class="line" data-startTime="695">onOpen, it executes onOpen. </span> <span class="line" data-startTime="698">So a typical use of onOpen </span><span class="line" data-startTime="698">is to insert menus. </span> <span class="line" data-startTime="703">Because you want to be able to </span><span class="line" data-startTime="703">extend the UI once the user </span><span class="line" data-startTime="706">opens the document. </span> <span class="line" data-startTime="707">And then, by clicking on menu </span><span class="line" data-startTime="707">items, you want the user to </span><span class="line" data-startTime="712">start using the app. </span> <span class="line" data-startTime="714">So this is a natural flow. </span></p>

<p><span class="line" data-startTime="716">A document is opened, onOpen is </span><span class="line" data-startTime="716">called, onOpen inserts menu </span><span class="line" data-startTime="720">items, and then user can click </span><span class="line" data-startTime="720">on menu item and the </span><span class="line" data-startTime="724">corresponding function </span><span class="line" data-startTime="724">will be invoked. </span> <span class="line" data-startTime="727">So that's simple, </span><span class="line" data-startTime="727">straightforward. </span> <span class="line" data-startTime="734">So we covered three steps &mdash; </span><span class="line" data-startTime="735">create scripts using the Script </span><span class="line" data-startTime="735">Editor, extending the </span><span class="line" data-startTime="738">UI of Google Docs, responding </span><span class="line" data-startTime="738">to events. </span> <span class="line" data-startTime="742">Jonathan now is going to cover </span><span class="line" data-startTime="742">how you can work with the </span><span class="line" data-startTime="744">document and modify </span><span class="line" data-startTime="744">the documents. </span> <span class="line" data-startTime="747">Jonathan? </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="748"><span class="speakerName">Jonathan Rascher</span>: Yes. </span> <span class="line" data-startTime="748">Thank you, Saurabh. </span> <span class="line" data-startTime="749">So Saurabh began the talk </span><span class="line" data-startTime="749">with our friend Bob. </span> <span class="line" data-startTime="753">And he was a Google Docs user, </span><span class="line" data-startTime="753">like Saurabh and I, like, I </span><span class="line" data-startTime="756">think, almost all of </span><span class="line" data-startTime="756">you, it seems like. </span> <span class="line" data-startTime="758">And he had this problem </span><span class="line" data-startTime="758">with Google Docs. </span> <span class="line" data-startTime="760">He wanted an ability to manage </span><span class="line" data-startTime="760">bibliographies in Docs. </span> <span class="line" data-startTime="764">And so we built him an app for </span><span class="line" data-startTime="764">that called Bibstro using this </span><span class="line" data-startTime="767">new Apps Script </span><span class="line" data-startTime="767">[? configuration. ?] </span><span class="line" data-startTime="769">And so Saurabh just covered </span><span class="line" data-startTime="769">the first three </span><span class="line" data-startTime="770">steps we used for this. </span> <span class="line" data-startTime="772">So we created some scripts. </span> <span class="line" data-startTime="774">We extended the Google Docs UI </span><span class="line" data-startTime="774">with custom UI elements. </span> <span class="line" data-startTime="777">And we can respond to events </span><span class="line" data-startTime="777">from those UI elements for </span><span class="line" data-startTime="780">things like menu clicks or </span><span class="line" data-startTime="780">button clicks, for example. </span></p>

<p><span class="line" data-startTime="784">So that brings us to </span><span class="line" data-startTime="784">the fourth point. </span> <span class="line" data-startTime="785">And this point is completely </span><span class="line" data-startTime="785">specific to DocumentApp. </span> <span class="line" data-startTime="789">If any of you saw, for example, </span><span class="line" data-startTime="789">the talk some of our </span><span class="line" data-startTime="791">colleagues gave yesterday about </span><span class="line" data-startTime="791">the integration with </span><span class="line" data-startTime="794">Google Apps Script and Google </span><span class="line" data-startTime="794">Forms, you'll see that these </span><span class="line" data-startTime="797">first three steps are very </span><span class="line" data-startTime="797">similar in Forms as in Docs or </span><span class="line" data-startTime="800">in Spreadsheets. </span> <span class="line" data-startTime="801">But this fourth step is specific </span><span class="line" data-startTime="801">to Google Docs. </span> <span class="line" data-startTime="806">So what we need to learn is, how </span><span class="line" data-startTime="806">is the document exposed to </span><span class="line" data-startTime="809">Apps Script? </span><span class="line" data-startTime="809">So when we want to do something </span><span class="line" data-startTime="809">in Bibstro, like </span><span class="line" data-startTime="811">maintain this live updating </span><span class="line" data-startTime="811">bibliography at the end of the </span><span class="line" data-startTime="814">document, how do we actually </span><span class="line" data-startTime="814">insert, and read, write, and </span><span class="line" data-startTime="817">modify the text in </span><span class="line" data-startTime="817">the document? </span><span class="line" data-startTime="818">And there's a couple of </span><span class="line" data-startTime="818">different ways that we can </span><span class="line" data-startTime="820">work with the Google Docs </span><span class="line" data-startTime="820">document from Apps Script, </span><span class="line" data-startTime="823">which I'm calling </span><span class="line" data-startTime="823">document models. </span></p>

<p><span class="line" data-startTime="825">The first of those is as </span><span class="line" data-startTime="825">a tree of elements. </span> <span class="line" data-startTime="828">So if you've ever done work </span><span class="line" data-startTime="828">with, say, HTML or XML, the </span><span class="line" data-startTime="831">Document Object Model or the </span><span class="line" data-startTime="831">DOM, then this should be </span><span class="line" data-startTime="834">somewhat familiar to you. </span> <span class="line" data-startTime="836">It's a tree-structured </span><span class="line" data-startTime="836">document, </span><span class="line" data-startTime="838">much like a web page. </span> <span class="line" data-startTime="839">Let's take a look at what </span><span class="line" data-startTime="839">this looks like. </span> <span class="line" data-startTime="842">So on the left, you can see </span><span class="line" data-startTime="842">we have a document. </span> <span class="line" data-startTime="845">This one's pretty simple. </span> <span class="line" data-startTime="846">It's got a couple </span><span class="line" data-startTime="846">of paragraphs. </span> <span class="line" data-startTime="847">There's a bulleted list. </span> <span class="line" data-startTime="849">There's a table and then at </span><span class="line" data-startTime="849">the bottom of the page, </span><span class="line" data-startTime="851">there's a page footer. </span> <span class="line" data-startTime="854">So this is all exposed to Apps </span><span class="line" data-startTime="854">Script as Document, the </span><span class="line" data-startTime="857">Document class. </span> <span class="line" data-startTime="858">And we get this in Apps </span><span class="line" data-startTime="858">Script code by saying </span><span class="line" data-startTime="860">DocumentApp.getActiveDocument. </span> <span class="line" data-startTime="863">And we'll see some </span><span class="line" data-startTime="863">code samples for </span><span class="line" data-startTime="864">this in just a minute. </span></p>

<p><span class="line" data-startTime="866">So this is sort of the </span><span class="line" data-startTime="866">equivalent of the root element </span><span class="line" data-startTime="869">of, say, a web page, </span><span class="line" data-startTime="869">the HTML element. </span> <span class="line" data-startTime="872">And like the HTML element in a </span><span class="line" data-startTime="872">web page, it's subdivided up </span><span class="line" data-startTime="875">into sections. </span> <span class="line" data-startTime="876">So we can see we have a body </span><span class="line" data-startTime="876">section at the top that's </span><span class="line" data-startTime="879">highlighted. </span> <span class="line" data-startTime="880">And then there's </span><span class="line" data-startTime="880">a little break. </span> <span class="line" data-startTime="881">And then down at the bottom, </span><span class="line" data-startTime="881">we have a footer section. </span> <span class="line" data-startTime="883">A page could also have, for </span><span class="line" data-startTime="883">example, a header section. </span> <span class="line" data-startTime="886">Or it could have a </span><span class="line" data-startTime="886">footnote section </span><span class="line" data-startTime="888">for numbered footnotes. </span> <span class="line" data-startTime="889">And these are all optional. </span> <span class="line" data-startTime="890">But any page is going to have </span><span class="line" data-startTime="890">a body, a document body. </span> <span class="line" data-startTime="895">If we take a look now inside the </span><span class="line" data-startTime="895">body, you can see that it </span><span class="line" data-startTime="898">contains elements &mdash; </span><span class="line" data-startTime="899">again, like in a web page &mdash; it </span><span class="line" data-startTime="899">contains elements for things </span><span class="line" data-startTime="902">like paragraphs, list items, </span><span class="line" data-startTime="902">tables, and so forth. </span></p>

<p><span class="line" data-startTime="906">These are kind of </span><span class="line" data-startTime="906">the equivalent </span><span class="line" data-startTime="907">of block level elements. </span> <span class="line" data-startTime="909">And they, in turn, are further </span><span class="line" data-startTime="909">subdivided up into other </span><span class="line" data-startTime="912">elements, into inline </span><span class="line" data-startTime="912">elements. </span> <span class="line" data-startTime="914">For example, if we take a look </span><span class="line" data-startTime="914">at this first paragraph here, </span><span class="line" data-startTime="917">this first paragraph just </span><span class="line" data-startTime="917">has some text in it. </span> <span class="line" data-startTime="920">But in the middle of that </span><span class="line" data-startTime="920">run of text, the text is </span><span class="line" data-startTime="922">interrupted by an image. </span> <span class="line" data-startTime="924">So how is this exposed </span><span class="line" data-startTime="924">to Apps Script? </span><span class="line" data-startTime="927">If you take a look now, you can </span><span class="line" data-startTime="927">see that this paragraph </span><span class="line" data-startTime="930">element has three </span><span class="line" data-startTime="930">child elements. </span> <span class="line" data-startTime="933">There's a text element, and </span><span class="line" data-startTime="933">that represents the run of </span><span class="line" data-startTime="935">text up to but not including </span><span class="line" data-startTime="935">the image. </span></p>

<p><span class="line" data-startTime="938">And then in the middle, </span><span class="line" data-startTime="938">there's an </span><span class="line" data-startTime="939">inline image element. </span> <span class="line" data-startTime="941">And that lets Apps Script access </span><span class="line" data-startTime="941">properties of the image </span><span class="line" data-startTime="943">like the binary contents of the </span><span class="line" data-startTime="943">image or the MIME types, </span><span class="line" data-startTime="947">so whether it's a PNG, </span><span class="line" data-startTime="947">or a JPEG, or a GIF, </span><span class="line" data-startTime="949">or what have you. </span> <span class="line" data-startTime="950">And then after that, there's </span><span class="line" data-startTime="950">another text element. </span> <span class="line" data-startTime="953">And this next text element just </span><span class="line" data-startTime="953">contains all of the text </span><span class="line" data-startTime="956">in the paragraph from the inline </span><span class="line" data-startTime="956">image up until the end </span><span class="line" data-startTime="959">of the paragraph. </span> <span class="line" data-startTime="960">And again, if you've ever done </span><span class="line" data-startTime="960">work with HTML, it should be </span><span class="line" data-startTime="963">very similar to what you've </span><span class="line" data-startTime="963">done with web pages. </span> <span class="line" data-startTime="966">Some of the element names are </span><span class="line" data-startTime="966">little bit different, but the </span><span class="line" data-startTime="968">basic idea is the same. </span> <span class="line" data-startTime="970">And in Apps Script, when we work </span><span class="line" data-startTime="970">with the document that </span><span class="line" data-startTime="973">the user sees on screen, what </span><span class="line" data-startTime="973">we're actually doing when we </span><span class="line" data-startTime="975">use this tree-based document </span><span class="line" data-startTime="975">model is saying, OK, we're </span><span class="line" data-startTime="978">going to take a look at </span><span class="line" data-startTime="978">the document tree. </span> <span class="line" data-startTime="980">And we're going to take a look </span><span class="line" data-startTime="980">just at specific elements or </span><span class="line" data-startTime="983">specific nodes in the document </span><span class="line" data-startTime="983">tree and do things like insert </span><span class="line" data-startTime="986">elements or delete them, </span><span class="line" data-startTime="986">change style </span><span class="line" data-startTime="988">properties, and so forth. </span></p>

<p><span class="line" data-startTime="990">This has all been kind of </span><span class="line" data-startTime="990">an abstract overview. </span> <span class="line" data-startTime="992">So now let's see a </span><span class="line" data-startTime="992">concrete example. </span> <span class="line" data-startTime="996">So recall from Bibstro, we had </span><span class="line" data-startTime="996">this functionality where </span><span class="line" data-startTime="999">Bibstro maintained, again, </span><span class="line" data-startTime="999">the bibliography at </span><span class="line" data-startTime="1001">the end of the document. </span> <span class="line" data-startTime="1002">And you saw that the first thing </span><span class="line" data-startTime="1002">Saurabh did in his demo, </span><span class="line" data-startTime="1005">he configured Bibstro to </span><span class="line" data-startTime="1005">pick a citation format. </span> <span class="line" data-startTime="1008">So he picked MLA format. </span> <span class="line" data-startTime="1009">But let's say you have a paper, </span><span class="line" data-startTime="1009">and you want to change </span><span class="line" data-startTime="1012">it for another journal. </span> <span class="line" data-startTime="1013">For example, you want </span><span class="line" data-startTime="1013">to change it to a </span><span class="line" data-startTime="1015">new citation format. </span> <span class="line" data-startTime="1016">So you go into Configure. </span> <span class="line" data-startTime="1017">You change from MLA format to </span><span class="line" data-startTime="1017">APA format, for example. </span></p>

<p><span class="line" data-startTime="1021">So what we want Bibstro </span><span class="line" data-startTime="1021">to do &mdash; </span><span class="line" data-startTime="1022">and what it, in fact, does &mdash; </span><span class="line" data-startTime="1024">is at that point updates the </span><span class="line" data-startTime="1024">bibliography, replaces the </span><span class="line" data-startTime="1027">existing sources, the existing </span><span class="line" data-startTime="1027">formatted references, with new </span><span class="line" data-startTime="1031">references in the new citation </span><span class="line" data-startTime="1031">format that you selected. </span> <span class="line" data-startTime="1034">So now, let's take </span><span class="line" data-startTime="1034">a look at how we </span><span class="line" data-startTime="1035">actually do that in Bibstro. </span> <span class="line" data-startTime="1038">Step one is we define the </span><span class="line" data-startTime="1038">bibliography in the document. </span> <span class="line" data-startTime="1041">We need to find the elements </span><span class="line" data-startTime="1041">in this document tree that </span><span class="line" data-startTime="1044">represent the contents of the </span><span class="line" data-startTime="1044">bibliography that the user </span><span class="line" data-startTime="1047">sees in their Document View. </span></p>

<p><span class="line" data-startTime="1049">And you can see at the top, </span><span class="line" data-startTime="1049">I've put this little blue </span><span class="line" data-startTime="1051">rectangle around this element </span><span class="line" data-startTime="1051">that says "Works Cited." </span><span class="line" data-startTime="1058">That's what we're going to call </span><span class="line" data-startTime="1058">the Title Paragraph at </span><span class="line" data-startTime="1060">the top of the bibliography. </span> <span class="line" data-startTime="1062">And it's part of the MLA </span><span class="line" data-startTime="1062">citation format. </span> <span class="line" data-startTime="1064">It's an indicator to somebody </span><span class="line" data-startTime="1064">reading an article or an essay </span><span class="line" data-startTime="1067">or what have you that OK, </span><span class="line" data-startTime="1067">the paper is done now. </span> <span class="line" data-startTime="1070">This is where the bibliography </span><span class="line" data-startTime="1070">starts. </span> <span class="line" data-startTime="1073">But it can also be an indicator </span><span class="line" data-startTime="1073">to Apps Script </span><span class="line" data-startTime="1075">programmatically of that </span><span class="line" data-startTime="1075">exact same thing. </span> <span class="line" data-startTime="1077">That this is where, in the </span><span class="line" data-startTime="1077">document tree, the </span><span class="line" data-startTime="1079">bibliography begins. </span> <span class="line" data-startTime="1081">So step one &mdash; </span><span class="line" data-startTime="1082">there's going to be three </span><span class="line" data-startTime="1082">steps total &mdash; </span><span class="line" data-startTime="1084">step one here is to find </span><span class="line" data-startTime="1084">that paragraph. </span> <span class="line" data-startTime="1088">So here we have some code </span><span class="line" data-startTime="1088">to do just that. </span> <span class="line" data-startTime="1091">So we start out with </span><span class="line" data-startTime="1091">documentApp.getActiveDocument, </span><span class="line" data-startTime="1094">and we say getBody to get that </span><span class="line" data-startTime="1094">body section &mdash; the main </span><span class="line" data-startTime="1096">contents of the document </span><span class="line" data-startTime="1096">between </span><span class="line" data-startTime="1098">any headers or footers. </span></p>

<p><span class="line" data-startTime="1100">And then we just do this while </span><span class="line" data-startTime="1100">loop, and we'd use the </span><span class="line" data-startTime="1102">findElement call on </span><span class="line" data-startTime="1102">the document body. </span> <span class="line" data-startTime="1105">So what the findElement call </span><span class="line" data-startTime="1105">does is it takes two </span><span class="line" data-startTime="1107">parameters. </span> <span class="line" data-startTime="1108">It takes the type of element </span><span class="line" data-startTime="1108">we want to find. </span> <span class="line" data-startTime="1110">In this case, we say that's </span><span class="line" data-startTime="1110">just a paragraph. </span> <span class="line" data-startTime="1112">So what we're saying actually </span><span class="line" data-startTime="1112">here is, loop over all the </span><span class="line" data-startTime="1115">paragraphs in the </span><span class="line" data-startTime="1115">document body. </span> <span class="line" data-startTime="1117">And then it also takes this </span><span class="line" data-startTime="1117">search result object. </span> <span class="line" data-startTime="1119">And at each iteration of the </span><span class="line" data-startTime="1119">loop, the search result object </span><span class="line" data-startTime="1122">is going to be populated with </span><span class="line" data-startTime="1122">the elements that we're </span><span class="line" data-startTime="1125">looking at right now. </span></p>

<p><span class="line" data-startTime="1126">And so we take that element, </span><span class="line" data-startTime="1126">that paragraph that we're </span><span class="line" data-startTime="1128">looking at, and we get its </span><span class="line" data-startTime="1128">text using Edit as Text. </span> <span class="line" data-startTime="1132">And we compare that to </span><span class="line" data-startTime="1132">this known string, </span><span class="line" data-startTime="1134">which is Works Cited. </span> <span class="line" data-startTime="1136">And when we find this paragraph </span><span class="line" data-startTime="1136">whose text is equal </span><span class="line" data-startTime="1137">to Works Cited, we know that </span><span class="line" data-startTime="1137">we've completed step one here. </span> <span class="line" data-startTime="1141">We found the title paragraph, </span><span class="line" data-startTime="1141">and hence, we found the rest </span><span class="line" data-startTime="1143">of the bibliography in the </span><span class="line" data-startTime="1143">document, which brings us to </span><span class="line" data-startTime="1147">this point. </span> <span class="line" data-startTime="1149">And so because the user wanted </span><span class="line" data-startTime="1149">to change their citation </span><span class="line" data-startTime="1151">format, the easiest way to do </span><span class="line" data-startTime="1151">this is just completely wipe </span><span class="line" data-startTime="1155">out the contents of the </span><span class="line" data-startTime="1155">bibliography and then just </span><span class="line" data-startTime="1158">reinsert new bibliography entry </span><span class="line" data-startTime="1158">paragraphs using the new </span><span class="line" data-startTime="1161">citation format. </span></p>

<p><span class="line" data-startTime="1163">So let's take a look </span><span class="line" data-startTime="1163">at how we do this. </span> <span class="line" data-startTime="1165">We start out with the title </span><span class="line" data-startTime="1165">paragraph that we had </span><span class="line" data-startTime="1167">previously. </span> <span class="line" data-startTime="1168">And now we do another </span><span class="line" data-startTime="1168">while loop. </span> <span class="line" data-startTime="1170">But this time, we're not </span><span class="line" data-startTime="1170">finding elements. </span> <span class="line" data-startTime="1172">We're looking at the next </span><span class="line" data-startTime="1172">sibling elements. </span> <span class="line" data-startTime="1175">Again, if you worked with the </span><span class="line" data-startTime="1175">document tree in HTML &mdash; </span><span class="line" data-startTime="1177">with JQuery, for example &mdash; </span><span class="line" data-startTime="1179">this should be somewhat </span><span class="line" data-startTime="1179">familiar. </span> <span class="line" data-startTime="1180">And if not, basically, a sibling </span><span class="line" data-startTime="1180">element is just the </span><span class="line" data-startTime="1183">element in the document that </span><span class="line" data-startTime="1183">comes immediately after the </span><span class="line" data-startTime="1186">bibliography title. </span> <span class="line" data-startTime="1188">So we do this, and now we want </span><span class="line" data-startTime="1188">to remove that paragraph, that </span><span class="line" data-startTime="1191">first bibliography entry after </span><span class="line" data-startTime="1191">the title from the document. </span> <span class="line" data-startTime="1195">So how do we do this? </span><span class="line" data-startTime="1196">It's a two step process. </span></p>

<p><span class="line" data-startTime="1198">So we take the title paragraph, </span><span class="line" data-startTime="1198">we get the </span><span class="line" data-startTime="1200">paragraph after it. </span> <span class="line" data-startTime="1201">And we take this bibliography </span><span class="line" data-startTime="1201">entry </span><span class="line" data-startTime="1202">paragraph and we call Clear. </span> <span class="line" data-startTime="1204">What Clear does is it says, </span><span class="line" data-startTime="1204">take the contents of this </span><span class="line" data-startTime="1206">paragraph, any text or any other </span><span class="line" data-startTime="1206">elements inside of it, </span><span class="line" data-startTime="1210">and just wipe them out </span><span class="line" data-startTime="1210">of the document. </span> <span class="line" data-startTime="1212">So at this point, we have the </span><span class="line" data-startTime="1212">title paragraph followed by an </span><span class="line" data-startTime="1215">empty paragraph where the </span><span class="line" data-startTime="1215">first bibliography </span><span class="line" data-startTime="1217">entry used to be. </span> <span class="line" data-startTime="1219">But we don't even want </span><span class="line" data-startTime="1219">an empty paragraph. </span> <span class="line" data-startTime="1220">We don't want to have any </span><span class="line" data-startTime="1220">paragraph at all left. </span> <span class="line" data-startTime="1223">So what we do is </span><span class="line" data-startTime="1223">we call Merge. </span> <span class="line" data-startTime="1225">Merge is kind of an interesting </span><span class="line" data-startTime="1226">operation, I think. </span> <span class="line" data-startTime="1228">It doesn't really map up cleanly </span><span class="line" data-startTime="1228">to the HTML document </span><span class="line" data-startTime="1231">object model or to an XML </span><span class="line" data-startTime="1231">document operation. </span> <span class="line" data-startTime="1234">What Merge is going to do is </span><span class="line" data-startTime="1234">it's going to say, take this </span><span class="line" data-startTime="1236">second paragraph, this </span><span class="line" data-startTime="1236">bibliography entry paragraph &mdash; </span><span class="line" data-startTime="1239">now it's empty because </span><span class="line" data-startTime="1239">we just cleared it &mdash; </span><span class="line" data-startTime="1241">and collapse this empty </span><span class="line" data-startTime="1241">paragraph into the </span><span class="line" data-startTime="1243">paragraph before it. </span></p>

<p><span class="line" data-startTime="1245">So now, after we call Merge, the </span><span class="line" data-startTime="1245">end result is we used to </span><span class="line" data-startTime="1248">have two paragraphs, now </span><span class="line" data-startTime="1248">we just have one. </span> <span class="line" data-startTime="1251">And its contents is just the </span><span class="line" data-startTime="1251">contents of the title </span><span class="line" data-startTime="1253">paragraph, because we cleared </span><span class="line" data-startTime="1253">the contents of the old </span><span class="line" data-startTime="1257">bibliography entry before </span><span class="line" data-startTime="1257">we called Merge. </span> <span class="line" data-startTime="1260">And so then we just </span><span class="line" data-startTime="1260">do this in a loop. </span> <span class="line" data-startTime="1262">And each iteration of the loop </span><span class="line" data-startTime="1262">uses this two step process to </span><span class="line" data-startTime="1266">remove one of the biography </span><span class="line" data-startTime="1266">entries from the document. </span> <span class="line" data-startTime="1269">And we do this until we've </span><span class="line" data-startTime="1269">removed all of those </span><span class="line" data-startTime="1271">bibliography entries after the </span><span class="line" data-startTime="1271">title paragraph, which brings </span><span class="line" data-startTime="1275">us to this point. </span> <span class="line" data-startTime="1276">So at this point, we have </span><span class="line" data-startTime="1276">the Works Cited </span><span class="line" data-startTime="1278">paragraph at the top. </span></p>

<p><span class="line" data-startTime="1280">And it's sitting there all by </span><span class="line" data-startTime="1280">its lonesome self, and it's </span><span class="line" data-startTime="1281">kind of sad, because all of </span><span class="line" data-startTime="1281">its friends are gone. </span> <span class="line" data-startTime="1284">So now what we want to do is </span><span class="line" data-startTime="1284">insert some new paragraphs </span><span class="line" data-startTime="1287">after it with the same </span><span class="line" data-startTime="1287">bibliography data from the </span><span class="line" data-startTime="1289">data store, but with the </span><span class="line" data-startTime="1289">new citation formats. </span> <span class="line" data-startTime="1293">The text in the document will </span><span class="line" data-startTime="1293">be different even though it </span><span class="line" data-startTime="1295">represents the same sources. </span> <span class="line" data-startTime="1298">And we do this as follows. </span> <span class="line" data-startTime="1300">This time, instead of removing </span><span class="line" data-startTime="1300">elements from the document, we </span><span class="line" data-startTime="1302">want to insert elements into </span><span class="line" data-startTime="1302">the document tree. </span> <span class="line" data-startTime="1305">So we take the title </span><span class="line" data-startTime="1305">paragraph &mdash; </span><span class="line" data-startTime="1307">once again, this is kind of our </span><span class="line" data-startTime="1307">anchor or our reference </span><span class="line" data-startTime="1309">point that tells us where in </span><span class="line" data-startTime="1309">the document tree does the </span><span class="line" data-startTime="1313">structured bibliography start? </span><span class="line" data-startTime="1315">And we take that title paragraph </span><span class="line" data-startTime="1315">and we get its </span><span class="line" data-startTime="1317">parent element. </span></p>

<p><span class="line" data-startTime="1318">So in this case, that'll </span><span class="line" data-startTime="1318">most likely be the </span><span class="line" data-startTime="1320">document's body element. </span> <span class="line" data-startTime="1321">But it makes the code a little </span><span class="line" data-startTime="1321">bit more general to speak of </span><span class="line" data-startTime="1323">it just as a parent. </span> <span class="line" data-startTime="1325">And so we take this parent </span><span class="line" data-startTime="1325">element, and we use it to get </span><span class="line" data-startTime="1328">the child index of the </span><span class="line" data-startTime="1328">title paragraph. </span> <span class="line" data-startTime="1331">That is to say, we use it to get </span><span class="line" data-startTime="1331">a number that represents </span><span class="line" data-startTime="1333">OK, which element, how many </span><span class="line" data-startTime="1333">elements into the parent is </span><span class="line" data-startTime="1337">this title paragraph? </span><span class="line" data-startTime="1339">And then we load some source </span><span class="line" data-startTime="1339">data for the bibliography </span><span class="line" data-startTime="1341">references. </span> <span class="line" data-startTime="1342">We load that from </span><span class="line" data-startTime="1342">a data store. </span> <span class="line" data-startTime="1344">And for each source, we have </span><span class="line" data-startTime="1344">some code somewhere to format </span><span class="line" data-startTime="1346">that according to the </span><span class="line" data-startTime="1346">citation format that </span><span class="line" data-startTime="1349">the user has selected. </span></p>

<p><span class="line" data-startTime="1351">And so we do that. </span> <span class="line" data-startTime="1351">And we have this </span><span class="line" data-startTime="1351">formatted text. </span> <span class="line" data-startTime="1353">And now we need to actually </span><span class="line" data-startTime="1353">put it into the document. </span> <span class="line" data-startTime="1355">And this is really simple. </span> <span class="line" data-startTime="1356">We take the parent element that </span><span class="line" data-startTime="1356">we found a minute ago, </span><span class="line" data-startTime="1359">and we just say, Insert </span><span class="line" data-startTime="1359">Paragraph. </span> <span class="line" data-startTime="1361">That takes two things. </span> <span class="line" data-startTime="1362">First of all, it takes a child </span><span class="line" data-startTime="1362">index or an insertion point. </span> <span class="line" data-startTime="1366">And to get this, we just use </span><span class="line" data-startTime="1366">the insertion point that we </span><span class="line" data-startTime="1368">computed previously, by getting </span><span class="line" data-startTime="1368">the child index of the </span><span class="line" data-startTime="1371">title paragraph and adding </span><span class="line" data-startTime="1371">one to that. </span> <span class="line" data-startTime="1374">And then this also takes a </span><span class="line" data-startTime="1374">string, which, in this case, </span><span class="line" data-startTime="1377">is just the formatted contents </span><span class="line" data-startTime="1377">of this new paragraph of the </span><span class="line" data-startTime="1380">bibliography entry. </span></p>

<p><span class="line" data-startTime="1382">So we make this Insert </span><span class="line" data-startTime="1382">Paragraph call. </span> <span class="line" data-startTime="1384">And after we do that, we've </span><span class="line" data-startTime="1384">now inserted a new </span><span class="line" data-startTime="1386">bibliography entry paragraph </span><span class="line" data-startTime="1386">after the title paragraph. </span> <span class="line" data-startTime="1390">And then we can do things like </span><span class="line" data-startTime="1390">set margins, set styles, or </span><span class="line" data-startTime="1392">whatever we want to do </span><span class="line" data-startTime="1392">on this new paragraph </span><span class="line" data-startTime="1394">that we've just inserted. </span> <span class="line" data-startTime="1396">And that's about it. </span> <span class="line" data-startTime="1397">We do this in a loop, over and </span><span class="line" data-startTime="1397">over again for each source. </span> <span class="line" data-startTime="1400">And at the end of this loop and </span><span class="line" data-startTime="1400">at the end of this three </span><span class="line" data-startTime="1402">step process, we've now removed </span><span class="line" data-startTime="1402">the old bibliography </span><span class="line" data-startTime="1406">entries from the document and </span><span class="line" data-startTime="1406">replaced them with new entries </span><span class="line" data-startTime="1408">using the new, up-to-date </span><span class="line" data-startTime="1408">citation format. </span> <span class="line" data-startTime="1412">And so that's pretty much how </span><span class="line" data-startTime="1412">we use the document tree in </span><span class="line" data-startTime="1414">Apps Script to work </span><span class="line" data-startTime="1414">with the document. </span> <span class="line" data-startTime="1416">And it's great. </span> <span class="line" data-startTime="1417">It's a little bit involved, </span><span class="line" data-startTime="1417">but it's really not that </span><span class="line" data-startTime="1419">complicated. </span></p>

<p><span class="line" data-startTime="1419">But it does involve a </span><span class="line" data-startTime="1419">good bit of code. </span> <span class="line" data-startTime="1421">You can see I had to split </span><span class="line" data-startTime="1421">this over three slides. </span> <span class="line" data-startTime="1425">So for cases where we don't </span><span class="line" data-startTime="1425">actually care about the </span><span class="line" data-startTime="1427">elements of the document, about </span><span class="line" data-startTime="1427">the tree structure, it </span><span class="line" data-startTime="1430">seems like it would be nice if </span><span class="line" data-startTime="1430">we had some way to work with </span><span class="line" data-startTime="1432">the document just as rich text, </span><span class="line" data-startTime="1432">ignoring intricacies </span><span class="line" data-startTime="1436">like different elements. </span> <span class="line" data-startTime="1438">It turns out that we also can </span><span class="line" data-startTime="1438">look at the document as this. </span> <span class="line" data-startTime="1441">The second document model is a </span><span class="line" data-startTime="1441">long string of formatted text, </span><span class="line" data-startTime="1445">of rich text, ignoring anything </span><span class="line" data-startTime="1445">like non-text </span><span class="line" data-startTime="1448">elements, like sections </span><span class="line" data-startTime="1448">and so forth. </span> <span class="line" data-startTime="1452">And you recall from Bibstro, </span><span class="line" data-startTime="1452">we had this functionality </span><span class="line" data-startTime="1455">where we have this sidebar, </span><span class="line" data-startTime="1455">which I totally love. </span></p>

<p><span class="line" data-startTime="1458">We have this sidebar, and the </span><span class="line" data-startTime="1458">user can pick a source in the </span><span class="line" data-startTime="1462">bibliography in the sidebar. </span> <span class="line" data-startTime="1463">And they can click the </span><span class="line" data-startTime="1463">Highlight button. </span> <span class="line" data-startTime="1465">And then that source, all the </span><span class="line" data-startTime="1465">citations that reference that </span><span class="line" data-startTime="1467">source, will be highlighted in </span><span class="line" data-startTime="1467">the document by setting their </span><span class="line" data-startTime="1470">background to yellow. </span> <span class="line" data-startTime="1472">So how do we do this? </span><span class="line" data-startTime="1473">Do we need to worry about </span><span class="line" data-startTime="1473">element trees and all of this </span><span class="line" data-startTime="1476">for something like this </span><span class="line" data-startTime="1476">that's strictly </span><span class="line" data-startTime="1477">a text-based approach? </span><span class="line" data-startTime="1479">I saw somebody shake their head, </span><span class="line" data-startTime="1479">and I love that, because </span><span class="line" data-startTime="1481">no, we don't. </span></p>

<p><span class="line" data-startTime="1482">So we have </span><span class="line" data-startTime="1482">DocumentApp.getActiveDocument </span><span class="line" data-startTime="1485">and getBody, and that's </span><span class="line" data-startTime="1485">the same as before. </span> <span class="line" data-startTime="1488">But now the technique we're </span><span class="line" data-startTime="1488">using here starts </span><span class="line" data-startTime="1490">to diverge a bit. </span> <span class="line" data-startTime="1491">So now we say Edit as Text. </span> <span class="line" data-startTime="1493">You might recall we did this </span><span class="line" data-startTime="1493">a minute ago on a single </span><span class="line" data-startTime="1495">paragraph to get just the </span><span class="line" data-startTime="1495">text of a paragraph. </span> <span class="line" data-startTime="1499">But we can also do this on the </span><span class="line" data-startTime="1499">entire document body, and this </span><span class="line" data-startTime="1501">is going to give us back a text </span><span class="line" data-startTime="1501">element that contains </span><span class="line" data-startTime="1504">just the textual contents of the </span><span class="line" data-startTime="1504">paragraph with things like </span><span class="line" data-startTime="1507">inline images or inline drawings </span><span class="line" data-startTime="1507">just left out. </span> <span class="line" data-startTime="1510">So they're still left </span><span class="line" data-startTime="1510">in the document. </span> <span class="line" data-startTime="1511">They won't be removed from the </span><span class="line" data-startTime="1511">document that the user sees. </span> <span class="line" data-startTime="1514">But they're removed from the </span><span class="line" data-startTime="1514">model of the document, or the </span><span class="line" data-startTime="1516">view of the document, that's </span><span class="line" data-startTime="1516">exposed to Apps Script. </span></p>

<p><span class="line" data-startTime="1519">And then we can use normal </span><span class="line" data-startTime="1519">string operations in </span><span class="line" data-startTime="1521">JavaScript. </span> <span class="line" data-startTime="1522">For example, here we have a </span><span class="line" data-startTime="1522">regular expression in the </span><span class="line" data-startTime="1524">middle of the slide. </span> <span class="line" data-startTime="1526">And that matches parenthesized </span><span class="line" data-startTime="1526">substrings in the </span><span class="line" data-startTime="1528">document, or citations. </span> <span class="line" data-startTime="1530">And you can tell it's a regular </span><span class="line" data-startTime="1530">expression because it </span><span class="line" data-startTime="1532">is horrendously ugly </span><span class="line" data-startTime="1532">and it's just an </span><span class="line" data-startTime="1534">abomination to look at. </span> <span class="line" data-startTime="1535">But that's just standard </span><span class="line" data-startTime="1535">JavaScript. </span> <span class="line" data-startTime="1538">And so we do a JavaScript </span><span class="line" data-startTime="1538">regular </span><span class="line" data-startTime="1539">expression match in a loop. </span></p>

<p><span class="line" data-startTime="1541">And we loop over all the </span><span class="line" data-startTime="1541">citations in the string </span><span class="line" data-startTime="1543">contents of the document body. </span> <span class="line" data-startTime="1545">And for each of those citations, </span><span class="line" data-startTime="1545">what we do is we </span><span class="line" data-startTime="1548">say, OK, we have some </span><span class="line" data-startTime="1548">logic to find out. </span> <span class="line" data-startTime="1550">Does it go with the source that </span><span class="line" data-startTime="1551">we're trying to highlight? </span><span class="line" data-startTime="1552">And if it does, we want to set </span><span class="line" data-startTime="1552">the background color for that </span><span class="line" data-startTime="1555">substring in the document </span><span class="line" data-startTime="1555">body to yellow. </span> <span class="line" data-startTime="1558">So we use this body text element </span><span class="line" data-startTime="1558">that we got in the </span><span class="line" data-startTime="1560">first step, and we say </span><span class="line" data-startTime="1560">body text element </span><span class="line" data-startTime="1562">set background color. </span> <span class="line" data-startTime="1564">And that takes just </span><span class="line" data-startTime="1564">three things. </span> <span class="line" data-startTime="1566">It takes the first two </span><span class="line" data-startTime="1566">parameters as indices, so a </span><span class="line" data-startTime="1568">start index and an end index. </span> <span class="line" data-startTime="1571">And we compute these just </span><span class="line" data-startTime="1571">using the normal regular </span><span class="line" data-startTime="1573">expression indices we got from </span><span class="line" data-startTime="1573">the RegEx match, because these </span><span class="line" data-startTime="1576">indices, they're just character </span><span class="line" data-startTime="1576">text indices. </span></p>

<p><span class="line" data-startTime="1579">They ignore things like </span><span class="line" data-startTime="1579">element child </span><span class="line" data-startTime="1581">positions and so forth. </span> <span class="line" data-startTime="1583">And then finally, we just </span><span class="line" data-startTime="1583">pass in a color. </span> <span class="line" data-startTime="1585">So that's the hexidecimal </span><span class="line" data-startTime="1585">color code for yellow. </span> <span class="line" data-startTime="1588">And that's about it. </span> <span class="line" data-startTime="1589">So this Edit as Text based </span><span class="line" data-startTime="1589">approach, you can see it's </span><span class="line" data-startTime="1592">very different than </span><span class="line" data-startTime="1592">the document tree. </span> <span class="line" data-startTime="1593">It is not quite as powerful. </span> <span class="line" data-startTime="1595">The document tree can do </span><span class="line" data-startTime="1595">anything to the document, </span><span class="line" data-startTime="1598">whereas this can only perform </span><span class="line" data-startTime="1598">text and formatting </span><span class="line" data-startTime="1600">operations. </span></p>

<p><span class="line" data-startTime="1601">But for text and formatting </span><span class="line" data-startTime="1601">operations like highlighting </span><span class="line" data-startTime="1604">citations in an essay, in fact, </span><span class="line" data-startTime="1604">this lets you do the </span><span class="line" data-startTime="1607">same thing as you can do with </span><span class="line" data-startTime="1607">the tree-based approach, but </span><span class="line" data-startTime="1611">in much less code. </span> <span class="line" data-startTime="1612">And, in my opinion, in code </span><span class="line" data-startTime="1612">that's much easier to read, </span><span class="line" data-startTime="1615">regular expressions </span><span class="line" data-startTime="1615">notwithstanding. </span> <span class="line" data-startTime="1617">So that's about it. </span> <span class="line" data-startTime="1619">We have these two models </span><span class="line" data-startTime="1619">of the document. </span> <span class="line" data-startTime="1621">We can work with it either as a </span><span class="line" data-startTime="1621">tree, like a web page, or as </span><span class="line" data-startTime="1624">a long string of rich text with </span><span class="line" data-startTime="1624">formatting attributes </span><span class="line" data-startTime="1627">applied to each character </span><span class="line" data-startTime="1627">in that string. </span> <span class="line" data-startTime="1630">There's one other model of </span><span class="line" data-startTime="1630">working with the document. </span></p>

<p><span class="line" data-startTime="1632">This is not launched yet, but </span><span class="line" data-startTime="1632">it's going to be coming out in </span><span class="line" data-startTime="1635">the next couple of weeks after </span><span class="line" data-startTime="1635">I/O. And you saw Saurabh </span><span class="line" data-startTime="1637">actually hinted at </span><span class="line" data-startTime="1637">it in his demo. </span> <span class="line" data-startTime="1640">And that is, we're going to give </span><span class="line" data-startTime="1640">you an API to work with </span><span class="line" data-startTime="1642">cursor and selection </span><span class="line" data-startTime="1642">in the document. </span> <span class="line" data-startTime="1645">So when the user positions their </span><span class="line" data-startTime="1645">cursor in some text or </span><span class="line" data-startTime="1647">next to an image, or selects a </span><span class="line" data-startTime="1647">range of text or a table or </span><span class="line" data-startTime="1650">whatever you might have, we're </span><span class="line" data-startTime="1650">going to give you the ability </span><span class="line" data-startTime="1652">to determine where is the </span><span class="line" data-startTime="1652">cursor, or what is the </span><span class="line" data-startTime="1655">selection, and to operate on </span><span class="line" data-startTime="1655">the cursor or selection by </span><span class="line" data-startTime="1659">doing things like inserting </span><span class="line" data-startTime="1659">text at the cursor. </span> <span class="line" data-startTime="1662">So recall from the Bibstro demo </span><span class="line" data-startTime="1662">that Saurabh showed, we </span><span class="line" data-startTime="1665">have this menu, and we let the </span><span class="line" data-startTime="1665">user put their cursor after a </span><span class="line" data-startTime="1668">sentence or phrase they </span><span class="line" data-startTime="1668">want to cite. </span></p>

<p><span class="line" data-startTime="1670">And the user says, </span><span class="line" data-startTime="1670">Insert Citation. </span> <span class="line" data-startTime="1672">And we show them a dialog, </span><span class="line" data-startTime="1672">and they pick a source. </span> <span class="line" data-startTime="1675">And then that source appears </span><span class="line" data-startTime="1675">in the document right after </span><span class="line" data-startTime="1677">their cursor. </span> <span class="line" data-startTime="1679">So this is working today. </span> <span class="line" data-startTime="1680">We're finalizing the API for </span><span class="line" data-startTime="1680">launch to give you something </span><span class="line" data-startTime="1683">that reduces complexity in </span><span class="line" data-startTime="1683">a bunch of edge cases. </span> <span class="line" data-startTime="1685">There are surprisingly </span><span class="line" data-startTime="1685">many edge </span><span class="line" data-startTime="1687">cases in document selection. </span> <span class="line" data-startTime="1688">It's kind of amazing. </span></p>

<p><span class="line" data-startTime="1692">So there you go. </span> <span class="line" data-startTime="1692">That's about it. </span> <span class="line" data-startTime="1693">We have these four steps that </span><span class="line" data-startTime="1693">we use to build this app </span><span class="line" data-startTime="1696">called Bibstro, to build </span><span class="line" data-startTime="1696">a bibliography </span><span class="line" data-startTime="1698">app in Google Docs. </span> <span class="line" data-startTime="1700">So we created some scripts using </span><span class="line" data-startTime="1700">the Script Editor, using </span><span class="line" data-startTime="1702">the new Google Docs integration </span><span class="line" data-startTime="1702">that we just </span><span class="line" data-startTime="1704">launched a couple days ago. </span> <span class="line" data-startTime="1706">And we extended the Google Docs </span><span class="line" data-startTime="1706">UI to add things like </span><span class="line" data-startTime="1708">custom menus and dialogs, and </span><span class="line" data-startTime="1708">my personal favorite, custom </span><span class="line" data-startTime="1711">sidebars, because who doesn't </span><span class="line" data-startTime="1711">love a sidebar? </span><span class="line" data-startTime="1714">And then we also have the </span><span class="line" data-startTime="1714">ability to respond to events, </span><span class="line" data-startTime="1716">just like in any other </span><span class="line" data-startTime="1717">event-driven programming framework. </span></p>

<p><span class="line" data-startTime="1719">And those events can do things, </span><span class="line" data-startTime="1719">they can do operations </span><span class="line" data-startTime="1722">on the document on behalf of the </span><span class="line" data-startTime="1722">user, which is what makes </span><span class="line" data-startTime="1726">this all work together and </span><span class="line" data-startTime="1726">lets us build apps that </span><span class="line" data-startTime="1728">automate Google Docs &mdash; </span><span class="line" data-startTime="1729">apps like Bibstro or apps like </span><span class="line" data-startTime="1729">whatever you all want to do </span><span class="line" data-startTime="1733">any use case, document workflow, </span><span class="line" data-startTime="1733">whatever you want in </span><span class="line" data-startTime="1736">Google Docs. </span> <span class="line" data-startTime="1738">I'm excited to see what </span><span class="line" data-startTime="1738">you all are going </span><span class="line" data-startTime="1739">to build with this. </span> <span class="line" data-startTime="1740">I kind of hope you give it a </span><span class="line" data-startTime="1740">better name than Bibstro, </span><span class="line" data-startTime="1742">because that's just bad. </span> <span class="line" data-startTime="1744">So we have this. </span></p>

<p><span class="line" data-startTime="1746">That's about it for the talk. </span> <span class="line" data-startTime="1747">We have some links here </span><span class="line" data-startTime="1747">to our documentation. </span> <span class="line" data-startTime="1749">And also, I know I brushed over </span><span class="line" data-startTime="1749">the code samples kind of </span><span class="line" data-startTime="1752">quickly to get in a couple </span><span class="line" data-startTime="1752">of examples. </span> <span class="line" data-startTime="1754">So we're going to be posting </span><span class="line" data-startTime="1754">all of the code for this </span><span class="line" data-startTime="1756">Bibstro sample app online in a </span><span class="line" data-startTime="1756">couple of weeks after I/O. So </span><span class="line" data-startTime="1760">keep your eye on, say, the </span><span class="line" data-startTime="1760">Google Apps Developer Blog and </span><span class="line" data-startTime="1762">the Apps Script pages on </span><span class="line" data-startTime="1762">developers.google.com. </span> <span class="line" data-startTime="1764">So I think that's about it. </span> <span class="line" data-startTime="1768">Thank you all for watching. </span> <span class="line" data-startTime="1769">And, at this point, if you have </span><span class="line" data-startTime="1769">any questions, looks like </span><span class="line" data-startTime="1772">there's a couple of mics in </span><span class="line" data-startTime="1772">the middle of the room. </span> <span class="line" data-startTime="1773">So come up and talk </span><span class="line" data-startTime="1773">into the mic. </span> <span class="line" data-startTime="1775">Thank you. </span></p>

<p><span class="line" data-startTime="1776">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="1786"><span class="speakerName">Audience</span>: Hi Is this available </span><span class="line" data-startTime="1786">only for Docs, or available </span><span class="line" data-startTime="1789">also for the Spreadsheets </span><span class="line" data-startTime="1789">and the [INAUDIBLE]? </span></p>

<p class="speaker"><span class="line" data-starttime="1795"><span class="speakerName">Saurabh Gupta</span>: Today, you </span><span class="line" data-startTime="1795">can use scripts in </span><span class="line" data-startTime="1797">Spreadsheets and cite. </span><span class="line" data-startTime="1798">In yesterday's session, we </span><span class="line" data-startTime="1798">announced in Forms as well and </span><span class="line" data-startTime="1802">now in Documents. </span><span class="line" data-startTime="1804">Yes, please. </span></p>

<p class="speaker"><span class="line" data-starttime="1806"><span class="speakerName">Audience</span>: The adding of the </span><span class="line" data-startTime="1806">menus is different on </span><span class="line" data-startTime="1807">Spreadsheets, right? </span><span class="line" data-startTime="1808">So in Spreadsheets, </span><span class="line" data-startTime="1808">you say, Add Menu. </span><span class="line" data-startTime="1812">And so when are you going </span><span class="line" data-startTime="1812">to integrate the same </span><span class="line" data-startTime="1814">functionality, the new UI </span><span class="line" data-startTime="1814">service to add the sidebars? </span><span class="line" data-startTime="1820">What's the timeline for that </span><span class="line" data-startTime="1820">coming on Spreadsheets? </span></p>

<p class="speaker"><span class="line" data-starttime="1824"><span class="speakerName">Saurabh Gupta</span>: It will </span><span class="line" data-startTime="1824">happen pretty soon, </span><span class="line" data-startTime="1825">and this will converge. </span><span class="line" data-startTime="1827">As you saw in Forms and Docs, </span><span class="line" data-startTime="1827">we are creating a concept of </span><span class="line" data-startTime="1833">DocumentApp.getUi. </span><span class="line" data-startTime="1834">So if you can get handle to the </span><span class="line" data-startTime="1834">UI, you'll see something </span><span class="line" data-startTime="1837">similar in Spreadsheets </span><span class="line" data-startTime="1837">as well. </span></p>

<p class="speaker"><span class="line" data-starttime="1838"><span class="speakerName">Jonathan Rascher</span>: Right, and </span><span class="line" data-startTime="1838">this will include the full </span><span class="line" data-startTime="1839">range of what we talked </span><span class="line" data-startTime="1839">about today. </span><span class="line" data-startTime="1841">So things like, for example, </span><span class="line" data-startTime="1841">the sidebar that you can't </span><span class="line" data-startTime="1844">show today in Spreadsheets. </span><span class="line" data-startTime="1845">That sidebar that exists now in </span><span class="line" data-startTime="1845">DocumentApp and in FormApp </span><span class="line" data-startTime="1848">will be coming to SpreadsheetApp </span><span class="line" data-startTime="1848">in the next </span><span class="line" data-startTime="1850">couple of weeks. </span></p>

<p class="speaker"><span class="line" data-starttime="1851"><span class="speakerName">Audience</span>: Just on the new </span><span class="line" data-startTime="1851">cursor-based location, would </span><span class="line" data-startTime="1857">we get a right click menu? </span></p>

<p class="speaker"><span class="line" data-starttime="1861"><span class="speakerName">Saurabh Gupta</span>: We have not </span><span class="line" data-startTime="1861">planned for it, but let's talk </span><span class="line" data-startTime="1863">about it at the Office Hours. </span></p>

<p class="speaker"><span class="line" data-starttime="1864"><span class="speakerName">Audience</span>: OK, thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="1866"><span class="speakerName">Saurabh Gupta</span>: Yes, please? </span></p>

<p class="speaker"><span class="line" data-starttime="1868"><span class="speakerName">Audience</span>: I've got a question </span><span class="line" data-startTime="1868">about deployment. </span><span class="line" data-startTime="1869">So is it something I can create </span><span class="line" data-startTime="1869">only inside my own </span><span class="line" data-startTime="1872">document, or is it something I </span><span class="line" data-startTime="1872">can create once and deploy it </span><span class="line" data-startTime="1875">to all the users in my domain? </span></p>

<p class="speaker"><span class="line" data-starttime="1877"><span class="speakerName">Saurabh Gupta</span>: So what you're </span><span class="line" data-startTime="1877">asking is really how you </span><span class="line" data-startTime="1879">distribute a script that can </span><span class="line" data-startTime="1879">be inserted into all the </span><span class="line" data-startTime="1883">documents across a number </span><span class="line" data-startTime="1883">of users and stuff. </span><span class="line" data-startTime="1885">So we're working on that. </span><span class="line" data-startTime="1886">And do watch the Google Apps </span><span class="line" data-startTime="1886">Developers Blog for </span><span class="line" data-startTime="1890">more news on that. </span><span class="line" data-startTime="1891">It's not there yet, </span><span class="line" data-startTime="1891">but coming soon. </span></p>

<p class="speaker"><span class="line" data-starttime="1893"><span class="speakerName">Audience</span>: OK, thanks. </span></p>

<p class="speaker"><span class="line" data-starttime="1896"><span class="speakerName">Saurabh Gupta</span>: Yes, please. </span></p>

<p class="speaker"><span class="line" data-starttime="1898"><span class="speakerName">Audience</span>: I wanted to ask about </span><span class="line" data-startTime="1898">if you've considered </span><span class="line" data-startTime="1900">cross-document integration. </span><span class="line" data-startTime="1902">So for example, if I have a </span><span class="line" data-startTime="1902">spreadsheet I want to use as a </span><span class="line" data-startTime="1904">data source to fill a Doc with </span><span class="line" data-startTime="1904">the citations, for example, or </span><span class="line" data-startTime="1908">if I want to hit an external </span><span class="line" data-startTime="1908">data source, such as I've got </span><span class="line" data-startTime="1913">a Cloud SQL database running and </span><span class="line" data-startTime="1913">I want to be able to pull </span><span class="line" data-startTime="1915">content from that into a report, </span><span class="line" data-startTime="1915">for example, and then </span><span class="line" data-startTime="1917">drive that into a Doc. </span></p>

<p class="speaker"><span class="line" data-starttime="1919"><span class="speakerName">Jonathan Rascher</span>: So that is </span><span class="line" data-startTime="1919">an excellent question. </span><span class="line" data-startTime="1921">And I think the answer is, we </span><span class="line" data-startTime="1921">don't have anything pre-built </span><span class="line" data-startTime="1924">to do this, but I think we give </span><span class="line" data-startTime="1924">you all the tools you'd </span><span class="line" data-startTime="1926">need to do that. </span><span class="line" data-startTime="1927">For example, we have </span><span class="line" data-startTime="1927">services called </span><span class="line" data-startTime="1930">SpreadsheetApp and DriveApp. </span><span class="line" data-startTime="1932">So what you could do &mdash; </span><span class="line" data-startTime="1933">I can't think of any </span><span class="line" data-startTime="1933">reason not to &mdash; </span><span class="line" data-startTime="1935">is you could have a sidebar in </span><span class="line" data-startTime="1935">Google Docs, or a dialog, that </span><span class="line" data-startTime="1938">uses the DriveApp service to let </span><span class="line" data-startTime="1938">the user pick a file from </span><span class="line" data-startTime="1941">their Google Drive, to pick a </span><span class="line" data-startTime="1941">spreadsheet, and then use the </span><span class="line" data-startTime="1944">SpreadsheetApp to take that </span><span class="line" data-startTime="1944">spreadsheet, read it in data </span><span class="line" data-startTime="1948">format, and populate it </span><span class="line" data-startTime="1948">into the document. </span><span class="line" data-startTime="1950">So there's nothing prefabricated </span><span class="line" data-startTime="1950">to do this, but </span><span class="line" data-startTime="1953">I believe we have all </span><span class="line" data-startTime="1953">the tools for </span><span class="line" data-startTime="1954">you to do that today. </span></p>

<p class="speaker"><span class="line" data-starttime="1958"><span class="speakerName">Saurabh Gupta</span>: Yes, please? </span><span class="line" data-startTime="1960">One more question. </span></p>

<p class="speaker"><span class="line" data-starttime="1962"><span class="speakerName">Audience</span>: Are you planning </span><span class="line" data-startTime="1962">on extending the document </span><span class="line" data-startTime="1964">permissions to, for example, </span><span class="line" data-startTime="1964">keep allowance for editing </span><span class="line" data-startTime="1968">document but not editing the </span><span class="line" data-startTime="1968">scripts inside of documents? </span></p>

<p class="speaker"><span class="line" data-starttime="1973"><span class="speakerName">Saurabh Gupta</span>: I'm sorry. </span><span class="line" data-startTime="1974">I did not understand </span><span class="line" data-startTime="1974">your question. </span></p>

<p class="speaker"><span class="line" data-starttime="1975"><span class="speakerName">Audience</span>: So when you give </span><span class="line" data-startTime="1975">somebody a permission </span><span class="line" data-startTime="1978">currently to edit your document, </span><span class="line" data-startTime="1978">you automatically </span><span class="line" data-startTime="1981">give them the permission to edit </span><span class="line" data-startTime="1981">scripts in the document. </span><span class="line" data-startTime="1985">Are you planning on having a </span><span class="line" data-startTime="1985">separate permission to allow </span><span class="line" data-startTime="1989">editing the document, but not </span><span class="line" data-startTime="1989">allowing editing the scripts? </span></p>

<p class="speaker"><span class="line" data-starttime="1993"><span class="speakerName">Saurabh Gupta</span>: That's an </span><span class="line" data-startTime="1993">interesting question, and we </span><span class="line" data-startTime="1994">debated this a lot. </span><span class="line" data-startTime="1996">When you create scripts, </span><span class="line" data-startTime="1996">they're </span><span class="line" data-startTime="1998">a part of the document. </span><span class="line" data-startTime="1999">They are inherent in the </span><span class="line" data-startTime="1999">sharing model from the </span><span class="line" data-startTime="2003">document itself. </span><span class="line" data-startTime="2004">So Edit privileges on the </span><span class="line" data-startTime="2004">document mean Edit privileges </span><span class="line" data-startTime="2006">on the script. </span><span class="line" data-startTime="2007">However, as a developer, what </span><span class="line" data-startTime="2007">you can do is you can use </span><span class="line" data-startTime="2012">libraries and then sort of </span><span class="line" data-startTime="2012">abstract that out where you're </span><span class="line" data-startTime="2016">using a library and not giving </span><span class="line" data-startTime="2016">editor permissions on the </span><span class="line" data-startTime="2019">library, just a view. </span><span class="line" data-startTime="2020">And so you can abstract </span><span class="line" data-startTime="2020">some of that out. </span><span class="line" data-startTime="2022">But really, what might help </span><span class="line" data-startTime="2022">you is things that we are </span><span class="line" data-startTime="2025">working on, which is the </span><span class="line" data-startTime="2025">distribution model, which is </span><span class="line" data-startTime="2027">how do you take a script and </span><span class="line" data-startTime="2027">just let users install it in </span><span class="line" data-startTime="2032">their documents and stuff. </span></p>

<p class="speaker"><span class="line" data-starttime="2034"><span class="speakerName">Jonathan Rascher</span>: Yeah, </span><span class="line" data-startTime="2034">do you want to &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="2036"><span class="speakerName">Audience</span>: Can I control the </span><span class="line" data-startTime="2036">existing menu of a Google Doc, </span><span class="line" data-startTime="2038">like download or print? </span><span class="line" data-startTime="2039">If I want to remove </span><span class="line" data-startTime="2039">that or disable </span><span class="line" data-startTime="2042">that, is that possible? </span></p>

<p class="speaker"><span class="line" data-starttime="2045"><span class="speakerName">Saurabh Gupta</span>: Not today. </span><span class="line" data-startTime="2047">You can insert a new </span><span class="line" data-startTime="2047">top level menu. </span><span class="line" data-startTime="2049">You cannot tinker around with </span><span class="line" data-startTime="2049">the existing native menu </span><span class="line" data-startTime="2052">options just yet. </span></p>

<p class="speaker"><span class="line" data-starttime="2053"><span class="speakerName">Jonathan Rascher</span>: Right. </span><span class="line" data-startTime="2054">And we've thought about things </span><span class="line" data-startTime="2054">like this, but there's some </span><span class="line" data-startTime="2056">intricacies involved. </span><span class="line" data-startTime="2057">For example, Google Docs can </span><span class="line" data-startTime="2057">change their menu structure as </span><span class="line" data-startTime="2060">they add features or just as </span><span class="line" data-startTime="2060">they move menu items around. </span><span class="line" data-startTime="2063">And you wouldn't want your </span><span class="line" data-startTime="2063">script to break, for example, </span><span class="line" data-startTime="2066">if a Google Docs menu item </span><span class="line" data-startTime="2066">wasn't in the location you </span><span class="line" data-startTime="2068">expected it to be at. </span></p>

<p class="speaker"><span class="line" data-starttime="2072"><span class="speakerName">Audience</span>: [INAUDIBLE] </span><span class="line" data-startTime="2073">is for disabling downloads. </span><span class="line" data-startTime="2076">Sometimes you want to share a </span><span class="line" data-startTime="2076">folder, and you want people to </span><span class="line" data-startTime="2079">only read documents. </span><span class="line" data-startTime="2080">And except for PDFs, where </span><span class="line" data-startTime="2080">really you can disable </span><span class="line" data-startTime="2083">downloads, you can't do that </span><span class="line" data-startTime="2083">on most document types. </span></p>

<p class="speaker"><span class="line" data-starttime="2087"><span class="speakerName">Saurabh Gupta</span>: So if I rephrase </span><span class="line" data-startTime="2087">your question, you </span><span class="line" data-startTime="2090">want more control over whether </span><span class="line" data-startTime="2090">a document can be </span><span class="line" data-startTime="2092">downloaded or not? </span></p>

<p class="speaker"><span class="line" data-starttime="2093"><span class="speakerName">Audience</span>: Yeah. </span></p>

<p class="speaker"><span class="line" data-starttime="2095"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="2097"><span class="speakerName">Saurabh Gupta</span>: I'm sorry? </span></p>

<p class="speaker"><span class="line" data-starttime="2098"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="2100"><span class="speakerName">Saurabh Gupta</span>: You cannot </span><span class="line" data-startTime="2100">play around with the </span><span class="line" data-startTime="2102">existing menu options. </span><span class="line" data-startTime="2103">What you can do is if you want </span><span class="line" data-startTime="2103">to build an interesting app, </span><span class="line" data-startTime="2106">you can add new menu options, </span><span class="line" data-startTime="2106">and let users use all of that. </span></p>

<p class="speaker"><span class="line" data-starttime="2111"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="2113"><span class="speakerName">Saurabh Gupta</span>: Can you please </span><span class="line" data-startTime="2113">come up to the mic? </span></p>

<p class="speaker"><span class="line" data-starttime="2116"><span class="speakerName">Audience</span>: Is this in your </span><span class="line" data-startTime="2116">roadmap, controlling the </span><span class="line" data-startTime="2118">existing menu items, because we </span><span class="line" data-startTime="2118">do a lot of requests from </span><span class="line" data-startTime="2120">customers, I can share a </span><span class="line" data-startTime="2120">document with someone, but I </span><span class="line" data-startTime="2123">don't want them to print </span><span class="line" data-startTime="2123">them or download them &mdash; </span><span class="line" data-startTime="2126">just view it. </span></p>

<p class="speaker"><span class="line" data-starttime="2128"><span class="speakerName">Saurabh Gupta</span>: Yeah. </span><span class="line" data-startTime="2129">I mean, you can share </span><span class="line" data-startTime="2129">documents with View </span><span class="line" data-startTime="2131">privileges, and that's a limited </span><span class="line" data-startTime="2131">set of things that you </span><span class="line" data-startTime="2133">can do on a document, </span><span class="line" data-startTime="2133">and that's about it. </span><span class="line" data-startTime="2138">Let's just check online if </span><span class="line" data-startTime="2138">there are more questions. </span><span class="line" data-startTime="2140">Any questions? </span><span class="line" data-startTime="2142">No questions. </span><span class="line" data-startTime="2144">Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="2144"><span class="speakerName">Jonathan Rascher</span>: Thank </span><span class="line" data-startTime="2144">you very much. </span><span class="line" data-startTime="2145">[APPLAUSE] </span></p>