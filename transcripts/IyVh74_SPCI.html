<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>TimesOpen: Performance</h1>

<h2>Pete, Adam Grossman, Jake Archibald, Eitan Konigsburg, Colt McAnlis</h2>

<a class="video" href="http://youtu.be/IyVh74_SPCI">youtu.be/IyVh74_SPCI</a><div id="transcript"><p><span class="line" data-startTime="0">[MUSIC PLAYING] </span></p>

<p class="speaker"><span class="line" data-starttime="184"><span class="speakerName">Pete</span>: All right, everybody. </span><span class="line" data-startTime="187">All right. </span><span class="line" data-startTime="188">We're getting ready to start. </span><span class="line" data-startTime="190">Thank you for coming out for </span><span class="line" data-startTime="190">our performance event tonight. </span><span class="line" data-startTime="192">And thank you for making it the </span><span class="line" data-startTime="192">biggest one we've ever done. </span><span class="line" data-startTime="196">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="201"><span class="speakerName">Pete</span>: So a couple </span><span class="line" data-startTime="201">of things to know. </span> <span class="line" data-startTime="203">The way it's going </span><span class="line" data-startTime="203">to work tonight </span><span class="line" data-startTime="204">is we have three speakers. </span> <span class="line" data-startTime="207">After the speakers, we're </span><span class="line" data-startTime="207">going to have some dinner. </span> <span class="line" data-startTime="209">It's going to be tacos. </span> <span class="line" data-startTime="211">We fought for better food. </span> <span class="line" data-startTime="212">We got you better food. </span> <span class="line" data-startTime="215">After that, Colt </span><span class="line" data-startTime="215">McAnlis from Google </span><span class="line" data-startTime="217">is going to do something </span><span class="line" data-startTime="217">that if you've never </span><span class="line" data-startTime="218">seen someone do before, it's </span><span class="line" data-startTime="218">pretty awesome to watch, which </span><span class="line" data-startTime="221">is dissect sites for </span><span class="line" data-startTime="221">their performance. </span> <span class="line" data-startTime="223">That's going to be great. </span></p>

<p><span class="line" data-startTime="225">The first speaker tonight, </span><span class="line" data-startTime="225">make sure you're all </span><span class="line" data-startTime="227">on the wireless. </span> <span class="line" data-startTime="228">Did everyone see the web page </span><span class="line" data-startTime="228">they were supposed to go to? </span><span class="line" data-startTime="232">Jake will remind you. </span> <span class="line" data-startTime="233">This is going to be </span><span class="line" data-startTime="233">an interactive one. </span> <span class="line" data-startTime="234">So get your phones ready </span><span class="line" data-startTime="234">to connect to that site. </span> <span class="line" data-startTime="237">There's going to be quizzing. </span> <span class="line" data-startTime="238">There's going to be answering. </span> <span class="line" data-startTime="239">There's going to be minds blown, </span><span class="line" data-startTime="239">like, wait, that's a thing? </span><span class="line" data-startTime="243">Then we're going to have Eitan </span><span class="line" data-startTime="243">talking about the "New York </span><span class="line" data-startTime="244">Times." </span><span class="line" data-startTime="245">And we're going to be having </span><span class="line" data-startTime="245">Adam Grossman from Forecast.io </span><span class="line" data-startTime="248">talking about Forecast.io </span><span class="line" data-startTime="248">or Forecast.io? </span></p>

<p class="speaker"><span class="line" data-starttime="250"><span class="speakerName">Adam Grossman</span>: It </span><span class="line" data-startTime="250">is now Forecast.io. </span></p>

<p class="speaker"><span class="line" data-starttime="251"><span class="speakerName">Pete</span>: It's Forecast.io? </span><span class="line" data-startTime="253">ADAM GROSSMAN: </span><span class="line" data-startTime="253">It's just Forecast. </span></p>

<p class="speaker"><span class="line" data-starttime="254"><span class="speakerName">Pete</span>: Just Forecast. </span><span class="line" data-startTime="255">OK. </span><span class="line" data-startTime="255">It's just Forecast. </span><span class="line" data-startTime="256">Sorry. </span><span class="line" data-startTime="257">Which if you haven't looked </span><span class="line" data-startTime="257">at, you really should. </span><span class="line" data-startTime="259">But first, Jake </span><span class="line" data-startTime="259">Archibald from Google </span><span class="line" data-startTime="261">is going to give </span><span class="line" data-startTime="261">his excellent quiz. </span><span class="line" data-startTime="264">One more thing. </span><span class="line" data-startTime="266">Sorry. </span><span class="line" data-startTime="267">Bathrooms are on the </span><span class="line" data-startTime="267">sides if you need to. </span><span class="line" data-startTime="269">And anything else, Chris? </span><span class="line" data-startTime="272">Did I get it? </span><span class="line" data-startTime="273">OK. </span><span class="line" data-startTime="274">Jake Archibald from Google. </span><span class="line" data-startTime="275">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="279"><span class="speakerName">Jake Archibald</span>: So, yeah. </span> <span class="line" data-startTime="280">This is going to be a quiz. </span> <span class="line" data-startTime="282">So if you're not on the Wi-Fi, </span><span class="line" data-startTime="282">get yourself on the Wi-Fi now. </span> <span class="line" data-startTime="286">The username and </span><span class="line" data-startTime="286">password is on there. </span> <span class="line" data-startTime="288">And then once you've done that, </span><span class="line" data-startTime="288">if you want to go to this URL </span><span class="line" data-startTime="290">and make up your own </span><span class="line" data-startTime="290">username and password. </span> <span class="line" data-startTime="294">So obviously not the same </span><span class="line" data-startTime="294">username and password </span><span class="line" data-startTime="296">or a bunch of you will </span><span class="line" data-startTime="296">be on the same account. </span> <span class="line" data-startTime="299">So you won't be able </span><span class="line" data-startTime="299">to get to that URL </span><span class="line" data-startTime="300">if you're not on </span><span class="line" data-startTime="300">that Wi-Fi network. </span></p>

<p><span class="line" data-startTime="302">So make sure you are. </span> <span class="line" data-startTime="303">And if you're watching this </span><span class="line" data-startTime="303">on the live stream, tough luck </span><span class="line" data-startTime="306">I'm afraid. </span> <span class="line" data-startTime="306">You've just got to play </span><span class="line" data-startTime="306">along using your brain. </span> <span class="line" data-startTime="309">And you can write </span><span class="line" data-startTime="309">things down on paper </span><span class="line" data-startTime="311">and score yourself if you want. </span> <span class="line" data-startTime="312">So the reason I'm asking </span><span class="line" data-startTime="312">you for a username </span><span class="line" data-startTime="315">and password is just so you can </span><span class="line" data-startTime="315">switch devices halfway through, </span><span class="line" data-startTime="318">in case one, your phone </span><span class="line" data-startTime="318">starts running out of battery </span><span class="line" data-startTime="321">and you want to </span><span class="line" data-startTime="321">switch to your laptop. </span> <span class="line" data-startTime="323">Just use the same </span><span class="line" data-startTime="323">username and password. </span> <span class="line" data-startTime="324">And everything will work. </span> <span class="line" data-startTime="326">The password is stored in </span><span class="line" data-startTime="326">plain text on my machine. </span> <span class="line" data-startTime="328">So don't use your credit card </span><span class="line" data-startTime="328">number or anything like that </span><span class="line" data-startTime="332">unless you are intending </span><span class="line" data-startTime="332">to make a donation. </span> <span class="line" data-startTime="333">And that will be </span><span class="line" data-startTime="333">gratefully received. </span> <span class="line" data-startTime="335">Thank you very much. </span> <span class="line" data-startTime="337">So I'm going to assume </span><span class="line" data-startTime="337">everyone's ready to go. </span></p>

<p><span class="line" data-startTime="339">I will keep the URL in </span><span class="line" data-startTime="339">the corner of the screen. </span> <span class="line" data-startTime="341">So if anyone loses it, you'll </span><span class="line" data-startTime="341">be able to pick it back up. </span> <span class="line" data-startTime="347">I hacked this </span><span class="line" data-startTime="347">together on a plane. </span> <span class="line" data-startTime="349">You could probably break </span><span class="line" data-startTime="349">it by trying to break it. </span> <span class="line" data-startTime="352">So please, don't </span><span class="line" data-startTime="352">try and break it. </span> <span class="line" data-startTime="354">I've made it so little </span><span class="line" data-startTime="354">Bobby Tables can play. </span> <span class="line" data-startTime="357">That's not going to break it. </span> <span class="line" data-startTime="358">But there are </span><span class="line" data-startTime="358">probably other things. </span> <span class="line" data-startTime="359">You could probably DOS it. </span> <span class="line" data-startTime="360">So please don't do that. </span> <span class="line" data-startTime="362">And I want to stress that </span><span class="line" data-startTime="362">this quiz is pretty tough. </span></p>

<p><span class="line" data-startTime="365">I've seen it get </span><span class="line" data-startTime="365">the better of people </span><span class="line" data-startTime="366">who do this kind of study of </span><span class="line" data-startTime="366">browser quirks for a living. </span> <span class="line" data-startTime="370">So if you're the kind of </span><span class="line" data-startTime="370">person who gets really angry </span><span class="line" data-startTime="372">and starts flipping over </span><span class="line" data-startTime="372">tables when you don't win, </span><span class="line" data-startTime="375">then just maybe stay away from </span><span class="line" data-startTime="375">the tables for a little while. </span> <span class="line" data-startTime="379">OK. </span> <span class="line" data-startTime="380">Of course, what </span><span class="line" data-startTime="380">kind of a quiz would </span><span class="line" data-startTime="382">be complete without a prize? </span><span class="line" data-startTime="384">So the Chromebook Pixel </span><span class="line" data-startTime="384">is Google's latest laptop, </span><span class="line" data-startTime="388">featuring an i5 1.8 </span><span class="line" data-startTime="388">gigahertz dual core </span><span class="line" data-startTime="391">processor, 4 gigabytes of RAM, </span><span class="line" data-startTime="391">and a touchscreen with a higher </span><span class="line" data-startTime="394">DPI than a MacBook Pro. </span> <span class="line" data-startTime="397">Couldn't get hold </span><span class="line" data-startTime="397">of one of those. </span> <span class="line" data-startTime="398">Sorry. </span></p>

<p><span class="line" data-startTime="399">They wouldn't let me. </span> <span class="line" data-startTime="401">But what I did get </span><span class="line" data-startTime="401">is a Chromecast. </span> <span class="line" data-startTime="403">So I've got one of </span><span class="line" data-startTime="403">those to give away </span><span class="line" data-startTime="404">for whoever gets </span><span class="line" data-startTime="404">the highest score. </span> <span class="line" data-startTime="406">So it's not quite a Pixel. </span> <span class="line" data-startTime="407">But it's very, very good. </span> <span class="line" data-startTime="409">So let's start. </span> <span class="line" data-startTime="410">Let's start off really simple. </span> <span class="line" data-startTime="412">And so the URL is there in </span><span class="line" data-startTime="412">the bottom of the screen </span><span class="line" data-startTime="414">if you need it again. </span> <span class="line" data-startTime="415">But here's a nice easy start. </span> <span class="line" data-startTime="417">You've all worked with </span><span class="line" data-startTime="417">images in HTML, right? </span><span class="line" data-startTime="419">OK. </span> <span class="line" data-startTime="420">So here's a DIV. </span> <span class="line" data-startTime="422">But it has a source, </span><span class="line" data-startTime="422">like an image might. </span> <span class="line" data-startTime="424">Which browsers do </span><span class="line" data-startTime="424">you think are going </span><span class="line" data-startTime="425">to make a request </span><span class="line" data-startTime="425">for that image? </span><span class="line" data-startTime="427">Now, on your phones </span><span class="line" data-startTime="427">or on your laptops, </span><span class="line" data-startTime="429">you should be presented </span><span class="line" data-startTime="429">with the option. </span> <span class="line" data-startTime="431">So you pick which ones you think </span><span class="line" data-startTime="431">are going to make a request. </span> <span class="line" data-startTime="433">And then hit submit. </span> <span class="line" data-startTime="434">If it's not appearing </span><span class="line" data-startTime="434">on the screen </span><span class="line" data-startTime="436">or the icons aren't, you </span><span class="line" data-startTime="436">can just give the page </span><span class="line" data-startTime="438">a refresh and that </span><span class="line" data-startTime="438">should come through. </span></p>

<p><span class="line" data-startTime="439">When we're talking </span><span class="line" data-startTime="439">about these browsers, </span><span class="line" data-startTime="441">I mean the latest versions </span><span class="line" data-startTime="441">of each one, so I10, </span><span class="line" data-startTime="443">et cetera, et cetera. </span> <span class="line" data-startTime="445">You get one point if you get it </span><span class="line" data-startTime="445">right for a particular browser. </span> <span class="line" data-startTime="448">You lose a point if you get it </span><span class="line" data-startTime="448">wrong for a particular browser. </span> <span class="line" data-startTime="451">So there's a maximum of </span><span class="line" data-startTime="451">four points per question </span><span class="line" data-startTime="453">and a minimum of minus 4. </span> <span class="line" data-startTime="454">You can score negatively. </span> <span class="line" data-startTime="457">You can assume the </span><span class="line" data-startTime="457">HTML5 doc type. </span> <span class="line" data-startTime="459">And there's nothing </span><span class="line" data-startTime="459">hidden going on. </span> <span class="line" data-startTime="461">I'm not going to turn around </span><span class="line" data-startTime="461">and say, oh, but there's </span><span class="line" data-startTime="463">a base element </span><span class="line" data-startTime="463">that's changing URLs. </span></p>

<p><span class="line" data-startTime="465">There will be none of that. </span> <span class="line" data-startTime="466">It's just what's there on </span><span class="line" data-startTime="466">the screen, that one line. </span> <span class="line" data-startTime="469">So what we're seeing here is </span><span class="line" data-startTime="469">like a live opinion of the room </span><span class="line" data-startTime="471">as well. </span> <span class="line" data-startTime="472">So the needle swings one way </span><span class="line" data-startTime="472">when you're saying collectively </span><span class="line" data-startTime="475">that yes, the browser </span><span class="line" data-startTime="475">will make a request. </span> <span class="line" data-startTime="477">It will swing the other </span><span class="line" data-startTime="477">way if you're saying no. </span> <span class="line" data-startTime="479">But I'm going to </span><span class="line" data-startTime="479">randomize which way </span><span class="line" data-startTime="480">is yes and no for each </span><span class="line" data-startTime="480">question, so you can't just </span><span class="line" data-startTime="483">look at the screen and </span><span class="line" data-startTime="483">vote along with the room. </span> <span class="line" data-startTime="485">OK. </span> <span class="line" data-startTime="485">So that's probably enough time. </span> <span class="line" data-startTime="487">I'm going to close the </span><span class="line" data-startTime="487">question in three, two, one. </span> <span class="line" data-startTime="491">OK. </span> <span class="line" data-startTime="491">So we can see from </span><span class="line" data-startTime="491">this that your result </span><span class="line" data-startTime="493">is saying Chrome is going </span><span class="line" data-startTime="493">to make a request here. </span></p>

<p><span class="line" data-startTime="496">You're less sure about </span><span class="line" data-startTime="496">the other browsers. </span> <span class="line" data-startTime="498">And the answer is no. </span> <span class="line" data-startTime="500">None of the browsers are going </span><span class="line" data-startTime="500">to make a request in this. </span> <span class="line" data-startTime="503">But it's not actually </span><span class="line" data-startTime="503">as mad as it seems. </span> <span class="line" data-startTime="505">So this doesn't work in HTML5. </span> <span class="line" data-startTime="508">But it was proposed in XHTML2. </span> <span class="line" data-startTime="512">So XHTML2 allowed </span><span class="line" data-startTime="512">you to do this, </span><span class="line" data-startTime="515">put a source </span><span class="line" data-startTime="515">attribute on anything. </span> <span class="line" data-startTime="516">And it would replace </span><span class="line" data-startTime="516">the content with what </span><span class="line" data-startTime="518">you had in the source. </span> <span class="line" data-startTime="519">And this was really </span><span class="line" data-startTime="519">good, because it </span><span class="line" data-startTime="521">meant that the old </span><span class="line" data-startTime="521">attribute on images </span><span class="line" data-startTime="523">became redundant </span><span class="line" data-startTime="523">because you could </span><span class="line" data-startTime="524">replace real semantic content. </span> <span class="line" data-startTime="527">A pretty cool idea. </span></p>

<p><span class="line" data-startTime="528">But XHTML2 was </span><span class="line" data-startTime="528">backwards incompatible. </span> <span class="line" data-startTime="530">And it carried with it XML's </span><span class="line" data-startTime="530">draconian era handling. </span> <span class="line" data-startTime="533">And once you invite XML into </span><span class="line" data-startTime="533">your home, it XMLs everything. </span> <span class="line" data-startTime="537">XML is all over the </span><span class="line" data-startTime="537">floor, up the walls. </span> <span class="line" data-startTime="539">And in the same way that Smurfs </span><span class="line" data-startTime="539">stick the word Smurf in front </span><span class="line" data-startTime="542">of everything to make </span><span class="line" data-startTime="542">it a Smurf thing, </span><span class="line" data-startTime="544">XML does it with X. </span> <span class="line" data-startTime="544">You don't want HTML. </span> <span class="line" data-startTime="547">You want XHTML. </span> <span class="line" data-startTime="549">You don't want Frames. </span> <span class="line" data-startTime="550">You want XFrames. </span> <span class="line" data-startTime="552">You don't want Forms. </span> <span class="line" data-startTime="553">You want XForms. </span> <span class="line" data-startTime="557">If you let XML take </span><span class="line" data-startTime="557">over your life, </span><span class="line" data-startTime="558">it will turn your </span><span class="line" data-startTime="558">boyfriend or girlfriend </span><span class="line" data-startTime="560">into an ex-boyfriend </span><span class="line" data-startTime="560">or girlfriend. </span> <span class="line" data-startTime="564">And XML is cool with </span><span class="line" data-startTime="564">that, because you </span><span class="line" data-startTime="565">don't need a partner anymore. </span> <span class="line" data-startTime="567">You've got XML to </span><span class="line" data-startTime="567">look after you. </span></p>

<p><span class="line" data-startTime="569">It seems fitting </span><span class="line" data-startTime="569">that in 2009, XHTML </span><span class="line" data-startTime="571">became an ex-specification. </span> <span class="line" data-startTime="573">And it was completely abandoned. </span> <span class="line" data-startTime="574">And no browsers ever implemented </span><span class="line" data-startTime="574">that source attribute </span><span class="line" data-startTime="577">on elements of images and </span><span class="line" data-startTime="577">the things they work on now. </span> <span class="line" data-startTime="580">OK. </span> <span class="line" data-startTime="581">But what about this? </span><span class="line" data-startTime="582">So here we've got </span><span class="line" data-startTime="582">an image element. </span> <span class="line" data-startTime="584">It's got a source. </span> <span class="line" data-startTime="584">It's in the page. </span> <span class="line" data-startTime="585">But I've spelled </span><span class="line" data-startTime="585">image incorrectly. </span> <span class="line" data-startTime="588">I've put it I-M-A-G-E </span><span class="line" data-startTime="588">rather than I-M-G. </span></p>

<p><span class="line" data-startTime="592">Does the browser treat </span><span class="line" data-startTime="592">it as an unknown element? </span><span class="line" data-startTime="594">Or does it make the request? </span><span class="line" data-startTime="595">The browser only has </span><span class="line" data-startTime="595">to make the request. </span> <span class="line" data-startTime="597">It doesn't have to </span><span class="line" data-startTime="597">display it on the page, </span><span class="line" data-startTime="599">in case you think that matters. </span> <span class="line" data-startTime="600">XML was too strict </span><span class="line" data-startTime="600">to work with the web. </span> <span class="line" data-startTime="602">But is HTML this lenient? </span><span class="line" data-startTime="603">Or are the browsers more </span><span class="line" data-startTime="603">lenient than the spec? </span><span class="line" data-startTime="606">Just get your </span><span class="line" data-startTime="606">answers in quickly. </span> <span class="line" data-startTime="607">I'm going to close the </span><span class="line" data-startTime="607">question in three, two, one. </span> <span class="line" data-startTime="612">And it's closed. </span> <span class="line" data-startTime="614">So we're edging towards </span><span class="line" data-startTime="614">no in all of the browsers. </span> <span class="line" data-startTime="618">All of the browsers will make </span><span class="line" data-startTime="618">a request for this image. </span></p>

<p><span class="line" data-startTime="621">And they will display </span><span class="line" data-startTime="621">it, because, in the past, </span><span class="line" data-startTime="624">a browser decides that IMG is </span><span class="line" data-startTime="624">quite difficult for developers </span><span class="line" data-startTime="628">to remember so they should </span><span class="line" data-startTime="628">support I-M-A-G-E as well. </span> <span class="line" data-startTime="632">And we've been stuck </span><span class="line" data-startTime="632">with it ever since. </span> <span class="line" data-startTime="634">Which browser </span><span class="line" data-startTime="634">engine do you think </span><span class="line" data-startTime="636">we've got to thank for this? </span><span class="line" data-startTime="637">Yep. </span> <span class="line" data-startTime="637">You've guessed it. </span> <span class="line" data-startTime="638">It is Mosaic back in 1993. </span> <span class="line" data-startTime="643">The people who </span><span class="line" data-startTime="643">invented the image tag, </span><span class="line" data-startTime="645">they put this alias in. </span> <span class="line" data-startTime="646">And a study in 2005 </span><span class="line" data-startTime="646">showed that 0.2% of pages </span><span class="line" data-startTime="649">were using this </span><span class="line" data-startTime="649">misspelled image tag. </span> <span class="line" data-startTime="652">So any browser that </span><span class="line" data-startTime="652">wants to work on the web </span><span class="line" data-startTime="654">that we have today has </span><span class="line" data-startTime="654">to duplicate this alias. </span> <span class="line" data-startTime="657">The WHATWG recognized that. </span> <span class="line" data-startTime="658">And they added it to the spec. </span> <span class="line" data-startTime="659">This is the parsing spec. </span></p>

<p><span class="line" data-startTime="660">It was start tag, name image, </span><span class="line" data-startTime="660">change the token to IMG, </span><span class="line" data-startTime="664">and reprocess it. </span> <span class="line" data-startTime="665">Don't ask, which was great. </span> <span class="line" data-startTime="667">But this was actually used </span><span class="line" data-startTime="667">in a clever hack recently. </span> <span class="line" data-startTime="669">Alexi 10 came up with </span><span class="line" data-startTime="669">this, which I really liked. </span> <span class="line" data-startTime="672">You would use this in place </span><span class="line" data-startTime="672">of your image elements. </span> <span class="line" data-startTime="674">What it does is it loads an SVG </span><span class="line" data-startTime="674">for browsers that support SVG. </span> <span class="line" data-startTime="678">And it loads a PNG for </span><span class="line" data-startTime="678">browsers that don't. </span> <span class="line" data-startTime="681">So the way a modern browser </span><span class="line" data-startTime="681">would parse it is it sees SVG. </span> <span class="line" data-startTime="683">And it goes, OK, </span><span class="line" data-startTime="683">it's got a width </span><span class="line" data-startTime="685">and height of 100% </span><span class="line" data-startTime="685">of 100 pixels. </span> <span class="line" data-startTime="688">And it sees this. </span> <span class="line" data-startTime="689">And it sees this as </span><span class="line" data-startTime="689">an SVG image element, </span><span class="line" data-startTime="692">because in SVG, </span><span class="line" data-startTime="692">images are spelled out </span><span class="line" data-startTime="694">full rather than IMG. </span> <span class="line" data-startTime="695">It's got width and height. </span> <span class="line" data-startTime="696">And I'm going to load </span><span class="line" data-startTime="696">this, because this </span><span class="line" data-startTime="698">is how you define the </span><span class="line" data-startTime="698">source of an image in SVG. </span></p>

<p><span class="line" data-startTime="701">Because why have Links </span><span class="line" data-startTime="701">when you could have XLinks? </span><span class="line" data-startTime="706">And then it sees this. </span> <span class="line" data-startTime="707">And that doesn't mean </span><span class="line" data-startTime="707">anything to SVG images. </span> <span class="line" data-startTime="709">So it's ignored. </span> <span class="line" data-startTime="710">So we're now showing </span><span class="line" data-startTime="710">the SVG image. </span> <span class="line" data-startTime="712">An older browser, such as </span><span class="line" data-startTime="712">Android 2 or IE8 and below, </span><span class="line" data-startTime="716">they will parse it like this. </span> <span class="line" data-startTime="718">No idea what that is. </span> <span class="line" data-startTime="719">I'm going to ignore it. </span> <span class="line" data-startTime="720">I'll treat it like </span><span class="line" data-startTime="720">an unknown element. </span> <span class="line" data-startTime="722">Oh, look, the developer </span><span class="line" data-startTime="722">has spelled image wrong. </span> <span class="line" data-startTime="724">It's OK. </span> <span class="line" data-startTime="724">I'm going to </span><span class="line" data-startTime="724">correct it for them. </span> <span class="line" data-startTime="725">It's 100 by 100. </span> <span class="line" data-startTime="728">No idea what that means. </span> <span class="line" data-startTime="730">So I'll ignore that. </span></p>

<p><span class="line" data-startTime="731">And then, oh, there's </span><span class="line" data-startTime="731">the source of the image. </span> <span class="line" data-startTime="733">They're going to </span><span class="line" data-startTime="733">download the PNG. </span> <span class="line" data-startTime="734">So it's kind of nice because </span><span class="line" data-startTime="734">it doesn't require JavaScript. </span> <span class="line" data-startTime="737">And it's a nice way </span><span class="line" data-startTime="737">to conditionally load </span><span class="line" data-startTime="739">the kind of file that </span><span class="line" data-startTime="739">the browser supports. </span> <span class="line" data-startTime="741">We got quite excited about it. </span> <span class="line" data-startTime="742">And we were tweeting about it. </span> <span class="line" data-startTime="744">The mistake we made </span><span class="line" data-startTime="744">is we did not test it. </span> <span class="line" data-startTime="746">So a few of us did just that. </span> <span class="line" data-startTime="748">And we found out </span><span class="line" data-startTime="748">something interesting. </span> <span class="line" data-startTime="750">All of these </span><span class="line" data-startTime="750">browsers support SVG. </span> <span class="line" data-startTime="753">But which browsers will </span><span class="line" data-startTime="753">download the PNG as well? </span><span class="line" data-startTime="755">And I'll give you a clue. </span></p>

<p><span class="line" data-startTime="757">It's not all of them. </span> <span class="line" data-startTime="757">Not all of them get it wrong. </span> <span class="line" data-startTime="759">It's just one or </span><span class="line" data-startTime="759">some of the browsers </span><span class="line" data-startTime="761">that are going to </span><span class="line" data-startTime="761">get this wrong. </span> <span class="line" data-startTime="764">And they'll end up downloading </span><span class="line" data-startTime="764">both, both the PNG and the SVG. </span> <span class="line" data-startTime="768">I'm going to close the </span><span class="line" data-startTime="768">question in three, two, one. </span> <span class="line" data-startTime="773">OK. </span> <span class="line" data-startTime="774">So we're saying no in all </span><span class="line" data-startTime="774">the browsers and yes in IE. </span> <span class="line" data-startTime="776">It's almost like </span><span class="line" data-startTime="776">you've been burned </span><span class="line" data-startTime="778">by that browser in the past. </span> <span class="line" data-startTime="779">Well, the answer </span><span class="line" data-startTime="779">is, you are right. </span></p>

<p><span class="line" data-startTime="783">Internet Explorer will make a </span><span class="line" data-startTime="783">request for two images here. </span> <span class="line" data-startTime="785">And it's because </span><span class="line" data-startTime="785">all modern browsers, </span><span class="line" data-startTime="787">they've got two parsers </span><span class="line" data-startTime="787">built into them. </span> <span class="line" data-startTime="788">It's a relatively new </span><span class="line" data-startTime="788">thing for them to have. </span> <span class="line" data-startTime="790">But they all have it. </span> <span class="line" data-startTime="792">One parser runs ahead. </span> <span class="line" data-startTime="793">And it goes, and it </span><span class="line" data-startTime="793">tries and find things </span><span class="line" data-startTime="795">like it should download, </span><span class="line" data-startTime="795">like scripts and images </span><span class="line" data-startTime="797">and whatever. </span> <span class="line" data-startTime="797">And the other parser comes along </span><span class="line" data-startTime="797">and does the heavy lifting, </span><span class="line" data-startTime="800">like building the DOM </span><span class="line" data-startTime="800">tree, parsing scripts, </span><span class="line" data-startTime="802">et cetera, et cetera. </span></p>

<p><span class="line" data-startTime="804">And this has a </span><span class="line" data-startTime="804">really large benefit. </span> <span class="line" data-startTime="805">A study we did at Google, </span><span class="line" data-startTime="805">we looked at 2,000 sites. </span> <span class="line" data-startTime="808">And we added this preloader. </span> <span class="line" data-startTime="809">And we got a 20% </span><span class="line" data-startTime="809">speed improvement </span><span class="line" data-startTime="811">to get to DOM content loaded. </span> <span class="line" data-startTime="813">So it's really useful. </span> <span class="line" data-startTime="814">But in order to be </span><span class="line" data-startTime="814">quick, this pre-parser </span><span class="line" data-startTime="816">is a little bit stupid. </span> <span class="line" data-startTime="817">And in Internet Explorer, it's </span><span class="line" data-startTime="817">a bit too stupid at the moment. </span> <span class="line" data-startTime="821">It kind of gets over excited. </span> <span class="line" data-startTime="822">It's like, oh, look, I'm </span><span class="line" data-startTime="822">going to show this PNG. </span></p>

<p><span class="line" data-startTime="824">I'm going to show this PNG. </span> <span class="line" data-startTime="826">Here I go. </span> <span class="line" data-startTime="826">Showing the PNG. </span> <span class="line" data-startTime="827">Oh, no. </span> <span class="line" data-startTime="827">Actually, I won't. </span> <span class="line" data-startTime="828">It's actually an SVG. </span> <span class="line" data-startTime="830">I'll do that instead. </span> <span class="line" data-startTime="831">So the main parser </span><span class="line" data-startTime="831">sees the markup. </span> <span class="line" data-startTime="833">And it sees the image. </span> <span class="line" data-startTime="834">But it misses the SVG context. </span> <span class="line" data-startTime="836">And then the main parser </span><span class="line" data-startTime="836">comes along and goes, well, </span><span class="line" data-startTime="838">why am I downloading PNG? </span><span class="line" data-startTime="840">And it cancels that download </span><span class="line" data-startTime="840">and goes for the SVG instead. </span> <span class="line" data-startTime="843">But by that point, it's </span><span class="line" data-startTime="843">made the connection. </span> <span class="line" data-startTime="845">It's probably got all of </span><span class="line" data-startTime="845">the image by that point. </span> <span class="line" data-startTime="848">The moral here is don't </span><span class="line" data-startTime="848">trust performance tips. </span> <span class="line" data-startTime="851">Make sure you test things. </span> <span class="line" data-startTime="853">At Chrome, we say, tools </span><span class="line" data-startTime="853">not rules, which rhymes. </span> <span class="line" data-startTime="856">So I guess it must be true. </span></p>

<p><span class="line" data-startTime="857">But always be on the lookout for </span><span class="line" data-startTime="857">existing data or existing tests </span><span class="line" data-startTime="861">that you can run. </span> <span class="line" data-startTime="863">One of my favorite stories </span><span class="line" data-startTime="863">in science or a tale &mdash; I </span><span class="line" data-startTime="866">don't know how true it is. </span> <span class="line" data-startTime="867">But it involves this </span><span class="line" data-startTime="867">man, August Weismann. </span> <span class="line" data-startTime="869">And he wanted to disprove </span><span class="line" data-startTime="869">that life experience was </span><span class="line" data-startTime="872">part of evolution, like </span><span class="line" data-startTime="872">something that happened </span><span class="line" data-startTime="875">to you during your life would </span><span class="line" data-startTime="875">be passed down as evolution. </span> <span class="line" data-startTime="877">So the way he was going </span><span class="line" data-startTime="877">to disprove this is he </span><span class="line" data-startTime="879">took two mice. </span> <span class="line" data-startTime="880">And he cut their tails off </span><span class="line" data-startTime="880">and bred them together. </span> <span class="line" data-startTime="882">And then he took </span><span class="line" data-startTime="882">the offspring there. </span> <span class="line" data-startTime="884">And he cut their tails off </span><span class="line" data-startTime="884">and bred them together. </span></p>

<p><span class="line" data-startTime="886">And the idea was </span><span class="line" data-startTime="886">we shouldn't end up </span><span class="line" data-startTime="888">with mice being born </span><span class="line" data-startTime="888">without tails, right? </span><span class="line" data-startTime="890">And he was running this </span><span class="line" data-startTime="890">test for quite a while, </span><span class="line" data-startTime="892">until one of his colleagues </span><span class="line" data-startTime="892">pointed out, August, </span><span class="line" data-startTime="894">you do realize that Jewish </span><span class="line" data-startTime="894">people have been inadvertently </span><span class="line" data-startTime="898">carrying out this experiment </span><span class="line" data-startTime="898">a lot longer than you have. </span> <span class="line" data-startTime="901">Oh, yeah. </span> <span class="line" data-startTime="903">So he stopped his test and </span><span class="line" data-startTime="903">just used that as evidence. </span> <span class="line" data-startTime="907">So what about this? </span><span class="line" data-startTime="908">We've got a DIV. </span> <span class="line" data-startTime="909">It's displaying none </span><span class="line" data-startTime="909">as an image inside it. </span> <span class="line" data-startTime="911">So the image won't be displayed. </span> <span class="line" data-startTime="912">But which browsers are </span><span class="line" data-startTime="912">going to download it anyway? </span><span class="line" data-startTime="916">So, yeah, it's not </span><span class="line" data-startTime="916">going to render. </span></p>

<p><span class="line" data-startTime="919">So you could say it's a </span><span class="line" data-startTime="919">waste of bytes to do so. </span> <span class="line" data-startTime="922">Or maybe some browsers are going </span><span class="line" data-startTime="922">to get it just in preparation, </span><span class="line" data-startTime="925">thinking it might be shown. </span> <span class="line" data-startTime="926">I'm going to close the </span><span class="line" data-startTime="926">question in three, two, one. </span> <span class="line" data-startTime="931">So we're leaning towards </span><span class="line" data-startTime="931">yes for every browser. </span> <span class="line" data-startTime="933">We're quite certain it's going </span><span class="line" data-startTime="933">to happen in Internet Explorer. </span> <span class="line" data-startTime="936">The answer. </span> <span class="line" data-startTime="936">Collectively, you are correct. </span> <span class="line" data-startTime="938">Yes, all of the </span><span class="line" data-startTime="938">browsers here are </span><span class="line" data-startTime="939">going to download that image. </span></p>

<p><span class="line" data-startTime="941">And this behavior </span><span class="line" data-startTime="941">is part of the spec. </span> <span class="line" data-startTime="943">So in the browser, in the </span><span class="line" data-startTime="943">beginning, there is nothing. </span> <span class="line" data-startTime="945">And then the browser gets </span><span class="line" data-startTime="945">sprayed with HTML text. </span> <span class="line" data-startTime="948">And it will convert that </span><span class="line" data-startTime="948">text into a tree of elements </span><span class="line" data-startTime="950">that we know as the DOM. </span> <span class="line" data-startTime="953">When this is HTML, when a tag </span><span class="line" data-startTime="953">is turned into an element, </span><span class="line" data-startTime="958">the construction steps </span><span class="line" data-startTime="958">for that element are run. </span> <span class="line" data-startTime="960">And for image, it's really </span><span class="line" data-startTime="960">complicated, actually, </span><span class="line" data-startTime="963">creating an image element. </span> <span class="line" data-startTime="964">But step 14 down </span><span class="line" data-startTime="964">here at the bottom </span><span class="line" data-startTime="966">is where it actually makes the </span><span class="line" data-startTime="966">request and requests the image. </span> <span class="line" data-startTime="969">So visibility doesn't </span><span class="line" data-startTime="969">matter at all. </span> <span class="line" data-startTime="971">It doesn't come into it. </span></p>

<p><span class="line" data-startTime="972">And that's good, because it </span><span class="line" data-startTime="972">means that your images can </span><span class="line" data-startTime="974">download before your </span><span class="line" data-startTime="974">CSS is downloaded, </span><span class="line" data-startTime="976">before your scripts </span><span class="line" data-startTime="976">have downloaded. </span> <span class="line" data-startTime="977">As a downside, it meant that </span><span class="line" data-startTime="977">responsive images, polyfills, </span><span class="line" data-startTime="980">did not work. </span> <span class="line" data-startTime="982">Because by the time your </span><span class="line" data-startTime="982">JavaScript gets to the image, </span><span class="line" data-startTime="985">it's already </span><span class="line" data-startTime="985">started the download </span><span class="line" data-startTime="986">of the thing that </span><span class="line" data-startTime="986">was there already. </span> <span class="line" data-startTime="987">You're just going to </span><span class="line" data-startTime="987">add a second download </span><span class="line" data-startTime="989">by changing the source. </span> <span class="line" data-startTime="991">This won't be a problem in the </span><span class="line" data-startTime="991">future, the resource priority </span><span class="line" data-startTime="994">spec. </span> <span class="line" data-startTime="994">We've specified the </span><span class="line" data-startTime="994">postpone attribute, </span><span class="line" data-startTime="997">which tells an image </span><span class="line" data-startTime="997">that it shouldn't display </span><span class="line" data-startTime="999">if it's displaying </span><span class="line" data-startTime="999">among other things. </span></p>

<p><span class="line" data-startTime="1002">But what if we are using CSS? </span><span class="line" data-startTime="1005">What then? </span><span class="line" data-startTime="1005">So here we've got a DIV </span><span class="line" data-startTime="1005">that's displaying none. </span> <span class="line" data-startTime="1007">And inside, there's a DIV </span><span class="line" data-startTime="1007">with a background image. </span> <span class="line" data-startTime="1010">So it's similar </span><span class="line" data-startTime="1010">to the image one. </span> <span class="line" data-startTime="1012">But we saw that images </span><span class="line" data-startTime="1012">are ignoring CSS. </span> <span class="line" data-startTime="1014">But here we're actually </span><span class="line" data-startTime="1014">in CSS land already. </span> <span class="line" data-startTime="1016">So are there any browsers that </span><span class="line" data-startTime="1016">are going to download that? </span><span class="line" data-startTime="1019">Or are they just </span><span class="line" data-startTime="1019">going to ignore it? </span><span class="line" data-startTime="1021">So once again, it's not </span><span class="line" data-startTime="1021">going to be displayed. </span> <span class="line" data-startTime="1023">So you could consider </span><span class="line" data-startTime="1023">it a waste of bytes. </span> <span class="line" data-startTime="1026">I'm going to close the </span><span class="line" data-startTime="1026">question in three, two, one. </span> <span class="line" data-startTime="1030">So we're edging towards </span><span class="line" data-startTime="1030">yes in every browser. </span> <span class="line" data-startTime="1033">I'm afraid not. </span></p>

<p><span class="line" data-startTime="1034">No browsers are going </span><span class="line" data-startTime="1034">to download it here. </span> <span class="line" data-startTime="1036">Not at all. </span> <span class="line" data-startTime="1036">And I suppose you could </span><span class="line" data-startTime="1036">see that as a good thing. </span> <span class="line" data-startTime="1039">It's saving bytes. </span> <span class="line" data-startTime="1040">But what if we did this? </span><span class="line" data-startTime="1041">Similar question. </span> <span class="line" data-startTime="1042">It's a DIV, displaying none, </span><span class="line" data-startTime="1042">and it has a background image. </span> <span class="line" data-startTime="1046">So the difference </span><span class="line" data-startTime="1046">in the last question </span><span class="line" data-startTime="1048">is it's all on one element. </span> <span class="line" data-startTime="1050">The images isn't inside another </span><span class="line" data-startTime="1050">element that's displaying none. </span> <span class="line" data-startTime="1053">Does that change things? </span><span class="line" data-startTime="1054">Once again, it's not going to </span><span class="line" data-startTime="1054">need that background image. </span> <span class="line" data-startTime="1058">I'm going to close the </span><span class="line" data-startTime="1058">question in three, two, one. </span> <span class="line" data-startTime="1062">So we're edging towards </span><span class="line" data-startTime="1062">yes in every browser, </span><span class="line" data-startTime="1064">a little bit more </span><span class="line" data-startTime="1064">confident in Chrome. </span></p>

<p><span class="line" data-startTime="1067">Most browsers will. </span> <span class="line" data-startTime="1068">Firefox will not. </span> <span class="line" data-startTime="1070">So what's going on here? </span><span class="line" data-startTime="1072">So once the browser has </span><span class="line" data-startTime="1072">this tree of elements, </span><span class="line" data-startTime="1074">it needs to work out </span><span class="line" data-startTime="1074">what they look like </span><span class="line" data-startTime="1076">and where they go on the page. </span> <span class="line" data-startTime="1077">And the first step of this </span><span class="line" data-startTime="1077">is a style calculation. </span> <span class="line" data-startTime="1079">So it calculates all the styles. </span> <span class="line" data-startTime="1081">It goes through the </span><span class="line" data-startTime="1081">CSS cascade, the style </span><span class="line" data-startTime="1082">attributes, the font tags </span><span class="line" data-startTime="1082">if you're from the '90s, </span><span class="line" data-startTime="1085">and works out what style </span><span class="line" data-startTime="1085">applies to each element. </span> <span class="line" data-startTime="1087">But not everything gets </span><span class="line" data-startTime="1087">its style calculated. </span></p>

<p><span class="line" data-startTime="1089">So this DIV up at the top </span><span class="line" data-startTime="1089">turned out to be display none. </span> <span class="line" data-startTime="1092">The browser stops there. </span> <span class="line" data-startTime="1093">It doesn't calculate </span><span class="line" data-startTime="1093">for the children, </span><span class="line" data-startTime="1095">because those elements </span><span class="line" data-startTime="1095">have no impact </span><span class="line" data-startTime="1097">on the rendering of the page. </span> <span class="line" data-startTime="1098">So it shortcuts. </span> <span class="line" data-startTime="1099">So if these elements </span><span class="line" data-startTime="1099">have a background image, </span><span class="line" data-startTime="1101">the browser just never </span><span class="line" data-startTime="1101">finds out about it. </span> <span class="line" data-startTime="1104">This DIV up at the top </span><span class="line" data-startTime="1104">here is displaying none. </span> <span class="line" data-startTime="1106">But it did have its </span><span class="line" data-startTime="1106">style calculated in order </span><span class="line" data-startTime="1108">to find that out. </span> <span class="line" data-startTime="1108">And that's when the browser will </span><span class="line" data-startTime="1108">discover the background image. </span> <span class="line" data-startTime="1111">Firefox is a little bit smarter </span><span class="line" data-startTime="1111">here and avoids the download. </span> <span class="line" data-startTime="1114">But if you change that to </span><span class="line" data-startTime="1114">instead of displaying none, </span><span class="line" data-startTime="1116">you use visibility </span><span class="line" data-startTime="1116">hidden or opacity zero, </span><span class="line" data-startTime="1120">Firefox would download as well. </span></p>

<p><span class="line" data-startTime="1122">Who's getting it right </span><span class="line" data-startTime="1122">according to the specification? </span><span class="line" data-startTime="1125">Everyone is. </span> <span class="line" data-startTime="1126">The spec is really vague here. </span> <span class="line" data-startTime="1128">It says the browser </span><span class="line" data-startTime="1128">may optimize, </span><span class="line" data-startTime="1130">even if the element </span><span class="line" data-startTime="1130">is just obscured. </span> <span class="line" data-startTime="1131">It's underneath another one. </span> <span class="line" data-startTime="1133">But no browsers are that smart. </span> <span class="line" data-startTime="1135">This kind of freedom </span><span class="line" data-startTime="1135">in specifications </span><span class="line" data-startTime="1137">is good, because it </span><span class="line" data-startTime="1137">means the browser can </span><span class="line" data-startTime="1139">do the right thing given the </span><span class="line" data-startTime="1139">device, the connectivity, </span><span class="line" data-startTime="1142">maybe even the battery percent, </span><span class="line" data-startTime="1142">how much battery you've </span><span class="line" data-startTime="1145">got left. </span> <span class="line" data-startTime="1146">But it's also scary, as it </span><span class="line" data-startTime="1146">means the browsers are doing </span><span class="line" data-startTime="1149">different things, as </span><span class="line" data-startTime="1149">they try new stuff </span><span class="line" data-startTime="1150">with that freedom they have. </span></p>

<p><span class="line" data-startTime="1151">But I think that </span><span class="line" data-startTime="1151">kind of diversity </span><span class="line" data-startTime="1153">is what makes the web great. </span> <span class="line" data-startTime="1155">It's not one company driving </span><span class="line" data-startTime="1155">forward with its own interests. </span> <span class="line" data-startTime="1158">It's lots of companies </span><span class="line" data-startTime="1158">driving forward </span><span class="line" data-startTime="1161">in different directions. </span> <span class="line" data-startTime="1162">And we get this car crash </span><span class="line" data-startTime="1162">but with a happy ending. </span> <span class="line" data-startTime="1167">And that's the web </span><span class="line" data-startTime="1167">that we have today. </span> <span class="line" data-startTime="1170">If you want to avoid </span><span class="line" data-startTime="1170">downloading a CSS background, </span><span class="line" data-startTime="1173">hiding the element isn't enough. </span> <span class="line" data-startTime="1174">You need to put it </span><span class="line" data-startTime="1174">inside an element that </span><span class="line" data-startTime="1176">is displaying none. </span> <span class="line" data-startTime="1177">But when you do </span><span class="line" data-startTime="1177">this, you are just </span><span class="line" data-startTime="1178">relying on what </span><span class="line" data-startTime="1178">browsers do today. </span></p>

<p><span class="line" data-startTime="1180">It's not specified behavior. </span> <span class="line" data-startTime="1182">Browsers may change. </span> <span class="line" data-startTime="1183">The only sure-fire way is </span><span class="line" data-startTime="1183">make sure the browser doesn't </span><span class="line" data-startTime="1186">find out about that </span><span class="line" data-startTime="1186">background image. </span> <span class="line" data-startTime="1188">Don't add the class name </span><span class="line" data-startTime="1188">that adds that background </span><span class="line" data-startTime="1190">or don't add the </span><span class="line" data-startTime="1190">element to the DOM </span><span class="line" data-startTime="1192">at all until you really need it. </span> <span class="line" data-startTime="1195">OK. </span> <span class="line" data-startTime="1195">Things have been </span><span class="line" data-startTime="1195">relatively easy so far </span><span class="line" data-startTime="1197">because we weren't </span><span class="line" data-startTime="1197">involving JavaScript. </span></p>

<p><span class="line" data-startTime="1199">So let's get </span><span class="line" data-startTime="1199">JavaScript involved. </span> <span class="line" data-startTime="1201">What about this? </span><span class="line" data-startTime="1201">I'm creating an image. </span> <span class="line" data-startTime="1202">I'm giving it a source. </span> <span class="line" data-startTime="1203">I'm not putting it </span><span class="line" data-startTime="1203">in the document. </span> <span class="line" data-startTime="1205">And I'm spelling </span><span class="line" data-startTime="1205">image incorrectly, </span><span class="line" data-startTime="1207">like we did before. </span> <span class="line" data-startTime="1208">So we saw in HTML that it </span><span class="line" data-startTime="1208">was also correcting I-M-A-G-E </span><span class="line" data-startTime="1213">to I-M-G. But does it </span><span class="line" data-startTime="1213">do the same in the DOM? </span><span class="line" data-startTime="1217">Do images even download when </span><span class="line" data-startTime="1217">they're not in the document? </span><span class="line" data-startTime="1219">Because once again, </span><span class="line" data-startTime="1219">the browser doesn't </span><span class="line" data-startTime="1221">need to render this yet. </span> <span class="line" data-startTime="1223">Or it can't render this yet. </span> <span class="line" data-startTime="1224">I'm going to close the </span><span class="line" data-startTime="1224">question in three, two, one. </span> <span class="line" data-startTime="1229">So this is the point in the </span><span class="line" data-startTime="1229">quiz where the audience just </span><span class="line" data-startTime="1232">gets broken. </span></p>

<p><span class="line" data-startTime="1232">And the needles just drift </span><span class="line" data-startTime="1232">towards the center of I </span><span class="line" data-startTime="1235">don't know what's going on. </span> <span class="line" data-startTime="1237">In this case, most </span><span class="line" data-startTime="1237">browsers will download. </span> <span class="line" data-startTime="1241">Firefox won't. </span> <span class="line" data-startTime="1242">And there are two parts </span><span class="line" data-startTime="1242">of this explanation. </span> <span class="line" data-startTime="1245">As we saw before, </span><span class="line" data-startTime="1245">the DOM gets parsed. </span> <span class="line" data-startTime="1248">And the creation steps </span><span class="line" data-startTime="1248">of the elements are run. </span> <span class="line" data-startTime="1250">This animation took </span><span class="line" data-startTime="1250">me a long time, </span><span class="line" data-startTime="1251">which is why you've seen </span><span class="line" data-startTime="1251">it three times already. </span> <span class="line" data-startTime="1253">But that is the last time. </span> <span class="line" data-startTime="1254">But when an element is </span><span class="line" data-startTime="1254">created using DOM stuff, </span><span class="line" data-startTime="1257">it's still going to </span><span class="line" data-startTime="1257">run the creation steps. </span></p>

<p><span class="line" data-startTime="1259">And we saw for </span><span class="line" data-startTime="1259">images, at step 14, </span><span class="line" data-startTime="1261">that is going to be when </span><span class="line" data-startTime="1261">it downloads the image. </span> <span class="line" data-startTime="1263">We can use this </span><span class="line" data-startTime="1263">to our advantage, </span><span class="line" data-startTime="1265">because this one line, you can </span><span class="line" data-startTime="1265">make a GET request to anything </span><span class="line" data-startTime="1268">that the machine can access. </span> <span class="line" data-startTime="1270">And in fact, images have </span><span class="line" data-startTime="1270">their own DOM constructor, </span><span class="line" data-startTime="1274">unlike a lot of other elements. </span> <span class="line" data-startTime="1275">So that tiny bit of </span><span class="line" data-startTime="1275">code, instant GET </span><span class="line" data-startTime="1277">request to anywhere else. </span> <span class="line" data-startTime="1278">And this is pretty much how </span><span class="line" data-startTime="1278">Google Analytics talks back </span><span class="line" data-startTime="1281">to the server. </span> <span class="line" data-startTime="1282">But we saw before that Firefox </span><span class="line" data-startTime="1282">didn't make the request. </span> <span class="line" data-startTime="1284">So what's going on there? </span><span class="line" data-startTime="1286">When we create this, most </span><span class="line" data-startTime="1286">browsers &mdash; Chrome, Safari, IE &mdash; </span><span class="line" data-startTime="1290">will give us an HTML </span><span class="line" data-startTime="1290">image element back. </span> <span class="line" data-startTime="1292">Whereas Firefox will </span><span class="line" data-startTime="1292">give us an HTML element. </span> <span class="line" data-startTime="1295">It's not an image. </span></p>

<p><span class="line" data-startTime="1296">If you add it to the page, </span><span class="line" data-startTime="1296">it won't display an image. </span> <span class="line" data-startTime="1299">And the interesting </span><span class="line" data-startTime="1299">thing is here, </span><span class="line" data-startTime="1301">it's the only one </span><span class="line" data-startTime="1301">getting it right. </span> <span class="line" data-startTime="1303">We saw before this is </span><span class="line" data-startTime="1303">how the browser that </span><span class="line" data-startTime="1306">had the spec deals with images </span><span class="line" data-startTime="1306">that are spelled incorrectly. </span> <span class="line" data-startTime="1308">But this is in the parsing spec. </span> <span class="line" data-startTime="1311">And we bypassed parsing </span><span class="line" data-startTime="1311">by using create element. </span> <span class="line" data-startTime="1314">We're completely </span><span class="line" data-startTime="1314">bypassing the parser. </span> <span class="line" data-startTime="1317">Well, Firefox gives </span><span class="line" data-startTime="1317">us an HTML element. </span> <span class="line" data-startTime="1320">It should give us an </span><span class="line" data-startTime="1320">HTML unknown element, </span><span class="line" data-startTime="1322">which it does if you </span><span class="line" data-startTime="1322">do create on Fubar. </span></p>

<p><span class="line" data-startTime="1324">So Firefox is doing something </span><span class="line" data-startTime="1324">special for these images. </span> <span class="line" data-startTime="1327">But it's getting it more </span><span class="line" data-startTime="1327">right than other browsers. </span> <span class="line" data-startTime="1329">I think I preferred it when we </span><span class="line" data-startTime="1329">were developing for browsers. </span> <span class="line" data-startTime="1333">It was like there </span><span class="line" data-startTime="1333">was one bad guy. </span> <span class="line" data-startTime="1334">And it was Internet </span><span class="line" data-startTime="1334">Explorer 6 or 7 or 8. </span> <span class="line" data-startTime="1337">And all the other browsers </span><span class="line" data-startTime="1337">seemed perfect in comparison. </span> <span class="line" data-startTime="1339">But I see the browser scape as </span><span class="line" data-startTime="1339">being like an orchestra, where </span><span class="line" data-startTime="1343">Internet Explorer </span><span class="line" data-startTime="1343">8 was just this kid </span><span class="line" data-startTime="1345">hitting two cymbals </span><span class="line" data-startTime="1345">together and screaming. </span> <span class="line" data-startTime="1347">But once we finally kick </span><span class="line" data-startTime="1347">the screaming child out </span><span class="line" data-startTime="1349">of the room, and we come back </span><span class="line" data-startTime="1349">and we start conducting again, </span><span class="line" data-startTime="1352">we realize, oh, </span><span class="line" data-startTime="1352">everyone's actually </span><span class="line" data-startTime="1354">a little bit out of tune. </span> <span class="line" data-startTime="1355">We just didn't realize because </span><span class="line" data-startTime="1355">of the screaming cymbal child </span><span class="line" data-startTime="1358">of Internet Explorer. </span></p>

<p><span class="line" data-startTime="1360">So let's get CSS involved </span><span class="line" data-startTime="1360">again but JavaScript as well. </span> <span class="line" data-startTime="1364">What about this? </span><span class="line" data-startTime="1365">So I'm creating a DIV. </span> <span class="line" data-startTime="1366">Giving it a background. </span> <span class="line" data-startTime="1367">It's not in the document. </span> <span class="line" data-startTime="1368">But everything's </span><span class="line" data-startTime="1368">spelled right and valid. </span> <span class="line" data-startTime="1371">We saw images download </span><span class="line" data-startTime="1371">at this point. </span> <span class="line" data-startTime="1373">But what about when </span><span class="line" data-startTime="1373">CSS is involved? </span><span class="line" data-startTime="1375">Are we going to see </span><span class="line" data-startTime="1375">things download there? </span><span class="line" data-startTime="1377">Get your answers in quickly. </span> <span class="line" data-startTime="1378">I'm going to close the </span><span class="line" data-startTime="1378">question in three, two, one. </span> <span class="line" data-startTime="1384">So once again, the needles </span><span class="line" data-startTime="1384">drift into the middle. </span> <span class="line" data-startTime="1387">The answer here is no. </span></p>

<p><span class="line" data-startTime="1388">No browsers will download here. </span> <span class="line" data-startTime="1390">This is the same as </span><span class="line" data-startTime="1390">the display none case. </span> <span class="line" data-startTime="1393">The browser won't </span><span class="line" data-startTime="1393">calculate the style </span><span class="line" data-startTime="1395">of elements that display none. </span> <span class="line" data-startTime="1396">And it also won't </span><span class="line" data-startTime="1396">calculate the styles </span><span class="line" data-startTime="1398">of elements that aren't in </span><span class="line" data-startTime="1398">the document, because there's </span><span class="line" data-startTime="1399">no point. </span> <span class="line" data-startTime="1400">It doesn't affect the </span><span class="line" data-startTime="1400">rendering of the page at all. </span> <span class="line" data-startTime="1402">OK. </span> <span class="line" data-startTime="1403">I'm going to be cruel now. </span> <span class="line" data-startTime="1405">What about this? </span><span class="line" data-startTime="1406">So same again. </span> <span class="line" data-startTime="1407">I'm adding it to the document. </span> <span class="line" data-startTime="1409">Then I'm removing it again. </span></p>

<p><span class="line" data-startTime="1411">Is it in the document long </span><span class="line" data-startTime="1411">enough for the browser </span><span class="line" data-startTime="1413">to go, oh, I should download </span><span class="line" data-startTime="1413">this background image? </span><span class="line" data-startTime="1416">Or does it not get to </span><span class="line" data-startTime="1416">see it long enough? </span><span class="line" data-startTime="1418">Does it not bother? </span><span class="line" data-startTime="1421">I'm going to close the </span><span class="line" data-startTime="1421">question in three, two, one. </span> <span class="line" data-startTime="1427">OK. </span> <span class="line" data-startTime="1427">So we're suggesting </span><span class="line" data-startTime="1427">yes, because yes, it </span><span class="line" data-startTime="1429">has entered the document. </span> <span class="line" data-startTime="1431">I'm afraid you are all </span><span class="line" data-startTime="1431">wrong with that one, all </span><span class="line" data-startTime="1433">the people who said that. </span></p>

<p><span class="line" data-startTime="1434">The browser doesn't want to </span><span class="line" data-startTime="1434">think about styles or layout </span><span class="line" data-startTime="1436">until the very last moment. </span> <span class="line" data-startTime="1438">And that's normally </span><span class="line" data-startTime="1438">rendering, when it actually </span><span class="line" data-startTime="1440">needs to change </span><span class="line" data-startTime="1440">pixels on the screen. </span> <span class="line" data-startTime="1442">And we can't do </span><span class="line" data-startTime="1442">that or we don't do </span><span class="line" data-startTime="1443">that while we're in the </span><span class="line" data-startTime="1443">middle of JavaScript. </span> <span class="line" data-startTime="1446">So the browser </span><span class="line" data-startTime="1446">actually sits back </span><span class="line" data-startTime="1447">and waits for that </span><span class="line" data-startTime="1447">JavaScript block to execute. </span> <span class="line" data-startTime="1449">And then afterwards, it will </span><span class="line" data-startTime="1449">go and look at what's changed </span><span class="line" data-startTime="1452">and react to that when </span><span class="line" data-startTime="1452">it needs to render next. </span> <span class="line" data-startTime="1455">But does this change that? </span><span class="line" data-startTime="1457">So same code again. </span> <span class="line" data-startTime="1458">But in between adding and </span><span class="line" data-startTime="1458">removing it to the document, </span><span class="line" data-startTime="1460">I'm going to ask for the </span><span class="line" data-startTime="1460">text content of the element. </span> <span class="line" data-startTime="1462">Now, the text content is </span><span class="line" data-startTime="1462">going to be an empty string </span><span class="line" data-startTime="1464">because it is an empty element. </span> <span class="line" data-startTime="1466">But is just accessing </span><span class="line" data-startTime="1466">that property </span><span class="line" data-startTime="1468">going to change things? </span><span class="line" data-startTime="1469">I'm not even assigning </span><span class="line" data-startTime="1469">it to a variable. </span></p>

<p><span class="line" data-startTime="1471">So is it just even going to be </span><span class="line" data-startTime="1471">optimized away by JavaScript </span><span class="line" data-startTime="1474">because it has no impact? </span><span class="line" data-startTime="1476">I'm going to close the </span><span class="line" data-startTime="1476">question in three, two, one. </span> <span class="line" data-startTime="1480">Almost dead in the middle. </span> <span class="line" data-startTime="1481">Excellent. </span> <span class="line" data-startTime="1482">The answer is no. </span> <span class="line" data-startTime="1483">No browsers will make a request. </span> <span class="line" data-startTime="1485">Getting the text </span><span class="line" data-startTime="1485">content is easy. </span> <span class="line" data-startTime="1487">It's just going to go through </span><span class="line" data-startTime="1487">the DOM, find the text nodes, </span><span class="line" data-startTime="1489">and catenate the </span><span class="line" data-startTime="1489">values together. </span> <span class="line" data-startTime="1492">What about this? </span><span class="line" data-startTime="1492">Similar question. </span> <span class="line" data-startTime="1493">But this time, enter HTML </span><span class="line" data-startTime="1493">rather than text content. </span> <span class="line" data-startTime="1495">Once again, it's going to be </span><span class="line" data-startTime="1495">an empty string that comes back </span><span class="line" data-startTime="1498">there, because the </span><span class="line" data-startTime="1498">element is empty. </span> <span class="line" data-startTime="1500">But does it behave </span><span class="line" data-startTime="1500">differently to text content? </span><span class="line" data-startTime="1504">Are the browsers going to </span><span class="line" data-startTime="1504">do something different? </span><span class="line" data-startTime="1506">I'm going to close the </span><span class="line" data-startTime="1506">question in three, two, one. </span></p>

<p><span class="line" data-startTime="1511">So we're saying no here. </span> <span class="line" data-startTime="1514">You're mostly right. </span> <span class="line" data-startTime="1516">Internet Explorer will </span><span class="line" data-startTime="1516">make a download here. </span> <span class="line" data-startTime="1518">And the reason for that is </span><span class="line" data-startTime="1518">because in Internet Explorer &mdash; </span><span class="line" data-startTime="1523">I don't know. </span> <span class="line" data-startTime="1524">I have absolutely no idea. </span> <span class="line" data-startTime="1526">Some things in the world </span><span class="line" data-startTime="1526">cannot be explained. </span> <span class="line" data-startTime="1529">And this is one of them, like </span><span class="line" data-startTime="1529">how it takes three attempts </span><span class="line" data-startTime="1531">to plug in a USB cable, even </span><span class="line" data-startTime="1531">though there are only two </span><span class="line" data-startTime="1534">possibilities. </span> <span class="line" data-startTime="1535">Some things cannot be explained. </span> <span class="line" data-startTime="1538">OK. </span> <span class="line" data-startTime="1539">So on the same theme again </span><span class="line" data-startTime="1539">but this time in a text. </span></p>

<p><span class="line" data-startTime="1542">Once again, like </span><span class="line" data-startTime="1542">the other two, this </span><span class="line" data-startTime="1544">is going to come back as an </span><span class="line" data-startTime="1544">empty string, because it's </span><span class="line" data-startTime="1546">an empty element. </span> <span class="line" data-startTime="1547">But is that going to </span><span class="line" data-startTime="1547">behave differently? </span><span class="line" data-startTime="1548">Is Internet Explorer still going </span><span class="line" data-startTime="1548">to make the request erroneously </span><span class="line" data-startTime="1551">like it did before? </span><span class="line" data-startTime="1552">Is it going to get </span><span class="line" data-startTime="1552">it correct this time? </span><span class="line" data-startTime="1554">Who knows. </span> <span class="line" data-startTime="1555">I'm going to close the </span><span class="line" data-startTime="1555">question in three, two, one. </span> <span class="line" data-startTime="1560">So we're edging towards no. </span> <span class="line" data-startTime="1561">A little bit less sure </span><span class="line" data-startTime="1561">on Internet Explorer. </span> <span class="line" data-startTime="1563">The answer &mdash; yes. </span> <span class="line" data-startTime="1565">Most browsers will </span><span class="line" data-startTime="1565">make a request here. </span> <span class="line" data-startTime="1567">And this actually makes </span><span class="line" data-startTime="1567">sense in an odd way. </span> <span class="line" data-startTime="1571">Let's make a DIV. </span> <span class="line" data-startTime="1572">It's got a background image. </span> <span class="line" data-startTime="1573">And it's got some inner HTMLs. </span> <span class="line" data-startTime="1575">It's got Hello World inside it. </span> <span class="line" data-startTime="1576">But World is inside </span><span class="line" data-startTime="1576">a DIV of its own. </span> <span class="line" data-startTime="1578">We add it to the document. </span></p>

<p><span class="line" data-startTime="1580">We ask for its text content. </span> <span class="line" data-startTime="1581">It's Hello World. </span> <span class="line" data-startTime="1582">But when we ask for the inner </span><span class="line" data-startTime="1582">text in IE, Safari, and Chrome, </span><span class="line" data-startTime="1586">it's going to return this. </span> <span class="line" data-startTime="1587">It's got a line </span><span class="line" data-startTime="1587">break in the middle. </span> <span class="line" data-startTime="1588">And the reason for this is inner </span><span class="line" data-startTime="1588">text isn't just a text content. </span> <span class="line" data-startTime="1592">It's more like </span><span class="line" data-startTime="1592">what you would get </span><span class="line" data-startTime="1593">if you highlighted the </span><span class="line" data-startTime="1593">element and copied it. </span> <span class="line" data-startTime="1596">And because of this, it's </span><span class="line" data-startTime="1596">got style information, </span><span class="line" data-startTime="1599">because the world is </span><span class="line" data-startTime="1599">on a different line, </span><span class="line" data-startTime="1601">because the DIV is block level. </span> <span class="line" data-startTime="1602">Or it is by default. </span> <span class="line" data-startTime="1603">And it is in this case. </span></p>

<p><span class="line" data-startTime="1605">So what actually happens </span><span class="line" data-startTime="1605">here is the browser, </span><span class="line" data-startTime="1608">we asked for the text content. </span> <span class="line" data-startTime="1609">It just gets that back. </span> <span class="line" data-startTime="1610">But when you ask for the inner </span><span class="line" data-startTime="1610">text, the browser has to go, </span><span class="line" data-startTime="1613">ah, I need to know what </span><span class="line" data-startTime="1613">the layout of this element </span><span class="line" data-startTime="1615">is in order to return this. </span> <span class="line" data-startTime="1617">I need to find out if </span><span class="line" data-startTime="1617">that DIV is block level. </span> <span class="line" data-startTime="1619">Where am I going to </span><span class="line" data-startTime="1619">put my line breaks? </span><span class="line" data-startTime="1621">Oh, look. </span> <span class="line" data-startTime="1621">There's a background </span><span class="line" data-startTime="1621">image there. </span> <span class="line" data-startTime="1622">And it downloads it, </span><span class="line" data-startTime="1622">because it forces </span><span class="line" data-startTime="1624">it to look at the styles. </span> <span class="line" data-startTime="1626">Most of the time, </span><span class="line" data-startTime="1626">the browser will </span><span class="line" data-startTime="1627">defer looking at styles </span><span class="line" data-startTime="1627">as late as it can. </span></p>

<p><span class="line" data-startTime="1629">But here we forced it to </span><span class="line" data-startTime="1629">happen sooner because we've </span><span class="line" data-startTime="1631">asked for something </span><span class="line" data-startTime="1631">that's style dependent. </span> <span class="line" data-startTime="1634">Firefox didn't make </span><span class="line" data-startTime="1634">a request because it </span><span class="line" data-startTime="1637">doesn't support inner text. </span> <span class="line" data-startTime="1638">It doesn't support </span><span class="line" data-startTime="1638">the property at all. </span> <span class="line" data-startTime="1640">So that's just undefined. </span> <span class="line" data-startTime="1642">That was quite cruel. </span> <span class="line" data-startTime="1643">But if we used any </span><span class="line" data-startTime="1643">of these properties, </span><span class="line" data-startTime="1646">like offset left, </span><span class="line" data-startTime="1646">offset parent, Firefox </span><span class="line" data-startTime="1651">would have made the </span><span class="line" data-startTime="1651">request as well. </span> <span class="line" data-startTime="1654">So with ignorance of </span><span class="line" data-startTime="1654">those elements that </span><span class="line" data-startTime="1657">will require style </span><span class="line" data-startTime="1657">information, that's </span><span class="line" data-startTime="1660">one of the number one </span><span class="line" data-startTime="1660">problems with performance </span><span class="line" data-startTime="1663">that we see on the web. </span> <span class="line" data-startTime="1664">But also, you can do some </span><span class="line" data-startTime="1664">nice hackery with it. </span> <span class="line" data-startTime="1666">If you look at code like this, </span><span class="line" data-startTime="1666">it looks really expensive. </span> <span class="line" data-startTime="1669">But it's not. </span></p>

<p><span class="line" data-startTime="1669">It's really cheap, because </span><span class="line" data-startTime="1669">the browser is just </span><span class="line" data-startTime="1671">going to sit back and </span><span class="line" data-startTime="1671">watch you just writing </span><span class="line" data-startTime="1673">this property to an object. </span> <span class="line" data-startTime="1675">And it's not going to care </span><span class="line" data-startTime="1675">about it until that block ends. </span> <span class="line" data-startTime="1679">And once that's all done, it </span><span class="line" data-startTime="1679">will just look at the results. </span> <span class="line" data-startTime="1684">And in this case, there's </span><span class="line" data-startTime="1684">no pixel difference. </span> <span class="line" data-startTime="1687">This can lead to some </span><span class="line" data-startTime="1687">unexpected results, not just </span><span class="line" data-startTime="1690">graphical performance. </span> <span class="line" data-startTime="1692">So let's have a look </span><span class="line" data-startTime="1692">at a practical example. </span> <span class="line" data-startTime="1696">Here is Paul Lewis and me. </span></p>

<p><span class="line" data-startTime="1697">We work together. </span> <span class="line" data-startTime="1698">We want to go over there. </span> <span class="line" data-startTime="1700">You can tell because </span><span class="line" data-startTime="1700">we're pointing. </span> <span class="line" data-startTime="1701">But let's do it with code. </span> <span class="line" data-startTime="1703">We're going to say left 0%. </span> <span class="line" data-startTime="1705">We're going to set a </span><span class="line" data-startTime="1705">transition, and then left 100%. </span> <span class="line" data-startTime="1707">If we run that code, off we go. </span> <span class="line" data-startTime="1710">Excellent. </span> <span class="line" data-startTime="1710">We win at code. </span> <span class="line" data-startTime="1712">But if we run that code </span><span class="line" data-startTime="1712">again, nothing happens. </span> <span class="line" data-startTime="1716">And the reason </span><span class="line" data-startTime="1716">nothing happens is </span><span class="line" data-startTime="1717">the browser is going to </span><span class="line" data-startTime="1717">batch up these style changes. </span> <span class="line" data-startTime="1719">So we're saying left twice. </span> <span class="line" data-startTime="1721">But the browser is only going </span><span class="line" data-startTime="1721">to listen to the last one. </span> <span class="line" data-startTime="1724">And we're essentially </span><span class="line" data-startTime="1724">saying, transition to 100%. </span></p>

<p><span class="line" data-startTime="1727">But we're already at 100%. </span> <span class="line" data-startTime="1728">So it doesn't move. </span> <span class="line" data-startTime="1730">You might have </span><span class="line" data-startTime="1730">encountered this and tried </span><span class="line" data-startTime="1732">to fix it with set timeouts and </span><span class="line" data-startTime="1732">an arbitrary number in that. </span> <span class="line" data-startTime="1735">But what you actually want </span><span class="line" data-startTime="1735">to do is at this point, </span><span class="line" data-startTime="1737">just after we set </span><span class="line" data-startTime="1737">the first left, </span><span class="line" data-startTime="1738">you want the browser </span><span class="line" data-startTime="1738">to look at that style </span><span class="line" data-startTime="1741">and actually think about it. </span> <span class="line" data-startTime="1742">And we can actually do that by </span><span class="line" data-startTime="1742">putting one of those properties </span><span class="line" data-startTime="1745">in of set width or whatever. </span></p>

<p><span class="line" data-startTime="1746">And once we do that, we can </span><span class="line" data-startTime="1746">run that code as many times </span><span class="line" data-startTime="1749">as we want. </span> <span class="line" data-startTime="1749">And it will work every time. </span> <span class="line" data-startTime="1751">But you are relying on </span><span class="line" data-startTime="1751">unspecified behavior </span><span class="line" data-startTime="1753">when you do that. </span> <span class="line" data-startTime="1754">The web animation's </span><span class="line" data-startTime="1754">API will save us there. </span> <span class="line" data-startTime="1757">And just before I </span><span class="line" data-startTime="1757">get kicked off stage, </span><span class="line" data-startTime="1759">I want to go through </span><span class="line" data-startTime="1759">the bad side of that. </span> <span class="line" data-startTime="1762">Normally, using things </span><span class="line" data-startTime="1762">like offset width </span><span class="line" data-startTime="1764">in the middle of your code can </span><span class="line" data-startTime="1764">lead to performance difficulty. </span> <span class="line" data-startTime="1767">And here's an example of that. </span> <span class="line" data-startTime="1768">So here I've got a page </span><span class="line" data-startTime="1768">with a load of paragraphs. </span></p>

<p><span class="line" data-startTime="1770">And what I'm going </span><span class="line" data-startTime="1770">to do is I'm going </span><span class="line" data-startTime="1772">to set Chrome's timeline </span><span class="line" data-startTime="1772">recording, which </span><span class="line" data-startTime="1773">is going to record </span><span class="line" data-startTime="1773">everything that's going on, </span><span class="line" data-startTime="1775">resize the screen box, and </span><span class="line" data-startTime="1775">I'm going to hit that button. </span> <span class="line" data-startTime="1777">When I hit that button, </span><span class="line" data-startTime="1777">all of these paragraphs </span><span class="line" data-startTime="1779">are going to become the </span><span class="line" data-startTime="1779">same size as the green box. </span> <span class="line" data-startTime="1782">So we do that. </span> <span class="line" data-startTime="1782">Press the button. </span> <span class="line" data-startTime="1784">And they all change. </span> <span class="line" data-startTime="1785">And that was quite slow. </span> <span class="line" data-startTime="1786">We can see in the timeline, </span><span class="line" data-startTime="1786">there's a little spike there. </span> <span class="line" data-startTime="1789">And if we have a look at the </span><span class="line" data-startTime="1789">number that comes up there, </span><span class="line" data-startTime="1792">it's like 1.27 seconds. </span> <span class="line" data-startTime="1795">It's very slow. </span> <span class="line" data-startTime="1796">But there's this little </span><span class="line" data-startTime="1796">warning icon on there. </span></p>

<p><span class="line" data-startTime="1798">And if we look into that, we </span><span class="line" data-startTime="1798">get a clue of what's going on. </span> <span class="line" data-startTime="1801">We get this Recalculate Style </span><span class="line" data-startTime="1801">Layout, Recalculate Style </span><span class="line" data-startTime="1803">Layout, happening </span><span class="line" data-startTime="1803">over and over again. </span> <span class="line" data-startTime="1805">And that's not looking great. </span> <span class="line" data-startTime="1807">The code we're using </span><span class="line" data-startTime="1807">is really simple. </span> <span class="line" data-startTime="1809">We just loop through </span><span class="line" data-startTime="1809">all of those paragraphs </span><span class="line" data-startTime="1811">and set the offset width of the </span><span class="line" data-startTime="1811">green block to the paragraph. </span> <span class="line" data-startTime="1814">Now, the first time we </span><span class="line" data-startTime="1814">go through this loop, </span><span class="line" data-startTime="1816">we ask the browser, what is </span><span class="line" data-startTime="1816">the size of the green box? </span><span class="line" data-startTime="1818">And it goes, oh, </span><span class="line" data-startTime="1818">I know that answer </span><span class="line" data-startTime="1821">because I've just drawn it. </span></p>

<p><span class="line" data-startTime="1822">Here's your answer. </span> <span class="line" data-startTime="1823">Easy peasy. </span> <span class="line" data-startTime="1824">And then we set the </span><span class="line" data-startTime="1824">width of the paragraph. </span> <span class="line" data-startTime="1826">But the next time we </span><span class="line" data-startTime="1826">come around the loop, </span><span class="line" data-startTime="1827">we ask the browser, what's </span><span class="line" data-startTime="1827">the width of the green box? </span><span class="line" data-startTime="1830">And it's like, I used to know </span><span class="line" data-startTime="1830">the answer to that question. </span> <span class="line" data-startTime="1833">But since then, you've </span><span class="line" data-startTime="1833">been playing around </span><span class="line" data-startTime="1835">with styles on the page. </span> <span class="line" data-startTime="1836">So I need to go away and have a </span><span class="line" data-startTime="1836">think about what you've changed </span><span class="line" data-startTime="1839">and see if it affects the </span><span class="line" data-startTime="1839">width of the green block. </span> <span class="line" data-startTime="1843">And that's going to </span><span class="line" data-startTime="1843">happen on every loop. </span> <span class="line" data-startTime="1844">This is layout frashing. </span> <span class="line" data-startTime="1846">This is interleaving </span><span class="line" data-startTime="1846">style reads and writes. </span></p>

<p><span class="line" data-startTime="1848">And it's a performance killer. </span> <span class="line" data-startTime="1850">What we actually want to </span><span class="line" data-startTime="1850">do is just cache that, </span><span class="line" data-startTime="1852">do the reads first outside the </span><span class="line" data-startTime="1852">loop, get the green box width, </span><span class="line" data-startTime="1855">and then go through the loop. </span> <span class="line" data-startTime="1856">And the difference is </span><span class="line" data-startTime="1856">absolutely astounding. </span> <span class="line" data-startTime="1858">So recording that, changing </span><span class="line" data-startTime="1858">the width of the green box, </span><span class="line" data-startTime="1860">click the button. </span> <span class="line" data-startTime="1861">It just happens instantly. </span> <span class="line" data-startTime="1862">And it's a massive difference. </span> <span class="line" data-startTime="1864">That was like 60 milliseconds </span><span class="line" data-startTime="1864">all in for everything </span><span class="line" data-startTime="1866">versus over a second. </span> <span class="line" data-startTime="1869">So if you need to read something </span><span class="line" data-startTime="1869">that's style dependent, </span><span class="line" data-startTime="1872">do it before you start </span><span class="line" data-startTime="1872">making style changes. </span> <span class="line" data-startTime="1874">Am I out of time? </span><span class="line" data-startTime="1876">Am I done? </span><span class="line" data-startTime="1877">OK. </span></p>

<p><span class="line" data-startTime="1877">But before we do that, we'll </span><span class="line" data-startTime="1877">have a look at the final scores </span><span class="line" data-startTime="1881">and see who managed to </span><span class="line" data-startTime="1881">win the Chromecast if I </span><span class="line" data-startTime="1884">can get the mouse </span><span class="line" data-startTime="1884">pointer over here. </span> <span class="line" data-startTime="1887">Right. </span> <span class="line" data-startTime="1890">A moment of tension. </span> <span class="line" data-startTime="1892">Where's my mouse pointer? </span><span class="line" data-startTime="1894">Let's see if this works. </span> <span class="line" data-startTime="1900">OK. </span> <span class="line" data-startTime="1901">Oh, we've got a draw. </span> <span class="line" data-startTime="1905">We've got one Chromecast. </span> <span class="line" data-startTime="1907">We can get another one. </span> <span class="line" data-startTime="1908">That's excellent. </span> <span class="line" data-startTime="1908">I do have a bonus round. </span> <span class="line" data-startTime="1909">But we're definitely </span><span class="line" data-startTime="1909">out of time. </span> <span class="line" data-startTime="1911">Where are you two people? </span><span class="line" data-startTime="1914">Where are you? </span><span class="line" data-startTime="1916">Oh, one here. </span> <span class="line" data-startTime="1918">And there. </span> <span class="line" data-startTime="1919">Congratulations, guys. </span> <span class="line" data-startTime="1920">A round of applause for </span><span class="line" data-startTime="1920">these guys actually. </span> <span class="line" data-startTime="1922">[APPLAUSE] </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1926"><span class="speakerName">Jake Archibald</span>: And with that, </span><span class="line" data-startTime="1926">I say, thank you very much. </span><span class="line" data-startTime="1929">And I'm going to make </span><span class="line" data-startTime="1929">way for someone else. </span><span class="line" data-startTime="1930">Thank you very much, guys. </span><span class="line" data-startTime="1931">Cheers. </span><span class="line" data-startTime="1933">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="1937"><span class="speakerName">Pete</span>: Thanks, Jake. </span><span class="line" data-startTime="1938">That was great. </span><span class="line" data-startTime="1944">All right. </span><span class="line" data-startTime="1944">And our next speaker is the </span><span class="line" data-startTime="1944">"New York Times'" own Eitan </span><span class="line" data-startTime="1946">Konigsburg. </span><span class="line" data-startTime="1947">He's a front-end architect. </span><span class="line" data-startTime="1948">And he's going to be </span><span class="line" data-startTime="1948">talking about the history </span><span class="line" data-startTime="1950">of performance at the Times. </span><span class="line" data-startTime="1964">Looks good. </span><span class="line" data-startTime="1965">OK. </span></p>

<p class="speaker"><span class="line" data-starttime="1979"><span class="speakerName">Eitan Konigsburg</span>: Hello? </span><span class="line" data-startTime="1981">Hey. </span> <span class="line" data-startTime="1982">So hi, everybody. </span> <span class="line" data-startTime="1983">My name's Eitan Konigsburg. </span> <span class="line" data-startTime="1985">I'm a front-end </span><span class="line" data-startTime="1985">software architect here </span><span class="line" data-startTime="1986">at the "New York Times." </span><span class="line" data-startTime="1988">Today, I'm going to be talking </span><span class="line" data-startTime="1988">about the very real history </span><span class="line" data-startTime="1991">of our web performance efforts </span><span class="line" data-startTime="1991">here at the "New York Times." </span><span class="line" data-startTime="1995">Before I dive in, I </span><span class="line" data-startTime="1995">wanted to share with you </span><span class="line" data-startTime="1997">this tweet by Steve </span><span class="line" data-startTime="1997">Souders himself. </span> <span class="line" data-startTime="1999">If you're not familiar </span><span class="line" data-startTime="1999">with Steve Souders, </span><span class="line" data-startTime="2001">it's the place to </span><span class="line" data-startTime="2001">start when you're </span><span class="line" data-startTime="2002">talking about web performance. </span> <span class="line" data-startTime="2004">He tweeted, "is </span><span class="line" data-startTime="2004">performance of "the Web" </span><span class="line" data-startTime="2006">getting better or worse? </span><span class="line" data-startTime="2007">My past week was painfully </span><span class="line" data-startTime="2007">slow, marred by top sites w/ bad </span><span class="line" data-startTime="2010">#WebPerf. </span></p>

<p><span class="line" data-startTime="2011">Is it too hard?" </span><span class="line" data-startTime="2013">I don't know if the "New York </span><span class="line" data-startTime="2013">Times" was among these sites </span><span class="line" data-startTime="2015">that Steve was </span><span class="line" data-startTime="2015">having trouble with. </span> <span class="line" data-startTime="2017">We've known that we've had a </span><span class="line" data-startTime="2017">little bit of a performance </span><span class="line" data-startTime="2019">problem. </span> <span class="line" data-startTime="2019">I like to think that </span><span class="line" data-startTime="2019">he's checking our site. </span> <span class="line" data-startTime="2022">And he's actually complaining </span><span class="line" data-startTime="2022">for real that our site is slow, </span><span class="line" data-startTime="2025">so that we make it fast for him. </span> <span class="line" data-startTime="2026">But I'm going to get </span><span class="line" data-startTime="2026">back to this question </span><span class="line" data-startTime="2028">about whether it's too hard. </span> <span class="line" data-startTime="2030">So while I was </span><span class="line" data-startTime="2030">preparing for this talk, </span><span class="line" data-startTime="2033">I was thinking that this </span><span class="line" data-startTime="2033">is a very real story. </span> <span class="line" data-startTime="2035">And it reminded me of a </span><span class="line" data-startTime="2035">Geico ad from about 2006 </span><span class="line" data-startTime="2038">that I just wanted </span><span class="line" data-startTime="2038">to share with you. </span> <span class="line" data-startTime="2040">So just give me one sec to play. </span> <span class="line" data-startTime="2044">[VIDEO PLAYBACK] </span><span class="line" data-startTime="2045">-Paula Sala is a real Geico </span><span class="line" data-startTime="2045">customer, not an actor. </span></p>

<p><span class="line" data-startTime="2047">So to help tell her story, </span><span class="line" data-startTime="2047">we hired that announcer guy </span><span class="line" data-startTime="2050">from the movies. </span> <span class="line" data-startTime="2051">-When the storm hit, both our </span><span class="line" data-startTime="2051">cars were totally under water. </span> <span class="line" data-startTime="2055">-In a world where both of our </span><span class="line" data-startTime="2055">cars were totally under water. </span> <span class="line" data-startTime="2059">-We thought it would take </span><span class="line" data-startTime="2059">forever to get some help. </span> <span class="line" data-startTime="2061">-But a new wind </span><span class="line" data-startTime="2061">was about to blow. </span> <span class="line" data-startTime="2065">-With Geico, we had </span><span class="line" data-startTime="2065">our check in two days. </span> <span class="line" data-startTime="2067">-Payback &mdash; this </span><span class="line" data-startTime="2067">time it's for real. </span> <span class="line" data-startTime="2071">-Geico. </span> <span class="line" data-startTime="2072">Real service, real savings. </span> <span class="line" data-startTime="2073">[END VIDEO PLAYBACK] </span></p>

<p class="speaker"><span class="line" data-starttime="2074"><span class="speakerName">Eitan Konigsburg</span>: So I thought </span><span class="line" data-startTime="2074">about doing this entire talk </span><span class="line" data-startTime="2076">in movie announcer voice. </span> <span class="line" data-startTime="2078">I didn't think I'd be able to </span><span class="line" data-startTime="2078">keep it up all the way through. </span> <span class="line" data-startTime="2080">Colt is actually </span><span class="line" data-startTime="2080">the expert at that. </span> <span class="line" data-startTime="2082">So you should check out </span><span class="line" data-startTime="2082">his talk on National Talk </span><span class="line" data-startTime="2085">Like a Pirate Day. </span> <span class="line" data-startTime="2086">That was actually really great. </span> <span class="line" data-startTime="2088">Kudos. </span> <span class="line" data-startTime="2089">So in a world of static </span><span class="line" data-startTime="2089">pages, pages on our website </span><span class="line" data-startTime="2095">are published basically </span><span class="line" data-startTime="2095">like you would a newspaper. </span> <span class="line" data-startTime="2097">Somebody hits a button. </span> <span class="line" data-startTime="2099">And the content goes </span><span class="line" data-startTime="2099">through templates </span><span class="line" data-startTime="2101">and is written to disk. </span></p>

<p><span class="line" data-startTime="2103">And we mix it with a </span><span class="line" data-startTime="2103">proprietary language </span><span class="line" data-startTime="2105">that we compile to give a </span><span class="line" data-startTime="2105">little bit of dynamicism </span><span class="line" data-startTime="2109">on the server side. </span> <span class="line" data-startTime="2110">And it was fast. </span> <span class="line" data-startTime="2112">We have about 1 million of </span><span class="line" data-startTime="2112">these static pages since 2004. </span> <span class="line" data-startTime="2115">And republishing them is </span><span class="line" data-startTime="2115">really not an option for us. </span> <span class="line" data-startTime="2118">If, hypothetically, it </span><span class="line" data-startTime="2118">took about five seconds </span><span class="line" data-startTime="2120">to republish one of these pages, </span><span class="line" data-startTime="2120">5 million seconds, I think, </span><span class="line" data-startTime="2123">comes out to about two months. </span> <span class="line" data-startTime="2125">We can't be doing that </span><span class="line" data-startTime="2125">every time we make a change. </span> <span class="line" data-startTime="2128">So what ends up happening is </span><span class="line" data-startTime="2128">it's extremely hard for us </span><span class="line" data-startTime="2131">to change markup once </span><span class="line" data-startTime="2131">it's been published. </span> <span class="line" data-startTime="2133">And every time we </span><span class="line" data-startTime="2133">make a change, it's </span><span class="line" data-startTime="2136">only present from the </span><span class="line" data-startTime="2136">day we deploy it onward, </span><span class="line" data-startTime="2138">which means we have an </span><span class="line" data-startTime="2138">unknown number of permutations </span><span class="line" data-startTime="2141">of these markups to handle </span><span class="line" data-startTime="2141">and support over time. </span> <span class="line" data-startTime="2144">So our front-end assets, </span><span class="line" data-startTime="2144">our JavaScript and CSS, </span><span class="line" data-startTime="2147">have to handle all of </span><span class="line" data-startTime="2147">these permutations. </span> <span class="line" data-startTime="2150">And in order to be able </span><span class="line" data-startTime="2150">to change these files, </span><span class="line" data-startTime="2152">since we can't change the </span><span class="line" data-startTime="2152">asset path because the HTML is </span><span class="line" data-startTime="2155">static, we have to </span><span class="line" data-startTime="2155">keep the time to live, </span><span class="line" data-startTime="2158">the cache expiration timeout, </span><span class="line" data-startTime="2158">very low on these files, which </span><span class="line" data-startTime="2161">is a performance bad practice. </span></p>

<p><span class="line" data-startTime="2164">And we also don't really </span><span class="line" data-startTime="2164">know what pages on the site </span><span class="line" data-startTime="2167">call which assets in general. </span> <span class="line" data-startTime="2170">So I want to talk </span><span class="line" data-startTime="2170">about our CSS history. </span> <span class="line" data-startTime="2172">We didn't really </span><span class="line" data-startTime="2172">have a CSS framework </span><span class="line" data-startTime="2174">which means we have a </span><span class="line" data-startTime="2174">lot of repetitive styles. </span> <span class="line" data-startTime="2177">Files were imported, </span><span class="line" data-startTime="2177">basically, as needed. </span> <span class="line" data-startTime="2181">Style sheets approached the </span><span class="line" data-startTime="2181">import limits in IE &mdash; 31 total </span><span class="line" data-startTime="2185">and maybe up to three </span><span class="line" data-startTime="2185">nested levels deep. </span> <span class="line" data-startTime="2188">There was inconsistent </span><span class="line" data-startTime="2188">load style. </span> <span class="line" data-startTime="2190">We were using link tags in </span><span class="line" data-startTime="2190">one case, and right after it, </span><span class="line" data-startTime="2192">using a style tag with </span><span class="line" data-startTime="2192">an add import directive. </span> <span class="line" data-startTime="2196">And basically, we </span><span class="line" data-startTime="2196">also have to deal </span><span class="line" data-startTime="2198">with web producers </span><span class="line" data-startTime="2198">who go through. </span> <span class="line" data-startTime="2200">And they're able </span><span class="line" data-startTime="2200">to modify the look </span><span class="line" data-startTime="2202">and feel of our page on the </span><span class="line" data-startTime="2202">fly as the news happens. </span></p>

<p><span class="line" data-startTime="2204">So they can be dropped </span><span class="line" data-startTime="2204">into our content system </span><span class="line" data-startTime="2207">and appear anywhere on the page. </span> <span class="line" data-startTime="2209">In the JavaScript department, </span><span class="line" data-startTime="2209">JavaScript was very ad hoc. </span> <span class="line" data-startTime="2212">Since most of the dynamicism </span><span class="line" data-startTime="2212">was on the server side, </span><span class="line" data-startTime="2215">we basically used </span><span class="line" data-startTime="2215">JS basically as </span><span class="line" data-startTime="2217">needed to fix </span><span class="line" data-startTime="2217">cross-browser issues, </span><span class="line" data-startTime="2219">to do widgets that </span><span class="line" data-startTime="2219">respond to events </span><span class="line" data-startTime="2221">by the user in the browser. </span> <span class="line" data-startTime="2223">Most of the variables </span><span class="line" data-startTime="2223">and functions are global. </span> <span class="line" data-startTime="2226">Script tags are dropped </span><span class="line" data-startTime="2226">wherever they were needed. </span> <span class="line" data-startTime="2228">You would define a new </span><span class="line" data-startTime="2228">DIV, leave it empty, </span><span class="line" data-startTime="2230">and you'd put a script </span><span class="line" data-startTime="2230">tag right after it. </span></p>

<p><span class="line" data-startTime="2232">We didn't defer execution, </span><span class="line" data-startTime="2232">another performance no-no. </span> <span class="line" data-startTime="2235">We didn't have a DOM </span><span class="line" data-startTime="2235">framework to handle </span><span class="line" data-startTime="2237">any cross-browser functionality. </span> <span class="line" data-startTime="2240">That framework war happened. </span> <span class="line" data-startTime="2242">And we still hadn't </span><span class="line" data-startTime="2242">picked one yet. </span> <span class="line" data-startTime="2245">Some words on images. </span> <span class="line" data-startTime="2247">Basically, the UI images </span><span class="line" data-startTime="2247">that are part of a product </span><span class="line" data-startTime="2249">would get uploaded </span><span class="line" data-startTime="2249">individually to production. </span> <span class="line" data-startTime="2252">You could easily forget </span><span class="line" data-startTime="2252">how to do that when </span><span class="line" data-startTime="2255">you were deploying. </span> <span class="line" data-startTime="2256">So they would go missing </span><span class="line" data-startTime="2256">for a little while. </span> <span class="line" data-startTime="2258">Our content photography </span><span class="line" data-startTime="2258">is extremely hard for us </span><span class="line" data-startTime="2261">to optimize. </span> <span class="line" data-startTime="2262">We have a lot of pride </span><span class="line" data-startTime="2262">in our photography. </span> <span class="line" data-startTime="2263">There's a lot of resistance </span><span class="line" data-startTime="2263">in making them smaller </span><span class="line" data-startTime="2265">and not featuring them </span><span class="line" data-startTime="2265">as largely on our pages. </span></p>

<p><span class="line" data-startTime="2269">We did some experiments </span><span class="line" data-startTime="2269">with lossless compression. </span> <span class="line" data-startTime="2272">We actually, for </span><span class="line" data-startTime="2272">color novices, we </span><span class="line" data-startTime="2274">noticed some colors changing </span><span class="line" data-startTime="2274">in whatever these tools were. </span> <span class="line" data-startTime="2278">There's a whole department here </span><span class="line" data-startTime="2278">that does color correction. </span> <span class="line" data-startTime="2280">And the red walls don't </span><span class="line" data-startTime="2280">appear in their area, </span><span class="line" data-startTime="2282">so that they don't have a </span><span class="line" data-startTime="2282">little bit of red dilution </span><span class="line" data-startTime="2285">on their screens to do </span><span class="line" data-startTime="2285">this color correction. </span> <span class="line" data-startTime="2290">It's basically a manual process </span><span class="line" data-startTime="2290">to re-size these images. </span> <span class="line" data-startTime="2293">And we have a lot of them. </span> <span class="line" data-startTime="2294">And in order for them to be </span><span class="line" data-startTime="2294">fast and have them be smaller, </span><span class="line" data-startTime="2297">people have to cut them and make </span><span class="line" data-startTime="2297">sure they don't crop something </span><span class="line" data-startTime="2300">out of the picture. </span></p>

<p><span class="line" data-startTime="2301">Because it's manual, it </span><span class="line" data-startTime="2301">doesn't happen a lot. </span> <span class="line" data-startTime="2303">Other concerns for </span><span class="line" data-startTime="2303">the business, we </span><span class="line" data-startTime="2305">have these editorial </span><span class="line" data-startTime="2305">constraints. </span> <span class="line" data-startTime="2307">Like I mentioned </span><span class="line" data-startTime="2307">earlier, producers </span><span class="line" data-startTime="2309">have a need to adjust based on </span><span class="line" data-startTime="2309">what's happening in the news. </span> <span class="line" data-startTime="2313">So we use this </span><span class="line" data-startTime="2313">free-form module where </span><span class="line" data-startTime="2315">they can drop any </span><span class="line" data-startTime="2315">bit of HTML code. </span> <span class="line" data-startTime="2317">It doesn't even have </span><span class="line" data-startTime="2317">to be balanced tags. </span> <span class="line" data-startTime="2320">So this can easily </span><span class="line" data-startTime="2320">mess up our page. </span> <span class="line" data-startTime="2323">But they have the </span><span class="line" data-startTime="2323">freedom to do that. </span> <span class="line" data-startTime="2324">And we have to be able to handle </span><span class="line" data-startTime="2324">styles and scripts occurring </span><span class="line" data-startTime="2327">in them. </span> <span class="line" data-startTime="2328">And ads, of course, they're </span><span class="line" data-startTime="2328">top-level objects in our DOM. </span></p>

<p><span class="line" data-startTime="2331">They're not treated </span><span class="line" data-startTime="2331">in any special way. </span> <span class="line" data-startTime="2334">They bring their own copies </span><span class="line" data-startTime="2334">of DOM frameworks in. </span> <span class="line" data-startTime="2336">We get older versions of jQuery. </span> <span class="line" data-startTime="2337">We saw an ad that tried to </span><span class="line" data-startTime="2337">encapsulate Prototype &mdash; which </span><span class="line" data-startTime="2342">if you're familiar with </span><span class="line" data-startTime="2342">how Prototype JS works, </span><span class="line" data-startTime="2344">it modifies built-in </span><span class="line" data-startTime="2344">objects in the browser. </span> <span class="line" data-startTime="2346">You can't actually </span><span class="line" data-startTime="2346">contain it in a box. </span> <span class="line" data-startTime="2350">So it didn't really work. </span> <span class="line" data-startTime="2352">Ads animate as </span><span class="line" data-startTime="2352">soon as they load. </span> <span class="line" data-startTime="2354">We get a lot of painting </span><span class="line" data-startTime="2354">issues when animations </span><span class="line" data-startTime="2357">happen while the </span><span class="line" data-startTime="2357">page is loading. </span></p>

<p><span class="line" data-startTime="2359">And basically, they are </span><span class="line" data-startTime="2359">higher in the DOM order </span><span class="line" data-startTime="2363">as the page is loading than </span><span class="line" data-startTime="2363">our own logo on the homepage. </span> <span class="line" data-startTime="2366">You'll see two ads. </span> <span class="line" data-startTime="2367">And then you'll see our logo </span><span class="line" data-startTime="2367">if you look at the source. </span> <span class="line" data-startTime="2369">So just to caveat </span><span class="line" data-startTime="2369">all of this history, </span><span class="line" data-startTime="2371">it wasn't really </span><span class="line" data-startTime="2371">entirely all bad. </span> <span class="line" data-startTime="2373">We do use a CDN. </span> <span class="line" data-startTime="2375">We've had Akamai for </span><span class="line" data-startTime="2375">a number of years. </span> <span class="line" data-startTime="2377">It's been great. </span> <span class="line" data-startTime="2378">We did turn gzip on in 2007. </span> <span class="line" data-startTime="2383">The bandwidth savings </span><span class="line" data-startTime="2383">were actually immediate. </span> <span class="line" data-startTime="2385">And there were a lot </span><span class="line" data-startTime="2385">of really happy people </span><span class="line" data-startTime="2387">as soon as we did that. </span> <span class="line" data-startTime="2388">But it wasn't on previously. </span></p>

<p><span class="line" data-startTime="2389">And it's worth mentioning </span><span class="line" data-startTime="2389">that we did turn it on. </span> <span class="line" data-startTime="2393">So a new wind for </span><span class="line" data-startTime="2393">our efforts and what </span><span class="line" data-startTime="2396">we were trying to do starting </span><span class="line" data-startTime="2396">in 2009 to make the site faster. </span> <span class="line" data-startTime="2399">2009 was the year </span><span class="line" data-startTime="2399">we were focusing </span><span class="line" data-startTime="2400">on tools and libraries. </span> <span class="line" data-startTime="2402">We basically built a new build </span><span class="line" data-startTime="2402">system for front-end files. </span> <span class="line" data-startTime="2405">And this was our first foray </span><span class="line" data-startTime="2405">into doing automatic builds. </span> <span class="line" data-startTime="2408">We used to manually </span><span class="line" data-startTime="2408">untar uncompressed files </span><span class="line" data-startTime="2412">in production. </span> <span class="line" data-startTime="2414">And we were actually pulling </span><span class="line" data-startTime="2414">changes from version control, </span><span class="line" data-startTime="2416">as opposed to somebody's </span><span class="line" data-startTime="2416">home directory. </span></p>

<p><span class="line" data-startTime="2419">They would arrange the files the </span><span class="line" data-startTime="2419">way they wanted them to appear. </span> <span class="line" data-startTime="2421">We would package them up. </span> <span class="line" data-startTime="2422">And someone would </span><span class="line" data-startTime="2422">manually unpackage it. </span> <span class="line" data-startTime="2425">Now, it's coming from </span><span class="line" data-startTime="2425">version control directly. </span> <span class="line" data-startTime="2427">There were </span><span class="line" data-startTime="2427">semi-stateful rollbacks. </span> <span class="line" data-startTime="2429">There was a rollback mechanism. </span> <span class="line" data-startTime="2430">But you could really only </span><span class="line" data-startTime="2430">roll back the latest one. </span> <span class="line" data-startTime="2434">If you tried to roll </span><span class="line" data-startTime="2434">back any before that, </span><span class="line" data-startTime="2436">you'd end up in </span><span class="line" data-startTime="2436">an unknown state. </span></p>

<p><span class="line" data-startTime="2437">And that was really bad. </span> <span class="line" data-startTime="2439">But the really </span><span class="line" data-startTime="2439">exciting bit of it </span><span class="line" data-startTime="2440">was that there were </span><span class="line" data-startTime="2440">hooks for build scripts. </span> <span class="line" data-startTime="2444">And we can expand </span><span class="line" data-startTime="2444">on this process, </span><span class="line" data-startTime="2446">basically, dynamically. </span> <span class="line" data-startTime="2448">So we did just that for our CSS. </span> <span class="line" data-startTime="2450">It was the first system </span><span class="line" data-startTime="2450">to use those new hooks. </span> <span class="line" data-startTime="2452">And we wrote a bunch </span><span class="line" data-startTime="2452">of proprietary scripts </span><span class="line" data-startTime="2454">to not only unravel the ad </span><span class="line" data-startTime="2454">import directives to make </span><span class="line" data-startTime="2457">one concatenated file, we </span><span class="line" data-startTime="2457">wrote a script also trying </span><span class="line" data-startTime="2461">to remove some of the white </span><span class="line" data-startTime="2461">space and the comments. </span> <span class="line" data-startTime="2464">This is all downstream from </span><span class="line" data-startTime="2464">development work, which </span><span class="line" data-startTime="2466">is also a really good point. </span></p>

<p><span class="line" data-startTime="2467">We didn't want our </span><span class="line" data-startTime="2467">developers to feel </span><span class="line" data-startTime="2470">that they couldn't comment </span><span class="line" data-startTime="2470">their work adequately. </span> <span class="line" data-startTime="2473">While we were </span><span class="line" data-startTime="2473">doing this, we were </span><span class="line" data-startTime="2474">working on our CSS framework. </span> <span class="line" data-startTime="2476">We took the concepts </span><span class="line" data-startTime="2476">from our design. </span> <span class="line" data-startTime="2479">And we turned them </span><span class="line" data-startTime="2479">into these base files </span><span class="line" data-startTime="2480">that can be used </span><span class="line" data-startTime="2480">across the site. </span> <span class="line" data-startTime="2482">We split code into </span><span class="line" data-startTime="2482">reusable modules </span><span class="line" data-startTime="2484">and actually tried to </span><span class="line" data-startTime="2484">reuse them in a sane way. </span> <span class="line" data-startTime="2486">We aimed to have a single entry </span><span class="line" data-startTime="2486">point at the top of the page. </span></p>

<p><span class="line" data-startTime="2490">While we were doing </span><span class="line" data-startTime="2490">this, we were also </span><span class="line" data-startTime="2491">trying to lock down </span><span class="line" data-startTime="2491">our JS development. </span> <span class="line" data-startTime="2493">We introduced a </span><span class="line" data-startTime="2493">top-level name space </span><span class="line" data-startTime="2496">called NYTD and </span><span class="line" data-startTime="2496">the module pattern </span><span class="line" data-startTime="2498">also called the Immediately </span><span class="line" data-startTime="2498">Invoked Function Expression. </span> <span class="line" data-startTime="2501">This is a great way to wrap all </span><span class="line" data-startTime="2501">your variables in a closure. </span> <span class="line" data-startTime="2505">Although thanks to Colt, </span><span class="line" data-startTime="2505">I'm now afraid of closures. </span> <span class="line" data-startTime="2510">We introduced Prototype </span><span class="line" data-startTime="2510">JS as a DOM library. </span> <span class="line" data-startTime="2512">This one bullet </span><span class="line" data-startTime="2512">point doesn't really </span><span class="line" data-startTime="2514">reflect the amount of </span><span class="line" data-startTime="2514">meetings and discussions </span><span class="line" data-startTime="2516">and debates and fights we </span><span class="line" data-startTime="2516">had over this decision. </span> <span class="line" data-startTime="2519">But Prototype JS </span><span class="line" data-startTime="2519">won out in the end. </span> <span class="line" data-startTime="2522">We also tried to write our </span><span class="line" data-startTime="2522">own proprietary asynchronous </span><span class="line" data-startTime="2524">JavaScript loader in the </span><span class="line" data-startTime="2524">days before RequireJS. </span></p>

<p><span class="line" data-startTime="2528">Any of these, LabJS, </span><span class="line" data-startTime="2528">any of these loaders, </span><span class="line" data-startTime="2530">they didn't exist. </span> <span class="line" data-startTime="2531">We tried to write our own. </span> <span class="line" data-startTime="2532">It didn't really work. </span> <span class="line" data-startTime="2533">It became a synchronous </span><span class="line" data-startTime="2533">JavaScript loader. </span> <span class="line" data-startTime="2537">So we started with </span><span class="line" data-startTime="2537">our home page. </span> <span class="line" data-startTime="2538">And there's a number </span><span class="line" data-startTime="2538">of reasons why. </span> <span class="line" data-startTime="2540">It's published very frequently. </span> <span class="line" data-startTime="2541">So this problem </span><span class="line" data-startTime="2541">with legacy markup </span><span class="line" data-startTime="2543">really doesn't become an issue. </span> <span class="line" data-startTime="2545">It gets the most traffic. </span> <span class="line" data-startTime="2546">So it has the potential to save </span><span class="line" data-startTime="2546">people the most amount of time. </span> <span class="line" data-startTime="2549">It has an isolated </span><span class="line" data-startTime="2549">implementation. </span> <span class="line" data-startTime="2551">And basically, if </span><span class="line" data-startTime="2551">something went wrong, </span><span class="line" data-startTime="2553">nothing would go wrong on </span><span class="line" data-startTime="2553">other parts of the site. </span></p>

<p><span class="line" data-startTime="2556">And it's viewed very </span><span class="line" data-startTime="2556">heavily internally. </span> <span class="line" data-startTime="2557">If something were really </span><span class="line" data-startTime="2557">bad, it would get noticed </span><span class="line" data-startTime="2559">before it got out </span><span class="line" data-startTime="2559">into production. </span> <span class="line" data-startTime="2562">So in November 2009, we </span><span class="line" data-startTime="2562">put our CSS optimizations </span><span class="line" data-startTime="2565">on the home page. </span> <span class="line" data-startTime="2566">It saved 25 HTTP connections to </span><span class="line" data-startTime="2566">what our very small CSS files. </span> <span class="line" data-startTime="2571">The first pane occurred </span><span class="line" data-startTime="2571">a whole second earlier. </span> <span class="line" data-startTime="2573">And the homepage </span><span class="line" data-startTime="2573">really felt faster. </span> <span class="line" data-startTime="2575">And we were very happy by this. </span> <span class="line" data-startTime="2577">So in 2010, we wanted to </span><span class="line" data-startTime="2577">continue these efforts. </span> <span class="line" data-startTime="2581">The CSS framework </span><span class="line" data-startTime="2581">basically rolled out </span><span class="line" data-startTime="2583">to our section </span><span class="line" data-startTime="2583">and article pages. </span> <span class="line" data-startTime="2585">Again, we were focusing </span><span class="line" data-startTime="2585">on the single entry point. </span> <span class="line" data-startTime="2587">But we never optimized them. </span> <span class="line" data-startTime="2590">There were some concerns with </span><span class="line" data-startTime="2590">these proprietary scripts. </span> <span class="line" data-startTime="2592">And it turns out later </span><span class="line" data-startTime="2592">when we did an audit </span><span class="line" data-startTime="2594">that we were right </span><span class="line" data-startTime="2594">to be concerned. </span> <span class="line" data-startTime="2596">There were references </span><span class="line" data-startTime="2596">to missing files. </span></p>

<p><span class="line" data-startTime="2598">There were ad import cycles. </span> <span class="line" data-startTime="2599">A would include B, </span><span class="line" data-startTime="2599">include C, include A. </span> <span class="line" data-startTime="2601">And if you're ever curious </span><span class="line" data-startTime="2601">about what the browser does </span><span class="line" data-startTime="2603">to get out of that, I still </span><span class="line" data-startTime="2603">don't know the answer. </span> <span class="line" data-startTime="2607">And there were syntax </span><span class="line" data-startTime="2607">errors that there </span><span class="line" data-startTime="2608">were styles not getting </span><span class="line" data-startTime="2608">applied because they </span><span class="line" data-startTime="2610">were typed improperly. </span> <span class="line" data-startTime="2612">So we decided to build a </span><span class="line" data-startTime="2612">new JS build system in 2010. </span> <span class="line" data-startTime="2616">We forked the codebase. </span> <span class="line" data-startTime="2617">We wanted to create </span><span class="line" data-startTime="2617">a clean build. </span> <span class="line" data-startTime="2619">And only code that was </span><span class="line" data-startTime="2619">modular and name spaced </span><span class="line" data-startTime="2623">would be able to </span><span class="line" data-startTime="2623">be in this build. </span> <span class="line" data-startTime="2625">Basically, we had these </span><span class="line" data-startTime="2625">manifests of files that had </span><span class="line" data-startTime="2628">an @import-like syntax </span><span class="line" data-startTime="2628">in a JS comment, </span><span class="line" data-startTime="2631">so that they would be inert </span><span class="line" data-startTime="2631">if the build process failed. </span> <span class="line" data-startTime="2636">We used YUI compressor </span><span class="line" data-startTime="2636">for minification. </span> <span class="line" data-startTime="2638">We no longer wanted to </span><span class="line" data-startTime="2638">write our own scripts. </span></p>

<p><span class="line" data-startTime="2640">This was well </span><span class="line" data-startTime="2640">supported at the time. </span> <span class="line" data-startTime="2641">So why not? </span><span class="line" data-startTime="2642">We were focusing </span><span class="line" data-startTime="2642">on two build files, </span><span class="line" data-startTime="2644">one at the top, </span><span class="line" data-startTime="2644">one at the bottom. </span> <span class="line" data-startTime="2646">If you're familiar with </span><span class="line" data-startTime="2646">the best practices, </span><span class="line" data-startTime="2648">they say that you're </span><span class="line" data-startTime="2648">supposed to put </span><span class="line" data-startTime="2650">your JS at the </span><span class="line" data-startTime="2650">bottom of the page. </span> <span class="line" data-startTime="2651">So why did we have </span><span class="line" data-startTime="2651">them at the top? </span><span class="line" data-startTime="2653">If you remember that editors </span><span class="line" data-startTime="2653">can put JavaScript on the page, </span><span class="line" data-startTime="2656">if we wanted them to </span><span class="line" data-startTime="2656">use our frameworks, </span><span class="line" data-startTime="2658">it had to be there before they </span><span class="line" data-startTime="2658">could actually run their code. </span></p>

<p><span class="line" data-startTime="2661">So we put stuff at </span><span class="line" data-startTime="2661">the top to make sure </span><span class="line" data-startTime="2662">that that wouldn't </span><span class="line" data-startTime="2662">break anything. </span> <span class="line" data-startTime="2664">This build process </span><span class="line" data-startTime="2664">was executed manually. </span> <span class="line" data-startTime="2666">So it didn't see </span><span class="line" data-startTime="2666">widespread usage. </span> <span class="line" data-startTime="2668">It's basically almost done </span><span class="line" data-startTime="2668">only on the home page. </span> <span class="line" data-startTime="2671">And now, we have two codebases </span><span class="line" data-startTime="2671">and still no automatic </span><span class="line" data-startTime="2673">build process. </span> <span class="line" data-startTime="2675">But when we did launch these </span><span class="line" data-startTime="2675">JS changes to the homepage, </span><span class="line" data-startTime="2677">it was pretty drastic. </span> <span class="line" data-startTime="2678">We got a 50% speedup, 6 </span><span class="line" data-startTime="2678">seconds, down from 12. </span> <span class="line" data-startTime="2682">We were very excited by that. </span> <span class="line" data-startTime="2684">So 2011 was a bit </span><span class="line" data-startTime="2684">of a slow year. </span> <span class="line" data-startTime="2687">As you might remember, if you're </span><span class="line" data-startTime="2687">fans of the "New York Times," </span><span class="line" data-startTime="2689">we introduced digital </span><span class="line" data-startTime="2689">subscriptions in 2011. </span> <span class="line" data-startTime="2693">So resourcing for </span><span class="line" data-startTime="2693">this kind of work </span><span class="line" data-startTime="2694">was really hard to come by. </span> <span class="line" data-startTime="2696">Oh, hello. </span> <span class="line" data-startTime="2697">I don't know what I just did. </span> <span class="line" data-startTime="2699">All right. </span></p>

<p><span class="line" data-startTime="2701">There were efforts to optimize </span><span class="line" data-startTime="2701">our analytics packaging. </span> <span class="line" data-startTime="2706">We have a lot of </span><span class="line" data-startTime="2706">analytics packages. </span> <span class="line" data-startTime="2707">And they were doing </span><span class="line" data-startTime="2707">some really bad stuff. </span> <span class="line" data-startTime="2709">They got aborted </span><span class="line" data-startTime="2709">mostly because we </span><span class="line" data-startTime="2711">were afraid to break </span><span class="line" data-startTime="2711">these actual reports. </span> <span class="line" data-startTime="2714">We wanted to make sure </span><span class="line" data-startTime="2714">that the business was </span><span class="line" data-startTime="2716">able to analyze </span><span class="line" data-startTime="2716">things correctly. </span> <span class="line" data-startTime="2718">So we didn't continue that. </span> <span class="line" data-startTime="2719">So we used a series of code </span><span class="line" data-startTime="2719">reviews and style guides </span><span class="line" data-startTime="2722">to make sure that </span><span class="line" data-startTime="2722">we were enforcing </span><span class="line" data-startTime="2724">good standards </span><span class="line" data-startTime="2724">and best practices </span><span class="line" data-startTime="2725">to keep the status quo. </span></p>

<p><span class="line" data-startTime="2727">But at the end of 2011, </span><span class="line" data-startTime="2727">we made the decision. </span> <span class="line" data-startTime="2731">We decided to </span><span class="line" data-startTime="2731">replace PrototypeJS </span><span class="line" data-startTime="2732">with jQuery sitewide. </span> <span class="line" data-startTime="2734">And as you can imagine, </span><span class="line" data-startTime="2734">this is really, really hard. </span> <span class="line" data-startTime="2739">We needed both of them to </span><span class="line" data-startTime="2739">coexist during the transition. </span> <span class="line" data-startTime="2741">We weren't going to rewrite </span><span class="line" data-startTime="2741">everything and launch </span><span class="line" data-startTime="2743">a new site on a new </span><span class="line" data-startTime="2743">framework all at once. </span> <span class="line" data-startTime="2745">So we needed both of </span><span class="line" data-startTime="2745">them to, basically, </span><span class="line" data-startTime="2747">be around while we did this. </span> <span class="line" data-startTime="2749">But in 2012, a group </span><span class="line" data-startTime="2749">of five developers </span><span class="line" data-startTime="2752">basically set out </span><span class="line" data-startTime="2752">to try and excise </span><span class="line" data-startTime="2754">PrototypeJS from article pages. </span> <span class="line" data-startTime="2757">And we were making really, </span><span class="line" data-startTime="2757">really excellent progress. </span> <span class="line" data-startTime="2759">Things were going great, </span><span class="line" data-startTime="2759">hours and hours of work. </span> <span class="line" data-startTime="2761">And then we found out there </span><span class="line" data-startTime="2761">were some inline scripts that </span><span class="line" data-startTime="2764">made references to PrototypeJS. </span></p>

<p><span class="line" data-startTime="2767">And if you remember that we have </span><span class="line" data-startTime="2767">these static pages with markup </span><span class="line" data-startTime="2770">that we can't change, </span><span class="line" data-startTime="2770">we really have no idea </span><span class="line" data-startTime="2772">what's calling PrototypeJS </span><span class="line" data-startTime="2772">and inline scripts. </span> <span class="line" data-startTime="2775">And so, therefore, </span><span class="line" data-startTime="2775">we're not ever </span><span class="line" data-startTime="2776">able to remove PrototypeJS </span><span class="line" data-startTime="2776">fully from our site. </span> <span class="line" data-startTime="2779">So now we have two frameworks. </span> <span class="line" data-startTime="2781">They both download. </span> <span class="line" data-startTime="2782">They're both still in use. </span> <span class="line" data-startTime="2783">And this actually causes </span><span class="line" data-startTime="2783">some really strange bugs. </span> <span class="line" data-startTime="2786">In older IE, where you </span><span class="line" data-startTime="2786">don't have a get elements </span><span class="line" data-startTime="2789">by class name, </span><span class="line" data-startTime="2789">PrototypeJS would add one. </span> <span class="line" data-startTime="2792">And jQuery will </span><span class="line" data-startTime="2792">detect it and use it. </span> <span class="line" data-startTime="2795">It returns Prototype objects. </span> <span class="line" data-startTime="2796">And jQuery says, I have no </span><span class="line" data-startTime="2796">idea what these are, and bails. </span> <span class="line" data-startTime="2801">So 2012 also marked the end </span><span class="line" data-startTime="2801">of life for this proprietary </span><span class="line" data-startTime="2805">build system. </span></p>

<p><span class="line" data-startTime="2806">We basically </span><span class="line" data-startTime="2806">migrated to a system </span><span class="line" data-startTime="2808">that mirrored our entire </span><span class="line" data-startTime="2808">SVN repositories via Hudson. </span> <span class="line" data-startTime="2811">We wrote a new script to </span><span class="line" data-startTime="2811">concatenate the CSS imports. </span> <span class="line" data-startTime="2815">We needed feature parity </span><span class="line" data-startTime="2815">with what we had before. </span> <span class="line" data-startTime="2817">So we had to write </span><span class="line" data-startTime="2817">something new to make sure </span><span class="line" data-startTime="2819">that we could handle it for the </span><span class="line" data-startTime="2819">homepage, which already had it. </span> <span class="line" data-startTime="2822">It does have all these features. </span> <span class="line" data-startTime="2824">Although CSSLint is </span><span class="line" data-startTime="2824">added on the list </span><span class="line" data-startTime="2826">to catch syntax errors that </span><span class="line" data-startTime="2826">didn't exist until 2012, </span><span class="line" data-startTime="2830">I believe. </span> <span class="line" data-startTime="2831">It uses YUI compressor </span><span class="line" data-startTime="2831">to do minification </span><span class="line" data-startTime="2833">and also has to be run manually. </span></p>

<p><span class="line" data-startTime="2835">So again, it's really just </span><span class="line" data-startTime="2835">limited to the home page. </span> <span class="line" data-startTime="2839">So finally, I'm going to </span><span class="line" data-startTime="2839">talk a bit about some efforts </span><span class="line" data-startTime="2843">in modern times of </span><span class="line" data-startTime="2843">what we're trying </span><span class="line" data-startTime="2844">to do to really </span><span class="line" data-startTime="2844">fix this problem. </span> <span class="line" data-startTime="2846">So we were really gifted </span><span class="line" data-startTime="2846">a very rare opportunity </span><span class="line" data-startTime="2849">by the business. </span> <span class="line" data-startTime="2850">In March 2013, the </span><span class="line" data-startTime="2850">"New York Times" </span><span class="line" data-startTime="2852">announced that it was going </span><span class="line" data-startTime="2852">to introduce a new article </span><span class="line" data-startTime="2855">redesign. </span> <span class="line" data-startTime="2856">And for us, it's more than </span><span class="line" data-startTime="2856">just a new user interface, </span><span class="line" data-startTime="2859">a new user experience. </span> <span class="line" data-startTime="2861">It's really a </span><span class="line" data-startTime="2861">technological reboot. </span> <span class="line" data-startTime="2862">We've changed everything </span><span class="line" data-startTime="2862">about our systems </span><span class="line" data-startTime="2864">in order to deal with some </span><span class="line" data-startTime="2864">of these legacy issues </span><span class="line" data-startTime="2867">that we've had. </span> <span class="line" data-startTime="2868">So the best thing &mdash; and I have </span><span class="line" data-startTime="2868">an exclamation point here, </span><span class="line" data-startTime="2871">and it really doesn't </span><span class="line" data-startTime="2871">represent our excitement </span><span class="line" data-startTime="2872">by this &mdash; we have </span><span class="line" data-startTime="2872">dynamic pages now. </span></p>

<p><span class="line" data-startTime="2875">We no longer have to deal </span><span class="line" data-startTime="2875">with an unknown number </span><span class="line" data-startTime="2877">of permutations. </span> <span class="line" data-startTime="2878">We can actually </span><span class="line" data-startTime="2878">change our asset URLs </span><span class="line" data-startTime="2880">on the fly to bypass the cache </span><span class="line" data-startTime="2880">as soon as we do a deploy. </span> <span class="line" data-startTime="2883">We pushed a lot of </span><span class="line" data-startTime="2883">the user customization </span><span class="line" data-startTime="2885">into the client side. </span> <span class="line" data-startTime="2887">We're not doing </span><span class="line" data-startTime="2887">it on the server. </span> <span class="line" data-startTime="2888">So we can actually cache our </span><span class="line" data-startTime="2888">pages better on the back end. </span> <span class="line" data-startTime="2891">We introduced HTML5 </span><span class="line" data-startTime="2891">Boilerplate and Modernizr </span><span class="line" data-startTime="2894">to give us a nice starting </span><span class="line" data-startTime="2894">point for these new pages. </span></p>

<p><span class="line" data-startTime="2897">So now, we have a modern </span><span class="line" data-startTime="2897">build system using Grunt. </span> <span class="line" data-startTime="2900">It can be run both in </span><span class="line" data-startTime="2900">our Developer Sandboxes </span><span class="line" data-startTime="2902">and in Hudson to </span><span class="line" data-startTime="2902">prepare a build. </span> <span class="line" data-startTime="2905">And most of these </span><span class="line" data-startTime="2905">web performance </span><span class="line" data-startTime="2906">best practices are actually </span><span class="line" data-startTime="2906">available as Grunt tasks </span><span class="line" data-startTime="2908">already, which </span><span class="line" data-startTime="2908">made it really easy </span><span class="line" data-startTime="2910">to integrate some of this </span><span class="line" data-startTime="2910">great advice for our code. </span> <span class="line" data-startTime="2914">And we're using RPM </span><span class="line" data-startTime="2914">packaging for deployments. </span> <span class="line" data-startTime="2918">They have very great </span><span class="line" data-startTime="2918">rollback support. </span></p>

<p><span class="line" data-startTime="2920">And they're really easy to use. </span> <span class="line" data-startTime="2924">So for style development, </span><span class="line" data-startTime="2924">we switched to using LESS. </span> <span class="line" data-startTime="2927">LESS itself handles </span><span class="line" data-startTime="2927">concatenation. </span> <span class="line" data-startTime="2929">Minification is supported </span><span class="line" data-startTime="2929">by a YUI compressor </span><span class="line" data-startTime="2932">through the Grunt task. </span> <span class="line" data-startTime="2933">So this is really easy </span><span class="line" data-startTime="2933">to get these two wins. </span> <span class="line" data-startTime="2936">Variables and mix-ins allow us </span><span class="line" data-startTime="2936">to do some really interesting </span><span class="line" data-startTime="2938">things in CSS that we had to </span><span class="line" data-startTime="2938">do with images before &mdash; arrows, </span><span class="line" data-startTime="2942">buttons, data </span><span class="line" data-startTime="2942">URIs, and spriting. </span> <span class="line" data-startTime="2946">So earlier this year, </span><span class="line" data-startTime="2946">I wrote a Grunt task </span><span class="line" data-startTime="2947">that automates the </span><span class="line" data-startTime="2947">creation of spritesheets. </span></p>

<p><span class="line" data-startTime="2950">I don't really know </span><span class="line" data-startTime="2950">what the diction </span><span class="line" data-startTime="2953">is around sprites </span><span class="line" data-startTime="2953">and spritesheets. </span> <span class="line" data-startTime="2956">I don't know. </span> <span class="line" data-startTime="2956">What do you call the individual </span><span class="line" data-startTime="2956">images on a spritesheet? </span><span class="line" data-startTime="2959">I have no idea. </span> <span class="line" data-startTime="2960">So I'm making up </span><span class="line" data-startTime="2960">the terminology. </span> <span class="line" data-startTime="2963">Basically, the task takes in </span><span class="line" data-startTime="2963">a bunch of images and exports </span><span class="line" data-startTime="2966">not only the combined </span><span class="line" data-startTime="2966">spritesheet but also </span><span class="line" data-startTime="2969">a bunch of mix-ins in LESS with </span><span class="line" data-startTime="2969">the background coordinates, </span><span class="line" data-startTime="2971">which makes it not </span><span class="line" data-startTime="2971">only really easy </span><span class="line" data-startTime="2973">to make these </span><span class="line" data-startTime="2973">combined images, you </span><span class="line" data-startTime="2974">don't have to maintain </span><span class="line" data-startTime="2974">them manually. </span> <span class="line" data-startTime="2975">It's really easy for developers </span><span class="line" data-startTime="2975">to use them in the code. </span> <span class="line" data-startTime="2978">The mix-ins are named </span><span class="line" data-startTime="2978">after the image itself. </span> <span class="line" data-startTime="2980">So you just put the image </span><span class="line" data-startTime="2980">name, and you basically </span><span class="line" data-startTime="2982">get the sprite. </span></p>

<p><span class="line" data-startTime="2984">And the best part about it </span><span class="line" data-startTime="2984">is if the coordinates change </span><span class="line" data-startTime="2986">because we've added a new </span><span class="line" data-startTime="2986">image, and if it's alphabetical, </span><span class="line" data-startTime="2989">and you added a C, all the </span><span class="line" data-startTime="2989">images shift a little bit. </span> <span class="line" data-startTime="2993">All you have to do is </span><span class="line" data-startTime="2993">rebuild the system. </span> <span class="line" data-startTime="2994">And all the coordinates </span><span class="line" data-startTime="2994">are updated. </span> <span class="line" data-startTime="2996">Nobody has to go in and actually </span><span class="line" data-startTime="2996">figure something out and change </span><span class="line" data-startTime="2998">anything. </span> <span class="line" data-startTime="2999">And we're currently combining </span><span class="line" data-startTime="2999">I think over 100 small images </span><span class="line" data-startTime="3002">into one. </span> <span class="line" data-startTime="3003">That's 99 saved requests </span><span class="line" data-startTime="3003">to very small files </span><span class="line" data-startTime="3006">that we need for our new design. </span></p>

<p><span class="line" data-startTime="3008">I'm not showing it here. </span> <span class="line" data-startTime="3009">You can check out the marketing </span><span class="line" data-startTime="3009">page to see what it looks like. </span> <span class="line" data-startTime="3013">Just a heads up. </span> <span class="line" data-startTime="3015">For JavaScript, we </span><span class="line" data-startTime="3015">switched to RequireJS. </span> <span class="line" data-startTime="3019">This handles, again, </span><span class="line" data-startTime="3019">concatenation and minification </span><span class="line" data-startTime="3022">in the Grunt task. </span> <span class="line" data-startTime="3022">And we also get </span><span class="line" data-startTime="3022">source maps, which </span><span class="line" data-startTime="3024">is something we're </span><span class="line" data-startTime="3024">really excited to use </span><span class="line" data-startTime="3026">for our development. </span> <span class="line" data-startTime="3028">We no longer need </span><span class="line" data-startTime="3028">a global namespace. </span> <span class="line" data-startTime="3030">That's why the slide </span><span class="line" data-startTime="3030">is titled that we're </span><span class="line" data-startTime="3031">deleting our </span><span class="line" data-startTime="3031">Window.NYTD namespace. </span> <span class="line" data-startTime="3034">We get asynchronous </span><span class="line" data-startTime="3034">loading of JavaScript. </span> <span class="line" data-startTime="3037">And we, basically, decided to </span><span class="line" data-startTime="3037">focus on larger build files, </span><span class="line" data-startTime="3041">so that once you've establish </span><span class="line" data-startTime="3041">a connection on mobile, </span><span class="line" data-startTime="3044">you want to make sure </span><span class="line" data-startTime="3044">you keep the latency low. </span></p>

<p><span class="line" data-startTime="3046">That initial handshake </span><span class="line" data-startTime="3046">can be really high. </span> <span class="line" data-startTime="3048">So we keep these large </span><span class="line" data-startTime="3048">build files around instead </span><span class="line" data-startTime="3051">of using a bunch of </span><span class="line" data-startTime="3051">individual RequireJS loads. </span> <span class="line" data-startTime="3055">Since we moved a lot of </span><span class="line" data-startTime="3055">the client customization </span><span class="line" data-startTime="3057">to the browser, </span><span class="line" data-startTime="3057">we needed to make </span><span class="line" data-startTime="3059">sure we could template properly. </span> <span class="line" data-startTime="3061">So we use Underscore JS </span><span class="line" data-startTime="3061">templates instead of building </span><span class="line" data-startTime="3064">with the DOM or </span><span class="line" data-startTime="3064">any HTML strings. </span> <span class="line" data-startTime="3066">And it's way faster </span><span class="line" data-startTime="3066">to precompile. </span> <span class="line" data-startTime="3067">You're essentially running </span><span class="line" data-startTime="3067">a JavaScript function, </span><span class="line" data-startTime="3069">which is optimized </span><span class="line" data-startTime="3069">in the browser. </span> <span class="line" data-startTime="3071">Grunt can automate </span><span class="line" data-startTime="3071">this compilation. </span> <span class="line" data-startTime="3073">There's a built-in </span><span class="line" data-startTime="3073">task to do it. </span></p>

<p><span class="line" data-startTime="3075">And we turn them into </span><span class="line" data-startTime="3075">a RequireJS module </span><span class="line" data-startTime="3077">that gets included as </span><span class="line" data-startTime="3077">part of our build process. </span> <span class="line" data-startTime="3081">So we use Backbone to organize </span><span class="line" data-startTime="3081">everything into modules. </span> <span class="line" data-startTime="3084">They are reusable. </span> <span class="line" data-startTime="3085">And they are shared </span><span class="line" data-startTime="3085">across applications </span><span class="line" data-startTime="3086">if we would like them to be. </span> <span class="line" data-startTime="3088">But the real win is </span><span class="line" data-startTime="3088">that they give us </span><span class="line" data-startTime="3089">a bunch of inherited </span><span class="line" data-startTime="3089">functionality. </span> <span class="line" data-startTime="3091">So we can abstract out </span><span class="line" data-startTime="3091">touch events and analytics </span><span class="line" data-startTime="3094">or some common </span><span class="line" data-startTime="3094">element references, </span><span class="line" data-startTime="3097">so that we won't have to </span><span class="line" data-startTime="3097">look them up all the time. </span> <span class="line" data-startTime="3100">And we can get this </span><span class="line" data-startTime="3100">functionality in everything </span><span class="line" data-startTime="3104">very easily. </span> <span class="line" data-startTime="3105">We get event delegation, </span><span class="line" data-startTime="3105">fewer event listeners, </span><span class="line" data-startTime="3108">so things run a </span><span class="line" data-startTime="3108">little more smoothly. </span></p>

<p><span class="line" data-startTime="3110">And the modules communicate </span><span class="line" data-startTime="3110">with each other using events. </span> <span class="line" data-startTime="3112">So you can publish events. </span> <span class="line" data-startTime="3113">Or you can subscribe to </span><span class="line" data-startTime="3113">another module's events </span><span class="line" data-startTime="3115">to find out about changes. </span> <span class="line" data-startTime="3117">So this is the big topic. </span> <span class="line" data-startTime="3118">What did we do about ads? </span><span class="line" data-startTime="3119">We took ads out of </span><span class="line" data-startTime="3119">the critical path. </span> <span class="line" data-startTime="3121">What we do is on DOM ready, </span><span class="line" data-startTime="3121">we write the ad markup </span><span class="line" data-startTime="3124">into a new Iframe. </span> <span class="line" data-startTime="3126">You just take the </span><span class="line" data-startTime="3126">frames document, </span><span class="line" data-startTime="3127">and you document.write </span><span class="line" data-startTime="3127">it into the frame. </span> <span class="line" data-startTime="3130">And what happens, if the ad </span><span class="line" data-startTime="3130">itself calls document.write, </span><span class="line" data-startTime="3133">you don't lose your whole page. </span> <span class="line" data-startTime="3134">You would just lose the </span><span class="line" data-startTime="3134">content of the Iframe, which </span><span class="line" data-startTime="3136">is blank to begin with. </span></p>

<p><span class="line" data-startTime="3137">So we don't care what they </span><span class="line" data-startTime="3137">do once they're in the frame, </span><span class="line" data-startTime="3139">once they load. </span> <span class="line" data-startTime="3140">If they decide to bust out </span><span class="line" data-startTime="3140">of the frame, they can. </span> <span class="line" data-startTime="3143">But we have this notion of </span><span class="line" data-startTime="3143">trusted ads that aren't framed. </span> <span class="line" data-startTime="3145">And trusted basically means </span><span class="line" data-startTime="3145">that they specifically </span><span class="line" data-startTime="3147">don't do things that </span><span class="line" data-startTime="3147">are bad for page speed. </span> <span class="line" data-startTime="3150">And also, if there's actually a </span><span class="line" data-startTime="3150">problem, it's very easy for us </span><span class="line" data-startTime="3153">to get in touch with </span><span class="line" data-startTime="3153">them and make the change. </span> <span class="line" data-startTime="3155">And this has been really, </span><span class="line" data-startTime="3155">really effective for us. </span> <span class="line" data-startTime="3158">So this is the results page. </span> <span class="line" data-startTime="3161">I thought it would </span><span class="line" data-startTime="3161">be great to show you </span><span class="line" data-startTime="3162">a comparative slide </span><span class="line" data-startTime="3162">of our waterfalls </span><span class="line" data-startTime="3164">to show you how really </span><span class="line" data-startTime="3164">dramatic this is. </span></p>

<p><span class="line" data-startTime="3167">We're not quite ready to show </span><span class="line" data-startTime="3167">you that information yet. </span> <span class="line" data-startTime="3169">It's still being built. </span> <span class="line" data-startTime="3170">So we're not quite </span><span class="line" data-startTime="3170">ready to do that. </span> <span class="line" data-startTime="3173">But just to give </span><span class="line" data-startTime="3173">you an overview, </span><span class="line" data-startTime="3175">before starting to </span><span class="line" data-startTime="3175">render, the page </span><span class="line" data-startTime="3177">used to download </span><span class="line" data-startTime="3177">over 60 requests. </span> <span class="line" data-startTime="3179">It's about 10 now, </span><span class="line" data-startTime="3179">maybe even fewer. </span> <span class="line" data-startTime="3183">Before we're fully loaded, we </span><span class="line" data-startTime="3183">had to download 200 assets. </span> <span class="line" data-startTime="3186">It's about 70 now. </span> <span class="line" data-startTime="3187">Start render is under </span><span class="line" data-startTime="3187">one second in Chrome. </span> <span class="line" data-startTime="3190">And document complete is </span><span class="line" data-startTime="3190">under three seconds in Chrome. </span> <span class="line" data-startTime="3193">So this is a huge win for us. </span> <span class="line" data-startTime="3194">Before, previously, </span><span class="line" data-startTime="3194">document complete </span><span class="line" data-startTime="3196">would be about nine seconds </span><span class="line" data-startTime="3196">on our article pages. </span> <span class="line" data-startTime="3199">So to answer Steve's </span><span class="line" data-startTime="3199">question about </span><span class="line" data-startTime="3201">is web performance </span><span class="line" data-startTime="3201">too hard, no and yes. </span> <span class="line" data-startTime="3205">It's really not that hard. </span></p>

<p><span class="line" data-startTime="3207">The optimization </span><span class="line" data-startTime="3207">practices are really not </span><span class="line" data-startTime="3209">that difficult to begin with. </span> <span class="line" data-startTime="3211">And there is excellent tooling </span><span class="line" data-startTime="3211">that exist to make it really, </span><span class="line" data-startTime="3213">really, really easy to do. </span> <span class="line" data-startTime="3215">However, there are some unique </span><span class="line" data-startTime="3215">challenges that, I think, </span><span class="line" data-startTime="3218">not just big websites, </span><span class="line" data-startTime="3218">but companies </span><span class="line" data-startTime="3220">tend to have their own </span><span class="line" data-startTime="3220">challenges that people can't </span><span class="line" data-startTime="3222">solve their problems </span><span class="line" data-startTime="3222">for them, and not </span><span class="line" data-startTime="3224">to mention any legacy </span><span class="line" data-startTime="3224">decisions, such as ours, where </span><span class="line" data-startTime="3227">we have our static pages </span><span class="line" data-startTime="3227">that was holding us back. </span> <span class="line" data-startTime="3229">We found that we did this </span><span class="line" data-startTime="3229">negative feedback cycle. </span> <span class="line" data-startTime="3232">We had this poor setup. </span></p>

<p><span class="line" data-startTime="3234">And we tried to do </span><span class="line" data-startTime="3234">this proprietary fix </span><span class="line" data-startTime="3235">to make it better. </span> <span class="line" data-startTime="3236">And we found ourselves slightly </span><span class="line" data-startTime="3236">worse off than we were before, </span><span class="line" data-startTime="3239">even though we were getting </span><span class="line" data-startTime="3239">slightly faster speed. </span> <span class="line" data-startTime="3241">So here's some stuff that we </span><span class="line" data-startTime="3241">learned, share some advice. </span> <span class="line" data-startTime="3245">It's really worth </span><span class="line" data-startTime="3245">it to fight to solve </span><span class="line" data-startTime="3246">these big, difficult problems. </span> <span class="line" data-startTime="3248">They are the 800-pound gorilla </span><span class="line" data-startTime="3248">in the room for a reason. </span> <span class="line" data-startTime="3251">Fight to solve them. </span> <span class="line" data-startTime="3252">Once they're out of </span><span class="line" data-startTime="3252">your way, it really </span><span class="line" data-startTime="3254">opens the path to making </span><span class="line" data-startTime="3254">this a lot simpler. </span> <span class="line" data-startTime="3256">We live in a world </span><span class="line" data-startTime="3256">where you don't </span><span class="line" data-startTime="3258">have to rely on proprietary </span><span class="line" data-startTime="3258">systems anymore. </span></p>

<p><span class="line" data-startTime="3260">You might need some </span><span class="line" data-startTime="3260">because it's your business. </span> <span class="line" data-startTime="3263">So you may need to </span><span class="line" data-startTime="3263">make sure that you </span><span class="line" data-startTime="3267">have all your requirements </span><span class="line" data-startTime="3267">taken care of. </span> <span class="line" data-startTime="3269">But a lot of the tooling exists </span><span class="line" data-startTime="3269">to make this very simple. </span> <span class="line" data-startTime="3273">I always say that you should </span><span class="line" data-startTime="3273">count your HTTP connections </span><span class="line" data-startTime="3276">before you count </span><span class="line" data-startTime="3276">bytes in every file. </span> <span class="line" data-startTime="3280">Do the big, easy wins first. </span> <span class="line" data-startTime="3282">It's really easy to </span><span class="line" data-startTime="3282">combine files together </span><span class="line" data-startTime="3284">than it is to figure </span><span class="line" data-startTime="3284">out what code is old </span><span class="line" data-startTime="3286">and needs to be removed </span><span class="line" data-startTime="3286">from your files. </span> <span class="line" data-startTime="3288">And automate everything. </span></p>

<p><span class="line" data-startTime="3289">As soon as you introduce </span><span class="line" data-startTime="3289">manual to the equation, </span><span class="line" data-startTime="3291">it really doesn't get done. </span> <span class="line" data-startTime="3293">So if you can </span><span class="line" data-startTime="3293">automate everything, </span><span class="line" data-startTime="3294">it's by far going to pave the </span><span class="line" data-startTime="3294">road and make it really easy. </span> <span class="line" data-startTime="3300">So that's it. </span> <span class="line" data-startTime="3300">I think I'm running out of time. </span> <span class="line" data-startTime="3302">Thank you very much. </span> <span class="line" data-startTime="3304">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="3308"><span class="speakerName">Eitan Konigsburg</span>: I don't think </span><span class="line" data-startTime="3308">I have time for questions. </span><span class="line" data-startTime="3311">But I will be around at dinner. </span><span class="line" data-startTime="3313">So if you want to </span><span class="line" data-startTime="3313">come find me, and I </span><span class="line" data-startTime="3314">can talk endlessly about this. </span><span class="line" data-startTime="3316">So please find me. </span><span class="line" data-startTime="3317">I will share all </span><span class="line" data-startTime="3317">of my knowledge. </span></p>

<p class="speaker"><span class="line" data-starttime="3319"><span class="speakerName">Pete</span>: All right. </span><span class="line" data-startTime="3321">So that's one point. </span><span class="line" data-startTime="3322">You can talk to </span><span class="line" data-startTime="3322">people at dinnertime. </span><span class="line" data-startTime="3324">We may have time for questions </span><span class="line" data-startTime="3324">at the end of the night. </span><span class="line" data-startTime="3326">We'll see. </span><span class="line" data-startTime="3330">All right. </span><span class="line" data-startTime="3330">So our next speaker is Adam </span><span class="line" data-startTime="3330">Grossman from Forecast. </span><span class="line" data-startTime="3335">Really, if you haven't looked </span><span class="line" data-startTime="3335">at this, you should look at it. </span><span class="line" data-startTime="3337">You should pull it up on your </span><span class="line" data-startTime="3337">browser, maybe right now, </span><span class="line" data-startTime="3340">and see how it is. </span><span class="line" data-startTime="3342">One quick question. </span><span class="line" data-startTime="3344">Is everyone OK on temperature? </span><span class="line" data-startTime="3346">Raise your hand if </span><span class="line" data-startTime="3346">you're too warm. </span><span class="line" data-startTime="3351">OK. </span><span class="line" data-startTime="3352">Looks good. </span></p>

<p class="speaker"><span class="line" data-starttime="3389"><span class="speakerName">Adam Grossman</span>: You'll </span><span class="line" data-startTime="3389">have to excuse me. </span> <span class="line" data-startTime="3391">This is my first </span><span class="line" data-startTime="3391">time using Keynote. </span> <span class="line" data-startTime="3397">All right. </span> <span class="line" data-startTime="3398">Word of warning. </span> <span class="line" data-startTime="3399">I'm getting over a cold. </span> <span class="line" data-startTime="3401">So I'm really hoping that my </span><span class="line" data-startTime="3401">voice lasts the entire thing. </span> <span class="line" data-startTime="3405">So I'll try to keep this short. </span> <span class="line" data-startTime="3406">And also, full disclosure. </span> <span class="line" data-startTime="3409">Right now, I'm a little </span><span class="line" data-startTime="3409">bit high on the 'Tussin. </span> <span class="line" data-startTime="3413">And it turns out, I </span><span class="line" data-startTime="3413">just learned this right </span><span class="line" data-startTime="3416">before coming here, </span><span class="line" data-startTime="3416">that you're not </span><span class="line" data-startTime="3419">supposed to mix cold </span><span class="line" data-startTime="3419">medicine with whiskey. </span></p>

<p><span class="line" data-startTime="3422">I didn't know that. </span> <span class="line" data-startTime="3424">But that train has sailed. </span> <span class="line" data-startTime="3428">So we're going to </span><span class="line" data-startTime="3428">make the best of it. </span> <span class="line" data-startTime="3435">I'm Adam Grossman. </span> <span class="line" data-startTime="3436">I work for a tiny little </span><span class="line" data-startTime="3436">two-person company </span><span class="line" data-startTime="3440">called Dark Sky. </span> <span class="line" data-startTime="3444">We make weather </span><span class="line" data-startTime="3444">prediction software. </span> <span class="line" data-startTime="3446">We have an iOS app </span><span class="line" data-startTime="3446">called Dark Sky. </span> <span class="line" data-startTime="3449">We have a weather API </span><span class="line" data-startTime="3449">for other developers. </span> <span class="line" data-startTime="3451">And we make, more </span><span class="line" data-startTime="3451">recently, a weather website </span><span class="line" data-startTime="3455">called Forecast. </span> <span class="line" data-startTime="3457">It's forecast.io. </span> <span class="line" data-startTime="3458">If you want to </span><span class="line" data-startTime="3458">give us heartburn, </span><span class="line" data-startTime="3460">you can call it </span><span class="line" data-startTime="3460">"forecast-ee-oh." </span><span class="line" data-startTime="3462">And it looks like </span><span class="line" data-startTime="3462">this on the desktop. </span></p>

<p><span class="line" data-startTime="3465">On mobile, it looks </span><span class="line" data-startTime="3465">more like this. </span> <span class="line" data-startTime="3468">That's the iPhone version. </span> <span class="line" data-startTime="3470">And we really tried hard to </span><span class="line" data-startTime="3470">make the mobile experience </span><span class="line" data-startTime="3476">feel like a native app. </span> <span class="line" data-startTime="3479">So you save it to </span><span class="line" data-startTime="3479">your home screen. </span> <span class="line" data-startTime="3481">In fact, we require it. </span> <span class="line" data-startTime="3482">And that's a very </span><span class="line" data-startTime="3482">controversial decision. </span> <span class="line" data-startTime="3485">It lives on your homescreen. </span> <span class="line" data-startTime="3486">It's got a little icon. </span> <span class="line" data-startTime="3488">It fits in with </span><span class="line" data-startTime="3488">all the other apps. </span> <span class="line" data-startTime="3493">And you launch it. </span> <span class="line" data-startTime="3493">And you get something that </span><span class="line" data-startTime="3493">looks like a native app. </span> <span class="line" data-startTime="3496">And when you slide </span><span class="line" data-startTime="3496">between views, </span><span class="line" data-startTime="3497">it's a nice smooth animation. </span> <span class="line" data-startTime="3498">And we even got a nice, </span><span class="line" data-startTime="3498">smoothly animating radar map. </span> <span class="line" data-startTime="3502">And the reason we </span><span class="line" data-startTime="3502">did this &mdash; and I </span><span class="line" data-startTime="3507">don't recommend it for all apps. </span> <span class="line" data-startTime="3508">But the reason we did this is </span><span class="line" data-startTime="3508">because if you want a weather </span><span class="line" data-startTime="3512">app on your phone, and you've </span><span class="line" data-startTime="3512">got your phone and you're out </span><span class="line" data-startTime="3515">and you want to access the </span><span class="line" data-startTime="3515">weather, the last thing </span><span class="line" data-startTime="3517">you want to do is </span><span class="line" data-startTime="3517">open your web browser, </span><span class="line" data-startTime="3520">navigate to some weather </span><span class="line" data-startTime="3520">website, enter your location, </span><span class="line" data-startTime="3522">and wait for it to load. </span> <span class="line" data-startTime="3523">You just want to launch an </span><span class="line" data-startTime="3523">app and get the weather. </span></p>

<p><span class="line" data-startTime="3527">So if we had gone the </span><span class="line" data-startTime="3527">more traditional route, </span><span class="line" data-startTime="3529">I think a lot of people </span><span class="line" data-startTime="3529">just wouldn't use it. </span> <span class="line" data-startTime="3532">So that's the reason </span><span class="line" data-startTime="3532">that we did it. </span> <span class="line" data-startTime="3535">Now, a lot of ink </span><span class="line" data-startTime="3535">has been spilled </span><span class="line" data-startTime="3539">on the topic of mobile </span><span class="line" data-startTime="3539">web UI performance </span><span class="line" data-startTime="3544">and the bigger picture question </span><span class="line" data-startTime="3544">of what's the future of mobile. </span> <span class="line" data-startTime="3549">Is it native apps? </span><span class="line" data-startTime="3550">Or is it the mobile web? </span><span class="line" data-startTime="3553">And more recently, </span><span class="line" data-startTime="3553">the question has </span><span class="line" data-startTime="3555">been why are mobile web apps so </span><span class="line" data-startTime="3555">crummy compared to native apps? </span><span class="line" data-startTime="3560">And they are. </span> <span class="line" data-startTime="3562">If you take the </span><span class="line" data-startTime="3562">average mobile web app </span><span class="line" data-startTime="3564">and you compare it to </span><span class="line" data-startTime="3564">the average native app, </span><span class="line" data-startTime="3566">it doesn't perform as well. </span></p>

<p><span class="line" data-startTime="3568">And of course, there </span><span class="line" data-startTime="3568">are always exceptions. </span> <span class="line" data-startTime="3571">And if you do some Googling, </span><span class="line" data-startTime="3571">the general consensus, </span><span class="line" data-startTime="3575">if there is such a </span><span class="line" data-startTime="3575">thing on the web, </span><span class="line" data-startTime="3577">is that web apps are slow </span><span class="line" data-startTime="3577">because JavaScript is slow. </span> <span class="line" data-startTime="3581">There was a great article, </span><span class="line" data-startTime="3581">great blog post put out </span><span class="line" data-startTime="3584">by a guy named Drew </span><span class="line" data-startTime="3584">Crawford called </span><span class="line" data-startTime="3587">"Why Mobile Web Apps Are Slow." </span><span class="line" data-startTime="3589">And he did a comparison. </span> <span class="line" data-startTime="3591">He showed benchmarks of </span><span class="line" data-startTime="3591">JavaScript versus native code. </span> <span class="line" data-startTime="3596">And he found, of course, </span><span class="line" data-startTime="3596">that especially on mobile, </span><span class="line" data-startTime="3599">JavaScript is way </span><span class="line" data-startTime="3599">slower than native code. </span> <span class="line" data-startTime="3601">And his conclusion </span><span class="line" data-startTime="3601">is that web apps </span><span class="line" data-startTime="3604">can't compete with native </span><span class="line" data-startTime="3604">apps because they're </span><span class="line" data-startTime="3606">written in JavaScript. </span></p>

<p><span class="line" data-startTime="3607">And JavaScript has </span><span class="line" data-startTime="3607">to compete with, </span><span class="line" data-startTime="3610">on iOS, Objective-C, </span><span class="line" data-startTime="3610">which is nice and fast. </span> <span class="line" data-startTime="3614">On Android, it's generally </span><span class="line" data-startTime="3614">Java, even BlackBerry, </span><span class="line" data-startTime="3618">presumably Fortran. </span> <span class="line" data-startTime="3623">And all of these are fast. </span> <span class="line" data-startTime="3625">And JavaScript is </span><span class="line" data-startTime="3625">comparatively much slower. </span> <span class="line" data-startTime="3628">And that's why mobile </span><span class="line" data-startTime="3628">web apps are slow. </span> <span class="line" data-startTime="3631">This is not true. </span> <span class="line" data-startTime="3633">Web apps are not slow and </span><span class="line" data-startTime="3633">crummy because JavaScript slow. </span> <span class="line" data-startTime="3637">And the reason is really simple. </span> <span class="line" data-startTime="3640">Graphical rendering on the web </span><span class="line" data-startTime="3640">does not happen in JavaScript. </span> <span class="line" data-startTime="3645">Unless you're doing </span><span class="line" data-startTime="3645">pixel-by-pixel graphics </span><span class="line" data-startTime="3648">on a canvas element, nothing </span><span class="line" data-startTime="3648">is being drawn by JavaScript. </span></p>

<p><span class="line" data-startTime="3652">It's all being drawn by the </span><span class="line" data-startTime="3652">engine underneath it which </span><span class="line" data-startTime="3656">has been heavily optimized. </span> <span class="line" data-startTime="3657">And in fact, on iOS, </span><span class="line" data-startTime="3657">graphical rendering </span><span class="line" data-startTime="3661">is not done in Objective-C. </span> <span class="line" data-startTime="3661">Most of it, at least </span><span class="line" data-startTime="3665">the heavy lifting, is </span><span class="line" data-startTime="3665">offloaded onto the GPU. </span> <span class="line" data-startTime="3668">And in fact, you can </span><span class="line" data-startTime="3668">prove this yourself </span><span class="line" data-startTime="3670">with a little </span><span class="line" data-startTime="3670">thought experiment. </span> <span class="line" data-startTime="3671">Imagine ripping out your GPU, </span><span class="line" data-startTime="3671">the little chip on your iPhone, </span><span class="line" data-startTime="3674">and being forced to do </span><span class="line" data-startTime="3674">everything in Objective-C. </span> <span class="line" data-startTime="3677">You would get a really </span><span class="line" data-startTime="3677">crummy experience. </span> <span class="line" data-startTime="3680">So really when it comes </span><span class="line" data-startTime="3680">to graphical performance, </span><span class="line" data-startTime="3682">it's not about JavaScript. </span> <span class="line" data-startTime="3684">It's not about Objective-C. </span> <span class="line" data-startTime="3684">So that brings us back </span><span class="line" data-startTime="3688">to the original question. </span></p>

<p><span class="line" data-startTime="3689">Why are mobile web apps so </span><span class="line" data-startTime="3689">crummy compared to native apps? </span><span class="line" data-startTime="3695">And to answer this </span><span class="line" data-startTime="3695">question, I think </span><span class="line" data-startTime="3699">I have to stop and give </span><span class="line" data-startTime="3699">you the two rules for how </span><span class="line" data-startTime="3704">to create performant </span><span class="line" data-startTime="3704">mobile web apps. </span> <span class="line" data-startTime="3707">There's only two rules </span><span class="line" data-startTime="3707">you need to know. </span> <span class="line" data-startTime="3708">And you only need to know these </span><span class="line" data-startTime="3708">two rules and nothing else. </span> <span class="line" data-startTime="3712">So you might want to grab a pen. </span> <span class="line" data-startTime="3714">The two rules for performant </span><span class="line" data-startTime="3714">mobile web UI, number one, </span><span class="line" data-startTime="3718">is to do stuff </span><span class="line" data-startTime="3718">that is performant. </span> <span class="line" data-startTime="3722">Number two, second </span><span class="line" data-startTime="3722">rule, is avoid stuff </span><span class="line" data-startTime="3726">that performs poorly. </span> <span class="line" data-startTime="3729">Now, before I continue, a </span><span class="line" data-startTime="3729">brief anecdotal interlude. </span> <span class="line" data-startTime="3736">Growing up, I played baseball. </span></p>

<p><span class="line" data-startTime="3738">I was on the little league team. </span> <span class="line" data-startTime="3740">And I had a little league coach. </span> <span class="line" data-startTime="3742">That's not him. </span> <span class="line" data-startTime="3743">He was much fatter. </span> <span class="line" data-startTime="3745">And that's the wrong sport. </span> <span class="line" data-startTime="3751">And one day, he gathered </span><span class="line" data-startTime="3751">all of us around. </span> <span class="line" data-startTime="3753">And he said, kids, </span><span class="line" data-startTime="3753">I'm going to tell you </span><span class="line" data-startTime="3756">the key to winning </span><span class="line" data-startTime="3756">any baseball game. </span> <span class="line" data-startTime="3759">And of course, our </span><span class="line" data-startTime="3759">ears perked up. </span> <span class="line" data-startTime="3761">And we leaned in. </span> <span class="line" data-startTime="3762">And he said, the key to </span><span class="line" data-startTime="3762">winning any baseball game </span><span class="line" data-startTime="3765">is to score more runs </span><span class="line" data-startTime="3765">than your opponent. </span> <span class="line" data-startTime="3769">Thanks, coach. </span> <span class="line" data-startTime="3772">You're a really bad coach. </span> <span class="line" data-startTime="3773">And it turns out </span><span class="line" data-startTime="3773">he was a bad coach. </span> <span class="line" data-startTime="3775">We lost most of the </span><span class="line" data-startTime="3775">games that year. </span> <span class="line" data-startTime="3776">And I know that this rule </span><span class="line" data-startTime="3776">seems very similar in spirit </span><span class="line" data-startTime="3783">to my two rules for </span><span class="line" data-startTime="3783">performant mobile web UI. </span> <span class="line" data-startTime="3787">But they're not. </span> <span class="line" data-startTime="3789">They're not the same. </span></p>

<p><span class="line" data-startTime="3790">And I think there's </span><span class="line" data-startTime="3790">some interesting things </span><span class="line" data-startTime="3793">that we can pull from this </span><span class="line" data-startTime="3793">if we really, really try. </span> <span class="line" data-startTime="3797">The first thing to notice </span><span class="line" data-startTime="3797">is that on the surface </span><span class="line" data-startTime="3800">these two rules seem like </span><span class="line" data-startTime="3800">the same rule, just worded </span><span class="line" data-startTime="3803">in two different ways, so I can </span><span class="line" data-startTime="3803">fill up two points on a slide. </span> <span class="line" data-startTime="3806">But really, I think </span><span class="line" data-startTime="3806">they're different. </span> <span class="line" data-startTime="3810">And one of these </span><span class="line" data-startTime="3810">rules is much harder </span><span class="line" data-startTime="3814">to accomplish than </span><span class="line" data-startTime="3814">the other rule. </span> <span class="line" data-startTime="3816">And if you're going to ask </span><span class="line" data-startTime="3816">someone who is just starting up </span><span class="line" data-startTime="3818">in web development </span><span class="line" data-startTime="3818">which rule was easy </span><span class="line" data-startTime="3821">and which rule </span><span class="line" data-startTime="3821">was hard, he would </span><span class="line" data-startTime="3823">say, the hard rule is the first </span><span class="line" data-startTime="3823">one &mdash; doing stuff that performs </span><span class="line" data-startTime="3828">well, finding the </span><span class="line" data-startTime="3828">techniques that you need, </span><span class="line" data-startTime="3830">because there's lot of </span><span class="line" data-startTime="3830">stuff you need to learn. </span></p>

<p><span class="line" data-startTime="3832">And learning is hard. </span> <span class="line" data-startTime="3834">And you may have to learn about </span><span class="line" data-startTime="3834">CSS transitions, and Appcache, </span><span class="line" data-startTime="3837">and browser compatibility, </span><span class="line" data-startTime="3837">and all of that. </span> <span class="line" data-startTime="3841">And that's really hard. </span> <span class="line" data-startTime="3842">Meanwhile, rule number </span><span class="line" data-startTime="3842">two &mdash; avoiding stuff. </span> <span class="line" data-startTime="3845">That's easy. </span> <span class="line" data-startTime="3846">That's not doing something. </span> <span class="line" data-startTime="3847">And not doing something </span><span class="line" data-startTime="3847">is really easy. </span> <span class="line" data-startTime="3849">And you can just try things. </span> <span class="line" data-startTime="3851">And if you look on your phone </span><span class="line" data-startTime="3851">and they don't perform well, </span><span class="line" data-startTime="3854">well, you just don't include it. </span> <span class="line" data-startTime="3855">And so that's really easy. </span> <span class="line" data-startTime="3859">But I think true enlightenment </span><span class="line" data-startTime="3859">comes from the realization </span><span class="line" data-startTime="3864">that the situation is </span><span class="line" data-startTime="3864">reversed, that, in actuality, </span><span class="line" data-startTime="3867">the hard one is to avoid </span><span class="line" data-startTime="3867">stuff that performs poorly. </span> <span class="line" data-startTime="3871">And the easy one is to do </span><span class="line" data-startTime="3871">stuff that performs well. </span></p>

<p><span class="line" data-startTime="3875">I need my water. </span> <span class="line" data-startTime="3878">So I've been doing web </span><span class="line" data-startTime="3878">development for a while. </span> <span class="line" data-startTime="3884">I was doing freelance </span><span class="line" data-startTime="3884">before I started Dark Sky. </span> <span class="line" data-startTime="3888">But I'd never done any big </span><span class="line" data-startTime="3888">mobile project, like Forecast. </span> <span class="line" data-startTime="3892">And I didn't know, </span><span class="line" data-startTime="3892">really, where to start. </span> <span class="line" data-startTime="3894">I didn't know what the </span><span class="line" data-startTime="3894">performance bottlenecks were. </span> <span class="line" data-startTime="3900">Well, what I did was </span><span class="line" data-startTime="3900">I went to Google. </span> <span class="line" data-startTime="3905">And I asked Google, </span><span class="line" data-startTime="3905">hey Google, how do I </span><span class="line" data-startTime="3908">make smooth animations </span><span class="line" data-startTime="3908">in mobile web apps? </span><span class="line" data-startTime="3910">And Google said, hey, </span><span class="line" data-startTime="3910">here are some links </span><span class="line" data-startTime="3914">you might like to read. </span> <span class="line" data-startTime="3915">And there's a whole </span><span class="line" data-startTime="3915">bunch of them. </span> <span class="line" data-startTime="3917">And the first thing you </span><span class="line" data-startTime="3917">learn is that if you're </span><span class="line" data-startTime="3919">going to make mobile </span><span class="line" data-startTime="3919">animations that are performant, </span><span class="line" data-startTime="3922">you should use CSS transitions </span><span class="line" data-startTime="3922">and transforms because they're </span><span class="line" data-startTime="3925">hardware accelerated </span><span class="line" data-startTime="3925">and they're fast. </span> <span class="line" data-startTime="3927">So I went back to Google. </span></p>

<p><span class="line" data-startTime="3928">And I said, tell me about CSS </span><span class="line" data-startTime="3928">transforms and transitions. </span> <span class="line" data-startTime="3932">And it worked, even though </span><span class="line" data-startTime="3932">I spelled transitions wrong. </span> <span class="line" data-startTime="3935">And suddenly, in </span><span class="line" data-startTime="3935">a weekend, I was </span><span class="line" data-startTime="3939">able to make my animations fast </span><span class="line" data-startTime="3939">and performant on my iPhone. </span> <span class="line" data-startTime="3943">So then I went on </span><span class="line" data-startTime="3943">to the next thing. </span> <span class="line" data-startTime="3944">I asked Google </span><span class="line" data-startTime="3944">about touch events. </span> <span class="line" data-startTime="3946">And it told me </span><span class="line" data-startTime="3946">about touch events, </span><span class="line" data-startTime="3947">how to capture the event when </span><span class="line" data-startTime="3947">your finger touches the phone. </span> <span class="line" data-startTime="3950">And suddenly, my smooth </span><span class="line" data-startTime="3950">animations were interactive. </span> <span class="line" data-startTime="3954">You can interact with them. </span> <span class="line" data-startTime="3955">And then I got excited. </span> <span class="line" data-startTime="3956">And I went on and I asked </span><span class="line" data-startTime="3956">Google about Appcache. </span> <span class="line" data-startTime="3959">It is this thing </span><span class="line" data-startTime="3959">I'd heard about. </span></p>

<p><span class="line" data-startTime="3960">I always heard that it </span><span class="line" data-startTime="3960">was tough and confusing. </span> <span class="line" data-startTime="3962">But you ask Google about it. </span> <span class="line" data-startTime="3963">And it gives you the </span><span class="line" data-startTime="3963">links, the blog posts </span><span class="line" data-startTime="3965">that you need to know. </span> <span class="line" data-startTime="3966">And the Appcache is </span><span class="line" data-startTime="3966">something that, well, </span><span class="line" data-startTime="3969">it tells the browser </span><span class="line" data-startTime="3969">to cache the app, </span><span class="line" data-startTime="3971">so that next time </span><span class="line" data-startTime="3971">you go to it, you </span><span class="line" data-startTime="3973">don't have to pull in all </span><span class="line" data-startTime="3973">of the HTML and JavaScript. </span> <span class="line" data-startTime="3977">And suddenly, your </span><span class="line" data-startTime="3977">interactive, smooth animations </span><span class="line" data-startTime="3981">now load quickly. </span> <span class="line" data-startTime="3983">And finally, you want </span><span class="line" data-startTime="3983">to make it into an app </span><span class="line" data-startTime="3985">that you save to </span><span class="line" data-startTime="3985">your home screen. </span> <span class="line" data-startTime="3986">So I asked Google, how do I save </span><span class="line" data-startTime="3986">mobile apps to the home screen, </span><span class="line" data-startTime="3988">because that would </span><span class="line" data-startTime="3988">be really awesome? </span><span class="line" data-startTime="3989">And it tells you about </span><span class="line" data-startTime="3989">metatags that you </span><span class="line" data-startTime="3993">can include in your page. </span></p>

<p><span class="line" data-startTime="3994">It's really easy. </span> <span class="line" data-startTime="3995">And when you include </span><span class="line" data-startTime="3995">those metatags, </span><span class="line" data-startTime="3999">the Chrome disappears, the </span><span class="line" data-startTime="3999">back button and what have you. </span> <span class="line" data-startTime="4003">And you now have an app </span><span class="line" data-startTime="4003">that fills the screen. </span> <span class="line" data-startTime="4006">And you also find about </span><span class="line" data-startTime="4006">metatags for specifying icons. </span> <span class="line" data-startTime="4009">So very little work in about </span><span class="line" data-startTime="4009">two weekends of Googling. </span> <span class="line" data-startTime="4011">It's not tough. </span> <span class="line" data-startTime="4012">In two weekends, </span><span class="line" data-startTime="4012">you can have an app </span><span class="line" data-startTime="4016">that lives on your home </span><span class="line" data-startTime="4016">screen, has an icon. </span> <span class="line" data-startTime="4018">And when you launch the icon, </span><span class="line" data-startTime="4018">you get an app in full screen. </span> <span class="line" data-startTime="4021">And it's performant. </span> <span class="line" data-startTime="4022">And it's great. </span></p>

<p><span class="line" data-startTime="4023">And suddenly, the </span><span class="line" data-startTime="4023">"New York Times" </span><span class="line" data-startTime="4025">is asking you to </span><span class="line" data-startTime="4025">give presentations. </span> <span class="line" data-startTime="4028">And I think that was the </span><span class="line" data-startTime="4028">body from someone else. </span> <span class="line" data-startTime="4032">That's not my body. </span> <span class="line" data-startTime="4033">So learning the techniques </span><span class="line" data-startTime="4033">that perform well </span><span class="line" data-startTime="4037">is actually pretty </span><span class="line" data-startTime="4037">straightforward. </span> <span class="line" data-startTime="4038">It doesn't take that long, </span><span class="line" data-startTime="4038">especially if you're already </span><span class="line" data-startTime="4040">a web developer. </span> <span class="line" data-startTime="4042">And we like to think that </span><span class="line" data-startTime="4042">web development is difficult, </span><span class="line" data-startTime="4047">because it's our jobs, </span><span class="line" data-startTime="4047">it's our livelihoods. </span> <span class="line" data-startTime="4050">But in reality, the hard </span><span class="line" data-startTime="4050">part is all the stuff that </span><span class="line" data-startTime="4053">happens behind the scenes, </span><span class="line" data-startTime="4053">all the people that </span><span class="line" data-startTime="4055">work on the web kit team, </span><span class="line" data-startTime="4055">people at Google and Apple </span><span class="line" data-startTime="4058">and Mozilla, who are </span><span class="line" data-startTime="4058">making the tools, </span><span class="line" data-startTime="4061">doing the hard work to give </span><span class="line" data-startTime="4061">us the handful of tools </span><span class="line" data-startTime="4064">to make mobile apps </span><span class="line" data-startTime="4064">that perform well. </span> <span class="line" data-startTime="4067">So this is easy. </span> <span class="line" data-startTime="4069">And I really think that avoiding </span><span class="line" data-startTime="4069">techniques that perform poorly </span><span class="line" data-startTime="4073">is the hard part. </span></p>

<p><span class="line" data-startTime="4076">This is a little bit </span><span class="line" data-startTime="4076">counterintuitive, </span><span class="line" data-startTime="4078">because introducing crummy </span><span class="line" data-startTime="4078">performance on the web is </span><span class="line" data-startTime="4081">really an active endeavour. </span> <span class="line" data-startTime="4083">The default is good performance. </span> <span class="line" data-startTime="4085">So one of my favorite mobile </span><span class="line" data-startTime="4085">websites is Wikipedia. </span> <span class="line" data-startTime="4091">And this is one of the </span><span class="line" data-startTime="4091">only content-heavy sites </span><span class="line" data-startTime="4094">where I actually prefer </span><span class="line" data-startTime="4094">their mobile site </span><span class="line" data-startTime="4096">over their desktop </span><span class="line" data-startTime="4096">site on my phone. </span> <span class="line" data-startTime="4100">And it performs beautifully. </span> <span class="line" data-startTime="4101">I think the most complicated </span><span class="line" data-startTime="4101">thing on the site </span><span class="line" data-startTime="4103">is an auto complete </span><span class="line" data-startTime="4103">in the search. </span> <span class="line" data-startTime="4105">But they don't try </span><span class="line" data-startTime="4105">to do anything fancy. </span> <span class="line" data-startTime="4107">And because of that, they </span><span class="line" data-startTime="4107">get great performance. </span> <span class="line" data-startTime="4110">It scrolls beautifully. </span> <span class="line" data-startTime="4112">When you click on a </span><span class="line" data-startTime="4112">sub-heading that's collapsed, </span><span class="line" data-startTime="4115">it just appears. </span> <span class="line" data-startTime="4117">No jittery animations because </span><span class="line" data-startTime="4117">there aren't any animations. </span> <span class="line" data-startTime="4121">So really, good </span><span class="line" data-startTime="4121">performance is the default. </span></p>

<p><span class="line" data-startTime="4125">And when you come </span><span class="line" data-startTime="4125">across crummy websites, </span><span class="line" data-startTime="4129">it's because someone is </span><span class="line" data-startTime="4129">actively making it crummy. </span> <span class="line" data-startTime="4131">And that's a very </span><span class="line" data-startTime="4131">perplexing thing. </span> <span class="line" data-startTime="4133">One example is I </span><span class="line" data-startTime="4133">was reading a blog. </span> <span class="line" data-startTime="4136">And it had a mobile interface. </span> <span class="line" data-startTime="4138">And I was scrolling </span><span class="line" data-startTime="4138">through it vertically. </span> <span class="line" data-startTime="4142">And as you're apt to do, </span><span class="line" data-startTime="4142">because your thumb is </span><span class="line" data-startTime="4145">on a weird swivel, I couldn't </span><span class="line" data-startTime="4145">scroll perfectly up and down. </span> <span class="line" data-startTime="4148">And I managed to go a </span><span class="line" data-startTime="4148">little bit sideways. </span> <span class="line" data-startTime="4150">And all of a sudden, this </span><span class="line" data-startTime="4150">red semicircle appeared. </span> <span class="line" data-startTime="4153">And it had this chunky animated </span><span class="line" data-startTime="4153">bitty, disgusting loading </span><span class="line" data-startTime="4157">screen. </span></p>

<p><span class="line" data-startTime="4158">The UI froze up. </span> <span class="line" data-startTime="4159">And then a new blog post loaded. </span> <span class="line" data-startTime="4163">And it was because someone tried </span><span class="line" data-startTime="4163">to get fancy with a swiping </span><span class="line" data-startTime="4165">gesture to load </span><span class="line" data-startTime="4165">up new blog posts. </span> <span class="line" data-startTime="4168">And it failed miserably. </span> <span class="line" data-startTime="4169">And this is someone who was </span><span class="line" data-startTime="4169">not heeding rule number two. </span> <span class="line" data-startTime="4174">Another example is </span><span class="line" data-startTime="4174">on the ESPN site. </span> <span class="line" data-startTime="4177">I just saw this where </span><span class="line" data-startTime="4177">you get a main headline. </span> <span class="line" data-startTime="4182">And then you get one </span><span class="line" data-startTime="4182">sub-story and a more link. </span> <span class="line" data-startTime="4186">And when you click that </span><span class="line" data-startTime="4186">more link, it comes up. </span> <span class="line" data-startTime="4188">And you get more articles. </span> <span class="line" data-startTime="4190">And when you do that, it is </span><span class="line" data-startTime="4190">this chunky, horrible animation </span><span class="line" data-startTime="4193">that's a few frames a second. </span> <span class="line" data-startTime="4195">And doing this in a </span><span class="line" data-startTime="4195">way that is smooth </span><span class="line" data-startTime="4198">takes no extra work than doing </span><span class="line" data-startTime="4198">it in a way that's not smooth. </span> <span class="line" data-startTime="4201">And this is a major website. </span></p>

<p><span class="line" data-startTime="4203">And they've failed to </span><span class="line" data-startTime="4203">heed rule number two. </span> <span class="line" data-startTime="4208">There are design </span><span class="line" data-startTime="4208">examples of this too. </span> <span class="line" data-startTime="4210">Any time you see </span><span class="line" data-startTime="4210">content that spills over </span><span class="line" data-startTime="4213">or nav that spills </span><span class="line" data-startTime="4213">over your content, </span><span class="line" data-startTime="4216">it's someone who has actively </span><span class="line" data-startTime="4216">incorporated crummy design. </span> <span class="line" data-startTime="4222">My favorite example </span><span class="line" data-startTime="4222">is this website. </span> <span class="line" data-startTime="4225">You go here. </span> <span class="line" data-startTime="4226">And I exaggerated by </span><span class="line" data-startTime="4226">putting it in landscape. </span> <span class="line" data-startTime="4229">But you have browser Chrome </span><span class="line" data-startTime="4229">on the top and the bottom. </span> <span class="line" data-startTime="4231">And then they've introduced </span><span class="line" data-startTime="4231">a header and a footer that's </span><span class="line" data-startTime="4235">always there, fixed positioning. </span> <span class="line" data-startTime="4236">And I don't understand </span><span class="line" data-startTime="4236">the share links. </span> <span class="line" data-startTime="4240">It's as if you're going to get </span><span class="line" data-startTime="4240">halfway through the article, </span><span class="line" data-startTime="4243">and you just can't wait </span><span class="line" data-startTime="4243">to share it on Twitter. </span> <span class="line" data-startTime="4247">So it's there and again. </span></p>

<p><span class="line" data-startTime="4248">So it's not just </span><span class="line" data-startTime="4248">performance in terms </span><span class="line" data-startTime="4251">of making smooth animations. </span> <span class="line" data-startTime="4253">It's also the design too. </span> <span class="line" data-startTime="4255">And this is someone </span><span class="line" data-startTime="4255">actively making </span><span class="line" data-startTime="4257">the design worse by doing this. </span> <span class="line" data-startTime="4258">The rest of the site </span><span class="line" data-startTime="4258">looks really nice, </span><span class="line" data-startTime="4260">but this one aspect. </span> <span class="line" data-startTime="4261">So why do we do it? </span><span class="line" data-startTime="4264">If it's an active </span><span class="line" data-startTime="4264">thing, it seems </span><span class="line" data-startTime="4266">like it should be </span><span class="line" data-startTime="4266">really easy to avoid. </span> <span class="line" data-startTime="4269">And it seems to be a bigger </span><span class="line" data-startTime="4269">problem on the mobile web </span><span class="line" data-startTime="4273">than in native apps. </span> <span class="line" data-startTime="4275">And why is that? </span><span class="line" data-startTime="4276">I think this rule &mdash; </span><span class="line" data-startTime="4276">avoid stuff that </span><span class="line" data-startTime="4279">performs poorly &mdash; I </span><span class="line" data-startTime="4279">think the key difference </span><span class="line" data-startTime="4282">between native apps and mobile </span><span class="line" data-startTime="4282">web apps is that this rule is </span><span class="line" data-startTime="4286">really easy to break on the web. </span> <span class="line" data-startTime="4288">And it's really hard to break </span><span class="line" data-startTime="4288">when you make native apps. </span></p>

<p><span class="line" data-startTime="4291">So what do I mean by this? </span><span class="line" data-startTime="4293">On the web, you're given all </span><span class="line" data-startTime="4293">sorts of ways to do things. </span> <span class="line" data-startTime="4298">And generally, the way </span><span class="line" data-startTime="4298">that you've learned them </span><span class="line" data-startTime="4300">when you're just </span><span class="line" data-startTime="4300">making static content </span><span class="line" data-startTime="4303">is not the way you </span><span class="line" data-startTime="4303">should do things </span><span class="line" data-startTime="4304">when you're trying to make </span><span class="line" data-startTime="4304">dynamic animations that </span><span class="line" data-startTime="4307">perform well. </span> <span class="line" data-startTime="4307">So one example is say </span><span class="line" data-startTime="4307">you make a static page </span><span class="line" data-startTime="4310">and you want to position </span><span class="line" data-startTime="4310">something absolutely. </span></p>

<p><span class="line" data-startTime="4312">So you give it a CSS </span><span class="line" data-startTime="4312">position absolute. </span> <span class="line" data-startTime="4315">And you said it's top </span><span class="line" data-startTime="4315">in left attributes. </span> <span class="line" data-startTime="4318">And you put it somewhere. </span> <span class="line" data-startTime="4320">And now, say you want </span><span class="line" data-startTime="4320">to make it dynamic. </span> <span class="line" data-startTime="4322">You want to animate it. </span> <span class="line" data-startTime="4323">I think the first thing we </span><span class="line" data-startTime="4323">all do is we load up jQuery. </span> <span class="line" data-startTime="4326">And we animate the top and </span><span class="line" data-startTime="4326">left attributes in jQuery. </span> <span class="line" data-startTime="4328">And when you try it, </span><span class="line" data-startTime="4328">historically, that </span><span class="line" data-startTime="4331">has given really poor </span><span class="line" data-startTime="4331">performance on mobile. </span> <span class="line" data-startTime="4333">You should really be </span><span class="line" data-startTime="4333">using CSS transitions. </span> <span class="line" data-startTime="4338">Meanwhile, on native apps &mdash; and </span><span class="line" data-startTime="4338">this is especially true in iOS. </span> <span class="line" data-startTime="4343">As far as native apps go, </span><span class="line" data-startTime="4343">I'm only an iOS developer, </span><span class="line" data-startTime="4346">but I imagine this </span><span class="line" data-startTime="4346">is true on Android. </span> <span class="line" data-startTime="4349">Apple makes it really hard to </span><span class="line" data-startTime="4349">do things that perform poorly. </span> <span class="line" data-startTime="4354">Apple has &mdash; you do UI </span><span class="line" data-startTime="4354">kit and core animation. </span></p>

<p><span class="line" data-startTime="4358">And there's all sorts of juicy </span><span class="line" data-startTime="4358">things you can do with this. </span> <span class="line" data-startTime="4361">And you can't find anything </span><span class="line" data-startTime="4361">in there that performs poorly. </span> <span class="line" data-startTime="4364">If you try to break it and </span><span class="line" data-startTime="4364">try to do these things, </span><span class="line" data-startTime="4366">it's really hard to </span><span class="line" data-startTime="4366">do that, because Apple </span><span class="line" data-startTime="4368">has it locked down. </span> <span class="line" data-startTime="4369">And they only give you </span><span class="line" data-startTime="4369">tools that perform well. </span> <span class="line" data-startTime="4372">And one big example of this </span><span class="line" data-startTime="4372">is it is possible to make, </span><span class="line" data-startTime="4377">of course, iOS apps </span><span class="line" data-startTime="4377">that don't perform well. </span></p>

<p><span class="line" data-startTime="4379">And the biggest </span><span class="line" data-startTime="4379">way to do this is </span><span class="line" data-startTime="4381">to do custom drawing operations. </span> <span class="line" data-startTime="4384">And so in the iOS world, there </span><span class="line" data-startTime="4384">are things called UI views. </span> <span class="line" data-startTime="4389">And UI views, you can think of </span><span class="line" data-startTime="4389">them as DIVs in the HTML world. </span> <span class="line" data-startTime="4393">They're just generic </span><span class="line" data-startTime="4393">rectangle containers </span><span class="line" data-startTime="4395">that you can put stuff in. </span> <span class="line" data-startTime="4396">And you can implement </span><span class="line" data-startTime="4396">an optional method </span><span class="line" data-startTime="4399">on them called drawRect. </span> <span class="line" data-startTime="4401">It's optional. </span> <span class="line" data-startTime="4402">You usually don't </span><span class="line" data-startTime="4402">want to use it. </span> <span class="line" data-startTime="4404">But when you implement </span><span class="line" data-startTime="4404">it, it turns a UI view </span><span class="line" data-startTime="4406">into, essentially, a </span><span class="line" data-startTime="4406">canvas element, where </span><span class="line" data-startTime="4409">you can do a canvas </span><span class="line" data-startTime="4409">drawing to it. </span> <span class="line" data-startTime="4411">And actually, the syntax is </span><span class="line" data-startTime="4411">very similar to the syntax </span><span class="line" data-startTime="4414">for a canvas drawing, presumably </span><span class="line" data-startTime="4414">because canvas was originally </span><span class="line" data-startTime="4418">developed by Apple. </span> <span class="line" data-startTime="4420">So Apple cares so much </span><span class="line" data-startTime="4420">about you not using this </span><span class="line" data-startTime="4425">that they'll actually </span><span class="line" data-startTime="4425">put this optional method. </span></p>

<p><span class="line" data-startTime="4427">When you go into Xcode </span><span class="line" data-startTime="4427">and you create a file, </span><span class="line" data-startTime="4429">they'll put this method here. </span> <span class="line" data-startTime="4431">They'll comment it out. </span> <span class="line" data-startTime="4431">And in the comment, they </span><span class="line" data-startTime="4431">tell you not to use it. </span> <span class="line" data-startTime="4434">And I think the only </span><span class="line" data-startTime="4434">reason they actually </span><span class="line" data-startTime="4435">put this here is so that they </span><span class="line" data-startTime="4435">can tell you that it adversely </span><span class="line" data-startTime="4438">affects performance. </span> <span class="line" data-startTime="4439">And so I think this is </span><span class="line" data-startTime="4439">the biggest difference </span><span class="line" data-startTime="4444">between the native </span><span class="line" data-startTime="4444">world and the web world </span><span class="line" data-startTime="4448">is that it's really </span><span class="line" data-startTime="4448">hard to break this rule. </span> <span class="line" data-startTime="4452">So where do we go from here? </span><span class="line" data-startTime="4454">How do we avoid making </span><span class="line" data-startTime="4454">crummy web apps? </span><span class="line" data-startTime="4458">I think the biggest thing, </span><span class="line" data-startTime="4458">more so than on native apps, </span><span class="line" data-startTime="4462">is discipline. </span> <span class="line" data-startTime="4464">We need to take </span><span class="line" data-startTime="4464">great care that we </span><span class="line" data-startTime="4466">don't introduce </span><span class="line" data-startTime="4466">poor performance. </span></p>

<p><span class="line" data-startTime="4469">Some things to watch out </span><span class="line" data-startTime="4469">for are &mdash; well, the biggest </span><span class="line" data-startTime="4475">thing to watch out for, </span><span class="line" data-startTime="4475">and this is something </span><span class="line" data-startTime="4477">that I fall for all the </span><span class="line" data-startTime="4477">time, is falling in love </span><span class="line" data-startTime="4481">with a bad idea. </span> <span class="line" data-startTime="4483">So maybe you have an idea. </span> <span class="line" data-startTime="4484">Presumably, the person </span><span class="line" data-startTime="4484">who made that blog post </span><span class="line" data-startTime="4486">with the really awful </span><span class="line" data-startTime="4486">swiping, he fell in </span><span class="line" data-startTime="4488">love with the idea of swiping to </span><span class="line" data-startTime="4488">get back and forth between blog </span><span class="line" data-startTime="4493">posts. </span> <span class="line" data-startTime="4494">For me, it's been </span><span class="line" data-startTime="4494">a lot of things. </span> <span class="line" data-startTime="4496">I wanted to implement </span><span class="line" data-startTime="4496">a thing in Forecast </span><span class="line" data-startTime="4498">for deleting saved </span><span class="line" data-startTime="4498">locations where </span><span class="line" data-startTime="4500">when you click that delete </span><span class="line" data-startTime="4500">button, the thing jumps up, </span><span class="line" data-startTime="4503">crinkles up, gets thrown </span><span class="line" data-startTime="4503">away into a trash bin, </span><span class="line" data-startTime="4506">and fades out. </span></p>

<p><span class="line" data-startTime="4507">And it's really seductive to </span><span class="line" data-startTime="4507">fall in love with an idea. </span> <span class="line" data-startTime="4510">And when you test </span><span class="line" data-startTime="4510">it, it will often </span><span class="line" data-startTime="4512">work because you're testing </span><span class="line" data-startTime="4512">it in an environment that's </span><span class="line" data-startTime="4515">not a real-world environment. </span> <span class="line" data-startTime="4519">And it turns out when you </span><span class="line" data-startTime="4519">actually implement it, </span><span class="line" data-startTime="4521">when it's actually interacting </span><span class="line" data-startTime="4521">with other things on the page, </span><span class="line" data-startTime="4523">sometimes it fails. </span> <span class="line" data-startTime="4524">And if you fall in </span><span class="line" data-startTime="4524">love with a bad idea, </span><span class="line" data-startTime="4526">it's sometimes really </span><span class="line" data-startTime="4526">hard to let it go. </span> <span class="line" data-startTime="4528">And it stays in. </span></p>

<p><span class="line" data-startTime="4530">And sometimes you </span><span class="line" data-startTime="4530">don't listen when </span><span class="line" data-startTime="4532">your friends try to </span><span class="line" data-startTime="4532">talk you out of it. </span> <span class="line" data-startTime="4535">And they say that idea </span><span class="line" data-startTime="4535">is no good for you. </span> <span class="line" data-startTime="4538">And that's fine. </span> <span class="line" data-startTime="4539">Experiment. </span> <span class="line" data-startTime="4540">Fool around a little bit. </span> <span class="line" data-startTime="4542">We're young. </span> <span class="line" data-startTime="4543">But don't settle down too </span><span class="line" data-startTime="4543">easily if it turns out </span><span class="line" data-startTime="4546">that the idea turns out </span><span class="line" data-startTime="4546">to be no good for you. </span> <span class="line" data-startTime="4549">I don't know why I </span><span class="line" data-startTime="4549">used this picture </span><span class="line" data-startTime="4551">of an example of a couple </span><span class="line" data-startTime="4551">that's no good for each other. </span> <span class="line" data-startTime="4554">They look really happy. </span> <span class="line" data-startTime="4560">And if one of them </span><span class="line" data-startTime="4560">decides to change </span><span class="line" data-startTime="4562">their hair before the other. </span> <span class="line" data-startTime="4566">Another thing to </span><span class="line" data-startTime="4566">avoid is, of course, </span><span class="line" data-startTime="4568">designer-developer disconnect. </span></p>

<p><span class="line" data-startTime="4570">And this tends to be true at </span><span class="line" data-startTime="4570">larger organizations, where </span><span class="line" data-startTime="4572">you have a designer </span><span class="line" data-startTime="4572">designing something </span><span class="line" data-startTime="4574">or a team of designers. </span> <span class="line" data-startTime="4575">And they hand it </span><span class="line" data-startTime="4575">down to developers. </span> <span class="line" data-startTime="4577">And time was you could design </span><span class="line" data-startTime="4577">something in Photoshop, </span><span class="line" data-startTime="4581">because websites were static. </span> <span class="line" data-startTime="4583">And developers </span><span class="line" data-startTime="4583">could implement it. </span> <span class="line" data-startTime="4585">And sometimes they had </span><span class="line" data-startTime="4585">to do disgusting things, </span><span class="line" data-startTime="4588">like chop it up into a grid </span><span class="line" data-startTime="4588">of images and use tables. </span> <span class="line" data-startTime="4591">But it worked. </span> <span class="line" data-startTime="4592">But now, especially </span><span class="line" data-startTime="4592">on the mobile web, </span><span class="line" data-startTime="4596">websites are dynamic. </span> <span class="line" data-startTime="4597">They're animated. </span> <span class="line" data-startTime="4598">And it's really hard to </span><span class="line" data-startTime="4598">design for that, especially </span><span class="line" data-startTime="4600">in Photoshop. </span></p>

<p><span class="line" data-startTime="4601">So designers may have </span><span class="line" data-startTime="4601">these great ideas </span><span class="line" data-startTime="4603">for how to do things, how </span><span class="line" data-startTime="4603">to interact with things. </span> <span class="line" data-startTime="4605">And when it comes time </span><span class="line" data-startTime="4605">to actually develop them, </span><span class="line" data-startTime="4607">it doesn't work. </span> <span class="line" data-startTime="4608">And I think that </span><span class="line" data-startTime="4608">very often developers </span><span class="line" data-startTime="4612">don't speak up about it. </span> <span class="line" data-startTime="4614">And it stays in there. </span> <span class="line" data-startTime="4616">So I think the way to avoid this </span><span class="line" data-startTime="4616">is to really &mdash; developers take </span><span class="line" data-startTime="4619">ownership in any design work and </span><span class="line" data-startTime="4619">any app that you're working on. </span> <span class="line" data-startTime="4624">I don't know any organization </span><span class="line" data-startTime="4624">where a developer couldn't </span><span class="line" data-startTime="4626">go back to the designers </span><span class="line" data-startTime="4626">and even back to management </span><span class="line" data-startTime="4629">and say, this was a great idea. </span> <span class="line" data-startTime="4631">But it turns out when we </span><span class="line" data-startTime="4631">actually implement it, </span><span class="line" data-startTime="4633">it doesn't work. </span></p>

<p><span class="line" data-startTime="4634">So there needs to be </span><span class="line" data-startTime="4634">this cyclical process </span><span class="line" data-startTime="4637">of development. </span> <span class="line" data-startTime="4640">Another thing to avoid is </span><span class="line" data-startTime="4640">one platform preference. </span> <span class="line" data-startTime="4644">I am an iPhone guy. </span> <span class="line" data-startTime="4645">I love my iPhone. </span> <span class="line" data-startTime="4647">I will never switch to Android. </span> <span class="line" data-startTime="4649">I have a bunch of </span><span class="line" data-startTime="4649">Android phones. </span> <span class="line" data-startTime="4651">And I never use them. </span> <span class="line" data-startTime="4653">I have a Firefox OS device. </span> <span class="line" data-startTime="4655">And I really want the Firefox </span><span class="line" data-startTime="4655">OS device to be great. </span> <span class="line" data-startTime="4659">But it's not that great. </span> <span class="line" data-startTime="4660">So I'm really about iOS. </span> <span class="line" data-startTime="4662">And this is to the severe </span><span class="line" data-startTime="4662">detriment of Forecast </span><span class="line" data-startTime="4665">because it works way better on </span><span class="line" data-startTime="4665">iOS than it does on Android. </span> <span class="line" data-startTime="4669">So this is something to avoid. </span> <span class="line" data-startTime="4671">And this is the lesson </span><span class="line" data-startTime="4671">I need to learn. </span> <span class="line" data-startTime="4674">But I haven't. </span></p>

<p><span class="line" data-startTime="4676">I can put it in a slide. </span> <span class="line" data-startTime="4678">The next thing to avoid is </span><span class="line" data-startTime="4678">what I call test blindness. </span> <span class="line" data-startTime="4684">And when you develop an app, </span><span class="line" data-startTime="4684">as you progress in development, </span><span class="line" data-startTime="4689">you're constantly using it. </span> <span class="line" data-startTime="4690">You're constantly </span><span class="line" data-startTime="4690">interacting with it. </span> <span class="line" data-startTime="4692">You're loading it on your phone. </span> <span class="line" data-startTime="4693">And pretty soon, you </span><span class="line" data-startTime="4693">learn how to avoid </span><span class="line" data-startTime="4696">interacting with it in </span><span class="line" data-startTime="4696">a way that breaks it. </span> <span class="line" data-startTime="4698">You know all the </span><span class="line" data-startTime="4698">little hidden gotchas. </span> <span class="line" data-startTime="4701">And subconsciously, </span><span class="line" data-startTime="4701">you avoid it. </span> <span class="line" data-startTime="4703">And I do this all the time. </span> <span class="line" data-startTime="4705">I'll do something. </span> <span class="line" data-startTime="4705">And I'll think it has no bugs. </span></p>

<p><span class="line" data-startTime="4706">And then I'll hand </span><span class="line" data-startTime="4706">it to my wife. </span> <span class="line" data-startTime="4708">And the very first thing </span><span class="line" data-startTime="4708">she does is break it. </span> <span class="line" data-startTime="4710">She'll double-tap </span><span class="line" data-startTime="4710">on things you're not </span><span class="line" data-startTime="4711">supposed to double-tap on. </span> <span class="line" data-startTime="4712">She'll slide when you're </span><span class="line" data-startTime="4712">not supposed to slide. </span> <span class="line" data-startTime="4714">And it completely falls apart. </span> <span class="line" data-startTime="4717">And so the way I know that </span><span class="line" data-startTime="4717">I'm falling for test blindness </span><span class="line" data-startTime="4721">is when I show a new app </span><span class="line" data-startTime="4721">to someone new on my phone. </span> <span class="line" data-startTime="4725">And instead of handing </span><span class="line" data-startTime="4725">it to them, I load it up. </span> <span class="line" data-startTime="4729">And I show it to them. </span> <span class="line" data-startTime="4730">And I show them how I'm </span><span class="line" data-startTime="4730">interacting with it. </span> <span class="line" data-startTime="4732">Isn't this a great thing? </span><span class="line" data-startTime="4733">And I don't hand over my phone. </span> <span class="line" data-startTime="4735">And I've seen </span><span class="line" data-startTime="4735">other developers do </span><span class="line" data-startTime="4736">this too when they're </span><span class="line" data-startTime="4736">working on something, </span><span class="line" data-startTime="4737">especially when it's in beta. </span> <span class="line" data-startTime="4738">And if you're afraid to </span><span class="line" data-startTime="4738">hand over your phone, </span><span class="line" data-startTime="4740">if you try to show people it </span><span class="line" data-startTime="4740">by you interacting with it, </span><span class="line" data-startTime="4743">then you're probably </span><span class="line" data-startTime="4743">succumbing to test blindness. </span> <span class="line" data-startTime="4747">So these are the </span><span class="line" data-startTime="4747">things to avoid. </span></p>

<p><span class="line" data-startTime="4751">And there's lots of </span><span class="line" data-startTime="4751">other things to avoid. </span> <span class="line" data-startTime="4754">But it really </span><span class="line" data-startTime="4754">boils down to this. </span> <span class="line" data-startTime="4757">The only way that we're going </span><span class="line" data-startTime="4757">to compete with native apps </span><span class="line" data-startTime="4760">is through unflinching </span><span class="line" data-startTime="4760">diligence to keep crumminess out </span><span class="line" data-startTime="4764">of our apps. </span> <span class="line" data-startTime="4765">Native app developers </span><span class="line" data-startTime="4765">have it easy. </span> <span class="line" data-startTime="4767">They got it by default. </span> <span class="line" data-startTime="4768">But we have to spend every </span><span class="line" data-startTime="4768">waking minute that we're </span><span class="line" data-startTime="4770">developing a mobile </span><span class="line" data-startTime="4770">web app and make sure </span><span class="line" data-startTime="4772">that crumminess </span><span class="line" data-startTime="4772">doesn't get introduced, </span><span class="line" data-startTime="4775">because once it's there, it's </span><span class="line" data-startTime="4775">really hard to get rid of it. </span> <span class="line" data-startTime="4779">Thank you. </span> <span class="line" data-startTime="4782">One quick thing, I do have </span><span class="line" data-startTime="4782">one anecdotal postscript </span><span class="line" data-startTime="4787">that has nothing to do with </span><span class="line" data-startTime="4787">the mobile web UI performance. </span> <span class="line" data-startTime="4792">I had one slide in </span><span class="line" data-startTime="4792">here where I was </span><span class="line" data-startTime="4794">going to talk about how web </span><span class="line" data-startTime="4794">development is so easy that you </span><span class="line" data-startTime="4797">could teach my </span><span class="line" data-startTime="4797">grandmother to do it. </span></p>

<p><span class="line" data-startTime="4799">So here's my </span><span class="line" data-startTime="4799">grandmother, presumably, </span><span class="line" data-startTime="4800">rocking out in BBEdit, </span><span class="line" data-startTime="4800">listening to 5by5 podcasts. </span> <span class="line" data-startTime="4804">Actually, this is </span><span class="line" data-startTime="4804">not my grandmother. </span> <span class="line" data-startTime="4806">I had to do a Google image </span><span class="line" data-startTime="4806">search for old ladies </span><span class="line" data-startTime="4809">on a computer. </span> <span class="line" data-startTime="4810">And there's a lot of images </span><span class="line" data-startTime="4810">of old ladies on computers. </span> <span class="line" data-startTime="4813">But one really strange </span><span class="line" data-startTime="4813">phenomenon is even more </span><span class="line" data-startTime="4818">than there are old </span><span class="line" data-startTime="4818">ladies on computers, </span><span class="line" data-startTime="4819">there are a bunch of old </span><span class="line" data-startTime="4819">ladies smoking cigars. </span> <span class="line" data-startTime="4823">I don't understand </span><span class="line" data-startTime="4823">this phenomenon. </span> <span class="line" data-startTime="4826">It's all over. </span> <span class="line" data-startTime="4827">The web is filled with </span><span class="line" data-startTime="4827">old ladies smoking cigars. </span> <span class="line" data-startTime="4831">This one's my favorite. </span></p>

<p><span class="line" data-startTime="4833">It's inexplicable. </span> <span class="line" data-startTime="4834">And this may be the </span><span class="line" data-startTime="4834">Robitussin talking, </span><span class="line" data-startTime="4837">but I love that </span><span class="line" data-startTime="4837">we live in a world </span><span class="line" data-startTime="4840">where such a thing is possible. </span> <span class="line" data-startTime="4843">Thank you. </span> <span class="line" data-startTime="4843">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="4848"><span class="speakerName">Pete</span>: Thank you, Adam. </span> <span class="line" data-startTime="4850">OK. </span> <span class="line" data-startTime="4851">It's time for dinner. </span> <span class="line" data-startTime="4852">Wait. </span> <span class="line" data-startTime="4854">There is a lot of us. </span> <span class="line" data-startTime="4857">There's a small space </span><span class="line" data-startTime="4857">for getting through </span><span class="line" data-startTime="4859">to food and drinks. </span> <span class="line" data-startTime="4860">Food is on this side. </span> <span class="line" data-startTime="4863">Drinks are on this side. </span> <span class="line" data-startTime="4865">OK? </span><span class="line" data-startTime="4866">Consider taking the side you're </span><span class="line" data-startTime="4866">on to get that thing first. </span> <span class="line" data-startTime="4869">We're going to have to cooperate </span><span class="line" data-startTime="4869">to get through the food </span><span class="line" data-startTime="4873">and get everyone </span><span class="line" data-startTime="4873">through and fed. </span> <span class="line" data-startTime="4874">Also, consider that when </span><span class="line" data-startTime="4874">you're looking at portions. </span> <span class="line" data-startTime="4876">We have more food. </span> <span class="line" data-startTime="4877">But be considerate of </span><span class="line" data-startTime="4877">your fellow attendee. </span></p>

<p><span class="line" data-startTime="4879">We've got a little bit of time. </span> <span class="line" data-startTime="4882">We have 40 &mdash; so we're </span><span class="line" data-startTime="4882">meeting back here at 8:30. </span> <span class="line" data-startTime="4891">So back in your seats at 8:30. </span> <span class="line" data-startTime="4892">You can eat in here. </span> <span class="line" data-startTime="4894">You can eat out on the balcony. </span> <span class="line" data-startTime="4896">Get to it. </span> <span class="line" data-startTime="4896">[MUSIC PLAYING] </span></p>

<p class="speaker"><span class="line" data-starttime="7553"><span class="speakerName">Pete</span>: All right, everybody. </span> <span class="line" data-startTime="7558">You can find your seats. </span> <span class="line" data-startTime="7560">We're ready to begin the second </span><span class="line" data-startTime="7560">part of our show this evening. </span> <span class="line" data-startTime="7564">We've got Colt McAnlis </span><span class="line" data-startTime="7564">from Google here. </span> <span class="line" data-startTime="7566">And he's going to </span><span class="line" data-startTime="7566">be doing something, </span><span class="line" data-startTime="7568">if you've never </span><span class="line" data-startTime="7568">seen it before, it's </span><span class="line" data-startTime="7570">pretty interesting to watch. </span> <span class="line" data-startTime="7572">He's going to be looking </span><span class="line" data-startTime="7572">at other people's websites, </span><span class="line" data-startTime="7574">looking at them through </span><span class="line" data-startTime="7574">the lens of tooling that's </span><span class="line" data-startTime="7577">available in Chrome and his </span><span class="line" data-startTime="7577">expertise as a performance </span><span class="line" data-startTime="7581">expert, and look at performance </span><span class="line" data-startTime="7581">issues that are happening </span><span class="line" data-startTime="7584">and why they're happening. </span> <span class="line" data-startTime="7585">He'll tell you more about that. </span> <span class="line" data-startTime="7587">And we've also got </span><span class="line" data-startTime="7587">some stuff on mobile. </span> <span class="line" data-startTime="7589">So this should be </span><span class="line" data-startTime="7589">pretty interesting. </span> <span class="line" data-startTime="7591">So without further ado, Colt </span><span class="line" data-startTime="7591">McAnlis, Developer Advocate </span><span class="line" data-startTime="7593">at Google. </span></p>

<p><span class="line" data-startTime="7593">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="7597"><span class="speakerName">Colt McAnlis</span>: Are we good? </span><span class="line" data-startTime="7598">Test? </span><span class="line" data-startTime="7598">Can everybody hear me? </span><span class="line" data-startTime="7599">Can everyone see how bald I </span><span class="line" data-startTime="7599">am from where you're sitting? </span><span class="line" data-startTime="7603">Hands up if you can see </span><span class="line" data-startTime="7603">your reflection in my head. </span> <span class="line" data-startTime="7607">So I have a really </span><span class="line" data-startTime="7607">tough job tonight. </span> <span class="line" data-startTime="7609">My job is to try to keep </span><span class="line" data-startTime="7609">you entertained and awake </span><span class="line" data-startTime="7611">at this time of night, after </span><span class="line" data-startTime="7611">you've been fed and alcoholed. </span> <span class="line" data-startTime="7614">So I'm going to try to </span><span class="line" data-startTime="7614">do that as best I can. </span> <span class="line" data-startTime="7617">Let me introduce </span><span class="line" data-startTime="7617">myself really quickly. </span> <span class="line" data-startTime="7619">My name is Colt McAnlis. </span> <span class="line" data-startTime="7620">I'm actually the team lead </span><span class="line" data-startTime="7620">for Chrome Developer Relations </span><span class="line" data-startTime="7623">Performance. </span> <span class="line" data-startTime="7624">About a year ago in </span><span class="line" data-startTime="7624">January, we actually </span><span class="line" data-startTime="7626">identified that the web </span><span class="line" data-startTime="7626">performance community </span><span class="line" data-startTime="7630">was good and doing well. </span> <span class="line" data-startTime="7632">But we didn't have </span><span class="line" data-startTime="7632">someone focused </span><span class="line" data-startTime="7633">on bringing the message </span><span class="line" data-startTime="7633">to people constantly. </span> <span class="line" data-startTime="7636">And as talked about in the </span><span class="line" data-startTime="7636">previous talks tonight, </span><span class="line" data-startTime="7639">it's really easy to do dumb, </span><span class="line" data-startTime="7639">slow things on the web. </span></p>

<p><span class="line" data-startTime="7641">And one of the first things </span><span class="line" data-startTime="7641">we need to do with that </span><span class="line" data-startTime="7643">is fix it with education. </span> <span class="line" data-startTime="7645">So we defined from the </span><span class="line" data-startTime="7645">beginning that after looking </span><span class="line" data-startTime="7648">at all the education and </span><span class="line" data-startTime="7648">looking at everything out there, </span><span class="line" data-startTime="7651">they're really three </span><span class="line" data-startTime="7651">pillars of web performance. </span> <span class="line" data-startTime="7654">Up until now, the web </span><span class="line" data-startTime="7654">as a whole has really </span><span class="line" data-startTime="7657">only focused on one of them. </span> <span class="line" data-startTime="7658">All you've heard from </span><span class="line" data-startTime="7658">most performance experts </span><span class="line" data-startTime="7661">is, how fast does </span><span class="line" data-startTime="7661">your website load? </span><span class="line" data-startTime="7663">We've all seen the </span><span class="line" data-startTime="7663">studies that show </span><span class="line" data-startTime="7664">that one millisecond of time </span><span class="line" data-startTime="7664">actually related to $10 million </span><span class="line" data-startTime="7668">of lost revenue for </span><span class="line" data-startTime="7668">site X, Y, and Z. </span></p>

<p><span class="line" data-startTime="7670">And they only really </span><span class="line" data-startTime="7670">talk about network. </span> <span class="line" data-startTime="7672">But in the modern age </span><span class="line" data-startTime="7672">of web applications, </span><span class="line" data-startTime="7675">we often tend to </span><span class="line" data-startTime="7675">neglect the other two </span><span class="line" data-startTime="7677">pillars of web performance &mdash; </span><span class="line" data-startTime="7677">rendering and compute. </span> <span class="line" data-startTime="7681">A great part of the </span><span class="line" data-startTime="7681">Forecast.io &mdash; Forecast.io? </span><span class="line" data-startTime="7687">I wanted to see if </span><span class="line" data-startTime="7687">he was listening. </span> <span class="line" data-startTime="7688">That was good. </span> <span class="line" data-startTime="7689">See? </span><span class="line" data-startTime="7690">I've got to keep you awake too. </span> <span class="line" data-startTime="7691">One of the great parts of </span><span class="line" data-startTime="7691">the Forecast talk, I believe, </span><span class="line" data-startTime="7693">was when he really said, </span><span class="line" data-startTime="7693">we have to actually solve </span><span class="line" data-startTime="7696">this problem of </span><span class="line" data-startTime="7696">rendering, because it </span><span class="line" data-startTime="7698">doesn't happen for free. </span> <span class="line" data-startTime="7699">I think the existence of </span><span class="line" data-startTime="7699">the previous type of web, </span><span class="line" data-startTime="7702">where CSS animations </span><span class="line" data-startTime="7702">weren't something you even </span><span class="line" data-startTime="7704">had availability to, allowed </span><span class="line" data-startTime="7704">us to do really stupid things. </span></p>

<p><span class="line" data-startTime="7708">And the browser </span><span class="line" data-startTime="7708">kept us really fast. </span> <span class="line" data-startTime="7709">But now, because we </span><span class="line" data-startTime="7709">contend our own yard, </span><span class="line" data-startTime="7712">we're running into </span><span class="line" data-startTime="7712">some problems there. </span> <span class="line" data-startTime="7714">So when you think </span><span class="line" data-startTime="7714">about performance, </span><span class="line" data-startTime="7715">you should know that </span><span class="line" data-startTime="7715">network render and compute, </span><span class="line" data-startTime="7717">you can have problems </span><span class="line" data-startTime="7717">in all three of these. </span> <span class="line" data-startTime="7719">And much like Jake said </span><span class="line" data-startTime="7719">earlier, a huge problem </span><span class="line" data-startTime="7723">in one of these </span><span class="line" data-startTime="7723">portions can actually </span><span class="line" data-startTime="7724">cloud out issues that are </span><span class="line" data-startTime="7724">happening in the other two. </span></p>

<p><span class="line" data-startTime="7727">So as you're going through your </span><span class="line" data-startTime="7727">process of finding performance </span><span class="line" data-startTime="7729">issues in your website, </span><span class="line" data-startTime="7729">you need to make sure </span><span class="line" data-startTime="7732">that you're evaluating </span><span class="line" data-startTime="7732">all three of these </span><span class="line" data-startTime="7733">with the right tools </span><span class="line" data-startTime="7733">at the right time. </span> <span class="line" data-startTime="7735">And what I'm going </span><span class="line" data-startTime="7735">to do tonight is </span><span class="line" data-startTime="7737">I'm going to try to walk you </span><span class="line" data-startTime="7737">through some of the sites </span><span class="line" data-startTime="7739">that you've submitted &mdash; </span><span class="line" data-startTime="7739">ha, ha, ha, ha, ha &mdash; </span><span class="line" data-startTime="7741">and, hopefully, bruise </span><span class="line" data-startTime="7741">your ego a little bit. </span></p>

<p><span class="line" data-startTime="7744">No offense. </span> <span class="line" data-startTime="7745">It's what we all have to do. </span> <span class="line" data-startTime="7746">Quite frankly, I think one </span><span class="line" data-startTime="7746">of the big things we've </span><span class="line" data-startTime="7748">been trying to do with </span><span class="line" data-startTime="7748">the web performance </span><span class="line" data-startTime="7750">movement over the </span><span class="line" data-startTime="7750">past year is actually </span><span class="line" data-startTime="7752">bruise a lot of egos in the web, </span><span class="line" data-startTime="7752">because we're all programmers. </span> <span class="line" data-startTime="7755">We're all smart. </span> <span class="line" data-startTime="7756">We're too smart, quite frankly. </span> <span class="line" data-startTime="7757">And we've got to be taken </span><span class="line" data-startTime="7757">down a peg, because we all </span><span class="line" data-startTime="7760">know in here, everyone in here, </span><span class="line" data-startTime="7760">think about your coworkers. </span> <span class="line" data-startTime="7763">And think about what </span><span class="line" data-startTime="7763">really motivates them. </span> <span class="line" data-startTime="7765">99% of the time, if you </span><span class="line" data-startTime="7765">can bruise their ego </span><span class="line" data-startTime="7768">or challenge them or tell </span><span class="line" data-startTime="7768">them they're not good enough </span><span class="line" data-startTime="7770">or the problem is </span><span class="line" data-startTime="7770">too hard, that's </span><span class="line" data-startTime="7771">what actually gets </span><span class="line" data-startTime="7771">them to move, right? </span></p>

<p class="speaker"><span class="line" data-starttime="7773"><span class="speakerName">Audience</span>: Or if </span><span class="line" data-startTime="7773">you pay them more. </span></p>

<p class="speaker"><span class="line" data-starttime="7775"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="7776">Maybe, maybe, maybe. </span> <span class="line" data-startTime="7778">If you've got Yankees </span><span class="line" data-startTime="7778">money, I guess so. </span> <span class="line" data-startTime="7781">So this is the loop. </span> <span class="line" data-startTime="7782">So this is what you </span><span class="line" data-startTime="7782">should all be thinking of. </span> <span class="line" data-startTime="7784">Now, I've got about 10 years </span><span class="line" data-startTime="7784">of game development background </span><span class="line" data-startTime="7787">under my belt. </span> <span class="line" data-startTime="7788">I'm a C++ programmer at heart. </span> <span class="line" data-startTime="7789">And I'm trying to apply </span><span class="line" data-startTime="7789">a lot of the lessons we </span><span class="line" data-startTime="7791">use in game development </span><span class="line" data-startTime="7791">to web development, </span><span class="line" data-startTime="7793">because, in reality, we're both </span><span class="line" data-startTime="7793">dealing with real-time media </span><span class="line" data-startTime="7796">interfaces. </span> <span class="line" data-startTime="7797">So when you guys say, </span><span class="line" data-startTime="7797">how fast can something </span><span class="line" data-startTime="7799">load off an internet site? </span><span class="line" data-startTime="7800">I'm thinking, how fast can that </span><span class="line" data-startTime="7800">stuff be streamed off a DVD? </span><span class="line" data-startTime="7803">It's the same problem we've </span><span class="line" data-startTime="7803">had, just 10 years later. </span> <span class="line" data-startTime="7806">So when you're doing </span><span class="line" data-startTime="7806">your performance, </span><span class="line" data-startTime="7808">the main thing that you have to </span><span class="line" data-startTime="7808">do is follow these three steps. </span></p>

<p><span class="line" data-startTime="7810">The first thing is you </span><span class="line" data-startTime="7810">need to gather information. </span> <span class="line" data-startTime="7812">You go open up Chrome DevTools. </span> <span class="line" data-startTime="7813">You open up webpagetest.org. </span> <span class="line" data-startTime="7816">This gives you information about </span><span class="line" data-startTime="7816">what is going on in your page. </span> <span class="line" data-startTime="7820">From that you </span><span class="line" data-startTime="7820">actually need insight. </span> <span class="line" data-startTime="7821">Because, really, what's a whole </span><span class="line" data-startTime="7821">sheet of floating point numbers </span><span class="line" data-startTime="7824">mean to you? </span><span class="line" data-startTime="7825">Nothing, right? </span><span class="line" data-startTime="7825">You need to know what those </span><span class="line" data-startTime="7825">floating point numbers mean. </span> <span class="line" data-startTime="7827">And your tooling </span><span class="line" data-startTime="7827">system needs to be </span><span class="line" data-startTime="7829">able to infer what those </span><span class="line" data-startTime="7829">floating point numbers mean. </span> <span class="line" data-startTime="7831">And then once you </span><span class="line" data-startTime="7831">have that insight, </span><span class="line" data-startTime="7832">you need to be able to </span><span class="line" data-startTime="7832">actually plan an action. </span> <span class="line" data-startTime="7834">You have this data. </span> <span class="line" data-startTime="7835">You have to then </span><span class="line" data-startTime="7835">go to your manager </span><span class="line" data-startTime="7836">and justify, please, let </span><span class="line" data-startTime="7836">me spend two weeks fixing </span><span class="line" data-startTime="7840">seven milliseconds of load </span><span class="line" data-startTime="7840">time from our website, </span><span class="line" data-startTime="7843">because it matters. </span></p>

<p><span class="line" data-startTime="7844">And then you need to be able </span><span class="line" data-startTime="7844">to repeat this constantly, </span><span class="line" data-startTime="7846">constantly, constantly. </span> <span class="line" data-startTime="7847">You need continuous </span><span class="line" data-startTime="7847">integration tools. </span> <span class="line" data-startTime="7848">You need the ability </span><span class="line" data-startTime="7848">to actually track down </span><span class="line" data-startTime="7851">whose check-in broke the build. </span> <span class="line" data-startTime="7854">Quick show of hands. </span> <span class="line" data-startTime="7855">How many of you in </span><span class="line" data-startTime="7855">here actually have </span><span class="line" data-startTime="7856">some continuous </span><span class="line" data-startTime="7856">integration for performance </span><span class="line" data-startTime="7858">in your suite right now? </span><span class="line" data-startTime="7860">One, two, three, four, five. </span> <span class="line" data-startTime="7863">Wait. </span> <span class="line" data-startTime="7864">Were you just showing </span><span class="line" data-startTime="7864">me your Pepsi can? </span><span class="line" data-startTime="7866">I mean, it's a cool can. </span> <span class="line" data-startTime="7869">Bravo. </span> <span class="line" data-startTime="7871">So maybe four, maybe </span><span class="line" data-startTime="7871">five of an entire room. </span> <span class="line" data-startTime="7873">I've asked this question to </span><span class="line" data-startTime="7873">probably about 3,000 developers </span><span class="line" data-startTime="7877">this week while I've </span><span class="line" data-startTime="7877">been in New York </span><span class="line" data-startTime="7878">and meeting and giving talks. </span></p>

<p><span class="line" data-startTime="7880">And the total number of </span><span class="line" data-startTime="7880">people is close to about 15 </span><span class="line" data-startTime="7883">with the five in this room. </span> <span class="line" data-startTime="7885">This shows that there's a huge </span><span class="line" data-startTime="7885">problem in the web community </span><span class="line" data-startTime="7888">is that we're not actually </span><span class="line" data-startTime="7888">testing for performance </span><span class="line" data-startTime="7890">and giving it the gravitas that </span><span class="line" data-startTime="7890">we are our features and our CSS </span><span class="line" data-startTime="7893">and those pretty </span><span class="line" data-startTime="7893">little bubbly items </span><span class="line" data-startTime="7895">everywhere else on our pages. </span> <span class="line" data-startTime="7896">This is why we </span><span class="line" data-startTime="7896">actually moved forward </span><span class="line" data-startTime="7898">with trying to build a </span><span class="line" data-startTime="7898">better community about this. </span> <span class="line" data-startTime="7900">So for you in the audience, </span><span class="line" data-startTime="7900">this is the only slide </span><span class="line" data-startTime="7902">I want you to take </span><span class="line" data-startTime="7902">away from today. </span> <span class="line" data-startTime="7904">Burn this into your retina. </span> <span class="line" data-startTime="7905">Tweet it. </span> <span class="line" data-startTime="7906">Blog it. </span> <span class="line" data-startTime="7906">Get a tattoo of it. </span> <span class="line" data-startTime="7907">If you get a tattoo </span><span class="line" data-startTime="7907">if it, tweet it to me. </span> <span class="line" data-startTime="7908">And I'll send you some swag. </span> <span class="line" data-startTime="7909">Please don't get a tattoo. </span></p>

<p><span class="line" data-startTime="7911">Anything I say is </span><span class="line" data-startTime="7911">not representative </span><span class="line" data-startTime="7912">of any organization or </span><span class="line" data-startTime="7912">Google or the lawyers that </span><span class="line" data-startTime="7915">are affiliated with me. </span> <span class="line" data-startTime="7916">All comments are my own. </span> <span class="line" data-startTime="7917">Please do not get a tattoo. </span> <span class="line" data-startTime="7920">First off, if you're </span><span class="line" data-startTime="7920">doing performance, </span><span class="line" data-startTime="7921">go to HTML5rocks.com. </span> <span class="line" data-startTime="7923">There's a landing page. </span> <span class="line" data-startTime="7924">It's called performance. </span> <span class="line" data-startTime="7925">You click on the button. </span> <span class="line" data-startTime="7926">I'm actually the guy </span><span class="line" data-startTime="7926">that maintains that page. </span> <span class="line" data-startTime="7929">If you start there, </span><span class="line" data-startTime="7929">it's going to walk you </span><span class="line" data-startTime="7931">through the three pillars </span><span class="line" data-startTime="7931">of web performance. </span> <span class="line" data-startTime="7933">You're going to be able </span><span class="line" data-startTime="7933">to go step by step on how </span><span class="line" data-startTime="7935">to find and address </span><span class="line" data-startTime="7935">the largest problems </span><span class="line" data-startTime="7938">on each one of </span><span class="line" data-startTime="7938">these three pillars. </span> <span class="line" data-startTime="7939">Next is you need to </span><span class="line" data-startTime="7939">be following and using </span><span class="line" data-startTime="7941">the perfmatters hashtag. </span></p>

<p><span class="line" data-startTime="7943">We actually started this </span><span class="line" data-startTime="7943">hashtag just earlier this year. </span> <span class="line" data-startTime="7945">And we wanted to use web perf. </span> <span class="line" data-startTime="7948">We really did. </span> <span class="line" data-startTime="7949">We wanted to use that hashtag. </span> <span class="line" data-startTime="7950">It was out there. </span> <span class="line" data-startTime="7951">But we didn't feel like </span><span class="line" data-startTime="7951">it bruised enough egos. </span> <span class="line" data-startTime="7954">We wanted perfmatters to </span><span class="line" data-startTime="7954">be this name, this brand, </span><span class="line" data-startTime="7957">this answer to a question. </span> <span class="line" data-startTime="7959">And what we saw was, </span><span class="line" data-startTime="7959">very quickly, people </span><span class="line" data-startTime="7961">started hosting links </span><span class="line" data-startTime="7961">to their friends </span><span class="line" data-startTime="7963">websites and be </span><span class="line" data-startTime="7963">like, yo, dude, why </span><span class="line" data-startTime="7965">does it takes 15 seconds </span><span class="line" data-startTime="7965">to load your site? </span><span class="line" data-startTime="7967">Perfmatters. </span> <span class="line" data-startTime="7968">We wanted it to be something </span><span class="line" data-startTime="7968">you could take to your manager </span><span class="line" data-startTime="7971">and say, hey, it </span><span class="line" data-startTime="7971">takes 15 seconds </span><span class="line" data-startTime="7972">for our site to load on mobile. </span> <span class="line" data-startTime="7974">Perfmatters. </span> <span class="line" data-startTime="7975">We want this to be a badge. </span> <span class="line" data-startTime="7977">We are all egotistical </span><span class="line" data-startTime="7977">programmers. </span></p>

<p><span class="line" data-startTime="7979">Wear the badge. </span> <span class="line" data-startTime="7981">Own the sticker. </span> <span class="line" data-startTime="7983">Make it a part of your culture. </span> <span class="line" data-startTime="7984">Make it a part of </span><span class="line" data-startTime="7984">your environment. </span> <span class="line" data-startTime="7986">That's what we want. </span> <span class="line" data-startTime="7986">We want attitude in that. </span> <span class="line" data-startTime="7988">That's why you should </span><span class="line" data-startTime="7988">follow that hashtag. </span> <span class="line" data-startTime="7989">Finally, check out the G+ </span><span class="line" data-startTime="7989">web performance community. </span> <span class="line" data-startTime="7993">If you're in Google+, </span><span class="line" data-startTime="7993">it's a cool place. </span> <span class="line" data-startTime="7994">A lot of cool people </span><span class="line" data-startTime="7994">hang out there. </span> <span class="line" data-startTime="7995">Some of them are bald. </span> <span class="line" data-startTime="7996">Some of them post content. </span> <span class="line" data-startTime="7997">I'm not saying who. </span></p>

<p><span class="line" data-startTime="7999">But you need to follow </span><span class="line" data-startTime="7999">that, because, really, </span><span class="line" data-startTime="8000">if you combine perfmatters with </span><span class="line" data-startTime="8000">the Google+ web performance </span><span class="line" data-startTime="8003">communities and the articles </span><span class="line" data-startTime="8003">coming through HTML5rocks, </span><span class="line" data-startTime="8006">you're actually going to find </span><span class="line" data-startTime="8006">an overflow of information. </span> <span class="line" data-startTime="8008">I bet most of you in here </span><span class="line" data-startTime="8008">haven't actually dived into &mdash; </span><span class="line" data-startTime="8011">Here. </span> <span class="line" data-startTime="8012">We'll do this. </span> <span class="line" data-startTime="8012">We'll do this. </span> <span class="line" data-startTime="8013">Put your hand up if you've </span><span class="line" data-startTime="8013">read more than five articles </span><span class="line" data-startTime="8018">about performance. </span> <span class="line" data-startTime="8020">OK. </span> <span class="line" data-startTime="8021">Keep your hands up. </span> <span class="line" data-startTime="8021">Keep your hands up. </span> <span class="line" data-startTime="8022">More than 10 articles? </span><span class="line" data-startTime="8024">OK. </span> <span class="line" data-startTime="8024">Let's ramp this exponentially. </span> <span class="line" data-startTime="8026">20? </span><span class="line" data-startTime="8030">28? </span><span class="line" data-startTime="8033">Let's go 40 articles </span><span class="line" data-startTime="8033">on performance. </span></p>

<p><span class="line" data-startTime="8036">OK. </span> <span class="line" data-startTime="8038">For those of you who </span><span class="line" data-startTime="8038">have had your hands up, </span><span class="line" data-startTime="8039">of those 40 articles, </span><span class="line" data-startTime="8039">how many of those </span><span class="line" data-startTime="8041">things did you implement? </span><span class="line" data-startTime="8042">Maybe 5, 6, 20? </span><span class="line" data-startTime="8044">No fair if you actually </span><span class="line" data-startTime="8044">did a talk earlier tonight. </span> <span class="line" data-startTime="8048">I'm not taking your input. </span> <span class="line" data-startTime="8049">So the point that </span><span class="line" data-startTime="8049">we're getting at though </span><span class="line" data-startTime="8050">is that for those of you </span><span class="line" data-startTime="8050">who haven't been reading </span><span class="line" data-startTime="8052">a lot of this content, </span><span class="line" data-startTime="8052">there is actually </span><span class="line" data-startTime="8053">going to be overflow </span><span class="line" data-startTime="8053">of information. </span> <span class="line" data-startTime="8054">Hopefully, you can find it. </span> <span class="line" data-startTime="8055">You can guide it. </span> <span class="line" data-startTime="8056">You can move through it. </span> <span class="line" data-startTime="8057">What's the next one? </span><span class="line" data-startTime="8058">Yeah. </span> <span class="line" data-startTime="8058">So what I'm going to do now </span><span class="line" data-startTime="8058">is with the rest of the time &mdash; </span><span class="line" data-startTime="8061">Pete, how much time do we have? </span><span class="line" data-startTime="8062">40, 60, as much as I want? </span><span class="line" data-startTime="8063">Keep talking until </span><span class="line" data-startTime="8063">people fall asleep. </span> <span class="line" data-startTime="8065">Good. </span> <span class="line" data-startTime="8066">I can do that. </span> <span class="line" data-startTime="8067">So what we're going to do </span><span class="line" data-startTime="8067">is I'm actually only going </span><span class="line" data-startTime="8069">to load these </span><span class="line" data-startTime="8069">websites on mobile. </span></p>

<p><span class="line" data-startTime="8071">Quite frankly, I ran </span><span class="line" data-startTime="8071">through these earlier today. </span> <span class="line" data-startTime="8073">And most of your sites actually </span><span class="line" data-startTime="8073">fell over dead on mobile. </span> <span class="line" data-startTime="8077">There were some interesting </span><span class="line" data-startTime="8077">use cases on desktop. </span> <span class="line" data-startTime="8079">But quite frankly, </span><span class="line" data-startTime="8079">desktop is dead. </span> <span class="line" data-startTime="8081">If you're not making your </span><span class="line" data-startTime="8081">site mobile and friendly </span><span class="line" data-startTime="8083">and fast there, you're </span><span class="line" data-startTime="8083">doing it wrong, period. </span> <span class="line" data-startTime="8085">Period, period, period. </span> <span class="line" data-startTime="8086">Mobile is all that matters </span><span class="line" data-startTime="8086">right now. #perfmatters. </span> <span class="line" data-startTime="8089">You can tweet that. </span> <span class="line" data-startTime="8090">I'll give you a second. </span> <span class="line" data-startTime="8092">No, go ahead. </span> <span class="line" data-startTime="8093">It's OK. #perfmatters. </span> <span class="line" data-startTime="8094">So we're going to take a look at </span><span class="line" data-startTime="8094">a couple of these really quick. </span></p>

<p><span class="line" data-startTime="8097">And I'm going to try to organize </span><span class="line" data-startTime="8097">these in terms of discussion </span><span class="line" data-startTime="8101">and pointing out </span><span class="line" data-startTime="8101">a couple things. </span> <span class="line" data-startTime="8102">So if we don't get to </span><span class="line" data-startTime="8102">all of them, I apologize. </span> <span class="line" data-startTime="8104">Please feel free to email </span><span class="line" data-startTime="8104">me later and curse at me. </span> <span class="line" data-startTime="8107">Or do it on social media. </span> <span class="line" data-startTime="8108">That's always fun too. </span> <span class="line" data-startTime="8109">So what I've got here </span><span class="line" data-startTime="8109">is a little setup. </span> <span class="line" data-startTime="8110">And you can actually </span><span class="line" data-startTime="8110">see my little phone, </span><span class="line" data-startTime="8112">so I can click on some stuff. </span> <span class="line" data-startTime="8114">And what I'm using over here is </span><span class="line" data-startTime="8114">the Chrome Developer Tools ADB </span><span class="line" data-startTime="8117">extension. </span> <span class="line" data-startTime="8118">So this is a fantastic </span><span class="line" data-startTime="8118">little &mdash; who's using this? </span><span class="line" data-startTime="8121">Anyone using this? </span><span class="line" data-startTime="8122">No fair if you're </span><span class="line" data-startTime="8122">hosting the event, dude. </span></p>

<p><span class="line" data-startTime="8125">God. </span> <span class="line" data-startTime="8126">You guys are cheating. </span> <span class="line" data-startTime="8127">So this is a fantastic </span><span class="line" data-startTime="8127">Chrome extension. </span> <span class="line" data-startTime="8129">You go to the Chrome Web Store. </span> <span class="line" data-startTime="8130">You can actually download </span><span class="line" data-startTime="8130">and install this extension. </span> <span class="line" data-startTime="8132">Basically, what it </span><span class="line" data-startTime="8132">allows you to do </span><span class="line" data-startTime="8132">is to interface with the </span><span class="line" data-startTime="8132">Android developer tools </span><span class="line" data-startTime="8135">very easily and quickly. </span> <span class="line" data-startTime="8136">So I can actually click on this </span><span class="line" data-startTime="8136">and go view inspection targets. </span> <span class="line" data-startTime="8139">And you'll actually see that it </span><span class="line" data-startTime="8139">loads and shows me this Galaxy </span><span class="line" data-startTime="8143">Nexus phone that's actually </span><span class="line" data-startTime="8143">plugged in right here. </span> <span class="line" data-startTime="8145">And I can actually click &mdash; </span><span class="line" data-startTime="8145">well, I'll close this, </span><span class="line" data-startTime="8147">so you can actually see </span><span class="line" data-startTime="8147">what this looks like. </span> <span class="line" data-startTime="8149">I can click the inspect button. </span></p>

<p><span class="line" data-startTime="8151">And what this inspect </span><span class="line" data-startTime="8151">button shows is </span><span class="line" data-startTime="8153">it actually shows me what's </span><span class="line" data-startTime="8153">on my phone right now. </span> <span class="line" data-startTime="8157">So this one of the sites. </span> <span class="line" data-startTime="8159">I'll get to it in a little </span><span class="line" data-startTime="8159">bit deeper here in a minute. </span> <span class="line" data-startTime="8161">But this is actually </span><span class="line" data-startTime="8161">what's on the phone. </span> <span class="line" data-startTime="8163">You can see it's moving. </span> <span class="line" data-startTime="8164">It's scrolling. </span> <span class="line" data-startTime="8165">It's doing stuff. </span> <span class="line" data-startTime="8165">We go over here. </span> <span class="line" data-startTime="8166">And you can actually </span><span class="line" data-startTime="8166">see the network. </span> <span class="line" data-startTime="8167">So if I hit reload </span><span class="line" data-startTime="8167">on my phone, you </span><span class="line" data-startTime="8170">can actually see the network </span><span class="line" data-startTime="8170">request coming through. </span> <span class="line" data-startTime="8172">This is not the desktop site. </span> <span class="line" data-startTime="8173">This is actually a mobile site. </span></p>

<p><span class="line" data-startTime="8174">This is really good, because I'm </span><span class="line" data-startTime="8174">actually testing on the device </span><span class="line" data-startTime="8177">that my users are using. </span> <span class="line" data-startTime="8179">Wow. </span> <span class="line" data-startTime="8180">Great comment. </span> <span class="line" data-startTime="8181">#perfmatters. </span> <span class="line" data-startTime="8183">One of you will </span><span class="line" data-startTime="8183">tweet it tonight. </span> <span class="line" data-startTime="8184">It will happen. </span> <span class="line" data-startTime="8185">I'll keep drilling it into you. </span> <span class="line" data-startTime="8187">But the cool thing </span><span class="line" data-startTime="8187">is you can actually </span><span class="line" data-startTime="8188">see what's going on here. </span> <span class="line" data-startTime="8190">And notice, for this </span><span class="line" data-startTime="8190">particular website, </span><span class="line" data-startTime="8192">that it's actually </span><span class="line" data-startTime="8192">not done loading yet. </span> <span class="line" data-startTime="8194">You can still see the bar </span><span class="line" data-startTime="8194">moving on the side over there. </span> <span class="line" data-startTime="8197">And the funny thing is if you </span><span class="line" data-startTime="8197">load this site in desktop, </span><span class="line" data-startTime="8200">you don't see that same problem. </span> <span class="line" data-startTime="8201">So obviously, there's </span><span class="line" data-startTime="8201">an issue on the mobile </span><span class="line" data-startTime="8203">that is not showing </span><span class="line" data-startTime="8203">up on the desktop. </span></p>

<p><span class="line" data-startTime="8205">Again, we need to make sure that </span><span class="line" data-startTime="8205">we're testing things properly. </span> <span class="line" data-startTime="8208">But the cool thing </span><span class="line" data-startTime="8208">is we can actually </span><span class="line" data-startTime="8209">see all the same </span><span class="line" data-startTime="8209">events, use the dev </span><span class="line" data-startTime="8211">tools in the same way minus </span><span class="line" data-startTime="8211">everything crashing because </span><span class="line" data-startTime="8214">of memory issues, which </span><span class="line" data-startTime="8214">might happen tonight. </span> <span class="line" data-startTime="8216">I apologize for the live feed. </span> <span class="line" data-startTime="8218">But we can actually go through </span><span class="line" data-startTime="8218">here and just record memory </span><span class="line" data-startTime="8221">and see what's </span><span class="line" data-startTime="8221">going on in memory. </span> <span class="line" data-startTime="8223">And so let me show </span><span class="line" data-startTime="8223">you over here. </span> <span class="line" data-startTime="8224">I can go through and actually </span><span class="line" data-startTime="8224">scroll and go back and actually </span><span class="line" data-startTime="8227">see how memory is adjusting </span><span class="line" data-startTime="8227">based on this stuff. </span> <span class="line" data-startTime="8229">So if you haven't adopted </span><span class="line" data-startTime="8229">this Chrome ADB extension </span><span class="line" data-startTime="8233">into your tooling </span><span class="line" data-startTime="8233">and your testing, </span><span class="line" data-startTime="8234">you need to definitely do this. </span> <span class="line" data-startTime="8236">Definitely get </span><span class="line" data-startTime="8236">this in your stuff, </span><span class="line" data-startTime="8237">because no other tool allows </span><span class="line" data-startTime="8237">you this sort of integration. </span> <span class="line" data-startTime="8240">And Chrome Dev Tools are </span><span class="line" data-startTime="8240">already top of the line. </span> <span class="line" data-startTime="8242">It should be part of it. </span></p>

<p><span class="line" data-startTime="8243">So anyhow, enough </span><span class="line" data-startTime="8243">of me babbling. </span> <span class="line" data-startTime="8245">So let's start with one </span><span class="line" data-startTime="8245">of the first sites here. </span> <span class="line" data-startTime="8248">Clicky, clicky. </span> <span class="line" data-startTime="8249">There's a native app for you. </span> <span class="line" data-startTime="8251">Slow in loading. </span> <span class="line" data-startTime="8254">Forecast.io? </span><span class="line" data-startTime="8256">I'll get it right. </span> <span class="line" data-startTime="8257">Sorry. </span> <span class="line" data-startTime="8258">So we're going to try this </span><span class="line" data-startTime="8258">first one here, allout.org. </span> <span class="line" data-startTime="8261">This was submitted. </span> <span class="line" data-startTime="8262">Someone in the room </span><span class="line" data-startTime="8262">submitted this. </span> <span class="line" data-startTime="8263">I don't know who it is. </span></p>

<p><span class="line" data-startTime="8264">Doesn't matter. </span> <span class="line" data-startTime="8265">But we're going to take </span><span class="line" data-startTime="8265">a look at your site. </span> <span class="line" data-startTime="8266">And hopefully, we're </span><span class="line" data-startTime="8266">going to make you upset. </span> <span class="line" data-startTime="8267">So this is loading. </span> <span class="line" data-startTime="8269">I'm going to show you what </span><span class="line" data-startTime="8269">the page looks like first. </span> <span class="line" data-startTime="8272">So first off, we all </span><span class="line" data-startTime="8272">just watched it load. </span> <span class="line" data-startTime="8274">This is on a 4G connection. </span> <span class="line" data-startTime="8275">I'm not on the local Wi-Fi. </span> <span class="line" data-startTime="8277">We can see that this actually </span><span class="line" data-startTime="8277">is not a mobile site. </span> <span class="line" data-startTime="8284">I shouldn't have to scroll. </span> <span class="line" data-startTime="8286">Oh, I can zoom. </span> <span class="line" data-startTime="8287">Yay. </span> <span class="line" data-startTime="8288">But most of the site </span><span class="line" data-startTime="8288">is actually eclipsed. </span> <span class="line" data-startTime="8291">We've got some sort of </span><span class="line" data-startTime="8291">spinner here at the top. </span></p>

<p><span class="line" data-startTime="8293">It's a marquee movement. </span> <span class="line" data-startTime="8295">We've got some other items </span><span class="line" data-startTime="8295">down here on the bottom. </span> <span class="line" data-startTime="8298">Some stuff's going on. </span> <span class="line" data-startTime="8299">So let's take a </span><span class="line" data-startTime="8299">look at what that </span><span class="line" data-startTime="8299">looks like in Chrome Dev Tools. </span> <span class="line" data-startTime="8301">So I can go here. </span> <span class="line" data-startTime="8302">Click inspect. </span> <span class="line" data-startTime="8306">Again, native </span><span class="line" data-startTime="8306">applications &mdash; they're slow. </span> <span class="line" data-startTime="8308">So let's go to the Network tab. </span> <span class="line" data-startTime="8310">And I want to take a look </span><span class="line" data-startTime="8310">at how this thing loads. </span> <span class="line" data-startTime="8312">So I'm going to </span><span class="line" data-startTime="8312">hit reload again. </span> <span class="line" data-startTime="8313">And we're going to watch </span><span class="line" data-startTime="8313">all the assets come through. </span> <span class="line" data-startTime="8316">And notice here </span><span class="line" data-startTime="8316">on the bottom here </span><span class="line" data-startTime="8317">you can see six </span><span class="line" data-startTime="8317">requests, 12 requests. </span> <span class="line" data-startTime="8319">I'll keep scrolling down to </span><span class="line" data-startTime="8319">the bottom so you can see that. </span> <span class="line" data-startTime="8323">Seven seconds worth of load time </span><span class="line" data-startTime="8323">before it's actually loaded. </span> <span class="line" data-startTime="8325">So this down here on </span><span class="line" data-startTime="8325">the bottom tells us </span><span class="line" data-startTime="8327">that it took about six </span><span class="line" data-startTime="8327">seconds before content </span><span class="line" data-startTime="8330">complete was actually </span><span class="line" data-startTime="8330">issued, before the page load </span><span class="line" data-startTime="8332">event occurred and </span><span class="line" data-startTime="8332">7.9 seconds total. </span></p>

<p><span class="line" data-startTime="8335">8K actually came up. </span> <span class="line" data-startTime="8336">Nope. </span> <span class="line" data-startTime="8337">We're still not done. </span> <span class="line" data-startTime="8338">9K came through, pardon me. </span> <span class="line" data-startTime="8340">And so 34 requests. </span> <span class="line" data-startTime="8341">We can actually see the </span><span class="line" data-startTime="8341">health of this object </span><span class="line" data-startTime="8343">and the health of this site. </span> <span class="line" data-startTime="8344">Now, 34 requests, </span><span class="line" data-startTime="8344">that's actually nothing. </span> <span class="line" data-startTime="8346">9K, that's a drop in the bucket. </span> <span class="line" data-startTime="8348">The Robitussin-laced </span><span class="line" data-startTime="8348">grandmother picture from earlier </span><span class="line" data-startTime="8351">could easily load </span><span class="line" data-startTime="8351">9K very quickly. </span> <span class="line" data-startTime="8353">What's important here though, </span><span class="line" data-startTime="8353">and I want to show you this, </span><span class="line" data-startTime="8355">is when we go up here and </span><span class="line" data-startTime="8355">actually sort by size, </span><span class="line" data-startTime="8358">we actually get </span><span class="line" data-startTime="8358">a different sense </span><span class="line" data-startTime="8359">of the content that's </span><span class="line" data-startTime="8359">being sent around. </span> <span class="line" data-startTime="8365">So we can actually </span><span class="line" data-startTime="8365">see the images loaded. </span> <span class="line" data-startTime="8367">We can actually see that most </span><span class="line" data-startTime="8367">of the large assets here, 6.4K, </span><span class="line" data-startTime="8370">512 bytes. </span></p>

<p><span class="line" data-startTime="8372">We can see that the </span><span class="line" data-startTime="8372">large images here. </span> <span class="line" data-startTime="8375">This is actually </span><span class="line" data-startTime="8375">interesting to me. </span> <span class="line" data-startTime="8376">So this is a 1,024 by 576. </span> <span class="line" data-startTime="8380">It's 213K. </span> <span class="line" data-startTime="8383">Quick round of applause. </span> <span class="line" data-startTime="8384">Who thinks that's too </span><span class="line" data-startTime="8384">large for a mobile site? </span><span class="line" data-startTime="8387">[APPLAUSE] </span><span class="line" data-startTime="8388">COLT MCANLIS: </span><span class="line" data-startTime="8388">Here's another one. </span> <span class="line" data-startTime="8389">Here's 109K. </span> <span class="line" data-startTime="8391">A little bit better. </span> <span class="line" data-startTime="8392">Same resolution though. </span> <span class="line" data-startTime="8393">Anyone notice that? </span><span class="line" data-startTime="8394">Same resolution, half the size. </span> <span class="line" data-startTime="8399">Another round of applause. </span> <span class="line" data-startTime="8400">Who's written a JPEG compressor? </span><span class="line" data-startTime="8402">One guy, two guys, three guys. </span></p>

<p><span class="line" data-startTime="8404">We'll get some beers later. </span> <span class="line" data-startTime="8406">And we'll talk about </span><span class="line" data-startTime="8406">DCT coefficients. </span> <span class="line" data-startTime="8407">I've had this really </span><span class="line" data-startTime="8407">cool idea that you </span><span class="line" data-startTime="8408">can actually &mdash; you know what? </span><span class="line" data-startTime="8410">Never mind. </span> <span class="line" data-startTime="8410">So notice, though, that </span><span class="line" data-startTime="8410">this image actually </span><span class="line" data-startTime="8412">has a lot more data to it. </span> <span class="line" data-startTime="8414">There's a lot more edges. </span> <span class="line" data-startTime="8415">There's a lot more </span><span class="line" data-startTime="8415">noise to the image. </span> <span class="line" data-startTime="8417">Yet it's smaller </span><span class="line" data-startTime="8417">than this one here. </span> <span class="line" data-startTime="8418">This is actually mostly pink. </span> <span class="line" data-startTime="8420">There's no reason that </span><span class="line" data-startTime="8420">the image with more detail </span><span class="line" data-startTime="8422">should be less size than the </span><span class="line" data-startTime="8422">one with less detail in it. </span> <span class="line" data-startTime="8426">What this tells &mdash; I know </span><span class="line" data-startTime="8426">nothing about these developers. </span> <span class="line" data-startTime="8428">I know nothing about the site. </span> <span class="line" data-startTime="8429">But this tells me that </span><span class="line" data-startTime="8429">they're not actually </span><span class="line" data-startTime="8431">exporting this particular image </span><span class="line" data-startTime="8431">with the right compression </span><span class="line" data-startTime="8433">settings. </span> <span class="line" data-startTime="8434">So I like doing these </span><span class="line" data-startTime="8434">polls, because it's late. </span></p>

<p><span class="line" data-startTime="8437">And I need you all entertained. </span> <span class="line" data-startTime="8439">So how many of you </span><span class="line" data-startTime="8439">actually just export </span><span class="line" data-startTime="8442">your images at some </span><span class="line" data-startTime="8442">constant format? </span><span class="line" data-startTime="8444">When you do an export from </span><span class="line" data-startTime="8444">a JPEG it's on 12 or 80 </span><span class="line" data-startTime="8447">depending on what you're doing? </span><span class="line" data-startTime="8451">Everyone else hand optimizes </span><span class="line" data-startTime="8451">your exact perfect PSNR </span><span class="line" data-startTime="8456">relationship for your JPEG? </span><span class="line" data-startTime="8458">Yes? </span><span class="line" data-startTime="8459">Is that what I'm hearing? </span><span class="line" data-startTime="8460">Because I saw three hands. </span> <span class="line" data-startTime="8461">So either you're all </span><span class="line" data-startTime="8461">lying to each other. </span> <span class="line" data-startTime="8463">Or you have no idea the way that </span><span class="line" data-startTime="8463">your images &mdash; Round of applause </span><span class="line" data-startTime="8466">for no idea of the </span><span class="line" data-startTime="8466">compression quality. </span> <span class="line" data-startTime="8467">[APPLAUSE] </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="8468"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="8469">Fantastic. </span> <span class="line" data-startTime="8470">So seeing this site </span><span class="line" data-startTime="8470">actually tells us </span><span class="line" data-startTime="8471">that this is a systemic problem. </span> <span class="line" data-startTime="8472">And again, the 3,000 </span><span class="line" data-startTime="8472">developers I've </span><span class="line" data-startTime="8474">talked to over the past </span><span class="line" data-startTime="8474">week all see this problem. </span> <span class="line" data-startTime="8476">On a couple of </span><span class="line" data-startTime="8476">the other websites </span><span class="line" data-startTime="8477">I'm going to load </span><span class="line" data-startTime="8477">tonight, you're </span><span class="line" data-startTime="8478">going to see the show </span><span class="line" data-startTime="8478">up very prevalently, </span><span class="line" data-startTime="8480">that in general, we </span><span class="line" data-startTime="8480">as a web community </span><span class="line" data-startTime="8482">do a horrible, horrible job of </span><span class="line" data-startTime="8482">optimizing images for quality </span><span class="line" data-startTime="8487">against size. </span></p>

<p><span class="line" data-startTime="8488">Now, in reality, </span><span class="line" data-startTime="8488">this isn't something </span><span class="line" data-startTime="8490">that's that difficult. </span> <span class="line" data-startTime="8491">Most of us consider </span><span class="line" data-startTime="8491">a single-way pipe. </span> <span class="line" data-startTime="8493">We have artists or designers </span><span class="line" data-startTime="8493">that are working in a vacuum. </span> <span class="line" data-startTime="8496">They're trying to optimize </span><span class="line" data-startTime="8496">for the visual quality </span><span class="line" data-startTime="8499">of the image. </span> <span class="line" data-startTime="8499">Meanwhile, there's </span><span class="line" data-startTime="8499">bald engineers </span><span class="line" data-startTime="8501">in a corner somewhere </span><span class="line" data-startTime="8501">going, why is my site slow? </span><span class="line" data-startTime="8504">And there's this constant back </span><span class="line" data-startTime="8504">and forth between these two </span><span class="line" data-startTime="8506">camps about size of </span><span class="line" data-startTime="8506">images versus quality </span><span class="line" data-startTime="8509">of images and load </span><span class="line" data-startTime="8509">times and all the stuff. </span></p>

<p><span class="line" data-startTime="8510">Let me give you a </span><span class="line" data-startTime="8510">little word of advice. </span> <span class="line" data-startTime="8512">If any of you are able to </span><span class="line" data-startTime="8512">implement something like this, </span><span class="line" data-startTime="8514">it's very simple to spin </span><span class="line" data-startTime="8514">up an Amazon EC2 instance, </span><span class="line" data-startTime="8518">or even do this at your </span><span class="line" data-startTime="8518">desk, and actually run </span><span class="line" data-startTime="8520">a compressor, a command </span><span class="line" data-startTime="8520">line compressor, </span><span class="line" data-startTime="8522">like libjpeg or jpeg-turbo. </span> <span class="line" data-startTime="8524">By the way, jpeg-turbo </span><span class="line" data-startTime="8524">is the actual codec </span><span class="line" data-startTime="8527">that we use inside </span><span class="line" data-startTime="8527">of Chrome for JPEGs. </span> <span class="line" data-startTime="8529">And actually compress it </span><span class="line" data-startTime="8529">at various quality settings </span><span class="line" data-startTime="8531">and test the PSNR of the images. </span> <span class="line" data-startTime="8534">PSNR, for those of </span><span class="line" data-startTime="8534">you who don't know, </span><span class="line" data-startTime="8535">is Peak Signal to Noise Ratio. </span> <span class="line" data-startTime="8538">This is actually a </span><span class="line" data-startTime="8538">measurement of the amount </span><span class="line" data-startTime="8541">of noise and error that's </span><span class="line" data-startTime="8541">introduced to an image. </span></p>

<p><span class="line" data-startTime="8543">It's the blockiness </span><span class="line" data-startTime="8543">that actually </span><span class="line" data-startTime="8545">comes from the </span><span class="line" data-startTime="8545">compression format. </span> <span class="line" data-startTime="8546">We actually have a </span><span class="line" data-startTime="8546">standardization process. </span> <span class="line" data-startTime="8548">We call it PSNR. </span> <span class="line" data-startTime="8549">And that's how we compare image </span><span class="line" data-startTime="8549">compressors to each other. </span> <span class="line" data-startTime="8552">So you can actually take your </span><span class="line" data-startTime="8552">image, compress it at level 90, </span><span class="line" data-startTime="8555">see what the PSNR is. </span> <span class="line" data-startTime="8557">Compress it at 80. </span> <span class="line" data-startTime="8558">See what the PSNR is. </span> <span class="line" data-startTime="8559">70, 60, 50, 40, 30. </span> <span class="line" data-startTime="8560">If you get below 30, </span><span class="line" data-startTime="8560">you've gone too far. </span> <span class="line" data-startTime="8563">Just stop at 30. </span> <span class="line" data-startTime="8563">But the cool thing about </span><span class="line" data-startTime="8563">this is that you can actually </span><span class="line" data-startTime="8566">run 10,000, 20,000, 30,000 </span><span class="line" data-startTime="8566">images through this process </span><span class="line" data-startTime="8569">and, for each one, find </span><span class="line" data-startTime="8569">the exact right compression </span><span class="line" data-startTime="8572">value to give you a </span><span class="line" data-startTime="8572">PSNR of around 38 to 45. </span> <span class="line" data-startTime="8576">So you're not actually </span><span class="line" data-startTime="8576">just exporting </span><span class="line" data-startTime="8578">to a single compression </span><span class="line" data-startTime="8578">number, a slider </span><span class="line" data-startTime="8580">that your artists have </span><span class="line" data-startTime="8580">no idea what it does. </span></p>

<p><span class="line" data-startTime="8582">You can actually </span><span class="line" data-startTime="8582">programmatically </span><span class="line" data-startTime="8583">find this value by implementing </span><span class="line" data-startTime="8583">a simple iterative process </span><span class="line" data-startTime="8586">against the command </span><span class="line" data-startTime="8586">line compressor. </span> <span class="line" data-startTime="8587">That's kind of cool. </span> <span class="line" data-startTime="8589">Round of applause for cool? </span><span class="line" data-startTime="8590">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="8591"><span class="speakerName">Colt McAnlis</span>: I saw </span><span class="line" data-startTime="8591">some of you begrudgingly </span><span class="line" data-startTime="8593">go, that's not cool. </span> <span class="line" data-startTime="8594">Let's save the questions </span><span class="line" data-startTime="8594">for the end if that's OK, </span><span class="line" data-startTime="8596">because, otherwise, I'm </span><span class="line" data-startTime="8596">going to stare at Putin. </span> <span class="line" data-startTime="8598">And he kind of scares me. </span> <span class="line" data-startTime="8600">So let's take a look at </span><span class="line" data-startTime="8600">some other things here. </span> <span class="line" data-startTime="8602">So I want to go over timeline. </span> <span class="line" data-startTime="8603">So that was load time. </span> <span class="line" data-startTime="8604">Everyone knows </span><span class="line" data-startTime="8604">the network stuff. </span> <span class="line" data-startTime="8606">If you're not using </span><span class="line" data-startTime="8606">webpagetest.org or modpagespeed </span><span class="line" data-startTime="8611">or pagespeedinsights </span><span class="line" data-startTime="8611">and all that stuff, </span><span class="line" data-startTime="8613">you need to be using all that. </span> <span class="line" data-startTime="8614">So let's just take a </span><span class="line" data-startTime="8614">look at what this site is </span><span class="line" data-startTime="8616">doing while I'm doing nothing. </span></p>

<p><span class="line" data-startTime="8617">So now, I haven't </span><span class="line" data-startTime="8617">touched this site. </span> <span class="line" data-startTime="8618">To be clear, my </span><span class="line" data-startTime="8618">phone almost actually </span><span class="line" data-startTime="8620">went locked, because </span><span class="line" data-startTime="8620">I haven't touched it. </span> <span class="line" data-startTime="8622">I'm still not touching it. </span> <span class="line" data-startTime="8623">But I want you to notice what </span><span class="line" data-startTime="8623">the memory is doing on the top. </span> <span class="line" data-startTime="8625">Now, I'm a C++ game developer. </span> <span class="line" data-startTime="8628">To me, the only thing that </span><span class="line" data-startTime="8628">matters for performance </span><span class="line" data-startTime="8631">is follow the memory. </span> <span class="line" data-startTime="8633">I actually gave a talk </span><span class="line" data-startTime="8633">at Velocity yesterday, </span><span class="line" data-startTime="8635">where I, in a very </span><span class="line" data-startTime="8635">heretic fashion, </span><span class="line" data-startTime="8638">suggested that web developers </span><span class="line" data-startTime="8638">were really bad developers </span><span class="line" data-startTime="8640">because we're not </span><span class="line" data-startTime="8640">controlling our memory. </span> <span class="line" data-startTime="8643">We're actually letting </span><span class="line" data-startTime="8643">JavaScript do it for us. </span> <span class="line" data-startTime="8644">And because of this, </span><span class="line" data-startTime="8644">we have no idea </span><span class="line" data-startTime="8646">what's going on under the hood. </span></p>

<p><span class="line" data-startTime="8648">How many of you know </span><span class="line" data-startTime="8648">what your heap size is? </span><span class="line" data-startTime="8651">How many of you care? </span><span class="line" data-startTime="8652">That's another question. </span> <span class="line" data-startTime="8654">I like that. </span> <span class="line" data-startTime="8655">I like your outfit. </span> <span class="line" data-startTime="8656">Does that have a cummerbund. </span> <span class="line" data-startTime="8657">What is that? </span><span class="line" data-startTime="8658">I like that. </span> <span class="line" data-startTime="8659">That's cool. </span> <span class="line" data-startTime="8660">I'm going to have to </span><span class="line" data-startTime="8660">get me one of those. </span> <span class="line" data-startTime="8661">Perfmatters. </span> <span class="line" data-startTime="8661">I've got to get me one of those. </span> <span class="line" data-startTime="8664">So again, I've touched nothing. </span> <span class="line" data-startTime="8665">But notice this here on the top. </span> <span class="line" data-startTime="8667">I don't know if you </span><span class="line" data-startTime="8667">guys can see it. </span> <span class="line" data-startTime="8668">It's allocating between </span><span class="line" data-startTime="8668">7.5 megs and 9 megs. </span> <span class="line" data-startTime="8671">I'm touching nothing. </span> <span class="line" data-startTime="8672">Nothing's occurring </span><span class="line" data-startTime="8672">on the screen. </span></p>

<p><span class="line" data-startTime="8674">Yet two megabytes of data are </span><span class="line" data-startTime="8674">being allocated and cleared </span><span class="line" data-startTime="8677">in this environment. </span> <span class="line" data-startTime="8678">Now, I can actually </span><span class="line" data-startTime="8678">figure out what's </span><span class="line" data-startTime="8680">going on with this, if </span><span class="line" data-startTime="8680">I stop my recording. </span> <span class="line" data-startTime="8683">Too much information. </span> <span class="line" data-startTime="8684">Let me just do a quick </span><span class="line" data-startTime="8684">record real quick, </span><span class="line" data-startTime="8685">so I can clear all that. </span> <span class="line" data-startTime="8688">So we can see something </span><span class="line" data-startTime="8688">on a timeline here. </span> <span class="line" data-startTime="8690">So it looks like, </span><span class="line" data-startTime="8690">first off, they've </span><span class="line" data-startTime="8692">got like two different </span><span class="line" data-startTime="8692">timers firing. </span> <span class="line" data-startTime="8694">So we've got Widgets.js </span><span class="line" data-startTime="8694">and Chartbeat. </span> <span class="line" data-startTime="8696">Chartbeat, I'm guessing, </span><span class="line" data-startTime="8696">is like an analytics thing. </span> <span class="line" data-startTime="8697">I see this on a bunch of </span><span class="line" data-startTime="8697">sites you guys gave me. </span></p>

<p><span class="line" data-startTime="8699">And then widgets seems </span><span class="line" data-startTime="8699">like their things. </span> <span class="line" data-startTime="8701">So I'm guessing this is that </span><span class="line" data-startTime="8701">marquee scroll at the top. </span> <span class="line" data-startTime="8703">They've got some </span><span class="line" data-startTime="8703">timer that's actually </span><span class="line" data-startTime="8705">moving those images around. </span> <span class="line" data-startTime="8706">What I don't like &mdash; pardon? </span></p>

<p class="speaker"><span class="line" data-starttime="8708"><span class="speakerName">Audience</span>: It's Twitter. </span></p>

<p class="speaker"><span class="line" data-starttime="8709"><span class="speakerName">Colt McAnlis</span>: For Widgets.js? </span><span class="line" data-startTime="8710">Oh, cool. </span> <span class="line" data-startTime="8713">Nice. </span> <span class="line" data-startTime="8716">Widgets.js. </span> <span class="line" data-startTime="8717">Twitter. </span> <span class="line" data-startTime="8717">Oh, cool. </span> <span class="line" data-startTime="8717">So Twitter is actually </span><span class="line" data-startTime="8717">screwing this page up. </span> <span class="line" data-startTime="8719">Go, Twitter. </span> <span class="line" data-startTime="8719">Is anyone here from Twitter? </span><span class="line" data-startTime="8721">Boo, Twitter. </span> <span class="line" data-startTime="8724">So what we see </span><span class="line" data-startTime="8724">down here though is </span><span class="line" data-startTime="8725">we see recalculate </span><span class="line" data-startTime="8725">and paint and whatnot. </span> <span class="line" data-startTime="8727">For our memory, this </span><span class="line" data-startTime="8727">view doesn't actually </span><span class="line" data-startTime="8731">tell us what's being allocated. </span></p>

<p><span class="line" data-startTime="8732">We can see where the events </span><span class="line" data-startTime="8732">are occurring and whatnot. </span> <span class="line" data-startTime="8735">I can actually mouse over the </span><span class="line" data-startTime="8735">GCs when they actually happen. </span> <span class="line" data-startTime="8738">More importantly, though, </span><span class="line" data-startTime="8738">I can actually go over here </span><span class="line" data-startTime="8740">to the Profiles </span><span class="line" data-startTime="8740">page, because I don't </span><span class="line" data-startTime="8741">like seeing that kind of memory. </span> <span class="line" data-startTime="8743">And I can actually do a </span><span class="line" data-startTime="8743">record of heap applications. </span> <span class="line" data-startTime="8745">So I can just hit start </span><span class="line" data-startTime="8745">and let this thing run. </span> <span class="line" data-startTime="8747">And basically, what you're </span><span class="line" data-startTime="8747">seeing here is on this top, </span><span class="line" data-startTime="8749">you're seeing timeline </span><span class="line" data-startTime="8749">view plus memory </span><span class="line" data-startTime="8751">profiling at the same time. </span> <span class="line" data-startTime="8752">At the top, any of </span><span class="line" data-startTime="8752">these blue lines </span><span class="line" data-startTime="8755">is when memory </span><span class="line" data-startTime="8755">allocations occur. </span> <span class="line" data-startTime="8756">Now, when you see a gray </span><span class="line" data-startTime="8756">line, what the gray line means </span><span class="line" data-startTime="8759">is that memory has been freed </span><span class="line" data-startTime="8759">by a garbage collection process </span><span class="line" data-startTime="8762">somewhere. </span></p>

<p><span class="line" data-startTime="8762">So you can actually see a </span><span class="line" data-startTime="8762">new set that just happened. </span> <span class="line" data-startTime="8765">And some of the </span><span class="line" data-startTime="8765">gray lines happened. </span> <span class="line" data-startTime="8767">But these blues tend to pop </span><span class="line" data-startTime="8767">up in a very regular fashion. </span> <span class="line" data-startTime="8771">Now, in this, I can </span><span class="line" data-startTime="8771">actually go through here </span><span class="line" data-startTime="8774">and change the size of </span><span class="line" data-startTime="8774">my window and actually </span><span class="line" data-startTime="8777">see exactly what was allocated. </span> <span class="line" data-startTime="8780">So in this single event, </span><span class="line" data-startTime="8780">at about eight seconds </span><span class="line" data-startTime="8782">into my capture, about 3K </span><span class="line" data-startTime="8782">worth of data was allocated. </span> <span class="line" data-startTime="8785">And we can see a similar </span><span class="line" data-startTime="8785">pattern over here. </span> <span class="line" data-startTime="8787">l can highlight this window. </span> <span class="line" data-startTime="8788">And we see about almost 3K. </span> <span class="line" data-startTime="8790">And over here, a similar window. </span> <span class="line" data-startTime="8792">There's about 3K plus </span><span class="line" data-startTime="8792">a lot of extra change </span><span class="line" data-startTime="8794">there that hasn't </span><span class="line" data-startTime="8794">been freed up yet. </span> <span class="line" data-startTime="8796">But let me focus on </span><span class="line" data-startTime="8796">this guy really quick. </span> <span class="line" data-startTime="8798">So here I can actually see that </span><span class="line" data-startTime="8798">3K came from compiled code. </span> <span class="line" data-startTime="8800">So somewhere in the system, </span><span class="line" data-startTime="8800">deoptimization code came from. </span></p>

<p><span class="line" data-startTime="8803">Now, for those of </span><span class="line" data-startTime="8803">you who are not </span><span class="line" data-startTime="8805">versed in fast path and </span><span class="line" data-startTime="8805">slow path JavaScript, </span><span class="line" data-startTime="8807">effectively, what this </span><span class="line" data-startTime="8807">little block of data </span><span class="line" data-startTime="8809">you're seeing here &mdash; see </span><span class="line" data-startTime="8809">that deoptimization data? </span><span class="line" data-startTime="8811">The way that V8 and most modern </span><span class="line" data-startTime="8811">JavaScript VMs work is they </span><span class="line" data-startTime="8815">will actually try to optimize </span><span class="line" data-startTime="8815">your code on your behalf, </span><span class="line" data-startTime="8817">because come on, you're </span><span class="line" data-startTime="8817">a stupid programmer. </span> <span class="line" data-startTime="8819">You don't know </span><span class="line" data-startTime="8819">how to write code. </span> <span class="line" data-startTime="8821">Obviously, the VM </span><span class="line" data-startTime="8821">knows better than you, </span><span class="line" data-startTime="8822">because it's a machine. </span> <span class="line" data-startTime="8823">And it's fast. </span></p>

<p><span class="line" data-startTime="8823">And it's smart. </span> <span class="line" data-startTime="8824">So what it will actually </span><span class="line" data-startTime="8824">do is take a code path </span><span class="line" data-startTime="8825">that you've written. </span> <span class="line" data-startTime="8826">And it will actually </span><span class="line" data-startTime="8826">optimize it. </span> <span class="line" data-startTime="8827">It'll manage the memory. </span> <span class="line" data-startTime="8828">It will make some fast </span><span class="line" data-startTime="8828">path optimizations. </span> <span class="line" data-startTime="8830">And it will put it out </span><span class="line" data-startTime="8830">there and start running it. </span> <span class="line" data-startTime="8832">Well, the problem </span><span class="line" data-startTime="8832">is that it does this </span><span class="line" data-startTime="8834">with some assumptions about </span><span class="line" data-startTime="8834">the state of the environment </span><span class="line" data-startTime="8836">that it's in. </span> <span class="line" data-startTime="8837">And it'll do this. </span> <span class="line" data-startTime="8837">And oftentimes it'll break. </span> <span class="line" data-startTime="8839">And it'll go, whoa, whoa. </span> <span class="line" data-startTime="8840">We actually caused an exception </span><span class="line" data-startTime="8840">somewhere in the stack </span><span class="line" data-startTime="8842">doing our optimization, because </span><span class="line" data-startTime="8842">we're just a stupid robot. </span></p>

<p><span class="line" data-startTime="8844">And we actually don't know </span><span class="line" data-startTime="8844">what we're doing either. </span> <span class="line" data-startTime="8846">When this happens, </span><span class="line" data-startTime="8846">basically, Chrome </span><span class="line" data-startTime="8848">has to create this new block </span><span class="line" data-startTime="8848">of code that's parallel </span><span class="line" data-startTime="8852">to the block of code you had, </span><span class="line" data-startTime="8852">delete your block of code, </span><span class="line" data-startTime="8854">put your new block of code in </span><span class="line" data-startTime="8854">the stack, and have it execute. </span> <span class="line" data-startTime="8857">When that deoptimization </span><span class="line" data-startTime="8857">occurs, because the optimization </span><span class="line" data-startTime="8859">failed, it has to take </span><span class="line" data-startTime="8859">your old block of code, </span><span class="line" data-startTime="8862">put it back in, and </span><span class="line" data-startTime="8862">delete the block of code </span><span class="line" data-startTime="8864">that it just created. </span> <span class="line" data-startTime="8866">So there are specific </span><span class="line" data-startTime="8866">code paths that </span><span class="line" data-startTime="8868">generally cause this to happen. </span> <span class="line" data-startTime="8869">Closures are one of them. </span> <span class="line" data-startTime="8872">How many of you are using </span><span class="line" data-startTime="8872">closures in your timers? </span><span class="line" data-startTime="8875">Don't applaud. </span></p>

<p><span class="line" data-startTime="8875">I don't want you </span><span class="line" data-startTime="8875">to applaud that. </span> <span class="line" data-startTime="8878">Closures are one </span><span class="line" data-startTime="8878">of these things. </span> <span class="line" data-startTime="8880">If you actually have </span><span class="line" data-startTime="8880">a closure running, </span><span class="line" data-startTime="8881">it's very common for people to </span><span class="line" data-startTime="8881">do set interval closure, 1,000. </span> <span class="line" data-startTime="8886">That closure in </span><span class="line" data-startTime="8886">that set interval </span><span class="line" data-startTime="8888">is actually causing these </span><span class="line" data-startTime="8888">sorts of memory leaks to occur. </span> <span class="line" data-startTime="8891">It's a deoptimization path </span><span class="line" data-startTime="8891">that V8 can't optimize around. </span> <span class="line" data-startTime="8894">And so, basically, every </span><span class="line" data-startTime="8894">single time you're doing this, </span><span class="line" data-startTime="8897">you're running into </span><span class="line" data-startTime="8897">this situation. </span> <span class="line" data-startTime="8898">So let's take a look at </span><span class="line" data-startTime="8898">something else really quick. </span> <span class="line" data-startTime="8900">So I want to go over </span><span class="line" data-startTime="8900">here and show you </span><span class="line" data-startTime="8903">what I'm seeing on the screen. </span> <span class="line" data-startTime="8904">Now, I've turned on a couple </span><span class="line" data-startTime="8904">modes on the developer tools. </span> <span class="line" data-startTime="8908">So first off, you'll see </span><span class="line" data-startTime="8908">this beautiful little &mdash; </span><span class="line" data-startTime="8911">you can't see it too well. </span> <span class="line" data-startTime="8913">I wonder if I can tilt my </span><span class="line" data-startTime="8913">phone just a little bit. </span></p>

<p><span class="line" data-startTime="8914">You can see up at the </span><span class="line" data-startTime="8914">top that I actually </span><span class="line" data-startTime="8915">have a little graph </span><span class="line" data-startTime="8915">showing me frame rate, </span><span class="line" data-startTime="8917">as well as how much GPU </span><span class="line" data-startTime="8917">memory is being used. </span> <span class="line" data-startTime="8922">Quick show of hands. </span> <span class="line" data-startTime="8923">Who understands how a </span><span class="line" data-startTime="8923">web page is painted? </span><span class="line" data-startTime="8928">It's like the same guys </span><span class="line" data-startTime="8928">that wrote JPEG compilers. </span> <span class="line" data-startTime="8930">So for everyone else, let </span><span class="line" data-startTime="8930">me do this really quick. </span> <span class="line" data-startTime="8932">How your page is rasterized </span><span class="line" data-startTime="8932">is a delicate ballet. </span> <span class="line" data-startTime="8938">Really, it's more like boxing. </span> <span class="line" data-startTime="8940">It's basically two people </span><span class="line" data-startTime="8940">smashing each other's faces </span><span class="line" data-startTime="8942">in for about six </span><span class="line" data-startTime="8942">milliseconds a frame. </span> <span class="line" data-startTime="8944">Effectively, what happens is </span><span class="line" data-startTime="8944">Chrome will take your web page. </span> <span class="line" data-startTime="8947">And it will dice it up. </span> <span class="line" data-startTime="8949">It'll create square regions </span><span class="line" data-startTime="8949">of 256 by 256 tiles. </span></p>

<p><span class="line" data-startTime="8953">For each one of these tiles, it </span><span class="line" data-startTime="8953">will actually spin up a thread </span><span class="line" data-startTime="8956">and actually rasterize all </span><span class="line" data-startTime="8956">of the pixels in that tile, </span><span class="line" data-startTime="8959">all of the WebKit &mdash; </span><span class="line" data-startTime="8959">well, Blink now. </span> <span class="line" data-startTime="8961">Sorry. </span> <span class="line" data-startTime="8961">I've got to get my terminology </span><span class="line" data-startTime="8961">right &mdash; all of the page </span><span class="line" data-startTime="8963">elements and actually composite </span><span class="line" data-startTime="8963">that to a CPU chunk of memory, </span><span class="line" data-startTime="8967">32 bits per pixel, </span><span class="line" data-startTime="8967">256 by 256 tile. </span> <span class="line" data-startTime="8971">And it will rasterize </span><span class="line" data-startTime="8971">all that data in there. </span> <span class="line" data-startTime="8973">Once that data is rasterized, it </span><span class="line" data-startTime="8973">will then upload it to the GPU. </span></p>

<p><span class="line" data-startTime="8976">When you scroll a page, </span><span class="line" data-startTime="8976">the GPU is actually </span><span class="line" data-startTime="8979">the thing that's </span><span class="line" data-startTime="8979">moving your page. </span> <span class="line" data-startTime="8981">Now, some of you in here are </span><span class="line" data-startTime="8981">young, much younger than me. </span> <span class="line" data-startTime="8984">You may not know this. </span> <span class="line" data-startTime="8985">But back before Quake 3 </span><span class="line" data-startTime="8985">was hardware accelerated, </span><span class="line" data-startTime="8988">we had something called </span><span class="line" data-startTime="8988">software rasterization. </span> <span class="line" data-startTime="8991">Software rasterization? </span><span class="line" data-startTime="8992">Heretic Doom? </span><span class="line" data-startTime="8993">Quake? </span><span class="line" data-startTime="8993">Anybody? </span><span class="line" data-startTime="8994">Any other professional </span><span class="line" data-startTime="8994">gamers in the house? </span><span class="line" data-startTime="8996">Yeah. </span> <span class="line" data-startTime="8997">So back then, we used a term </span><span class="line" data-startTime="8997">called software rasterization. </span> <span class="line" data-startTime="9000">This was generally OK. </span> <span class="line" data-startTime="9002">But once we invented </span><span class="line" data-startTime="9002">GPUs, GPUs are basically </span><span class="line" data-startTime="9004">hardware rasterization. </span> <span class="line" data-startTime="9005">They're built to take pixels </span><span class="line" data-startTime="9005">and put them on the screen. </span> <span class="line" data-startTime="9008">They're dedicated </span><span class="line" data-startTime="9008">silicon for this. </span></p>

<p><span class="line" data-startTime="9010">But Chrome is actually still </span><span class="line" data-startTime="9010">using software rasterization </span><span class="line" data-startTime="9012">to paint the pixels </span><span class="line" data-startTime="9012">on the screen. </span> <span class="line" data-startTime="9014">This means that </span><span class="line" data-startTime="9014">this is a slow path. </span> <span class="line" data-startTime="9016">This also means that </span><span class="line" data-startTime="9016">every one of you </span><span class="line" data-startTime="9017">right now should be </span><span class="line" data-startTime="9017">really, really scared, </span><span class="line" data-startTime="9020">because how many of you have </span><span class="line" data-startTime="9020">actually tested whether or not </span><span class="line" data-startTime="9023">those rounded corners and drop </span><span class="line" data-startTime="9023">shadows affect your render </span><span class="line" data-startTime="9027">time? </span><span class="line" data-startTime="9029">They do, actually, </span><span class="line" data-startTime="9029">quite frankly. </span> <span class="line" data-startTime="9030">If you go to HTML5rocks, I </span><span class="line" data-startTime="9030">actually did a study on this. </span> <span class="line" data-startTime="9033">I'm sorry. </span> <span class="line" data-startTime="9034">That was a leading question. </span> <span class="line" data-startTime="9034">That was mean. </span></p>

<p><span class="line" data-startTime="9035">I knew that you didn't </span><span class="line" data-startTime="9035">know that answer. </span> <span class="line" data-startTime="9037">But basically, what </span><span class="line" data-startTime="9037">happens is your CSS effects </span><span class="line" data-startTime="9041">have to be software rasterized, </span><span class="line" data-startTime="9041">which means we have to actually </span><span class="line" data-startTime="9043">go and draw rounded rectangles </span><span class="line" data-startTime="9043">and then actually add a drop </span><span class="line" data-startTime="9046">shadow to the side of it. </span> <span class="line" data-startTime="9048">And this actually </span><span class="line" data-startTime="9048">takes more time. </span> <span class="line" data-startTime="9049">In fact, if you have </span><span class="line" data-startTime="9049">those two combinations </span><span class="line" data-startTime="9051">of things together, </span><span class="line" data-startTime="9051">it actually takes 4x </span><span class="line" data-startTime="9053">as long as each one of </span><span class="line" data-startTime="9053">them individually, which </span><span class="line" data-startTime="9055">means that there's </span><span class="line" data-startTime="9055">combinations of CSS properties </span><span class="line" data-startTime="9058">that hurt your rendering </span><span class="line" data-startTime="9058">performance more than others. </span> <span class="line" data-startTime="9062">Hopefully, all of you </span><span class="line" data-startTime="9062">are going, dear God, </span><span class="line" data-startTime="9064">I have to test this right now. </span></p>

<p><span class="line" data-startTime="9066">And how you can test this </span><span class="line" data-startTime="9066">is you can actually see up </span><span class="line" data-startTime="9068">here in this frame rate meter </span><span class="line" data-startTime="9068">that as you're scrolling, </span><span class="line" data-startTime="9071">you can actually </span><span class="line" data-startTime="9071">see the milliseconds </span><span class="line" data-startTime="9073">taken to render that </span><span class="line" data-startTime="9073">part of your page. </span> <span class="line" data-startTime="9075">Now, what you're </span><span class="line" data-startTime="9075">also seeing here </span><span class="line" data-startTime="9076">is notice this big red </span><span class="line" data-startTime="9076">box that keeps popping up? </span><span class="line" data-startTime="9079">This is actually a mode </span><span class="line" data-startTime="9079">in Chrome Dev Tools &mdash; </span><span class="line" data-startTime="9081">and let me show you this. </span> <span class="line" data-startTime="9081">And I know I'm spending </span><span class="line" data-startTime="9081">more time on this site. </span> <span class="line" data-startTime="9083">As we go to the other </span><span class="line" data-startTime="9083">sites, you actually </span><span class="line" data-startTime="9084">see this stuff play out. </span></p>

<p><span class="line" data-startTime="9085">But I need to test </span><span class="line" data-startTime="9085">the groundwork here. </span> <span class="line" data-startTime="9087">Is that in or left? </span></p>

<p class="speaker"><span class="line" data-starttime="9089"><span class="speakerName">Audience</span>: Left. </span></p>

<p class="speaker"><span class="line" data-starttime="9090"><span class="speakerName">Colt McAnlis</span>: Left. </span> <span class="line" data-startTime="9090">Oh, wow. </span> <span class="line" data-startTime="9091">I'll keep working. </span> <span class="line" data-startTime="9092">So anyhow, I have show </span><span class="line" data-startTime="9092">paint rectangles on. </span> <span class="line" data-startTime="9094">Basically, what this does </span><span class="line" data-startTime="9094">is when I turn this on, </span><span class="line" data-startTime="9096">it's going to show </span><span class="line" data-startTime="9096">a red rectangle </span><span class="line" data-startTime="9097">for every part of the page </span><span class="line" data-startTime="9097">that actually gets repainted. </span> <span class="line" data-startTime="9099">So this actually tells </span><span class="line" data-startTime="9099">me what part of the page </span><span class="line" data-startTime="9101">is being rerasterized, which </span><span class="line" data-startTime="9101">is really cool to know, </span><span class="line" data-startTime="9105">because I'm pretty sure all </span><span class="line" data-startTime="9105">of you will look at your site </span><span class="line" data-startTime="9107">and find that you've got some </span><span class="line" data-startTime="9107">little square icon like this. </span> <span class="line" data-startTime="9110">But for some reason it's </span><span class="line" data-startTime="9110">rasterizing like a 6x size </span><span class="line" data-startTime="9113">window of that that all has </span><span class="line" data-startTime="9113">to be reprocessed on the CPU. </span> <span class="line" data-startTime="9116">This slows down your page. </span> <span class="line" data-startTime="9117">It creates jank. </span></p>

<p><span class="line" data-startTime="9118">I hate that word. </span> <span class="line" data-startTime="9119">Hitching, by the way, </span><span class="line" data-startTime="9119">hitching is the right term. </span> <span class="line" data-startTime="9121">Every other medium &mdash; </span><span class="line" data-startTime="9121">video games, AV, </span><span class="line" data-startTime="9123">movies &mdash; it's called hitching. </span> <span class="line" data-startTime="9125">Can we all agree </span><span class="line" data-startTime="9125">to use hitching? </span><span class="line" data-startTime="9127">No? </span><span class="line" data-startTime="9128">I'll get hitchfree.org later. </span> <span class="line" data-startTime="9131">Anyhow, let me move </span><span class="line" data-startTime="9131">on to the next site, </span><span class="line" data-startTime="9132">because I want to make sure that </span><span class="line" data-startTime="9132">we talk about some more stuff. </span> <span class="line" data-startTime="9135">But basically, you can </span><span class="line" data-startTime="9135">see that on this site, </span><span class="line" data-startTime="9136">there's a couple things. </span> <span class="line" data-startTime="9137">First off, they're </span><span class="line" data-startTime="9137">sending too large images </span><span class="line" data-startTime="9140">to a mobile device. </span> <span class="line" data-startTime="9141">They don't have a mobile view. </span></p>

<p><span class="line" data-startTime="9142">They don't have a </span><span class="line" data-startTime="9142">mindset of a viewport </span><span class="line" data-startTime="9145">for these mobile environments. </span> <span class="line" data-startTime="9146">Plus, it seems like </span><span class="line" data-startTime="9146">their marquee is actually </span><span class="line" data-startTime="9149">rendering and updating </span><span class="line" data-startTime="9149">different parts of the page </span><span class="line" data-startTime="9151">at different frequencies. </span> <span class="line" data-startTime="9152">They're allocating about </span><span class="line" data-startTime="9152">a meg of memory per minute </span><span class="line" data-startTime="9156">or so, when no one's </span><span class="line" data-startTime="9156">touching anything. </span> <span class="line" data-startTime="9158">So if this is your </span><span class="line" data-startTime="9158">site, fix those things, </span><span class="line" data-startTime="9161">because you need to. </span> <span class="line" data-startTime="9162">And also, your load time </span><span class="line" data-startTime="9162">is pretty harsh too. </span> <span class="line" data-startTime="9164">So let's do this next one. </span> <span class="line" data-startTime="9167">So this next one </span><span class="line" data-startTime="9167">should be pretty quick. </span> <span class="line" data-startTime="9169">I just want to highlight </span><span class="line" data-startTime="9169">something really poignant here. </span> <span class="line" data-startTime="9172">So I'm going to close this. </span> <span class="line" data-startTime="9174">Which view are you on? </span><span class="line" data-startTime="9177">So let's show you. </span> <span class="line" data-startTime="9178">So this is dosomething.org. </span> <span class="line" data-startTime="9180">Cool little website. </span></p>

<p><span class="line" data-startTime="9182">It just encourages everyone </span><span class="line" data-startTime="9182">to do something interesting, </span><span class="line" data-startTime="9184">like small butterfly </span><span class="line" data-startTime="9184">wings change </span><span class="line" data-startTime="9187">the course of tides in </span><span class="line" data-startTime="9187">Africa and all that stuff. </span> <span class="line" data-startTime="9189">But we see it's a pretty simple </span><span class="line" data-startTime="9189">website, just a little strata </span><span class="line" data-startTime="9195">of images and whatnot. </span> <span class="line" data-startTime="9196">When we go over here </span><span class="line" data-startTime="9196">to Chrome Dev Tools, </span><span class="line" data-startTime="9199">let's inspect this </span><span class="line" data-startTime="9199">information here. </span> <span class="line" data-startTime="9200">And I'm going to put this </span><span class="line" data-startTime="9200">back on the Network tab. </span> <span class="line" data-startTime="9202">And we're going to go </span><span class="line" data-startTime="9202">ahead and reload this. </span> <span class="line" data-startTime="9208">So we can actually see the </span><span class="line" data-startTime="9208">page loaded pretty quickly. </span> <span class="line" data-startTime="9211">We got a lot of </span><span class="line" data-startTime="9211">information really quick, </span><span class="line" data-startTime="9213">about 2.9 seconds. </span> <span class="line" data-startTime="9214">So this is a lot better </span><span class="line" data-startTime="9214">than the previous website. </span></p>

<p><span class="line" data-startTime="9216">We're right around that </span><span class="line" data-startTime="9216">three-second load time. </span> <span class="line" data-startTime="9219">And again, this is on my 4G. </span> <span class="line" data-startTime="9220">I'm not on the wireless. </span> <span class="line" data-startTime="9221">So that's pretty good. </span> <span class="line" data-startTime="9222">10K transferred. </span> <span class="line" data-startTime="9223">That's all right. </span> <span class="line" data-startTime="9224">21 requests. </span> <span class="line" data-startTime="9225">Not that bad at all. </span> <span class="line" data-startTime="9226">So let's, again, sort by size. </span> <span class="line" data-startTime="9227">Let's see if anything's </span><span class="line" data-startTime="9227">coming up here. </span> <span class="line" data-startTime="9230">I got a couple not founds. </span> <span class="line" data-startTime="9231">That's not necessarily </span><span class="line" data-startTime="9231">a good idea. </span> <span class="line" data-startTime="9233">A couple images here. </span> <span class="line" data-startTime="9237">So this is interesting. </span> <span class="line" data-startTime="9238">Again, another 106K image </span><span class="line" data-startTime="9238">that's being delivered </span><span class="line" data-startTime="9240">to a mobile screen, that, </span><span class="line" data-startTime="9240">obviously, does not need 106K. </span> <span class="line" data-startTime="9244">That one's a little bit </span><span class="line" data-startTime="9244">better, well not better. </span> <span class="line" data-startTime="9246">I mean that's a very </span><span class="line" data-startTime="9246">depressing image. </span> <span class="line" data-startTime="9248">I didn't mean that </span><span class="line" data-startTime="9248">that was &mdash; Again, </span><span class="line" data-startTime="9252">my opinions are my </span><span class="line" data-startTime="9252">own and not that </span><span class="line" data-startTime="9254">of any organization </span><span class="line" data-startTime="9254">or secret service </span><span class="line" data-startTime="9255">that I'm influenced with. </span> <span class="line" data-startTime="9257">So we can actually see </span><span class="line" data-startTime="9257">some of these images </span><span class="line" data-startTime="9258">may be a little bit </span><span class="line" data-startTime="9258">larger than others. </span></p>

<p><span class="line" data-startTime="9260">But for the most part, </span><span class="line" data-startTime="9260">this is actually nice. </span> <span class="line" data-startTime="9262">What happened here? </span><span class="line" data-startTime="9267">This technology. </span> <span class="line" data-startTime="9268">Isn't it great? </span><span class="line" data-startTime="9269">So we can actually see though </span><span class="line" data-startTime="9269">that this page is actually </span><span class="line" data-startTime="9272">a pretty good example of </span><span class="line" data-startTime="9272">what to do on a website. </span> <span class="line" data-startTime="9275">If you load this on the desktop, </span><span class="line" data-startTime="9275">what you'll actually see </span><span class="line" data-startTime="9277">is that there's larger </span><span class="line" data-startTime="9277">versions of these images. </span> <span class="line" data-startTime="9279">They're tiled differently </span><span class="line" data-startTime="9279">with a different layout. </span> <span class="line" data-startTime="9281">There's a difference scheme. </span> <span class="line" data-startTime="9282">But in the mobile </span><span class="line" data-startTime="9282">version, they really only </span><span class="line" data-startTime="9284">have one or two images </span><span class="line" data-startTime="9284">that are probably </span><span class="line" data-startTime="9286">too large for the mobile device. </span></p>

<p><span class="line" data-startTime="9287">But in the most </span><span class="line" data-startTime="9287">part, this actually </span><span class="line" data-startTime="9289">scrolls pretty quickly. </span> <span class="line" data-startTime="9292">I know you can't see </span><span class="line" data-startTime="9292">it up at the top here, </span><span class="line" data-startTime="9294">but this is actually about </span><span class="line" data-startTime="9294">three milliseconds to five </span><span class="line" data-startTime="9297">milliseconds to actually </span><span class="line" data-startTime="9297">draw the part of the page. </span> <span class="line" data-startTime="9299">And you can actually see </span><span class="line" data-startTime="9299">that as I'm scrolling, </span><span class="line" data-startTime="9302">notice that there's </span><span class="line" data-startTime="9302">no red tiles. </span> <span class="line" data-startTime="9304">You don't see those </span><span class="line" data-startTime="9304">big red flashes. </span> <span class="line" data-startTime="9306">What that means is this </span><span class="line" data-startTime="9306">entire page has actually </span><span class="line" data-startTime="9308">been rasterized on the CPU </span><span class="line" data-startTime="9308">and uploaded to the GPU. </span> <span class="line" data-startTime="9310">And it's been cached in the GPU. </span> <span class="line" data-startTime="9312">And so as you're </span><span class="line" data-startTime="9312">scrolling up and down, </span><span class="line" data-startTime="9314">the CPU doesn't </span><span class="line" data-startTime="9314">have to do any work. </span> <span class="line" data-startTime="9316">So this is what you want. </span></p>

<p><span class="line" data-startTime="9317">You want to no red blocks </span><span class="line" data-startTime="9317">going on in your page. </span> <span class="line" data-startTime="9320">So let's do another </span><span class="line" data-startTime="9320">site here really quick, </span><span class="line" data-startTime="9322">because now I'm freaking out </span><span class="line" data-startTime="9322">that I've only got 30 minutes. </span></p>

<p class="speaker"><span class="line" data-starttime="9325"><span class="speakerName">Male Speaker</span>: You've </span><span class="line" data-startTime="9325">got 45 minutes. </span></p>

<p class="speaker"><span class="line" data-starttime="9327"><span class="speakerName">Colt McAnlis</span>: Yes! </span><span class="line" data-startTime="9329">We're going all night. </span><span class="line" data-startTime="9332">Let's just open </span><span class="line" data-startTime="9332">up every website. </span><span class="line" data-startTime="9334">So this is the one we </span><span class="line" data-startTime="9334">saw a little bit earlier. </span><span class="line" data-startTime="9337">Sorry. </span><span class="line" data-startTime="9338">I don't know if my antics </span><span class="line" data-startTime="9338">distracted you all. </span><span class="line" data-startTime="9340">Let's reload this again. </span><span class="line" data-startTime="9342">Let's see how the load time is. </span><span class="line" data-startTime="9343">So notice on the top here </span><span class="line" data-startTime="9343">that it's about halfway. </span><span class="line" data-startTime="9346">So this page hasn't </span><span class="line" data-startTime="9346">unloaded yet. </span><span class="line" data-startTime="9347">Let's just be clear about </span><span class="line" data-startTime="9347">what we're looking at. </span><span class="line" data-startTime="9349">This is an instant load. </span><span class="line" data-startTime="9350">Now, we've actually gotten </span><span class="line" data-startTime="9350">to the loading part. </span><span class="line" data-startTime="9359">If this is your </span><span class="line" data-startTime="9359">website, I'm sorry. </span><span class="line" data-startTime="9362">Hopefully, you understand </span><span class="line" data-startTime="9362">there's work that needs to do. </span></p>

<p class="speaker"><span class="line" data-starttime="9364"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="9367"><span class="speakerName">Colt McAnlis</span>: It might be. </span> <span class="line" data-startTime="9368">Let's find out. </span> <span class="line" data-startTime="9369">So again, over here, </span><span class="line" data-startTime="9369">let's go to inspect. </span> <span class="line" data-startTime="9371">I wonder if I can just </span><span class="line" data-startTime="9371">catch this midstream, </span><span class="line" data-startTime="9372">if it will just tell </span><span class="line" data-startTime="9372">me what that image is </span><span class="line" data-startTime="9374">or if I have to hit reload. </span> <span class="line" data-startTime="9378">It's still loading. </span> <span class="line" data-startTime="9379">OK. </span> <span class="line" data-startTime="9379">Here, I'll hit reload and </span><span class="line" data-startTime="9379">see what goes on here. </span> <span class="line" data-startTime="9383">Oh, web fonts. </span> <span class="line" data-startTime="9384">OK. </span> <span class="line" data-startTime="9384">We'll take a look </span><span class="line" data-startTime="9384">at that in a second. </span> <span class="line" data-startTime="9386">OK. </span> <span class="line" data-startTime="9387">So I hit reload. </span> <span class="line" data-startTime="9388">This is waiting to reload. </span></p>

<p><span class="line" data-startTime="9389">So obviously, there's already </span><span class="line" data-startTime="9389">some problems with this site. </span> <span class="line" data-startTime="9392">Hopefully, someone in </span><span class="line" data-startTime="9392">here is going, please </span><span class="line" data-startTime="9394">stop clicking buttons. </span> <span class="line" data-startTime="9397">Please take my website off </span><span class="line" data-startTime="9397">of your screen, you angry, </span><span class="line" data-startTime="9400">bald man. </span> <span class="line" data-startTime="9401">OK. </span> <span class="line" data-startTime="9402">Let's see how this </span><span class="line" data-startTime="9402">is going here. </span> <span class="line" data-startTime="9404">So you can't see the screen. </span> <span class="line" data-startTime="9406">It's still loading. </span> <span class="line" data-startTime="9407">The fonts just now appeared. </span> <span class="line" data-startTime="9409">Let's take a look at </span><span class="line" data-startTime="9409">what's going on here </span><span class="line" data-startTime="9411">and see whether or not we can </span><span class="line" data-startTime="9411">discuss some of these items. </span> <span class="line" data-startTime="9414">So let's sort by size here. </span> <span class="line" data-startTime="9418">This is something I want to let </span><span class="line" data-startTime="9418">everybody know, because this </span><span class="line" data-startTime="9420">is the first thing I want </span><span class="line" data-startTime="9420">to point out on this site. </span> <span class="line" data-startTime="9422">This is a WOFF file. </span> <span class="line" data-startTime="9424">It's a web font. </span></p>

<p><span class="line" data-startTime="9426">Round of applause if you're </span><span class="line" data-startTime="9426">using web fonts in your site. </span> <span class="line" data-startTime="9428">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="9429"><span class="speakerName">Colt McAnlis</span>: Good. </span> <span class="line" data-startTime="9430">Please stop. </span> <span class="line" data-startTime="9433">Please, please stop. </span> <span class="line" data-startTime="9436">I don't know if you saw this. </span> <span class="line" data-startTime="9438">Web fonts look great. </span> <span class="line" data-startTime="9439">They're awesome. </span> <span class="line" data-startTime="9440">This is 38K for that web font. </span> <span class="line" data-startTime="9441">And unfortunately, some </span><span class="line" data-startTime="9441">of these have been cached. </span> <span class="line" data-startTime="9444">So you can't actually see the </span><span class="line" data-startTime="9444">true size of a lot of these. </span> <span class="line" data-startTime="9447">But there's actually five or </span><span class="line" data-startTime="9447">six web fonts on this page. </span> <span class="line" data-startTime="9450">So you guys are </span><span class="line" data-startTime="9450">getting a bum deal. </span> <span class="line" data-startTime="9451">You're not seeing </span><span class="line" data-startTime="9451">how horrible this is. </span></p>

<p><span class="line" data-startTime="9453">But basically, </span><span class="line" data-startTime="9453">here's what happens. </span> <span class="line" data-startTime="9455">When you've got five </span><span class="line" data-startTime="9455">web fonts, each one </span><span class="line" data-startTime="9457">can be somewhere between </span><span class="line" data-startTime="9457">the range of 40K and 90K </span><span class="line" data-startTime="9460">for a font. </span> <span class="line" data-startTime="9461">That font is required </span><span class="line" data-startTime="9461">before text can actually </span><span class="line" data-startTime="9464">be drawn to your screen. </span> <span class="line" data-startTime="9467">So pop quiz. </span> <span class="line" data-startTime="9468">What happens if you're </span><span class="line" data-startTime="9468">ready to draw text, </span><span class="line" data-startTime="9470">and your CSS is down, and </span><span class="line" data-startTime="9470">your JavaScript is down, </span><span class="line" data-startTime="9473">and your images are down, </span><span class="line" data-startTime="9473">but your WOFF isn't down yet? </span><span class="line" data-startTime="9477">Good answer. </span> <span class="line" data-startTime="9479">No one said anything. </span> <span class="line" data-startTime="9479">Good answer. </span> <span class="line" data-startTime="9480">Nothing. </span></p>

<p><span class="line" data-startTime="9480">Nothing happens. </span> <span class="line" data-startTime="9481">Chrome will do nothing. </span> <span class="line" data-startTime="9482">Chrome will block. </span> <span class="line" data-startTime="9483">Chrome will wait. </span> <span class="line" data-startTime="9483">Chrome will wait for every </span><span class="line" data-startTime="9483">single one of your WOFFs </span><span class="line" data-startTime="9485">to come down before a </span><span class="line" data-startTime="9485">single character of text </span><span class="line" data-startTime="9489">is drawn on your screen. </span></p>

<p class="speaker"><span class="line" data-starttime="9492"><span class="speakerName">Audience</span>: [INAUDIBLE] render all </span><span class="line" data-startTime="9492">the text that you [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="9495"><span class="speakerName">Colt McAnlis</span>: Jake </span><span class="line" data-startTime="9495">Archibald says I'm dumb. </span><span class="line" data-startTime="9498">If that single WOFF is </span><span class="line" data-startTime="9498">visible, it'll render that one. </span><span class="line" data-startTime="9501">Now, Firefox will do it </span><span class="line" data-startTime="9501">a little bit differently. </span><span class="line" data-startTime="9502">Basically, what it will do </span><span class="line" data-startTime="9502">is it'll wait three seconds. </span><span class="line" data-startTime="9504">Right, Jake? </span></p>

<p class="speaker"><span class="line" data-starttime="9504"><span class="speakerName">Jake Archibald</span>: Yeah. </span></p>

<p class="speaker"><span class="line" data-starttime="9505"><span class="speakerName">Colt McAnlis</span>: It'll </span><span class="line" data-startTime="9505">wait three seconds. </span> <span class="line" data-startTime="9507">Maybe you should &mdash; having </span><span class="line" data-startTime="9507">an awkward mic moment. </span> <span class="line" data-startTime="9511">Basically, what will </span><span class="line" data-startTime="9511">happen with Firefox </span><span class="line" data-startTime="9512">is it'll start the </span><span class="line" data-startTime="9512">request for the WOFF. </span> <span class="line" data-startTime="9514">If it hasn't been </span><span class="line" data-startTime="9514">downloaded in three seconds, </span><span class="line" data-startTime="9516">it'll actually keep </span><span class="line" data-startTime="9516">allowing that to download. </span> <span class="line" data-startTime="9520">But it'll actually display </span><span class="line" data-startTime="9520">the font with a default. </span> <span class="line" data-startTime="9523">It'll just see Arial. </span> <span class="line" data-startTime="9524">So if you're actually </span><span class="line" data-startTime="9524">seeing this on Firefox, </span><span class="line" data-startTime="9526">you'll see three </span><span class="line" data-startTime="9526">seconds of nothing. </span> <span class="line" data-startTime="9527">And then you'll see Arial. </span></p>

<p><span class="line" data-startTime="9528">And then when the </span><span class="line" data-startTime="9528">font comes in, you'll </span><span class="line" data-startTime="9530">see it pop to whatever the </span><span class="line" data-startTime="9530">font is supposed to be. </span> <span class="line" data-startTime="9532">And so you see this flicker. </span> <span class="line" data-startTime="9533">I see it. </span> <span class="line" data-startTime="9534">You see it a lot on mobile, </span><span class="line" data-startTime="9534">because these mobile devices </span><span class="line" data-startTime="9536">are actually 6x slower in </span><span class="line" data-startTime="9536">hardware just across the board, </span><span class="line" data-startTime="9540">probably for at least </span><span class="line" data-startTime="9540">another two years, </span><span class="line" data-startTime="9542">depending on which hardware </span><span class="line" data-startTime="9542">manufacturer you're trending, </span><span class="line" data-startTime="9544">then what you're </span><span class="line" data-startTime="9544">seeing on the desktops. </span> <span class="line" data-startTime="9546">Not only is it slower to </span><span class="line" data-startTime="9546">download these things, </span><span class="line" data-startTime="9548">but these WOFFs are actually </span><span class="line" data-startTime="9548">very complex spline paths </span><span class="line" data-startTime="9550">that actually can be interpreted </span><span class="line" data-startTime="9550">by these under-powered ARM </span><span class="line" data-startTime="9553">chips as well. </span></p>

<p><span class="line" data-startTime="9554">Anyone in here written </span><span class="line" data-startTime="9554">a software rasterizer? </span><span class="line" data-startTime="9557">Cool. </span> <span class="line" data-startTime="9558">Spline paths are slow. </span> <span class="line" data-startTime="9560">Anyhow, WOFFs are bad. </span> <span class="line" data-startTime="9562">And you should </span><span class="line" data-startTime="9562">feel bad if you're </span><span class="line" data-startTime="9564">using them in your </span><span class="line" data-startTime="9564">websites right now. </span> <span class="line" data-startTime="9565">Now, things have been </span><span class="line" data-startTime="9565">happening that are </span><span class="line" data-startTime="9566">trying to optimize this. </span> <span class="line" data-startTime="9567">I know that there's </span><span class="line" data-startTime="9567">people talking </span><span class="line" data-startTime="9568">about different ways to compress </span><span class="line" data-startTime="9568">WOFFS and different ways </span><span class="line" data-startTime="9571">to use these type of </span><span class="line" data-startTime="9571">fonts in different ways. </span> <span class="line" data-startTime="9573">But please note that if you </span><span class="line" data-startTime="9573">have them as part of your site, </span><span class="line" data-startTime="9576">you should feel bad. </span></p>

<p><span class="line" data-startTime="9578">Now, can I shift reload this? </span><span class="line" data-startTime="9581">I don't know. </span> <span class="line" data-startTime="9582">I can't get the data from cache. </span> <span class="line" data-startTime="9583">But we also see and here </span><span class="line" data-startTime="9583">a couple of these things. </span> <span class="line" data-startTime="9586">And I can't show you this. </span> <span class="line" data-startTime="9587">But these images are </span><span class="line" data-startTime="9587">actually a little bit larger </span><span class="line" data-startTime="9590">than they should be as well. </span> <span class="line" data-startTime="9591">These are OK. </span> <span class="line" data-startTime="9593">Is that Willie Nelson? </span><span class="line" data-startTime="9594">I don't know. </span> <span class="line" data-startTime="9596">Again, there's another WOFF. </span> <span class="line" data-startTime="9598">This PNG, where was </span><span class="line" data-startTime="9598">his header on that? </span><span class="line" data-startTime="9600">This one's a WebP. </span> <span class="line" data-startTime="9601">Oh, fantastic. </span> <span class="line" data-startTime="9602">So this guy was </span><span class="line" data-startTime="9602">actually using a WebP. </span> <span class="line" data-startTime="9606">Interesting. </span></p>

<p><span class="line" data-startTime="9607">I don't know what that's doing. </span></p>

<p class="speaker"><span class="line" data-starttime="9607"><span class="speakerName">Audience</span>: That was </span><span class="line" data-startTime="9607">the accept header. </span></p>

<p class="speaker"><span class="line" data-starttime="9608"><span class="speakerName">Colt McAnlis</span>: That was </span><span class="line" data-startTime="9608">the accept header, yeah. </span> <span class="line" data-startTime="9610">So at least a WebP </span><span class="line" data-startTime="9610">did come down. </span> <span class="line" data-startTime="9612">However, we see that &mdash; </span><span class="line" data-startTime="9612">let's go down here. </span> <span class="line" data-startTime="9615">Again, 124K. </span> <span class="line" data-startTime="9616">So again, you guys are </span><span class="line" data-startTime="9616">getting the bad rap, </span><span class="line" data-startTime="9617">because I'm not doing a </span><span class="line" data-startTime="9617">cached fresh reload on this. </span> <span class="line" data-startTime="9621">But basically, this </span><span class="line" data-startTime="9621">site is actually </span><span class="line" data-startTime="9624">passing full megabyte, </span><span class="line" data-startTime="9624">two megabyte images down. </span> <span class="line" data-startTime="9627">It's got the WOFFs in the </span><span class="line" data-startTime="9627">direct path to rendering. </span> <span class="line" data-startTime="9629">And so that's going </span><span class="line" data-startTime="9629">to take a long time </span><span class="line" data-startTime="9631">before text will show up. </span> <span class="line" data-startTime="9632">In fact, the image will try </span><span class="line" data-startTime="9632">to progressively load in </span><span class="line" data-startTime="9634">before all the text does. </span> <span class="line" data-startTime="9636">And this will annoy </span><span class="line" data-startTime="9636">your users a lot more. </span></p>

<p><span class="line" data-startTime="9638">So let's try to avoid that. </span> <span class="line" data-startTime="9640">Let's try another website </span><span class="line" data-startTime="9640">here really quick. </span> <span class="line" data-startTime="9645">Just let me go over to this. </span> <span class="line" data-startTime="9648">Is anyone sad yet about </span><span class="line" data-startTime="9648">the state of things? </span><span class="line" data-startTime="9652">Is anyone going, </span><span class="line" data-startTime="9652">wow, I wonder how </span><span class="line" data-startTime="9653">my site does under </span><span class="line" data-startTime="9653">this type of scrutiny? </span><span class="line" data-startTime="9656">If so, then yay. </span> <span class="line" data-startTime="9656">I'm doing my job. </span> <span class="line" data-startTime="9658">I can get paid this week. </span> <span class="line" data-startTime="9661">Cool. </span> <span class="line" data-startTime="9661">That was actually pretty quick. </span> <span class="line" data-startTime="9663">That actually wasn't that bad. </span> <span class="line" data-startTime="9664">Let me do that again. </span> <span class="line" data-startTime="9671">That actually wasn't that bad. </span> <span class="line" data-startTime="9676">Load, load, load. </span> <span class="line" data-startTime="9677">Good. </span> <span class="line" data-startTime="9678">Cool. </span> <span class="line" data-startTime="9678">OK. </span></p>

<p><span class="line" data-startTime="9679">So this might be a good site. </span> <span class="line" data-startTime="9680">Let's take a look at this one. </span> <span class="line" data-startTime="9681">So we'll hit Inspect again. </span> <span class="line" data-startTime="9682">We'll load it up. </span> <span class="line" data-startTime="9686">Let's see here. </span> <span class="line" data-startTime="9686">Scrolling actually seems </span><span class="line" data-startTime="9686">pretty smooth on this site. </span> <span class="line" data-startTime="9690">It doesn't seem that bad. </span> <span class="line" data-startTime="9693">We can move stuff </span><span class="line" data-startTime="9693">around pretty easily. </span> <span class="line" data-startTime="9696">Let's take a look </span><span class="line" data-startTime="9696">at the Network tab. </span> <span class="line" data-startTime="9697">Let's hit reload again. </span> <span class="line" data-startTime="9703">Again, unfortunately, </span><span class="line" data-startTime="9703">all of this stuff </span><span class="line" data-startTime="9705">is coming from the cache now. </span> <span class="line" data-startTime="9706">I should have used </span><span class="line" data-startTime="9706">my other tablet. </span> <span class="line" data-startTime="9709">.com, CSS, not that bad. </span> <span class="line" data-startTime="9711">22K CSS. </span> <span class="line" data-startTime="9712">27K CSS. </span> <span class="line" data-startTime="9714">200K. </span></p>

<p><span class="line" data-startTime="9715">I don't like this 192K JPEG </span><span class="line" data-startTime="9715">that's only 920 by 300. </span> <span class="line" data-startTime="9722">Notice this. </span> <span class="line" data-startTime="9723">So this is 192K </span><span class="line" data-startTime="9723">for an image that </span><span class="line" data-startTime="9726">is a quarter of </span><span class="line" data-startTime="9726">the size of Putin. </span> <span class="line" data-startTime="9730">Quick show of hands. </span> <span class="line" data-startTime="9731">Who knows what that means? </span><span class="line" data-startTime="9732">Yeah, not optimizing your JPEGs. </span> <span class="line" data-startTime="9735">I think there's actually </span><span class="line" data-startTime="9735">some other bad examples here. </span> <span class="line" data-startTime="9737">Here's another one, 240K. </span> <span class="line" data-startTime="9739">Oh, oh, 240K, 920 by 300. </span> <span class="line" data-startTime="9742">Does anyone off the </span><span class="line" data-startTime="9742">back of your hand </span><span class="line" data-startTime="9744">know what this is if it </span><span class="line" data-startTime="9744">were a raw image size? </span><span class="line" data-startTime="9747">So it's 920 times 300 </span><span class="line" data-startTime="9747">times 24 bits per pixel. </span> <span class="line" data-startTime="9753">Get back to me. </span> <span class="line" data-startTime="9754">Jake will give you some swag. </span></p>

<p><span class="line" data-startTime="9756">Oh, there's a Facebook </span><span class="line" data-startTime="9756">icon, only 9K. </span> <span class="line" data-startTime="9758">Yay. </span> <span class="line" data-startTime="9760">100 by 100 is 9K. </span> <span class="line" data-startTime="9762">That seems a little </span><span class="line" data-startTime="9762">bit excessive. </span> <span class="line" data-startTime="9764">That seems like there's actually </span><span class="line" data-startTime="9764">some bloat going on there. </span> <span class="line" data-startTime="9767">I wonder if there's a </span><span class="line" data-startTime="9767">negative JPEG encoder. </span> <span class="line" data-startTime="9769">Make it larger. </span> <span class="line" data-startTime="9772">By the way, if any of you are </span><span class="line" data-startTime="9772">going to be in San Francisco </span><span class="line" data-startTime="9775">next week or have a chance </span><span class="line" data-startTime="9775">or have the internet, </span><span class="line" data-startTime="9777">I think, definitely tune into my </span><span class="line" data-startTime="9777">talk I'm giving on compression </span><span class="line" data-startTime="9781">on the web. </span> <span class="line" data-startTime="9782">And hopefully, if you've </span><span class="line" data-startTime="9782">seen my talk yesterday </span><span class="line" data-startTime="9784">about being scared of closures, </span><span class="line" data-startTime="9784">if you see my talk next week </span><span class="line" data-startTime="9787">on compression on the web, </span><span class="line" data-startTime="9787">hopefully, compression </span><span class="line" data-startTime="9789">will scare you after that. </span></p>

<p><span class="line" data-startTime="9790">And you'll drudge toward </span><span class="line" data-startTime="9790">that monster with a wary eye. </span> <span class="line" data-startTime="9794">But anyhow, 100K </span><span class="line" data-startTime="9794">pixels is 3.9K in size. </span> <span class="line" data-startTime="9798">So that actually seems a </span><span class="line" data-startTime="9798">little bit excessive there too. </span> <span class="line" data-startTime="9801">Here's, again, those </span><span class="line" data-startTime="9801">are the same images. </span> <span class="line" data-startTime="9803">Here's another one. </span> <span class="line" data-startTime="9804">These are really large, 180K </span><span class="line" data-startTime="9804">being sent to my mobile device. </span> <span class="line" data-startTime="9807">And the reason this </span><span class="line" data-startTime="9807">loaded, again, this </span><span class="line" data-startTime="9809">loaded a little fast. </span> <span class="line" data-startTime="9810">This is a bias, </span><span class="line" data-startTime="9810">because I've been </span><span class="line" data-startTime="9811">testing these things all day. </span> <span class="line" data-startTime="9812">And this is coming from cache. </span></p>

<p><span class="line" data-startTime="9813">So you're not really feeling </span><span class="line" data-startTime="9813">as much pain as you should be. </span> <span class="line" data-startTime="9816">JAKE ARCHIBALD: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="9820"><span class="speakerName">Colt McAnlis</span>: Beautiful. </span><span class="line" data-startTime="9822">All right. </span><span class="line" data-startTime="9822">Jake Archibald for the win. </span><span class="line" data-startTime="9824">Here, let's hit reload now. </span><span class="line" data-startTime="9829">There we go. </span><span class="line" data-startTime="9830">Oh, yeah. </span><span class="line" data-startTime="9832">Oh, feel it. </span><span class="line" data-startTime="9834">Feel it. </span><span class="line" data-startTime="9835">So awkward right now. </span></p>

<p class="speaker"><span class="line" data-starttime="9839"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="9841"><span class="speakerName">Colt McAnlis</span>: They kind </span><span class="line" data-startTime="9841">of should be, yeah. </span><span class="line" data-startTime="9845">No one is hiding </span><span class="line" data-startTime="9845">their face right now. </span><span class="line" data-startTime="9847">So maybe the guy who put </span><span class="line" data-startTime="9847">this site in isn't here. </span><span class="line" data-startTime="9849">Or you've got a </span><span class="line" data-startTime="9849">great poker face. </span><span class="line" data-startTime="9852">I will not bet </span><span class="line" data-startTime="9852">money against you. </span><span class="line" data-startTime="9855">OK. </span></p>

<p class="speaker"><span class="line" data-starttime="9857"><span class="speakerName">Audience</span>: And then they shrank. </span></p>

<p class="speaker"><span class="line" data-starttime="9858"><span class="speakerName">Colt McAnlis</span>: And </span><span class="line" data-startTime="9858">then they shrank. </span><span class="line" data-startTime="9861">That's actually a great point. </span><span class="line" data-startTime="9862">I'll bring this up </span><span class="line" data-startTime="9862">really quick too. </span><span class="line" data-startTime="9864">How many of you have </span><span class="line" data-startTime="9864">responsive websites? </span><span class="line" data-startTime="9867">OK. </span><span class="line" data-startTime="9868">You're doing it wrong. </span><span class="line" data-startTime="9871">Let me ask that in a better way. </span><span class="line" data-startTime="9872">How many of your </span><span class="line" data-startTime="9872">responsive websites </span><span class="line" data-startTime="9874">will actually resize the </span><span class="line" data-startTime="9874">image that you've been given? </span><span class="line" data-startTime="9880">Jake? </span></p>

<p class="speaker"><span class="line" data-starttime="9880"><span class="speakerName">Jake Archibald</span>: What </span><span class="line" data-startTime="9880">do you mean by resize? </span></p>

<p class="speaker"><span class="line" data-starttime="9881"><span class="speakerName">Colt McAnlis</span>: You've </span><span class="line" data-startTime="9881">got a CSS resize, where </span><span class="line" data-startTime="9884">you're changing the </span><span class="line" data-startTime="9884">properties of it. </span> <span class="line" data-startTime="9886">If it comes down as 1024 </span><span class="line" data-startTime="9886">pixels by 1024 pixels </span><span class="line" data-startTime="9889">and you display it as 900 pixels </span><span class="line" data-startTime="9889">by 900 pixels or something </span><span class="line" data-startTime="9893">like that. </span> <span class="line" data-startTime="9894">Anybody resizing? </span><span class="line" data-startTime="9895">You're telling me </span><span class="line" data-startTime="9895">every single one of you </span><span class="line" data-startTime="9897">gives exactly the right pixel </span><span class="line" data-startTime="9897">ratio for every single device </span><span class="line" data-startTime="9900">that loads your website? </span><span class="line" data-startTime="9901">Is that what I'm hearing? </span><span class="line" data-startTime="9903">That guy's hiding his face. </span> <span class="line" data-startTime="9904">So I know he's doing it wrong. </span></p>

<p><span class="line" data-startTime="9905">At least you're honest, brother. </span> <span class="line" data-startTime="9906">I've got some swag </span><span class="line" data-startTime="9906">for you after this. </span> <span class="line" data-startTime="9908">So here's something a </span><span class="line" data-startTime="9908">lot of you don't know. </span> <span class="line" data-startTime="9911">Decoding a JPEG or a PNG </span><span class="line" data-startTime="9911">or a WebP file actually </span><span class="line" data-startTime="9916">takes time from your CPU. </span> <span class="line" data-startTime="9917">And in fact, you know </span><span class="line" data-startTime="9917">how I was talking </span><span class="line" data-startTime="9918">about those tiles </span><span class="line" data-startTime="9918">getting rasterized? </span><span class="line" data-startTime="9920">What happens is before a </span><span class="line" data-startTime="9920">tile can be rasterized, </span><span class="line" data-startTime="9923">Chrome actually has </span><span class="line" data-startTime="9923">to go decompress </span><span class="line" data-startTime="9925">all the images that </span><span class="line" data-startTime="9925">are in that tile. </span> <span class="line" data-startTime="9928">Now, when that tile is </span><span class="line" data-startTime="9928">evicted from the cache, </span><span class="line" data-startTime="9931">we're going to have to repaint </span><span class="line" data-startTime="9931">it again sometime later. </span></p>

<p><span class="line" data-startTime="9933">Well, lo and behold, </span><span class="line" data-startTime="9933">there's actually </span><span class="line" data-startTime="9936">a texture decompression </span><span class="line" data-startTime="9936">cache as well. </span> <span class="line" data-startTime="9938">So there's a chance, a very </span><span class="line" data-startTime="9938">high, high, high chance </span><span class="line" data-startTime="9941">on mobile devices, that we'll </span><span class="line" data-startTime="9941">actually decompress a JPEG file </span><span class="line" data-startTime="9945">and then have to resize the </span><span class="line" data-startTime="9945">uncompressed version of it. </span> <span class="line" data-startTime="9950">So you're actually getting full </span><span class="line" data-startTime="9950">32-bit pixels actually being </span><span class="line" data-startTime="9952">resized from 1024 to 512. </span> <span class="line" data-startTime="9955">And then the next time you </span><span class="line" data-startTime="9955">have to render that image, </span><span class="line" data-startTime="9957">you have to decompress </span><span class="line" data-startTime="9957">it and resize it again. </span></p>

<p><span class="line" data-startTime="9960">So if an image is split </span><span class="line" data-startTime="9960">between two tiles, </span><span class="line" data-startTime="9962">you can run into a very </span><span class="line" data-startTime="9962">awkward situation, where </span><span class="line" data-startTime="9965">you have to decode and resize </span><span class="line" data-startTime="9965">that image for each tile </span><span class="line" data-startTime="9969">that it's split in. </span> <span class="line" data-startTime="9971">So if you are resizing your </span><span class="line" data-startTime="9971">images dynamically right now, </span><span class="line" data-startTime="9975">this could be a </span><span class="line" data-startTime="9975">problem for your site. </span> <span class="line" data-startTime="9978">Hopefully, some of you &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="9979"><span class="speakerName">Audience</span>: So should we </span><span class="line" data-startTime="9979">not do dynamic websites? </span></p>

<p class="speaker"><span class="line" data-starttime="9983"><span class="speakerName">Colt McAnlis</span>: Save the </span><span class="line" data-startTime="9983">questions for the end. </span> <span class="line" data-startTime="9985">I said it to that guy. </span> <span class="line" data-startTime="9986">I've got to say it to you too. </span> <span class="line" data-startTime="9988">Was that because I </span><span class="line" data-startTime="9988">called you Forecast.io? </span><span class="line" data-startTime="9990">OK. </span> <span class="line" data-startTime="9990">That's all right. </span> <span class="line" data-startTime="9991">Much love. </span> <span class="line" data-startTime="9993">Anyhow, so I think we see that </span><span class="line" data-startTime="9993">this website has some issues. </span> <span class="line" data-startTime="9997">And most of it is </span><span class="line" data-startTime="9997">on the Network tab. </span> <span class="line" data-startTime="9999">Let me go ahead and turn </span><span class="line" data-startTime="9999">on continuous show paint </span><span class="line" data-startTime="10003">rectangles as well, because </span><span class="line" data-startTime="10003">I want to show this off too. </span></p>

<p><span class="line" data-startTime="10007">So see that red rectangle? </span><span class="line" data-startTime="10008">You can see this little one. </span> <span class="line" data-startTime="10009">Let me show it on </span><span class="line" data-startTime="10009">the screen here. </span> <span class="line" data-startTime="10010">You can see this one </span><span class="line" data-startTime="10010">little pop it up. </span> <span class="line" data-startTime="10012">But watch this red rectangle </span><span class="line" data-startTime="10012">happen full screen. </span> <span class="line" data-startTime="10014">Did you see that? </span><span class="line" data-startTime="10015">See that again? </span><span class="line" data-startTime="10019">I see this almost on every </span><span class="line" data-startTime="10019">single site on this list. </span> <span class="line" data-startTime="10022">Basically, they got </span><span class="line" data-startTime="10022">a marquee on top. </span> <span class="line" data-startTime="10024">And that marquee, </span><span class="line" data-startTime="10024">for some reason, </span><span class="line" data-startTime="10026">is actually invalidating the </span><span class="line" data-startTime="10026">entire page below it as well. </span> <span class="line" data-startTime="10030">So the actual DIV that's </span><span class="line" data-startTime="10030">expanding this thing, that's </span><span class="line" data-startTime="10034">getting repainted, is </span><span class="line" data-startTime="10034">touching every single pixel </span><span class="line" data-startTime="10036">on the page, which </span><span class="line" data-startTime="10036">means that even sitting </span><span class="line" data-startTime="10039">here doing nothing, where </span><span class="line" data-startTime="10039">actually the CPU is just </span><span class="line" data-startTime="10041">sitting here </span><span class="line" data-startTime="10041">spinning and spinning </span><span class="line" data-startTime="10042">and spinning and spinning </span><span class="line" data-startTime="10042">and working and working. </span></p>

<p><span class="line" data-startTime="10044">And that's actually going to </span><span class="line" data-startTime="10044">make scrolling not as smooth </span><span class="line" data-startTime="10046">as possible. </span> <span class="line" data-startTime="10047">And you can't see it. </span> <span class="line" data-startTime="10048">I can feel it a little bit here. </span> <span class="line" data-startTime="10050">This is actually a </span><span class="line" data-startTime="10050">pretty janky website. </span> <span class="line" data-startTime="10051">Up at the top, it says that our </span><span class="line" data-startTime="10051">average frame rate right now </span><span class="line" data-startTime="10054">is about 18 frames a </span><span class="line" data-startTime="10054">second, 17 frames a second. </span> <span class="line" data-startTime="10058">I can actually really </span><span class="line" data-startTime="10058">feel this on mobile. </span> <span class="line" data-startTime="10061">Now, I have 30 minutes. </span> <span class="line" data-startTime="10062">Yes. </span> <span class="line" data-startTime="10063">15 minutes of filler. </span></p>

<p><span class="line" data-startTime="10065">So obviously, this is a problem. </span> <span class="line" data-startTime="10067">And because when I see </span><span class="line" data-startTime="10067">something dynamic like this, </span><span class="line" data-startTime="10068">I generally think that memory </span><span class="line" data-startTime="10068">is going wonky as well. </span> <span class="line" data-startTime="10071">So let's go ahead and do a </span><span class="line" data-startTime="10071">timeline and hit record again. </span> <span class="line" data-startTime="10073">Let's see what's going on. </span> <span class="line" data-startTime="10078">We've seen this before. </span> <span class="line" data-startTime="10080">Same pattern we saw </span><span class="line" data-startTime="10080">with the other site. </span> <span class="line" data-startTime="10083">We see just memory being </span><span class="line" data-startTime="10083">allocated and allocated </span><span class="line" data-startTime="10085">and allocated and allocated. </span> <span class="line" data-startTime="10087">Let's hit stop and </span><span class="line" data-startTime="10087">see if we can drill in </span><span class="line" data-startTime="10088">and see what the culprit is. </span> <span class="line" data-startTime="10089">Again, I know nothing </span><span class="line" data-startTime="10089">of these websites. </span> <span class="line" data-startTime="10092">I'm just a primitive </span><span class="line" data-startTime="10092">C++ developer. </span> <span class="line" data-startTime="10094">Your web development </span><span class="line" data-startTime="10094">scares and confuses me. </span></p>

<p><span class="line" data-startTime="10097">So let's go to Profile. </span> <span class="line" data-startTime="10100">And let's do a record </span><span class="line" data-startTime="10100">heap allocations. </span> <span class="line" data-startTime="10102">So we can see that </span><span class="line" data-startTime="10102">memory is a problem. </span> <span class="line" data-startTime="10103">Now, let's dig in a </span><span class="line" data-startTime="10103">little bit deeper. </span> <span class="line" data-startTime="10105">Let's record a heap application. </span> <span class="line" data-startTime="10107">OK. </span> <span class="line" data-startTime="10107">Again, I'm not touching </span><span class="line" data-startTime="10107">anything on the website. </span> <span class="line" data-startTime="10109">And memory, 10K, 5K, 10K, 5K. </span> <span class="line" data-startTime="10112">Let's hit stop. </span> <span class="line" data-startTime="10115">Let's try to drill in </span><span class="line" data-startTime="10115">here on one of these guys. </span> <span class="line" data-startTime="10118">Let's just look at this one. </span> <span class="line" data-startTime="10119">Compiled code. </span> <span class="line" data-startTime="10121">Looks familiar again. </span> <span class="line" data-startTime="10123">Oh, wow. </span> <span class="line" data-startTime="10124">It's almost like we've seen </span><span class="line" data-startTime="10124">this exact three lines of code </span><span class="line" data-startTime="10127">before. </span> <span class="line" data-startTime="10128">So again, I know </span><span class="line" data-startTime="10128">nothing of this website. </span> <span class="line" data-startTime="10130">I haven't even looked </span><span class="line" data-startTime="10130">at the source code yet. </span> <span class="line" data-startTime="10132">But something in here is </span><span class="line" data-startTime="10132">already passing a closure </span><span class="line" data-startTime="10134">to a set timeout </span><span class="line" data-startTime="10134">or a set interval. </span> <span class="line" data-startTime="10136">Sorry. </span></p>

<p><span class="line" data-startTime="10137">Set timeout is a different </span><span class="line" data-startTime="10137">operating system. </span> <span class="line" data-startTime="10138">But there's some other </span><span class="line" data-startTime="10138">stuff going on in here too. </span> <span class="line" data-startTime="10141">It looks like some other </span><span class="line" data-startTime="10141">relocation info is going on. </span> <span class="line" data-startTime="10143">I don't see any </span><span class="line" data-startTime="10143">injections, which is good. </span> <span class="line" data-startTime="10145">No one's calling eval, because, </span><span class="line" data-startTime="10145">otherwise, we'd probably </span><span class="line" data-startTime="10147">see the 6K worth of information. </span> <span class="line" data-startTime="10150">Someone laughed. </span> <span class="line" data-startTime="10150">That's probably good. </span> <span class="line" data-startTime="10151">Eval is bad. </span> <span class="line" data-startTime="10152">And you should feel bad. </span> <span class="line" data-startTime="10153">So if you're using closures </span><span class="line" data-startTime="10153">and eval, just get out. </span> <span class="line" data-startTime="10155">Just get out, dude. </span> <span class="line" data-startTime="10159">I'm going to see a tweet. </span> <span class="line" data-startTime="10160">Colt says, use set interval </span><span class="line" data-startTime="10160">with closure and eval &mdash; </span><span class="line" data-startTime="10163">perfmatters &mdash; inside of a WOFF. </span> <span class="line" data-startTime="10167">By the way, I saw </span><span class="line" data-startTime="10167">someone the other day </span><span class="line" data-startTime="10168">that actually had a WOFF </span><span class="line" data-startTime="10168">embedded inside of a CSS. </span> <span class="line" data-startTime="10171">And I was like, that's just a </span><span class="line" data-startTime="10171">bad idea from all principles. </span> <span class="line" data-startTime="10174">The CSS gets bloated. </span></p>

<p><span class="line" data-startTime="10175">And then the WOFF </span><span class="line" data-startTime="10175">has to be &mdash; Anyhow, </span><span class="line" data-startTime="10178">we see that this other </span><span class="line" data-startTime="10178">part is an array. </span> <span class="line" data-startTime="10180">Now, this is interesting. </span> <span class="line" data-startTime="10181">So when you see </span><span class="line" data-startTime="10181">this array object, </span><span class="line" data-startTime="10182">this means this is an </span><span class="line" data-startTime="10182">actual JavaScript array that </span><span class="line" data-startTime="10184">is allocated </span><span class="line" data-startTime="10184">somewhere on the page. </span> <span class="line" data-startTime="10186">And you can see </span><span class="line" data-startTime="10186">some of it is coming </span><span class="line" data-startTime="10187">from internal with </span><span class="line" data-startTime="10187">V8, the code DOP data. </span> <span class="line" data-startTime="10190">But otherwise, the </span><span class="line" data-startTime="10190">relocation info &mdash; here's </span><span class="line" data-startTime="10192">a null array is just being </span><span class="line" data-startTime="10192">created for no reason. </span> <span class="line" data-startTime="10196">And no items are </span><span class="line" data-startTime="10196">being added to it. </span> <span class="line" data-startTime="10198">We can go down here to string. </span> <span class="line" data-startTime="10200">And we can see a GM string </span><span class="line" data-startTime="10200">has been created somewhere. </span> <span class="line" data-startTime="10204">Let's scroll this up. </span> <span class="line" data-startTime="10205">Do we have any information? </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="10205"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="10206"><span class="speakerName">Colt McAnlis</span>: Yeah. </span> <span class="line" data-startTime="10207">Yeah. </span> <span class="line" data-startTime="10208">That's what's going on here. </span> <span class="line" data-startTime="10209">So there's a regex </span><span class="line" data-startTime="10209">occurring somewhere. </span> <span class="line" data-startTime="10211">A GM is being created. </span> <span class="line" data-startTime="10212">And then there's some </span><span class="line" data-startTime="10212">system-level stuff. </span> <span class="line" data-startTime="10213">This is mostly </span><span class="line" data-startTime="10213">dragons and krakens </span><span class="line" data-startTime="10216">and other things going </span><span class="line" data-startTime="10216">on under the hood. </span> <span class="line" data-startTime="10217">If we expand this </span><span class="line" data-startTime="10217">a little bit, we </span><span class="line" data-startTime="10219">can actually slide over and </span><span class="line" data-startTime="10219">see, again, compiled code. </span> <span class="line" data-startTime="10222">There's another relocation info. </span> <span class="line" data-startTime="10224">Let's see if there's </span><span class="line" data-startTime="10224">a DOP this time. </span> <span class="line" data-startTime="10225">No. </span> <span class="line" data-startTime="10226">That makes sense, because </span><span class="line" data-startTime="10226">the spike's not as high. </span></p>

<p><span class="line" data-startTime="10228">We're on this guy. </span> <span class="line" data-startTime="10229">Compiled code. </span> <span class="line" data-startTime="10230">Relocation. </span> <span class="line" data-startTime="10231">Spike's not as high again. </span> <span class="line" data-startTime="10232">So again, DOP is actually what's </span><span class="line" data-startTime="10232">causing the memory spike here. </span> <span class="line" data-startTime="10234">And then, of course, that's </span><span class="line" data-startTime="10234">causing inflation in our heap. </span> <span class="line" data-startTime="10237">So we can actually see </span><span class="line" data-startTime="10237">there's a couple problems. </span> <span class="line" data-startTime="10238">Obviously, they're sending </span><span class="line" data-startTime="10238">too much data down the pipe. </span> <span class="line" data-startTime="10240">This page is loading slowly. </span> <span class="line" data-startTime="10241">The person should feel bad. </span> <span class="line" data-startTime="10243">They've also got some </span><span class="line" data-startTime="10243">timers and some closures </span><span class="line" data-startTime="10245">and some memory leak </span><span class="line" data-startTime="10245">issues that are causing </span><span class="line" data-startTime="10247">some friction with their users. </span> <span class="line" data-startTime="10248">Let's load another site. </span> <span class="line" data-startTime="10257">Chrome always, thank you. </span> <span class="line" data-startTime="10260">So let's see this one. </span> <span class="line" data-startTime="10261">Who thinks this is </span><span class="line" data-startTime="10261">going to be a fast site? </span><span class="line" data-startTime="10263">Show of hands. </span> <span class="line" data-startTime="10265">No hands. </span></p>

<p><span class="line" data-startTime="10265">Good job. </span> <span class="line" data-startTime="10266">You win. </span> <span class="line" data-startTime="10268">I like the spinner. </span> <span class="line" data-startTime="10269">We're trying to load. </span> <span class="line" data-startTime="10271">We're letting you know that </span><span class="line" data-startTime="10271">we don't know how to do this. </span> <span class="line" data-startTime="10274">Sorry. </span> <span class="line" data-startTime="10274">That was below the belt. </span> <span class="line" data-startTime="10275">I'm sorry. </span> <span class="line" data-startTime="10275">I'm sorry. </span> <span class="line" data-startTime="10277">I'm sorry. </span> <span class="line" data-startTime="10280">I'm sorry. </span> <span class="line" data-startTime="10281">That was a good idea. </span> <span class="line" data-startTime="10282">We see it in Gmail. </span> <span class="line" data-startTime="10283">I don't know. </span> <span class="line" data-startTime="10284">It's like, hey, we're not </span><span class="line" data-startTime="10284">ready to figure out how </span><span class="line" data-startTime="10287">to steam content yet. </span> <span class="line" data-startTime="10288">We saw load. </span></p>

<p><span class="line" data-startTime="10289">That was good. </span> <span class="line" data-startTime="10290">So let's do this again. </span> <span class="line" data-startTime="10291">Actually, let me show. </span> <span class="line" data-startTime="10293">Scrolling doesn't seem that bad. </span> <span class="line" data-startTime="10296">Let's click on something. </span> <span class="line" data-startTime="10299">That was actually pretty fast. </span> <span class="line" data-startTime="10301">That was actually </span><span class="line" data-startTime="10301">a little too fast. </span> <span class="line" data-startTime="10302">Hold on. </span> <span class="line" data-startTime="10304">Wait a minute. </span> <span class="line" data-startTime="10305">Let me go back. </span> <span class="line" data-startTime="10306">I'm back to slow. </span> <span class="line" data-startTime="10307">Let me click on something </span><span class="line" data-startTime="10307">else, like trust no one. </span> <span class="line" data-startTime="10309">I don't trust anybody. </span> <span class="line" data-startTime="10312">Wow, that actually loaded a </span><span class="line" data-startTime="10312">lot faster than the main site. </span></p>

<p><span class="line" data-startTime="10314">Let's drill in here. </span></p>

<p class="speaker"><span class="line" data-starttime="10316"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="10319"><span class="speakerName">Colt McAnlis</span>: Dude, </span><span class="line" data-startTime="10319">you're messing it up. </span><span class="line" data-startTime="10323">Jake, who's got the microphone? </span></p>

<p class="speaker"><span class="line" data-starttime="10324"><span class="speakerName">Jake Archibald</span>: I'm sorry. </span></p>

<p class="speaker"><span class="line" data-starttime="10326"><span class="speakerName">Colt McAnlis</span>: I didn't </span><span class="line" data-startTime="10326">interrupt your talk. </span> <span class="line" data-startTime="10329">So let's take a </span><span class="line" data-startTime="10329">look at this here. </span> <span class="line" data-startTime="10330">So I'm going to </span><span class="line" data-startTime="10330">go to Network tab. </span> <span class="line" data-startTime="10333">And I'm going to hit </span><span class="line" data-startTime="10333">reload again here. </span> <span class="line" data-startTime="10336">And we're going to </span><span class="line" data-startTime="10336">take a look at this. </span> <span class="line" data-startTime="10337">Let's see what's going on. </span> <span class="line" data-startTime="10338">So it was really weird. </span> <span class="line" data-startTime="10339">The main page loaded slow. </span> <span class="line" data-startTime="10340">That was awkward. </span> <span class="line" data-startTime="10341">But then all subsequent </span><span class="line" data-startTime="10341">clicks loaded actually really, </span><span class="line" data-startTime="10344">really, really </span><span class="line" data-startTime="10344">fast, which tells us </span><span class="line" data-startTime="10346">if you can't get </span><span class="line" data-startTime="10346">the main page right, </span><span class="line" data-startTime="10348">why are you getting </span><span class="line" data-startTime="10348">the sub-clicks right? </span><span class="line" data-startTime="10349">That's kind of awkward. </span></p>

<p><span class="line" data-startTime="10351">So we're still loading. </span> <span class="line" data-startTime="10352">We're still loading. </span> <span class="line" data-startTime="10353">We're still loading. </span> <span class="line" data-startTime="10354">Again, I always sort </span><span class="line" data-startTime="10354">by size, because I'm </span><span class="line" data-startTime="10357">a big dude who says that </span><span class="line" data-startTime="10357">memory is where the performance </span><span class="line" data-startTime="10359">problems are. </span> <span class="line" data-startTime="10362">We can actually see </span><span class="line" data-startTime="10362">that they're loading. </span> <span class="line" data-startTime="10367">And I'll give away </span><span class="line" data-startTime="10367">the punchline here. </span> <span class="line" data-startTime="10369">But these images were on the </span><span class="line" data-startTime="10369">sub pages, not the main page. </span> <span class="line" data-startTime="10373">But they're being </span><span class="line" data-startTime="10373">loaded on the main page. </span> <span class="line" data-startTime="10377">Anyone figure it out yet? </span><span class="line" data-startTime="10378">Basically, what they're </span><span class="line" data-startTime="10378">doing is they're </span><span class="line" data-startTime="10379">loading all of the images </span><span class="line" data-startTime="10379">for all of the articles </span><span class="line" data-startTime="10382">that you would click to before </span><span class="line" data-startTime="10382">the main page is loaded. </span></p>

<p><span class="line" data-startTime="10386">So they're basically </span><span class="line" data-startTime="10386">trading off. </span> <span class="line" data-startTime="10388">They're saying your </span><span class="line" data-startTime="10388">initial load time </span><span class="line" data-startTime="10390">is going to be really crummy. </span> <span class="line" data-startTime="10391">But every click after that </span><span class="line" data-startTime="10391">is going to be golden. </span> <span class="line" data-startTime="10393">So they're giving up that </span><span class="line" data-startTime="10393">initial three-second load time </span><span class="line" data-startTime="10395">to get one-second </span><span class="line" data-startTime="10395">load times later. </span> <span class="line" data-startTime="10398">Maybe that's a discussion. </span> <span class="line" data-startTime="10399">Again, here's a WOFF. </span> <span class="line" data-startTime="10401">Anyone like WOFFs now? </span><span class="line" data-startTime="10403">The answer should be no. </span> <span class="line" data-startTime="10404">But yeah, this is </span><span class="line" data-startTime="10404">really interesting </span><span class="line" data-startTime="10405">that we're seeing </span><span class="line" data-startTime="10405">some of these images. </span> <span class="line" data-startTime="10406">Let me see if I </span><span class="line" data-startTime="10406">can sort this again </span><span class="line" data-startTime="10408">and see if we can't get better. </span> <span class="line" data-startTime="10410">Here's another PNG. </span> <span class="line" data-startTime="10411">Again, this is not </span><span class="line" data-startTime="10411">on the main page. </span></p>

<p><span class="line" data-startTime="10413">So let me hit back here. </span> <span class="line" data-startTime="10415">Let's show you the </span><span class="line" data-startTime="10415">main page here. </span> <span class="line" data-startTime="10419">Even clicking back </span><span class="line" data-startTime="10419">takes some time. </span> <span class="line" data-startTime="10424">No? </span><span class="line" data-startTime="10426">Backy? </span><span class="line" data-startTime="10429">No, I guess not. </span></p>

<p class="speaker"><span class="line" data-starttime="10430"><span class="speakerName">Audience</span>: You can do it. </span></p>

<p class="speaker"><span class="line" data-starttime="10431"><span class="speakerName">Colt McAnlis</span>: We're stuck now. </span> <span class="line" data-startTime="10433">There we go. </span> <span class="line" data-startTime="10435">So yeah. </span> <span class="line" data-startTime="10435">So notice this right here. </span> <span class="line" data-startTime="10436">So this was one of the </span><span class="line" data-startTime="10436">last things I clicked on. </span> <span class="line" data-startTime="10438">And they have a </span><span class="line" data-startTime="10438">little drop-down. </span> <span class="line" data-startTime="10440">So basically, each one of </span><span class="line" data-startTime="10440">these items, the images </span><span class="line" data-startTime="10443">and the extra content is </span><span class="line" data-startTime="10443">loaded in the main page, not </span><span class="line" data-startTime="10447">the subsequent page. </span> <span class="line" data-startTime="10448">We're seeing that break down </span><span class="line" data-startTime="10448">in a lot of these charts here. </span> <span class="line" data-startTime="10454">They have a couple lower </span><span class="line" data-startTime="10454">res versions here too. </span> <span class="line" data-startTime="10457">So remember when that 100 pixel </span><span class="line" data-startTime="10457">by 100 pixel Facebook icon </span><span class="line" data-startTime="10461">was 9K? </span><span class="line" data-startTime="10462">Here's a 320 by 180 that's 10K. </span> <span class="line" data-startTime="10465">So again, don't trust </span><span class="line" data-startTime="10465">your Facebook icons. </span> <span class="line" data-startTime="10467">I would like to say, </span><span class="line" data-startTime="10467">don't trust Facebook. </span></p>

<p><span class="line" data-startTime="10469">But I'm not allowed </span><span class="line" data-startTime="10469">to say that on camera. </span> <span class="line" data-startTime="10471">Shit. </span> <span class="line" data-startTime="10473">Sorry. </span> <span class="line" data-startTime="10474">Again, perfect. </span> <span class="line" data-startTime="10476">Here's a 320 by 180 </span><span class="line" data-startTime="10476">that's exactly 9.1K. </span> <span class="line" data-startTime="10479">So again, I think </span><span class="line" data-startTime="10479">all of you should </span><span class="line" data-startTime="10480">be questioning how </span><span class="line" data-startTime="10480">big your images are. </span> <span class="line" data-startTime="10482">But I think this Quartz site </span><span class="line" data-startTime="10482">is actually an interesting case </span><span class="line" data-startTime="10485">study, because they've </span><span class="line" data-startTime="10485">definitely traded off </span><span class="line" data-startTime="10487">one type of load time for </span><span class="line" data-startTime="10487">another type of load time. </span> <span class="line" data-startTime="10491">And I'm not really </span><span class="line" data-startTime="10491">sure why or where </span><span class="line" data-startTime="10495">the justifications of that are. </span></p>

<p><span class="line" data-startTime="10496">But I think we </span><span class="line" data-startTime="10496">can definitely all </span><span class="line" data-startTime="10498">agree that the 20 years </span><span class="line" data-startTime="10498">that we've had on the web </span><span class="line" data-startTime="10500">have all accumulated that the </span><span class="line" data-startTime="10500">initial load time is pretty </span><span class="line" data-startTime="10503">much the most important </span><span class="line" data-startTime="10503">thing, because that's </span><span class="line" data-startTime="10505">the first thing your user feels. </span> <span class="line" data-startTime="10507">None of you have seen this </span><span class="line" data-startTime="10507">site, except for the one </span><span class="line" data-startTime="10509">guy who submitted it. </span> <span class="line" data-startTime="10510">And all of you felt the </span><span class="line" data-startTime="10510">pain of this site loading </span><span class="line" data-startTime="10512">for me hitting a button. </span> <span class="line" data-startTime="10514">And it doesn't matter how much </span><span class="line" data-startTime="10514">the clicks after that are. </span> <span class="line" data-startTime="10516">Most of us would have left the </span><span class="line" data-startTime="10516">site before we got to that. </span> <span class="line" data-startTime="10518">Let me go over here too. </span></p>

<p><span class="line" data-startTime="10520">I want to show this. </span> <span class="line" data-startTime="10521">So notice this &mdash; I moved now &mdash; </span><span class="line" data-startTime="10521">but this YouTube image here. </span> <span class="line" data-startTime="10527">So if I click this </span><span class="line" data-startTime="10527">button, you'll </span><span class="line" data-startTime="10528">see the red boxes </span><span class="line" data-startTime="10528">again show up here. </span> <span class="line" data-startTime="10531">So we can actually see </span><span class="line" data-startTime="10531">that that part of the page </span><span class="line" data-startTime="10535">is being re-rendered. </span> <span class="line" data-startTime="10538">So you can see, again, </span><span class="line" data-startTime="10538">that it's showing &mdash; nope. </span> <span class="line" data-startTime="10541">Don't care. </span> <span class="line" data-startTime="10541">Don't care. </span> <span class="line" data-startTime="10542">Don't. </span> <span class="line" data-startTime="10543">No, dumb. </span> <span class="line" data-startTime="10544">Stop. </span> <span class="line" data-startTime="10545">Stop. </span> <span class="line" data-startTime="10546">Let me click. </span> <span class="line" data-startTime="10547">Done. </span> <span class="line" data-startTime="10548">What I'd really </span><span class="line" data-startTime="10548">like to show here, </span><span class="line" data-startTime="10549">and this isn't really showing </span><span class="line" data-startTime="10549">up on the main screen. </span> <span class="line" data-startTime="10551">I'm sorry. </span> <span class="line" data-startTime="10552">But can anyone see this </span><span class="line" data-startTime="10552">orange line right here? </span><span class="line" data-startTime="10554">This orange line? </span><span class="line" data-startTime="10555">So one of the other </span><span class="line" data-startTime="10555">interesting things, </span><span class="line" data-startTime="10556">there's a talk that I gave at </span><span class="line" data-startTime="10556">Google I/O this year on this. </span></p>

<p><span class="line" data-startTime="10559">It's called webpage design </span><span class="line" data-startTime="10559">with the GPU in mind. </span> <span class="line" data-startTime="10563">So what happens is </span><span class="line" data-startTime="10563">certain elements on a page </span><span class="line" data-startTime="10566">are &mdash; Imagine your </span><span class="line" data-startTime="10566">page is a plane. </span> <span class="line" data-startTime="10568">And all of your images </span><span class="line" data-startTime="10568">and all of your text </span><span class="line" data-startTime="10569">exist on this plane. </span> <span class="line" data-startTime="10571">Some of those </span><span class="line" data-startTime="10571">things are actually </span><span class="line" data-startTime="10572">propagated to its own plane, so </span><span class="line" data-startTime="10572">that the webpage can actually </span><span class="line" data-startTime="10576">scroll in the background. </span> <span class="line" data-startTime="10577">And this other plane can </span><span class="line" data-startTime="10577">actually scroll relative to it. </span> <span class="line" data-startTime="10581">So there is relative </span><span class="line" data-startTime="10581">scrolling concept. </span></p>

<p><span class="line" data-startTime="10583">Let me actually show you </span><span class="line" data-startTime="10583">this on a big screen here. </span> <span class="line" data-startTime="10586">Let me load up HTML5rocks. </span> <span class="line" data-startTime="10592">No. </span> <span class="line" data-startTime="10593">I typed in the wrong </span><span class="line" data-startTime="10593">thing, because I can type. </span> <span class="line" data-startTime="10601">Who's on my internet? </span><span class="line" data-startTime="10607">Watch my Wi-Fi go down now. </span> <span class="line" data-startTime="10612">We'll try that. </span> <span class="line" data-startTime="10612">There we go. </span> <span class="line" data-startTime="10614">So I'm going to pick a random </span><span class="line" data-startTime="10614">article with some random guy </span><span class="line" data-startTime="10618">on it, some random </span><span class="line" data-startTime="10618">good-looking guy. </span> <span class="line" data-startTime="10621">I think he's pretty </span><span class="line" data-startTime="10621">good looking. </span> <span class="line" data-startTime="10622">Bald is beautiful here. </span></p>

<p><span class="line" data-startTime="10624">So let's go ahead and turn on. </span> <span class="line" data-startTime="10626">This is Chrome DevTools </span><span class="line" data-startTime="10626">on a desktop site. </span> <span class="line" data-startTime="10628">I know I wasn't going </span><span class="line" data-startTime="10628">to talk about this. </span> <span class="line" data-startTime="10629">But let's do forced accelerated </span><span class="line" data-startTime="10629">and show composite layer </span><span class="line" data-startTime="10632">borders. </span> <span class="line" data-startTime="10632">So turning on layer </span><span class="line" data-startTime="10632">borders here shows us </span><span class="line" data-startTime="10634">what we're seeing normally. </span> <span class="line" data-startTime="10636">The first thing you see is </span><span class="line" data-startTime="10636">that the blue lines here </span><span class="line" data-startTime="10639">actually represent the </span><span class="line" data-startTime="10639">tiling of the page. </span> <span class="line" data-startTime="10641">And this orange line </span><span class="line" data-startTime="10641">actually represents </span><span class="line" data-startTime="10643">something that's been </span><span class="line" data-startTime="10643">promoted to its own layer. </span> <span class="line" data-startTime="10645">So how many of you are </span><span class="line" data-startTime="10645">using translateZ(0)? </span><span class="line" data-startTime="10647">TranslateZ(0). </span></p>

<p><span class="line" data-startTime="10648">Translate3D. </span> <span class="line" data-startTime="10649">This is the hardware-accelerated </span><span class="line" data-startTime="10649">fast path, the silver bullet </span><span class="line" data-startTime="10652">that makes your web fast, </span><span class="line" data-startTime="10652">because you're suddenly </span><span class="line" data-startTime="10654">using the GPU on the web. </span> <span class="line" data-startTime="10656">It's so amazing. </span> <span class="line" data-startTime="10657">Actually, that's </span><span class="line" data-startTime="10657">not how it works. </span> <span class="line" data-startTime="10659">What happens is when you use </span><span class="line" data-startTime="10659">translateZ(0) or translate3D, </span><span class="line" data-startTime="10662">you're actually promoting </span><span class="line" data-startTime="10662">these pieces of content </span><span class="line" data-startTime="10664">to its own plane. </span> <span class="line" data-startTime="10665">This is actually a </span><span class="line" data-startTime="10665">separate set of tiles. </span> <span class="line" data-startTime="10667">So remember how I said </span><span class="line" data-startTime="10667">the GPU will actually </span><span class="line" data-startTime="10669">scroll your tiles on the screen? </span><span class="line" data-startTime="10671">When you actually </span><span class="line" data-startTime="10671">use translateZ(0), </span><span class="line" data-startTime="10673">you get another layer that </span><span class="line" data-startTime="10673">the GPU also controls. </span> <span class="line" data-startTime="10675">Now, I'm going to </span><span class="line" data-startTime="10675">see if I can do this, </span><span class="line" data-startTime="10677">because for some reason we </span><span class="line" data-startTime="10677">get paused in the debug. </span> <span class="line" data-startTime="10681">Too much clicking. </span> <span class="line" data-startTime="10682">So as I scroll here, notice </span><span class="line" data-startTime="10682">how these objects on the side &mdash; </span><span class="line" data-startTime="10688">watch this. </span> <span class="line" data-startTime="10688">The table of contents </span><span class="line" data-startTime="10688">has not orange. </span></p>

<p><span class="line" data-startTime="10691">And so once it gets </span><span class="line" data-startTime="10691">to a certain part, </span><span class="line" data-startTime="10693">it actually gets promoted </span><span class="line" data-startTime="10693">to its own layer. </span> <span class="line" data-startTime="10695">The orange border represents </span><span class="line" data-startTime="10695">different layers in GPU memory. </span> <span class="line" data-startTime="10699">And then as I scroll </span><span class="line" data-startTime="10699">down the page, </span><span class="line" data-startTime="10701">they actually stay static. </span> <span class="line" data-startTime="10702">Any time you have relative </span><span class="line" data-startTime="10702">scrolling content on your page, </span><span class="line" data-startTime="10704">you're actually going </span><span class="line" data-startTime="10704">to want to promote it </span><span class="line" data-startTime="10706">with this translateZ(0) </span><span class="line" data-startTime="10706">or translate3D. </span> <span class="line" data-startTime="10708">Now, beware that this actually </span><span class="line" data-startTime="10708">puts a lot of pressure </span><span class="line" data-startTime="10711">on your GPU. </span> <span class="line" data-startTime="10711">So for all of you </span><span class="line" data-startTime="10711">who are just going </span><span class="line" data-startTime="10713">to start putting translateZ(0) </span><span class="line" data-startTime="10713">on every part of your page &mdash; </span><span class="line" data-startTime="10716">we saw this happen </span><span class="line" data-startTime="10716">a lot because it </span><span class="line" data-startTime="10717">was supposed to be </span><span class="line" data-startTime="10717">a silver bullet &mdash; </span><span class="line" data-startTime="10719">every one of these tiles, </span><span class="line" data-startTime="10719">every one of these layers, </span><span class="line" data-startTime="10721">is actually contending for </span><span class="line" data-startTime="10721">residency inside of your GPU </span><span class="line" data-startTime="10724">cache, which means the more </span><span class="line" data-startTime="10724">of these separate layers </span><span class="line" data-startTime="10726">that you've actually promoted, </span><span class="line" data-startTime="10726">the slower your website is </span><span class="line" data-startTime="10729">going to be. </span></p>

<p><span class="line" data-startTime="10730">So you can get an </span><span class="line" data-startTime="10730">inverse effect with it, </span><span class="line" data-startTime="10732">because, basically, your </span><span class="line" data-startTime="10732">GPU is getting overtaxed. </span> <span class="line" data-startTime="10734">More tiles are being </span><span class="line" data-startTime="10734">evicted from your cache, </span><span class="line" data-startTime="10736">because more things are </span><span class="line" data-startTime="10736">fighting for residency. </span> <span class="line" data-startTime="10738">It's actually going to </span><span class="line" data-startTime="10738">slow down your site, </span><span class="line" data-startTime="10740">because your CPU is </span><span class="line" data-startTime="10740">spinning out more. </span> <span class="line" data-startTime="10741">Anyhow, enough with </span><span class="line" data-startTime="10741">the desktop stuff. </span> <span class="line" data-startTime="10743">Desktop is dead. </span> <span class="line" data-startTime="10744">No one wants desktop. </span> <span class="line" data-startTime="10745">OK. </span> <span class="line" data-startTime="10746">Let's go back over </span><span class="line" data-startTime="10746">here to this thing, </span><span class="line" data-startTime="10747">because the mobile web is sexy. </span> <span class="line" data-startTime="10750">What was I showing off? </span><span class="line" data-startTime="10751">Yeah. </span> <span class="line" data-startTime="10752">So this qz site, this </span><span class="line" data-startTime="10752">is actually a little bit </span><span class="line" data-startTime="10754">interesting, because we see </span><span class="line" data-startTime="10754">mostly that as we're scrolling, </span><span class="line" data-startTime="10761">notice the big red spots </span><span class="line" data-startTime="10761">that keep popping up. </span> <span class="line" data-startTime="10765">Let me see if I can get </span><span class="line" data-startTime="10765">it to do that again. </span></p>

<p><span class="line" data-startTime="10769">See it? </span><span class="line" data-startTime="10770">So something's going on. </span> <span class="line" data-startTime="10771">I'll spare you the </span><span class="line" data-startTime="10771">punchline here. </span> <span class="line" data-startTime="10773">What's actually occurring </span><span class="line" data-startTime="10773">is that these guys </span><span class="line" data-startTime="10775">are doing something with </span><span class="line" data-startTime="10775">a scroll handler in here, </span><span class="line" data-startTime="10777">where they're actually trying </span><span class="line" data-startTime="10777">to catch what I'm doing. </span> <span class="line" data-startTime="10779">They're trying to </span><span class="line" data-startTime="10779">catch my little scroll. </span> <span class="line" data-startTime="10780">They're trying to </span><span class="line" data-startTime="10780">reposition things. </span> <span class="line" data-startTime="10782">And we soon as </span><span class="line" data-startTime="10782">they touch the DOM, </span><span class="line" data-startTime="10784">the whole DOM has </span><span class="line" data-startTime="10784">to be recalculated. </span></p>

<p><span class="line" data-startTime="10786">As soon as the whole DOM </span><span class="line" data-startTime="10786">has to be recalculated, </span><span class="line" data-startTime="10788">all of the tiles </span><span class="line" data-startTime="10788">have to be redrawn. </span> <span class="line" data-startTime="10790">So as soon as they try to </span><span class="line" data-startTime="10790">touch what I'm scrolling </span><span class="line" data-startTime="10793">and reposition things </span><span class="line" data-startTime="10793">manually, they're actually </span><span class="line" data-startTime="10795">invalidating the </span><span class="line" data-startTime="10795">hardware compositing </span><span class="line" data-startTime="10798">and the GPU scrolling that we're </span><span class="line" data-startTime="10798">trying to do on their behalf </span><span class="line" data-startTime="10801">and actually messing up </span><span class="line" data-startTime="10801">their entire frame rate. </span> <span class="line" data-startTime="10803">How many of your mobile sites </span><span class="line" data-startTime="10803">are catching a user input </span><span class="line" data-startTime="10806">like this? </span><span class="line" data-startTime="10808">Yeah. </span> <span class="line" data-startTime="10809">I saw that. </span></p>

<p><span class="line" data-startTime="10810">I saw that. </span> <span class="line" data-startTime="10811">At least you're honest. </span> <span class="line" data-startTime="10812">Forecast.io, they know </span><span class="line" data-startTime="10812">what's going on guys. </span> <span class="line" data-startTime="10815">I got it right. </span> <span class="line" data-startTime="10815">I got it right. </span> <span class="line" data-startTime="10816">He didn't. </span> <span class="line" data-startTime="10817">No, he still hates me. </span> <span class="line" data-startTime="10818">That's OK. </span> <span class="line" data-startTime="10819">All right. </span> <span class="line" data-startTime="10820">Let's do some other websites. </span> <span class="line" data-startTime="10821">Pete, how are we doing on time? </span></p>

<p class="speaker"><span class="line" data-starttime="10823"><span class="speakerName">Pete</span>: 15. </span></p>

<p class="speaker"><span class="line" data-starttime="10824"><span class="speakerName">Colt McAnlis</span>: 15 minutes? </span><span class="line" data-startTime="10825">I can load all the </span><span class="line" data-startTime="10825">websites in 15 minutes. </span> <span class="line" data-startTime="10828">So let's look at a </span><span class="line" data-startTime="10828">couple other ones here. </span> <span class="line" data-startTime="10831">Let's see. </span> <span class="line" data-startTime="10832">Let's take a look </span><span class="line" data-startTime="10832">at something good, </span><span class="line" data-startTime="10834">so that everyone </span><span class="line" data-startTime="10834">walks away from here </span><span class="line" data-startTime="10835">with feelings of </span><span class="line" data-startTime="10835">happy bunny times. </span> <span class="line" data-startTime="10837">Sorry. </span> <span class="line" data-startTime="10838">I just called somebody. </span> <span class="line" data-startTime="10842">So this is meetup.com. </span> <span class="line" data-startTime="10849">OK. </span> <span class="line" data-startTime="10849">So we didn't see </span><span class="line" data-startTime="10849">a loading spinner. </span> <span class="line" data-startTime="10851">That was nice. </span> <span class="line" data-startTime="10851">But it did take a </span><span class="line" data-startTime="10851">little bit long to load. </span> <span class="line" data-startTime="10854">In general though, let's </span><span class="line" data-startTime="10854">see how it scrolls. </span></p>

<p><span class="line" data-startTime="10856">That's actually pretty fast. </span> <span class="line" data-startTime="10862">Let's open the DevTools again </span><span class="line" data-startTime="10862">and see what kind of red things </span><span class="line" data-startTime="10865">are occurring and what </span><span class="line" data-startTime="10865">kind of load times </span><span class="line" data-startTime="10867">we're experiencing here. </span> <span class="line" data-startTime="10869">So turn on DevTools. </span> <span class="line" data-startTime="10870">Let's hit reload and see </span><span class="line" data-startTime="10870">how the network performs. </span> <span class="line" data-startTime="10875">Not that bad. </span> <span class="line" data-startTime="10876">Not that bad. </span> <span class="line" data-startTime="10877">On the device, I'm </span><span class="line" data-startTime="10877">actually seeing </span><span class="line" data-startTime="10878">things starting </span><span class="line" data-startTime="10878">to pop up already. </span> <span class="line" data-startTime="10880">I notice no WOFFs in the code. </span> <span class="line" data-startTime="10882">That's really good. </span> <span class="line" data-startTime="10883">Oh, there is one. </span> <span class="line" data-startTime="10883">Son of a bitch. </span> <span class="line" data-startTime="10884">Where did that come from? </span><span class="line" data-startTime="10887">Oh, bogus. </span> <span class="line" data-startTime="10888">Well, maybe they're not using </span><span class="line" data-startTime="10888">that on something critical. </span> <span class="line" data-startTime="10891">Let's sort by content here. </span> <span class="line" data-startTime="10894">This is really cool to see. </span> <span class="line" data-startTime="10896">A 44K JavaScript is actually </span><span class="line" data-startTime="10896">the biggest part of the page. </span> <span class="line" data-startTime="10900">I'm surprised that's </span><span class="line" data-startTime="10900">not jQuery at 191K. </span></p>

<p><span class="line" data-startTime="10903">How many of you are using &mdash; ? </span><span class="line" data-startTime="10904">You know what? </span><span class="line" data-startTime="10904">Never mind. </span> <span class="line" data-startTime="10905">Just never mind. </span> <span class="line" data-startTime="10906">OK. </span> <span class="line" data-startTime="10907">Actually, this </span><span class="line" data-startTime="10907">image is popping up </span><span class="line" data-startTime="10908">at the top, 60K </span><span class="line" data-startTime="10908">JPEG, 320 by 226. </span> <span class="line" data-startTime="10913">That's maybe a little large. </span> <span class="line" data-startTime="10915">Another 60K JPEG. </span> <span class="line" data-startTime="10917">Another 50K JPEG. </span> <span class="line" data-startTime="10919">This is really interesting too, </span><span class="line" data-startTime="10919">because we just saw 340 by 226s </span><span class="line" data-startTime="10922">on the previous site </span><span class="line" data-startTime="10922">that were about 10K. </span> <span class="line" data-startTime="10926">So again, someone's not </span><span class="line" data-startTime="10926">optimizing JPEGs the right way. </span> <span class="line" data-startTime="10930">In fact, actually on the </span><span class="line" data-startTime="10930">article that I put on HTML5rocks </span><span class="line" data-startTime="10933">about image </span><span class="line" data-startTime="10933">compression &mdash; let me see </span><span class="line" data-startTime="10934">if I can type over </span><span class="line" data-startTime="10934">there really quick. </span> <span class="line" data-startTime="10942">So this article that </span><span class="line" data-startTime="10942">I did was actually </span><span class="line" data-startTime="10944">image compression </span><span class="line" data-startTime="10944">for web developers. </span> <span class="line" data-startTime="10945">The entire point of this article </span><span class="line" data-startTime="10945">was to talk to all of you </span><span class="line" data-startTime="10948">in a very frank way and </span><span class="line" data-startTime="10948">discuss the back story of where </span><span class="line" data-startTime="10951">image compression works. </span></p>

<p><span class="line" data-startTime="10952">Plus, I'm a real </span><span class="line" data-startTime="10952">big fan of parrots. </span> <span class="line" data-startTime="10954">They're kind of cool, especially </span><span class="line" data-startTime="10954">the digitally pixelated ones. </span> <span class="line" data-startTime="10956">Anyhow, there's some </span><span class="line" data-startTime="10956">great content down here </span><span class="line" data-startTime="10959">about JPEG information. </span> <span class="line" data-startTime="10961">And it actually shows that &mdash; </span><span class="line" data-startTime="10961">here it is, right here. </span> <span class="line" data-startTime="10964">Let me see if I </span><span class="line" data-startTime="10964">can zoom this in. </span> <span class="line" data-startTime="10967">Nope. </span> <span class="line" data-startTime="10967">Too far. </span> <span class="line" data-startTime="10968">OK. </span> <span class="line" data-startTime="10968">So I feel it's </span><span class="line" data-startTime="10968">important to break away </span><span class="line" data-startTime="10971">from our regular scheduled </span><span class="line" data-startTime="10971">bashing of these websites, </span><span class="line" data-startTime="10973">because that's getting a </span><span class="line" data-startTime="10973">little depressing, right? </span><span class="line" data-startTime="10975">Everyone is getting depressed. </span></p>

<p><span class="line" data-startTime="10976">So this is actually a test </span><span class="line" data-startTime="10976">that an external person </span><span class="line" data-startTime="10979">did on the compression </span><span class="line" data-startTime="10979">quality of images </span><span class="line" data-startTime="10984">that are being served by the </span><span class="line" data-startTime="10984">top websites of the world. </span> <span class="line" data-startTime="10986">And what you're actually seeing </span><span class="line" data-startTime="10986">here is that most of them </span><span class="line" data-startTime="10990">actually just use </span><span class="line" data-startTime="10990">a standard value. </span> <span class="line" data-startTime="10993">So all Window Live background </span><span class="line" data-startTime="10993">images are exactly 82. </span> <span class="line" data-startTime="10998">Regardless of what the </span><span class="line" data-startTime="10998">PSNR is, they choose 82. </span> <span class="line" data-startTime="11001">It's hard coded. </span> <span class="line" data-startTime="11003">So they might be able on some </span><span class="line" data-startTime="11003">of the images to use a level 64 </span><span class="line" data-startTime="11006">and actually reduce </span><span class="line" data-startTime="11006">the size more. </span></p>

<p><span class="line" data-startTime="11008">But they use 82. </span> <span class="line" data-startTime="11009">Wikipedia are all 80 for </span><span class="line" data-startTime="11009">every one of their images, </span><span class="line" data-startTime="11012">regardless of the </span><span class="line" data-startTime="11012">content quality on it. </span> <span class="line" data-startTime="11014">YouTube is about 70 to 82. </span> <span class="line" data-startTime="11016">That's good. </span> <span class="line" data-startTime="11016">It shows that they're actually </span><span class="line" data-startTime="11016">doing some dynamic scaling. </span> <span class="line" data-startTime="11019">Although it's unclear </span><span class="line" data-startTime="11019">whether or not that </span><span class="line" data-startTime="11020">it's actually manually scaled, </span><span class="line" data-startTime="11020">or they have an artist actually </span><span class="line" data-startTime="11022">changing them, or they have </span><span class="line" data-startTime="11022">some sort of dynamic solution, </span><span class="line" data-startTime="11025">like I was saying. </span> <span class="line" data-startTime="11026">Yahoo, 69 to 91. </span></p>

<p><span class="line" data-startTime="11028">Again, they may have some more </span><span class="line" data-startTime="11028">responsive version of that. </span> <span class="line" data-startTime="11030">Facebook's are at 85. </span> <span class="line" data-startTime="11032">And Google image </span><span class="line" data-startTime="11032">thumbnails are about 74. </span> <span class="line" data-startTime="11035">Here's the really interesting. </span> <span class="line" data-startTime="11036">Twitter user JPEGs are </span><span class="line" data-startTime="11036">anywhere between 30 and 100, </span><span class="line" data-startTime="11039">which means that </span><span class="line" data-startTime="11039">for some images, </span><span class="line" data-startTime="11040">they're actually doing nothing. </span> <span class="line" data-startTime="11042">And some images, they're </span><span class="line" data-startTime="11042">doing everything. </span> <span class="line" data-startTime="11044">This actually tells me &mdash; no one </span><span class="line" data-startTime="11044">is in here from Twitter, right? </span><span class="line" data-startTime="11047">This actually tells me that </span><span class="line" data-startTime="11047">they may have something dynamic </span><span class="line" data-startTime="11049">actually testing the noise </span><span class="line" data-startTime="11049">ratio of the compression </span><span class="line" data-startTime="11052">there and actually serving </span><span class="line" data-startTime="11052">you the most optimized JPEG </span><span class="line" data-startTime="11055">at the best image </span><span class="line" data-startTime="11055">quality possible. </span> <span class="line" data-startTime="11057">So that's really cool. </span> <span class="line" data-startTime="11058">That's really cool to </span><span class="line" data-startTime="11058">see that someone's is </span><span class="line" data-startTime="11060">doing that out on the web. </span> <span class="line" data-startTime="11062">OK. </span></p>

<p><span class="line" data-startTime="11062">Back to doom and gloom. </span> <span class="line" data-startTime="11065">We were over here. </span> <span class="line" data-startTime="11066">So these images probably are a </span><span class="line" data-startTime="11066">little too large in megabytes. </span> <span class="line" data-startTime="11071">They're probably </span><span class="line" data-startTime="11071">not optimizing it. </span> <span class="line" data-startTime="11073">Nope, that's not an image. </span> <span class="line" data-startTime="11074">Chances are they're just </span><span class="line" data-startTime="11074">using a standard one. </span> <span class="line" data-startTime="11075">So let's hit timeline. </span> <span class="line" data-startTime="11076">Let's just hit record. </span> <span class="line" data-startTime="11078">Let's see what's </span><span class="line" data-startTime="11078">going on with memory. </span> <span class="line" data-startTime="11080">I'm not touching anything. </span> <span class="line" data-startTime="11081">Memory is increasing, </span><span class="line" data-startTime="11081">not too much, 5.5, 5.6. </span> <span class="line" data-startTime="11088">Again, we've got these </span><span class="line" data-startTime="11088">timers getting fired. </span> <span class="line" data-startTime="11090">fine.js. </span></p>

<p><span class="line" data-startTime="11091">I don't even know what this is. </span> <span class="line" data-startTime="11092">Meetup script mobile find. </span> <span class="line" data-startTime="11094">So apparently, it's trying </span><span class="line" data-startTime="11094">to meet me and find me. </span> <span class="line" data-startTime="11096">That's kind of creepy. </span> <span class="line" data-startTime="11099">Mobile base. </span> <span class="line" data-startTime="11101">So that's weird. </span> <span class="line" data-startTime="11101">So they've got two </span><span class="line" data-startTime="11101">separate timers </span><span class="line" data-startTime="11103">coming from their own website </span><span class="line" data-startTime="11103">doing two different things. </span> <span class="line" data-startTime="11106">And again, I'm not </span><span class="line" data-startTime="11106">touching anything. </span> <span class="line" data-startTime="11109">Nothing's happening. </span> <span class="line" data-startTime="11109">Nothing is moving. </span> <span class="line" data-startTime="11111">But we're at 5.6 megs. </span></p>

<p><span class="line" data-startTime="11113">So this is like a slow leak. </span> <span class="line" data-startTime="11114">It looks like there's a slow </span><span class="line" data-startTime="11114">closure or something being </span><span class="line" data-startTime="11117">tossed to this. </span> <span class="line" data-startTime="11118">So let's take a look at this </span><span class="line" data-startTime="11118">and see if we can't drill in. </span> <span class="line" data-startTime="11121">Oh, yay. </span> <span class="line" data-startTime="11122">It is a jQuery library. </span> <span class="line" data-startTime="11123">Summon the power </span><span class="line" data-startTime="11123">of pretty print. </span> <span class="line" data-startTime="11125">Aha. </span> <span class="line" data-startTime="11126">That didn't help. </span> <span class="line" data-startTime="11128">I'll try that again. </span> <span class="line" data-startTime="11129">There we go. </span> <span class="line" data-startTime="11131">Oh, mustache. </span> <span class="line" data-startTime="11134">Interesting. </span> <span class="line" data-startTime="11135">Who uses mustache? </span><span class="line" data-startTime="11136">Can anyone explain this </span><span class="line" data-startTime="11136">line of code to me? </span></p>

<p class="speaker"><span class="line" data-starttime="11139"><span class="speakerName">Audience</span>: It's a </span><span class="line" data-startTime="11139">JavaScript template. </span><span class="line" data-startTime="11142">[INAUDIBLE] is derived from it. </span></p>

<p class="speaker"><span class="line" data-starttime="11143"><span class="speakerName">Colt McAnlis</span>: So this is </span><span class="line" data-startTime="11143">causing a memory leak. </span> <span class="line" data-startTime="11146">Can anyone fix this? </span><span class="line" data-startTime="11148">Not now? </span><span class="line" data-startTime="11148">OK. </span> <span class="line" data-startTime="11149">That's cool. </span> <span class="line" data-startTime="11149">Take your time. </span> <span class="line" data-startTime="11149">That's all right. </span> <span class="line" data-startTime="11150">We'll get back to it. </span> <span class="line" data-startTime="11151">But basically, we're </span><span class="line" data-startTime="11151">seeing again this looks </span><span class="line" data-startTime="11154">like an anonymous function </span><span class="line" data-startTime="11154">calling some factory objects, </span><span class="line" data-startTime="11159">testing some object definitions. </span> <span class="line" data-startTime="11161">This in and of itself </span><span class="line" data-startTime="11161">doesn't look bad. </span> <span class="line" data-startTime="11163">Although it is calling another </span><span class="line" data-startTime="11163">anonymous function down here. </span> <span class="line" data-startTime="11167">Sometimes the </span><span class="line" data-startTime="11167">pretty print spacing </span><span class="line" data-startTime="11168">doesn't get it all right. </span></p>

<p><span class="line" data-startTime="11169">This might actually be </span><span class="line" data-startTime="11169">a closure in a closure. </span> <span class="line" data-startTime="11172">It looks like we've got one </span><span class="line" data-startTime="11172">closed there and one open here. </span> <span class="line" data-startTime="11176">Something is going on. </span> <span class="line" data-startTime="11178">Any of you who are using </span><span class="line" data-startTime="11178">third-party libraries, </span><span class="line" data-startTime="11180">it's actually really easy </span><span class="line" data-startTime="11180">to fall into these traps, </span><span class="line" data-startTime="11182">where they're allocating </span><span class="line" data-startTime="11182">memory and doing stuff </span><span class="line" data-startTime="11184">on your behalf that may </span><span class="line" data-startTime="11184">be negatively impacting </span><span class="line" data-startTime="11187">your performance. </span> <span class="line" data-startTime="11187">And we sometimes </span><span class="line" data-startTime="11187">ignore these faults </span><span class="line" data-startTime="11190">and don't track </span><span class="line" data-startTime="11190">these faults down, </span><span class="line" data-startTime="11192">because of the fact that we get </span><span class="line" data-startTime="11192">event propagation or something </span><span class="line" data-startTime="11194">else, like oh, I get a call </span><span class="line" data-startTime="11194">back when something occurs. </span> <span class="line" data-startTime="11198">That code you can actually </span><span class="line" data-startTime="11198">write in about 100 lines </span><span class="line" data-startTime="11200">of your own making and actually </span><span class="line" data-startTime="11200">keep it memory performant. </span></p>

<p><span class="line" data-startTime="11203">But instead, we pull in </span><span class="line" data-startTime="11203">these large libraries. </span> <span class="line" data-startTime="11204">So it's important that </span><span class="line" data-startTime="11204">you know these trade-offs </span><span class="line" data-startTime="11207">when something like </span><span class="line" data-startTime="11207">this is occurring. </span> <span class="line" data-startTime="11209">Let's do another website. </span> <span class="line" data-startTime="11210">Pete, we've got what? </span><span class="line" data-startTime="11211">10 minutes left? </span><span class="line" data-startTime="11212">Yeah? </span><span class="line" data-startTime="11213">About 10 minutes? </span><span class="line" data-startTime="11213">Let's see. </span> <span class="line" data-startTime="11214">What haven't we done here? </span><span class="line" data-startTime="11216">So I have to load </span><span class="line" data-startTime="11216">this, because I really </span><span class="line" data-startTime="11218">don't get this website. </span></p>

<p><span class="line" data-startTime="11220">And I really want to talk </span><span class="line" data-startTime="11220">about the website more </span><span class="line" data-startTime="11222">than the performance </span><span class="line" data-startTime="11222">characteristics. </span> <span class="line" data-startTime="11224">So this is called </span><span class="line" data-startTime="11224">Game of Phones. </span> <span class="line" data-startTime="11227">Is this your site? </span></p>

<p class="speaker"><span class="line" data-starttime="11228"><span class="speakerName">Audience</span>: Yeah. </span></p>

<p class="speaker"><span class="line" data-starttime="11229"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="11229">Cool. </span> <span class="line" data-startTime="11231">I really don't get this website. </span> <span class="line" data-startTime="11234">But it's here. </span> <span class="line" data-startTime="11235">So we can take a look at it </span><span class="line" data-startTime="11235">from a performance perspective. </span> <span class="line" data-startTime="11237">Basically, what happens </span><span class="line" data-startTime="11237">is someone will record. </span> <span class="line" data-startTime="11241">And from what I </span><span class="line" data-startTime="11241">can tell, they're </span><span class="line" data-startTime="11242">very politically </span><span class="line" data-startTime="11242">charged, angry arguments. </span> <span class="line" data-startTime="11245">And you sign up. </span> <span class="line" data-startTime="11247">And someone will call you and </span><span class="line" data-startTime="11247">play this recorded message </span><span class="line" data-startTime="11250">that's like, blah, blah, </span><span class="line" data-startTime="11250">blah, blah, blah, blah, blah, </span><span class="line" data-startTime="11253">rally, fight the power. </span> <span class="line" data-startTime="11255">And then you have to call </span><span class="line" data-startTime="11255">someone else on the list </span><span class="line" data-startTime="11259">and try to regurgitate </span><span class="line" data-startTime="11259">what you heard. </span> <span class="line" data-startTime="11262">And so it's like the </span><span class="line" data-startTime="11262">game of telephone </span><span class="line" data-startTime="11263">that you play as kids. </span> <span class="line" data-startTime="11264">And you're trying to </span><span class="line" data-startTime="11264">get all the way through. </span> <span class="line" data-startTime="11266">I have no idea why people </span><span class="line" data-startTime="11266">are even doing this. </span> <span class="line" data-startTime="11268">I hate getting calls </span><span class="line" data-startTime="11268">from my wife, much less </span><span class="line" data-startTime="11270">random strangers </span><span class="line" data-startTime="11270">on the internet. </span></p>

<p><span class="line" data-startTime="11271">I'm on the internet because </span><span class="line" data-startTime="11271">I don't want you to call me. </span> <span class="line" data-startTime="11274">Send me a text or something. </span> <span class="line" data-startTime="11276">Anyhow. </span> <span class="line" data-startTime="11277">Personal thing. </span> <span class="line" data-startTime="11278">I'm sure it works </span><span class="line" data-startTime="11278">for your brother. </span> <span class="line" data-startTime="11279">I don't get the internet. </span> <span class="line" data-startTime="11280">I'm too old. </span> <span class="line" data-startTime="11281">That's my problem. </span></p>

<p class="speaker"><span class="line" data-starttime="11281"><span class="speakerName">Audience</span>: I've had people tell </span><span class="line" data-startTime="11281">me it's the only phone calls </span><span class="line" data-startTime="11284">that they will answer. </span></p>

<p class="speaker"><span class="line" data-starttime="11288"><span class="speakerName">Colt McAnlis</span>: Oh, dude. </span> <span class="line" data-startTime="11289">Game of Phones. </span> <span class="line" data-startTime="11290">Awesome. </span> <span class="line" data-startTime="11292">You know what you need to do? </span><span class="line" data-startTime="11293">You actually need to get the </span><span class="line" data-startTime="11293">voices from "Game of Thrones" </span><span class="line" data-startTime="11296">to actually do the call. </span> <span class="line" data-startTime="11297">And then it would just go </span><span class="line" data-startTime="11297">through the roof, dude. </span> <span class="line" data-startTime="11299">HBO might sue me now. </span> <span class="line" data-startTime="11300">Sorry about that. </span> <span class="line" data-startTime="11301">Anyhow, let's look at this </span><span class="line" data-startTime="11301">from a performance perspective. </span> <span class="line" data-startTime="11303">There's really </span><span class="line" data-startTime="11303">nothing on this page. </span> <span class="line" data-startTime="11305">It's kind of text. </span> <span class="line" data-startTime="11306">But we're going to </span><span class="line" data-startTime="11306">run through it anyway, </span><span class="line" data-startTime="11308">just so you guys can see the </span><span class="line" data-startTime="11308">differences in these things. </span></p>

<p><span class="line" data-startTime="11313">So I'm not here. </span> <span class="line" data-startTime="11315">By the way, did you see </span><span class="line" data-startTime="11315">actually what showed up? </span><span class="line" data-startTime="11317">Was this on the screen? </span><span class="line" data-startTime="11318">Sorry. </span> <span class="line" data-startTime="11319">So this is Game of Phones. </span> <span class="line" data-startTime="11320">Again, it's just text and </span><span class="line" data-startTime="11320">people calling each other. </span> <span class="line" data-startTime="11326">But this is it. </span> <span class="line" data-startTime="11328">12 requests. </span> <span class="line" data-startTime="11330">The interesting </span><span class="line" data-startTime="11330">thing here is 107K. </span> <span class="line" data-startTime="11334">That's a little odd. </span> <span class="line" data-startTime="11334">We were seeing some other </span><span class="line" data-startTime="11334">pages come in below that. </span> <span class="line" data-startTime="11338">Mainly, this is coming from &mdash; </span><span class="line" data-startTime="11338">Bootstrap is being included. </span> <span class="line" data-startTime="11343">I'm not really sure why </span><span class="line" data-startTime="11343">this needs Bootstrap. </span> <span class="line" data-startTime="11352">I guess the cool </span><span class="line" data-startTime="11352">kids are doing it. </span> <span class="line" data-startTime="11354">And here's the funny thing. </span></p>

<p><span class="line" data-startTime="11355">We got Bootstrap.min and then </span><span class="line" data-startTime="11355">CSS that replaces Bootstrap. </span> <span class="line" data-startTime="11361">So that's a thing. </span> <span class="line" data-startTime="11362">And then jQuery. </span> <span class="line" data-startTime="11369">OK. </span> <span class="line" data-startTime="11370">And then here's another </span><span class="line" data-startTime="11370">Bootstrap again and then </span><span class="line" data-startTime="11373">telephone gram and </span><span class="line" data-startTime="11373">then another jQuery. </span> <span class="line" data-startTime="11379">Are you using two jQueries? </span></p>

<p class="speaker"><span class="line" data-starttime="11381"><span class="speakerName">Audience</span>: I should </span><span class="line" data-startTime="11381">mention that I've never </span><span class="line" data-startTime="11383">made a web page before. </span></p>

<p class="speaker"><span class="line" data-starttime="11384"><span class="speakerName">Colt McAnlis</span>: You're </span><span class="line" data-startTime="11384">using two jQueries. </span><span class="line" data-startTime="11387">Do you know you're </span><span class="line" data-startTime="11387">using two jQueries? </span></p>

<p class="speaker"><span class="line" data-starttime="11389"><span class="speakerName">Audience</span>: Now I do. </span></p>

<p class="speaker"><span class="line" data-starttime="11389"><span class="speakerName">Colt McAnlis</span>: Now you do. </span><span class="line" data-startTime="11390">OK. </span><span class="line" data-startTime="11393">And then I like the GIF. </span><span class="line" data-startTime="11396">It's spritesheeted, I guess. </span><span class="line" data-startTime="11399">Here's the cool thing. </span><span class="line" data-startTime="11400">So a 300 by 120 animated </span><span class="line" data-startTime="11400">GIF is only 4.4K. </span><span class="line" data-startTime="11404">Yet we were seeing full JPEGs </span><span class="line" data-startTime="11404">that were 9K that were static. </span><span class="line" data-startTime="11410">So I'm not really sure </span><span class="line" data-startTime="11410">what else to do with this. </span><span class="line" data-startTime="11414">Let me hit timeline and see </span><span class="line" data-startTime="11414">what this is doing here. </span><span class="line" data-startTime="11417">It's a little awkward. </span><span class="line" data-startTime="11422">So your jQueries </span><span class="line" data-startTime="11422">are using memory. </span><span class="line" data-startTime="11425">So this is kind of tell-tale. </span><span class="line" data-startTime="11428">Do you have a timer? </span><span class="line" data-startTime="11429">It looks like you have a timer. </span></p>

<p class="speaker"><span class="line" data-starttime="11430"><span class="speakerName">Audience</span>: Maybe the </span><span class="line" data-startTime="11430">audio player is using it. </span></p>

<p class="speaker"><span class="line" data-starttime="11432"><span class="speakerName">Colt McAnlis</span>: Maybe </span><span class="line" data-startTime="11432">the audio player. </span> <span class="line" data-startTime="11434">Yeah. </span> <span class="line" data-startTime="11435">Yeah, it does. </span> <span class="line" data-startTime="11435">So it looks like </span><span class="line" data-startTime="11435">there's a timer here. </span> <span class="line" data-startTime="11437">I don't know if you </span><span class="line" data-startTime="11437">guys can see this. </span> <span class="line" data-startTime="11439">It looks like </span><span class="line" data-startTime="11439">there's a timer here. </span> <span class="line" data-startTime="11440">And you can see this red square </span><span class="line" data-startTime="11440">up here, just the Play button. </span> <span class="line" data-startTime="11443">That Play button </span><span class="line" data-startTime="11443">has a timer that </span><span class="line" data-startTime="11448">needs jQuery and Bootstrap &mdash; </span><span class="line" data-startTime="11448">two jQueries and Bootstrap &mdash; </span><span class="line" data-startTime="11452">and is allocating a meg of </span><span class="line" data-startTime="11452">memory over seven seconds. </span> <span class="line" data-startTime="11457">So that's a thing. </span> <span class="line" data-startTime="11459">Lots of rasterizes occurring </span><span class="line" data-startTime="11459">in here, lots of recalculates. </span></p>

<p><span class="line" data-startTime="11462">So not only is it </span><span class="line" data-startTime="11462">repainting, it's </span><span class="line" data-startTime="11464">actually updating </span><span class="line" data-startTime="11464">the DOM to repaint. </span> <span class="line" data-startTime="11467">Let's look at this again. </span> <span class="line" data-startTime="11468">That's updating the DOM. </span> <span class="line" data-startTime="11471">Don't know why. </span> <span class="line" data-startTime="11472">Maybe there's a cool </span><span class="line" data-startTime="11472">jitter effect there. </span> <span class="line" data-startTime="11473">Maybe I got this wrong. </span> <span class="line" data-startTime="11474">Maybe I'm actually </span><span class="line" data-startTime="11474">looking at the matrix. </span> <span class="line" data-startTime="11476">Am I looking at the matrix? </span><span class="line" data-startTime="11478">That would be kind of cool. </span> <span class="line" data-startTime="11479">I'm like analyzing. </span> <span class="line" data-startTime="11480">No, sorry. </span> <span class="line" data-startTime="11481">I'm having fun. </span> <span class="line" data-startTime="11481">It's late. </span> <span class="line" data-startTime="11482">And I have to keep you all </span><span class="line" data-startTime="11482">awake for another five minutes. </span></p>

<p><span class="line" data-startTime="11484">So anyhow, I don't </span><span class="line" data-startTime="11484">like this trend. </span> <span class="line" data-startTime="11487">You're actually allocating </span><span class="line" data-startTime="11487">more memory faster </span><span class="line" data-startTime="11489">than the other </span><span class="line" data-startTime="11489">websites we looked at. </span> <span class="line" data-startTime="11490">It's probably because </span><span class="line" data-startTime="11490">you have two jQueries. </span> <span class="line" data-startTime="11491">But anyhow, let's dig in. </span> <span class="line" data-startTime="11493">So let's go to Profiles. </span> <span class="line" data-startTime="11494">Again, follow the memory, </span><span class="line" data-startTime="11494">find the performance problems. </span> <span class="line" data-startTime="11496">So we follow the asset </span><span class="line" data-startTime="11496">memory to figure out </span><span class="line" data-startTime="11498">where load problems are. </span> <span class="line" data-startTime="11499">We follow the dynamic </span><span class="line" data-startTime="11499">memory to figure out </span><span class="line" data-startTime="11500">where compute problems </span><span class="line" data-startTime="11500">and render problems are. </span> <span class="line" data-startTime="11502">Can I click this button please? </span><span class="line" data-startTime="11504">Clicky. </span> <span class="line" data-startTime="11505">You've allocated too much </span><span class="line" data-startTime="11505">memory for your site. </span> <span class="line" data-startTime="11509">And I can't click. </span></p>

<p><span class="line" data-startTime="11510">Oh, there we go. </span> <span class="line" data-startTime="11510">OK. </span> <span class="line" data-startTime="11511">So let's do record </span><span class="line" data-startTime="11511">heap applications. </span> <span class="line" data-startTime="11513">Hit start. </span> <span class="line" data-startTime="11516">So that's kind of interesting. </span> <span class="line" data-startTime="11517">Do you guys see this pattern? </span><span class="line" data-startTime="11519">So this is, actually, </span><span class="line" data-startTime="11519">really very, very regular </span><span class="line" data-startTime="11521">allocations that are occurring, </span><span class="line" data-startTime="11521">two different sets of it. </span> <span class="line" data-startTime="11524">But they're almost </span><span class="line" data-startTime="11524">deleted immediately, </span><span class="line" data-startTime="11526">except for the </span><span class="line" data-startTime="11526">stuff that happened </span><span class="line" data-startTime="11528">in the beginning of the trace. </span> <span class="line" data-startTime="11529">So see, we're seeing </span><span class="line" data-startTime="11529">the gray lines. </span> <span class="line" data-startTime="11530">So the gray lines mean </span><span class="line" data-startTime="11530">that what was allocated </span><span class="line" data-startTime="11532">has actually been freed now. </span> <span class="line" data-startTime="11534">This is kind of odd. </span></p>

<p><span class="line" data-startTime="11535">I want to see where </span><span class="line" data-startTime="11535">this is coming from. </span> <span class="line" data-startTime="11538">I like to dig in and </span><span class="line" data-startTime="11538">figure out why I'm so bald. </span> <span class="line" data-startTime="11542">So we have the whole thing. </span> <span class="line" data-startTime="11543">Yada, yada, yada. </span> <span class="line" data-startTime="11544">Let's actually just </span><span class="line" data-startTime="11544">highlight this guy here. </span> <span class="line" data-startTime="11546">So array. </span> <span class="line" data-startTime="11548">Transition array. </span> <span class="line" data-startTime="11548">So something is going </span><span class="line" data-startTime="11548">on inside of V8. </span> <span class="line" data-startTime="11550">All these are being deleted. </span> <span class="line" data-startTime="11552">Compiled code. </span> <span class="line" data-startTime="11554">Is it DOP? </span><span class="line" data-startTime="11555">No, relocation. </span> <span class="line" data-startTime="11556">So it looks like there's </span><span class="line" data-startTime="11556">just some sort of cases </span><span class="line" data-startTime="11560">where jQuery is executing. </span> <span class="line" data-startTime="11561">Again, I see this a </span><span class="line" data-startTime="11561">lot with closures. </span> <span class="line" data-startTime="11563">Closures, for some reason, </span><span class="line" data-startTime="11563">tend to bring up this pattern. </span> <span class="line" data-startTime="11565">jQuery is kicking </span><span class="line" data-startTime="11565">off a closure that's </span><span class="line" data-startTime="11567">causing a reflow of your </span><span class="line" data-startTime="11567">entire page for a five pixel </span><span class="line" data-startTime="11573">by five pixel icon. </span></p>

<p><span class="line" data-startTime="11574">So you still loaded faster </span><span class="line" data-startTime="11574">than the other sites. </span> <span class="line" data-startTime="11577">Bravo. </span> <span class="line" data-startTime="11578">Round of applause for that. </span> <span class="line" data-startTime="11580">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="11583"><span class="speakerName">Audience</span>: [INAUDIBLE] </span><span class="line" data-startTime="11583">don't need images. </span></p>

<p class="speaker"><span class="line" data-starttime="11584"><span class="speakerName">Colt McAnlis</span>: There you go. </span><span class="line" data-startTime="11587">I'm a fan of the text web. </span><span class="line" data-startTime="11589">That requires drinking to get </span><span class="line" data-startTime="11589">more information out of that. </span><span class="line" data-startTime="11591">Anyhow, let's load </span><span class="line" data-startTime="11591">up another one. </span><span class="line" data-startTime="11593">Pete, how are we doing on time? </span></p>

<p class="speaker"><span class="line" data-starttime="11594"><span class="speakerName">Pete</span>: About five minutes. </span></p>

<p class="speaker"><span class="line" data-starttime="11595"><span class="speakerName">Colt McAnlis</span>: Five more minutes. </span><span class="line" data-startTime="11595">OK. </span><span class="line" data-startTime="11596">Let's clear up quickly, </span><span class="line" data-startTime="11596">because I'm actually </span><span class="line" data-startTime="11598">really interested to try this </span><span class="line" data-startTime="11598">Robitussin and whiskey thing. </span><span class="line" data-startTime="11600">I think we may have </span><span class="line" data-startTime="11600">something on there. </span></p>

<p class="speaker"><span class="line" data-starttime="11602"><span class="speakerName">Adam Grossman</span>: I </span><span class="line" data-startTime="11602">highly recommend it. </span></p>

<p class="speaker"><span class="line" data-starttime="11603"><span class="speakerName">Colt McAnlis</span>: OK. </span> <span class="line" data-startTime="11604">Let's try this CBN week. </span> <span class="line" data-startTime="11620">And we're done. </span> <span class="line" data-startTime="11622">I think at this time </span><span class="line" data-startTime="11622">I don't actually </span><span class="line" data-startTime="11624">need to tell you guys </span><span class="line" data-startTime="11624">what I'm about to do. </span> <span class="line" data-startTime="11629">No, I don't want to translate. </span> <span class="line" data-startTime="11630">I used to be able </span><span class="line" data-startTime="11630">to speak Chinese. </span> <span class="line" data-startTime="11632">It was a beautiful language. </span> <span class="line" data-startTime="11633">So you know what </span><span class="line" data-startTime="11633">I'm about to do. </span> <span class="line" data-startTime="11636">I'm going to load up networking. </span> <span class="line" data-startTime="11637">I'm going to see what images </span><span class="line" data-startTime="11637">are too large, what JavaScript </span><span class="line" data-startTime="11640">is too large, what you're using </span><span class="line" data-startTime="11640">that you shouldn't be using. </span> <span class="line" data-startTime="11642">We're going to try to </span><span class="line" data-startTime="11642">call assets and get rid </span><span class="line" data-startTime="11644">of extra network loads. </span> <span class="line" data-startTime="11646">I thought the points </span><span class="line" data-startTime="11646">about spritesheets </span><span class="line" data-startTime="11648">was perfect earlier. </span> <span class="line" data-startTime="11649">By the way, they shouldn't </span><span class="line" data-startTime="11649">be called spritesheets. </span></p>

<p><span class="line" data-startTime="11651">They should be called atlases. </span> <span class="line" data-startTime="11652">You should actually see my </span><span class="line" data-startTime="11652">Udacity course rant on this. </span> <span class="line" data-startTime="11654">Everywhere else in the world </span><span class="line" data-startTime="11654">and video games and film </span><span class="line" data-startTime="11658">and everything, we </span><span class="line" data-startTime="11658">call them atlases. </span> <span class="line" data-startTime="11660">You know what? </span><span class="line" data-startTime="11660">Never mind. </span> <span class="line" data-startTime="11661">Anyhow, let's see </span><span class="line" data-startTime="11661">some scrolling. </span> <span class="line" data-startTime="11663">Not that bad. </span> <span class="line" data-startTime="11666">Let's head over to DevTools. </span> <span class="line" data-startTime="11667">Let's take a look at this </span><span class="line" data-startTime="11667">under the microscope. </span> <span class="line" data-startTime="11672">Let's go back to Network. </span> <span class="line" data-startTime="11676">My computer said I'm dumb. </span> <span class="line" data-startTime="11682">This will be the last site. </span> <span class="line" data-startTime="11684">And then we'll actually </span><span class="line" data-startTime="11684">get to all the questions. </span> <span class="line" data-startTime="11685">And I think we're going to </span><span class="line" data-startTime="11685">do a group question, right? </span><span class="line" data-startTime="11688">Fantastic. </span> <span class="line" data-startTime="11689">So that's interesting. </span></p>

<p><span class="line" data-startTime="11693">So there's already 89 </span><span class="line" data-startTime="11693">requests, 92 requests, 93, 95. </span> <span class="line" data-startTime="11701">1.5 megs transferred so far. </span> <span class="line" data-startTime="11705">1.9, 2 megs, 2.195. </span> <span class="line" data-startTime="11711">So here's something </span><span class="line" data-startTime="11711">interesting up here. </span> <span class="line" data-startTime="11713">So notice this gray </span><span class="line" data-startTime="11713">bar right here. </span> <span class="line" data-startTime="11716">So in Chrome DevTools, when </span><span class="line" data-startTime="11716">you look at this Network tab, </span><span class="line" data-startTime="11718">basically, you see two values. </span> <span class="line" data-startTime="11719">You see this semi-transparent </span><span class="line" data-startTime="11719">and this opaque portion </span><span class="line" data-startTime="11722">of these items. </span> <span class="line" data-startTime="11723">That semi-transparent </span><span class="line" data-startTime="11723">value is actually </span><span class="line" data-startTime="11725">how long the browser spent </span><span class="line" data-startTime="11725">waiting to receive the asset. </span> <span class="line" data-startTime="11729">This is one of the reasons </span><span class="line" data-startTime="11729">that spritesheets are actually </span><span class="line" data-startTime="11731">so important for you, because </span><span class="line" data-startTime="11731">each browser has a set </span><span class="line" data-startTime="11734">number of limits </span><span class="line" data-startTime="11734">of open connections </span><span class="line" data-startTime="11736">that it will allow </span><span class="line" data-startTime="11736">to a single server. </span> <span class="line" data-startTime="11738">For Chrome, I believe </span><span class="line" data-startTime="11738">it's around six, </span><span class="line" data-startTime="11741">which means if you have </span><span class="line" data-startTime="11741">six requests in flight, </span><span class="line" data-startTime="11744">it'll block the rest of the </span><span class="line" data-startTime="11744">requests until a slot opens up. </span></p>

<p><span class="line" data-startTime="11747">Think of it like a </span><span class="line" data-startTime="11747">caching FIFO or whatnot. </span> <span class="line" data-startTime="11749">And so Chrome actually shows </span><span class="line" data-startTime="11749">you this here on the timeline. </span> <span class="line" data-startTime="11752">You can see some of </span><span class="line" data-startTime="11752">these actually waited </span><span class="line" data-startTime="11754">a very, very long time. </span> <span class="line" data-startTime="11756">In this case, it actually </span><span class="line" data-startTime="11756">spent 471 milliseconds waiting. </span> <span class="line" data-startTime="11760">It wanted to request </span><span class="line" data-startTime="11760">this asset, but it </span><span class="line" data-startTime="11762">couldn't because there were </span><span class="line" data-startTime="11762">other things in the pipe. </span> <span class="line" data-startTime="11764">And you can see that this </span><span class="line" data-startTime="11764">is a function of the fact </span><span class="line" data-startTime="11767">that there's about 100 requests </span><span class="line" data-startTime="11767">and 3.6 megs transferred. </span> <span class="line" data-startTime="11770">For those of you who don't </span><span class="line" data-startTime="11770">know, the average website </span><span class="line" data-startTime="11773">size right now, according </span><span class="line" data-startTime="11773">to HTTP archive, </span><span class="line" data-startTime="11775">is about 1.1 megs. </span></p>

<p><span class="line" data-startTime="11777">And that's for desktop. </span> <span class="line" data-startTime="11778">They haven't really got into </span><span class="line" data-startTime="11778">a lot of the mobile testing </span><span class="line" data-startTime="11779">just yet. </span> <span class="line" data-startTime="11780">But obviously, mobile </span><span class="line" data-startTime="11780">shouldn't be 1.1 meg, right? </span><span class="line" data-startTime="11783">So obviously, there's </span><span class="line" data-startTime="11783">too big a content here. </span> <span class="line" data-startTime="11785">So let's see if there's </span><span class="line" data-startTime="11785">any big offenders. </span> <span class="line" data-startTime="11787">Let's see if images </span><span class="line" data-startTime="11787">are a problem. </span> <span class="line" data-startTime="11789">Who thinks images are a problem? </span><span class="line" data-startTime="11792">Here's a 300K image, </span><span class="line" data-startTime="11792">200K, 197K, 161K, 152K. </span> <span class="line" data-startTime="11802">What is in that image? </span><span class="line" data-startTime="11806">I think that's bigger than raw. </span> <span class="line" data-startTime="11809">Yeah. </span> <span class="line" data-startTime="11810">Obviously, these </span><span class="line" data-startTime="11810">images are too big. </span> <span class="line" data-startTime="11811">They're not being optimized. </span> <span class="line" data-startTime="11812">They should be fixed. </span></p>

<p><span class="line" data-startTime="11813">Let's take a look at timeline. </span> <span class="line" data-startTime="11815">Let's see if anything is </span><span class="line" data-startTime="11815">going on with memory here. </span> <span class="line" data-startTime="11817">Anything crazy? </span><span class="line" data-startTime="11820">Slow, again timer. </span> <span class="line" data-startTime="11823">We see this same pattern. </span> <span class="line" data-startTime="11824">So we see almost </span><span class="line" data-startTime="11824">all of these pages </span><span class="line" data-startTime="11827">are falling into </span><span class="line" data-startTime="11827">the same pattern. </span> <span class="line" data-startTime="11829">Also, almost all of these </span><span class="line" data-startTime="11829">pages and some of them, </span><span class="line" data-startTime="11831">in rare cases, are all using </span><span class="line" data-startTime="11831">jQuery or jQuery twice. </span> <span class="line" data-startTime="11835">Closures are being passed </span><span class="line" data-startTime="11835">off to timers for things </span><span class="line" data-startTime="11838">like ads or analytics </span><span class="line" data-startTime="11838">or marquees. </span> <span class="line" data-startTime="11841">And this seems to </span><span class="line" data-startTime="11841">be a common pattern. </span> <span class="line" data-startTime="11843">But this is obviously is </span><span class="line" data-startTime="11843">causing a lot of memory </span><span class="line" data-startTime="11845">and a lot of churn and some </span><span class="line" data-startTime="11845">other weird things going on. </span></p>

<p><span class="line" data-startTime="11848">I can look at the </span><span class="line" data-startTime="11848">frames times here. </span> <span class="line" data-startTime="11849">And so let me actually do this. </span> <span class="line" data-startTime="11851">I don't know if I showed </span><span class="line" data-startTime="11851">you guys this tool. </span> <span class="line" data-startTime="11854">Nope. </span> <span class="line" data-startTime="11855">Cancel. </span> <span class="line" data-startTime="11857">So as I'm scrolling here &mdash; </span><span class="line" data-startTime="11857">and it's not picking that up. </span> <span class="line" data-startTime="11861">Never mind. </span> <span class="line" data-startTime="11861">I won't show you that tool. </span> <span class="line" data-startTime="11863">Anyhow, let's be done </span><span class="line" data-startTime="11863">with this for the evening </span><span class="line" data-startTime="11866">because I think Pete has </span><span class="line" data-startTime="11866">some other stuff he wants </span><span class="line" data-startTime="11868">to talk to you </span><span class="line" data-startTime="11868">guys about tonight. </span> <span class="line" data-startTime="11871">So thank you for </span><span class="line" data-startTime="11871">your time tonight. </span> <span class="line" data-startTime="11874">Perfmatters. </span> <span class="line" data-startTime="11875">Wait, wait, wait, wait. </span></p>

<p><span class="line" data-startTime="11877">I'll let you start </span><span class="line" data-startTime="11877">the clap in a second. </span> <span class="line" data-startTime="11878">So here's how you </span><span class="line" data-startTime="11878">get a hold of me. </span> <span class="line" data-startTime="11881">If anything today was </span><span class="line" data-startTime="11881">controversial or something </span><span class="line" data-startTime="11884">worth tweeting or </span><span class="line" data-startTime="11884">something you just </span><span class="line" data-startTime="11885">want to ask more questions </span><span class="line" data-startTime="11885">about, go ahead and find me. </span> <span class="line" data-startTime="11887">Make sure you join the Google+ </span><span class="line" data-startTime="11887">web performance community. </span> <span class="line" data-startTime="11889">There's a lot of </span><span class="line" data-startTime="11889">great stuff there. </span> <span class="line" data-startTime="11890">Please, for the love of </span><span class="line" data-startTime="11890">God, use perfmatters. </span></p>

<p><span class="line" data-startTime="11892">Follow perfmatters. </span> <span class="line" data-startTime="11893">It's a brand. </span> <span class="line" data-startTime="11894">You should wear this at work. </span> <span class="line" data-startTime="11896">Everything you do, you should </span><span class="line" data-startTime="11896">be challenging your employees, </span><span class="line" data-startTime="11900">your managers, the </span><span class="line" data-startTime="11900">owners of your company, </span><span class="line" data-startTime="11903">perfmatters, </span><span class="line" data-startTime="11903">perfmatters, perfmatters. </span> <span class="line" data-startTime="11905">It's going to be the thing that </span><span class="line" data-startTime="11905">separates the billion dollar </span><span class="line" data-startTime="11908">companies from everybody </span><span class="line" data-startTime="11908">else on the mobile web </span><span class="line" data-startTime="11912">within the next year. </span> <span class="line" data-startTime="11913">In fact, it already is. </span> <span class="line" data-startTime="11914">It's already [INAUDIBLE]. </span> <span class="line" data-startTime="11916">Challenge everyone. </span> <span class="line" data-startTime="11917">Hold them to the </span><span class="line" data-startTime="11917">standards of perfmatters. </span> <span class="line" data-startTime="11919">Now, you can start the clap. </span> <span class="line" data-startTime="11920">Yes. </span></p>

<p><span class="line" data-startTime="11921">Thank you for your time. </span> <span class="line" data-startTime="11922">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="11926"><span class="speakerName">Pete</span>: Thanks, Colt. </span><span class="line" data-startTime="11927">That was awesome. </span><span class="line" data-startTime="11929">OK. </span><span class="line" data-startTime="11929">So we know it's late. </span><span class="line" data-startTime="11931">We're going to have a </span><span class="line" data-startTime="11931">quick Q&A with speakers. </span><span class="line" data-startTime="11936">If you're ready, we </span><span class="line" data-startTime="11936">have some chairs. </span><span class="line" data-startTime="11937">You can come sit down. </span><span class="line" data-startTime="11939">We'll make it </span><span class="line" data-startTime="11939">quick, quick, quick. </span><span class="line" data-startTime="11946">And maybe share a mic. </span><span class="line" data-startTime="11958">Runner? </span><span class="line" data-startTime="11960">OK. </span><span class="line" data-startTime="11961">Questions, anyone? </span></p>

<p class="speaker"><span class="line" data-starttime="11972"><span class="speakerName">Audience</span>: This is directed </span><span class="line" data-startTime="11972">to the weather application. </span></p>

<p class="speaker"><span class="line" data-starttime="11977"><span class="speakerName">Adam Grossman</span>: By </span><span class="line" data-startTime="11977">the way, I'm really, </span><span class="line" data-startTime="11979">really glad you didn't look at </span><span class="line" data-startTime="11979">Forecast and try to benchmark </span><span class="line" data-startTime="11983">it. </span><span class="line" data-startTime="11983">Really glad. </span></p>

<p class="speaker"><span class="line" data-starttime="11984"><span class="speakerName">Audience</span>: I just would like </span><span class="line" data-startTime="11984">to know what is actually </span><span class="line" data-startTime="11987">keeping you from </span><span class="line" data-startTime="11987">putting it to the web? </span><span class="line" data-startTime="11990">And why not? </span><span class="line" data-startTime="11991">And &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="11991"><span class="speakerName">Adam Grossman</span>: What do you mean? </span></p>

<p class="speaker"><span class="line" data-starttime="11992"><span class="speakerName">Audience</span>: Shouldn't </span><span class="line" data-startTime="11992">you try harder? </span><span class="line" data-startTime="11993">You say you can't </span><span class="line" data-startTime="11993">put it to the web. </span><span class="line" data-startTime="11995">It has to be an application. </span></p>

<p class="speaker"><span class="line" data-starttime="11997"><span class="speakerName">Adam Grossman</span>: Well, </span><span class="line" data-startTime="11997">it doesn't have to be. </span> <span class="line" data-startTime="12000">But I don't know </span><span class="line" data-startTime="12000">anyone who would </span><span class="line" data-startTime="12003">be willing to check the </span><span class="line" data-startTime="12003">weather by going to a website. </span> <span class="line" data-startTime="12006">It just takes way too long. </span> <span class="line" data-startTime="12008">And there are so many </span><span class="line" data-startTime="12008">good apps out there. </span> <span class="line" data-startTime="12010">It's just not </span><span class="line" data-startTime="12010">something people are </span><span class="line" data-startTime="12012">going to do, at least </span><span class="line" data-startTime="12012">not in large numbers. </span> <span class="line" data-startTime="12014">People may try at first. </span> <span class="line" data-startTime="12016">But I just don't </span><span class="line" data-startTime="12016">see that happening. </span> <span class="line" data-startTime="12018">And that's definitely </span><span class="line" data-startTime="12018">not true for most things. </span></p>

<p><span class="line" data-startTime="12020">I think it's a weird thing </span><span class="line" data-startTime="12020">for weather, in particular. </span> <span class="line" data-startTime="12025">If it's so awesome that it's </span><span class="line" data-startTime="12025">the best website in the world, </span><span class="line" data-startTime="12028">people would go to it. </span> <span class="line" data-startTime="12029">But that's the one thing that </span><span class="line" data-startTime="12029">native apps have over the web </span><span class="line" data-startTime="12034">is the ease of accessibility. </span> <span class="line" data-startTime="12036">And they load super fast. </span> <span class="line" data-startTime="12041">That doesn't really </span><span class="line" data-startTime="12041">answer your question. </span></p>

<p class="speaker"><span class="line" data-starttime="12042"><span class="speakerName">Audience</span>: I could go on. </span><span class="line" data-startTime="12043">But next question. </span></p>

<p class="speaker"><span class="line" data-starttime="12046"><span class="speakerName">Pete</span>: You had a question </span><span class="line" data-startTime="12046">yourself, right? </span></p>

<p class="speaker"><span class="line" data-starttime="12047"><span class="speakerName">Adam Grossman</span>: I </span><span class="line" data-startTime="12047">did have a question. </span><span class="line" data-startTime="12051">Sorry. </span><span class="line" data-startTime="12053">Is Colt short for something? </span><span class="line" data-startTime="12055">Or is your name </span><span class="line" data-startTime="12055">just that awesome? </span></p>

<p class="speaker"><span class="line" data-starttime="12059"><span class="speakerName">Colt McAnlis</span>: Thank </span><span class="line" data-startTime="12059">you first off. </span><span class="line" data-startTime="12060">Colt is short for Colton. </span><span class="line" data-startTime="12062">I was actually named </span><span class="line" data-startTime="12062">after the 1970s show, </span><span class="line" data-startTime="12065">"The Fall Guy," Colt Seavers. </span><span class="line" data-startTime="12067">It turns out my parents were </span><span class="line" data-startTime="12067">geeks before I was a geek. </span><span class="line" data-startTime="12071">By the way, go Colts. </span></p>

<p class="speaker"><span class="line" data-starttime="12074"><span class="speakerName">Pete</span>: We have another </span><span class="line" data-startTime="12074">question from the crowd. </span></p>

<p class="speaker"><span class="line" data-starttime="12076"><span class="speakerName">Audience</span>: It's a question </span><span class="line" data-startTime="12076">for Colt about the PSNR. </span><span class="line" data-startTime="12080">Is that right? </span></p>

<p class="speaker"><span class="line" data-starttime="12081"><span class="speakerName">Colt McAnlis</span>: Yeah. </span></p>

<p class="speaker"><span class="line" data-starttime="12082"><span class="speakerName">Audience</span>: Do you know </span><span class="line" data-startTime="12082">of any command line </span><span class="line" data-startTime="12084">or open source tools that can do </span><span class="line" data-startTime="12084">a little bit of that iteration </span><span class="line" data-startTime="12088">and, as a trade-off of </span><span class="line" data-startTime="12088">time versus precision, </span><span class="line" data-startTime="12091">give you a good compression? </span></p>

<p class="speaker"><span class="line" data-starttime="12092"><span class="speakerName">Colt McAnlis</span>: Yeah, absolutely. </span> <span class="line" data-startTime="12093">So pretty much every single </span><span class="line" data-startTime="12093">JPEG compressor will do that. </span> <span class="line" data-startTime="12096">So the question for </span><span class="line" data-startTime="12096">the people at home, </span><span class="line" data-startTime="12098">in case they didn't </span><span class="line" data-startTime="12098">hear it is, do you </span><span class="line" data-startTime="12100">know if there's a command </span><span class="line" data-startTime="12100">line compressor for JPEG that </span><span class="line" data-startTime="12103">will actually give you </span><span class="line" data-startTime="12103">this evaluation of PSNR </span><span class="line" data-startTime="12105">and how much it takes to </span><span class="line" data-startTime="12105">get that value and whatnot? </span><span class="line" data-startTime="12107">Pretty much all of them do. </span> <span class="line" data-startTime="12108">If you actually </span><span class="line" data-startTime="12108">go out and Google, </span><span class="line" data-startTime="12110">"image compressor comparison," </span><span class="line" data-startTime="12110">the first 29 pages you'll see </span><span class="line" data-startTime="12115">are just going to </span><span class="line" data-startTime="12115">be charts of PSNR </span><span class="line" data-startTime="12117">against file size </span><span class="line" data-startTime="12117">against time to compress. </span> <span class="line" data-startTime="12120">So things like </span><span class="line" data-startTime="12120">libjpeg, jpeg-turbo. </span></p>

<p><span class="line" data-startTime="12124">These are the top tier. </span> <span class="line" data-startTime="12126">And like I said, one </span><span class="line" data-startTime="12126">of them is actually </span><span class="line" data-startTime="12127">used inside of Chrome </span><span class="line" data-startTime="12127">because of its speed. </span> <span class="line" data-startTime="12129">And I think there was </span><span class="line" data-startTime="12129">actually a news article </span><span class="line" data-startTime="12131">a couple of weeks </span><span class="line" data-startTime="12131">ago of Apple actually </span><span class="line" data-startTime="12132">acquiring a Scottish </span><span class="line" data-startTime="12132">company or an Irish company </span><span class="line" data-startTime="12137">that all they did was make a </span><span class="line" data-startTime="12137">faster JPEG decoder for the iOS </span><span class="line" data-startTime="12141">platform. </span> <span class="line" data-startTime="12142">And so they are now all living </span><span class="line" data-startTime="12142">in mansions with waterfalls </span><span class="line" data-startTime="12145">inside of their mansions </span><span class="line" data-startTime="12145">because they just </span><span class="line" data-startTime="12147">made a JPEG decoder </span><span class="line" data-startTime="12147">that was faster. </span></p>

<p><span class="line" data-startTime="12149">But yeah, definitely </span><span class="line" data-startTime="12149">check those out. </span></p>

<p class="speaker"><span class="line" data-starttime="12157"><span class="speakerName">Audience</span>: So I do </span><span class="line" data-startTime="12157">have a question </span><span class="line" data-startTime="12158">about the special font </span><span class="line" data-startTime="12158">files for Colt, the WOFF, </span><span class="line" data-startTime="12162">I guess or whatever, </span><span class="line" data-startTime="12162">whoever knows better. </span><span class="line" data-startTime="12166">And a font or some </span><span class="line" data-startTime="12166">which some people </span><span class="line" data-startTime="12169">use for icons and whatnot, </span><span class="line" data-startTime="12169">what's the suggestion? </span><span class="line" data-startTime="12173">What do you do? </span></p>

<p class="speaker"><span class="line" data-starttime="12174"><span class="speakerName">Jake Archibald</span>: In terms of </span><span class="line" data-startTime="12174">what you would do for icons? </span></p>

<p class="speaker"><span class="line" data-starttime="12176"><span class="speakerName">Audience</span>: You don't use them at </span><span class="line" data-startTime="12176">all or how to avoid using them </span><span class="line" data-startTime="12179">if the client wants a </span><span class="line" data-startTime="12179">specific pretty font? </span><span class="line" data-startTime="12182">What do you do? </span><span class="line" data-startTime="12183">JAKE ARCHIBALD: </span><span class="line" data-startTime="12183">So I would always </span><span class="line" data-startTime="12184">avoid using web </span><span class="line" data-startTime="12184">fonts for body copy. </span> <span class="line" data-startTime="12187">You can almost get away with </span><span class="line" data-startTime="12187">it for things like headlines, </span><span class="line" data-startTime="12190">because the chances are the </span><span class="line" data-startTime="12190">user has some idea of what </span><span class="line" data-startTime="12194">the headline is going to be. </span> <span class="line" data-startTime="12195">They've either clicked </span><span class="line" data-startTime="12195">it from the previous page </span><span class="line" data-startTime="12197">or they've clicked it from </span><span class="line" data-startTime="12197">search results or something </span><span class="line" data-startTime="12198">like that. </span> <span class="line" data-startTime="12199">The problem is when it's </span><span class="line" data-startTime="12199">there for body copy, </span><span class="line" data-startTime="12201">because that's when not </span><span class="line" data-startTime="12201">only is the user going </span><span class="line" data-startTime="12204">to have to wait for the </span><span class="line" data-startTime="12204">CSS to see anything, </span><span class="line" data-startTime="12205">because there are very </span><span class="line" data-startTime="12205">few resources that </span><span class="line" data-startTime="12208">are going to block </span><span class="line" data-startTime="12208">your first render. </span> <span class="line" data-startTime="12209">It's JavaScript. </span></p>

<p><span class="line" data-startTime="12210">If it's done wrong, </span><span class="line" data-startTime="12210">it's CSS all the time. </span> <span class="line" data-startTime="12213">And it's web fonts. </span> <span class="line" data-startTime="12215">And the problem with web </span><span class="line" data-startTime="12215">fonts is their loading </span><span class="line" data-startTime="12217">is triggered by the CSS. </span> <span class="line" data-startTime="12219">It's going to </span><span class="line" data-startTime="12219">happen after layout. </span> <span class="line" data-startTime="12221">So your CSS downloads. </span> <span class="line" data-startTime="12222">There's a layout done. </span> <span class="line" data-startTime="12223">And then it goes, oh, I </span><span class="line" data-startTime="12223">need to download a font. </span> <span class="line" data-startTime="12226">The font downloads. </span> <span class="line" data-startTime="12227">And then it can </span><span class="line" data-startTime="12227">render that text. </span> <span class="line" data-startTime="12228">I would say avoid for body copy. </span> <span class="line" data-startTime="12232">You can use a </span><span class="line" data-startTime="12232">WebFont loader, which </span><span class="line" data-startTime="12234">is something developed </span><span class="line" data-startTime="12234">by Google and Typekit. </span></p>

<p><span class="line" data-startTime="12236">And what you can </span><span class="line" data-startTime="12236">do there is it will </span><span class="line" data-startTime="12238">use JavaScript to </span><span class="line" data-startTime="12238">load the web fonts. </span> <span class="line" data-startTime="12241">And it will give you special </span><span class="line" data-startTime="12241">class names on the HTML or body </span><span class="line" data-startTime="12244">element, I forget </span><span class="line" data-startTime="12244">which, that indicate </span><span class="line" data-startTime="12246">the loading states of that font. </span> <span class="line" data-startTime="12248">And you can then decide </span><span class="line" data-startTime="12248">to use a different font </span><span class="line" data-startTime="12251">while it's loading. </span> <span class="line" data-startTime="12252">You can force, kind of what </span><span class="line" data-startTime="12252">Internet Explorer does. </span> <span class="line" data-startTime="12255">But it means you can tweak </span><span class="line" data-startTime="12255">the size of the fallback font </span><span class="line" data-startTime="12257">to more closely match, </span><span class="line" data-startTime="12257">change the line height, </span><span class="line" data-startTime="12260">change the size to </span><span class="line" data-startTime="12260">more closely match </span><span class="line" data-startTime="12261">the font that will load in. </span> <span class="line" data-startTime="12263">So you can do that </span><span class="line" data-startTime="12263">with headlines </span><span class="line" data-startTime="12264">because they tend </span><span class="line" data-startTime="12264">to be one line. </span> <span class="line" data-startTime="12267">You'll struggle </span><span class="line" data-startTime="12267">with the body copy, </span><span class="line" data-startTime="12269">because the user will </span><span class="line" data-startTime="12269">be reading a bit. </span> <span class="line" data-startTime="12271">And then the chances are </span><span class="line" data-startTime="12271">things are going to jump. </span> <span class="line" data-startTime="12273">And the word is going to </span><span class="line" data-startTime="12273">move along the line or worse. </span> <span class="line" data-startTime="12275">It's going to wrap differently. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="12280"><span class="speakerName">Pete</span>: Next question? </span></p>

<p class="speaker"><span class="line" data-starttime="12284"><span class="speakerName">Audience</span>: This is </span><span class="line" data-startTime="12284">for any and all. </span> <span class="line" data-startTime="12287">We saw a lot of examples that </span><span class="line" data-startTime="12287">was pretty easy to detect </span><span class="line" data-startTime="12291">performance issues with file </span><span class="line" data-startTime="12291">sizes and number of network </span><span class="line" data-startTime="12294">requests. </span> <span class="line" data-startTime="12295">Increasingly, we're seeing sites </span><span class="line" data-startTime="12295">that the perception of page </span><span class="line" data-startTime="12299">load is just as bad as </span><span class="line" data-startTime="12299">the actual throughput. </span> <span class="line" data-startTime="12302">So can you talk a </span><span class="line" data-startTime="12302">little bit about how </span><span class="line" data-startTime="12303">you would analyze and </span><span class="line" data-startTime="12303">test for, basically, </span><span class="line" data-startTime="12306">all the crap that's being </span><span class="line" data-startTime="12306">done when DOM is ready </span><span class="line" data-startTime="12309">and people are just loading </span><span class="line" data-startTime="12309">stuff after the initial load </span><span class="line" data-startTime="12313">and there's all kinds of junk </span><span class="line" data-startTime="12313">happening with JavaScript? </span><span class="line" data-startTime="12316">How would you test and </span><span class="line" data-startTime="12316">analyze that kind of thing? </span><span class="line" data-startTime="12318">JAKE ARCHIBALD: </span><span class="line" data-startTime="12318">Well, first, I want </span><span class="line" data-startTime="12319">to pick up on </span><span class="line" data-startTime="12319">something that Colt </span><span class="line" data-startTime="12321">said, because I think </span><span class="line" data-startTime="12321">it's worth saying again. </span> <span class="line" data-startTime="12323">If your site has a </span><span class="line" data-startTime="12323">loading bar, 99% of cases, </span><span class="line" data-startTime="12329">that's a missed opportunity. </span> <span class="line" data-startTime="12331">You're doing it wrong. </span> <span class="line" data-startTime="12333">And I include Gmail </span><span class="line" data-startTime="12333">in this as well. </span> <span class="line" data-startTime="12335">The fact that I have to </span><span class="line" data-startTime="12335">watch a loading bar go </span><span class="line" data-startTime="12338">to see a set of email subjects, </span><span class="line" data-startTime="12338">which is just a list &mdash; it's </span><span class="line" data-startTime="12343">essentially an HTML list of </span><span class="line" data-startTime="12343">a sentence &mdash; is ridiculous. </span></p>

<p><span class="line" data-startTime="12347">And if you compare something </span><span class="line" data-startTime="12347">like TweetDeck to Twitter, </span><span class="line" data-startTime="12351">Twitter will do this. </span> <span class="line" data-startTime="12352">They serve HTML and CSS. </span> <span class="line" data-startTime="12354">You get the content </span><span class="line" data-startTime="12354">as it's loading. </span> <span class="line" data-startTime="12356">Whereas in something </span><span class="line" data-startTime="12356">like TweetDeck, </span><span class="line" data-startTime="12357">you get this loading bar. </span> <span class="line" data-startTime="12359">So yeah, it pulls </span><span class="line" data-startTime="12359">script out of you. </span> <span class="line" data-startTime="12363">Avoid depending on script </span><span class="line" data-startTime="12363">for a first render, I think, </span><span class="line" data-startTime="12366">would be the first case. </span> <span class="line" data-startTime="12367">But I don't know. </span> <span class="line" data-startTime="12368">Do you have anything </span><span class="line" data-startTime="12368">in terms of how </span><span class="line" data-startTime="12370">you would test that or </span><span class="line" data-startTime="12370">any continuous integration </span><span class="line" data-startTime="12372">for that? </span></p>

<p class="speaker"><span class="line" data-starttime="12374"><span class="speakerName">Colt McAnlis</span>: Telemetry. </span> <span class="line" data-startTime="12375">Yeah. </span> <span class="line" data-startTime="12375">So we didn't really </span><span class="line" data-startTime="12375">get a chance to talk </span><span class="line" data-startTime="12377">a lot about continuous </span><span class="line" data-startTime="12377">integration tonight. </span> <span class="line" data-startTime="12379">I think Jake and I both agree </span><span class="line" data-startTime="12379">that probably the next big step </span><span class="line" data-startTime="12382">in web performance is getting </span><span class="line" data-startTime="12382">a good tool out there to allow </span><span class="line" data-startTime="12386">you to do performance, </span><span class="line" data-startTime="12386">continuous integration. </span> <span class="line" data-startTime="12388">So you should be able to have </span><span class="line" data-startTime="12388">some distributed team checking </span><span class="line" data-startTime="12392">in code changes to some </span><span class="line" data-startTime="12392">GitHub or something like that. </span> <span class="line" data-startTime="12396">And then some automated system </span><span class="line" data-startTime="12396">will actually kick off a build. </span> <span class="line" data-startTime="12399">And then once that </span><span class="line" data-startTime="12399">build is done, </span><span class="line" data-startTime="12399">it's run across continuous </span><span class="line" data-startTime="12399">integration environment </span><span class="line" data-startTime="12402">across different web servers </span><span class="line" data-startTime="12402">and different mobile devices </span><span class="line" data-startTime="12404">and actually give you </span><span class="line" data-startTime="12404">performance information back, </span><span class="line" data-startTime="12406">not just from the </span><span class="line" data-startTime="12406">network side of things, </span><span class="line" data-startTime="12408">but also from the rendering </span><span class="line" data-startTime="12408">side of things, the JavaScript </span><span class="line" data-startTime="12411">side of things, post load Ajax </span><span class="line" data-startTime="12411">style information as well, </span><span class="line" data-startTime="12415">and be able to give </span><span class="line" data-startTime="12415">you that in a report. </span> <span class="line" data-startTime="12417">So you can actually go back </span><span class="line" data-startTime="12417">and be like, hey, Jake, you </span><span class="line" data-startTime="12420">broke the perf build, dude. </span></p>

<p><span class="line" data-startTime="12421">I think this is </span><span class="line" data-startTime="12421">actually the next step </span><span class="line" data-startTime="12424">in tooling for the web. </span> <span class="line" data-startTime="12425">And I think we're pretty far </span><span class="line" data-startTime="12425">away from it, unfortunately. </span> <span class="line" data-startTime="12429">So I hope that there's </span><span class="line" data-startTime="12429">a lot of people </span><span class="line" data-startTime="12430">thinking about this problem. </span></p>

<p class="speaker"><span class="line" data-starttime="12432"><span class="speakerName">Pete</span>: Next question? </span></p>

<p class="speaker"><span class="line" data-starttime="12434"><span class="speakerName">Audience</span>: So the set </span><span class="line" data-startTime="12434">timeout, instead of that, </span><span class="line" data-startTime="12437">you should be using [INAUDIBLE] </span><span class="line" data-startTime="12437">for polling, for daemons. </span></p>

<p class="speaker"><span class="line" data-starttime="12443"><span class="speakerName">Colt McAnlis</span>: So set timeout, </span><span class="line" data-startTime="12443">in itself, is not a problem. </span><span class="line" data-startTime="12447">I'll say that again. </span><span class="line" data-startTime="12447">Set timeout, in itself, </span><span class="line" data-startTime="12447">is not a problem. </span><span class="line" data-startTime="12450">The problem is passing a </span><span class="line" data-startTime="12450">closure to set timeout. </span><span class="line" data-startTime="12454">So obviously, if </span><span class="line" data-startTime="12454">you're using a closure, </span><span class="line" data-startTime="12458">there's a chance </span><span class="line" data-startTime="12458">that you don't know </span><span class="line" data-startTime="12460">why you're using a closure. </span><span class="line" data-startTime="12461">Or you're using a </span><span class="line" data-startTime="12461">closure, because you </span><span class="line" data-startTime="12462">think it's a better </span><span class="line" data-startTime="12462">coding pattern. </span><span class="line" data-startTime="12465">It seems to be a pretty </span><span class="line" data-startTime="12465">standard coding practice when </span><span class="line" data-startTime="12467">you go copy paste </span><span class="line" data-startTime="12467">off of the web. </span></p>

<p class="speaker"><span class="line" data-starttime="12471"><span class="speakerName">Audience</span>: [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="12476"><span class="speakerName">Colt McAnlis</span>: Again, the set </span><span class="line" data-startTime="12476">interval, not the problem. </span><span class="line" data-startTime="12480">Feel free to use set interval. </span><span class="line" data-startTime="12482">Yay, set interval. </span><span class="line" data-startTime="12483">Woo! </span><span class="line" data-startTime="12484">The problem is set interval </span><span class="line" data-startTime="12484">plus incorrect memory </span><span class="line" data-startTime="12487">management or closure is </span><span class="line" data-startTime="12487">being passed to set interval. </span><span class="line" data-startTime="12489">That's the problem. </span></p>

<p class="speaker"><span class="line" data-starttime="12493"><span class="speakerName">Jake Archibald</span>: What I would say </span><span class="line" data-startTime="12493">is if you're doing animations, </span><span class="line" data-startTime="12496">you've got this, </span><span class="line" data-startTime="12496">assuming 60 Hz screen, </span><span class="line" data-startTime="12498">you've got this </span><span class="line" data-startTime="12498">16.67 milliseconds </span><span class="line" data-startTime="12501">window in order to produce what </span><span class="line" data-startTime="12501">you want to produce and then </span><span class="line" data-startTime="12505">get that on the screen </span><span class="line" data-startTime="12505">in the next refresh. </span> <span class="line" data-startTime="12507">If something else in the </span><span class="line" data-startTime="12507">page is running set interval, </span><span class="line" data-startTime="12511">I'm assuming you're using </span><span class="line" data-startTime="12511">RequestAnimationFrame </span><span class="line" data-startTime="12513">for your animations, which you </span><span class="line" data-startTime="12513">should be, or CSS animations. </span> <span class="line" data-startTime="12516">But if you then have set </span><span class="line" data-startTime="12516">interval or something running </span><span class="line" data-startTime="12519">or some other things </span><span class="line" data-startTime="12519">using set interval, </span><span class="line" data-startTime="12521">even if that's only going </span><span class="line" data-startTime="12521">to take three milliseconds, </span><span class="line" data-startTime="12524">if it happens in the </span><span class="line" data-startTime="12524">three milliseconds </span><span class="line" data-startTime="12525">when there's going to be a </span><span class="line" data-startTime="12525">new refresh on the screen, </span><span class="line" data-startTime="12528">it's going to block that frame </span><span class="line" data-startTime="12528">from happening on the screen. </span></p>

<p><span class="line" data-startTime="12530">And it will drop a frame. </span> <span class="line" data-startTime="12532">So if you're doing </span><span class="line" data-startTime="12532">a set interval, </span><span class="line" data-startTime="12536">if you're going to do </span><span class="line" data-startTime="12536">some work inside that, </span><span class="line" data-startTime="12538">you do your set intervals </span><span class="line" data-startTime="12538">for whatever you want, </span><span class="line" data-startTime="12541">like every 300 </span><span class="line" data-startTime="12541">milliseconds or whatever. </span> <span class="line" data-startTime="12544">If you've got some </span><span class="line" data-startTime="12544">substantial work </span><span class="line" data-startTime="12545">to do in there or </span><span class="line" data-startTime="12545">really any work, </span><span class="line" data-startTime="12547">use RequestAnimationFrame </span><span class="line" data-startTime="12547">in there </span><span class="line" data-startTime="12549">as well, because it'll </span><span class="line" data-startTime="12549">queue that stuff up </span><span class="line" data-startTime="12550">for right at the </span><span class="line" data-startTime="12550">start of the refresh </span><span class="line" data-startTime="12554">and along with, </span><span class="line" data-startTime="12554">maybe, other timers </span><span class="line" data-startTime="12556">that just happen to coincide </span><span class="line" data-startTime="12556">roughly at the same time. </span></p>

<p class="speaker"><span class="line" data-starttime="12559"><span class="speakerName">Colt McAnlis</span>: Really </span><span class="line" data-startTime="12559">quick on that. </span> <span class="line" data-startTime="12561">So there's actually </span><span class="line" data-startTime="12561">a design pattern </span><span class="line" data-startTime="12562">that I don't talk about a lot, </span><span class="line" data-startTime="12562">because people throw chairs </span><span class="line" data-startTime="12565">at me. </span> <span class="line" data-startTime="12567">So a lot of people are </span><span class="line" data-startTime="12567">actually handling input </span><span class="line" data-startTime="12571">when the user actually </span><span class="line" data-startTime="12571">gives them that event. </span> <span class="line" data-startTime="12573">So you click. </span> <span class="line" data-startTime="12574">I get the on-click event. </span> <span class="line" data-startTime="12575">And you go, cool, </span><span class="line" data-startTime="12575">this is an event. </span> <span class="line" data-startTime="12576">Let me run some code right now. </span> <span class="line" data-startTime="12578">That's actually a </span><span class="line" data-startTime="12578">bad idea as well. </span> <span class="line" data-startTime="12579">Because, again, you </span><span class="line" data-startTime="12579">have to remember </span><span class="line" data-startTime="12580">that the web page </span><span class="line" data-startTime="12580">and the browser </span><span class="line" data-startTime="12582">is going to come along </span><span class="line" data-startTime="12582">at every 16 milliseconds </span><span class="line" data-startTime="12584">or whatever the refresh </span><span class="line" data-startTime="12584">rate of the monitor is. </span></p>

<p><span class="line" data-startTime="12586">And it's going to try to </span><span class="line" data-startTime="12586">repaint and refresh the screen. </span> <span class="line" data-startTime="12590">But if that JavaScript is in </span><span class="line" data-startTime="12590">the middle of executing input </span><span class="line" data-startTime="12593">or set intervals </span><span class="line" data-startTime="12593">or anything, it's </span><span class="line" data-startTime="12595">going to block that </span><span class="line" data-startTime="12595">from occurring. </span> <span class="line" data-startTime="12597">And so there's a </span><span class="line" data-startTime="12597">different design pattern </span><span class="line" data-startTime="12599">that we've seen very </span><span class="line" data-startTime="12599">successful, and we see it </span><span class="line" data-startTime="12601">with game developers especially, </span><span class="line" data-startTime="12601">is that you don't actually </span><span class="line" data-startTime="12603">do any logic in </span><span class="line" data-startTime="12603">callback handlers. </span> <span class="line" data-startTime="12606">Instead, you actually just </span><span class="line" data-startTime="12606">cache that value away. </span></p>

<p><span class="line" data-startTime="12609">And the next time that </span><span class="line" data-startTime="12609">your RequestAnimationFrame </span><span class="line" data-startTime="12611">comes around, you </span><span class="line" data-startTime="12611">actually respond to that. </span> <span class="line" data-startTime="12613">And so if you want to get rid </span><span class="line" data-startTime="12613">of this set interval system, </span><span class="line" data-startTime="12617">just put all that logic in </span><span class="line" data-startTime="12617">a RequestAnimationFrame. </span> <span class="line" data-startTime="12620">The difference is in </span><span class="line" data-startTime="12620">whatever your interval </span><span class="line" data-startTime="12622">you think your interval needs </span><span class="line" data-startTime="12622">to be in the 16 milliseconds </span><span class="line" data-startTime="12624">that RequestAnimationFrame </span><span class="line" data-startTime="12624">comes around, come on. </span> <span class="line" data-startTime="12627">We're talking about polling </span><span class="line" data-startTime="12627">data or other things. </span> <span class="line" data-startTime="12630">So it's a different </span><span class="line" data-startTime="12630">mental model. </span></p>

<p class="speaker"><span class="line" data-starttime="12632"><span class="speakerName">Pete</span>: OK. </span><span class="line" data-startTime="12634">So virtually, we're out </span><span class="line" data-startTime="12634">of time for questions. </span><span class="line" data-startTime="12637">That's our show for tonight. </span><span class="line" data-startTime="12644">Yes. </span><span class="line" data-startTime="12644">OK. </span><span class="line" data-startTime="12645">So our next event is </span><span class="line" data-startTime="12645">going to our Hack Day. </span><span class="line" data-startTime="12646">It's going to be November 16. </span><span class="line" data-startTime="12648">It's going to be right here. </span><span class="line" data-startTime="12649">@timesopen and @nytdevs to </span><span class="line" data-startTime="12649">follow what we're up to. </span><span class="line" data-startTime="12653">@nytdevs is the </span><span class="line" data-startTime="12653">main one on Twitter. </span><span class="line" data-startTime="12655">You can also visit our site, </span><span class="line" data-startTime="12655">developers@NYTimes.com. </span><span class="line" data-startTime="12658">I wanted to thank our speakers. </span><span class="line" data-startTime="12660">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="12666"><span class="speakerName">Pete</span>: I want to thank the </span><span class="line" data-startTime="12666">team that planned the event. </span><span class="line" data-startTime="12668">They're all wearing </span><span class="line" data-startTime="12668">purple shirts. </span><span class="line" data-startTime="12669">They can all wave their hands. </span><span class="line" data-startTime="12671">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="12674"><span class="speakerName">Pete</span>: And Pete </span><span class="line" data-startTime="12674">LePage from Google, </span><span class="line" data-startTime="12676">who is standing there carefully </span><span class="line" data-startTime="12676">looking at his camera. </span><span class="line" data-startTime="12679">A lot of work went into this. </span><span class="line" data-startTime="12681">And we want to thank </span><span class="line" data-startTime="12681">you for coming. </span><span class="line" data-startTime="12683">It's been a great night. </span><span class="line" data-startTime="12685">Go make your websites faster. </span><span class="line" data-startTime="12687">We're good? </span><span class="line" data-startTime="12690">Oh, yes. </span><span class="line" data-startTime="12691">One other thing &mdash; </span></p></div>