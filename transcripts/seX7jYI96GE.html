<p><span class="line" data-startTime="3">Russell: </span><span class="line" data-startTime="3">Good afternoon. </span> <span class="line" data-startTime="4">I'm Alex Russell. </span> <span class="line" data-startTime="5">I'm a software engineer </span><span class="line" data-startTime="5">on the Chrome Team. </span> <span class="line" data-startTime="6">Thanks for tearing yourself </span><span class="line" data-startTime="6">away from lunch </span><span class="line" data-startTime="8">to come hear </span><span class="line" data-startTime="8">about JavaScript. </span> <span class="line" data-startTime="10">So like I said, I'm an engineer </span><span class="line" data-startTime="10">on the Chrome Team, </span><span class="line" data-startTime="14">and before I joined Google, </span><span class="line" data-startTime="15">I spent a lot of my life </span><span class="line" data-startTime="15">working in JavaScript. </span> <span class="line" data-startTime="18">I joined the Chrome Team from </span><span class="line" data-startTime="18">a web development background, </span><span class="line" data-startTime="21">specifically working on open </span><span class="line" data-startTime="21">source JavaScript tool kits </span><span class="line" data-startTime="23">and before that, </span><span class="line" data-startTime="24">working web application </span><span class="line" data-startTime="24">development and security. </span> <span class="line" data-startTime="26">And before my recent </span><span class="line" data-startTime="26">detour into C++, </span><span class="line" data-startTime="30">I spent most of my day </span><span class="line" data-startTime="30">trying to figure out </span><span class="line" data-startTime="33">how to make JavaScript </span><span class="line" data-startTime="33">do interesting things. </span></p>

<p><span class="line" data-startTime="35">My personal history with </span><span class="line" data-startTime="35">JavaScript started in 1997, </span><span class="line" data-startTime="39">I think when a lot of us started </span><span class="line" data-startTime="39">to be cognizant of the web. </span> <span class="line" data-startTime="42">And at the time, JavaScript </span><span class="line" data-startTime="42">was this thing </span><span class="line" data-startTime="44">that was starting </span><span class="line" data-startTime="44">to become powerful </span><span class="line" data-startTime="46">and somewhat standardized </span><span class="line" data-startTime="47">and somewhat widely available on </span><span class="line" data-startTime="47">the back of the browser wars. </span> <span class="line" data-startTime="52">So I want to talk a lot about </span><span class="line" data-startTime="54">how we got to where we are </span><span class="line" data-startTime="54">today with JavaScript, </span><span class="line" data-startTime="56">why it's so important, </span><span class="line" data-startTime="56">why that history, </span><span class="line" data-startTime="58">that long history continues </span><span class="line" data-startTime="60">to figure into the sorts of </span><span class="line" data-startTime="60">things we try to do </span><span class="line" data-startTime="63">with JavaScript on </span><span class="line" data-startTime="63">a day-to-day basis. </span> <span class="line" data-startTime="65">And I want to take you </span><span class="line" data-startTime="65">through what's really </span><span class="line" data-startTime="67">inside of JavaScript. </span></p>

<p><span class="line" data-startTime="68">What is it about </span><span class="line" data-startTime="68">JavaScript that it is, </span><span class="line" data-startTime="70">that makes it so different </span><span class="line" data-startTime="70">to the languages </span><span class="line" data-startTime="72">that you might be using </span><span class="line" data-startTime="72">in your day-to-day work </span><span class="line" data-startTime="74">that aren't JavaScript, </span><span class="line" data-startTime="74">because there's a lot that is. </span> <span class="line" data-startTime="77">Exactly where </span><span class="line" data-startTime="77">are we right now? </span><span class="line" data-startTime="79">Because I think </span><span class="line" data-startTime="79">this is also sort of </span><span class="line" data-startTime="80">an ambiguous question, right? </span><span class="line" data-startTime="80">If you're a browser bender, </span><span class="line" data-startTime="83">it's easy to say </span><span class="line" data-startTime="83">we're this fast &mdash; easy-ish. </span> <span class="line" data-startTime="87">If you're a web developer, </span><span class="line" data-startTime="88">you can look </span><span class="line" data-startTime="88">in your deployed base </span><span class="line" data-startTime="89">and understand </span><span class="line" data-startTime="89">who's got what, </span><span class="line" data-startTime="91">but that doesn't necessarily </span><span class="line" data-startTime="91">tell you anything </span><span class="line" data-startTime="92">about the future. </span></p>

<p><span class="line" data-startTime="94">And I want to spend a lot </span><span class="line" data-startTime="94">of time today talking about </span><span class="line" data-startTime="96">how it is that we are going </span><span class="line" data-startTime="96">to get a different future </span><span class="line" data-startTime="98">for JavaScript, </span><span class="line" data-startTime="99">because JavaScript, </span><span class="line" data-startTime="99">like the browsers, </span><span class="line" data-startTime="100">is starting to move again, </span><span class="line" data-startTime="102">and I want to </span><span class="line" data-startTime="102">tear back the veil </span><span class="line" data-startTime="106">that covers each of </span><span class="line" data-startTime="106">these topics </span><span class="line" data-startTime="108">and help you understand </span><span class="line" data-startTime="108">exactly what's going on </span><span class="line" data-startTime="109">and how these parts relate to </span><span class="line" data-startTime="109">each other, because they do. </span> <span class="line" data-startTime="112">The history informs </span><span class="line" data-startTime="112">the future, </span><span class="line" data-startTime="114">and the current state informs </span><span class="line" data-startTime="114">what's going to happen next. </span> <span class="line" data-startTime="117">So JavaScript is </span><span class="line" data-startTime="117">a functional language. </span> <span class="line" data-startTime="120">So how many of you write </span><span class="line" data-startTime="120">in other functional languages </span><span class="line" data-startTime="122">or are familiar with </span><span class="line" data-startTime="122">functional languages? </span><span class="line" data-startTime="124">Awesome. </span></p>

<p><span class="line" data-startTime="125">The front of this talk is </span><span class="line" data-startTime="125">going to be something </span><span class="line" data-startTime="126">that maybe just warms your heart </span><span class="line" data-startTime="126">and may not be new information. </span> <span class="line" data-startTime="130">So JavaScript is </span><span class="line" data-startTime="130">a functional language. </span> <span class="line" data-startTime="132">In the sort of the history </span><span class="line" data-startTime="132">of functional languages, </span><span class="line" data-startTime="138">it supports closures. </span> <span class="line" data-startTime="139">Much like Scheme, </span><span class="line" data-startTime="141">it's got this nice </span><span class="line" data-startTime="141">first class function system, </span><span class="line" data-startTime="145">and in 1995, Brenda and I hacked </span><span class="line" data-startTime="145">it up as a little prototype </span><span class="line" data-startTime="150">which made its way </span><span class="line" data-startTime="150">into Netscape 2, </span><span class="line" data-startTime="152">and Netscape 2 </span><span class="line" data-startTime="152">was the first browser </span><span class="line" data-startTime="154">to really have any serious </span><span class="line" data-startTime="154">scripting supported. </span> <span class="line" data-startTime="156">It had DOM level 0, </span><span class="line" data-startTime="156">and soon afterwards, </span><span class="line" data-startTime="160">JavaScript sort of, you know, </span><span class="line" data-startTime="163">once it escaped </span><span class="line" data-startTime="163">into the browser, </span><span class="line" data-startTime="164">started the standards </span><span class="line" data-startTime="164">process at ECMA, </span><span class="line" data-startTime="166">not inside the W3C, </span><span class="line" data-startTime="168">because the W3C wasn't </span><span class="line" data-startTime="168">the place for languages. </span> <span class="line" data-startTime="172">And in 1997, we got </span><span class="line" data-startTime="172">the first version of JavaScript </span><span class="line" data-startTime="175">as a standard. </span></p>

<p><span class="line" data-startTime="176">In 1996, Microsoft </span><span class="line" data-startTime="176">shipped IE 3.0, </span><span class="line" data-startTime="182">and that was the first version </span><span class="line" data-startTime="182">of JScript. </span> <span class="line" data-startTime="183">So we now had two competing, </span><span class="line" data-startTime="185">mostly compatible </span><span class="line" data-startTime="185">implementations </span><span class="line" data-startTime="187">of a scripting language </span><span class="line" data-startTime="187">for the web. </span> <span class="line" data-startTime="189">Nobody knew how big </span><span class="line" data-startTime="189">the web was going to be, </span><span class="line" data-startTime="191">although, at the time, </span><span class="line" data-startTime="192">it looked like things </span><span class="line" data-startTime="192">were trending up. </span> <span class="line" data-startTime="194">Well, we know how </span><span class="line" data-startTime="194">that story ends. </span> <span class="line" data-startTime="195">Today, you can't ship </span><span class="line" data-startTime="195">a credible platform </span><span class="line" data-startTime="197">that doesn't have the web. </span> <span class="line" data-startTime="199">In 1999, ECMAScript </span><span class="line" data-startTime="199">version 3 </span><span class="line" data-startTime="203">was finalized at TC39, </span><span class="line" data-startTime="203">which is the technical committee </span><span class="line" data-startTime="207">that is the standards body </span><span class="line" data-startTime="207">for JavaScript. </span></p>

<p><span class="line" data-startTime="212">And from its humble roots </span><span class="line" data-startTime="214">as Mocha/LiveScript/JavaScript </span><span class="line" data-startTime="214">in Netscape 2, </span><span class="line" data-startTime="219">JavaScript 3, ECMAScript 262-3, </span><span class="line" data-startTime="219">the version or the standard </span><span class="line" data-startTime="223">that was released in 1999 has </span><span class="line" data-startTime="223">powered us pretty much to today. </span> <span class="line" data-startTime="228">It has been the thing </span><span class="line" data-startTime="228">that for more than a decade </span><span class="line" data-startTime="231">has been what </span><span class="line" data-startTime="231">we think of as JavaScript. </span> <span class="line" data-startTime="234">And JavaScript, on the back </span><span class="line" data-startTime="234">of that standard, </span><span class="line" data-startTime="237">has gone pretty much everywhere. </span> <span class="line" data-startTime="238">JScript, the component that runs </span><span class="line" data-startTime="238">JavaScript inside of IE, </span><span class="line" data-startTime="241">has been built in to the OS </span><span class="line" data-startTime="241">for Windows since Windows 98. </span> <span class="line" data-startTime="244">You can't get </span><span class="line" data-startTime="244">a copy of Windows, </span><span class="line" data-startTime="246">you can't buy </span><span class="line" data-startTime="246">a copy of Windows today </span><span class="line" data-startTime="248">that does not include </span><span class="line" data-startTime="248">JavaScript in the OS, </span><span class="line" data-startTime="251">and every browser on the planet </span><span class="line" data-startTime="251">now includes </span><span class="line" data-startTime="253">at least one implementation of </span><span class="line" data-startTime="253">JavaScript, </span><span class="line" data-startTime="254">and these things are moving </span><span class="line" data-startTime="254">really, really fast. </span></p>

<p><span class="line" data-startTime="256">I work on the Chrome Team; </span><span class="line" data-startTime="256">therefore, I'm partial to V8. </span> <span class="line" data-startTime="260">It goes nice and quickly, </span><span class="line" data-startTime="261">but these things </span><span class="line" data-startTime="261">are all compatible </span><span class="line" data-startTime="263">to a very high degree. </span> <span class="line" data-startTime="264">All of these implementations </span><span class="line" data-startTime="264">are separate implementations, </span><span class="line" data-startTime="267">and they're competing </span><span class="line" data-startTime="267">on things that aren't, </span><span class="line" data-startTime="268">"Oh, here's a new language </span><span class="line" data-startTime="268">feature." </span><span class="line" data-startTime="270">We're collaborating </span><span class="line" data-startTime="270">on language features </span><span class="line" data-startTime="271">in the standards committee, </span><span class="line" data-startTime="273">but we're competing </span><span class="line" data-startTime="273">on performance, </span><span class="line" data-startTime="276">which is a really great place </span><span class="line" data-startTime="276">to be for a language, </span><span class="line" data-startTime="278">because it takes </span><span class="line" data-startTime="278">a lot of investment </span><span class="line" data-startTime="279">to make a language </span><span class="line" data-startTime="279">a real success. </span></p>

<p><span class="line" data-startTime="280">It takes </span><span class="line" data-startTime="280">a lot of deployment, </span><span class="line" data-startTime="282">a lot of competition, </span><span class="line" data-startTime="282">and a lot of investment </span><span class="line" data-startTime="283">to sort of get </span><span class="line" data-startTime="283">the really smart guys </span><span class="line" data-startTime="285">that it takes to go make </span><span class="line" data-startTime="285">a VM go like hell. </span> <span class="line" data-startTime="287">And so JavaScript has been </span><span class="line" data-startTime="287">the beneficiary </span><span class="line" data-startTime="289">of this sort of ecosystem of </span><span class="line" data-startTime="289">investment in a way </span><span class="line" data-startTime="292">that only a couple of languages </span><span class="line" data-startTime="292">before it ever have. </span> <span class="line" data-startTime="294">And as a result, today's </span><span class="line" data-startTime="294">JavaScript runtimes </span><span class="line" data-startTime="298">and today's JavaScript </span><span class="line" data-startTime="298">performance are vastly different </span><span class="line" data-startTime="300">than they have been in the past, </span><span class="line" data-startTime="300">even the recent past. </span></p>

<p><span class="line" data-startTime="303">And so every device </span><span class="line" data-startTime="303">that you get today, </span><span class="line" data-startTime="307">including the tablets that were </span><span class="line" data-startTime="307">handed out to you yesterday </span><span class="line" data-startTime="309">and the Chrome books that you'll </span><span class="line" data-startTime="309">be receiving as attendees </span><span class="line" data-startTime="315">on June 15th, </span><span class="line" data-startTime="317">these all have JavaScript as </span><span class="line" data-startTime="317">a core part of their runtimes </span><span class="line" data-startTime="321">because the web </span><span class="line" data-startTime="321">is the platform. </span> <span class="line" data-startTime="322">The web is the way </span><span class="line" data-startTime="322">that you're going to build </span><span class="line" data-startTime="324">a lot of the applications </span><span class="line" data-startTime="325">that your user </span><span class="line" data-startTime="325">is going to care about, </span><span class="line" data-startTime="326">and it's the way to build </span><span class="line" data-startTime="326">portably today. </span> <span class="line" data-startTime="328">So JavaScript is everywhere, </span><span class="line" data-startTime="328">and it's terribly misunderstood. </span> <span class="line" data-startTime="333">And I think what I want to do </span><span class="line" data-startTime="333">first here </span><span class="line" data-startTime="336">is to talk you </span><span class="line" data-startTime="336">through the parts </span><span class="line" data-startTime="338">that most people don't </span><span class="line" data-startTime="338">really have a sense of, </span><span class="line" data-startTime="340">when they talk about, </span><span class="line" data-startTime="342">like, what is it that makes </span><span class="line" data-startTime="342">JavaScript different? </span><span class="line" data-startTime="343">Because we hear it's </span><span class="line" data-startTime="343">a dynamic language. </span> <span class="line" data-startTime="345">We hear it's </span><span class="line" data-startTime="345">a functional language. </span> <span class="line" data-startTime="346">But it looks a lot like C. </span> <span class="line" data-startTime="346">It looks a lot like Java. </span> <span class="line" data-startTime="348">It looks a lot like C++. </span></p>

<p><span class="line" data-startTime="349">And some folks have been </span><span class="line" data-startTime="349">doing a great job </span><span class="line" data-startTime="351">in the last couple of years at </span><span class="line" data-startTime="351">sort of helping to tear back </span><span class="line" data-startTime="353">the blinders </span><span class="line" data-startTime="353">that are on us, </span><span class="line" data-startTime="355">as folks who come from </span><span class="line" data-startTime="355">a C or C++ background, </span><span class="line" data-startTime="359">and help lay out what it is. </span> <span class="line" data-startTime="361">But I want to go </span><span class="line" data-startTime="361">through it very briefly, </span><span class="line" data-startTime="362">because I think it's </span><span class="line" data-startTime="362">important to understand </span><span class="line" data-startTime="364">what's actually in there, </span><span class="line" data-startTime="366">because when we understand </span><span class="line" data-startTime="366">what's actually in there, </span><span class="line" data-startTime="367">we'll understand how </span><span class="line" data-startTime="367">the language can evolve, </span><span class="line" data-startTime="369">because you don't want </span><span class="line" data-startTime="369">necessarily separate &mdash; </span><span class="line" data-startTime="371">competing ideas to be existing </span><span class="line" data-startTime="371">inside the same language. </span> <span class="line" data-startTime="374">You want a language to sort of </span><span class="line" data-startTime="374">have a theory of itself. </span> <span class="line" data-startTime="376">You want it to be coherent </span><span class="line" data-startTime="376">in ways that make it, </span><span class="line" data-startTime="380">so that when you understand </span><span class="line" data-startTime="380">one part of the language, </span><span class="line" data-startTime="381">you can understand </span><span class="line" data-startTime="381">the next part of it. </span></p>

<p><span class="line" data-startTime="383">And my interest in this is </span><span class="line" data-startTime="383">coming from a background </span><span class="line" data-startTime="384">as a web developer, </span><span class="line" data-startTime="386">I serve as one of Google's </span><span class="line" data-startTime="386">representatives to TC39, </span><span class="line" data-startTime="389">the standards committee </span><span class="line" data-startTime="389">for JavaScript. </span> <span class="line" data-startTime="391">And so I have a particular </span><span class="line" data-startTime="391">and keen interest </span><span class="line" data-startTime="392">in making sure that we evolve </span><span class="line" data-startTime="392">the language in ways </span><span class="line" data-startTime="394">that are reasonable </span><span class="line" data-startTime="394">and solve real world problems </span><span class="line" data-startTime="398">that we've all got. </span> <span class="line" data-startTime="399">So JavaScript only has </span><span class="line" data-startTime="399">a couple of key languages. </span> <span class="line" data-startTime="403">I said earlier that JavaScript </span><span class="line" data-startTime="403">is a little functional language, </span><span class="line" data-startTime="406">and JavaScript started out as </span><span class="line" data-startTime="406">a very small language entity. </span> <span class="line" data-startTime="409">There aren't a lot </span><span class="line" data-startTime="409">of core concepts. </span> <span class="line" data-startTime="410">There's no type </span><span class="line" data-startTime="410">system, per se. </span></p>

<p><span class="line" data-startTime="412">There are types. </span> <span class="line" data-startTime="413">You can have a number, </span><span class="line" data-startTime="413">or an object, or an array, </span><span class="line" data-startTime="417">but there's no </span><span class="line" data-startTime="417">type testing. </span> <span class="line" data-startTime="419">There's no way to define </span><span class="line" data-startTime="419">your own types, necessarily, </span><span class="line" data-startTime="421">and have them participate at, </span><span class="line" data-startTime="421">like, function call time </span><span class="line" data-startTime="425">and have the system throw </span><span class="line" data-startTime="425">an exception for you, </span><span class="line" data-startTime="427">unless you do the testing </span><span class="line" data-startTime="427">yourself. </span> <span class="line" data-startTime="429">And JavaScript </span><span class="line" data-startTime="429">reads top to bottom. </span> <span class="line" data-startTime="431">JavaScript has </span><span class="line" data-startTime="431">run-to-completion semantics. </span> <span class="line" data-startTime="433">That means that if you </span><span class="line" data-startTime="433">start a body of code, </span><span class="line" data-startTime="435">there's no multithreading </span><span class="line" data-startTime="435">in the language. </span> <span class="line" data-startTime="436">There's no way for you to sort </span><span class="line" data-startTime="436">of fork off some other process. </span></p>

<p><span class="line" data-startTime="439">Anything that does that in </span><span class="line" data-startTime="439">a JavaScript environment </span><span class="line" data-startTime="442">is doing it as a built-on. </span> <span class="line" data-startTime="443">So browsers with their set </span><span class="line" data-startTime="443">timeout and their set interval. </span> <span class="line" data-startTime="446">That's all happening outside </span><span class="line" data-startTime="446">of the core language semantics. </span> <span class="line" data-startTime="449">JavaScript reads </span><span class="line" data-startTime="449">top to bottom, </span><span class="line" data-startTime="451">and the interpreter </span><span class="line" data-startTime="451">and runtimes read it exactly </span><span class="line" data-startTime="453">and run it exactly that way. </span> <span class="line" data-startTime="455">If you see a block of </span><span class="line" data-startTime="455">JavaScript code, </span><span class="line" data-startTime="456">it goes from top to bottom, </span><span class="line" data-startTime="456">and that'll become important, </span><span class="line" data-startTime="459">as we see in </span><span class="line" data-startTime="459">just a minute. </span> <span class="line" data-startTime="462">Almost everything in </span><span class="line" data-startTime="462">JavaScript is mutable. </span> <span class="line" data-startTime="464">That means that you can </span><span class="line" data-startTime="464">change nearly everything, </span><span class="line" data-startTime="466">and we'll talk about the </span><span class="line" data-startTime="466">several exemptions to this rule, </span><span class="line" data-startTime="470">but those exemptions </span><span class="line" data-startTime="470">are very small, </span><span class="line" data-startTime="472">and they're very narrow, </span><span class="line" data-startTime="472">but they wind up being powerful. </span></p>

<p><span class="line" data-startTime="475">So that means that if you </span><span class="line" data-startTime="475">get an object back from </span><span class="line" data-startTime="476">some function call, </span><span class="line" data-startTime="477">you can probably change it </span><span class="line" data-startTime="477">in JavaScript. </span> <span class="line" data-startTime="480">Closure is the way we do </span><span class="line" data-startTime="480">private state, though, </span><span class="line" data-startTime="481">so if I get an object, </span><span class="line" data-startTime="482">and everything is mutable, </span><span class="line" data-startTime="484">it means, ah, I might be able </span><span class="line" data-startTime="484">to surprise somebody else. </span> <span class="line" data-startTime="485">I might be able to go </span><span class="line" data-startTime="485">change some state out </span><span class="line" data-startTime="487">from underneath them. </span> <span class="line" data-startTime="488">The thing that returned me </span><span class="line" data-startTime="488">the object might expect it </span><span class="line" data-startTime="490">back in some </span><span class="line" data-startTime="490">reasonably okay state. </span> <span class="line" data-startTime="493">Well, the way we do data </span><span class="line" data-startTime="493">hiding in JavaScript </span><span class="line" data-startTime="495">isn't through the private key </span><span class="line" data-startTime="495">order, </span><span class="line" data-startTime="497">through some method that gives </span><span class="line" data-startTime="497">you some sort of a private field </span><span class="line" data-startTime="500">that you can only see. </span> <span class="line" data-startTime="501">Instead, we invert </span><span class="line" data-startTime="501">the relationship </span><span class="line" data-startTime="504">between classes and functions, </span><span class="line" data-startTime="506">and we treat functions as </span><span class="line" data-startTime="506">behavior that can carry data, </span><span class="line" data-startTime="510">versus classes, </span><span class="line" data-startTime="511">which are data that can </span><span class="line" data-startTime="511">carry behavior. </span></p>

<p><span class="line" data-startTime="513">And so the last key concept is, </span><span class="line" data-startTime="513">instead of having a class, </span><span class="line" data-startTime="517">as you understand it in </span><span class="line" data-startTime="517">other languages, </span><span class="line" data-startTime="518">we have prototypes, </span><span class="line" data-startTime="520">which is to say we don't have </span><span class="line" data-startTime="520">this strong "is a" relationship </span><span class="line" data-startTime="523">through a hierarchy </span><span class="line" data-startTime="523">of classes. </span> <span class="line" data-startTime="525">Instead, we say, </span><span class="line" data-startTime="525">when I don't find it here, </span><span class="line" data-startTime="526">please look over there. </span> <span class="line" data-startTime="528">It's delegation, and </span><span class="line" data-startTime="528">it's a one-link chain delegation </span><span class="line" data-startTime="532">up to a root object </span><span class="line" data-startTime="532">that everybody shares. </span></p>

<p><span class="line" data-startTime="534">So we'll talk a lot about </span><span class="line" data-startTime="534">how exactly all this works, </span><span class="line" data-startTime="537">how it fits together, </span><span class="line" data-startTime="538">and hopefully you'll </span><span class="line" data-startTime="538">understand at the end </span><span class="line" data-startTime="541">how it's going to inform </span><span class="line" data-startTime="541">where we can go from here. </span> <span class="line" data-startTime="544">I said earlier that </span><span class="line" data-startTime="544">JavaScript runs top to bottom. </span> <span class="line" data-startTime="547">That means if I see </span><span class="line" data-startTime="547">a piece of code in JavaScript, </span><span class="line" data-startTime="549">one line before the next, </span><span class="line" data-startTime="550">before the next &mdash; because there </span><span class="line" data-startTime="550">isn't necessarily </span><span class="line" data-startTime="553">a compile cycle. </span> <span class="line" data-startTime="554">Most JavaScript runtimes </span><span class="line" data-startTime="554">traditionally were interpreters. </span> <span class="line" data-startTime="557">That means that the easiest way </span><span class="line" data-startTime="559">to think about your </span><span class="line" data-startTime="559">JavaScript program </span><span class="line" data-startTime="560">is as something that is going </span><span class="line" data-startTime="560">to happen in a live environment. </span> <span class="line" data-startTime="566">So if you had </span><span class="line" data-startTime="566">a command line, </span><span class="line" data-startTime="568">and you started typing in </span><span class="line" data-startTime="568">commands, </span><span class="line" data-startTime="569">JavaScript runs almost </span><span class="line" data-startTime="569">exactly the same way. </span> <span class="line" data-startTime="572">Top to bottom, </span><span class="line" data-startTime="572">line for line, </span><span class="line" data-startTime="574">it gets evaluated in the order </span><span class="line" data-startTime="574">that it is written out </span><span class="line" data-startTime="580">in the program, </span><span class="line" data-startTime="580">more or less. </span> <span class="line" data-startTime="582">And so </span><span class="line" data-startTime="582">statement to statement, </span><span class="line" data-startTime="584">your programs &mdash; they can change </span><span class="line" data-startTime="584">in ways that are surprising </span><span class="line" data-startTime="587">in other languages. </span></p>

<p><span class="line" data-startTime="588">Where you might otherwise </span><span class="line" data-startTime="588">have compile time exceptions, </span><span class="line" data-startTime="590">JavaScript just sort of </span><span class="line" data-startTime="590">merrily goes on </span><span class="line" data-startTime="592">and runs the next line. </span> <span class="line" data-startTime="593">So whenever we read </span><span class="line" data-startTime="593">some JavaScript code, </span><span class="line" data-startTime="596">it's important to think about </span><span class="line" data-startTime="596">it simply as running at the top </span><span class="line" data-startTime="599">and going to the bottom. </span> <span class="line" data-startTime="600">It's not really </span><span class="line" data-startTime="600">some big magical machine </span><span class="line" data-startTime="603">that's going to be out there </span><span class="line" data-startTime="603">doing something for you, </span><span class="line" data-startTime="605">and then it's going to start </span><span class="line" data-startTime="605">running your program. </span> <span class="line" data-startTime="607">It's just running </span><span class="line" data-startTime="607">top to bottom. </span> <span class="line" data-startTime="608">So when you evaluate </span><span class="line" data-startTime="608">JavaScript code, </span><span class="line" data-startTime="609">and you're trying to figure </span><span class="line" data-startTime="609">out what's going on, </span><span class="line" data-startTime="611">remember that the line </span><span class="line" data-startTime="611">before it may be the thing </span><span class="line" data-startTime="613">that caused the problem. </span> <span class="line" data-startTime="615">And JavaScript is functional </span><span class="line" data-startTime="615">and object-based. </span> <span class="line" data-startTime="618">It's really important </span><span class="line" data-startTime="618">to think of functions </span><span class="line" data-startTime="622">as first class in JavaScript. </span></p>

<p><span class="line" data-startTime="625">That means that they're </span><span class="line" data-startTime="625">not simply a pointer out </span><span class="line" data-startTime="627">in the world that you </span><span class="line" data-startTime="627">invoke against something. </span> <span class="line" data-startTime="630">They are actual objects. </span> <span class="line" data-startTime="632">I'm going to refer to them </span><span class="line" data-startTime="632">through this talk </span><span class="line" data-startTime="633">as function objects, </span><span class="line" data-startTime="634">because function objects are </span><span class="line" data-startTime="634">indeed objects that you can go </span><span class="line" data-startTime="637">and hang behavior off of. </span> <span class="line" data-startTime="638">But you don't hang behavior </span><span class="line" data-startTime="638">off of them </span><span class="line" data-startTime="639">by extending their public </span><span class="line" data-startTime="639">API area. </span> <span class="line" data-startTime="642">You don't say, </span><span class="line" data-startTime="642">"I've got a function object. </span> <span class="line" data-startTime="644">I'm going to add </span><span class="line" data-startTime="644">some new property to it." </span><span class="line" data-startTime="646">Most of the time, you do that </span><span class="line" data-startTime="646">by using functions as scopes. </span> <span class="line" data-startTime="649">The only way to create </span><span class="line" data-startTime="649">a new scope in JavaScript </span><span class="line" data-startTime="651">is to invoke a function. </span> <span class="line" data-startTime="653">When you invoke a function, </span><span class="line" data-startTime="653">it sort of creates a new scope. </span></p>

<p><span class="line" data-startTime="655">If statements, while statements, </span><span class="line" data-startTime="655">for-in statements &mdash; </span><span class="line" data-startTime="658">those things </span><span class="line" data-startTime="658">don't create scopes. </span> <span class="line" data-startTime="659">Only functions do, </span><span class="line" data-startTime="659">so we have this problem of </span><span class="line" data-startTime="663">how do we do beta hiding? </span><span class="line" data-startTime="664">Well, these scopes </span><span class="line" data-startTime="664">are really smart, </span><span class="line" data-startTime="665">because these scopes </span><span class="line" data-startTime="665">hold on to the variables </span><span class="line" data-startTime="667">that have been defined </span><span class="line" data-startTime="667">above them in another scope. </span> <span class="line" data-startTime="670">So what we've got here is </span><span class="line" data-startTime="670">a function called get counter, </span><span class="line" data-startTime="673">and get counter defines </span><span class="line" data-startTime="673">a local variable, I, </span><span class="line" data-startTime="675">and it returns </span><span class="line" data-startTime="675">another function, </span><span class="line" data-startTime="678">and that function references </span><span class="line" data-startTime="678">the variable I inside of it. </span> <span class="line" data-startTime="682">In other languages </span><span class="line" data-startTime="682">like C++ or Java, </span><span class="line" data-startTime="686">you really can't do </span><span class="line" data-startTime="686">anything here, </span><span class="line" data-startTime="688">because that variable I </span><span class="line" data-startTime="688">is going to go out of scope </span><span class="line" data-startTime="690">in the return function. </span></p>

<p><span class="line" data-startTime="691">We're allocating </span><span class="line" data-startTime="691">a new function here, </span><span class="line" data-startTime="692">but that inner function is </span><span class="line" data-startTime="692">going to hold on to I. </span> <span class="line" data-startTime="695">It actually allocates private </span><span class="line" data-startTime="695">memory to store a reference </span><span class="line" data-startTime="699">to I on the function object </span><span class="line" data-startTime="701">that's returned out of </span><span class="line" data-startTime="701">this statement here. </span> <span class="line" data-startTime="704">It, again, inverts </span><span class="line" data-startTime="704">the relationship. </span> <span class="line" data-startTime="705">It's not storage </span><span class="line" data-startTime="705">with behavior. </span> <span class="line" data-startTime="708">It's behavior </span><span class="line" data-startTime="708">that has hidden storage. </span> <span class="line" data-startTime="710">And so the way we do </span><span class="line" data-startTime="710">private variables </span><span class="line" data-startTime="712">and the way we do </span><span class="line" data-startTime="712">data hiding in JavaScript </span><span class="line" data-startTime="716">is to use this idea of a </span><span class="line" data-startTime="716">closure, something that encloses </span><span class="line" data-startTime="718">its lexical scope </span><span class="line" data-startTime="719">and holds on to variables </span><span class="line" data-startTime="721">as a way </span><span class="line" data-startTime="721">of passing behavior around. </span></p>

<p><span class="line" data-startTime="723">So we can call </span><span class="line" data-startTime="723">the get counter function. </span> <span class="line" data-startTime="725">It hands us back </span><span class="line" data-startTime="725">a function object. </span> <span class="line" data-startTime="727">We can call it multiple times, </span><span class="line" data-startTime="727">and that state isn't gone. </span> <span class="line" data-startTime="730">We can still see the variable I </span><span class="line" data-startTime="730">from inside the outside one, </span><span class="line" data-startTime="732">but it isn't referenceable. </span> <span class="line" data-startTime="734">We can't go and inspect some </span><span class="line" data-startTime="734">property on that function object </span><span class="line" data-startTime="737">and find out which variables </span><span class="line" data-startTime="737">it's holding references to. </span> <span class="line" data-startTime="740">It gets GC'd just like </span><span class="line" data-startTime="740">everything else in the language. </span> <span class="line" data-startTime="744">So these are </span><span class="line" data-startTime="744">first class functions. </span> <span class="line" data-startTime="745">These are functions </span><span class="line" data-startTime="745">that are things in the system. </span></p>

<p><span class="line" data-startTime="748">They're actually objects. </span> <span class="line" data-startTime="748">You can create them. </span> <span class="line" data-startTime="750">You can add properties to them. </span> <span class="line" data-startTime="750">It can enclose scope. </span> <span class="line" data-startTime="753">They're not simply inert </span><span class="line" data-startTime="753">bodies of code that get run. </span> <span class="line" data-startTime="757">They're participants </span><span class="line" data-startTime="757">in the object model. </span> <span class="line" data-startTime="759">They're participants </span><span class="line" data-startTime="759">in the storage system. </span> <span class="line" data-startTime="762">You can use them &mdash; I know </span><span class="line" data-startTime="762">the fundamental concept </span><span class="line" data-startTime="764">that underpins </span><span class="line" data-startTime="764">a lot of the patterns </span><span class="line" data-startTime="766">that we're going to see later. </span> <span class="line" data-startTime="768">So these functions </span><span class="line" data-startTime="768">work together </span><span class="line" data-startTime="770">with a lot of other </span><span class="line" data-startTime="770">sort of functional ideas </span><span class="line" data-startTime="772">about how a program language </span><span class="line" data-startTime="772">can be structured. </span> <span class="line" data-startTime="775">In JavaScript, we have a filter, </span><span class="line" data-startTime="775">map, reduce, </span><span class="line" data-startTime="777">and for each method </span><span class="line" data-startTime="777">on the array prototype, </span><span class="line" data-startTime="780">which means that every array </span><span class="line" data-startTime="780">in the system has these methods, </span><span class="line" data-startTime="782">which means that instead </span><span class="line" data-startTime="782">of having an external iterator, </span><span class="line" data-startTime="785">you have </span><span class="line" data-startTime="785">an internal iterator. </span></p>

<p><span class="line" data-startTime="786">You have something </span><span class="line" data-startTime="786">that can call a function </span><span class="line" data-startTime="788">across some set of arguments, </span><span class="line" data-startTime="790">and so you wind up </span><span class="line" data-startTime="790">creating a stack of stuff </span><span class="line" data-startTime="792">that you'd like to do </span><span class="line" data-startTime="792">in terms of behavior. </span> <span class="line" data-startTime="794">Instead of passing </span><span class="line" data-startTime="794">data structures around </span><span class="line" data-startTime="796">and around and around, you pass </span><span class="line" data-startTime="796">in arguments to functions, </span><span class="line" data-startTime="798">and that sort of </span><span class="line" data-startTime="798">unwinds the thing </span><span class="line" data-startTime="800">that you were </span><span class="line" data-startTime="800">trying to get done. </span> <span class="line" data-startTime="801">You express </span><span class="line" data-startTime="801">your program's intent </span><span class="line" data-startTime="803">in the form of </span><span class="line" data-startTime="803">nested functions </span><span class="line" data-startTime="805">that are going to </span><span class="line" data-startTime="805">unwind to some result, </span><span class="line" data-startTime="808">not linear code </span><span class="line" data-startTime="808">that's going to be executed </span><span class="line" data-startTime="811">by passing in </span><span class="line" data-startTime="811">the same data structures </span><span class="line" data-startTime="813">over and over </span><span class="line" data-startTime="813">and over again. </span> <span class="line" data-startTime="814">So these sorts of things </span><span class="line" data-startTime="814">are not hard and fast rules </span><span class="line" data-startTime="819">about any programming </span><span class="line" data-startTime="819">language. </span></p>

<p><span class="line" data-startTime="820">Like, you can have </span><span class="line" data-startTime="820">an endless debate about </span><span class="line" data-startTime="822">what makes something a </span><span class="line" data-startTime="822">functional programming language. </span> <span class="line" data-startTime="824">Can it have side effects? </span><span class="line" data-startTime="825">Can it not have side effects? </span><span class="line" data-startTime="825">You know &mdash; </span><span class="line" data-startTime="828">How completely does it </span><span class="line" data-startTime="828">support some particular </span><span class="line" data-startTime="831">set of macro languages, </span><span class="line" data-startTime="831">or hygienic macros, </span><span class="line" data-startTime="833">or whatever it is? </span><span class="line" data-startTime="834">Many people define functional </span><span class="line" data-startTime="834">languages differently, </span><span class="line" data-startTime="837">but for the intents </span><span class="line" data-startTime="837">and purposes here, </span><span class="line" data-startTime="839">we're just going to say </span><span class="line" data-startTime="839">it has closures, </span><span class="line" data-startTime="840">first class functions, </span><span class="line" data-startTime="841">and some concept of </span><span class="line" data-startTime="841">using those sorts of things </span><span class="line" data-startTime="844">to compose behavior </span><span class="line" data-startTime="844">nicely together. </span> <span class="line" data-startTime="848">So another important thing </span><span class="line" data-startTime="848">to remember about JavaScript </span><span class="line" data-startTime="850">is that everything </span><span class="line" data-startTime="850">is just an object. </span> <span class="line" data-startTime="852">So there aren't a lot of </span><span class="line" data-startTime="852">key concepts in JavaScript, </span><span class="line" data-startTime="855">and so you can think of it as </span><span class="line" data-startTime="855">sort of a lazy language design. </span></p>

<p><span class="line" data-startTime="858">It doesn't really have </span><span class="line" data-startTime="858">a lot of specialized, </span><span class="line" data-startTime="860">compartmentalized things </span><span class="line" data-startTime="862">to hold on </span><span class="line" data-startTime="862">to different concepts </span><span class="line" data-startTime="863">that you might encounter. </span> <span class="line" data-startTime="864">Instead, it just relies </span><span class="line" data-startTime="864">on the same systems </span><span class="line" data-startTime="865">over and over again. </span> <span class="line" data-startTime="867">One of those systems </span><span class="line" data-startTime="867">is this small type system, </span><span class="line" data-startTime="871">where objects are objects, </span><span class="line" data-startTime="871">that first object literal there. </span> <span class="line" data-startTime="875">It's an instance of object. </span> <span class="line" data-startTime="875">Arrays are objects, </span><span class="line" data-startTime="877">which means that arrays are </span><span class="line" data-startTime="877">instances of objects, too. </span></p>

<p><span class="line" data-startTime="879">And functions </span><span class="line" data-startTime="879">are also objects. </span> <span class="line" data-startTime="882">In this case, </span><span class="line" data-startTime="882">I've got a paren here, </span><span class="line" data-startTime="885">which is going to create </span><span class="line" data-startTime="885">a new expression. </span> <span class="line" data-startTime="887">I've got a function, </span><span class="line" data-startTime="887">which I define inside of here. </span> <span class="line" data-startTime="889">It doesn't have a name. </span> <span class="line" data-startTime="889">It's an anonymous function. </span> <span class="line" data-startTime="890">You can have anonymous </span><span class="line" data-startTime="890">functions in JavaScript. </span> <span class="line" data-startTime="893">And the result </span><span class="line" data-startTime="893">of this expression </span><span class="line" data-startTime="894">is just going to be </span><span class="line" data-startTime="894">that function object. </span> <span class="line" data-startTime="897">And the function object also is </span><span class="line" data-startTime="897">an instance of the object type, </span><span class="line" data-startTime="901">which means that nearly </span><span class="line" data-startTime="901">everything in the system </span><span class="line" data-startTime="903">that you encounter </span><span class="line" data-startTime="903">is going to be an object. </span> <span class="line" data-startTime="905">This is really powerful, </span><span class="line" data-startTime="905">because it means, </span><span class="line" data-startTime="906">as we'll see later, </span><span class="line" data-startTime="907">when we compose things, </span><span class="line" data-startTime="907">and everything is mutable, </span><span class="line" data-startTime="910">we can start </span><span class="line" data-startTime="910">to change the behavior </span><span class="line" data-startTime="911">of large parts of the system </span><span class="line" data-startTime="911">all at once. </span> <span class="line" data-startTime="913">And every object in the system </span><span class="line" data-startTime="913">acts more or less like a map. </span></p>

<p><span class="line" data-startTime="916">There's no separate </span><span class="line" data-startTime="916">map type in JavaScript. </span> <span class="line" data-startTime="918">So if you want a map, </span><span class="line" data-startTime="918">just take an object. </span> <span class="line" data-startTime="920">This is where &mdash; </span><span class="line" data-startTime="920">sort of where JSON comes from, </span><span class="line" data-startTime="922">this object literal syntax </span><span class="line" data-startTime="922">that we've got here, </span><span class="line" data-startTime="924">where we're </span><span class="line" data-startTime="924">defining an object </span><span class="line" data-startTime="926">with a single property </span><span class="line" data-startTime="926">and a single value. </span> <span class="line" data-startTime="928">It allows us to de-reference </span><span class="line" data-startTime="928">properties the same way. </span> <span class="line" data-startTime="930">So the data operator does </span><span class="line" data-startTime="930">almost exactly the same thing </span><span class="line" data-startTime="932">as this map operator. </span> <span class="line" data-startTime="934">It just finds a property </span><span class="line" data-startTime="934">by its name </span><span class="line" data-startTime="936">and returns it out </span><span class="line" data-startTime="936">the other side. </span> <span class="line" data-startTime="937">So in JavaScript, </span><span class="line" data-startTime="937">everything is an object. </span> <span class="line" data-startTime="940">Objects operate like maps. </span> <span class="line" data-startTime="940">That's pretty cool. </span></p>

<p><span class="line" data-startTime="943">Arrays do exactly </span><span class="line" data-startTime="943">the same thing. </span> <span class="line" data-startTime="944">And arrays are very confusing </span><span class="line" data-startTime="944">when you start out working </span><span class="line" data-startTime="947">in JavaScript, </span><span class="line" data-startTime="948">because you think array </span><span class="line" data-startTime="948">is some separate thing </span><span class="line" data-startTime="951">over on the side. </span> <span class="line" data-startTime="951">Arrays are not objects. </span> <span class="line" data-startTime="953">Arrays are this linear bag </span><span class="line" data-startTime="953">of memory </span><span class="line" data-startTime="955">that you're going to access </span><span class="line" data-startTime="955">with an integer someplace. </span> <span class="line" data-startTime="958">And as a result of that, </span><span class="line" data-startTime="960">you're not going to be surprised </span><span class="line" data-startTime="960">by some other identity. </span> <span class="line" data-startTime="964">But you are, because </span><span class="line" data-startTime="964">very often what happens is </span><span class="line" data-startTime="966">you go and extend an object. </span> <span class="line" data-startTime="966">You add a new property to it. </span></p>

<p><span class="line" data-startTime="968">In this case, we're going to add </span><span class="line" data-startTime="968">this other greeting property </span><span class="line" data-startTime="971">to an object dynamically, and &mdash; </span><span class="line" data-startTime="971">or to an array dynamically. </span> <span class="line" data-startTime="975">And as a result, </span><span class="line" data-startTime="975">when we go into a for-in loop, </span><span class="line" data-startTime="978">this is now an innumerable </span><span class="line" data-startTime="978">property on this array. </span> <span class="line" data-startTime="982">We might get surprised, because </span><span class="line" data-startTime="982">we see these other things </span><span class="line" data-startTime="984">showing up in our object. </span> <span class="line" data-startTime="987">Well, that's weird. </span> <span class="line" data-startTime="989">I mean, we iterated </span><span class="line" data-startTime="989">over the public properties. </span> <span class="line" data-startTime="992">Isn't 0 just </span><span class="line" data-startTime="992">an integer index thing? </span><span class="line" data-startTime="994">It's not a public </span><span class="line" data-startTime="994">property, right? </span><span class="line" data-startTime="996">Well, remember that </span><span class="line" data-startTime="996">everything in JavaScript </span><span class="line" data-startTime="998">just sort of falls back </span><span class="line" data-startTime="998">on these core concepts. </span></p>

<p><span class="line" data-startTime="1000">And if you think about </span><span class="line" data-startTime="1000">the array integer indexing </span><span class="line" data-startTime="1004">working exactly the same way </span><span class="line" data-startTime="1004">that property indexing does, </span><span class="line" data-startTime="1007">it all makes sense. </span> <span class="line" data-startTime="1008">Yeah, </span><span class="line" data-startTime="1008">in the implementation, </span><span class="line" data-startTime="1010">there might be some special </span><span class="line" data-startTime="1010">machinery to make arrays </span><span class="line" data-startTime="1012">efficient </span><span class="line" data-startTime="1012">or to pack them tightly, </span><span class="line" data-startTime="1013">so that you don't wind up </span><span class="line" data-startTime="1013">slowing things down </span><span class="line" data-startTime="1015">unnecessarily. </span> <span class="line" data-startTime="1017">But in the language semantics, </span><span class="line" data-startTime="1018">what happens here </span><span class="line" data-startTime="1018">when I say, </span><span class="line" data-startTime="1020">"Please give me item 0 </span><span class="line" data-startTime="1020">out of this list," </span><span class="line" data-startTime="1022">is that it turns </span><span class="line" data-startTime="1022">that 0 into a string, </span><span class="line" data-startTime="1025">and then does a map lookup. </span> <span class="line" data-startTime="1026">That's all it does. </span> <span class="line" data-startTime="1027">So the only magical thing </span><span class="line" data-startTime="1027">about arrays </span><span class="line" data-startTime="1029">versus any other kind of object </span><span class="line" data-startTime="1029">in the system </span><span class="line" data-startTime="1031">is that, </span><span class="line" data-startTime="1031">when I push onto an array </span><span class="line" data-startTime="1033">or I set the length property, </span><span class="line" data-startTime="1035">it actually affects </span><span class="line" data-startTime="1035">which properties are visible. </span></p>

<p><span class="line" data-startTime="1037">The length property is </span><span class="line" data-startTime="1037">the only thing in an array </span><span class="line" data-startTime="1039">that's actually magic. </span> <span class="line" data-startTime="1041">It has a little bit of syntax </span><span class="line" data-startTime="1041">for defining arrays naturally; </span><span class="line" data-startTime="1043">but other than that, </span><span class="line" data-startTime="1043">arrays are just objects. </span> <span class="line" data-startTime="1045">Things get turned into strings </span><span class="line" data-startTime="1045">and then de-referenced that way. </span> <span class="line" data-startTime="1048">The spec is pretty clear </span><span class="line" data-startTime="1048">about this. </span> <span class="line" data-startTime="1049">So JavaScript doesn't have </span><span class="line" data-startTime="1049">that many core concepts. </span> <span class="line" data-startTime="1053">And if you understand them, </span><span class="line" data-startTime="1053">you can understand </span><span class="line" data-startTime="1054">what's going on </span><span class="line" data-startTime="1054">in your system. </span> <span class="line" data-startTime="1056">So we've got mutable objects. </span> <span class="line" data-startTime="1056">We've got closures, </span><span class="line" data-startTime="1058">which are behavior </span><span class="line" data-startTime="1058">that carries data </span><span class="line" data-startTime="1060">and not data </span><span class="line" data-startTime="1060">that carries behavior. </span> <span class="line" data-startTime="1062">We've got mutable objects, </span><span class="line" data-startTime="1064">and we've got everything </span><span class="line" data-startTime="1064">being an object </span><span class="line" data-startTime="1066">and everything being an object </span><span class="line" data-startTime="1066">also being a map. </span> <span class="line" data-startTime="1069">Okay, that's not a lot </span><span class="line" data-startTime="1069">of concepts, so far, </span><span class="line" data-startTime="1071">for a programming language. </span> <span class="line" data-startTime="1072">And we can use these to build </span><span class="line" data-startTime="1072">some really powerful stuff. </span></p>

<p><span class="line" data-startTime="1076">So I mentioned mutability, </span><span class="line" data-startTime="1077">and I said </span><span class="line" data-startTime="1077">everything is mutable. </span> <span class="line" data-startTime="1079">Just a really quick example, </span><span class="line" data-startTime="1079">we can add new properties </span><span class="line" data-startTime="1081">at runtime to every object. </span> <span class="line" data-startTime="1083">Remember how I said that </span><span class="line" data-startTime="1083">JavaScript runs top to bottom? </span><span class="line" data-startTime="1086">When you're reading </span><span class="line" data-startTime="1086">a program like this, </span><span class="line" data-startTime="1088">it's not like my object type </span><span class="line" data-startTime="1088">somehow was extended </span><span class="line" data-startTime="1090">and, therefore, every object </span><span class="line" data-startTime="1090">of this type is going to have </span><span class="line" data-startTime="1092">one of these properties. </span> <span class="line" data-startTime="1093">I'm just adding a new property </span><span class="line" data-startTime="1093">to the object directly. </span> <span class="line" data-startTime="1097">So in this case, </span><span class="line" data-startTime="1097">object.item is being replaced, </span><span class="line" data-startTime="1101">and object.item2 </span><span class="line" data-startTime="1101">is simply being added. </span> <span class="line" data-startTime="1104">These are exactly </span><span class="line" data-startTime="1104">the same operations, </span><span class="line" data-startTime="1106">as far as JavaScript </span><span class="line" data-startTime="1106">is concerned. </span> <span class="line" data-startTime="1108">The dot operator </span><span class="line" data-startTime="1108">just finds you the object </span><span class="line" data-startTime="1110">and then assigns to it. </span></p>

<p><span class="line" data-startTime="1110">That's all it's doing. </span> <span class="line" data-startTime="1112">Every object in the system </span><span class="line" data-startTime="1112">is extensible. </span> <span class="line" data-startTime="1114">Most of them are mutable. </span> <span class="line" data-startTime="1116">Most of the values are mutable, </span><span class="line" data-startTime="1116">and we run top to bottom. </span> <span class="line" data-startTime="1120">So that means </span><span class="line" data-startTime="1120">that when I come down here, </span><span class="line" data-startTime="1123">and I delete a property </span><span class="line" data-startTime="1123">off of the object, </span><span class="line" data-startTime="1124">the very next line </span><span class="line" data-startTime="1124">isn't going to see it. </span> <span class="line" data-startTime="1126">But if I had said </span><span class="line" data-startTime="1126">console.log(obj.item) </span><span class="line" data-startTime="1128">one line above, </span><span class="line" data-startTime="1128">it would see it there. </span> <span class="line" data-startTime="1130">This is not </span><span class="line" data-startTime="1130">a compile time thing. </span> <span class="line" data-startTime="1131">It's just doing what you said, </span><span class="line" data-startTime="1131">line after line, </span><span class="line" data-startTime="1135">statement after statement, </span><span class="line" data-startTime="1135">expression after expression. </span></p>

<p><span class="line" data-startTime="1137">It seems really simple. </span> <span class="line" data-startTime="1139">It seems pretty obvious, but </span><span class="line" data-startTime="1139">very few programming languages </span><span class="line" data-startTime="1141">that you might be using </span><span class="line" data-startTime="1141">in a compiled environment </span><span class="line" data-startTime="1143">work this way. </span> <span class="line" data-startTime="1145">So I mentioned that closures </span><span class="line" data-startTime="1145">are the other side of classes, </span><span class="line" data-startTime="1147">whereas classes </span><span class="line" data-startTime="1147">are sort of a nice way </span><span class="line" data-startTime="1148">of saying, </span><span class="line" data-startTime="1148">"Here's a structure of data. </span> <span class="line" data-startTime="1150">"I'm going to associate </span><span class="line" data-startTime="1150">some properties with them, </span><span class="line" data-startTime="1152">and maybe they'll have </span><span class="line" data-startTime="1152">some type behavior as well." </span><span class="line" data-startTime="1155">In this case, </span><span class="line" data-startTime="1155">we're going to create something </span><span class="line" data-startTime="1158">that we would call a class </span><span class="line" data-startTime="1158">in JavaScript. </span> <span class="line" data-startTime="1159">We know it's a class, </span><span class="line" data-startTime="1161">because it's got </span><span class="line" data-startTime="1161">an uppercase B for the name. </span></p>

<p><span class="line" data-startTime="1163">This is not a language </span><span class="line" data-startTime="1163">enforced semantic. </span> <span class="line" data-startTime="1164">JavaScript doesn't necessarily </span><span class="line" data-startTime="1164">have classes today. </span> <span class="line" data-startTime="1168">This is just a convention. </span> <span class="line" data-startTime="1168">And as we'll see, conventions </span><span class="line" data-startTime="1170">figure large in day-to-day </span><span class="line" data-startTime="1170">JavaScript programming. </span> <span class="line" data-startTime="1174">So remember </span><span class="line" data-startTime="1174">every object is mutable. </span> <span class="line" data-startTime="1175">So we're going to create </span><span class="line" data-startTime="1175">down here, </span><span class="line" data-startTime="1178">we're going to create a new </span><span class="line" data-startTime="1178">instance of our behavior class. </span> <span class="line" data-startTime="1182">We're going to extend </span><span class="line" data-startTime="1182">the local object, this dot, </span><span class="line" data-startTime="1186">with the variable that </span><span class="line" data-startTime="1186">was passed in the configuration, </span><span class="line" data-startTime="1188">and then we're going to </span><span class="line" data-startTime="1188">extend the object again </span><span class="line" data-startTime="1190">with a function called do it. </span></p>

<p><span class="line" data-startTime="1192">In this case, </span><span class="line" data-startTime="1193">when I call the do it method </span><span class="line" data-startTime="1193">of my behavior instance, </span><span class="line" data-startTime="1196">it's then going to </span><span class="line" data-startTime="1196">run through, </span><span class="line" data-startTime="1197">and it's going to say </span><span class="line" data-startTime="1197">this.config </span><span class="line" data-startTime="1199">and go grab some flag </span><span class="line" data-startTime="1199">off the configuration. </span> <span class="line" data-startTime="1201">Okay, so we stored some property </span><span class="line" data-startTime="1201">and some behavior on the object. </span> <span class="line" data-startTime="1205">This looks a lot like </span><span class="line" data-startTime="1205">what you might expect out </span><span class="line" data-startTime="1206">of another </span><span class="line" data-startTime="1206">object-oriented language. </span> <span class="line" data-startTime="1208">The declaration syntax </span><span class="line" data-startTime="1208">is a little bit funky, </span><span class="line" data-startTime="1210">but you sort of </span><span class="line" data-startTime="1210">understand it, right? </span><span class="line" data-startTime="1211">I've added a method. </span> <span class="line" data-startTime="1211">I've added some data. </span> <span class="line" data-startTime="1214">The data operates on </span><span class="line" data-startTime="1214">the local objects method. </span></p>

<p><span class="line" data-startTime="1216">Sweet &mdash; </span><span class="line" data-startTime="1216">or other way around. </span> <span class="line" data-startTime="1218">Strike that, reverse it. </span> <span class="line" data-startTime="1220">New behavior, passing a flag, </span><span class="line" data-startTime="1220">then I call it false. </span> <span class="line" data-startTime="1223">I get a behavior object, </span><span class="line" data-startTime="1224">and now I can call a method </span><span class="line" data-startTime="1224">that uses that behavior, right? </span><span class="line" data-startTime="1227">So it's going to look </span><span class="line" data-startTime="1227">at the local object, this, </span><span class="line" data-startTime="1232">for the configuration, </span><span class="line" data-startTime="1232">and it may change its behavior </span><span class="line" data-startTime="1235">based on that configuration by </span><span class="line" data-startTime="1235">passing some other value to it. </span> <span class="line" data-startTime="1238">Make sense? </span><span class="line" data-startTime="1238">Cool? All right. </span> <span class="line" data-startTime="1241">So this is maybe a little bit </span><span class="line" data-startTime="1241">more idiomatic for JavaScript. </span> <span class="line" data-startTime="1244">It's the flip side of that. </span> <span class="line" data-startTime="1246">Instead of creating a class </span><span class="line" data-startTime="1246">that I created an instance of, </span><span class="line" data-startTime="1249">I'm going to </span><span class="line" data-startTime="1249">create a generator </span><span class="line" data-startTime="1251">that's going to pass me </span><span class="line" data-startTime="1251">back a function object, </span><span class="line" data-startTime="1254">which is going to hold </span><span class="line" data-startTime="1254">on to the state. </span></p>

<p><span class="line" data-startTime="1255">I'm not going to go </span><span class="line" data-startTime="1255">create a class for it. </span> <span class="line" data-startTime="1257">I'm going to create </span><span class="line" data-startTime="1257">a behavior generator. </span> <span class="line" data-startTime="1259">You can think of them </span><span class="line" data-startTime="1259">doing the same thing, </span><span class="line" data-startTime="1261">just the flip side of it. </span> <span class="line" data-startTime="1262">So instead of saying </span><span class="line" data-startTime="1262">new behavior, </span><span class="line" data-startTime="1264">I'm going to say </span><span class="line" data-startTime="1264">bind me a behavior, </span><span class="line" data-startTime="1267">which when I call this, </span><span class="line" data-startTime="1269">note the lack of </span><span class="line" data-startTime="1269">the new keyword here, </span><span class="line" data-startTime="1271">I'm going to pass </span><span class="line" data-startTime="1271">into configuration. </span> <span class="line" data-startTime="1273">Like we saw earlier, </span><span class="line" data-startTime="1274">I'm going to pass back out </span><span class="line" data-startTime="1274">a function object. </span> <span class="line" data-startTime="1276">This is a new </span><span class="line" data-startTime="1276">function object. </span> <span class="line" data-startTime="1277">Every time I call this method, </span><span class="line" data-startTime="1277">bind behavior, </span><span class="line" data-startTime="1279">it's going to pass me back out </span><span class="line" data-startTime="1279">a new function object. </span> <span class="line" data-startTime="1282">So I'm actually having a new </span><span class="line" data-startTime="1282">function object allocated here, </span><span class="line" data-startTime="1286">and that function object </span><span class="line" data-startTime="1286">is going to have, again, </span><span class="line" data-startTime="1288">some private storage, </span><span class="line" data-startTime="1288">and that private storage is </span><span class="line" data-startTime="1290">going to hold on to </span><span class="line" data-startTime="1290">the config variable </span><span class="line" data-startTime="1292">that was passed into </span><span class="line" data-startTime="1292">the outer function, right? </span><span class="line" data-startTime="1294">Because each one of these </span><span class="line" data-startTime="1294">is a new scope, </span><span class="line" data-startTime="1296">and because scopes </span><span class="line" data-startTime="1296">can hold on to the variables </span><span class="line" data-startTime="1298">that they were able to see </span><span class="line" data-startTime="1298">when they were defined, </span><span class="line" data-startTime="1301">the function object </span><span class="line" data-startTime="1301">that gets passed out of here now </span><span class="line" data-startTime="1303">has a reference. </span></p>

<p><span class="line" data-startTime="1304">It's holding on to </span><span class="line" data-startTime="1304">that local state. </span> <span class="line" data-startTime="1307">In this case, it's going to be </span><span class="line" data-startTime="1307">the object that was passed in. </span> <span class="line" data-startTime="1310">This might go out of scope here </span><span class="line" data-startTime="1310">in every other place </span><span class="line" data-startTime="1312">in my program. </span> <span class="line" data-startTime="1313">I may not be able to get </span><span class="line" data-startTime="1313">a reference back to this object, </span><span class="line" data-startTime="1315">but my behavior, the B variable </span><span class="line" data-startTime="1315">that was passed back out, </span><span class="line" data-startTime="1320">will have access to that data </span><span class="line" data-startTime="1322">because it's being held on to </span><span class="line" data-startTime="1322">internally. </span> <span class="line" data-startTime="1323">It's not going to be </span><span class="line" data-startTime="1323">garbage collected out </span><span class="line" data-startTime="1324">from underneath me. </span> <span class="line" data-startTime="1326">Closures are the way to invert </span><span class="line" data-startTime="1326">the way you think </span><span class="line" data-startTime="1328">about your programs. </span> <span class="line" data-startTime="1329">You don't create classes </span><span class="line" data-startTime="1329">that are state with data, </span><span class="line" data-startTime="1332">state with behavior attached. </span> <span class="line" data-startTime="1334">You create behavior that holds </span><span class="line" data-startTime="1334">on to the state that it needs, </span><span class="line" data-startTime="1337">and you can pass </span><span class="line" data-startTime="1337">that behavior around, </span><span class="line" data-startTime="1338">because functions </span><span class="line" data-startTime="1338">are first class. </span></p>

<p><span class="line" data-startTime="1342">So I mentioned earlier that </span><span class="line" data-startTime="1342">the last sort of big conceit </span><span class="line" data-startTime="1345">in the language is that we </span><span class="line" data-startTime="1345">don't have a way of saying, </span><span class="line" data-startTime="1348">hey, here's a class of stuff. </span> <span class="line" data-startTime="1350">Instead we say, </span><span class="line" data-startTime="1350">if you don't find it here, </span><span class="line" data-startTime="1353">don't look at my like </span><span class="line" data-startTime="1353">chain of class inheritance. </span> <span class="line" data-startTime="1360">Instead, just go look </span><span class="line" data-startTime="1360">at that other object. </span> <span class="line" data-startTime="1362">Remember how I said </span><span class="line" data-startTime="1362">over and over again </span><span class="line" data-startTime="1364">that JavaScript </span><span class="line" data-startTime="1364">just reads top to bottom? </span><span class="line" data-startTime="1367">I get some code. </span> <span class="line" data-startTime="1368">The thing executes </span><span class="line" data-startTime="1368">front to back, top to bottom. </span> <span class="line" data-startTime="1372">We're going to see </span><span class="line" data-startTime="1372">the exact same thing here, </span><span class="line" data-startTime="1374">because what happens every time </span><span class="line" data-startTime="1374">you call the .operator </span><span class="line" data-startTime="1376">is exactly the same thing. </span></p>

<p><span class="line" data-startTime="1377">I'm going to create </span><span class="line" data-startTime="1377">some variable </span><span class="line" data-startTime="1379">that I'm going </span><span class="line" data-startTime="1379">to call my delegate. </span> <span class="line" data-startTime="1381">It's an object. </span> <span class="line" data-startTime="1381">It's got a single property. </span> <span class="line" data-startTime="1383">Okay, cool. </span> <span class="line" data-startTime="1384">There's a new ECMAScript 5 </span><span class="line" data-startTime="1384">method called object.create. </span> <span class="line" data-startTime="1388">There's other ways to do this </span><span class="line" data-startTime="1388">in older versions, </span><span class="line" data-startTime="1389">but they're a little bit </span><span class="line" data-startTime="1389">mind bending, </span><span class="line" data-startTime="1390">and we won't go over them. </span> <span class="line" data-startTime="1391">But object.create &mdash; </span><span class="line" data-startTime="1391">the easiest way to think of it </span><span class="line" data-startTime="1393">is that it creates a new object </span><span class="line" data-startTime="1393">which will look at the object </span><span class="line" data-startTime="1397">that you pass </span><span class="line" data-startTime="1397">as its first property </span><span class="line" data-startTime="1399">if you don't find a value </span><span class="line" data-startTime="1399">with this same property name </span><span class="line" data-startTime="1403">on that object. </span></p>

<p><span class="line" data-startTime="1404">So let's say &mdash; and in this case, </span><span class="line" data-startTime="1404">I'm going to create object 2 </span><span class="line" data-startTime="1409">and have my delegate </span><span class="line" data-startTime="1409">be the delegate. </span> <span class="line" data-startTime="1411">And so when I reference </span><span class="line" data-startTime="1411">a property out of object 2, </span><span class="line" data-startTime="1414">it's going to go look it </span><span class="line" data-startTime="1414">up dynamically, </span><span class="line" data-startTime="1416">and if it doesn't find it </span><span class="line" data-startTime="1416">on object 2 directly, </span><span class="line" data-startTime="1419">it's going to go look it up </span><span class="line" data-startTime="1419">off of the delegated 2 object. </span> <span class="line" data-startTime="1421">It's going to go, </span><span class="line" data-startTime="1421">dynamically go </span><span class="line" data-startTime="1423">and try and find it </span><span class="line" data-startTime="1423">over there. </span> <span class="line" data-startTime="1425">Well, we created </span><span class="line" data-startTime="1425">another object. </span> <span class="line" data-startTime="1427">In this case, we're setting </span><span class="line" data-startTime="1427">a local property on that object, </span><span class="line" data-startTime="1432">whose name is item, </span><span class="line" data-startTime="1432">whose value is value. </span> <span class="line" data-startTime="1434">And that means that </span><span class="line" data-startTime="1434">when I look it up at runtime </span><span class="line" data-startTime="1436">directly top to bottom, </span><span class="line" data-startTime="1436">left to right, </span><span class="line" data-startTime="1438">what I see is that </span><span class="line" data-startTime="1438">I don't get the value </span><span class="line" data-startTime="1441">that was set on my delegate. </span></p>

<p><span class="line" data-startTime="1442">I get the value that was </span><span class="line" data-startTime="1442">on the local object. </span> <span class="line" data-startTime="1443">The .operator doesn't fail </span><span class="line" data-startTime="1443">on the local lookup. </span> <span class="line" data-startTime="1446">It finds it on </span><span class="line" data-startTime="1446">the local object. </span> <span class="line" data-startTime="1447">And instead of looking up </span><span class="line" data-startTime="1447">the chain, it says, </span><span class="line" data-startTime="1449">ah, I'll just give you this </span><span class="line" data-startTime="1449">object's value right back. </span> <span class="line" data-startTime="1452">So JavaScript is </span><span class="line" data-startTime="1452">incredibly dynamic </span><span class="line" data-startTime="1454">when it comes even to looking up </span><span class="line" data-startTime="1454">properties on objects. </span> <span class="line" data-startTime="1457">There's not some fixed list </span><span class="line" data-startTime="1457">of stuff that you can do. </span> <span class="line" data-startTime="1459">You can change </span><span class="line" data-startTime="1459">the delegation, </span><span class="line" data-startTime="1460">and you can change </span><span class="line" data-startTime="1460">the properties </span><span class="line" data-startTime="1462">that are available </span><span class="line" data-startTime="1462">on every object </span><span class="line" data-startTime="1463">that you're delegating to, </span><span class="line" data-startTime="1463">or your local object, </span><span class="line" data-startTime="1466">and that changes what happens </span><span class="line" data-startTime="1466">when you go </span><span class="line" data-startTime="1467">and look stuff up </span><span class="line" data-startTime="1467">at the very next line. </span> <span class="line" data-startTime="1470">So in this case, </span><span class="line" data-startTime="1471">if I go and I change the value </span><span class="line" data-startTime="1471">on the delegate, </span><span class="line" data-startTime="1474">I change the item value </span><span class="line" data-startTime="1474">on the delegate, </span><span class="line" data-startTime="1475">remember that object 2 </span><span class="line" data-startTime="1475">doesn't have a local property </span><span class="line" data-startTime="1478">called item. </span></p>

<p><span class="line" data-startTime="1479">If I fail on that lookup </span><span class="line" data-startTime="1479">on object 2, </span><span class="line" data-startTime="1481">it just goes and says, ah, okay, </span><span class="line" data-startTime="1481">let's go consult my delegate, </span><span class="line" data-startTime="1484">and that delegate is now </span><span class="line" data-startTime="1484">going to have the new value. </span> <span class="line" data-startTime="1486">So the new value has </span><span class="line" data-startTime="1486">been shadowed all the way </span><span class="line" data-startTime="1488">through to everything else </span><span class="line" data-startTime="1488">in the system </span><span class="line" data-startTime="1489">that is delegating </span><span class="line" data-startTime="1489">to that object. </span> <span class="line" data-startTime="1491">This is incredibly </span><span class="line" data-startTime="1491">powerful. </span> <span class="line" data-startTime="1493">The dynamic nature of </span><span class="line" data-startTime="1493">JavaScript means that </span><span class="line" data-startTime="1495">because it reads </span><span class="line" data-startTime="1495">top to bottom, </span><span class="line" data-startTime="1496">because almost everything </span><span class="line" data-startTime="1496">is mutable, </span><span class="line" data-startTime="1498">and because I can delegate </span><span class="line" data-startTime="1498">to most other objects </span><span class="line" data-startTime="1500">when I create something, </span><span class="line" data-startTime="1501">I wind up in a place where </span><span class="line" data-startTime="1501">I can create brand-new behavior </span><span class="line" data-startTime="1505">at runtime. </span> <span class="line" data-startTime="1506">I can compose things on the next </span><span class="line" data-startTime="1506">line that didn't exist before, </span><span class="line" data-startTime="1509">or I can change </span><span class="line" data-startTime="1509">the behavior of other objects </span><span class="line" data-startTime="1510">in the system, </span><span class="line" data-startTime="1511">based on what </span><span class="line" data-startTime="1511">they're delegating to. </span> <span class="line" data-startTime="1513">This turns out to be </span><span class="line" data-startTime="1513">a great way </span><span class="line" data-startTime="1515">to go build up </span><span class="line" data-startTime="1515">a lot of the constructs </span><span class="line" data-startTime="1517">that we get in other languages </span><span class="line" data-startTime="1517">for ourselves, </span><span class="line" data-startTime="1518">because JavaScript may not </span><span class="line" data-startTime="1518">give them to us naturally. </span></p>

<p><span class="line" data-startTime="1521">This power is the sort of thing </span><span class="line" data-startTime="1521">that really drew me </span><span class="line" data-startTime="1524">to JavaScript </span><span class="line" data-startTime="1524">as a young programmer. </span> <span class="line" data-startTime="1526">I didn't really understand </span><span class="line" data-startTime="1526">what I was dealing with. </span> <span class="line" data-startTime="1528">I remember I had a friend </span><span class="line" data-startTime="1528">who told me, </span><span class="line" data-startTime="1531">after I'd written some article </span><span class="line" data-startTime="1531">about how to do </span><span class="line" data-startTime="1534">signals and slots, </span><span class="line" data-startTime="1534">some sort of aspect-oriented </span><span class="line" data-startTime="1536">event style thing, </span><span class="line" data-startTime="1536">he's like, </span><span class="line" data-startTime="1538">"Well, why didn't you just use </span><span class="line" data-startTime="1538">a closure for that?" </span><span class="line" data-startTime="1540">And it took me a long time, </span><span class="line" data-startTime="1541">probably six months </span><span class="line" data-startTime="1541">or more after that, </span><span class="line" data-startTime="1543">to sort of really understand </span><span class="line" data-startTime="1543">what it was </span><span class="line" data-startTime="1545">that he meant when he said, </span><span class="line" data-startTime="1545">"Just use a closure for that." </span><span class="line" data-startTime="1547">I didn't understand </span><span class="line" data-startTime="1547">that you could hide data </span><span class="line" data-startTime="1548">inside of functions. </span></p>

<p><span class="line" data-startTime="1549">I didn't understand </span><span class="line" data-startTime="1549">that JavaScript sort of </span><span class="line" data-startTime="1551">ran top to bottom. </span> <span class="line" data-startTime="1553">But these core concepts </span><span class="line" data-startTime="1553">allow you to create </span><span class="line" data-startTime="1555">all sorts of </span><span class="line" data-startTime="1555">really powerful stuff, </span><span class="line" data-startTime="1559">assuming we understand what </span><span class="line" data-startTime="1559">happens with the word "this." </span><span class="line" data-startTime="1562">So the word this </span><span class="line" data-startTime="1562">is really special. </span> <span class="line" data-startTime="1564">In order &mdash; Because we don't have </span><span class="line" data-startTime="1564">classes that wire up </span><span class="line" data-startTime="1566">this inheritance hierarchy, </span><span class="line" data-startTime="1567">and because we're always </span><span class="line" data-startTime="1567">delegating at runtime, right, </span><span class="line" data-startTime="1569">every .operator sort of </span><span class="line" data-startTime="1569">does the dynamic lookup </span><span class="line" data-startTime="1573">on the local object &mdash; </span><span class="line" data-startTime="1574">looks at its delegate, </span><span class="line" data-startTime="1574">looks at its delegates. </span></p>

<p><span class="line" data-startTime="1576">The this object </span><span class="line" data-startTime="1576">is a way of saying, </span><span class="line" data-startTime="1578">okay, whatever scope I'm in, </span><span class="line" data-startTime="1581">execute the next lookup </span><span class="line" data-startTime="1581">against the local object, </span><span class="line" data-startTime="1586">which means that the this </span><span class="line" data-startTime="1586">keyword in any function </span><span class="line" data-startTime="1589">isn't pointing </span><span class="line" data-startTime="1589">at some fixed object. </span> <span class="line" data-startTime="1591">It's not fixed </span><span class="line" data-startTime="1591">when I necessarily say, </span><span class="line" data-startTime="1594">you know, create me an object. </span> <span class="line" data-startTime="1594">It's promiscuous. </span> <span class="line" data-startTime="1596">The this keyword points </span><span class="line" data-startTime="1596">at whatever object my function </span><span class="line" data-startTime="1599">is being called through. </span> <span class="line" data-startTime="1600">Right, remember function </span><span class="line" data-startTime="1600">objects are first class? </span><span class="line" data-startTime="1602">They don't actually sort of </span><span class="line" data-startTime="1602">carry around relationships </span><span class="line" data-startTime="1606">to their class or the thing </span><span class="line" data-startTime="1606">that they were defined in. </span> <span class="line" data-startTime="1608">They hold their own data. </span></p>

<p><span class="line" data-startTime="1610">So the this keyword is </span><span class="line" data-startTime="1610">a nice little syntactic out </span><span class="line" data-startTime="1612">which lets you say, okay, </span><span class="line" data-startTime="1612">whenever I look up a property, </span><span class="line" data-startTime="1618">which happens to be </span><span class="line" data-startTime="1618">a function, </span><span class="line" data-startTime="1619">and I call it, the .operator </span><span class="line" data-startTime="1619">for method calls says </span><span class="line" data-startTime="1624">don't just return it. </span> <span class="line" data-startTime="1626">But if I evaluate it directly, </span><span class="line" data-startTime="1626">use the .call property </span><span class="line" data-startTime="1630">of the function object </span><span class="line" data-startTime="1631">that's returned and call it </span><span class="line" data-startTime="1631">in the scope of the object </span><span class="line" data-startTime="1634">on the left hand side </span><span class="line" data-startTime="1634">of the .operator. </span> <span class="line" data-startTime="1637">I know this is a little bit </span><span class="line" data-startTime="1637">maybe tricky, </span><span class="line" data-startTime="1638">but the easiest way to think </span><span class="line" data-startTime="1638">about this is that in order to </span><span class="line" data-startTime="1641">wire up this behavior </span><span class="line" data-startTime="1641">correctly, </span><span class="line" data-startTime="1643">so that it sort of does what you </span><span class="line" data-startTime="1643">expect out of other languages, </span><span class="line" data-startTime="1646">we rely on the function </span><span class="line" data-startTime="1646">being first class, </span><span class="line" data-startTime="1648">meaning it has its own call </span><span class="line" data-startTime="1648">and apply methods. </span> <span class="line" data-startTime="1651">You don't say necessarily, </span><span class="line" data-startTime="1651">hey, function, </span><span class="line" data-startTime="1653">you're not going to work </span><span class="line" data-startTime="1653">if you're not called inside </span><span class="line" data-startTime="1655">of some other object. </span></p>

<p><span class="line" data-startTime="1656">I can call any function in </span><span class="line" data-startTime="1656">the scope of any other object. </span> <span class="line" data-startTime="1660">I can assign a function to any </span><span class="line" data-startTime="1660">other object and then call it </span><span class="line" data-startTime="1662">through that object </span><span class="line" data-startTime="1662">dynamically, right? </span><span class="line" data-startTime="1665">Everything is mutable. </span> <span class="line" data-startTime="1667">Functions are first class. </span> <span class="line" data-startTime="1667">Why not? </span><span class="line" data-startTime="1668">So in order to get </span><span class="line" data-startTime="1668">that to execute </span><span class="line" data-startTime="1670">against the right object, </span><span class="line" data-startTime="1671">you use the this keyword </span><span class="line" data-startTime="1671">to go grab </span><span class="line" data-startTime="1672">the value out of the thing </span><span class="line" data-startTime="1674">that was on </span><span class="line" data-startTime="1674">the left hand side of dot, </span><span class="line" data-startTime="1676">which is exactly </span><span class="line" data-startTime="1676">the same thing as saying </span><span class="line" data-startTime="1678">please call my function, </span><span class="line" data-startTime="1679">which I pulled </span><span class="line" data-startTime="1679">out of that object, </span><span class="line" data-startTime="1680">in the scope of the object </span><span class="line" data-startTime="1680">on the left hand side. </span> <span class="line" data-startTime="1683">Cool? </span><span class="line" data-startTime="1685">All right. </span></p>

<p><span class="line" data-startTime="1686">Okay. </span> <span class="line" data-startTime="1688">So all this fits together </span><span class="line" data-startTime="1688">in ways that allow us </span><span class="line" data-startTime="1690">to recreate a lot of this stuff </span><span class="line" data-startTime="1690">that we expected </span><span class="line" data-startTime="1692">in other languages. </span> <span class="line" data-startTime="1693">A lot of this </span><span class="line" data-startTime="1693">is convention. </span> <span class="line" data-startTime="1695">A lot of this isn't necessarily </span><span class="line" data-startTime="1695">the sort of thing </span><span class="line" data-startTime="1696">that you're going </span><span class="line" data-startTime="1696">to have language level </span><span class="line" data-startTime="1698">or syntactic support for, </span><span class="line" data-startTime="1699">but if you understand </span><span class="line" data-startTime="1699">what's going on there, </span><span class="line" data-startTime="1701">those sort of core little ideas </span><span class="line" data-startTime="1701">about mutability, </span><span class="line" data-startTime="1706">scope, functions as first class </span><span class="line" data-startTime="1706">citizens, and dynamic behavior, </span><span class="line" data-startTime="1712">we can start to recreate </span><span class="line" data-startTime="1712">things like classes. </span></p>

<p><span class="line" data-startTime="1714">So here we've got an item type, </span><span class="line" data-startTime="1716">which is we're going to </span><span class="line" data-startTime="1716">think of as a class. </span> <span class="line" data-startTime="1719">It's not really </span><span class="line" data-startTime="1719">called a class. </span> <span class="line" data-startTime="1721">It's just a function. </span> <span class="line" data-startTime="1721">It's got the word function. </span> <span class="line" data-startTime="1723">As you saw earlier, </span><span class="line" data-startTime="1724">when you use the word new </span><span class="line" data-startTime="1724">in front of any function, </span><span class="line" data-startTime="1726">it sort of creates an object, </span><span class="line" data-startTime="1728">calls that function inside </span><span class="line" data-startTime="1728">the context of that object, </span><span class="line" data-startTime="1730">and then returns </span><span class="line" data-startTime="1730">that object back to you. </span></p>

<p><span class="line" data-startTime="1732">That's the way to think </span><span class="line" data-startTime="1732">about the new keyword. </span> <span class="line" data-startTime="1734">So we're just going to </span><span class="line" data-startTime="1734">create a function, </span><span class="line" data-startTime="1736">which we're going to call </span><span class="line" data-startTime="1736">with new sometime later, </span><span class="line" data-startTime="1738">and inside of it </span><span class="line" data-startTime="1738">we're going to execute </span><span class="line" data-startTime="1740">a couple of other functions. </span> <span class="line" data-startTime="1742">Now, we just saw .call, </span><span class="line" data-startTime="1742">and .call calls </span><span class="line" data-startTime="1744">those other functions </span><span class="line" data-startTime="1744">in the scope of the object </span><span class="line" data-startTime="1747">that we're being executed in </span><span class="line" data-startTime="1747">or that we want to pass in. </span> <span class="line" data-startTime="1750">In this case, we're going to </span><span class="line" data-startTime="1750">pass in the local object, </span><span class="line" data-startTime="1752">and we're going </span><span class="line" data-startTime="1752">to do it twice, </span><span class="line" data-startTime="1754">which means that </span><span class="line" data-startTime="1754">inside of tract, </span><span class="line" data-startTime="1756">we're going to assign </span><span class="line" data-startTime="1756">a new property to this &mdash; </span><span class="line" data-startTime="1760">which is to say the object </span><span class="line" data-startTime="1760">that was passed in &mdash; </span><span class="line" data-startTime="1762">and inside of logged, we're </span><span class="line" data-startTime="1762">going to assign a new method </span><span class="line" data-startTime="1765">where that method is going to go </span><span class="line" data-startTime="1765">dynamically look up the ID </span><span class="line" data-startTime="1769">and log it out. </span></p>

<p><span class="line" data-startTime="1771">So we call these mix-ins. </span> <span class="line" data-startTime="1772">These two methods up here </span><span class="line" data-startTime="1772">were written in a way </span><span class="line" data-startTime="1774">that they don't delegate </span><span class="line" data-startTime="1774">to anything else. </span> <span class="line" data-startTime="1775">They don't assume anything about </span><span class="line" data-startTime="1775">the behavior of their methods </span><span class="line" data-startTime="1780">or the properties </span><span class="line" data-startTime="1780">that they define. </span> <span class="line" data-startTime="1783">And instead, </span><span class="line" data-startTime="1783">they just add stuff. </span> <span class="line" data-startTime="1784">They just add stuff </span><span class="line" data-startTime="1784">dynamically </span><span class="line" data-startTime="1786">when they're invoked against </span><span class="line" data-startTime="1786">some other object. </span> <span class="line" data-startTime="1790">So I could call them </span><span class="line" data-startTime="1790">in any other context, </span><span class="line" data-startTime="1792">but in this case, I can use them </span><span class="line" data-startTime="1792">in the item type constructor </span><span class="line" data-startTime="1795">to extend the item type </span><span class="line" data-startTime="1795">with some new stuff. </span> <span class="line" data-startTime="1799">We saw earlier how </span><span class="line" data-startTime="1799">delegation allows you to </span><span class="line" data-startTime="1801">create new delegate </span><span class="line" data-startTime="1801">relationships between things, </span><span class="line" data-startTime="1806">and functions also have </span><span class="line" data-startTime="1806">this idea of a prototype. </span> <span class="line" data-startTime="1808">This is the exposed version </span><span class="line" data-startTime="1808">of the thing we saw </span><span class="line" data-startTime="1809">before with object.create, </span><span class="line" data-startTime="1811">where I can say, </span><span class="line" data-startTime="1811">please wire up this relationship </span><span class="line" data-startTime="1813">so that this object, </span><span class="line" data-startTime="1813">when you don't find it here, </span><span class="line" data-startTime="1815">looks at that thing over there. </span></p>

<p><span class="line" data-startTime="1818">So if we create </span><span class="line" data-startTime="1818">a new item type, </span><span class="line" data-startTime="1821">what we'll see is </span><span class="line" data-startTime="1821">that it has an ID, </span><span class="line" data-startTime="1823">and it has a type associated </span><span class="line" data-startTime="1823">with property added to them, </span><span class="line" data-startTime="1827">which is pretty good. </span> <span class="line" data-startTime="1827">And if we create another one, </span><span class="line" data-startTime="1830">the counter is incremented, </span><span class="line" data-startTime="1831">and the type is still </span><span class="line" data-startTime="1831">assigned to the same value. </span> <span class="line" data-startTime="1835">But if we create </span><span class="line" data-startTime="1835">a new sub item type, </span><span class="line" data-startTime="1837">what we see is that, </span><span class="line" data-startTime="1837">because the prototype created </span><span class="line" data-startTime="1841">a new property called type </span><span class="line" data-startTime="1841">with a new value, </span><span class="line" data-startTime="1846">again, the delegate system </span><span class="line" data-startTime="1846">faults on the local object, </span><span class="line" data-startTime="1850">looks at the object's </span><span class="line" data-startTime="1850">prototype &mdash; in this case, </span><span class="line" data-startTime="1853">SubItemType.prototype &mdash; </span><span class="line" data-startTime="1853">pulls it out of there </span><span class="line" data-startTime="1856">and doesn't fault all the way </span><span class="line" data-startTime="1856">through to ItemType.prototype. </span></p>

<p><span class="line" data-startTime="1859">So we can compose </span><span class="line" data-startTime="1859">these things together in a way </span><span class="line" data-startTime="1861">that gives us something like </span><span class="line" data-startTime="1861">classical inheritance. </span> <span class="line" data-startTime="1864">It's not exactly </span><span class="line" data-startTime="1864">the same thing. </span> <span class="line" data-startTime="1865">All this is dynamic. </span> <span class="line" data-startTime="1866">I can go and change </span><span class="line" data-startTime="1866">these prototypes. </span> <span class="line" data-startTime="1867">I can change </span><span class="line" data-startTime="1867">these objects later. </span> <span class="line" data-startTime="1870">But I've got the ability </span><span class="line" data-startTime="1870">to factor out code </span><span class="line" data-startTime="1872">into something like a macro </span><span class="line" data-startTime="1872">or a trait, using mix-ins, </span><span class="line" data-startTime="1876">and I've got the ability </span><span class="line" data-startTime="1876">to create </span><span class="line" data-startTime="1878">an entire subclass </span><span class="line" data-startTime="1878">relationship, </span><span class="line" data-startTime="1880">where I define </span><span class="line" data-startTime="1880">new function types </span><span class="line" data-startTime="1882">which defer </span><span class="line" data-startTime="1882">to their super classes </span><span class="line" data-startTime="1885">for a lot of their behavior. </span> <span class="line" data-startTime="1886">All right, we're starting </span><span class="line" data-startTime="1886">to get someplace. </span></p>

<p><span class="line" data-startTime="1888">These core concepts have </span><span class="line" data-startTime="1888">given us the ability to </span><span class="line" data-startTime="1890">define things that the language </span><span class="line" data-startTime="1890">didn't give us naturally, </span><span class="line" data-startTime="1893">but we can go get </span><span class="line" data-startTime="1893">for ourselves. </span> <span class="line" data-startTime="1896">You know how I said </span><span class="line" data-startTime="1896">that everything is mutable, </span><span class="line" data-startTime="1898">more or less? </span><span class="line" data-startTime="1900">That means that we can </span><span class="line" data-startTime="1900">go and extend the stuff </span><span class="line" data-startTime="1902">that is deferred to </span><span class="line" data-startTime="1902">by almost every object </span><span class="line" data-startTime="1905">in the system, right? </span><span class="line" data-startTime="1906">Remember, arrays </span><span class="line" data-startTime="1906">are objects. </span> <span class="line" data-startTime="1908">Objects are objects. </span> <span class="line" data-startTime="1908">Functions are objects. </span> <span class="line" data-startTime="1910">Well, those things </span><span class="line" data-startTime="1910">have prototypes, too. </span> <span class="line" data-startTime="1912">They have exposed objects, </span><span class="line" data-startTime="1913">which are &mdash; they defer to </span><span class="line" data-startTime="1913">when you don't find a property </span><span class="line" data-startTime="1916">in the local object. </span> <span class="line" data-startTime="1917">So a radar prototype is, again, </span><span class="line" data-startTime="1917">an object which is mutable, </span><span class="line" data-startTime="1921">and every instance of array, </span><span class="line" data-startTime="1921">every array in the system </span><span class="line" data-startTime="1924">that faults on some property </span><span class="line" data-startTime="1924">is going to go look it up off </span><span class="line" data-startTime="1927">of this object instead. </span> <span class="line" data-startTime="1927">So I can extend it. </span></p>

<p><span class="line" data-startTime="1930">I can say array.prototype.clear </span><span class="line" data-startTime="1930">is a new function. </span> <span class="line" data-startTime="1932">I can extend every single </span><span class="line" data-startTime="1932">array in the system at runtime, </span><span class="line" data-startTime="1936">because the next line </span><span class="line" data-startTime="1936">is going to look it up </span><span class="line" data-startTime="1938">through exactly </span><span class="line" data-startTime="1938">the same mechanism </span><span class="line" data-startTime="1941">as everything else, right? </span><span class="line" data-startTime="1943">This is not me </span><span class="line" data-startTime="1943">changing the type of array. </span> <span class="line" data-startTime="1945">I'm just extending </span><span class="line" data-startTime="1945">it dynamically. </span> <span class="line" data-startTime="1947">I'm creating a new thing </span><span class="line" data-startTime="1947">for you to hit, </span><span class="line" data-startTime="1950">when you don't find the property </span><span class="line" data-startTime="1950">in the local array object. </span> <span class="line" data-startTime="1953">And I'm going to add to. </span> <span class="line" data-startTime="1954">In this case, they're </span><span class="line" data-startTime="1954">going to return new arrays </span><span class="line" data-startTime="1956">when they're done, and so </span><span class="line" data-startTime="1956">I can chain them together. </span> <span class="line" data-startTime="1958">And so this is how </span><span class="line" data-startTime="1958">you can sort of create </span><span class="line" data-startTime="1960">little dynamic languages </span><span class="line" data-startTime="1960">in JavaScript. </span> <span class="line" data-startTime="1962">You can create DSLs </span><span class="line" data-startTime="1962">in JavaScript </span><span class="line" data-startTime="1964">by changing the things </span><span class="line" data-startTime="1964">that you delegate to. </span></p>

<p><span class="line" data-startTime="1966">If you create new objects, </span><span class="line" data-startTime="1968">and they delegate </span><span class="line" data-startTime="1968">to some prototype, </span><span class="line" data-startTime="1969">and you can mutate </span><span class="line" data-startTime="1969">that prototype, </span><span class="line" data-startTime="1971">well, then you can change almost </span><span class="line" data-startTime="1971">everything about the system. </span> <span class="line" data-startTime="1975">Yes, you can change almost </span><span class="line" data-startTime="1975">everything about the system. </span> <span class="line" data-startTime="1978">And, yes, it is a huge </span><span class="line" data-startTime="1978">maintainability nightmare. </span> <span class="line" data-startTime="1980">This is really good </span><span class="line" data-startTime="1980">when your code can do it. </span> <span class="line" data-startTime="1983">This can be a huge problem </span><span class="line" data-startTime="1983">when everybody's code can do it, </span><span class="line" data-startTime="1986">especially as you get </span><span class="line" data-startTime="1986">into larger code bases. </span> <span class="line" data-startTime="1988">So collectively, </span><span class="line" data-startTime="1988">as a community, </span><span class="line" data-startTime="1991">the JavaScript world has started </span><span class="line" data-startTime="1991">to learn these patterns </span><span class="line" data-startTime="1993">of practice, which they say, </span><span class="line" data-startTime="1993">please don't ever go </span><span class="line" data-startTime="1997">and mutate array.prototype. </span></p>

<p><span class="line" data-startTime="1999">Please don't change </span><span class="line" data-startTime="1999">object.prototype, </span><span class="line" data-startTime="2001">so that you don't wind up </span><span class="line" data-startTime="2003">stepping on somebody </span><span class="line" data-startTime="2003">else's toes, </span><span class="line" data-startTime="2004">stepping on somebody </span><span class="line" data-startTime="2004">else's extensions. </span> <span class="line" data-startTime="2006">But this is power </span><span class="line" data-startTime="2006">that we'd really like to have. </span> <span class="line" data-startTime="2008">This is power that </span><span class="line" data-startTime="2008">we'd really like to be able </span><span class="line" data-startTime="2009">to take advantage of. </span> <span class="line" data-startTime="2011">Being able to extend </span><span class="line" data-startTime="2011">methods in the system </span><span class="line" data-startTime="2012">is the sort of thing </span><span class="line" data-startTime="2014">that we've seen work pretty well </span><span class="line" data-startTime="2014">in languages like C#, </span><span class="line" data-startTime="2015">where they have extension </span><span class="line" data-startTime="2015">methods to interfaces. </span> <span class="line" data-startTime="2018">We really want to be able </span><span class="line" data-startTime="2018">to use this, </span><span class="line" data-startTime="2019">because it shortens up our code. </span></p>

<p><span class="line" data-startTime="2020">It makes it dynamic. </span> <span class="line" data-startTime="2020">It makes it easy to read, </span><span class="line" data-startTime="2022">and it makes it possible </span><span class="line" data-startTime="2022">to build up the language </span><span class="line" data-startTime="2024">to meet us halfway, </span><span class="line" data-startTime="2026">which is a great feature </span><span class="line" data-startTime="2026">of many dynamic languages. </span> <span class="line" data-startTime="2029">So JavaScript has this </span><span class="line" data-startTime="2029">incredible dynamic behavior, </span><span class="line" data-startTime="2034">which gives us </span><span class="line" data-startTime="2034">a lot of power, </span><span class="line" data-startTime="2035">and so we wind up using it </span><span class="line" data-startTime="2035">to do all sorts of things </span><span class="line" data-startTime="2038">that the language </span><span class="line" data-startTime="2038">doesn't necessarily, </span><span class="line" data-startTime="2040">because it's a little language, </span><span class="line" data-startTime="2040">have built-in support for. </span> <span class="line" data-startTime="2043">So in this case, </span><span class="line" data-startTime="2043">I'm going to, again, </span><span class="line" data-startTime="2045">create an expression </span><span class="line" data-startTime="2045">that has an anonymous function </span><span class="line" data-startTime="2048">defined inside of it. </span> <span class="line" data-startTime="2049">But, instead, </span><span class="line" data-startTime="2049">I'm going to do some stuff here </span><span class="line" data-startTime="2050">where I'm going to define </span><span class="line" data-startTime="2050">a local object, right? </span><span class="line" data-startTime="2053">We've seen this before, </span><span class="line" data-startTime="2054">that might get captured </span><span class="line" data-startTime="2054">in an enclosure; </span><span class="line" data-startTime="2056">and, in fact, </span><span class="line" data-startTime="2056">it's going to here. </span></p>

<p><span class="line" data-startTime="2058">But the little piece </span><span class="line" data-startTime="2058">of sophistry </span><span class="line" data-startTime="2061">at the bottom there, </span><span class="line" data-startTime="2063">or in the middle there, </span><span class="line" data-startTime="2063">where I end the function, </span><span class="line" data-startTime="2066">I end the expression, </span><span class="line" data-startTime="2068">which is going to return </span><span class="line" data-startTime="2068">that function </span><span class="line" data-startTime="2070">as the result of </span><span class="line" data-startTime="2070">that expression, </span><span class="line" data-startTime="2072">and then I invoke it </span><span class="line" data-startTime="2072">immediately, </span><span class="line" data-startTime="2074">means that what happens here </span><span class="line" data-startTime="2075">is that I've sort of </span><span class="line" data-startTime="2075">created some code </span><span class="line" data-startTime="2077">and just run it directly. </span> <span class="line" data-startTime="2079">I've just top to bottom </span><span class="line" data-startTime="2080">run some code, which is going to </span><span class="line" data-startTime="2080">define a local variable, </span><span class="line" data-startTime="2084">create a function &mdash; </span><span class="line" data-startTime="2084">which is not local, </span><span class="line" data-startTime="2085">which is going to get exported </span><span class="line" data-startTime="2085">back out to the global scope, </span><span class="line" data-startTime="2089">but that function can see </span><span class="line" data-startTime="2089">the local stuff, right? </span><span class="line" data-startTime="2091">So I can sort of hide away </span><span class="line" data-startTime="2091">in my own private stuff </span><span class="line" data-startTime="2094">inside of my module </span><span class="line" data-startTime="2094">by putting it in this pattern, </span><span class="line" data-startTime="2095">using VAR for the stuff. </span> <span class="line" data-startTime="2097">It's a local and emitting VAR </span><span class="line" data-startTime="2097">for the stuff that's global. </span></p>

<p><span class="line" data-startTime="2100">That's pretty good. </span> <span class="line" data-startTime="2101">We've got some sense </span><span class="line" data-startTime="2101">of modularity, again, </span><span class="line" data-startTime="2103">built on this few set of </span><span class="line" data-startTime="2103">prototypical properties </span><span class="line" data-startTime="2107">of the language: </span><span class="line" data-startTime="2108">mutability, functions </span><span class="line" data-startTime="2108">as first class and functions </span><span class="line" data-startTime="2111">as the only things </span><span class="line" data-startTime="2111">that create scope, </span><span class="line" data-startTime="2112">the ability to modify </span><span class="line" data-startTime="2112">nearly everything, </span><span class="line" data-startTime="2116">and closures as a way </span><span class="line" data-startTime="2116">to bind behavior to data </span><span class="line" data-startTime="2120">and not the other way around. </span> <span class="line" data-startTime="2120">Okay, so as you can imagine, </span><span class="line" data-startTime="2124">we've seen a couple </span><span class="line" data-startTime="2124">of places here now </span><span class="line" data-startTime="2126">with classes </span><span class="line" data-startTime="2126">and now with modules, </span><span class="line" data-startTime="2128">where we could start to use </span><span class="line" data-startTime="2128">these patterns together </span><span class="line" data-startTime="2130">to start to build up </span><span class="line" data-startTime="2130">our little library of stuff </span><span class="line" data-startTime="2133">to help us </span><span class="line" data-startTime="2133">meet the challenges </span><span class="line" data-startTime="2134">that we've got in </span><span class="line" data-startTime="2134">the large code base; </span><span class="line" data-startTime="2136">and, in fact, </span><span class="line" data-startTime="2136">nearly every large code base </span><span class="line" data-startTime="2138">has a library like this. </span></p>

<p><span class="line" data-startTime="2140">The world of </span><span class="line" data-startTime="2140">JavaScript libraries </span><span class="line" data-startTime="2142">has a lot of different answers </span><span class="line" data-startTime="2142">to a lot of the questions </span><span class="line" data-startTime="2144">that you want. </span> <span class="line" data-startTime="2144">So for modularity, </span><span class="line" data-startTime="2146">it'd be great if we could </span><span class="line" data-startTime="2146">sort of have a script loader </span><span class="line" data-startTime="2148">that would pull in </span><span class="line" data-startTime="2148">a bunch of stuff. </span> <span class="line" data-startTime="2150">It would transitive </span><span class="line" data-startTime="2150">dependency management, </span><span class="line" data-startTime="2151">and it would put our stuff </span><span class="line" data-startTime="2151">inside of this body of code </span><span class="line" data-startTime="2154">that we could then </span><span class="line" data-startTime="2154">think of as something </span><span class="line" data-startTime="2156">that has dependencies </span><span class="line" data-startTime="2156">but can also hide local state. </span> <span class="line" data-startTime="2159">So this is the closure example. </span> <span class="line" data-startTime="2161">This is the tree control, </span><span class="line" data-startTime="2161">and these are its dependencies. </span></p>

<p><span class="line" data-startTime="2164">And it does almost </span><span class="line" data-startTime="2164">exactly this, right? </span><span class="line" data-startTime="2166">This is the module </span><span class="line" data-startTime="2166">that it might define, </span><span class="line" data-startTime="2169">and it's going to </span><span class="line" data-startTime="2169">export some stuff. </span> <span class="line" data-startTime="2171">Okay, that's pretty good. </span> <span class="line" data-startTime="2173">But then you look at </span><span class="line" data-startTime="2173">other JavaScript libraries, </span><span class="line" data-startTime="2175">and they do almost exactly </span><span class="line" data-startTime="2175">the same thing. </span> <span class="line" data-startTime="2177">Here's a tree control </span><span class="line" data-startTime="2177">from the tool kit </span><span class="line" data-startTime="2179">that I used to work on, digit. </span> <span class="line" data-startTime="2182">And so that does exactly </span><span class="line" data-startTime="2182">the same thing, right? </span><span class="line" data-startTime="2185">We've got this </span><span class="line" data-startTime="2185">module pattern here, </span><span class="line" data-startTime="2186">where that's going to be </span><span class="line" data-startTime="2186">what you define inside of it. </span></p>

<p><span class="line" data-startTime="2189">And at the same time, </span><span class="line" data-startTime="2189">these two syntaxes </span><span class="line" data-startTime="2192">and these two semantics </span><span class="line" data-startTime="2192">aren't interoperable. </span> <span class="line" data-startTime="2195">You can't use them together. </span> <span class="line" data-startTime="2195">That's not great. </span> <span class="line" data-startTime="2197">Now, we're in a place where </span><span class="line" data-startTime="2197">we have all of this raw power, </span><span class="line" data-startTime="2200">and we can start to harness it </span><span class="line" data-startTime="2200">in ways that solve our problems, </span><span class="line" data-startTime="2202">but we can't say the same thing </span><span class="line" data-startTime="2202">unless we all agree a priori </span><span class="line" data-startTime="2206">which sort of patterns </span><span class="line" data-startTime="2206">we're going to use </span><span class="line" data-startTime="2207">and in which style </span><span class="line" data-startTime="2207">we're going to use them. </span> <span class="line" data-startTime="2210">So this is the role </span><span class="line" data-startTime="2210">of the language. </span> <span class="line" data-startTime="2212">This is where language </span><span class="line" data-startTime="2212">evolution can really start </span><span class="line" data-startTime="2214">to pay off </span><span class="line" data-startTime="2214">some big dividends. </span></p>

<p><span class="line" data-startTime="2216">And so this is Dave Herman's </span><span class="line" data-startTime="2216">simple module proposal syntax, </span><span class="line" data-startTime="2222">and this is something </span><span class="line" data-startTime="2222">like the array, </span><span class="line" data-startTime="2225">the tree control requirements </span><span class="line" data-startTime="2225">written out in the new syntax. </span> <span class="line" data-startTime="2230">As you can see, </span><span class="line" data-startTime="2230">we actually have syntax saying </span><span class="line" data-startTime="2232">this thing </span><span class="line" data-startTime="2232">is going to be a module. </span> <span class="line" data-startTime="2234">I'd like you </span><span class="line" data-startTime="2234">to acquire it. </span> <span class="line" data-startTime="2235">I'd like you to import </span><span class="line" data-startTime="2235">these sets of things </span><span class="line" data-startTime="2238">into my local scope. </span> <span class="line" data-startTime="2240">And because we've got syntax </span><span class="line" data-startTime="2240">for this in harmony, </span><span class="line" data-startTime="2243">which is the next version </span><span class="line" data-startTime="2243">of ECMAScript, </span><span class="line" data-startTime="2246">we've got the ability </span><span class="line" data-startTime="2246">for everyone </span><span class="line" data-startTime="2247">to agree on what it is </span><span class="line" data-startTime="2247">you're trying to get done. </span> <span class="line" data-startTime="2249">Because you have syntax, </span><span class="line" data-startTime="2251">no one now has the incentive </span><span class="line" data-startTime="2251">to go write their own thing. </span> <span class="line" data-startTime="2254">You can start to rely on </span><span class="line" data-startTime="2254">there being one canonical way </span><span class="line" data-startTime="2257">of saying here are my exports, </span><span class="line" data-startTime="2257">here are my imports. </span></p>

<p><span class="line" data-startTime="2261">Here's how it's done. </span> <span class="line" data-startTime="2262">And so tool kits can </span><span class="line" data-startTime="2262">start to interoperate. </span> <span class="line" data-startTime="2264">They don't have to </span><span class="line" data-startTime="2264">continue to compete </span><span class="line" data-startTime="2265">or, you know, reinvent </span><span class="line" data-startTime="2267">on the basis of </span><span class="line" data-startTime="2267">a low level set of things </span><span class="line" data-startTime="2270">that you might hope </span><span class="line" data-startTime="2270">would be provided for you </span><span class="line" data-startTime="2272">in the language. </span> <span class="line" data-startTime="2274">The same thing </span><span class="line" data-startTime="2274">goes for classes. </span> <span class="line" data-startTime="2275">You know how we saw </span><span class="line" data-startTime="2275">all that boilerplate earlier, </span><span class="line" data-startTime="2277">where you had the mix-ins </span><span class="line" data-startTime="2277">were for functions, </span><span class="line" data-startTime="2279">and the classes which were </span><span class="line" data-startTime="2279">defined as functions &mdash; </span><span class="line" data-startTime="2281">well, they all have </span><span class="line" data-startTime="2281">the same word, function. </span> <span class="line" data-startTime="2284">How do you know </span><span class="line" data-startTime="2284">it's a function? </span><span class="line" data-startTime="2285">Again, we saw the word function </span><span class="line" data-startTime="2285">reused to go define </span><span class="line" data-startTime="2286">that closure, </span><span class="line" data-startTime="2288">which gave us the scope </span><span class="line" data-startTime="2288">for using the module pattern. </span></p>

<p><span class="line" data-startTime="2291">Well, the word function </span><span class="line" data-startTime="2291">gets a lot of use, </span><span class="line" data-startTime="2292">and in fact, </span><span class="line" data-startTime="2292">it is used so often </span><span class="line" data-startTime="2295">that it's hard </span><span class="line" data-startTime="2295">to understand exactly </span><span class="line" data-startTime="2297">what it is </span><span class="line" data-startTime="2297">you're reading sometimes, </span><span class="line" data-startTime="2298">if you're not familiar </span><span class="line" data-startTime="2298">with all of these patterns. </span> <span class="line" data-startTime="2300">And so nearly every tool kit </span><span class="line" data-startTime="2300">comes along </span><span class="line" data-startTime="2303">and creates a shorthand </span><span class="line" data-startTime="2303">to help you define a class, </span><span class="line" data-startTime="2306">because, you know, </span><span class="line" data-startTime="2307">you can just write </span><span class="line" data-startTime="2307">a function that'll do it. </span> <span class="line" data-startTime="2308">Closure does it. </span> <span class="line" data-startTime="2312">Prototype does it. </span> <span class="line" data-startTime="2314">You can imagine </span><span class="line" data-startTime="2314">that MochiKit </span><span class="line" data-startTime="2315">or Dojo all do it slightly </span><span class="line" data-startTime="2315">differently, </span><span class="line" data-startTime="2317">and these all lead to slightly </span><span class="line" data-startTime="2317">different semantics, </span><span class="line" data-startTime="2319">because the way that you wire up </span><span class="line" data-startTime="2319">those relationships internally &mdash; </span><span class="line" data-startTime="2322">and I showed you one way </span><span class="line" data-startTime="2322">with using traits </span><span class="line" data-startTime="2327">or mix-ins inside </span><span class="line" data-startTime="2327">of constructor functions. </span> <span class="line" data-startTime="2329">They make different </span><span class="line" data-startTime="2329">decisions. </span> <span class="line" data-startTime="2331">You can compose this stuff </span><span class="line" data-startTime="2331">a lot of different ways, </span><span class="line" data-startTime="2332">because you're always sort of </span><span class="line" data-startTime="2332">cobbling it together </span><span class="line" data-startTime="2334">from the raw material </span><span class="line" data-startTime="2334">that's already in front of you. </span></p>

<p><span class="line" data-startTime="2336">It's incredibly powerful, </span><span class="line" data-startTime="2337">but with that power </span><span class="line" data-startTime="2337">comes the requirement </span><span class="line" data-startTime="2339">that you have to get a bunch </span><span class="line" data-startTime="2339">of people to agree with you </span><span class="line" data-startTime="2341">about how to use it. </span> <span class="line" data-startTime="2343">And in this case, </span><span class="line" data-startTime="2344">a bunch of well-meaning </span><span class="line" data-startTime="2344">library authors came up </span><span class="line" data-startTime="2346">with really good solutions </span><span class="line" data-startTime="2346">that fit their constraints. </span> <span class="line" data-startTime="2349">And in this case, </span><span class="line" data-startTime="2351">they all differ </span><span class="line" data-startTime="2351">a little bit in terms of </span><span class="line" data-startTime="2352">the underlying semantic, and </span><span class="line" data-startTime="2352">that's a little bit frustrating </span><span class="line" data-startTime="2354">when you want to just </span><span class="line" data-startTime="2354">share a little bit of code </span><span class="line" data-startTime="2356">with somebody over there. </span> <span class="line" data-startTime="2357">So what we'd like to do </span><span class="line" data-startTime="2357">is say what we mean. </span> <span class="line" data-startTime="2360">So this is a little bit of code </span><span class="line" data-startTime="2360">that comes from </span><span class="line" data-startTime="2363">Marcin Wichary's </span><span class="line" data-startTime="2363">awesome Pac-Man demo, </span><span class="line" data-startTime="2366">but this wouldn't be </span><span class="line" data-startTime="2366">how you'd write it today. </span></p>

<p><span class="line" data-startTime="2368">This is how you'd have </span><span class="line" data-startTime="2368">to write in the future. </span> <span class="line" data-startTime="2371">Or this isn't how you would </span><span class="line" data-startTime="2371">have to write it today. </span> <span class="line" data-startTime="2373">This is what you would </span><span class="line" data-startTime="2373">like to be writing. </span> <span class="line" data-startTime="2374">You'd like to say, </span><span class="line" data-startTime="2374">I've got a class. </span> <span class="line" data-startTime="2375">It's got a constructor body, </span><span class="line" data-startTime="2375">and it's got some methods, </span><span class="line" data-startTime="2379">and then I've got </span><span class="line" data-startTime="2379">a subclass which, </span><span class="line" data-startTime="2380">you know, wires with that </span><span class="line" data-startTime="2380">prototypal relationship </span><span class="line" data-startTime="2383">with the other thing. </span> <span class="line" data-startTime="2383">It's got a constructor body, </span><span class="line" data-startTime="2385">and it defines some properties </span><span class="line" data-startTime="2385">on its prototype. </span> <span class="line" data-startTime="2388">What we'd like to do </span><span class="line" data-startTime="2388">is have this syntax map </span><span class="line" data-startTime="2390">to exactly what </span><span class="line" data-startTime="2390">we saw before, right? </span><span class="line" data-startTime="2392">We don't want to change </span><span class="line" data-startTime="2392">the fundamental idea </span><span class="line" data-startTime="2396">of what the language is. </span> <span class="line" data-startTime="2397">Prototype based, </span><span class="line" data-startTime="2397">functions as first class, </span><span class="line" data-startTime="2400">closures to carry state, </span><span class="line" data-startTime="2400">top to bottom evaluation, </span><span class="line" data-startTime="2403">delegation and not classes. </span> <span class="line" data-startTime="2407">When we introduce a syntax </span><span class="line" data-startTime="2407">for the word class, right, </span><span class="line" data-startTime="2409">what we would like </span><span class="line" data-startTime="2409">for this to have happen here </span><span class="line" data-startTime="2411">is when we evolve </span><span class="line" data-startTime="2411">the language, </span><span class="line" data-startTime="2413">we want to hold on to </span><span class="line" data-startTime="2413">that fundamental set of things </span><span class="line" data-startTime="2415">that define JavaScript </span><span class="line" data-startTime="2415">as JavaScript, </span><span class="line" data-startTime="2417">so that you can understand old </span><span class="line" data-startTime="2417">code in the context of new code </span><span class="line" data-startTime="2420">and that JavaScript can maintain </span><span class="line" data-startTime="2420">a lot of that dynamic, </span><span class="line" data-startTime="2422">which pays off so well when </span><span class="line" data-startTime="2422">we need to start doing things </span><span class="line" data-startTime="2425">that the language </span><span class="line" data-startTime="2425">doesn't provide for us. </span></p>

<p><span class="line" data-startTime="2426">Because </span><span class="line" data-startTime="2426">what we've seen today is </span><span class="line" data-startTime="2428">that we've put together a whole </span><span class="line" data-startTime="2428">series of things from raw parts, </span><span class="line" data-startTime="2432">just little raw material, things </span><span class="line" data-startTime="2432">that are very high level, </span><span class="line" data-startTime="2434">very high level constructs that </span><span class="line" data-startTime="2434">you're going to need to use, </span><span class="line" data-startTime="2437">that you might not expect </span><span class="line" data-startTime="2437">to be there on JavaScript, </span><span class="line" data-startTime="2440">but JavaScript </span><span class="line" data-startTime="2440">provides them for you. </span> <span class="line" data-startTime="2441">And it's easy </span><span class="line" data-startTime="2441">to love a language </span><span class="line" data-startTime="2442">that gives you </span><span class="line" data-startTime="2442">that kind of power. </span> <span class="line" data-startTime="2445">So we wanted something that </span><span class="line" data-startTime="2446">we in the standards committee </span><span class="line" data-startTime="2446">call de-sugaring. </span></p>

<p><span class="line" data-startTime="2448">And de-sugaring </span><span class="line" data-startTime="2448">is the concept </span><span class="line" data-startTime="2449">of when you define a new idea, </span><span class="line" data-startTime="2449">or you define new syntax, </span><span class="line" data-startTime="2453">or a new semantic </span><span class="line" data-startTime="2453">in the language, </span><span class="line" data-startTime="2456">it would be best if we could </span><span class="line" data-startTime="2456">describe that new thing </span><span class="line" data-startTime="2459">in terms of the stuff </span><span class="line" data-startTime="2459">that's already there. </span> <span class="line" data-startTime="2461">So if I describe </span><span class="line" data-startTime="2461">a new language feature by </span><span class="line" data-startTime="2464">what it would be like </span><span class="line" data-startTime="2464">if I'd just written it all out, </span><span class="line" data-startTime="2467">we can start to say, aha. </span> <span class="line" data-startTime="2469">This fits </span><span class="line" data-startTime="2469">or this doesn't fit </span><span class="line" data-startTime="2470">with the way we start to use </span><span class="line" data-startTime="2470">JavaScript today. </span> <span class="line" data-startTime="2472">So this is an example </span><span class="line" data-startTime="2472">of what I'd like to write </span><span class="line" data-startTime="2474">in the new style, and what </span><span class="line" data-startTime="2474">you would have to write today </span><span class="line" data-startTime="2478">to go make this all </span><span class="line" data-startTime="2478">work in the old style. </span> <span class="line" data-startTime="2481">Okay, that's a lot, </span><span class="line" data-startTime="2481">and it's a lot of boilerplate </span><span class="line" data-startTime="2485">that we shouldn't </span><span class="line" data-startTime="2485">have to write. </span></p>

<p><span class="line" data-startTime="2488">The same thing goes for </span><span class="line" data-startTime="2488">a lot of sort of little </span><span class="line" data-startTime="2490">syntactic niggles. </span> <span class="line" data-startTime="2491">So let's say </span><span class="line" data-startTime="2491">I want a function </span><span class="line" data-startTime="2494">that takes variable arguments. </span> <span class="line" data-startTime="2495">Today, in JavaScript, I have </span><span class="line" data-startTime="2495">to go unpack those arguments </span><span class="line" data-startTime="2497">out of an explicit </span><span class="line" data-startTime="2497">arguments property </span><span class="line" data-startTime="2499">that's available </span><span class="line" data-startTime="2499">inside the scope of any &mdash; </span><span class="line" data-startTime="2501">inside of any function. </span> <span class="line" data-startTime="2504">So if I want a default value, </span><span class="line" data-startTime="2506">I have to go </span><span class="line" data-startTime="2506">provide it for myself, </span><span class="line" data-startTime="2507">and if I want to go grab </span><span class="line" data-startTime="2507">variable array arguments, </span><span class="line" data-startTime="2510">I have to go grab the &mdash; turn </span><span class="line" data-startTime="2510">the best of the arguments </span><span class="line" data-startTime="2514">into an array, </span><span class="line" data-startTime="2514">using array.prototype.slice, </span><span class="line" data-startTime="2518">pass it in to the arguments </span><span class="line" data-startTime="2518">object as the scope, </span><span class="line" data-startTime="2522">and then say give me everything </span><span class="line" data-startTime="2522">after the first one, right? </span><span class="line" data-startTime="2524">And then create me </span><span class="line" data-startTime="2524">the list of parameters. </span> <span class="line" data-startTime="2526">That's a lot of boilerplate. </span> <span class="line" data-startTime="2527">It's sort of hard </span><span class="line" data-startTime="2527">to read that function, </span><span class="line" data-startTime="2529">if you don't know this </span><span class="line" data-startTime="2529">particular sort of pattern, </span><span class="line" data-startTime="2534">and then to understand what </span><span class="line" data-startTime="2534">it is that it's trying to do. </span></p>

<p><span class="line" data-startTime="2536">It's much better </span><span class="line" data-startTime="2536">as a language, </span><span class="line" data-startTime="2538">if what we get to is a place </span><span class="line" data-startTime="2538">where we can say what we mean </span><span class="line" data-startTime="2540">when we're writing </span><span class="line" data-startTime="2540">our functions. </span> <span class="line" data-startTime="2542">I'd like the format </span><span class="line" data-startTime="2542">to have a default property </span><span class="line" data-startTime="2545">of a blank string, </span><span class="line" data-startTime="2545">and I'd like the parameters </span><span class="line" data-startTime="2548">that you don't have allocated </span><span class="line" data-startTime="2548">to some named argument </span><span class="line" data-startTime="2553">stashed away in an array </span><span class="line" data-startTime="2553">called params. </span> <span class="line" data-startTime="2555">That's a pretty common thing </span><span class="line" data-startTime="2555">to want to do. </span> <span class="line" data-startTime="2558">And so this sort of thing </span><span class="line" data-startTime="2558">is coming in the next version </span><span class="line" data-startTime="2562">of the language, </span><span class="line" data-startTime="2564">and last week at JS Conf </span><span class="line" data-startTime="2564">and again at Node Conf, </span><span class="line" data-startTime="2570">we started talking </span><span class="line" data-startTime="2570">about some work </span><span class="line" data-startTime="2571">that we're doing on the Chrome </span><span class="line" data-startTime="2571">Team with the JavaScript </span><span class="line" data-startTime="2575">and JavaScript compiler </span><span class="line" data-startTime="2575">written in JavaScript </span><span class="line" data-startTime="2577">called Traceur. </span></p>

<p><span class="line" data-startTime="2579">And Traceur's goal </span><span class="line" data-startTime="2580">is to help us design </span><span class="line" data-startTime="2580">these new language features </span><span class="line" data-startTime="2582">in a way that works really </span><span class="line" data-startTime="2582">well by trying them out, </span><span class="line" data-startTime="2586">because language evolution </span><span class="line" data-startTime="2586">isn't a straight line thing. </span> <span class="line" data-startTime="2589">You know, we said that all these </span><span class="line" data-startTime="2589">libraries have different ways </span><span class="line" data-startTime="2591">of doing a lot of the stuff, </span><span class="line" data-startTime="2593">so what we'd like to do </span><span class="line" data-startTime="2593">is figure out </span><span class="line" data-startTime="2594">what's the best pattern </span><span class="line" data-startTime="2594">or practice? </span><span class="line" data-startTime="2596">What's the thing that </span><span class="line" data-startTime="2596">we would really like to blast? </span><span class="line" data-startTime="2597">Or when there is </span><span class="line" data-startTime="2597">a new semantic </span><span class="line" data-startTime="2599">that we can introduce </span><span class="line" data-startTime="2599">into the language, </span><span class="line" data-startTime="2601">what is it that we would be </span><span class="line" data-startTime="2601">trying to say </span><span class="line" data-startTime="2602">in JavaScript directly? </span><span class="line" data-startTime="2604">And so this way, we sort of </span><span class="line" data-startTime="2604">have a way of, at runtime, </span><span class="line" data-startTime="2611">running this compiler over </span><span class="line" data-startTime="2611">some piece of JavaScript </span><span class="line" data-startTime="2614">written in the new syntax </span><span class="line" data-startTime="2614">and have it do something </span><span class="line" data-startTime="2616">in the old syntax. </span></p>

<p><span class="line" data-startTime="2617">So in this case &mdash; </span><span class="line" data-startTime="2628">I'm going to go grab something </span><span class="line" data-startTime="2628">out of the parameters, </span><span class="line" data-startTime="2631">and as you can see, it's </span><span class="line" data-startTime="2631">recompiling here, as I type. </span> <span class="line" data-startTime="2648">And now it has &mdash; </span><span class="line" data-startTime="2652">ah, yes, there we are. </span> <span class="line" data-startTime="2654">Now it's created </span><span class="line" data-startTime="2654">all of the stuff </span><span class="line" data-startTime="2656">that I was going to have </span><span class="line" data-startTime="2656">to write out by hand. </span> <span class="line" data-startTime="2658">It's just compiled that down </span><span class="line" data-startTime="2659">from the new syntax </span><span class="line" data-startTime="2659">to the old syntax, </span><span class="line" data-startTime="2661">and I can run it. </span> <span class="line" data-startTime="2664">I should be able to run it. </span> <span class="line" data-startTime="2667">man: </span><span class="line" data-startTime="2667">[indistinct comment] </span><span class="line" data-startTime="2673">Russell: </span><span class="line" data-startTime="2673">Ah, yes, good call. </span> <span class="line" data-startTime="2679">Great, there we go. </span></p>

<p><span class="line" data-startTime="2680">So this is a tool </span><span class="line" data-startTime="2680">that we're starting to use </span><span class="line" data-startTime="2685">to help inform </span><span class="line" data-startTime="2685">the language evolution </span><span class="line" data-startTime="2687">in order to help us </span><span class="line" data-startTime="2687">prototype stuff fast, </span><span class="line" data-startTime="2690">get feedback </span><span class="line" data-startTime="2690">about how it works, </span><span class="line" data-startTime="2691">and so we can </span><span class="line" data-startTime="2691">start to understand </span><span class="line" data-startTime="2693">how the new stuff that </span><span class="line" data-startTime="2693">we're adding into the language </span><span class="line" data-startTime="2695">fits with the old stuff </span><span class="line" data-startTime="2695">by writing real code in it. </span> <span class="line" data-startTime="2697">And as we work </span><span class="line" data-startTime="2697">in the standards committee </span><span class="line" data-startTime="2699">to help make this stuff reality, </span><span class="line" data-startTime="2699">this sort of tool, </span><span class="line" data-startTime="2702">I hope, is going to </span><span class="line" data-startTime="2702">make it possible for us </span><span class="line" data-startTime="2704">to evolve faster and evolve </span><span class="line" data-startTime="2704">in a straighter line </span><span class="line" data-startTime="2706">with the existing versions </span><span class="line" data-startTime="2706">of JavaScript, </span><span class="line" data-startTime="2709">because what we don't want </span><span class="line" data-startTime="2709">is for us </span><span class="line" data-startTime="2710">to add new things </span><span class="line" data-startTime="2710">like the idea of a class </span><span class="line" data-startTime="2713">and have it be at war with the </span><span class="line" data-startTime="2713">idea of prototypal inheritance </span><span class="line" data-startTime="2715">or functions </span><span class="line" data-startTime="2715">as first class objects. </span> <span class="line" data-startTime="2717">We want to continue to help you </span><span class="line" data-startTime="2717">build on these core fundamental, </span><span class="line" data-startTime="2721">really powerful building blocks </span><span class="line" data-startTime="2721">in the language </span><span class="line" data-startTime="2723">without introducing </span><span class="line" data-startTime="2723">new sorts of ideas or overhead </span><span class="line" data-startTime="2729">that you have to consider </span><span class="line" data-startTime="2729">when you're writing your code. </span></p>

<p><span class="line" data-startTime="2730">And so Traceur, again, </span><span class="line" data-startTime="2730">is an effort to help us </span><span class="line" data-startTime="2733">understand and experiment </span><span class="line" data-startTime="2733">with the language, </span><span class="line" data-startTime="2735">and it's available as an open </span><span class="line" data-startTime="2735">source project on Google Code. </span> <span class="line" data-startTime="2739">You can use it today, both on </span><span class="line" data-startTime="2739">the server and on the client, </span><span class="line" data-startTime="2741">and you can start </span><span class="line" data-startTime="2741">to play with it. </span> <span class="line" data-startTime="2743">You can start to write </span><span class="line" data-startTime="2743">real code in it. </span> <span class="line" data-startTime="2745">There's a read, evaluate, </span><span class="line" data-startTime="2745">and print loop </span><span class="line" data-startTime="2748">that you can just go to </span><span class="line" data-startTime="2748">and start typing code into. </span> <span class="line" data-startTime="2756">So I won't belabor </span><span class="line" data-startTime="2756">that anymore, </span><span class="line" data-startTime="2758">but what we're really hoping </span><span class="line" data-startTime="2758">for is that you can start to use </span><span class="line" data-startTime="2764">a lot of the new features that </span><span class="line" data-startTime="2764">we've started to play with. </span></p>

<p><span class="line" data-startTime="2766">We have a list of features that </span><span class="line" data-startTime="2766">we've implemented in Traceur, </span><span class="line" data-startTime="2769">and that's expanding every day. </span> <span class="line" data-startTime="2770">But things like modules, </span><span class="line" data-startTime="2770">classes, and traits, </span><span class="line" data-startTime="2772">asynchronous programming &mdash; </span><span class="line" data-startTime="2774">Asynchronous programming </span><span class="line" data-startTime="2774">is something we have to do </span><span class="line" data-startTime="2776">all the time, and we wind up </span><span class="line" data-startTime="2776">doing it with a callback system. </span> <span class="line" data-startTime="2777">It'd be great if </span><span class="line" data-startTime="2777">there was support for that </span><span class="line" data-startTime="2779">in a language that we didn't </span><span class="line" data-startTime="2779">have to continue to write </span><span class="line" data-startTime="2781">the same boilerplate </span><span class="line" data-startTime="2781">over and over and over again. </span> <span class="line" data-startTime="2783">Destructuring assignment, </span><span class="line" data-startTime="2783">like we just saw, </span><span class="line" data-startTime="2784">and the ability to use </span><span class="line" data-startTime="2784">the prototypal sort of style </span><span class="line" data-startTime="2787">of extension, </span><span class="line" data-startTime="2787">but have it happen in a way </span><span class="line" data-startTime="2789">that doesn't conflict </span><span class="line" data-startTime="2789">with everybody else's objects </span><span class="line" data-startTime="2791">in the system. </span></p>

<p><span class="line" data-startTime="2792">Those are the sorts of </span><span class="line" data-startTime="2792">high priority work items </span><span class="line" data-startTime="2794">that we're starting to use </span><span class="line" data-startTime="2794">Traceur to evaluate designs for, </span><span class="line" data-startTime="2798">and we'd love your help. </span> <span class="line" data-startTime="2800">We'd love for you to start </span><span class="line" data-startTime="2800">using it, testing it out, </span><span class="line" data-startTime="2802">working with the system, </span><span class="line" data-startTime="2802">and helping us write code </span><span class="line" data-startTime="2804">in the new style, </span><span class="line" data-startTime="2804">so we can understand </span><span class="line" data-startTime="2806">whether or not </span><span class="line" data-startTime="2806">it's actually good. </span> <span class="line" data-startTime="2808">So Traceur is one idea </span><span class="line" data-startTime="2808">to help us get there. </span> <span class="line" data-startTime="2812">We need implementations early </span><span class="line" data-startTime="2812">to inform the design process </span><span class="line" data-startTime="2814">for the future of the language, </span><span class="line" data-startTime="2814">so that the things that you do </span><span class="line" data-startTime="2817">in the language now </span><span class="line" data-startTime="2817">carry out into the future </span><span class="line" data-startTime="2820">as core idioms and core concepts </span><span class="line" data-startTime="2820">that you can rely on there, too. </span> <span class="line" data-startTime="2825">But we need those things </span><span class="line" data-startTime="2825">to eventually trickle down </span><span class="line" data-startTime="2827">into real, live implementations, </span><span class="line" data-startTime="2827">V8, other JavaScript engines, </span><span class="line" data-startTime="2830">and we want to make sure </span><span class="line" data-startTime="2830">that these things </span><span class="line" data-startTime="2832">are available to you quickly in </span><span class="line" data-startTime="2832">the fast-moving constituencies. </span> <span class="line" data-startTime="2835">So if you can start to use this </span><span class="line" data-startTime="2835">stuff in the Chrome Web Store &mdash; </span><span class="line" data-startTime="2838">because almost everyone in </span><span class="line" data-startTime="2838">the Chrome Web Store gets &mdash; </span><span class="line" data-startTime="2841">or who you can target </span><span class="line" data-startTime="2841">through the Chrome Web Store </span><span class="line" data-startTime="2843">gets the latest version </span><span class="line" data-startTime="2843">of Chrome within a week &mdash; </span><span class="line" data-startTime="2845">that's really good. </span></p>

<p><span class="line" data-startTime="2846">We can start to get fast </span><span class="line" data-startTime="2846">feedback in the language </span><span class="line" data-startTime="2848">and in the design of the </span><span class="line" data-startTime="2848">next version of JavaScript </span><span class="line" data-startTime="2851">based on your feedback </span><span class="line" data-startTime="2851">about what's working </span><span class="line" data-startTime="2853">and what's not in ways </span><span class="line" data-startTime="2853">that we couldn't before. </span> <span class="line" data-startTime="2856">The lead time on a new version </span><span class="line" data-startTime="2856">of the language has been years &mdash; </span><span class="line" data-startTime="2859">in some cases, </span><span class="line" data-startTime="2859">closer to a decade. </span> <span class="line" data-startTime="2862">And so you can follow along </span><span class="line" data-startTime="2862">the ECMAScript wiki. </span> <span class="line" data-startTime="2867">I realize this is &mdash; </span><span class="line" data-startTime="2867">the link </span><span class="line" data-startTime="2868">is a little bit long, </span><span class="line" data-startTime="2868">but there's a list </span><span class="line" data-startTime="2870">of accepted proposals for the </span><span class="line" data-startTime="2870">next version of the language. </span></p>

<p><span class="line" data-startTime="2871">That's going to be </span><span class="line" data-startTime="2871">somewhat formalized </span><span class="line" data-startTime="2873">in the next couple of months. </span> <span class="line" data-startTime="2874">And as that list </span><span class="line" data-startTime="2874">is locked down, </span><span class="line" data-startTime="2876">we're going to continue </span><span class="line" data-startTime="2876">to iterate on those proposals. </span> <span class="line" data-startTime="2878">They're going to get </span><span class="line" data-startTime="2878">new syntax. </span> <span class="line" data-startTime="2879">Things are going </span><span class="line" data-startTime="2879">to change there. </span> <span class="line" data-startTime="2881">But the list of things </span><span class="line" data-startTime="2881">that are in the proposal stage </span><span class="line" data-startTime="2882">for Harmony are the set </span><span class="line" data-startTime="2882">of things that we, </span><span class="line" data-startTime="2884">as a committee, </span><span class="line" data-startTime="2884">have agreed to go work on </span><span class="line" data-startTime="2886">and standardize together. </span> <span class="line" data-startTime="2887">And so Traceur </span><span class="line" data-startTime="2887">is going to continue </span><span class="line" data-startTime="2888">to follow that evolution </span><span class="line" data-startTime="2890">and allow us </span><span class="line" data-startTime="2890">to start to work in ways </span><span class="line" data-startTime="2892">that give us quick feedback </span><span class="line" data-startTime="2892">about whether or not </span><span class="line" data-startTime="2895">we're doing the right things </span><span class="line" data-startTime="2895">for you </span><span class="line" data-startTime="2897">as you're writing large </span><span class="line" data-startTime="2897">pieces of JavaScript. </span> <span class="line" data-startTime="2900">Okay, questions? </span><span class="line" data-startTime="2909">man: Hi. So the common JS </span><span class="line" data-startTime="2909">modules specification </span><span class="line" data-startTime="2913">has like a really simple </span><span class="line" data-startTime="2913">require and exports </span><span class="line" data-startTime="2917">that really doesn't &mdash; </span><span class="line" data-startTime="2917">that &mdash; it's kind of &mdash; </span><span class="line" data-startTime="2919">it doesn't factor in, </span><span class="line" data-startTime="2919">you know, </span><span class="line" data-startTime="2921">how things </span><span class="line" data-startTime="2921">get loaded or whatever. </span></p>

<p><span class="line" data-startTime="2922">It's really just a binding </span><span class="line" data-startTime="2922">mechanism between </span><span class="line" data-startTime="2924">disparate name space. </span> <span class="line" data-startTime="2926">That seems ultimately </span><span class="line" data-startTime="2926">simple to me, </span><span class="line" data-startTime="2927">but it doesn't seem like Harmony </span><span class="line" data-startTime="2927">is going in that direction. </span></p>

<p class="speaker"><span class="line" data-starttime="2930"><span class="speakerName">Russell</span>: So the simple </span><span class="line" data-startTime="2930">modules proposal </span><span class="line" data-startTime="2934">gives us a way </span><span class="line" data-startTime="2934">to have a first pass. </span> <span class="line" data-startTime="2937">So...sorry, I should run this </span><span class="line" data-startTime="2937">backwards. </span> <span class="line" data-startTime="2941">The common JS module system </span><span class="line" data-startTime="2941">sort of is implicitly server JS. </span> <span class="line" data-startTime="2947">You kind of assume that </span><span class="line" data-startTime="2947">the thing that you're getting </span><span class="line" data-startTime="2949">in the next statement </span><span class="line" data-startTime="2949">is cheap to fetch. </span> <span class="line" data-startTime="2951">And so what we need </span><span class="line" data-startTime="2951">for the client </span><span class="line" data-startTime="2952">is an ability to make the </span><span class="line" data-startTime="2952">require and provide statements </span><span class="line" data-startTime="2957">look apparently synchronous </span><span class="line" data-startTime="2957">but have them operate </span><span class="line" data-startTime="2959">asynchronously on the network, </span><span class="line" data-startTime="2959">which means that we want to get </span><span class="line" data-startTime="2962">the transitive closure </span><span class="line" data-startTime="2962">of all of the dependencies </span><span class="line" data-startTime="2964">that your module needs. </span> <span class="line" data-startTime="2966">man: Then you're kind of </span><span class="line" data-startTime="2966">mixing like load, </span><span class="line" data-startTime="2967">the loading and &mdash; </span><span class="line" data-startTime="2968">Russell: </span><span class="line" data-startTime="2968">They are mixed. </span> <span class="line" data-startTime="2969">There's no way </span><span class="line" data-startTime="2969">to unmix them. </span></p>

<p><span class="line" data-startTime="2970">Because of the way </span><span class="line" data-startTime="2970">that JavaScript evaluates </span><span class="line" data-startTime="2972">top to bottom, </span><span class="line" data-startTime="2972">we either have to &mdash; </span><span class="line" data-startTime="2974">and because </span><span class="line" data-startTime="2974">it runs on the UI thread, </span><span class="line" data-startTime="2975">we either have to block </span><span class="line" data-startTime="2975">the entire client </span><span class="line" data-startTime="2979">while we go fetch resources, </span><span class="line" data-startTime="2979">which is what happens </span><span class="line" data-startTime="2981">with the document.write, </span><span class="line" data-startTime="2981">that sort of thing &mdash; </span><span class="line" data-startTime="2983">man: Yeah, I see </span><span class="line" data-startTime="2983">what you're saying. </span> <span class="line" data-startTime="2984">Russell: </span><span class="line" data-startTime="2984">Or we have to find a way </span><span class="line" data-startTime="2985">to accommodate asynchronous </span><span class="line" data-startTime="2985">loading in the syntax, </span><span class="line" data-startTime="2988">and that's what the simple </span><span class="line" data-startTime="2988">module proposal does. </span> <span class="line" data-startTime="2989">man: </span><span class="line" data-startTime="2989">I see what you're saying. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="2990"><span class="speakerName">Russell</span>: Which is </span><span class="line" data-startTime="2990">fundamentally different, </span><span class="line" data-startTime="2992">because we can use syntax </span><span class="line" data-startTime="2992">to do that in a way </span><span class="line" data-startTime="2993">that common JS can't. </span><span class="line" data-startTime="2995">man: Yeah, I use a system where </span><span class="line" data-startTime="2995">I kind of &mdash; you use common JS </span><span class="line" data-startTime="2997">on the client, but I don't &mdash; </span><span class="line" data-startTime="2997">I allow for, like, </span><span class="line" data-startTime="3002">forward references. </span></p>

<p class="speaker"><span class="line" data-starttime="3002"><span class="speakerName">Russell</span>: Right. </span><span class="line" data-startTime="3003">man: So like, those things, </span><span class="line" data-startTime="3003">they get resolved </span><span class="line" data-startTime="3005">at a later time, </span><span class="line" data-startTime="3006">so you can't kind of use them </span><span class="line" data-startTime="3006">completely until later. </span></p>

<p class="speaker"><span class="line" data-starttime="3010"><span class="speakerName">Russell</span>: Yeah, I'm really </span><span class="line" data-startTime="3010">hopeful that we can get </span><span class="line" data-startTime="3011">the semantic that Dave Herman </span><span class="line" data-startTime="3011">has put forward, </span><span class="line" data-startTime="3013">because it really does give us </span><span class="line" data-startTime="3013">the power to not force you </span><span class="line" data-startTime="3016">to think about when your code </span><span class="line" data-startTime="3016">is going to run. </span> <span class="line" data-startTime="3017">If you say require in one line, </span><span class="line" data-startTime="3017">you can use it in the next one, </span><span class="line" data-startTime="3020">and I think that's </span><span class="line" data-startTime="3020">a key usability feature </span><span class="line" data-startTime="3023">of a language improvement </span><span class="line" data-startTime="3023">in this area. </span> <span class="line" data-startTime="3027">man: </span><span class="line" data-startTime="3027">Question. On the last slide, </span><span class="line" data-startTime="3029">one of the things you mentioned </span><span class="line" data-startTime="3029">was asynchronous programming </span><span class="line" data-startTime="3031">with JavaScript. </span> <span class="line" data-startTime="3032">And, you know, like Node JS </span><span class="line" data-startTime="3032">is one of the new frameworks. </span> <span class="line" data-startTime="3036">I'm wondering if you can talk </span><span class="line" data-startTime="3036">a little bit about </span><span class="line" data-startTime="3038">some best practices for </span><span class="line" data-startTime="3038">how to handle error conditions </span><span class="line" data-startTime="3041">or exceptions when you're </span><span class="line" data-startTime="3041">doing an asynchronous call </span><span class="line" data-startTime="3045">that may not be </span><span class="line" data-startTime="3045">in the same call stack </span><span class="line" data-startTime="3047">as when you actually </span><span class="line" data-startTime="3047">executed the call. </span></p>

<p><span class="line" data-startTime="3049">Russell: </span><span class="line" data-startTime="3049">So this is a hot topic. </span> <span class="line" data-startTime="3052">The asynchronous pattern </span><span class="line" data-startTime="3052">that seems to have won </span><span class="line" data-startTime="3056">the most mindshare is something </span><span class="line" data-startTime="3056">like deferreds or promises. </span> <span class="line" data-startTime="3059">Again, the common JS guys </span><span class="line" data-startTime="3059">have done great work there. </span> <span class="line" data-startTime="3062">And so those systems </span><span class="line" data-startTime="3062">tend to have some error </span><span class="line" data-startTime="3066">handling callback </span><span class="line" data-startTime="3066">that you can register, </span><span class="line" data-startTime="3070">so that if an error does occur, </span><span class="line" data-startTime="3070">you can be notified of it. </span> <span class="line" data-startTime="3073">I actually was talking with </span><span class="line" data-startTime="3073">the Node JS guys just last week </span><span class="line" data-startTime="3076">in Portland about exactly </span><span class="line" data-startTime="3076">how they want to do this, </span><span class="line" data-startTime="3079">because I'm hopeful </span><span class="line" data-startTime="3079">that what we can do </span><span class="line" data-startTime="3081">is build on top of built-in </span><span class="line" data-startTime="3081">language deferred </span><span class="line" data-startTime="3085">or promise API, </span><span class="line" data-startTime="3085">the ability to use the weight </span><span class="line" data-startTime="3088">or async keywords to go help </span><span class="line" data-startTime="3088">mark particular methods </span><span class="line" data-startTime="3091">of returning </span><span class="line" data-startTime="3091">these deferred objects, </span><span class="line" data-startTime="3092">but error handling does turn </span><span class="line" data-startTime="3092">into a primary question then. </span></p>

<p><span class="line" data-startTime="3096">So what they came to, </span><span class="line" data-startTime="3099">and I think </span><span class="line" data-startTime="3099">it's a pretty good answer, </span><span class="line" data-startTime="3101">is that you have </span><span class="line" data-startTime="3101">a single callback, right? </span><span class="line" data-startTime="3103">And that needs to be </span><span class="line" data-startTime="3103">also informed of errors. </span> <span class="line" data-startTime="3106">But you can have </span><span class="line" data-startTime="3106">an optional second callback, </span><span class="line" data-startTime="3108">which will be told </span><span class="line" data-startTime="3108">about error conditions </span><span class="line" data-startTime="3111">if you choose to handle them </span><span class="line" data-startTime="3111">independently. </span> <span class="line" data-startTime="3113">And I think, </span><span class="line" data-startTime="3113">you know, the idea </span><span class="line" data-startTime="3115">that you're not going </span><span class="line" data-startTime="3115">to have to deal with errors </span><span class="line" data-startTime="3116">in the primary callback </span><span class="line" data-startTime="3118">is a little bit farfetched, </span><span class="line" data-startTime="3119">and so I think that's maybe </span><span class="line" data-startTime="3119">a good trade-off. </span> <span class="line" data-startTime="3121">But it is an open topic. </span></p>

<p><span class="line" data-startTime="3124">We probably need </span><span class="line" data-startTime="3124">language level support </span><span class="line" data-startTime="3127">for sort of moving </span><span class="line" data-startTime="3127">stack traces. </span> <span class="line" data-startTime="3130">Like, if I throw in one catch </span><span class="line" data-startTime="3130">here and then re-throw </span><span class="line" data-startTime="3134">the exception someplace else, </span><span class="line" data-startTime="3134">we need some VM </span><span class="line" data-startTime="3136">or language level support </span><span class="line" data-startTime="3136">to help us make that reporting </span><span class="line" data-startTime="3139">cleaner and nicer. </span> <span class="line" data-startTime="3141">And I think </span><span class="line" data-startTime="3141">that's another important area </span><span class="line" data-startTime="3143">that we might be able to help </span><span class="line" data-startTime="3143">tie these things back together, </span><span class="line" data-startTime="3147">once we go async. </span> <span class="line" data-startTime="3147">man: Okay, great. </span> <span class="line" data-startTime="3150">man: Hi, I just wanted to know </span><span class="line" data-startTime="3150">if there was any interest </span><span class="line" data-startTime="3153">or effort within Google </span><span class="line" data-startTime="3153">to do some more of the more </span><span class="line" data-startTime="3159">server side JavaScript, </span><span class="line" data-startTime="3159">stuff like Node JS, </span><span class="line" data-startTime="3161">and maybe any possibility </span><span class="line" data-startTime="3161">of ever having that available </span><span class="line" data-startTime="3165">like on App Engine. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="3166"><span class="speakerName">Russell</span>: I can't speak </span><span class="line" data-startTime="3166">to future product plans, </span><span class="line" data-startTime="3168">but I can say that the VA team </span><span class="line" data-startTime="3168">is working closely </span><span class="line" data-startTime="3170">with the Node team to continue </span><span class="line" data-startTime="3170">to make Node faster. </span><span class="line" data-startTime="3174">We care a lot about </span><span class="line" data-startTime="3174">their use cases, </span><span class="line" data-startTime="3176">and we want to make sure </span><span class="line" data-startTime="3176">that we're supporting them. </span><span class="line" data-startTime="3180">man: So looking at the Traceur </span><span class="line" data-startTime="3180">function and the no sugar, </span><span class="line" data-startTime="3184">de-sugaring, in Lisp, </span><span class="line" data-startTime="3184">this was done </span><span class="line" data-startTime="3187">because they had </span><span class="line" data-startTime="3187">a powerful macro facility, </span><span class="line" data-startTime="3190">so that the developer could </span><span class="line" data-startTime="3190">actually introduce new syntax </span><span class="line" data-startTime="3192">into their programs and define </span><span class="line" data-startTime="3192">the behaviors in Lisp. </span><span class="line" data-startTime="3196">Is there any thought of </span><span class="line" data-startTime="3196">doing something like that </span><span class="line" data-startTime="3198">in JavaScript? </span></p>

<p class="speaker"><span class="line" data-starttime="3199"><span class="speakerName">Russell</span>: We have a hard time </span><span class="line" data-startTime="3199">with that in JavaScript, </span><span class="line" data-startTime="3201">because we have both statements </span><span class="line" data-startTime="3201">and expressions, </span><span class="line" data-startTime="3203">and we have, you know, </span><span class="line" data-startTime="3206">a lot of complex grammar </span><span class="line" data-startTime="3206">that's not movable. </span> <span class="line" data-startTime="3210">And as a result, </span><span class="line" data-startTime="3210">any macro facility </span><span class="line" data-startTime="3212">is going to quickly </span><span class="line" data-startTime="3212">become undecidable. </span> <span class="line" data-startTime="3214">And so I think </span><span class="line" data-startTime="3214">we're in a place where macros, </span><span class="line" data-startTime="3217">the way I think you want them, </span><span class="line" data-startTime="3217">aren't possible </span><span class="line" data-startTime="3220">in JavaScript. </span> <span class="line" data-startTime="3221">New syntax, specifically, </span><span class="line" data-startTime="3223">is going to have to continue </span><span class="line" data-startTime="3223">to happen through the committee. </span> <span class="line" data-startTime="3228">So I think there are places </span><span class="line" data-startTime="3230">where we can carve out </span><span class="line" data-startTime="3230">some stuff. </span></p>

<p><span class="line" data-startTime="3232">There's been some good work </span><span class="line" data-startTime="3232">in string formatting, </span><span class="line" data-startTime="3235">for instance, to make it </span><span class="line" data-startTime="3235">possible to plug in &mdash; </span><span class="line" data-startTime="3237">through protocols &mdash; some new </span><span class="line" data-startTime="3237">behavior into existing syntax, </span><span class="line" data-startTime="3241">and I think that's maybe </span><span class="line" data-startTime="3241">the promising way forward. </span> <span class="line" data-startTime="3243">man: Yeah. </span> <span class="line" data-startTime="3246">man: So did you know </span><span class="line" data-startTime="3246">that you can build Firefox </span><span class="line" data-startTime="3249">with support for Python </span><span class="line" data-startTime="3249">as a scripting language? </span><span class="line" data-startTime="3253">Russell: </span><span class="line" data-startTime="3253">I've heard tell of this, </span><span class="line" data-startTime="3254">but it's been that way </span><span class="line" data-startTime="3254">for many years, as I recall. </span> <span class="line" data-startTime="3256">man: Yes, debug build </span><span class="line" data-startTime="3256">with Firefox comes with it. </span> <span class="line" data-startTime="3259">More seriously, </span><span class="line" data-startTime="3259">what do you think of GWT </span><span class="line" data-startTime="3261">or more usefully Pyjamas </span><span class="line" data-startTime="3261">as actual development platforms </span><span class="line" data-startTime="3267">instead of writing </span><span class="line" data-startTime="3267">direct JavaScript, </span><span class="line" data-startTime="3270">and using the richer type system </span><span class="line" data-startTime="3270">of Python or Java </span><span class="line" data-startTime="3276">instead of the bare bones one </span><span class="line" data-startTime="3276">in JavaScript? </span></p>

<p class="speaker"><span class="line" data-starttime="3278"><span class="speakerName">Russell</span>: Type systems </span><span class="line" data-startTime="3278">are really great. </span> <span class="line" data-startTime="3280">I think that it's a key </span><span class="line" data-startTime="3280">missing feature from JavaScript </span><span class="line" data-startTime="3284">specifically because what </span><span class="line" data-startTime="3284">you wind up writing, again, </span><span class="line" data-startTime="3285">is a lot of boilerplate </span><span class="line" data-startTime="3285">to help you test </span><span class="line" data-startTime="3287">whether or not you were actually </span><span class="line" data-startTime="3287">tall enough to ride the ride. </span> <span class="line" data-startTime="3290">You actually have to </span><span class="line" data-startTime="3290">sort of go cart around </span><span class="line" data-startTime="3292">a lot of this </span><span class="line" data-startTime="3292">testing magic. </span> <span class="line" data-startTime="3293">I'm not hopeful </span><span class="line" data-startTime="3293">for type systems. </span></p>

<p><span class="line" data-startTime="3295">This is my personal opinion. </span> <span class="line" data-startTime="3296">I'm not hopeful for type systems </span><span class="line" data-startTime="3296">as a be all and end all </span><span class="line" data-startTime="3299">sort of verification system </span><span class="line" data-startTime="3299">for your program. </span> <span class="line" data-startTime="3302">The web is too dynamic. </span> <span class="line" data-startTime="3303">Client-side programs </span><span class="line" data-startTime="3303">are too dynamic for that. </span> <span class="line" data-startTime="3305">We're dealing with </span><span class="line" data-startTime="3305">user behavior a lot. </span> <span class="line" data-startTime="3307">Instead, what I'd like for us </span><span class="line" data-startTime="3307">to get to is a place </span><span class="line" data-startTime="3310">where the syntactic warts </span><span class="line" data-startTime="3310">of JavaScript sort of get </span><span class="line" data-startTime="3314">eased over one way </span><span class="line" data-startTime="3314">or the other. </span> <span class="line" data-startTime="3315">Things like CoffeeScript </span><span class="line" data-startTime="3316">are pointing </span><span class="line" data-startTime="3316">in a good direction here, </span><span class="line" data-startTime="3318">where you can sort of come </span><span class="line" data-startTime="3318">back up with some new syntax, </span><span class="line" data-startTime="3322">and hopefully that'll </span><span class="line" data-startTime="3322">eventually work its way </span><span class="line" data-startTime="3324">into the language. </span> <span class="line" data-startTime="3325">But things like </span><span class="line" data-startTime="3325">the module that are &mdash; </span><span class="line" data-startTime="3327">they're going to have </span><span class="line" data-startTime="3327">an analogous API, again, </span><span class="line" data-startTime="3329">building a protocol that you can </span><span class="line" data-startTime="3329">plug into with your own code, </span><span class="line" data-startTime="3332">and that API will allow you </span><span class="line" data-startTime="3332">to do things like run </span><span class="line" data-startTime="3335">the CoffeeScript compiler </span><span class="line" data-startTime="3335">or the Pyjamas compiler </span><span class="line" data-startTime="3337">across loaded modules </span><span class="line" data-startTime="3337">before they're run, </span><span class="line" data-startTime="3340">which means that you can </span><span class="line" data-startTime="3340">sort of have runtime support </span><span class="line" data-startTime="3342">for those built-in. </span></p>

<p><span class="line" data-startTime="3345">I think the &mdash; you asked a </span><span class="line" data-startTime="3345">question </span><span class="line" data-startTime="3346">of what do I think about </span><span class="line" data-startTime="3347">those tools as a way to do </span><span class="line" data-startTime="3347">production work. </span> <span class="line" data-startTime="3351">If your language veers far </span><span class="line" data-startTime="3351">enough from the core semantics </span><span class="line" data-startTime="3354">of JavaScript, you wind up </span><span class="line" data-startTime="3354">not just with the ability </span><span class="line" data-startTime="3357">to do all sorts of tooling </span><span class="line" data-startTime="3357">and stuff that comes along </span><span class="line" data-startTime="3359">with your source language, </span><span class="line" data-startTime="3359">but you also wind up with </span><span class="line" data-startTime="3362">the need for the runtime </span><span class="line" data-startTime="3362">to do dead code edition. </span> <span class="line" data-startTime="3366">You need to go and sort of </span><span class="line" data-startTime="3366">not just do a one-for-one </span><span class="line" data-startTime="3371">translation down to the </span><span class="line" data-startTime="3371">analogous statements </span><span class="line" data-startTime="3373">in the other language, </span><span class="line" data-startTime="3373">but you have to make sure </span><span class="line" data-startTime="3374">that the semantics are right. </span> <span class="line" data-startTime="3376">You have to make sure </span><span class="line" data-startTime="3376">that you have code in there </span><span class="line" data-startTime="3377">to support any differences, </span><span class="line" data-startTime="3377">any impotence mismatches </span><span class="line" data-startTime="3380">between the two languages. </span> <span class="line" data-startTime="3381">And so I'm much more hopeful </span><span class="line" data-startTime="3383">about things like CoffeeScript </span><span class="line" data-startTime="3383">and the Traceur editions </span><span class="line" data-startTime="3387">because they don't add </span><span class="line" data-startTime="3387">a lot of extra stuff, </span><span class="line" data-startTime="3390">because the languages </span><span class="line" data-startTime="3390">aren't that far away </span><span class="line" data-startTime="3391">in terms of core semantic. </span></p>

<p><span class="line" data-startTime="3393">man: All right, </span><span class="line" data-startTime="3393">thank you. </span> <span class="line" data-startTime="3395">man: Hi, one kind of application </span><span class="line" data-startTime="3395">domain that could benefit </span><span class="line" data-startTime="3398">from scripting </span><span class="line" data-startTime="3398">that's not really &mdash; </span><span class="line" data-startTime="3401">doesn't have a solution today </span><span class="line" data-startTime="3401">is a native Android app. </span> <span class="line" data-startTime="3405">So I wonder if there are any &mdash; </span><span class="line" data-startTime="3406">we've dabbled with, </span><span class="line" data-startTime="3406">you know, plug-in Rhino </span><span class="line" data-startTime="3407">and things like that. </span> <span class="line" data-startTime="3409">I wonder if there's any activity </span><span class="line" data-startTime="3409">in that area right now. </span></p>

<p class="speaker"><span class="line" data-starttime="3412"><span class="speakerName">Russell</span>: I think you'd have </span><span class="line" data-startTime="3412">to ask the Android team. </span><span class="line" data-startTime="3414">I'm sorry, I'm not up-to-date </span><span class="line" data-startTime="3414">on what they're doing there. </span><span class="line" data-startTime="3415">man: Okay. </span></p>

<p class="speaker"><span class="line" data-starttime="3415"><span class="speakerName">Russell</span>: Thanks. </span><span class="line" data-startTime="3418">man: </span><span class="line" data-startTime="3418">I had another question. </span><span class="line" data-startTime="3419">So in my Python programs, </span><span class="line" data-startTime="3419">I like to use sometimes </span><span class="line" data-startTime="3424">multiple inheritance, </span><span class="line" data-startTime="3424">and I have complex &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="3427"><span class="speakerName">Russell</span>: C3MRO, </span><span class="line" data-startTime="3427">right, yeah. </span><span class="line" data-startTime="3428">man: Dependency graphs </span><span class="line" data-startTime="3428">and so on, yeah. </span><span class="line" data-startTime="3430">So and they have a method </span><span class="line" data-startTime="3430">resolution order in Python </span><span class="line" data-startTime="3434">that allows you to call </span><span class="line" data-startTime="3434">the super classes methods, </span><span class="line" data-startTime="3437">you know, exactly once </span><span class="line" data-startTime="3437">in the right order, and &mdash; </span><span class="line" data-startTime="3439">or at least </span><span class="line" data-startTime="3439">a well-defined order. </span><span class="line" data-startTime="3442">Is anything going on in Harmony </span><span class="line" data-startTime="3442">for allowing for something </span><span class="line" data-startTime="3446">like an MRO type </span><span class="line" data-startTime="3446">call graph resolution? </span></p>

<p class="speaker"><span class="line" data-starttime="3450"><span class="speakerName">Russell</span>: I don't think </span><span class="line" data-startTime="3450">we're going to break the idea </span><span class="line" data-startTime="3453">of a single prototype. </span><span class="line" data-startTime="3453">man: Right. </span></p>

<p class="speaker"><span class="line" data-starttime="3455"><span class="speakerName">Russell</span>: So the analogous </span><span class="line" data-startTime="3455">thing here would be </span><span class="line" data-startTime="3457">multi prototype languages. </span> <span class="line" data-startTime="3459">I'm hopeful </span><span class="line" data-startTime="3459">that what we'll get done </span><span class="line" data-startTime="3460">is something like </span><span class="line" data-startTime="3460">Tom Van Cutsem's </span><span class="line" data-startTime="3462">Traits semantic, </span><span class="line" data-startTime="3464">where we can add </span><span class="line" data-startTime="3464">a syntax for defining </span><span class="line" data-startTime="3466">a set of things </span><span class="line" data-startTime="3466">that you would sort of &mdash; </span><span class="line" data-startTime="3469">like we did with mix-ins, </span><span class="line" data-startTime="3469">add to the class, </span><span class="line" data-startTime="3471">and then do conflict resolution </span><span class="line" data-startTime="3471">with syntax. </span> <span class="line" data-startTime="3474">Because what you're trying to </span><span class="line" data-startTime="3474">say in a lot of these cases </span><span class="line" data-startTime="3476">isn't, I'd like for you </span><span class="line" data-startTime="3476">to sort of decide for me </span><span class="line" data-startTime="3478">which of these things </span><span class="line" data-startTime="3478">I am at runtime. </span></p>

<p><span class="line" data-startTime="3480">It's not really a &mdash; </span><span class="line" data-startTime="3480">an "is a" relationship. </span> <span class="line" data-startTime="3482">It's sort of a "has a" </span><span class="line" data-startTime="3482">relationship, </span><span class="line" data-startTime="3483">what you're saying. </span> <span class="line" data-startTime="3484">I'd like this new behavior </span><span class="line" data-startTime="3485">to also be available </span><span class="line" data-startTime="3485">to my object. </span> <span class="line" data-startTime="3487">And if you can factor </span><span class="line" data-startTime="3487">those things out, </span><span class="line" data-startTime="3489">it can help with composability </span><span class="line" data-startTime="3489">and then eventually </span><span class="line" data-startTime="3491">with type testing. </span> <span class="line" data-startTime="3492">And I think Traits are where, </span><span class="line" data-startTime="3492">at least I'm hopeful, </span><span class="line" data-startTime="3495">that we'll go </span><span class="line" data-startTime="3495">to make a lot of that easier. </span> <span class="line" data-startTime="3498">man: Yeah, I use a wrapper </span><span class="line" data-startTime="3498">where like I kind of </span><span class="line" data-startTime="3500">build a copy of </span><span class="line" data-startTime="3500">a well-defined prototype chain, </span><span class="line" data-startTime="3503">specifically for this </span><span class="line" data-startTime="3503">particular set of mix-ins, </span><span class="line" data-startTime="3506">and so like </span><span class="line" data-startTime="3506">you can kind of emulate, </span><span class="line" data-startTime="3508">you know, </span><span class="line" data-startTime="3508">by specifically listing </span><span class="line" data-startTime="3509">the order in which you want </span><span class="line" data-startTime="3509">things to be resolved </span><span class="line" data-startTime="3513">and kind of get the behavior </span><span class="line" data-startTime="3513">for that in JavaScript. </span></p>

<p><span class="line" data-startTime="3519">man: Mainly curious, do you know </span><span class="line" data-startTime="3519">whether Traceur shares </span><span class="line" data-startTime="3522">common lineage with </span><span class="line" data-startTime="3522">the cross interpreter </span><span class="line" data-startTime="3524">in Google Widget Toolkit? </span></p>

<p class="speaker"><span class="line" data-starttime="3527"><span class="speakerName">Russell</span>: The Traceur code base </span><span class="line" data-startTime="3527">is brand-new. </span><span class="line" data-startTime="3528">It's a, you know, </span><span class="line" data-startTime="3531">a new client-side compiler </span><span class="line" data-startTime="3531">that we wrote, </span><span class="line" data-startTime="3535">hand-built parser, </span><span class="line" data-startTime="3535">that sort of thing. </span><span class="line" data-startTime="3539">man: Thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="3539"><span class="speakerName">Russell</span>: Yeah. </span> <span class="line" data-startTime="3543">All right, one more. </span> <span class="line" data-startTime="3543">All right. </span> <span class="line" data-startTime="3546">man: </span><span class="line" data-startTime="3546">So I'm a C# developer, </span><span class="line" data-startTime="3548">and I've stayed away from </span><span class="line" data-startTime="3548">JavaScript for a very long time, </span><span class="line" data-startTime="3553">mostly because I didn't &mdash; </span><span class="line" data-startTime="3553">I knew the what, </span><span class="line" data-startTime="3555">but I didn't know the why, </span><span class="line" data-startTime="3555">and that's been really good </span><span class="line" data-startTime="3558">in today's session. </span> <span class="line" data-startTime="3561">I'd like to continue </span><span class="line" data-startTime="3561">exploring. </span> <span class="line" data-startTime="3564">Can you recommend any reading &mdash; </span><span class="line" data-startTime="3564">specific reading material? </span><span class="line" data-startTime="3567">Because, of course, I could </span><span class="line" data-startTime="3567">always do a Google search. </span> <span class="line" data-startTime="3569">Russell: </span><span class="line" data-startTime="3569">Yeah. </span></p>

<p><span class="line" data-startTime="3571">man: But that would continue </span><span class="line" data-startTime="3571">along the path of not just </span><span class="line" data-startTime="3573">the what but the why also. </span> <span class="line" data-startTime="3575">Russell: </span><span class="line" data-startTime="3575">The latest version </span><span class="line" data-startTime="3576">of "JavaScript, the Definitive </span><span class="line" data-startTime="3576">Guide" is pretty good. </span> <span class="line" data-startTime="3579">I recommend </span><span class="line" data-startTime="3579">"Eloquent JavaScript." </span><span class="line" data-startTime="3582">It does a great job of sort of </span><span class="line" data-startTime="3582">introducing these core concepts </span><span class="line" data-startTime="3584">and getting you through not just </span><span class="line" data-startTime="3584">sort of what you can do. </span> <span class="line" data-startTime="3588">I didn't talk a lot </span><span class="line" data-startTime="3588">about how DOM interacts </span><span class="line" data-startTime="3590">with all of these things. </span> <span class="line" data-startTime="3593">My recommendation </span><span class="line" data-startTime="3593">is that you find someplace </span><span class="line" data-startTime="3597">to start playing with a language </span><span class="line" data-startTime="3597">that's not a web browser. </span></p>

<p><span class="line" data-startTime="3599">I mean, web browsers </span><span class="line" data-startTime="3599">are really handy. </span> <span class="line" data-startTime="3601">You can start to sort of like </span><span class="line" data-startTime="3601">make this all happen. </span> <span class="line" data-startTime="3603">But if you just sort of play </span><span class="line" data-startTime="3603">with the command line </span><span class="line" data-startTime="3605">in the browser or start to work </span><span class="line" data-startTime="3605">with a local copy of V8 </span><span class="line" data-startTime="3609">or Node JS, </span><span class="line" data-startTime="3609">you can really get a feel </span><span class="line" data-startTime="3611">for what's in the language </span><span class="line" data-startTime="3611">and what's not in the browser. </span> <span class="line" data-startTime="3613">JavaScript takes &mdash; in almost </span><span class="line" data-startTime="3613">every environment, </span><span class="line" data-startTime="3615">it takes a lot of its identity </span><span class="line" data-startTime="3615">from the standard library </span><span class="line" data-startTime="3618">that sort of </span><span class="line" data-startTime="3618">it's been wedded to. </span> <span class="line" data-startTime="3620">And in most cases, </span><span class="line" data-startTime="3621">because it has </span><span class="line" data-startTime="3621">a very small standard library, </span><span class="line" data-startTime="3622">all of that is in </span><span class="line" data-startTime="3622">the environment. </span> <span class="line" data-startTime="3624">And so the more you can sort of </span><span class="line" data-startTime="3624">remove those potential hurdles </span><span class="line" data-startTime="3628">or sort of impotence mismatches </span><span class="line" data-startTime="3629">with what's just </span><span class="line" data-startTime="3629">in the language, </span><span class="line" data-startTime="3631">I think the faster </span><span class="line" data-startTime="3631">it'll help you learn it. </span> <span class="line" data-startTime="3634">Yeah. </span></p>

<p><span class="line" data-startTime="3635">man: Actually, </span><span class="line" data-startTime="3635">in a similar situation </span><span class="line" data-startTime="3638">as the previous question, </span><span class="line" data-startTime="3638">which is I stayed away </span><span class="line" data-startTime="3640">from JavaScript </span><span class="line" data-startTime="3640">for a number of reasons. </span> <span class="line" data-startTime="3643">Probably </span><span class="line" data-startTime="3643">one of the biggest ones </span><span class="line" data-startTime="3644">was the lack of debug support. </span></p>

<p class="speaker"><span class="line" data-starttime="3644"><span class="speakerName">Russell</span>: Mm-hmm. </span><span class="line" data-startTime="3647">man: And the fact that you have </span><span class="line" data-startTime="3647">unexpected surprises, </span><span class="line" data-startTime="3652">like being able to overload </span><span class="line" data-startTime="3652">the array constructor, </span><span class="line" data-startTime="3656">that lend itself to, </span><span class="line" data-startTime="3656">you know, security holes, </span><span class="line" data-startTime="3659">whereas someone coming </span><span class="line" data-startTime="3659">from another language </span><span class="line" data-startTime="3661">isn't expecting that, </span><span class="line" data-startTime="3661">and they don't even consider </span><span class="line" data-startTime="3664">that as a possibility </span><span class="line" data-startTime="3664">when you're looking at code. </span><span class="line" data-startTime="3666">So specifically, is there </span><span class="line" data-startTime="3666">anything that's talked about </span><span class="line" data-startTime="3669">being added, where &mdash; </span><span class="line" data-startTime="3669">when you talk about modules, </span><span class="line" data-startTime="3673">that the module can set up </span><span class="line" data-startTime="3673">certainly like preconditions? </span><span class="line" data-startTime="3676">I'm expecting these sets </span><span class="line" data-startTime="3676">of things to be true, </span><span class="line" data-startTime="3679">like the array constructor </span><span class="line" data-startTime="3679">cannot be overloaded, </span><span class="line" data-startTime="3682">or anything else </span><span class="line" data-startTime="3682">where you can say, flag, </span><span class="line" data-startTime="3686">this is going to be a problem </span><span class="line" data-startTime="3686">or not going to run right. </span></p>

<p class="speaker"><span class="line" data-starttime="3689"><span class="speakerName">Russell</span>: So one of the big </span><span class="line" data-startTime="3689">things that's happening </span><span class="line" data-startTime="3691">with the module syntax </span><span class="line" data-startTime="3691">is that we're removing </span><span class="line" data-startTime="3693">the ability to share globals, </span><span class="line" data-startTime="3693">so you won't have </span><span class="line" data-startTime="3696">a single shared global, </span><span class="line" data-startTime="3696">which is going to be big, </span><span class="line" data-startTime="3699">to prevent people from sort of </span><span class="line" data-startTime="3699">blowing your own legs off. </span> <span class="line" data-startTime="3701">The other thing </span><span class="line" data-startTime="3701">is that ECMAScript 5, </span><span class="line" data-startTime="3704">the version that was just </span><span class="line" data-startTime="3704">recently ratified, </span><span class="line" data-startTime="3707">implements what we call </span><span class="line" data-startTime="3707">a strict mode. </span> <span class="line" data-startTime="3710">And strict mode turns off </span><span class="line" data-startTime="3710">some of the worst foot guns. </span> <span class="line" data-startTime="3712">It helps keep you out of trouble </span><span class="line" data-startTime="3712">by giving you more and more </span><span class="line" data-startTime="3719">pre-checking for things </span><span class="line" data-startTime="3719">like uninitialized variables, </span><span class="line" data-startTime="3722">that sort of thing, </span><span class="line" data-startTime="3722">where it keeps you from </span><span class="line" data-startTime="3724">sort of tripping over yourself </span><span class="line" data-startTime="3724">in some pretty common areas. </span> <span class="line" data-startTime="3727">It's not perfect, </span><span class="line" data-startTime="3727">but it's certainly a start. </span> <span class="line" data-startTime="3730">So use strict inside </span><span class="line" data-startTime="3730">of all of your functions, </span><span class="line" data-startTime="3731">and you should be good to go. </span></p>

<p><span class="line" data-startTime="3733">man: And what about the idea </span><span class="line" data-startTime="3733">of like official debug support? </span></p>

<p class="speaker"><span class="line" data-starttime="3737"><span class="speakerName">Russell</span>: So that's </span><span class="line" data-startTime="3737">an engine-by-engine thing. </span> <span class="line" data-startTime="3740">The topic of common stack traces </span><span class="line" data-startTime="3740">has been raised </span><span class="line" data-startTime="3746">a bunch of times, and it's </span><span class="line" data-startTime="3746">going to be very difficult, </span><span class="line" data-startTime="3748">because that constrains </span><span class="line" data-startTime="3748">our ability to optimize. </span> <span class="line" data-startTime="3750">So things like </span><span class="line" data-startTime="3750">alighting away dead code, </span><span class="line" data-startTime="3753">those are the sorts of things </span><span class="line" data-startTime="3753">that are going to be hard to do </span><span class="line" data-startTime="3755">if we have to agree </span><span class="line" data-startTime="3755">on a stack trace format. </span> <span class="line" data-startTime="3757">So what we do have is </span><span class="line" data-startTime="3757">really good support, </span><span class="line" data-startTime="3759">say, in the Chrome web inspector </span><span class="line" data-startTime="3759">for setting breakpoints, </span><span class="line" data-startTime="3763">future breakpoints, </span><span class="line" data-startTime="3763">getting call stacks, </span><span class="line" data-startTime="3766">and soon the ability to </span><span class="line" data-startTime="3766">sort of wire up line numbers </span><span class="line" data-startTime="3770">to source code. </span> <span class="line" data-startTime="3771">So yeah, debugability </span><span class="line" data-startTime="3771">is a hot topic. </span> <span class="line" data-startTime="3773">It tends to happen </span><span class="line" data-startTime="3773">through the browser </span><span class="line" data-startTime="3775">and not through </span><span class="line" data-startTime="3775">the language runtime. </span></p>

<p><span class="line" data-startTime="3777">man: </span><span class="line" data-startTime="3777">[indistinct] </span></p>

<p class="speaker"><span class="line" data-starttime="3781"><span class="speakerName">Russell</span>: So the question was </span><span class="line" data-startTime="3781">will a closure compiler </span><span class="line" data-startTime="3783">help with the debugability. </span><span class="line" data-startTime="3783">If the closure compiler has &mdash; </span><span class="line" data-startTime="3785">man: </span><span class="line" data-startTime="3785">[indistinct] </span></p>

<p class="speaker"><span class="line" data-starttime="3788"><span class="speakerName">Russell</span>: Oh, will the closure </span><span class="line" data-startTime="3788">compiler help beginners? </span><span class="line" data-startTime="3791">No. It's designed </span><span class="line" data-startTime="3791">to help folks who know </span><span class="line" data-startTime="3795">that they have a problem </span><span class="line" data-startTime="3795">avoid having problems. </span><span class="line" data-startTime="3797">Okay, cool. </span><span class="line" data-startTime="3799">Thanks again for coming, </span><span class="line" data-startTime="3799">and I'm looking forward to it. </span></p>