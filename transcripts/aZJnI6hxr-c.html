<p class="speaker"><span class="line" data-starttime="1"><span class="speakerName">Brendan Kenny</span>: So </span><span class="line" data-startTime="1">good morning. </span> <span class="line" data-startTime="4">My name is Brendan Kenny. </span> <span class="line" data-startTime="5">I'm an engineer with the Maps </span><span class="line" data-startTime="5">Developer Relations team. </span> <span class="line" data-startTime="9">And I mostly work with </span><span class="line" data-startTime="9">the JavaScript APIs. </span> <span class="line" data-startTime="12">So good old browsers. </span> <span class="line" data-startTime="14">And so, as you can see, I'm here </span><span class="line" data-startTime="14">to tell you a story about </span><span class="line" data-startTime="18">where maps and browsers and </span><span class="line" data-startTime="18">geospatial data meet and make </span><span class="line" data-startTime="26">beautiful, beautiful </span><span class="line" data-startTime="26">things for us. </span> <span class="line" data-startTime="29">It says HTML5 up there because </span><span class="line" data-startTime="29">I wanted to be cool, I guess, </span><span class="line" data-startTime="34">but it's really about </span><span class="line" data-startTime="34">modern browsers. </span> <span class="line" data-startTime="36">What are the new things that </span><span class="line" data-startTime="36">browsers can bring to the </span><span class="line" data-startTime="39">table and allow us </span><span class="line" data-startTime="39">to do things that </span><span class="line" data-startTime="42">we couldn't do before. </span> <span class="line" data-startTime="44">So how are you doing there? </span><span class="line" data-startTime="51">There we go. </span> <span class="line" data-startTime="54">So the kind of catchphrase </span><span class="line" data-startTime="54">of the day for </span><span class="line" data-startTime="61">visualization is process. </span></p>

<p><span class="line" data-startTime="65">And the reason why that is, and </span><span class="line" data-startTime="65">a lot of the visualization </span><span class="line" data-startTime="70">minds out there, the great </span><span class="line" data-startTime="70">visualization minds out there, </span><span class="line" data-startTime="73">are focusing on process, is that </span><span class="line" data-startTime="73">visualization, it turns </span><span class="line" data-startTime="76">out, is really difficult </span><span class="line" data-startTime="76">to do well. </span> <span class="line" data-startTime="79">If we wanted to take it easy, </span><span class="line" data-startTime="79">we could get a couple of </span><span class="line" data-startTime="82">numbers together and pick a nice </span><span class="line" data-startTime="82">font and maybe some clip </span><span class="line" data-startTime="86">art, and you can have it like </span><span class="line" data-startTime="86">a long vertical thing. </span> <span class="line" data-startTime="88">And it would be an </span><span class="line" data-startTime="88">infographic. </span> <span class="line" data-startTime="89">And you'd get some </span><span class="line" data-startTime="89">hits on Reddit. </span> <span class="line" data-startTime="90">And then a bunch of angry people </span><span class="line" data-startTime="90">would come in and say </span><span class="line" data-startTime="93">you're bad at statistics. </span> <span class="line" data-startTime="94">So we could do that. </span> <span class="line" data-startTime="96">But if you want to do a </span><span class="line" data-startTime="96">visualization that that's </span><span class="line" data-startTime="98">actually valuable and actually </span><span class="line" data-startTime="98">gives insight and </span><span class="line" data-startTime="102">communicates, it takes time. </span></p>

<p><span class="line" data-startTime="104">And so what this kind of thing </span><span class="line" data-startTime="104">that people have started </span><span class="line" data-startTime="110">calling this time is process. </span> <span class="line" data-startTime="111">So Ben Fry, who is one of the </span><span class="line" data-startTime="111">co-creators of Processing &mdash; </span><span class="line" data-startTime="119">which is, if you haven't heard </span><span class="line" data-startTime="119">of it it's, a kind of </span><span class="line" data-startTime="123">computational sketchbook slash </span><span class="line" data-startTime="123">programming environment. </span> <span class="line" data-startTime="128">It's great, I really like the </span><span class="line" data-startTime="128">sketchbook part of that. </span> <span class="line" data-startTime="130">It's meant to kind of just </span><span class="line" data-startTime="130">immediately start getting </span><span class="line" data-startTime="133">something on the screen </span><span class="line" data-startTime="133">and going so that </span><span class="line" data-startTime="136">you can start exploring. </span> <span class="line" data-startTime="137">And in his book on data </span><span class="line" data-startTime="137">visualization, he takes the </span><span class="line" data-startTime="142">stages of process and divides </span><span class="line" data-startTime="142">it into these kind of seven </span><span class="line" data-startTime="145">categories. </span> <span class="line" data-startTime="146">And the exact categories </span><span class="line" data-startTime="146">aren't that important. </span> <span class="line" data-startTime="147">There's definitely overlap. </span> <span class="line" data-startTime="148">And we could probably each have </span><span class="line" data-startTime="148">our own definitions for </span><span class="line" data-startTime="152">these words. </span></p>

<p><span class="line" data-startTime="152">But it's actually a pretty good </span><span class="line" data-startTime="152">way to think about it. </span> <span class="line" data-startTime="156">And what I don't have here, and </span><span class="line" data-startTime="156">he actually has when he </span><span class="line" data-startTime="159">first introduces this in the </span><span class="line" data-startTime="159">book, is a bunch of arrows </span><span class="line" data-startTime="163">that point back and forth </span><span class="line" data-startTime="163">and back and forth. </span> <span class="line" data-startTime="165">And it turns out that's </span><span class="line" data-startTime="165">what you have </span><span class="line" data-startTime="166">to do for this process. </span> <span class="line" data-startTime="169">You don't go through stages </span><span class="line" data-startTime="169">and then get to the end. </span> <span class="line" data-startTime="172">It turns out you get to midway </span><span class="line" data-startTime="172">through and realize you had no </span><span class="line" data-startTime="175">idea what you were doing, and </span><span class="line" data-startTime="175">have to go back to the </span><span class="line" data-startTime="177">beginning and take care </span><span class="line" data-startTime="177">of your data. </span> <span class="line" data-startTime="180">So now that I have emphasized </span><span class="line" data-startTime="180">the importance of these, I'm </span><span class="line" data-startTime="184">going to lump the first three </span><span class="line" data-startTime="184">together so I can dismiss them </span><span class="line" data-startTime="188">as quickly as possible. </span> <span class="line" data-startTime="189">So these are actually </span><span class="line" data-startTime="189">the hardest steps &mdash; </span><span class="line" data-startTime="194">acquire, parse, and filter. </span> <span class="line" data-startTime="195">So this is really about your </span><span class="line" data-startTime="195">data, your source data. </span> <span class="line" data-startTime="198">And it turns out this is </span><span class="line" data-startTime="198">often definitely the </span><span class="line" data-startTime="202">longest amount of time. </span></p>

<p><span class="line" data-startTime="204">It tends to be the most </span><span class="line" data-startTime="204">tedious part of a </span><span class="line" data-startTime="206">visualization project because </span><span class="line" data-startTime="206">data tends to be so horrible </span><span class="line" data-startTime="211">in the real world, especially </span><span class="line" data-startTime="211">as you get larger in the </span><span class="line" data-startTime="214">amount of data. </span> <span class="line" data-startTime="216">I'm going to avoid saying that </span><span class="line" data-startTime="216">phrase about voluminous </span><span class="line" data-startTime="221">amounts of data. </span> <span class="line" data-startTime="224">But as the amount of data you </span><span class="line" data-startTime="224">have increases, the likelihood </span><span class="line" data-startTime="227">of error increases. </span> <span class="line" data-startTime="229">And just the raw number of even </span><span class="line" data-startTime="229">somebody entering wrong </span><span class="line" data-startTime="233">things on a keyboard, or much </span><span class="line" data-startTime="233">more like subtle but </span><span class="line" data-startTime="237">pernicious things like somebody </span><span class="line" data-startTime="237">took a survey of data </span><span class="line" data-startTime="241">using 1990s census tracts, and </span><span class="line" data-startTime="241">somebody else took a survey of </span><span class="line" data-startTime="243">data using 2000 census tracts. </span> <span class="line" data-startTime="245">And then you want to compare </span><span class="line" data-startTime="245">them, but it turns out in your </span><span class="line" data-startTime="248">area, the census tracts </span><span class="line" data-startTime="248">don't actually align. </span></p>

<p><span class="line" data-startTime="249">And then you're going to have </span><span class="line" data-startTime="249">make some pretty serious </span><span class="line" data-startTime="252">assumptions about how things </span><span class="line" data-startTime="252">average over areas that only </span><span class="line" data-startTime="257">intersect but aren't the same. </span> <span class="line" data-startTime="262">So there's a bunch of tools </span><span class="line" data-startTime="262">out there to help you with </span><span class="line" data-startTime="266">these steps. </span> <span class="line" data-startTime="267">You import the data. </span> <span class="line" data-startTime="268">You look what's wrong. </span> <span class="line" data-startTime="270">All the way down from just </span><span class="line" data-startTime="270">libraries, a lot of Python </span><span class="line" data-startTime="273">libraries exist. </span> <span class="line" data-startTime="275">If you are a fan of R, </span><span class="line" data-startTime="275">this is great for it. </span> <span class="line" data-startTime="276">One thing that I'll put a plug </span><span class="line" data-startTime="276">in for is Open Refine, which </span><span class="line" data-startTime="280">used to be called </span><span class="line" data-startTime="280">Google Refine. </span> <span class="line" data-startTime="282">It's a great program </span><span class="line" data-startTime="282">that you can run. </span> <span class="line" data-startTime="283">And it's specifically for </span><span class="line" data-startTime="283">this type of thing. </span></p>

<p><span class="line" data-startTime="286">You put in your data, and you </span><span class="line" data-startTime="286">run what are called filters. </span> <span class="line" data-startTime="291">So for this unemployment column, </span><span class="line" data-startTime="291">you say, show me </span><span class="line" data-startTime="294">everything that's not a </span><span class="line" data-startTime="294">number because this is </span><span class="line" data-startTime="295">supposed to be a number. </span> <span class="line" data-startTime="296">And it might turn out somebody </span><span class="line" data-startTime="296">entered strings in there for </span><span class="line" data-startTime="298">some reason. </span> <span class="line" data-startTime="299">And then you can write a really </span><span class="line" data-startTime="299">quick little snippet in </span><span class="line" data-startTime="302">the little Refine programming </span><span class="line" data-startTime="302">scripting </span><span class="line" data-startTime="307">language to correct those. </span> <span class="line" data-startTime="308">And it turns out this is kind of </span><span class="line" data-startTime="308">what happens, big or small, </span><span class="line" data-startTime="311">what you have to do. </span> <span class="line" data-startTime="312">You have to look at your data </span><span class="line" data-startTime="312">and say, what doesn't belong? </span><span class="line" data-startTime="315">And there's a lot of tricks that </span><span class="line" data-startTime="315">you can do to get there. </span> <span class="line" data-startTime="322">So this is hard. </span> <span class="line" data-startTime="323">And the kind of data that I want </span><span class="line" data-startTime="323">to use, for WebGL stuff, </span><span class="line" data-startTime="327">which we're going to get to in </span><span class="line" data-startTime="327">just a second, it tends to be </span><span class="line" data-startTime="332">high in count, and so there </span><span class="line" data-startTime="332">tends to be errors in it. </span></p>

<p><span class="line" data-startTime="337">And as I said, I'm going to </span><span class="line" data-startTime="337">kind of pass over this now </span><span class="line" data-startTime="340">because there's an awesome </span><span class="line" data-startTime="340">session just after lunch in </span><span class="line" data-startTime="344">Room 1, which is somewhere down </span><span class="line" data-startTime="344">the hall, called All the </span><span class="line" data-startTime="348">Ships in the World. </span> <span class="line" data-startTime="349">And it's about gathering </span><span class="line" data-startTime="349">data from all the </span><span class="line" data-startTime="353">ships in the world. </span> <span class="line" data-startTime="355">So you can imagine, it's </span><span class="line" data-startTime="355">quite a bit of data. </span> <span class="line" data-startTime="356">And it's a great session, </span><span class="line" data-startTime="356">specifically, about how you </span><span class="line" data-startTime="359">get kind of nasty, poorly </span><span class="line" data-startTime="359">formatted, sometimes just </span><span class="line" data-startTime="366">erratic data, clean it up, put </span><span class="line" data-startTime="366">it through a pipeline so that </span><span class="line" data-startTime="369">you can process that large a </span><span class="line" data-startTime="369">volume of data, and then start </span><span class="line" data-startTime="373">serving it fast enough that </span><span class="line" data-startTime="373">you can start doing </span><span class="line" data-startTime="374">interactive queries on it, and </span><span class="line" data-startTime="374">so you can actually take a </span><span class="line" data-startTime="379">look at things, and a little </span><span class="line" data-startTime="379">graph, and say, oh, that </span><span class="line" data-startTime="382">little lump in that distribution </span><span class="line" data-startTime="382">does not belong </span><span class="line" data-startTime="384">there, so let's go figure </span><span class="line" data-startTime="384">out what that is. </span> <span class="line" data-startTime="387">So I definitely recommend it. </span></p>

<p><span class="line" data-startTime="389">12:45 after lunch. </span> <span class="line" data-startTime="391">So what we're going to do is </span><span class="line" data-startTime="391">treat that course as a little </span><span class="line" data-startTime="395">awesome black box and </span><span class="line" data-startTime="395">use their data. </span> <span class="line" data-startTime="398">So we're going to take a look at </span><span class="line" data-startTime="398">All the Ships in the World </span><span class="line" data-startTime="403">and just try our hand at </span><span class="line" data-startTime="403">visualizing it and kind of </span><span class="line" data-startTime="405">exploring the data. </span> <span class="line" data-startTime="406">So this is about the process of </span><span class="line" data-startTime="406">figuring out what are the </span><span class="line" data-startTime="410">interesting stories here. </span> <span class="line" data-startTime="411">So the data comes from </span><span class="line" data-startTime="411">SpaceQuest, a company called </span><span class="line" data-startTime="413">SpaceQuest. </span> <span class="line" data-startTime="415">And it turns out that ships </span><span class="line" data-startTime="415">broadcast a bunch of data </span><span class="line" data-startTime="417">about themselves. </span> <span class="line" data-startTime="418">They have transmissions that </span><span class="line" data-startTime="418">they sent out periodically </span><span class="line" data-startTime="422">talking about who they </span><span class="line" data-startTime="422">are, where they are, </span><span class="line" data-startTime="425">what they're doing. </span></p>

<p><span class="line" data-startTime="426">And it's primarily for collision </span><span class="line" data-startTime="426">avoidance and in </span><span class="line" data-startTime="430">harbors and things like that, </span><span class="line" data-startTime="430">for traffic control. </span> <span class="line" data-startTime="433">But all the ships broadcast </span><span class="line" data-startTime="433">it out. </span> <span class="line" data-startTime="436">And so SpaceQuest has a </span><span class="line" data-startTime="436">satellite overhead. </span> <span class="line" data-startTime="438">And they pick it up. </span> <span class="line" data-startTime="439">And they log it. </span> <span class="line" data-startTime="442">And so we've partnered </span><span class="line" data-startTime="442">with them to kind of </span><span class="line" data-startTime="445">explore what's possible. </span> <span class="line" data-startTime="447">If we were to visualize this </span><span class="line" data-startTime="447">kind of data, what kind of </span><span class="line" data-startTime="449">things could we do? </span><span class="line" data-startTime="455">So let's talk about Represent, </span><span class="line" data-startTime="455">representations. </span> <span class="line" data-startTime="458">Finding a representation. </span> <span class="line" data-startTime="460">So this is something that's part </span><span class="line" data-startTime="460">of my personal process, </span><span class="line" data-startTime="463">finding something on screen as </span><span class="line" data-startTime="463">quickly as possible so that I </span><span class="line" data-startTime="467">can get a look at the data </span><span class="line" data-startTime="467">and see what's going on. </span> <span class="line" data-startTime="472">So a year ago at I/O, I released </span><span class="line" data-startTime="472">a library called </span><span class="line" data-startTime="475">CanvasLayer. </span> <span class="line" data-startTime="476">It's in the Google Maps </span><span class="line" data-startTime="476">Utility Library. </span> <span class="line" data-startTime="479">If you just look for </span><span class="line" data-startTime="479">CanvasLayer, one word, it's </span><span class="line" data-startTime="482">usually in the top hits. </span> <span class="line" data-startTime="484">So it's a Maps API. </span></p>

<p><span class="line" data-startTime="486">How many people here are </span><span class="line" data-startTime="486">familiar with the Maps API, </span><span class="line" data-startTime="489">the JavaScript Maps API? </span><span class="line" data-startTime="491">OK, would you rate yourself as </span><span class="line" data-startTime="491">you have made more than two </span><span class="line" data-startTime="495">maps that you didn't directly </span><span class="line" data-startTime="495">copy paste from the samples? </span><span class="line" data-startTime="499">[LAUGHTER] </span></p>

<p class="speaker"><span class="line" data-starttime="500"><span class="speakerName">Brendan Kenny</span>: Yeah, OK, I mean, </span><span class="line" data-startTime="500">no it's totally fine. </span> <span class="line" data-startTime="502">I just am curious about </span><span class="line" data-startTime="502">what level of </span><span class="line" data-startTime="504">detail I should go into. </span> <span class="line" data-startTime="507">So the Maps API has a concept </span><span class="line" data-startTime="507">called overlays. </span> <span class="line" data-startTime="511">And they're exactly what </span><span class="line" data-startTime="511">they sound like. </span> <span class="line" data-startTime="514">Chrome doesn't like when I go </span><span class="line" data-startTime="514">full screen to other tabs. </span> <span class="line" data-startTime="519">So this is a ground overlay. </span> <span class="line" data-startTime="522">And it's literally an image </span><span class="line" data-startTime="522">put on top of the ground. </span> <span class="line" data-startTime="526">And so the key thing </span><span class="line" data-startTime="526">with overlays &mdash; </span><span class="line" data-startTime="529">the kind of overlays in the Maps </span><span class="line" data-startTime="529">API parlance &mdash; is that </span><span class="line" data-startTime="532">you take an object. </span> <span class="line" data-startTime="533">And it's associated with </span><span class="line" data-startTime="533">a point in the world. </span></p>

<p><span class="line" data-startTime="535">And so when you move, and </span><span class="line" data-startTime="535">when you zoom, it </span><span class="line" data-startTime="538">stays put at that point. </span> <span class="line" data-startTime="541">So that's great. </span> <span class="line" data-startTime="542">And you can do nice things like </span><span class="line" data-startTime="542">overlay historical data </span><span class="line" data-startTime="545">on top of here. </span> <span class="line" data-startTime="546">So CanvasLayer is a </span><span class="line" data-startTime="546">layer because it </span><span class="line" data-startTime="549">doesn't quite do that. </span> <span class="line" data-startTime="550">But it tries to emulate that. </span> <span class="line" data-startTime="553">Did that actually work? </span><span class="line" data-startTime="554">Oh, cool. </span> <span class="line" data-startTime="555">There we go. </span> <span class="line" data-startTime="558">So CanvasLayer takes an HTML5 </span><span class="line" data-startTime="558">canvas and puts it right on </span><span class="line" data-startTime="563">top of a map and let's you draw </span><span class="line" data-startTime="566">anything you want to canvas. </span> <span class="line" data-startTime="568">And if you're not familiar, </span><span class="line" data-startTime="568">canvas is supposed to be a </span><span class="line" data-startTime="571">dynamic image element. </span> <span class="line" data-startTime="572">And so it originally had a 2D </span><span class="line" data-startTime="572">API that's based off drawing </span><span class="line" data-startTime="576">APIs of old. </span> <span class="line" data-startTime="578">But then more recently, a 3D API </span><span class="line" data-startTime="578">was added, WebGL, which is </span><span class="line" data-startTime="584">based on OpenGL, yes, 2, but </span><span class="line" data-startTime="584">it's basically OpenGL </span><span class="line" data-startTime="588">bindings, emulated or not, </span><span class="line" data-startTime="588">through the browser. </span> <span class="line" data-startTime="591">So you can use the canvas </span><span class="line" data-startTime="591">as your place to draw. </span></p>

<p><span class="line" data-startTime="595">I'm sure most people have seen </span><span class="line" data-startTime="595">a WebGL thing by now. </span> <span class="line" data-startTime="597">I guess we saw a bunch </span><span class="line" data-startTime="597">yesterday. </span> <span class="line" data-startTime="601">So here's our canvas. </span> <span class="line" data-startTime="602">And the main thing is &mdash; </span><span class="line" data-startTime="604">ooh, that's no good. </span> <span class="line" data-startTime="606">The main thing to see </span><span class="line" data-startTime="606">here, though, is &mdash; </span><span class="line" data-startTime="609">it's a little hard </span><span class="line" data-startTime="609">to understand &mdash; </span><span class="line" data-startTime="611">is that the canvas actually </span><span class="line" data-startTime="611">stays still. </span> <span class="line" data-startTime="613">So the canvas covers the whole </span><span class="line" data-startTime="613">map, and it doesn't </span><span class="line" data-startTime="615">move with the map. </span> <span class="line" data-startTime="616">And the difference is, what </span><span class="line" data-startTime="616">you're doing is instead </span><span class="line" data-startTime="618">logically moving the content. </span> <span class="line" data-startTime="620">And so there's a callback </span><span class="line" data-startTime="620">every frame, so on a </span><span class="line" data-startTime="622">RequestAnimationFrame, to </span><span class="line" data-startTime="622">redraw the content. </span> <span class="line" data-startTime="625">And for 2D canvas, it's </span><span class="line" data-startTime="625">not that important. </span> <span class="line" data-startTime="628">You could kind of </span><span class="line" data-startTime="628">do some tricks. </span> <span class="line" data-startTime="630">But for WebGL, it turns out it's </span><span class="line" data-startTime="630">really important because </span><span class="line" data-startTime="632">every wasted pixel in WebGL is </span><span class="line" data-startTime="632">possibly a significant cost </span><span class="line" data-startTime="640">with wasted pixels. </span></p>

<p><span class="line" data-startTime="640">So you don't want anything </span><span class="line" data-startTime="640">sliding offscreen </span><span class="line" data-startTime="642">that you can't see. </span> <span class="line" data-startTime="643">And you don't want to allocate a </span><span class="line" data-startTime="643">bigger canvas than you need. </span> <span class="line" data-startTime="647">So that's what we do. </span> <span class="line" data-startTime="648">And so it's just something, </span><span class="line" data-startTime="648">too, that you have to deal </span><span class="line" data-startTime="651">with when you're dealing </span><span class="line" data-startTime="651">with CanvasLayer. </span> <span class="line" data-startTime="653">But it's not terribly difficult </span><span class="line" data-startTime="653">to understand. </span> <span class="line" data-startTime="666">So CanvasLayer is created like </span><span class="line" data-startTime="666">a lot of Maps API objects. </span> <span class="line" data-startTime="670">You create a canvas layer </span><span class="line" data-startTime="670">with a constructor. </span> <span class="line" data-startTime="673">You pass it a configuration </span><span class="line" data-startTime="673">object. </span> <span class="line" data-startTime="675">The most important things are </span><span class="line" data-startTime="675">the map that you want to </span><span class="line" data-startTime="677">actually put it on and the </span><span class="line" data-startTime="677">update function, so that </span><span class="line" data-startTime="679">function that's called </span><span class="line" data-startTime="679">back every frame. </span></p>

<p><span class="line" data-startTime="681">There's other options. </span> <span class="line" data-startTime="682">It's all in the docs if you </span><span class="line" data-startTime="682">want to take a look. </span> <span class="line" data-startTime="684">And so here's an example of </span><span class="line" data-startTime="684">the 2D transformation that </span><span class="line" data-startTime="688">we're doing. </span> <span class="line" data-startTime="688">And there's a direct analog </span><span class="line" data-startTime="688">to it in WebGL. </span> <span class="line" data-startTime="691">So we're calculating a scale. </span> <span class="line" data-startTime="693">So as you zoom in, you can think </span><span class="line" data-startTime="693">of the world as scaling </span><span class="line" data-startTime="695">rather than zooming. </span> <span class="line" data-startTime="696">And it's to the power </span><span class="line" data-startTime="696">of the zoom. </span> <span class="line" data-startTime="698">And then you have an offset, </span><span class="line" data-startTime="698">which is just the translation </span><span class="line" data-startTime="701">as you pan around. </span> <span class="line" data-startTime="702">And then the context.scale and </span><span class="line" data-startTime="702">context.translate are part of </span><span class="line" data-startTime="705">the 2D drawing API that </span><span class="line" data-startTime="705">actually let you </span><span class="line" data-startTime="708">transform the canvas. </span> <span class="line" data-startTime="709">So then I can just say draw </span><span class="line" data-startTime="709">a square, and it will </span><span class="line" data-startTime="713">correctly place it. </span> <span class="line" data-startTime="715">So that's the 2D canvas. </span></p>

<p><span class="line" data-startTime="716">And we don't care about </span><span class="line" data-startTime="716">it anymore. </span> <span class="line" data-startTime="718">So we have a canvas that </span><span class="line" data-startTime="718">we can draw to. </span> <span class="line" data-startTime="723">We have data from an awesome </span><span class="line" data-startTime="723">black box that's covered </span><span class="line" data-startTime="726">really well at 12:45, All </span><span class="line" data-startTime="726">the Ships in the World. </span> <span class="line" data-startTime="728">You should go. </span> <span class="line" data-startTime="730">And we need to get the data from </span><span class="line" data-startTime="730">there into the canvas. </span> <span class="line" data-startTime="734">So there's a couple </span><span class="line" data-startTime="734">of different ways. </span> <span class="line" data-startTime="736">Oh, that's exciting. </span> <span class="line" data-startTime="739">OK, whatever. </span></p>

<p><span class="line" data-startTime="741">So we have CSV, which ends up </span><span class="line" data-startTime="741">poorly wrapping, often. </span> <span class="line" data-startTime="746">And that's the tried </span><span class="line" data-startTime="746">and trusted way. </span> <span class="line" data-startTime="749">Whatever, if you really like </span><span class="line" data-startTime="749">spreadsheets, if you know </span><span class="line" data-startTime="752">people that really like </span><span class="line" data-startTime="752">spreadsheets, you probably </span><span class="line" data-startTime="754">could get CSV pretty quickly. </span> <span class="line" data-startTime="757">A million libraries can import </span><span class="line" data-startTime="757">it and parse it for you. </span> <span class="line" data-startTime="761">If you go talk to the </span><span class="line" data-startTime="761">Perfmatters guys upstairs in </span><span class="line" data-startTime="765">the Chrome booth area, they'll </span><span class="line" data-startTime="765">tell you not to mess </span><span class="line" data-startTime="769">with this too much. </span> <span class="line" data-startTime="769">As it gets bigger, you start </span><span class="line" data-startTime="769">generating a lot of strings. </span> <span class="line" data-startTime="772">And modern JavaScript engines </span><span class="line" data-startTime="772">are really good at doing </span><span class="line" data-startTime="776">offsets into strings because </span><span class="line" data-startTime="776">strings are read only. </span> <span class="line" data-startTime="780">But you can quite easily </span><span class="line" data-startTime="780">generate a ton of garbage. </span> <span class="line" data-startTime="783">And then everything </span><span class="line" data-startTime="783">slows down. </span> <span class="line" data-startTime="784">So that's no good. </span> <span class="line" data-startTime="785">So we'll look for something </span><span class="line" data-startTime="785">better. </span></p>

<p><span class="line" data-startTime="787">JSON is the classic thing. </span> <span class="line" data-startTime="791">Hopefully, everybody is </span><span class="line" data-startTime="791">familiar with JSON. </span> <span class="line" data-startTime="793">It has a nice direct translation </span><span class="line" data-startTime="793">to the object </span><span class="line" data-startTime="796">literal from JavaScript, which </span><span class="line" data-startTime="796">is what JSONP is based on. </span> <span class="line" data-startTime="799">And all the browsers, for years </span><span class="line" data-startTime="799">now, have had support </span><span class="line" data-startTime="802">for json.parse, which is a </span><span class="line" data-startTime="802">native method to safely parse </span><span class="line" data-startTime="807">Jason into JavaScript objects. </span> <span class="line" data-startTime="809">It's really fast. </span> <span class="line" data-startTime="810">There's a couple of downsides. </span> <span class="line" data-startTime="812">People tend to make deep </span><span class="line" data-startTime="812">objects with JSON, even </span><span class="line" data-startTime="815">without meaning to. </span> <span class="line" data-startTime="815">GeoJSON is a really beautifully </span><span class="line" data-startTime="815">simple format, and </span><span class="line" data-startTime="819">yet people still end up taking </span><span class="line" data-startTime="819">features and putting them in </span><span class="line" data-startTime="822">feature sets, and then they have </span><span class="line" data-startTime="822">geometries, but they're </span><span class="line" data-startTime="824">also siblings to other </span><span class="line" data-startTime="824">features which </span><span class="line" data-startTime="827">have feature sets. </span> <span class="line" data-startTime="827">And you end up having to write </span><span class="line" data-startTime="827">general tree callers just to </span><span class="line" data-startTime="832">find all the things. </span> <span class="line" data-startTime="833">The other thing is just size. </span> <span class="line" data-startTime="835">So the numeric type in </span><span class="line" data-startTime="835">JavaScript is a 64-bit float. </span></p>

<p><span class="line" data-startTime="838">And that's eight bytes </span><span class="line" data-startTime="838">on the wire. </span> <span class="line" data-startTime="840">And you can see that right </span><span class="line" data-startTime="840">here we have some </span><span class="line" data-startTime="843">lat longs or something. </span> <span class="line" data-startTime="846">And every character over eight </span><span class="line" data-startTime="846">characters is an extra byte. </span> <span class="line" data-startTime="852">And you actually want </span><span class="line" data-startTime="852">that because </span><span class="line" data-startTime="854">you want the precision. </span> <span class="line" data-startTime="855">A 64-bit floating point has 14 </span><span class="line" data-startTime="855">decimal places of precision. </span> <span class="line" data-startTime="860">And so you want that, but </span><span class="line" data-startTime="860">you start wasting space. </span> <span class="line" data-startTime="865">Gzip does help. </span> <span class="line" data-startTime="867">Don't let me make it </span><span class="line" data-startTime="867">sound too bad. </span> <span class="line" data-startTime="870">But you do end up paying </span><span class="line" data-startTime="870">the price. </span> <span class="line" data-startTime="872">So all of which is to say, the </span><span class="line" data-startTime="872">most beautiful thing, the most </span><span class="line" data-startTime="876">wonderful thing, is </span><span class="line" data-startTime="876">typed arrays. </span> <span class="line" data-startTime="879">So typed arrays came </span><span class="line" data-startTime="879">along with WebGL. </span> <span class="line" data-startTime="883">Is everybody familiar </span><span class="line" data-startTime="883">with typed arrays? </span><span class="line" data-startTime="885">Yes? </span><span class="line" data-startTime="887">No? </span><span class="line" data-startTime="889">OK. </span></p>

<p><span class="line" data-startTime="889">So typed arrays are kind </span><span class="line" data-startTime="889">of what you would </span><span class="line" data-startTime="892">think in C as an array. </span> <span class="line" data-startTime="894">It's a contiguous </span><span class="line" data-startTime="894">block of bytes. </span> <span class="line" data-startTime="896">And you say to the browser, give </span><span class="line" data-startTime="896">me these number of bytes. </span> <span class="line" data-startTime="899">And then you can just fill it </span><span class="line" data-startTime="899">in with whatever you want. </span> <span class="line" data-startTime="902">And so what's great about that </span><span class="line" data-startTime="902">is, when you get a message </span><span class="line" data-startTime="906">from a server with XHR2, which </span><span class="line" data-startTime="906">has been around for a little </span><span class="line" data-startTime="910">while now, you can actually </span><span class="line" data-startTime="910">set the response </span><span class="line" data-startTime="912">type on your XHR. </span> <span class="line" data-startTime="915">And so that basically tells the </span><span class="line" data-startTime="915">browser, don't mess with </span><span class="line" data-startTime="917">anything here. </span> <span class="line" data-startTime="918">Don't parse. </span></p>

<p><span class="line" data-startTime="919">Don't send it through some </span><span class="line" data-startTime="919">string engine, and back to </span><span class="line" data-startTime="921">binary, or something awful. </span> <span class="line" data-startTime="922">Just give me the </span><span class="line" data-startTime="922">bytes directly. </span> <span class="line" data-startTime="925">And so you can see here that, </span><span class="line" data-startTime="925">what I'm doing is, I take this </span><span class="line" data-startTime="928">response, which is the array </span><span class="line" data-startTime="928">buffer, and then I'm putting </span><span class="line" data-startTime="930">it in a float 32 array. </span> <span class="line" data-startTime="933">And so I think a lot of people, </span><span class="line" data-startTime="933">when they encounter </span><span class="line" data-startTime="936">typed arrays, they think of </span><span class="line" data-startTime="936">float 32 array, and int 32 </span><span class="line" data-startTime="939">array, and float 64 array </span><span class="line" data-startTime="939">because you think of it, it's </span><span class="line" data-startTime="943">a typed array. </span> <span class="line" data-startTime="944">You have a data type throughout </span><span class="line" data-startTime="944">an array. </span> <span class="line" data-startTime="947">But actually, those are what are </span><span class="line" data-startTime="947">called type array views. </span> <span class="line" data-startTime="950">And it's great because you can </span><span class="line" data-startTime="950">actually have multiple views </span><span class="line" data-startTime="953">on the same buffer. </span> <span class="line" data-startTime="954">So say you had, for instance, </span><span class="line" data-startTime="954">alternating float and ints. </span></p>

<p><span class="line" data-startTime="958">So in the data that we're about </span><span class="line" data-startTime="958">to see, our time stamps </span><span class="line" data-startTime="962">couldn't fit in a float 32 </span><span class="line" data-startTime="962">without losing precision. </span> <span class="line" data-startTime="965">And so we can fit them </span><span class="line" data-startTime="965">in an int 32. </span> <span class="line" data-startTime="967">And so I can actually </span><span class="line" data-startTime="967">get two views. </span> <span class="line" data-startTime="969">I could do a new int 32 array </span><span class="line" data-startTime="969">on this.response, and just </span><span class="line" data-startTime="973">alternate as I iterate through </span><span class="line" data-startTime="973">the array, and take a look at </span><span class="line" data-startTime="976">them because they just interpret </span><span class="line" data-startTime="976">the underlying bytes </span><span class="line" data-startTime="979">the way that you tell them to. </span> <span class="line" data-startTime="980">So they're my favorite thing. </span> <span class="line" data-startTime="982">They let us have JavaScript </span><span class="line" data-startTime="982">the way that we want it. </span> <span class="line" data-startTime="987">There's the loose, scripty, just </span><span class="line" data-startTime="987">throw it out on the page </span><span class="line" data-startTime="991">that everybody does. </span></p>

<p><span class="line" data-startTime="992">And there's the snooty, I do </span><span class="line" data-startTime="992">everything with promises and </span><span class="line" data-startTime="995">wrapped up callbacks. </span> <span class="line" data-startTime="996">And if it's not a monad, then I </span><span class="line" data-startTime="996">don't want to hear about it. </span> <span class="line" data-startTime="1000">And then there's the asm.js </span><span class="line" data-startTime="1000">hacker types that just want to </span><span class="line" data-startTime="1004">do some bit twiddling </span><span class="line" data-startTime="1004">sometimes. </span> <span class="line" data-startTime="1006">And we can merge all of them. </span> <span class="line" data-startTime="1007">And it's beautiful. </span> <span class="line" data-startTime="1009">So I apologize for this long </span><span class="line" data-startTime="1009">to actually draw something. </span> <span class="line" data-startTime="1013">So let's take a look at some </span><span class="line" data-startTime="1013">really simple points. </span> <span class="line" data-startTime="1015">So this is taking data from all </span><span class="line" data-startTime="1015">the ships in the world. </span> <span class="line" data-startTime="1018">And actually, the query is, </span><span class="line" data-startTime="1018">what are all the latest </span><span class="line" data-startTime="1021">positions of ships </span><span class="line" data-startTime="1021">that you've seen. </span> <span class="line" data-startTime="1024">So the satellite, actually, </span><span class="line" data-startTime="1024">is in a polar orbit. </span> <span class="line" data-startTime="1027">And so it only sees ships </span><span class="line" data-startTime="1027">every once in a while, </span><span class="line" data-startTime="1029">whenever they're underneath. </span></p>

<p><span class="line" data-startTime="1030">And so, typically, I don't </span><span class="line" data-startTime="1030">remember my orbital mechanics </span><span class="line" data-startTime="1034">exactly, but it depends on the </span><span class="line" data-startTime="1034">Earth turning, actually, </span><span class="line" data-startTime="1036">underneath the polar orbit </span><span class="line" data-startTime="1036">to see everything. </span> <span class="line" data-startTime="1039">And so it only sees what's in </span><span class="line" data-startTime="1039">its line of sight, and so </span><span class="line" data-startTime="1045">there's a certain amount </span><span class="line" data-startTime="1045">of time since </span><span class="line" data-startTime="1046">you've last seen a ship. </span> <span class="line" data-startTime="1047">And if ships turn off their </span><span class="line" data-startTime="1047">receivers, we might not see </span><span class="line" data-startTime="1050">them for months. </span> <span class="line" data-startTime="1052">So here's an image </span><span class="line" data-startTime="1052">of all of them. </span> <span class="line" data-startTime="1057">And as of this morning, </span><span class="line" data-startTime="1057">I think it was </span><span class="line" data-startTime="1059">about 79,000 points. </span> <span class="line" data-startTime="1063">So if you are familiar with web </span><span class="line" data-startTime="1063">mapping, this is actually </span><span class="line" data-startTime="1067">a huge amount of points. </span> <span class="line" data-startTime="1070">It's not unheard of. </span> <span class="line" data-startTime="1071">It's not it's not completely </span><span class="line" data-startTime="1071">out of a normal range. </span></p>

<p><span class="line" data-startTime="1075">But typically, with regular </span><span class="line" data-startTime="1075">markers, you </span><span class="line" data-startTime="1077">might have a few hundred. </span> <span class="line" data-startTime="1078">You can use optimized markers or </span><span class="line" data-startTime="1078">some kind of canvas tricks </span><span class="line" data-startTime="1081">for more than that. </span> <span class="line" data-startTime="1082">But what we have here is very </span><span class="line" data-startTime="1082">quickly interactive. </span> <span class="line" data-startTime="1085">And remember that this is </span><span class="line" data-startTime="1085">actually redrawing every frame </span><span class="line" data-startTime="1093">that that's actually </span><span class="line" data-startTime="1093">being done. </span> <span class="line" data-startTime="1094">And so it's actually quite </span><span class="line" data-startTime="1094">nice and fast. </span> <span class="line" data-startTime="1097">So this is just a very </span><span class="line" data-startTime="1097">simple drawing. </span> <span class="line" data-startTime="1099">I'm just taking the lat </span><span class="line" data-startTime="1099">long And I'm filling </span><span class="line" data-startTime="1101">a box around it. </span> <span class="line" data-startTime="1104">So that's great. </span> <span class="line" data-startTime="1105">And we can see, already, that we </span><span class="line" data-startTime="1105">have plenty of performance </span><span class="line" data-startTime="1107">room that we can start kind </span><span class="line" data-startTime="1107">of abusing our GPU. </span></p>

<p><span class="line" data-startTime="1111">Because what are those fans for </span><span class="line" data-startTime="1111">but running at full speed? </span><span class="line" data-startTime="1116">Makes sense to me. </span> <span class="line" data-startTime="1117">So just to give you a look at </span><span class="line" data-startTime="1117">what we're doing to get those </span><span class="line" data-startTime="1128">blocks on screen, if you've </span><span class="line" data-startTime="1128">never seen WebGL code before, </span><span class="line" data-startTime="1134">this might be a little </span><span class="line" data-startTime="1134">shocking. </span> <span class="line" data-startTime="1135">It's a very C-like API, on </span><span class="line" data-startTime="1135">purpose, to make it very easy </span><span class="line" data-startTime="1138">to port old OpenGL code. </span> <span class="line" data-startTime="1140">It's really not that bad, and </span><span class="line" data-startTime="1140">there's a ton of libraries out </span><span class="line" data-startTime="1143">there to wrap it. </span> <span class="line" data-startTime="1145">I personally would </span><span class="line" data-startTime="1145">suggest three.js. </span> <span class="line" data-startTime="1147">I don't use it that much, but </span><span class="line" data-startTime="1147">there's a huge community to </span><span class="line" data-startTime="1152">support that. </span> <span class="line" data-startTime="1153">And the three.js people are so </span><span class="line" data-startTime="1153">fast in Stack Overflow, I </span><span class="line" data-startTime="1156">never get to answer anything. </span></p>

<p><span class="line" data-startTime="1157">So they're ready to help you. </span> <span class="line" data-startTime="1160">And it wraps it in a bunch </span><span class="line" data-startTime="1160">of kind of very familiar </span><span class="line" data-startTime="1162">JavaScript objects and </span><span class="line" data-startTime="1162">helper classes. </span> <span class="line" data-startTime="1166">So it can help you out. </span> <span class="line" data-startTime="1168">But here's just looking </span><span class="line" data-startTime="1168">at raw WebGL. </span> <span class="line" data-startTime="1170">So we get a WebGL context by </span><span class="line" data-startTime="1170">asking &mdash; so CanvasLayer has a </span><span class="line" data-startTime="1173">canvas on it. </span> <span class="line" data-startTime="1174">And we ask for the </span><span class="line" data-startTime="1174">WebGL context. </span> <span class="line" data-startTime="1177">I put this in specifically on </span><span class="line" data-startTime="1177">its own slide because I'm </span><span class="line" data-startTime="1179">really excited. </span> <span class="line" data-startTime="1180">It used to be experimental WebGL </span><span class="line" data-startTime="1180">until a few months ago. </span> <span class="line" data-startTime="1184">WebGL was finally ratified. </span> <span class="line" data-startTime="1185">And it's now no longer </span><span class="line" data-startTime="1185">experimental. </span> <span class="line" data-startTime="1187">We have enough conforming </span><span class="line" data-startTime="1187">browsers to do it. </span> <span class="line" data-startTime="1190">So that's Firefox, and we have </span><span class="line" data-startTime="1190">Chrome, and Opera on Windows, </span><span class="line" data-startTime="1194">I think, and then Firefox on </span><span class="line" data-startTime="1194">mobile, Chrome on mobile, if </span><span class="line" data-startTime="1199">you go to about flags and turn </span><span class="line" data-startTime="1199">it, on and then Safari as well </span><span class="line" data-startTime="1203">if you go to the developer </span><span class="line" data-startTime="1203">menu and turn on WebGL. </span></p>

<p><span class="line" data-startTime="1206">So we have a lot of platforms </span><span class="line" data-startTime="1206">available. </span> <span class="line" data-startTime="1208">That's a huge amount of market </span><span class="line" data-startTime="1208">share, depending on </span><span class="line" data-startTime="1210">how you count it. </span> <span class="line" data-startTime="1211">And then I'll let you search on </span><span class="line" data-startTime="1211">the web for, I don't know, </span><span class="line" data-startTime="1215">IE11 and WebGL. </span> <span class="line" data-startTime="1216">And you might find some </span><span class="line" data-startTime="1216">interesting rumors. </span> <span class="line" data-startTime="1219">But I won't comment. </span> <span class="line" data-startTime="1223">I am encouraged, though. </span> <span class="line" data-startTime="1225">So this is kind of pretty </span><span class="line" data-startTime="1225">typical WebGL code. </span> <span class="line" data-startTime="1229">Again, don't worry too much </span><span class="line" data-startTime="1229">about the specifics. </span> <span class="line" data-startTime="1232">But what this is doing here is, </span><span class="line" data-startTime="1232">we're creating a buffer. </span> <span class="line" data-startTime="1234">WebGL is very state based. </span> <span class="line" data-startTime="1237">And so you create buffers, and </span><span class="line" data-startTime="1237">then you say, WebGL, here's my </span><span class="line" data-startTime="1240">current buffer, like </span><span class="line" data-startTime="1240">bind this. </span> <span class="line" data-startTime="1241">And now I want to give this data </span><span class="line" data-startTime="1241">to the current buffer, </span><span class="line" data-startTime="1244">rather than saying, current </span><span class="line" data-startTime="1244">buffer, here's some data. </span> <span class="line" data-startTime="1246">It's feels a little bit &mdash; </span><span class="line" data-startTime="1248">I don't know. </span> <span class="line" data-startTime="1251">So that's what we're </span><span class="line" data-startTime="1251">doing here. </span> <span class="line" data-startTime="1252">We're binding a buffer, and </span><span class="line" data-startTime="1252">we're passing raw data here. </span></p>

<p><span class="line" data-startTime="1255">And if you remember, raw data </span><span class="line" data-startTime="1255">was that array buffer that we </span><span class="line" data-startTime="1258">got off the wire from our XHR. </span> <span class="line" data-startTime="1261">And now we can just pass </span><span class="line" data-startTime="1261">it directly into WebGL. </span> <span class="line" data-startTime="1263">It's a beautiful thing. </span> <span class="line" data-startTime="1264">If you don't have to do any </span><span class="line" data-startTime="1264">processing, if you've already </span><span class="line" data-startTime="1266">processed on the server, you can </span><span class="line" data-startTime="1266">just pass it on in and no </span><span class="line" data-startTime="1269">work needs to be done. </span> <span class="line" data-startTime="1270">So that's the fastest thing to </span><span class="line" data-startTime="1270">compute is no computation. </span> <span class="line" data-startTime="1276">And then you do this thing </span><span class="line" data-startTime="1276">where you bind it to a </span><span class="line" data-startTime="1279">variable to these shaders that </span><span class="line" data-startTime="1279">I'm about to show you. </span> <span class="line" data-startTime="1281">And you tell it these kind of </span><span class="line" data-startTime="1281">esoteric long string of </span><span class="line" data-startTime="1285">parameters here. </span> <span class="line" data-startTime="1286">But I'm telling it it's a vector </span><span class="line" data-startTime="1286">of two components. </span> <span class="line" data-startTime="1290">So its a latitude </span><span class="line" data-startTime="1290">and longitude. </span> <span class="line" data-startTime="1291">And the type is float. </span> <span class="line" data-startTime="1294">And I tell it where to </span><span class="line" data-startTime="1294">find it in the array. </span> <span class="line" data-startTime="1296">And it's just lat long, lat </span><span class="line" data-startTime="1296">long, lat long, right in one </span><span class="line" data-startTime="1300">long array. </span></p>

<p><span class="line" data-startTime="1302">So then we create what </span><span class="line" data-startTime="1302">are called shaders. </span> <span class="line" data-startTime="1305">And they are kind </span><span class="line" data-startTime="1305">of a misnomer. </span> <span class="line" data-startTime="1307">They used to be just for </span><span class="line" data-startTime="1307">shading, but now we can pretty </span><span class="line" data-startTime="1309">much use them for whatever </span><span class="line" data-startTime="1309">we want. </span> <span class="line" data-startTime="1311">There's a great blog series </span><span class="line" data-startTime="1311">by Gregg Tavares, who's an </span><span class="line" data-startTime="1314">engineer on Chrome. </span> <span class="line" data-startTime="1316">And it's called WebGL </span><span class="line" data-startTime="1316">as a 2D API. </span> <span class="line" data-startTime="1318">And it's a really great look at </span><span class="line" data-startTime="1318">how, with the way that GPUs </span><span class="line" data-startTime="1323">have kind of generalized, that </span><span class="line" data-startTime="1323">the 3D is kind of incidental. </span> <span class="line" data-startTime="1329">It's very optimized for 3D, but </span><span class="line" data-startTime="1329">we think of these 3D APIs </span><span class="line" data-startTime="1335">as a means to games and </span><span class="line" data-startTime="1335">things like that. </span> <span class="line" data-startTime="1337">But there's no reason </span><span class="line" data-startTime="1337">for that. </span> <span class="line" data-startTime="1338">We can draw fancy 2D things, </span><span class="line" data-startTime="1338">for instance. </span> <span class="line" data-startTime="1341">So we create these shaders. </span> <span class="line" data-startTime="1343">And they're special programs </span><span class="line" data-startTime="1343">in a special scripting </span><span class="line" data-startTime="1345">language that is a different </span><span class="line" data-startTime="1345">language than JavaScript, but </span><span class="line" data-startTime="1350">it is very C-like. </span> <span class="line" data-startTime="1352">And its very small. </span></p>

<p><span class="line" data-startTime="1353">So there's not much to learn. </span> <span class="line" data-startTime="1354">And it's highly typed. </span> <span class="line" data-startTime="1355">So it's easy to make a mistake, </span><span class="line" data-startTime="1355">but you know pretty </span><span class="line" data-startTime="1358">much instantly because </span><span class="line" data-startTime="1358">the compiler </span><span class="line" data-startTime="1359">complains quite quickly. </span> <span class="line" data-startTime="1364">So you create your shaders. </span> <span class="line" data-startTime="1366">And you bind them. </span> <span class="line" data-startTime="1368">And so what happens on the </span><span class="line" data-startTime="1368">inside is, you've told it that </span><span class="line" data-startTime="1370">your array is broken up into </span><span class="line" data-startTime="1370">x, y, x, y, x, y, x, y. </span> <span class="line" data-startTime="1374">And so the GPU actually has a </span><span class="line" data-startTime="1374">ton of, essentially, parallel </span><span class="line" data-startTime="1378">processors all on its chip. </span></p>

<p><span class="line" data-startTime="1380">And it can run these extremely </span><span class="line" data-startTime="1380">quickly and a </span><span class="line" data-startTime="1383">lot of them at once. </span> <span class="line" data-startTime="1384">This machine, for instance, is </span><span class="line" data-startTime="1384">just a laptop, and it has a </span><span class="line" data-startTime="1386">few hundred that it </span><span class="line" data-startTime="1386">can run these </span><span class="line" data-startTime="1388">calculations at the same time. </span> <span class="line" data-startTime="1391">So it runs a bunch of </span><span class="line" data-startTime="1391">things through. </span> <span class="line" data-startTime="1394">And so you run it through </span><span class="line" data-startTime="1394">this vertex shader. </span> <span class="line" data-startTime="1396">And here's a very simple </span><span class="line" data-startTime="1396">vertex shader. </span> <span class="line" data-startTime="1398">I'm taking that world </span><span class="line" data-startTime="1398">coordinate, that lat long. </span> <span class="line" data-startTime="1401">I'm taking a matrix </span><span class="line" data-startTime="1401">that encodes </span><span class="line" data-startTime="1403">that scale and translate. </span></p>

<p><span class="line" data-startTime="1405">And then I'm just </span><span class="line" data-startTime="1405">multiplying it. </span> <span class="line" data-startTime="1406">And GLSL, the language, has a </span><span class="line" data-startTime="1406">bunch of handy things like 4 </span><span class="line" data-startTime="1413">vectors, and 4 by 4 matrices, </span><span class="line" data-startTime="1413">and things like that. </span> <span class="line" data-startTime="1416">So don't worry too much if </span><span class="line" data-startTime="1416">you're not big on this. </span> <span class="line" data-startTime="1421">Like I said, there's lots of </span><span class="line" data-startTime="1421">libraries to help you out. </span> <span class="line" data-startTime="1424">But the point is, the vertex </span><span class="line" data-startTime="1424">shader, the output here in </span><span class="line" data-startTime="1427">this vertex shader is </span><span class="line" data-startTime="1427">gl_position, a global </span><span class="line" data-startTime="1428">that you write to. </span> <span class="line" data-startTime="1430">And all you have to do is write </span><span class="line" data-startTime="1430">somewhere on the screen, </span><span class="line" data-startTime="1433">between negative 1 and 1 and x, </span><span class="line" data-startTime="1433">and negative 1 and 1 and y, </span><span class="line" data-startTime="1437">and as long as you do that, it's </span><span class="line" data-startTime="1437">going to be on screen. </span> <span class="line" data-startTime="1439">If it's offscreen, then it's </span><span class="line" data-startTime="1439">going to get clipped somehow. </span> <span class="line" data-startTime="1442">And so that's all the vertex </span><span class="line" data-startTime="1442">shader is responsible for is </span><span class="line" data-startTime="1445">outputting an x, y coordinate. </span> <span class="line" data-startTime="1447">And then you can include extra </span><span class="line" data-startTime="1447">coordinates if you're going to </span><span class="line" data-startTime="1450">be in 3D and can absorb it later </span><span class="line" data-startTime="1450">on down the pipeline. </span></p>

<p><span class="line" data-startTime="1454">So depending on what you told </span><span class="line" data-startTime="1454">WebGL you're drawing, in this </span><span class="line" data-startTime="1458">case, we might have said, I'm </span><span class="line" data-startTime="1458">drawing triangles, and so </span><span class="line" data-startTime="1460">it'll actually take the three </span><span class="line" data-startTime="1460">x, y pairs in a row and bind </span><span class="line" data-startTime="1466">them together in a triangle. </span> <span class="line" data-startTime="1468">And so then it says, OK, these </span><span class="line" data-startTime="1468">three are in a triangle. </span> <span class="line" data-startTime="1470">You told me three positions </span><span class="line" data-startTime="1470">on the screen. </span> <span class="line" data-startTime="1472">So every pixel inside that </span><span class="line" data-startTime="1472">logical triangle I'm </span><span class="line" data-startTime="1476">going to fill in. </span></p>

<p><span class="line" data-startTime="1476">And there's rules for those </span><span class="line" data-startTime="1476">partial pixels, which ones are </span><span class="line" data-startTime="1480">filled and which ones aren't. </span> <span class="line" data-startTime="1482">And then, finally, the last part </span><span class="line" data-startTime="1482">of the pipeline is, for </span><span class="line" data-startTime="1484">each of those pixels, you get </span><span class="line" data-startTime="1484">to run another program. </span> <span class="line" data-startTime="1487">So you can run even more </span><span class="line" data-startTime="1487">computations per pixel, which </span><span class="line" data-startTime="1490">gets kind of crazy. </span> <span class="line" data-startTime="1490">And that's what kind of </span><span class="line" data-startTime="1490">separates this from canvas 2D, </span><span class="line" data-startTime="1494">especially. </span> <span class="line" data-startTime="1494">Even as a canvas speeds up, </span><span class="line" data-startTime="1494">and even as SVG speeds up, </span><span class="line" data-startTime="1498">there's really nothing that </span><span class="line" data-startTime="1498">can compare to running a </span><span class="line" data-startTime="1501">rather complex program </span><span class="line" data-startTime="1501">per pixel. </span> <span class="line" data-startTime="1504">And again, the fragment shader </span><span class="line" data-startTime="1504">only has one job, </span><span class="line" data-startTime="1508">is to output a color. </span></p>

<p><span class="line" data-startTime="1510">So I created a little thing that </span><span class="line" data-startTime="1510">lets you edit shaders. </span> <span class="line" data-startTime="1519">And so this is the shader that's </span><span class="line" data-startTime="1519">actually running on </span><span class="line" data-startTime="1521">that map that we just saw, </span><span class="line" data-startTime="1521">just to remind you. </span> <span class="line" data-startTime="1524">Here it is. </span> <span class="line" data-startTime="1524">So we're drawing squares, </span><span class="line" data-startTime="1524">black squares. </span> <span class="line" data-startTime="1531">So in this case, we </span><span class="line" data-startTime="1531">have one point. </span> <span class="line" data-startTime="1534">And so in my vertex shader, I'm </span><span class="line" data-startTime="1534">just directly outputting </span><span class="line" data-startTime="1537">the x, y, which is 0, 0. </span> <span class="line" data-startTime="1538">And I'm using points this </span><span class="line" data-startTime="1538">time, which come </span><span class="line" data-startTime="1541">out as little sprites. </span> <span class="line" data-startTime="1542">And I'm saying that the point </span><span class="line" data-startTime="1542">size, which is the other </span><span class="line" data-startTime="1544">variable you can output for </span><span class="line" data-startTime="1544">points, it's 256 pixels across </span><span class="line" data-startTime="1548">and 256 pixels downwards. </span></p>

<p><span class="line" data-startTime="1551">And then, finally, the </span><span class="line" data-startTime="1551">fragment shader, </span><span class="line" data-startTime="1553">I'm not doing anything. </span> <span class="line" data-startTime="1554">I'm saying for every pixel </span><span class="line" data-startTime="1554">that's in this point, I'm </span><span class="line" data-startTime="1557">outputting an RGBA of </span><span class="line" data-startTime="1557">black, so 0001. </span> <span class="line" data-startTime="1561">And so, finally, when I run </span><span class="line" data-startTime="1561">that, I have my black pixel. </span> <span class="line" data-startTime="1568">So that's very exciting, but </span><span class="line" data-startTime="1568">we can do better than that. </span> <span class="line" data-startTime="1573">So it turns out, as I said, you </span><span class="line" data-startTime="1573">can run whole programs in </span><span class="line" data-startTime="1577">these things. </span> <span class="line" data-startTime="1577">And people actually run </span><span class="line" data-startTime="1577">incredibly complex programs. </span> <span class="line" data-startTime="1580">If you've ever looked at Shader </span><span class="line" data-startTime="1580">Toy, it's actually </span><span class="line" data-startTime="1582">designed specifically just to </span><span class="line" data-startTime="1582">draw two triangles to fill up </span><span class="line" data-startTime="1588">the whole screen. </span> <span class="line" data-startTime="1589">And then everything else </span><span class="line" data-startTime="1589">is run per pixel. </span></p>

<p><span class="line" data-startTime="1591">And you can run very elaborate, </span><span class="line" data-startTime="1591">even ray tracing, </span><span class="line" data-startTime="1593">just through that one pixel. </span> <span class="line" data-startTime="1595">So we can be simpler </span><span class="line" data-startTime="1595">than that. </span> <span class="line" data-startTime="1597">But we can use this built in </span><span class="line" data-startTime="1597">variable called gl Point </span><span class="line" data-startTime="1601">Coordinate, which is </span><span class="line" data-startTime="1601">within this square. </span> <span class="line" data-startTime="1603">And the point coordinates of the </span><span class="line" data-startTime="1603">square has yet a different </span><span class="line" data-startTime="1606">coordinate system, </span><span class="line" data-startTime="1606">which is great. </span> <span class="line" data-startTime="1607">But it basically runs from </span><span class="line" data-startTime="1607">0, 0 to 1, 1 like that. </span> <span class="line" data-startTime="1611">And so the center of </span><span class="line" data-startTime="1611">it is 0.5, 0.5. </span> <span class="line" data-startTime="1614">So I can say that the distance </span><span class="line" data-startTime="1614">for a particular pixel &mdash; so </span><span class="line" data-startTime="1622">remember, this is running </span><span class="line" data-startTime="1622">per pixel &mdash; </span><span class="line" data-startTime="1624">is equal to the length of gl </span><span class="line" data-startTime="1624">Point Coordinate, the x, y </span><span class="line" data-startTime="1630">components of that, and then </span><span class="line" data-startTime="1630">subtracted from a vector of </span><span class="line" data-startTime="1634">0.5, 0.5, which is the center. </span> <span class="line" data-startTime="1638">And so that's my distance from </span><span class="line" data-startTime="1638">the center of that circle. </span></p>

<p><span class="line" data-startTime="1641">And so I just want to test it. </span> <span class="line" data-startTime="1647">Let's see. </span> <span class="line" data-startTime="1647">Alpha is equal to &mdash; </span><span class="line" data-startTime="1649">if distance is greater than 0.5 </span><span class="line" data-startTime="1649">away, so past that circle, </span><span class="line" data-startTime="1656">then let's make that </span><span class="line" data-startTime="1656">an alpha of 0. </span> <span class="line" data-startTime="1661">Otherwise, let's </span><span class="line" data-startTime="1661">make it opaque. </span> <span class="line" data-startTime="1663">And now we can just multiply </span><span class="line" data-startTime="1663">our color by alpha. </span> <span class="line" data-startTime="1666">And that's not right. </span> <span class="line" data-startTime="1670">Luckily, we have a debugger. </span> <span class="line" data-startTime="1674">No matching overhead found. </span> <span class="line" data-startTime="1678">Which line? </span><span class="line" data-startTime="1681">Vec2. </span> <span class="line" data-startTime="1682">There we go. </span> <span class="line" data-startTime="1683">So now I've clipped everything </span><span class="line" data-startTime="1683">past 0.5 distance away from </span><span class="line" data-startTime="1688">the center, and I've made </span><span class="line" data-startTime="1688">it transparent. </span> <span class="line" data-startTime="1692">And so now, if we look over </span><span class="line" data-startTime="1692">in our points, we </span><span class="line" data-startTime="1694">can do the same thing. </span> <span class="line" data-startTime="1696">And we can make nice </span><span class="line" data-startTime="1696">blue circles. </span> <span class="line" data-startTime="1699">So Already we have a slightly </span><span class="line" data-startTime="1699">better looking map. </span></p>

<p><span class="line" data-startTime="1704">And that's just the start. </span> <span class="line" data-startTime="1710">So the next thing we might want </span><span class="line" data-startTime="1710">to do is, so now have a </span><span class="line" data-startTime="1714">representation. </span> <span class="line" data-startTime="1715">We have our other points </span><span class="line" data-startTime="1715">on the map. </span> <span class="line" data-startTime="1716">And actually, we should </span><span class="line" data-startTime="1716">take a look at this. </span> <span class="line" data-startTime="1717">I've looked at this too much, </span><span class="line" data-startTime="1717">and so I get jaded. </span> <span class="line" data-startTime="1719">So this is about 79,000 ships </span><span class="line" data-startTime="1719">over the last month or two. </span> <span class="line" data-startTime="1726">And they're older than last week </span><span class="line" data-startTime="1726">if they've docked, and </span><span class="line" data-startTime="1731">they stopped there, and actually </span><span class="line" data-startTime="1731">turned off their </span><span class="line" data-startTime="1733">transceiver, or something's </span><span class="line" data-startTime="1733">messed up, or sometimes ships </span><span class="line" data-startTime="1738">even change call </span><span class="line" data-startTime="1738">signs and IDs. </span></p>

<p><span class="line" data-startTime="1740">And so you think the </span><span class="line" data-startTime="1740">ship is gone, but </span><span class="line" data-startTime="1742">really it's a new ship. </span> <span class="line" data-startTime="1743">But you can see lots of </span><span class="line" data-startTime="1743">interesting things. </span> <span class="line" data-startTime="1745">So already, we can tell where </span><span class="line" data-startTime="1745">the major shipping lanes are, </span><span class="line" data-startTime="1748">where a lot of ships are. </span> <span class="line" data-startTime="1751">These are actually, they have </span><span class="line" data-startTime="1751">a slight alpha on them. </span> <span class="line" data-startTime="1754">And so you can see, when they </span><span class="line" data-startTime="1754">really bunch up here, that </span><span class="line" data-startTime="1760">there are quite a few. </span> <span class="line" data-startTime="1761">And then there's amusing things </span><span class="line" data-startTime="1761">like where people are </span><span class="line" data-startTime="1764">very strict about shipping </span><span class="line" data-startTime="1764">lanes, like down here, or </span><span class="line" data-startTime="1769">where they're less strict about </span><span class="line" data-startTime="1769">shipping lanes, where </span><span class="line" data-startTime="1771">they just kind of go for it. </span> <span class="line" data-startTime="1776">And then you can see, obviously, </span><span class="line" data-startTime="1776">one of the busiest </span><span class="line" data-startTime="1778">shipping straits in the world </span><span class="line" data-startTime="1778">is right through here. </span></p>

<p><span class="line" data-startTime="1786">And so a huge number of shipping </span><span class="line" data-startTime="1786">companies pass </span><span class="line" data-startTime="1788">through there. </span> <span class="line" data-startTime="1789">And we can come over here, and </span><span class="line" data-startTime="1789">there's interesting things. </span> <span class="line" data-startTime="1791">You can see the Panama Canal. </span> <span class="line" data-startTime="1794">You can see ships approach </span><span class="line" data-startTime="1794">and come in, and </span><span class="line" data-startTime="1797">then fan back out. </span> <span class="line" data-startTime="1799">It's quite cool. </span> <span class="line" data-startTime="1800">So this is our representation. </span> <span class="line" data-startTime="1801">We can go with this for now. </span> <span class="line" data-startTime="1803">And so we want to start </span><span class="line" data-startTime="1803">mining, is the </span><span class="line" data-startTime="1808">next Ben Fry stage. </span> <span class="line" data-startTime="1810">And so we need data. </span> <span class="line" data-startTime="1811">We need to be able to </span><span class="line" data-startTime="1811">pick into this. </span> <span class="line" data-startTime="1813">And so, when I say picking, </span><span class="line" data-startTime="1813">I mean it. </span></p>

<p><span class="line" data-startTime="1816">So picking points &mdash; picking is </span><span class="line" data-startTime="1816">the kind of classic graphics </span><span class="line" data-startTime="1822">term for literally saying, like, </span><span class="line" data-startTime="1822">I pick that &mdash; like where </span><span class="line" data-startTime="1826">your mouse is. </span> <span class="line" data-startTime="1828">And so it is basically sampling </span><span class="line" data-startTime="1828">what is at that place </span><span class="line" data-startTime="1831">that you clicked and giving </span><span class="line" data-startTime="1831">you something back. </span> <span class="line" data-startTime="1836">Now one of the advantages that </span><span class="line" data-startTime="1836">SVG fans tout about SVG is </span><span class="line" data-startTime="1842">that they're actually </span><span class="line" data-startTime="1842">elements in the DOM. </span> <span class="line" data-startTime="1843">And so you can add a click event </span><span class="line" data-startTime="1843">to it, and then it works </span><span class="line" data-startTime="1847">just like any other click </span><span class="line" data-startTime="1847">event in a browser. </span> <span class="line" data-startTime="1849">And it is great. </span></p>

<p><span class="line" data-startTime="1850">But it runs into trouble when </span><span class="line" data-startTime="1850">you can't really add 80,000 </span><span class="line" data-startTime="1855">points to an SVG element and </span><span class="line" data-startTime="1855">expect it to perform well &mdash; </span><span class="line" data-startTime="1861">yet. </span> <span class="line" data-startTime="1862">They keep improving. </span> <span class="line" data-startTime="1864">So we have to do it manually, </span><span class="line" data-startTime="1864">which is no fun. </span> <span class="line" data-startTime="1867">And so I've written some </span><span class="line" data-startTime="1867">code that does this. </span> <span class="line" data-startTime="1868">And actually, three.js has </span><span class="line" data-startTime="1868">a picking library. </span> <span class="line" data-startTime="1871">I've never used it in 2D. </span> <span class="line" data-startTime="1872">But I think it should work. </span> <span class="line" data-startTime="1874">And so the key is right here, </span><span class="line" data-startTime="1874">the gl.readPixels right here </span><span class="line" data-startTime="1878">in the middle. </span> <span class="line" data-startTime="1879">And what you do is, you </span><span class="line" data-startTime="1879">transform the world so that </span><span class="line" data-startTime="1882">where you just clicked </span><span class="line" data-startTime="1882">is now at 0, 0. </span> <span class="line" data-startTime="1885">And you just say, read me back </span><span class="line" data-startTime="1885">from that OpenGL frame buffer, </span><span class="line" data-startTime="1889">what color is at that pixel? </span><span class="line" data-startTime="1893">And you only want one pixel </span><span class="line" data-startTime="1893">because it's actually quite </span><span class="line" data-startTime="1900">expensive to bring stuff back </span><span class="line" data-startTime="1900">from the GPU, just as it's </span><span class="line" data-startTime="1903">expensive to push things &mdash; </span><span class="line" data-startTime="1904">expensive relative to </span><span class="line" data-startTime="1904">a steady frame rate. </span></p>

<p><span class="line" data-startTime="1906">So you might pay even five </span><span class="line" data-startTime="1906">milliseconds for this call, </span><span class="line" data-startTime="1910">and the latency increases as the </span><span class="line" data-startTime="1910">amount of memory increases </span><span class="line" data-startTime="1915">that you want to bring over. </span> <span class="line" data-startTime="1916">So I included this code just </span><span class="line" data-startTime="1916">because I love typed arrays so </span><span class="line" data-startTime="1918">much right at the top. </span> <span class="line" data-startTime="1920">So what I do is, I first create </span><span class="line" data-startTime="1920">a ReadBytes, and it's a </span><span class="line" data-startTime="1925">Uint8 array. </span> <span class="line" data-startTime="1926">So it's an array </span><span class="line" data-startTime="1926">of four bytes. </span> <span class="line" data-startTime="1928">And then I take a </span><span class="line" data-startTime="1928">pixelReadInt. </span> <span class="line" data-startTime="1930">So the type is Int. </span> <span class="line" data-startTime="1932">And it's an Int32 array of the </span><span class="line" data-startTime="1932">buffer of that Uint8 array. </span> <span class="line" data-startTime="1936">So it's taking that four byte </span><span class="line" data-startTime="1936">array and shoving it into a </span><span class="line" data-startTime="1938">single int. </span> <span class="line" data-startTime="1940">And what's cool about this is, </span><span class="line" data-startTime="1940">when you sample a color from </span><span class="line" data-startTime="1942">the screen, it's an RGBA. </span></p>

<p><span class="line" data-startTime="1944">And it's fitting into </span><span class="line" data-startTime="1944">four bytes. </span> <span class="line" data-startTime="1946">And so I can read those </span><span class="line" data-startTime="1946">separately. </span> <span class="line" data-startTime="1949">It'll be like 255, 128, 36, </span><span class="line" data-startTime="1949">and then 1 or whatever for </span><span class="line" data-startTime="1953">alpha, or 255 for alpha. </span> <span class="line" data-startTime="1957">But then I can look down here </span><span class="line" data-startTime="1957">the bottom, this last line, </span><span class="line" data-startTime="1961">and I can do a look up table </span><span class="line" data-startTime="1961">on the int value of that. </span> <span class="line" data-startTime="1964">So I can make a table </span><span class="line" data-startTime="1964">of values. </span> <span class="line" data-startTime="1967">And as long as my values fit </span><span class="line" data-startTime="1967">into an int, I can then just </span><span class="line" data-startTime="1970">shove them into a color. </span> <span class="line" data-startTime="1972">And OpenGL will just treat </span><span class="line" data-startTime="1972">it as a color. </span> <span class="line" data-startTime="1974">And so that's exactly </span><span class="line" data-startTime="1974">what I've done. </span> <span class="line" data-startTime="1975">So I have an ID for each ship. </span></p>

<p><span class="line" data-startTime="1979">And I shove it into a color. </span> <span class="line" data-startTime="1982">And I never actually draw </span><span class="line" data-startTime="1982">it onscreen, but </span><span class="line" data-startTime="1984">we can look at it. </span> <span class="line" data-startTime="1986">And it's really pretty. </span> <span class="line" data-startTime="1989">It's kind of unpleasant </span><span class="line" data-startTime="1989">to look at. </span> <span class="line" data-startTime="1993">But it doesn't matter because </span><span class="line" data-startTime="1993">we never see it. </span> <span class="line" data-startTime="1995">And it's because each of these </span><span class="line" data-startTime="1995">is a unique color. </span> <span class="line" data-startTime="1997">We have a huge range here. </span> <span class="line" data-startTime="1999">Alpha gets a little tricky, </span><span class="line" data-startTime="1999">but we have at </span><span class="line" data-startTime="2000">least 24 bits of values. </span> <span class="line" data-startTime="2005">And so what happens is, I click </span><span class="line" data-startTime="2005">on here, and I get the </span><span class="line" data-startTime="2010">single pixel that's </span><span class="line" data-startTime="2010">under my mouse. </span> <span class="line" data-startTime="2012">And I read back what that ID. </span> <span class="line" data-startTime="2017">And then I can look up in </span><span class="line" data-startTime="2017">a table to find it. </span> <span class="line" data-startTime="2019">And so let's find out. </span> <span class="line" data-startTime="2020">We actually have different </span><span class="line" data-startTime="2020">amounts of data for different </span><span class="line" data-startTime="2023">types of ship. </span> <span class="line" data-startTime="2023">So here's the New Venture. </span></p>

<p><span class="line" data-startTime="2025">It's a cargo ship. </span> <span class="line" data-startTime="2026">We last saw it on May 5. </span> <span class="line" data-startTime="2028">And it's speeding ahead at 11.8 </span><span class="line" data-startTime="2028">knots on a course of 27.4 </span><span class="line" data-startTime="2033">degrees, so mostly north. </span> <span class="line" data-startTime="2035">And meanwhile, let's find </span><span class="line" data-startTime="2035">a different one with a &mdash; </span><span class="line" data-startTime="2044">there we go. </span> <span class="line" data-startTime="2045">The Falcon traveler, it's </span><span class="line" data-startTime="2045">another cargo ship. </span> <span class="line" data-startTime="2048">But it's traveling south. </span> <span class="line" data-startTime="2051">So we can now do that. </span> <span class="line" data-startTime="2052">And so now, when we see kind of </span><span class="line" data-startTime="2052">curious ships, like say in </span><span class="line" data-startTime="2055">the middle of nowhere in land, </span><span class="line" data-startTime="2055">we can be like, well what's </span><span class="line" data-startTime="2058">going on here. </span> <span class="line" data-startTime="2059">And so we don't have </span><span class="line" data-startTime="2059">a ship name. </span> <span class="line" data-startTime="2063">But we can then use the MMSI, </span><span class="line" data-startTime="2063">which is there, which is kind </span><span class="line" data-startTime="2067">of an ID for it that you have </span><span class="line" data-startTime="2067">to register somewhere. </span></p>

<p><span class="line" data-startTime="2069">And we can look it up. </span> <span class="line" data-startTime="2070">We can look up the country and </span><span class="line" data-startTime="2070">then the registration office. </span> <span class="line" data-startTime="2076">And so usually what happens </span><span class="line" data-startTime="2076">is, it's a mistake. </span> <span class="line" data-startTime="2078">So either the GPS on the ship </span><span class="line" data-startTime="2078">messed up, or there's even </span><span class="line" data-startTime="2082">cases were lightning has struck </span><span class="line" data-startTime="2082">the GPS antenna and </span><span class="line" data-startTime="2086">fried the electronics, and </span><span class="line" data-startTime="2086">suddenly a ship will be </span><span class="line" data-startTime="2088">teleporting all over Earth. </span> <span class="line" data-startTime="2091">And unfortunately, it's very </span><span class="line" data-startTime="2091">difficult to tell if it's a </span><span class="line" data-startTime="2094">mistake or not because a lot of </span><span class="line" data-startTime="2094">this is standardized in a </span><span class="line" data-startTime="2097">way that allows you to &mdash; </span><span class="line" data-startTime="2100">you come on shift, and you're </span><span class="line" data-startTime="2100">just a guy, and you're kind of </span><span class="line" data-startTime="2102">on the deck. </span></p>

<p><span class="line" data-startTime="2103">And you're typing in your ship </span><span class="line" data-startTime="2103">ID, and hopefully you got it </span><span class="line" data-startTime="2105">right because you're </span><span class="line" data-startTime="2105">broadcasting to the </span><span class="line" data-startTime="2107">world who you are. </span> <span class="line" data-startTime="2108">So a lot of it is </span><span class="line" data-startTime="2108">not automated. </span> <span class="line" data-startTime="2110">So it can be very messy. </span> <span class="line" data-startTime="2111">And All the Ships in the World </span><span class="line" data-startTime="2111">covers some of that, how you </span><span class="line" data-startTime="2115">kind of figure out, if two ships </span><span class="line" data-startTime="2115">have the same ID, and </span><span class="line" data-startTime="2117">one's in South America, and </span><span class="line" data-startTime="2117">one's in England, maybe </span><span class="line" data-startTime="2120">they're not the same ship. </span> <span class="line" data-startTime="2121">But then you really hope that </span><span class="line" data-startTime="2121">they never come together </span><span class="line" data-startTime="2122">because then you can't </span><span class="line" data-startTime="2122">tell them apart. </span> <span class="line" data-startTime="2127">OK, so now we have picking. </span> <span class="line" data-startTime="2130">So we can kind of dig </span><span class="line" data-startTime="2130">a little bit deeper. </span> <span class="line" data-startTime="2133">I really like that you can see </span><span class="line" data-startTime="2133">ships on the Mississippi. </span> <span class="line" data-startTime="2135">I think that's awesome. </span> <span class="line" data-startTime="2139">So now we can dig a </span><span class="line" data-startTime="2139">little bit deeper. </span></p>

<p><span class="line" data-startTime="2145">So we actually get more </span><span class="line" data-startTime="2145">complicated data down from the </span><span class="line" data-startTime="2155">server than just x, </span><span class="line" data-startTime="2155">y coordinates. </span> <span class="line" data-startTime="2157">We actually can get a whole </span><span class="line" data-startTime="2157">bunch of attributes that come </span><span class="line" data-startTime="2159">with the ship. </span> <span class="line" data-startTime="2160">So ships actually broadcast </span><span class="line" data-startTime="2160">quite a bit more. </span> <span class="line" data-startTime="2162">They broadcast, as you've seen </span><span class="line" data-startTime="2162">from the info windows, they </span><span class="line" data-startTime="2165">broadcast the direction they're </span><span class="line" data-startTime="2165">travelling, their </span><span class="line" data-startTime="2167">current speed, and then </span><span class="line" data-startTime="2167">some other attributes. </span> <span class="line" data-startTime="2172">And so what we can do is </span><span class="line" data-startTime="2172">actually take those and shove </span><span class="line" data-startTime="2176">those into WebGL as well. </span> <span class="line" data-startTime="2177">And even though they're not </span><span class="line" data-startTime="2177">spatial coordinates, we can </span><span class="line" data-startTime="2179">use those to do the same thing </span><span class="line" data-startTime="2179">we're doing here, color them </span><span class="line" data-startTime="2181">by that value. </span></p>

<p><span class="line" data-startTime="2184">So let's see, is this </span><span class="line" data-startTime="2184">what I want to do? </span><span class="line" data-startTime="2191">Yes. </span> <span class="line" data-startTime="2193">So this is one that seems like </span><span class="line" data-startTime="2193">it's just as ugly as the </span><span class="line" data-startTime="2200">picking one. </span> <span class="line" data-startTime="2201">But actually, you'll start to </span><span class="line" data-startTime="2201">see some coherence in the </span><span class="line" data-startTime="2204">colors, especially around places </span><span class="line" data-startTime="2204">like here, where you </span><span class="line" data-startTime="2208">can see that there's obviously </span><span class="line" data-startTime="2208">a line of ships </span><span class="line" data-startTime="2210">with the same color. </span> <span class="line" data-startTime="2212">And then we come down, and </span><span class="line" data-startTime="2212">you'll see, even here, where </span><span class="line" data-startTime="2215">you have much more distinct, </span><span class="line" data-startTime="2215">it's kind of party colors, </span><span class="line" data-startTime="2221">very distinct shipping lanes. </span> <span class="line" data-startTime="2223">And so what we're doing is, </span><span class="line" data-startTime="2223">I'm not a designer. </span></p>

<p><span class="line" data-startTime="2227">If I was, this would </span><span class="line" data-startTime="2227">look prettier. </span> <span class="line" data-startTime="2229">But what I'm doing is just </span><span class="line" data-startTime="2229">taking the course that the </span><span class="line" data-startTime="2232">ship is traveling in, and just </span><span class="line" data-startTime="2232">taking the color wheel of hues </span><span class="line" data-startTime="2237">and assigning a direction </span><span class="line" data-startTime="2237">to a hue. </span> <span class="line" data-startTime="2239">So north is red, and then </span><span class="line" data-startTime="2239">it goes from there. </span> <span class="line" data-startTime="2242">And so what we can see </span><span class="line" data-startTime="2242">here is coherence </span><span class="line" data-startTime="2244">in direction traveling. </span> <span class="line" data-startTime="2247">And so remember, we're just </span><span class="line" data-startTime="2247">exploring data here. </span> <span class="line" data-startTime="2249">You wouldn't want to send </span><span class="line" data-startTime="2249">this to your end user. </span> <span class="line" data-startTime="2252">But you can start to see, first </span><span class="line" data-startTime="2252">of all, you can sanity </span><span class="line" data-startTime="2254">check is my data correct? </span><span class="line" data-startTime="2255">Like, yes, so if I look in the </span><span class="line" data-startTime="2255">Suez Canal, typically, ships </span><span class="line" data-startTime="2259">are moving in the </span><span class="line" data-startTime="2259">same direction. </span> <span class="line" data-startTime="2261">You might lose your heading if </span><span class="line" data-startTime="2261">you're still, for instance. </span> <span class="line" data-startTime="2264">So we can't be totally sure that </span><span class="line" data-startTime="2264">those aren't errors, but </span><span class="line" data-startTime="2268">we see enough coherence that </span><span class="line" data-startTime="2268">this is actually a valuable </span><span class="line" data-startTime="2274">insight into the data. </span></p>

<p><span class="line" data-startTime="2275">And then we can also start </span><span class="line" data-startTime="2275">seeing things like this where, </span><span class="line" data-startTime="2278">as a person who doesn't know </span><span class="line" data-startTime="2278">that much about shipping, I </span><span class="line" data-startTime="2280">immediately suspect that this </span><span class="line" data-startTime="2280">is a major shipping channel. </span> <span class="line" data-startTime="2282">And that it must be either </span><span class="line" data-startTime="2282">advantageous enough to cut </span><span class="line" data-startTime="2287">across like this because it's </span><span class="line" data-startTime="2287">a short distance, and it's </span><span class="line" data-startTime="2290">near the equator, so it could </span><span class="line" data-startTime="2290">be a great circle, or it's </span><span class="line" data-startTime="2295">some kind of mandated thing </span><span class="line" data-startTime="2295">by governments, or </span><span class="line" data-startTime="2297">something like that. </span> <span class="line" data-startTime="2298">And you can even see, as you get </span><span class="line" data-startTime="2298">close, that the ships on </span><span class="line" data-startTime="2301">top are very distinctively going </span><span class="line" data-startTime="2301">269, which is west for </span><span class="line" data-startTime="2314">you, that way. </span> <span class="line" data-startTime="2315">And then the guys in the bottom </span><span class="line" data-startTime="2315">are going the opposite </span><span class="line" data-startTime="2318">way, almost directly. </span> <span class="line" data-startTime="2319">So almost directly east/west. </span></p>

<p><span class="line" data-startTime="2324">So that's great. </span> <span class="line" data-startTime="2324">And in fact, you can assign </span><span class="line" data-startTime="2324">any color to those </span><span class="line" data-startTime="2327">things that you want. </span> <span class="line" data-startTime="2329">So then the last thing is that </span><span class="line" data-startTime="2329">you want to start getting </span><span class="line" data-startTime="2333">insight into more than that. </span> <span class="line" data-startTime="2338">So we can look at this, and it's </span><span class="line" data-startTime="2338">difficult because there's </span><span class="line" data-startTime="2340">a lot of data on screen. </span> <span class="line" data-startTime="2341">It's difficult to get a feel </span><span class="line" data-startTime="2341">for what's going on, </span><span class="line" data-startTime="2344">especially in confettiville </span><span class="line" data-startTime="2344">over here in the Gulf. </span> <span class="line" data-startTime="2349">And this isn't unexpected. </span> <span class="line" data-startTime="2351">There's actually a bunch of oil </span><span class="line" data-startTime="2351">platforms out here, and </span><span class="line" data-startTime="2353">ships that to go to and </span><span class="line" data-startTime="2353">from, and then a bunch </span><span class="line" data-startTime="2355">of tankers as well. </span> <span class="line" data-startTime="2356">And oil platforms, I didn't know </span><span class="line" data-startTime="2356">this until recently, oil </span><span class="line" data-startTime="2358">platforms actually </span><span class="line" data-startTime="2358">count as ships. </span> <span class="line" data-startTime="2360">And so they actually broadcast </span><span class="line" data-startTime="2360">their IDs because I guess </span><span class="line" data-startTime="2363">they're tethered, and actually, </span><span class="line" data-startTime="2363">they might be </span><span class="line" data-startTime="2366">drilling, unless they're </span><span class="line" data-startTime="2366">refineries. </span></p>

<p><span class="line" data-startTime="2369">But they're floating. </span> <span class="line" data-startTime="2372">And this is also &mdash; </span><span class="line" data-startTime="2374">like, party town. </span> <span class="line" data-startTime="2378">So what we can do is actually </span><span class="line" data-startTime="2378">get another </span><span class="line" data-startTime="2381">view into the data. </span> <span class="line" data-startTime="2382">And so I actually really </span><span class="line" data-startTime="2382">like this. </span> <span class="line" data-startTime="2384">And it's difficult to explain </span><span class="line" data-startTime="2384">why because it's not that </span><span class="line" data-startTime="2390">interesting. </span> <span class="line" data-startTime="2391">But if you think of the classic </span><span class="line" data-startTime="2391">model view controller, </span><span class="line" data-startTime="2397">we've actually kind of split </span><span class="line" data-startTime="2397">both the model and the view &mdash; </span><span class="line" data-startTime="2403">well, depending on how you </span><span class="line" data-startTime="2403">define them, but whatever &mdash; </span><span class="line" data-startTime="2406">into a GPU side and </span><span class="line" data-startTime="2406">a CPU side. </span> <span class="line" data-startTime="2409">So we have a GPU side that's </span><span class="line" data-startTime="2409">taken, we've loaded all of our </span><span class="line" data-startTime="2412">data over there. </span> <span class="line" data-startTime="2413">And the only things that we </span><span class="line" data-startTime="2413">sent over are things like, </span><span class="line" data-startTime="2415">well, here are the lat longs, </span><span class="line" data-startTime="2415">so only draw the things in </span><span class="line" data-startTime="2417">that lat long. </span></p>

<p><span class="line" data-startTime="2418">And only scale it by this </span><span class="line" data-startTime="2418">amount, and don't draw </span><span class="line" data-startTime="2420">anything off the screen. </span> <span class="line" data-startTime="2422">Meanwhile, on the CPU side, </span><span class="line" data-startTime="2422">I do things like read </span><span class="line" data-startTime="2424">back from the GPU. </span> <span class="line" data-startTime="2425">But all I'm reading back </span><span class="line" data-startTime="2425">is that one index. </span> <span class="line" data-startTime="2427">And so we can take that further </span><span class="line" data-startTime="2427">and actually do </span><span class="line" data-startTime="2429">computations on the CPU. </span> <span class="line" data-startTime="2430">And that's great because the </span><span class="line" data-startTime="2430">CPU is not doing anything </span><span class="line" data-startTime="2432">while the GPU is crunching </span><span class="line" data-startTime="2432">away at these numbers. </span> <span class="line" data-startTime="2435">And if we really want to get </span><span class="line" data-startTime="2435">those fans at full speed, what </span><span class="line" data-startTime="2438">we can do is actually </span><span class="line" data-startTime="2438">plot things. </span> <span class="line" data-startTime="2444">You see that? </span><span class="line" data-startTime="2446">I wonder if I can &mdash; </span><span class="line" data-startTime="2452">yeah, well, the country's </span><span class="line" data-startTime="2452">all messed up now. </span></p>

<p><span class="line" data-startTime="2458">There we go. </span> <span class="line" data-startTime="2458">So we lost some crispness. </span> <span class="line" data-startTime="2462">But that's OK. </span> <span class="line" data-startTime="2462">It's better to see this big. </span> <span class="line" data-startTime="2465">So what this is, it's </span><span class="line" data-startTime="2465">a histogram of the </span><span class="line" data-startTime="2467">speeds of the ships. </span> <span class="line" data-startTime="2470">And it changes as </span><span class="line" data-startTime="2470">we go around. </span> <span class="line" data-startTime="2471">It actually changes the </span><span class="line" data-startTime="2471">current view of the </span><span class="line" data-startTime="2473">speeds of the ship. </span> <span class="line" data-startTime="2476">So first of all, the thing </span><span class="line" data-startTime="2476">that always wins </span><span class="line" data-startTime="2478">is zero over here. </span> <span class="line" data-startTime="2479">So there's always enough ships </span><span class="line" data-startTime="2479">at rest that that's going to </span><span class="line" data-startTime="2482">be the biggest bucket. </span> <span class="line" data-startTime="2482">And in fact, the bucket goes </span><span class="line" data-startTime="2482">like up to India here, but I </span><span class="line" data-startTime="2488">clipped it off because it makes </span><span class="line" data-startTime="2488">everything else very </span><span class="line" data-startTime="2490">small if I normalize by that. </span> <span class="line" data-startTime="2492">And so remember, this </span><span class="line" data-startTime="2492">is a distribution. </span> <span class="line" data-startTime="2493">So this not a bar graph </span><span class="line" data-startTime="2493">of the total. </span> <span class="line" data-startTime="2496">This is just taking a look at, </span><span class="line" data-startTime="2496">if you count the current ships </span><span class="line" data-startTime="2500">on screen as 100%, this is </span><span class="line" data-startTime="2500">a division of that full </span><span class="line" data-startTime="2505">distribution. </span></p>

<p><span class="line" data-startTime="2507">So you can normalize in your </span><span class="line" data-startTime="2507">head by root 2 pi whatever. </span> <span class="line" data-startTime="2514">So what's interesting about this </span><span class="line" data-startTime="2514">is, you can start to see, </span><span class="line" data-startTime="2516">well A, everybody seems to </span><span class="line" data-startTime="2516">travel at about 12 knots, </span><span class="line" data-startTime="2519">which is a little slower than </span><span class="line" data-startTime="2519">I would've thought. </span> <span class="line" data-startTime="2523">But you can see definite </span><span class="line" data-startTime="2523">patterns. </span> <span class="line" data-startTime="2525">So where's a good pattern? </span><span class="line" data-startTime="2527">So off this Eastern Seaboard, </span><span class="line" data-startTime="2527">people are kind of doing a lot </span><span class="line" data-startTime="2532">of shipping. </span> <span class="line" data-startTime="2534">And so you have these </span><span class="line" data-startTime="2534">ships coming in </span><span class="line" data-startTime="2536">from across the ocean. </span> <span class="line" data-startTime="2537">And so they're tending to go </span><span class="line" data-startTime="2537">pretty fast because you spend </span><span class="line" data-startTime="2542">more time at sea, the more </span><span class="line" data-startTime="2542">expensive it is. </span> <span class="line" data-startTime="2544">But as I was mentioning, </span><span class="line" data-startTime="2544">in the Gulf </span><span class="line" data-startTime="2546">it's quite a bit different. </span></p>

<p><span class="line" data-startTime="2548">You actually have </span><span class="line" data-startTime="2548">very slow ships. </span> <span class="line" data-startTime="2550">So first all, your </span><span class="line" data-startTime="2550">oil platforms </span><span class="line" data-startTime="2551">aren't necessarily moving. </span> <span class="line" data-startTime="2553">They might fall in </span><span class="line" data-startTime="2553">the 0 category. </span> <span class="line" data-startTime="2554">But the ships that service </span><span class="line" data-startTime="2554">them are also quite slow. </span> <span class="line" data-startTime="2556">And so you actually have, as you </span><span class="line" data-startTime="2556">come around here, you have </span><span class="line" data-startTime="2558">this really nice bimodal </span><span class="line" data-startTime="2558">distribution which you never </span><span class="line" data-startTime="2561">get to see enough of where you </span><span class="line" data-startTime="2561">have definite slow ships, and </span><span class="line" data-startTime="2564">you have fast ships. </span></p>

<p><span class="line" data-startTime="2565">And so this can help you start </span><span class="line" data-startTime="2565">to investigate your data. </span> <span class="line" data-startTime="2568">And then you can start looking </span><span class="line" data-startTime="2568">at things, like, so what I've </span><span class="line" data-startTime="2570">done here is actually, </span><span class="line" data-startTime="2570">it's hard to tell. </span> <span class="line" data-startTime="2572">But I've actually colored it. </span> <span class="line" data-startTime="2574">I'm bending by everything that's </span><span class="line" data-startTime="2574">this light blue, which </span><span class="line" data-startTime="2579">is an unfortunate choice, but </span><span class="line" data-startTime="2579">that's OK, is not moving. </span> <span class="line" data-startTime="2584">And everything that's dark blue </span><span class="line" data-startTime="2584">is moving at some speed. </span> <span class="line" data-startTime="2587">And you can even color </span><span class="line" data-startTime="2587">it the same way </span><span class="line" data-startTime="2589">that we do with course. </span> <span class="line" data-startTime="2591">So that's looking this thing. </span> <span class="line" data-startTime="2593">And this is, I should say, this </span><span class="line" data-startTime="2593">is using the Crossfilter </span><span class="line" data-startTime="2596">library, that comes from &mdash; </span><span class="line" data-startTime="2597">Mike Bostock wrote it. </span> <span class="line" data-startTime="2598">And then it's drawing with D3, </span><span class="line" data-startTime="2598">which Mike Bostock also wrote, </span><span class="line" data-startTime="2602">is the little histogram. </span> <span class="line" data-startTime="2603">It's basically the simplest </span><span class="line" data-startTime="2603">little histogram </span><span class="line" data-startTime="2605">that you can write. </span></p>

<p><span class="line" data-startTime="2606">But you can drop this in for any </span><span class="line" data-startTime="2606">variable in the data set. </span> <span class="line" data-startTime="2609">And actually, so this afternoon, </span><span class="line" data-startTime="2609">when All the Ships </span><span class="line" data-startTime="2612">in the World shows, we actually </span><span class="line" data-startTime="2612">have a few more that </span><span class="line" data-startTime="2614">we can show that time, but </span><span class="line" data-startTime="2614">I need to press on. </span> <span class="line" data-startTime="2619">So the last thing I wanted to </span><span class="line" data-startTime="2619">show before we go to questions </span><span class="line" data-startTime="2624">is that here, I showed that </span><span class="line" data-startTime="2624">you can clip the alpha and </span><span class="line" data-startTime="2629">have a distinct circle. </span> <span class="line" data-startTime="2630">And so this is actually drawing </span><span class="line" data-startTime="2630">a square still, but </span><span class="line" data-startTime="2632">it's just drawing invisible </span><span class="line" data-startTime="2632">pixels around a circle. </span> <span class="line" data-startTime="2637">But there's no reason that </span><span class="line" data-startTime="2637">we have to do that. </span> <span class="line" data-startTime="2639">So what we could do instead is </span><span class="line" data-startTime="2639">actually draw with functions. </span> <span class="line" data-startTime="2644">So for instance, instead of </span><span class="line" data-startTime="2644">doing distance as this link </span><span class="line" data-startTime="2647">and then cutting off the alpha, </span><span class="line" data-startTime="2647">we could, instead, do </span><span class="line" data-startTime="2650">something like take the distance </span><span class="line" data-startTime="2650">and set it equal to 1 </span><span class="line" data-startTime="2659">minus dist times 2. </span></p>

<p><span class="line" data-startTime="2664">And so if you remember the </span><span class="line" data-startTime="2664">distance to the edge is 0.5 </span><span class="line" data-startTime="2667">because that's the edge </span><span class="line" data-startTime="2667">of the circle. </span> <span class="line" data-startTime="2669">So we multiply it by </span><span class="line" data-startTime="2669">2 to get to one. </span> <span class="line" data-startTime="2671">And then we invert it so that </span><span class="line" data-startTime="2671">zero's at the center. </span> <span class="line" data-startTime="2675">No, one is at the </span><span class="line" data-startTime="2675">center, yeah. </span> <span class="line" data-startTime="2677">And so now, if we </span><span class="line" data-startTime="2677">take this dist &mdash; </span><span class="line" data-startTime="2682">actually no, we want to do </span><span class="line" data-startTime="2682">one thing, just in case. </span> <span class="line" data-startTime="2684">dist equals max 0. </span> <span class="line" data-startTime="2689">So we clamp it at zero so we </span><span class="line" data-startTime="2689">don't draw out of range. </span> <span class="line" data-startTime="2692">We can now do something </span><span class="line" data-startTime="2692">like this. </span> <span class="line" data-startTime="2695">And what you see is, you </span><span class="line" data-startTime="2695">quickly get a function. </span></p>

<p><span class="line" data-startTime="2700">Or it's a fall off function </span><span class="line" data-startTime="2700">that's put on top of that dot. </span> <span class="line" data-startTime="2705">So you can do anything here. </span> <span class="line" data-startTime="2706">And you can do quite </span><span class="line" data-startTime="2706">complicated things. </span> <span class="line" data-startTime="2709">And so what you can start </span><span class="line" data-startTime="2709">thinking about is taking </span><span class="line" data-startTime="2711">functions and geometry, and </span><span class="line" data-startTime="2711">what's called convolving them, </span><span class="line" data-startTime="2715">and so you can actually have a </span><span class="line" data-startTime="2715">function that's spread out </span><span class="line" data-startTime="2718">over geometry. </span> <span class="line" data-startTime="2719">And that's the last thing </span><span class="line" data-startTime="2719">I wanted to show you. </span> <span class="line" data-startTime="2721">If we think about, instead of </span><span class="line" data-startTime="2721">points, we say, OK, so this is </span><span class="line" data-startTime="2726">the latest positions </span><span class="line" data-startTime="2726">of these ships. </span> <span class="line" data-startTime="2727">What about if we look at the </span><span class="line" data-startTime="2727">paths that these ships have </span><span class="line" data-startTime="2731">actually traveled? </span><span class="line" data-startTime="2732">So that was about </span><span class="line" data-startTime="2732">79,000 ships. </span> <span class="line" data-startTime="2736">And instead, we're going to </span><span class="line" data-startTime="2736">look at about 20,000. </span></p>

<p><span class="line" data-startTime="2739">So less ships, but we're </span><span class="line" data-startTime="2739">actually going to look at a </span><span class="line" data-startTime="2741">bunch of data points per ship. </span> <span class="line" data-startTime="2742">And so we're going to end </span><span class="line" data-startTime="2742">up with about two </span><span class="line" data-startTime="2744">million paths on screen. </span> <span class="line" data-startTime="2771">So you should see, </span><span class="line" data-startTime="2771">there we go. </span> <span class="line" data-startTime="2777">It's a little difficult to </span><span class="line" data-startTime="2777">see with these lights. </span> <span class="line" data-startTime="2779">That's unfortunate. </span> <span class="line" data-startTime="2780">So what you can see now is, as </span><span class="line" data-startTime="2780">we zoom in, you can actually </span><span class="line" data-startTime="2783">see these ships moving. </span> <span class="line" data-startTime="2785">And you can see some of the </span><span class="line" data-startTime="2785">errors in the data where they </span><span class="line" data-startTime="2787">cut across Saudi Arabia. </span> <span class="line" data-startTime="2788">Probably, that's just the </span><span class="line" data-startTime="2788">sampling of the data. </span></p>

<p><span class="line" data-startTime="2791">If the ship has made it around </span><span class="line" data-startTime="2791">the cape there in a day, then </span><span class="line" data-startTime="2795">they'll be drawn straight </span><span class="line" data-startTime="2795">through it. </span> <span class="line" data-startTime="2797">But you can quickly see, as it </span><span class="line" data-startTime="2797">builds up, that you can see </span><span class="line" data-startTime="2801">those same shipping </span><span class="line" data-startTime="2801">lanes building up. </span> <span class="line" data-startTime="2803">And we can do things like fall </span><span class="line" data-startTime="2803">off to blue and more </span><span class="line" data-startTime="2808">transparent over time. </span> <span class="line" data-startTime="2810">And so the newer ships, the </span><span class="line" data-startTime="2810">ships that are actually </span><span class="line" data-startTime="2813">passing by, are these </span><span class="line" data-startTime="2813">bright orange. </span> <span class="line" data-startTime="2815">And the older ships are </span><span class="line" data-startTime="2815">the darker pink. </span></p>

<p><span class="line" data-startTime="2818">And then we can do things. </span> <span class="line" data-startTime="2820">It's difficult to see, but it's </span><span class="line" data-startTime="2820">easier &mdash; you can come put </span><span class="line" data-startTime="2825">to the sandbox afterwards and </span><span class="line" data-startTime="2825">come see for yourself at full. </span> <span class="line" data-startTime="2828">It's a Retina screen, too. </span> <span class="line" data-startTime="2831">But what we're actually doing </span><span class="line" data-startTime="2831">is taking an error function. </span> <span class="line" data-startTime="2834">And we're putting that </span><span class="line" data-startTime="2834">over the line. </span> <span class="line" data-startTime="2835">So it's not just a line. </span> <span class="line" data-startTime="2836">It's also an error function. </span> <span class="line" data-startTime="2837">And it's an attempt I'm kind </span><span class="line" data-startTime="2837">of playing around with &mdash; </span><span class="line" data-startTime="2839">can we take GPS error and </span><span class="line" data-startTime="2839">kind of visualize it. </span></p>

<p><span class="line" data-startTime="2842">So we have an uncertainty </span><span class="line" data-startTime="2842">of where the ship is. </span> <span class="line" data-startTime="2844">We know it was here, and we </span><span class="line" data-startTime="2844">know it was here with some </span><span class="line" data-startTime="2847">amount of error. </span> <span class="line" data-startTime="2848">And we know it got between </span><span class="line" data-startTime="2848">them somehow. </span> <span class="line" data-startTime="2850">And so we want to start </span><span class="line" data-startTime="2850">thinking about, can we </span><span class="line" data-startTime="2853">quantify the error? </span><span class="line" data-startTime="2854">And can we draw it by actually </span><span class="line" data-startTime="2854">spreading out and kind of </span><span class="line" data-startTime="2856">having a sum of all possible </span><span class="line" data-startTime="2856">ships that go through. </span> <span class="line" data-startTime="2860">And so it's a pretty fun area. </span> <span class="line" data-startTime="2862">And I think we're just </span><span class="line" data-startTime="2862">starting with </span><span class="line" data-startTime="2865">that particular thing. </span> <span class="line" data-startTime="2867">But polylines are something that </span><span class="line" data-startTime="2867">have been ignored for too </span><span class="line" data-startTime="2870">long as kind of an interesting </span><span class="line" data-startTime="2870">geometric thing, especially in </span><span class="line" data-startTime="2874">Maps because while we can draw </span><span class="line" data-startTime="2874">polylines, it turns out </span><span class="line" data-startTime="2878">polylines are expensive, and in </span><span class="line" data-startTime="2878">many ways, more expensive </span><span class="line" data-startTime="2880">than polygons to draw. </span></p>

<p><span class="line" data-startTime="2883">And I did want to show just </span><span class="line" data-startTime="2883">a couple of things. </span> <span class="line" data-startTime="2886">I can leave while I </span><span class="line" data-startTime="2886">go for questions. </span> <span class="line" data-startTime="2888">But you can see already some </span><span class="line" data-startTime="2888">interesting things that we </span><span class="line" data-startTime="2891">couldn't pick up in just </span><span class="line" data-startTime="2891">the point data </span><span class="line" data-startTime="2893">like, here around Iceland &mdash; </span><span class="line" data-startTime="2900">there they are. </span> <span class="line" data-startTime="2901">You'll see there's definite </span><span class="line" data-startTime="2901">ships that are tracking and </span><span class="line" data-startTime="2904">doing cargo. </span> <span class="line" data-startTime="2905">But then as we get close to </span><span class="line" data-startTime="2905">the end here, you'll see </span><span class="line" data-startTime="2908">fishing vessels go out and </span><span class="line" data-startTime="2908">kind of swirl around </span><span class="line" data-startTime="2911">and come back in. </span> <span class="line" data-startTime="2912">And you can only see that </span><span class="line" data-startTime="2912">pretty much through the </span><span class="line" data-startTime="2914">behavior of the lines, which </span><span class="line" data-startTime="2914">is pretty cool to see. </span></p>

<p><span class="line" data-startTime="2917">So I'll open it up </span><span class="line" data-startTime="2917">for questions. </span> <span class="line" data-startTime="2919">We have about eight minutes. </span> <span class="line" data-startTime="2920">I apologize for going over. </span> <span class="line" data-startTime="2923">There's a lot more to show. </span> <span class="line" data-startTime="2924">So I'll just kind of &mdash; </span><span class="line" data-startTime="2926">I like this area </span><span class="line" data-startTime="2926">in Alaska, too. </span> <span class="line" data-startTime="2928">But so I just wanted </span><span class="line" data-startTime="2928">to say thank you. </span> <span class="line" data-startTime="2933">And as I said, there's a bunch </span><span class="line" data-startTime="2933">of resources online, a bunch </span><span class="line" data-startTime="2937">of libraries for WebGL. </span> <span class="line" data-startTime="2939">CanvasLayer, if you look for </span><span class="line" data-startTime="2939">it, it has two sample apps, </span><span class="line" data-startTime="2943">they are very simple, a 2D app </span><span class="line" data-startTime="2943">and a WebGL app just to get </span><span class="line" data-startTime="2945">you started. </span></p>

<p><span class="line" data-startTime="2946">And the 2D app does, I think, </span><span class="line" data-startTime="2946">exactly what you saw. </span> <span class="line" data-startTime="2949">It draws a square. </span> <span class="line" data-startTime="2950">And the WebGL app just generates </span><span class="line" data-startTime="2950">a bunch of random </span><span class="line" data-startTime="2952">points and plops them </span><span class="line" data-startTime="2952">down on a map. </span> <span class="line" data-startTime="2954">So you can kind of use </span><span class="line" data-startTime="2954">it and copy it. </span> <span class="line" data-startTime="2956">And I think there was even a </span><span class="line" data-startTime="2956">blog post where somebody </span><span class="line" data-startTime="2958">deciphered my code and </span><span class="line" data-startTime="2958">made it nicer. </span> <span class="line" data-startTime="2960">So you might look </span><span class="line" data-startTime="2960">for that, too. </span> <span class="line" data-startTime="2962">So if anybody has questions, </span><span class="line" data-startTime="2962">please come up to </span><span class="line" data-startTime="2966">the mic and ask away. </span></p>

<p class="speaker"><span class="line" data-starttime="2969"><span class="speakerName">Audience</span>: So when you're </span><span class="line" data-startTime="2969">coloring on a pixel by pixel </span><span class="line" data-startTime="2972">basis, how do you do things </span><span class="line" data-startTime="2972">like sprites? </span><span class="line" data-startTime="2974">Do you have a buffer that </span><span class="line" data-startTime="2974">represents the sprites, then </span><span class="line" data-startTime="2976">you look at the pixel offset in </span><span class="line" data-startTime="2976">there and draw that color </span><span class="line" data-startTime="2978">at that exact point? </span><span class="line" data-startTime="2980">Or how do you do more complex </span><span class="line" data-startTime="2980">things than dots? </span></p>

<p class="speaker"><span class="line" data-starttime="2983"><span class="speakerName">Brendan Kenny</span>: Oh, more complex </span><span class="line" data-startTime="2983">things than dots? </span><span class="line" data-startTime="2984">So you were asking about </span><span class="line" data-startTime="2984">sprites, like image sprites? </span><span class="line" data-startTime="2988">Yeah, so obviously this </span><span class="line" data-startTime="2988">3D stuff is used for </span><span class="line" data-startTime="2992">games all the time. </span> <span class="line" data-startTime="2993">And so games are often </span><span class="line" data-startTime="2993">based on, actually, </span><span class="line" data-startTime="2996">texturing and things. </span> <span class="line" data-startTime="2996">And so, yeah, you just </span><span class="line" data-startTime="2996">load up a bunch of </span><span class="line" data-startTime="2998">images onto your GPU. </span> <span class="line" data-startTime="2999">And then you can just get </span><span class="line" data-startTime="2999">those pixel offsets. </span> <span class="line" data-startTime="3003">The same thing I was using for </span><span class="line" data-startTime="3003">the function to do a distance, </span><span class="line" data-startTime="3005">you can use that to look </span><span class="line" data-startTime="3005">up into your sprite. </span> <span class="line" data-startTime="3007">And you say, like, this </span><span class="line" data-startTime="3007">is a gray pixel. </span> <span class="line" data-startTime="3009">This is a red pixel. </span> <span class="line" data-startTime="3010">This is a gray pixel. </span></p>

<p><span class="line" data-startTime="3011">And it seems like it would </span><span class="line" data-startTime="3011">be slow, but it's not. </span> <span class="line" data-startTime="3013">And you get your little 2D </span><span class="line" data-startTime="3013">sprite art before you know it. </span> <span class="line" data-startTime="3018">So that's typically </span><span class="line" data-startTime="3018">what you do. </span></p>

<p class="speaker"><span class="line" data-starttime="3019"><span class="speakerName">Audience</span>: And also, is that </span><span class="line" data-startTime="3019">shader playground that you </span><span class="line" data-startTime="3022">used to interactively </span><span class="line" data-startTime="3022">show the changes, is </span><span class="line" data-startTime="3025">that available online? </span></p>

<p class="speaker"><span class="line" data-starttime="3026"><span class="speakerName">Brendan Kenny</span>: I can </span><span class="line" data-startTime="3026">put it online. </span><span class="line" data-startTime="3027">It's dead simple, but yeah, </span><span class="line" data-startTime="3027">I can put it online. </span></p>

<p class="speaker"><span class="line" data-starttime="3032"><span class="speakerName">Audience</span>: Hi, yeah, I have a </span><span class="line" data-startTime="3032">simple question about plotting </span><span class="line" data-startTime="3037">the items on the map. </span><span class="line" data-startTime="3039">So would it be possible for </span><span class="line" data-startTime="3039">those points to have like an </span><span class="line" data-startTime="3047">additional bigger circles, </span><span class="line" data-startTime="3047">like the radius? </span><span class="line" data-startTime="3050">So my current project is, I need </span><span class="line" data-startTime="3050">to have a visualization </span><span class="line" data-startTime="3055">for overlapping schools, public </span><span class="line" data-startTime="3055">schools, particularly, </span><span class="line" data-startTime="3059">in the Philippines. </span><span class="line" data-startTime="3060">So I would need to have a range </span><span class="line" data-startTime="3060">of five kilometers. </span><span class="line" data-startTime="3065">I need to indicate if there are </span><span class="line" data-startTime="3065">overlapping schools within </span><span class="line" data-startTime="3070">a five kilometer radius. </span></p>

<p class="speaker"><span class="line" data-starttime="3072"><span class="speakerName">Brendan Kenny</span>: So how many </span><span class="line" data-startTime="3072">schools are you talking about? </span></p>

<p class="speaker"><span class="line" data-starttime="3075"><span class="speakerName">Audience</span>: I would be plotting </span><span class="line" data-startTime="3075">around 70,000 schools. </span></p>

<p class="speaker"><span class="line" data-starttime="3078"><span class="speakerName">Brendan Kenny</span>: Oh, so a lot. </span><span class="line" data-startTime="3079">OK, so yes. </span><span class="line" data-startTime="3080">So I actually limited the </span><span class="line" data-startTime="3080">circles because they get so </span><span class="line" data-startTime="3083">big after a while that </span><span class="line" data-startTime="3083">you lose all context. </span><span class="line" data-startTime="3086">You can't see the map anymore. </span><span class="line" data-startTime="3087">But yes, they can be </span><span class="line" data-startTime="3087">arbitrarily big. </span><span class="line" data-startTime="3090">There are some limits with point </span><span class="line" data-startTime="3090">sprites, but you can </span><span class="line" data-startTime="3093">then just switch to triangles </span><span class="line" data-startTime="3093">and pretending </span><span class="line" data-startTime="3095">they're point sprites. </span></p>

<p class="speaker"><span class="line" data-starttime="3096"><span class="speakerName">Audience</span>: OK, so that's </span><span class="line" data-startTime="3096">possible, right? </span><span class="line" data-startTime="3098">So I could like mark it as red </span><span class="line" data-startTime="3098">for those schools who overlap </span><span class="line" data-startTime="3105">for, let's say, I could adjust </span><span class="line" data-startTime="3105">it like 2 kilometers, 5 </span><span class="line" data-startTime="3111">kilometers. </span></p>

<p class="speaker"><span class="line" data-starttime="3111"><span class="speakerName">Brendan Kenny</span>: Yeah, so there's </span><span class="line" data-startTime="3111">a couple of different </span><span class="line" data-startTime="3112">ways you could do that. </span> <span class="line" data-startTime="3113">You can just do it with </span><span class="line" data-startTime="3113">plain color if it's </span><span class="line" data-startTime="3115">just for visual display. </span> <span class="line" data-startTime="3116">You could also use what's called </span><span class="line" data-startTime="3116">the stencil buffer, </span><span class="line" data-startTime="3118">where you can actually use, it's </span><span class="line" data-startTime="3118">like a secondary buffer, </span><span class="line" data-startTime="3120">where you can do more logical </span><span class="line" data-startTime="3120">operations like checking for </span><span class="line" data-startTime="3124">intersections and things </span><span class="line" data-startTime="3124">like that. </span> <span class="line" data-startTime="3125">And you can even do something, </span><span class="line" data-startTime="3125">if you had the colors, you </span><span class="line" data-startTime="3128">could then do that read back </span><span class="line" data-startTime="3128">thing that I did for picking. </span> <span class="line" data-startTime="3131">And you could even read the </span><span class="line" data-startTime="3131">color back and know, like, OK, </span><span class="line" data-startTime="3133">this is the intersection of this </span><span class="line" data-startTime="3133">kind of school and this </span><span class="line" data-startTime="3135">kind of school, if you </span><span class="line" data-startTime="3135">wanted to do that. </span></p>

<p><span class="line" data-startTime="3137">It might be faster do that </span><span class="line" data-startTime="3137">side on the CPU. </span> <span class="line" data-startTime="3139">It's always a trade off. </span> <span class="line" data-startTime="3140">But sometimes it's easier to </span><span class="line" data-startTime="3140">just shove it on the GPU and </span><span class="line" data-startTime="3142">say, take care of it. </span> <span class="line" data-startTime="3143">And GPUs tend to be so fast </span><span class="line" data-startTime="3143">these days that, at least for </span><span class="line" data-startTime="3147">a prototype, it's fast enough. </span> <span class="line" data-startTime="3150">And then you just need to </span><span class="line" data-startTime="3150">evaluate on real hardware and </span><span class="line" data-startTime="3152">see if it's fast enough there. </span></p>

<p class="speaker"><span class="line" data-starttime="3154"><span class="speakerName">Audience</span>: OK, thank you. </span></p>

<p class="speaker"><span class="line" data-starttime="3154"><span class="speakerName">Brendan Kenny</span>: Yeah. </span></p>

<p class="speaker"><span class="line" data-starttime="3157"><span class="speakerName">Audience</span>: Hi, can you </span><span class="line" data-startTime="3157">obtain a similar </span><span class="line" data-startTime="3159">effect on Google Earth? </span><span class="line" data-startTime="3160">And can you do it sharing </span><span class="line" data-startTime="3160">the same pieces of code? </span></p>

<p class="speaker"><span class="line" data-starttime="3165"><span class="speakerName">Brendan Kenny</span>: It would </span><span class="line" data-startTime="3165">be awesome to do </span><span class="line" data-startTime="3167">it in Google Earth. </span> <span class="line" data-startTime="3169">OK, if I understand </span><span class="line" data-startTime="3169">your question. </span> <span class="line" data-startTime="3169">So you're asking if you can do </span><span class="line" data-startTime="3169">this, take Google Earth and </span><span class="line" data-startTime="3172">draw the same things </span><span class="line" data-startTime="3172">on the planet. </span> <span class="line" data-startTime="3175">It would be awesome. </span> <span class="line" data-startTime="3176">But Google Earth is </span><span class="line" data-startTime="3176">a C++ program. </span> <span class="line" data-startTime="3180">And it's more difficult to </span><span class="line" data-startTime="3180">insert yourself into that kind </span><span class="line" data-startTime="3184">of program. </span> <span class="line" data-startTime="3186">And so it's difficult to </span><span class="line" data-startTime="3186">share the context. </span> <span class="line" data-startTime="3189">And especially if you want to </span><span class="line" data-startTime="3189">do things like properly draw </span><span class="line" data-startTime="3193">on terrain, and not </span><span class="line" data-startTime="3193">self-intersect it, </span><span class="line" data-startTime="3195">and stuff like that. </span> <span class="line" data-startTime="3196">Because if they've </span><span class="line" data-startTime="3196">done any tricks &mdash; </span><span class="line" data-startTime="3197">you would definitely </span><span class="line" data-startTime="3197">be hacking. </span> <span class="line" data-startTime="3199">It would not be getting </span><span class="line" data-startTime="3199">along harmoniously. </span> <span class="line" data-startTime="3206">I think it would be great </span><span class="line" data-startTime="3206">to do that, though. </span></p>

<p><span class="line" data-startTime="3208">And I mean, some of this is </span><span class="line" data-startTime="3208">very possible with KML. </span> <span class="line" data-startTime="3212">Usually not on this scale, </span><span class="line" data-startTime="3212">usually not in the tens of </span><span class="line" data-startTime="3215">thousands of polylines, </span><span class="line" data-startTime="3215">especially if </span><span class="line" data-startTime="3217">they're long enough. </span> <span class="line" data-startTime="3219">But I think we're starting to </span><span class="line" data-startTime="3219">see more and more stuff move </span><span class="line" data-startTime="3223">to the browser, kind of </span><span class="line" data-startTime="3223">with the new Maps </span><span class="line" data-startTime="3226">and things like that. </span> <span class="line" data-startTime="3226">And I would love to see this </span><span class="line" data-startTime="3226">kind of thing, just plop it </span><span class="line" data-startTime="3230">right on top of WebGL globe. </span> <span class="line" data-startTime="3232">I think that would be amazing. </span> <span class="line" data-startTime="3233">We'll see if that happens. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="3236"><span class="speakerName">Audience</span>: Thank you. </span><span class="line" data-startTime="3238">I noticed you said you had </span><span class="line" data-startTime="3238">about 70,000 points. </span><span class="line" data-startTime="3241">And then here, you were talking </span><span class="line" data-startTime="3241">about millions. </span><span class="line" data-startTime="3243">What are the limits? </span><span class="line" data-startTime="3244">I didn't understand. </span><span class="line" data-startTime="3246">I have a second question, too. </span></p>

<p class="speaker"><span class="line" data-starttime="3247"><span class="speakerName">Brendan Kenny</span>: Right, it was </span><span class="line" data-startTime="3247">79,000 in the first one. </span> <span class="line" data-startTime="3250">And it was just a query of the </span><span class="line" data-startTime="3250">database saying, for every </span><span class="line" data-startTime="3258">unique ID you have, show me the </span><span class="line" data-startTime="3258">most recent timestamped </span><span class="line" data-startTime="3262">message you have from them. </span> <span class="line" data-startTime="3263">And so we had 79,000 ships </span><span class="line" data-startTime="3263">that fall within &mdash; </span><span class="line" data-startTime="3266">we had a couple of things, </span><span class="line" data-startTime="3266">like it can't be &mdash; </span><span class="line" data-startTime="3269">there's a bunch of things with </span><span class="line" data-startTime="3269">obviously wrong data, like </span><span class="line" data-startTime="3272">either their machine's messed </span><span class="line" data-startTime="3272">up, or we're parsing it wrong, </span><span class="line" data-startTime="3274">or the satellite picked </span><span class="line" data-startTime="3274">it up wrong. </span> <span class="line" data-startTime="3276">So we're leaving them out. </span> <span class="line" data-startTime="3277">So that's the good 79,000 that </span><span class="line" data-startTime="3277">are within the last three </span><span class="line" data-startTime="3280">months or something. </span> <span class="line" data-startTime="3281">So for this, this is actually </span><span class="line" data-startTime="3281">fewer points. </span> <span class="line" data-startTime="3283">So this is 20,000 ships. </span> <span class="line" data-startTime="3285">So it's fewer ships, but it's </span><span class="line" data-startTime="3285">two million line segments is </span><span class="line" data-startTime="3290">what we end up drawing. </span> <span class="line" data-startTime="3291">And actually, the frame rate </span><span class="line" data-startTime="3291">is good enough that I was </span><span class="line" data-startTime="3293">thinking about bumping it up. </span></p>

<p><span class="line" data-startTime="3294">But I didn't have time. </span></p>

<p class="speaker"><span class="line" data-starttime="3296"><span class="speakerName">Audience</span>: But my question </span><span class="line" data-startTime="3296">is, what is the limits? </span><span class="line" data-startTime="3297">Like let's say you had </span><span class="line" data-startTime="3297">a million points? </span></p>

<p class="speaker"><span class="line" data-starttime="3299"><span class="speakerName">Brendan Kenny</span>: Yes. </span> <span class="line" data-startTime="3299">So a million points is </span><span class="line" data-startTime="3299">definitely doable. </span> <span class="line" data-startTime="3301">It depends on the hardware. </span> <span class="line" data-startTime="3302">So you might have more </span><span class="line" data-startTime="3302">difficulty on older hardware. </span> <span class="line" data-startTime="3306">And it's difficult to, right </span><span class="line" data-startTime="3306">now, get the feedback you need </span><span class="line" data-startTime="3310">to from the browser. </span> <span class="line" data-startTime="3311">There are a bunch of browser </span><span class="line" data-startTime="3311">extensions that you can run to </span><span class="line" data-startTime="3315">get that feedback. </span> <span class="line" data-startTime="3315">But it's hard to ask an end user </span><span class="line" data-startTime="3315">to run that and say, can </span><span class="line" data-startTime="3319">you copy and paste what </span><span class="line" data-startTime="3319">that just printed out. </span> <span class="line" data-startTime="3322">And so but I run regularly, </span><span class="line" data-startTime="3322">on here, up to 10 </span><span class="line" data-startTime="3330">million points, maybe. </span> <span class="line" data-startTime="3332">And that's mostly brute </span><span class="line" data-startTime="3332">force, actually. </span></p>

<p><span class="line" data-startTime="3335">As long as it's not on screen, </span><span class="line" data-startTime="3335">you can actually </span><span class="line" data-startTime="3339">call it quite quickly. </span> <span class="line" data-startTime="3341">And if it is on screen, you can </span><span class="line" data-startTime="3341">do things like be careful </span><span class="line" data-startTime="3345">of your alpha, so you're </span><span class="line" data-startTime="3345">not drawing too much. </span> <span class="line" data-startTime="3347">But then you can start doing </span><span class="line" data-startTime="3347">things like actually </span><span class="line" data-startTime="3351">partitioning it spatially. </span> <span class="line" data-startTime="3352">So you can do things like only </span><span class="line" data-startTime="3352">draw it between these </span><span class="line" data-startTime="3354">latitudes and these </span><span class="line" data-startTime="3354">longitudes. </span> <span class="line" data-startTime="3355">And so you actually save a </span><span class="line" data-startTime="3355">bunch of time that way. </span> <span class="line" data-startTime="3358">And so, but yeah, just brute </span><span class="line" data-startTime="3358">force, like draw it all on </span><span class="line" data-startTime="3361">screen, 10 million. </span> <span class="line" data-startTime="3363">It depends on the exact blending </span><span class="line" data-startTime="3363">modes that you're </span><span class="line" data-startTime="3364">doing and things like that. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="3365"><span class="speakerName">Audience</span>: My final question </span><span class="line" data-startTime="3365">is, let's say you're a </span><span class="line" data-startTime="3368">JavaScript map programmer. </span><span class="line" data-startTime="3369">You want to learn this, is </span><span class="line" data-startTime="3369">a good place to start? </span></p>

<p class="speaker"><span class="line" data-starttime="3373"><span class="speakerName">Brendan Kenny</span>: Yeah, </span><span class="line" data-startTime="3373">so three.js is a </span><span class="line" data-startTime="3375">great place to start. </span><span class="line" data-startTime="3376">I've seen a number of people </span><span class="line" data-startTime="3376">start with three.js. </span><span class="line" data-startTime="3379">It's a library. </span></p>

<p class="speaker"><span class="line" data-starttime="3381"><span class="speakerName">Audience</span>: Oh, OK, so search </span><span class="line" data-startTime="3381">Google on three.js? </span></p>

<p class="speaker"><span class="line" data-starttime="3383"><span class="speakerName">Brendan Kenny</span>: Yeah. </span> <span class="line" data-startTime="3384">A lot of people have </span><span class="line" data-startTime="3384">started with that. </span> <span class="line" data-startTime="3385">And if they've wanted to move </span><span class="line" data-startTime="3385">on to full WebGL, there's </span><span class="line" data-startTime="3388">actually a few escape hatches </span><span class="line" data-startTime="3388">where you can say custom </span><span class="line" data-startTime="3392">element, and you specify </span><span class="line" data-startTime="3392">everything yourself, but then </span><span class="line" data-startTime="3395">lots of it is already </span><span class="line" data-startTime="3395">made for you. </span> <span class="line" data-startTime="3398">Just simple things that </span><span class="line" data-startTime="3398">are already made. </span> <span class="line" data-startTime="3401">But then the variety that people </span><span class="line" data-startTime="3401">come up with with that </span><span class="line" data-startTime="3403">stuff is amazing. </span> <span class="line" data-startTime="3405">There's a few books. </span> <span class="line" data-startTime="3406">My favorite book is still the </span><span class="line" data-startTime="3406">"OpenGL ES 2.0 Programming </span><span class="line" data-startTime="3413">Guide." It's a purple book. </span> <span class="line" data-startTime="3415">And it's not actually </span><span class="line" data-startTime="3415">WebGL, but it's </span><span class="line" data-startTime="3417">close enough to WebGL. </span> <span class="line" data-startTime="3418">It's basically the mirrored </span><span class="line" data-startTime="3418">API, but in C. But it's is </span><span class="line" data-startTime="3422">pretty much the same thing. </span> <span class="line" data-startTime="3423">There's also two, at least, </span><span class="line" data-startTime="3423">that I know of, </span><span class="line" data-startTime="3425">of WebGL books directly. </span></p>

<p><span class="line" data-startTime="3427">And I haven't read either </span><span class="line" data-startTime="3427">of them, so I </span><span class="line" data-startTime="3429">can't vouch for them. </span> <span class="line" data-startTime="3430">But one of them is specifically </span><span class="line" data-startTime="3430">about three.js. </span> <span class="line" data-startTime="3434">And it's written </span><span class="line" data-startTime="3434">by Tony Parisi. </span> <span class="line" data-startTime="3439">And he runs a blog called </span><span class="line" data-startTime="3439">"Learning WebGL" now. </span> <span class="line" data-startTime="3443">And it's specifically about </span><span class="line" data-startTime="3443">that sort of thing. </span> <span class="line" data-startTime="3446">And he has updates every week, </span><span class="line" data-startTime="3446">like, cool stuff that happened </span><span class="line" data-startTime="3448">around the web. </span> <span class="line" data-startTime="3449">Yeah, so hopefully, </span><span class="line" data-startTime="3449">that's helpful. </span> <span class="line" data-startTime="3451">Yeah? </span></p>

<p class="speaker"><span class="line" data-starttime="3451"><span class="speakerName">Audience</span>: Hi there. </span><span class="line" data-startTime="3452">So using the color as an index </span><span class="line" data-startTime="3452">for picking is a pretty cool </span><span class="line" data-startTime="3455">trick, but kind of </span><span class="line" data-startTime="3455">limited to just </span><span class="line" data-startTime="3459">picking individual things. </span><span class="line" data-startTime="3462">It seems that for a lot of real </span><span class="line" data-startTime="3462">world stuff, you quickly </span><span class="line" data-startTime="3464">fall into sort of spatial </span><span class="line" data-startTime="3464">partitioning problems. </span><span class="line" data-startTime="3468">So do you have any advice for </span><span class="line" data-startTime="3468">how to efficiently, when </span><span class="line" data-startTime="3471">you've got really large data </span><span class="line" data-startTime="3471">sets, sort of do the spatial </span><span class="line" data-startTime="3474">partitioning for finding regions </span><span class="line" data-startTime="3474">and things like that? </span></p>

<p class="speaker"><span class="line" data-starttime="3477"><span class="speakerName">Brendan Kenny</span>: Sure, sure. </span> <span class="line" data-startTime="3478">So you're talking like if you </span><span class="line" data-startTime="3478">wanted to be like a ranged </span><span class="line" data-startTime="3480">query and say, all the points. </span> <span class="line" data-startTime="3482">So honestly, it's a little </span><span class="line" data-startTime="3482">embarrassing to do picking. </span> <span class="line" data-startTime="3486">It's actually nice to </span><span class="line" data-startTime="3486">show the technique. </span> <span class="line" data-startTime="3488">But it's the lazy way. </span> <span class="line" data-startTime="3489">Points, especially, are some </span><span class="line" data-startTime="3489">of the easiest things to </span><span class="line" data-startTime="3492">partition and select </span><span class="line" data-startTime="3492">the nearest from. </span> <span class="line" data-startTime="3495">Especially 80,000 points. </span> <span class="line" data-startTime="3497">So one piece of advice I have </span><span class="line" data-startTime="3497">would be to trust JavaScript. </span> <span class="line" data-startTime="3500">It's actually much faster </span><span class="line" data-startTime="3500">than a lot of people </span><span class="line" data-startTime="3501">give it credit for. </span> <span class="line" data-startTime="3503">You have to kind of stick to </span><span class="line" data-startTime="3503">same things, but there's even </span><span class="line" data-startTime="3506">a lot of profiling tools </span><span class="line" data-startTime="3506">available now to tell you </span><span class="line" data-startTime="3509">exactly where you screwed up &mdash; </span><span class="line" data-startTime="3513">screwed up in the sense that </span><span class="line" data-startTime="3513">you angered the JavaScript </span><span class="line" data-startTime="3515">gods, and you de-allocated </span><span class="line" data-startTime="3515">something they assumed it was </span><span class="line" data-startTime="3520">allocating. </span> <span class="line" data-startTime="3520">And they de-opted your just </span><span class="line" data-startTime="3520">in time compiled code. </span></p>

<p><span class="line" data-startTime="3524">But other than that, I mean, </span><span class="line" data-startTime="3524">it's really just like pretty </span><span class="line" data-startTime="3527">much the algorithms </span><span class="line" data-startTime="3527">that you expect. </span> <span class="line" data-startTime="3529">So Crossfilter, which was </span><span class="line" data-startTime="3529">running that histogram at the </span><span class="line" data-startTime="3531">bottom, is actually </span><span class="line" data-startTime="3531">doing that. </span> <span class="line" data-startTime="3533">They do range queries in </span><span class="line" data-startTime="3533">up to 32 dimensions. </span> <span class="line" data-startTime="3537">And it's pretty fast. </span> <span class="line" data-startTime="3540">WebGL is faster than it. </span> <span class="line" data-startTime="3542">And so it can actually slow </span><span class="line" data-startTime="3542">down the frame rate </span><span class="line" data-startTime="3543">calculating that. </span></p>

<p><span class="line" data-startTime="3545">But one thing that you can do, </span><span class="line" data-startTime="3545">but I've never tried before, </span><span class="line" data-startTime="3548">is you can run it in a </span><span class="line" data-startTime="3548">web worker, so it's </span><span class="line" data-startTime="3549">in a different thread. </span> <span class="line" data-startTime="3551">And actually, you're </span><span class="line" data-startTime="3551">bringing over </span><span class="line" data-startTime="3552">just the grouped histogram. </span> <span class="line" data-startTime="3554">So it's much less data that </span><span class="line" data-startTime="3554">you're bringing between </span><span class="line" data-startTime="3557">processes, threads, whatever. </span> <span class="line" data-startTime="3561">And so you can kind of </span><span class="line" data-startTime="3561">shove off work there. </span> <span class="line" data-startTime="3564">But I would say really, the </span><span class="line" data-startTime="3564">typical space partition </span><span class="line" data-startTime="3567">algorithms that are everywhere, </span><span class="line" data-startTime="3567">and hopefully </span><span class="line" data-startTime="3569">we'll start to see more </span><span class="line" data-startTime="3569">implementations. </span> <span class="line" data-startTime="3573">I've done a little bit with some </span><span class="line" data-startTime="3573">computational algebra, </span><span class="line" data-startTime="3577">computational geometry libraries </span><span class="line" data-startTime="3577">that you can check </span><span class="line" data-startTime="3580">out if you check out </span><span class="line" data-startTime="3580">my GitHub account. </span></p>

<p><span class="line" data-startTime="3583">And that might be helpful. </span> <span class="line" data-startTime="3588">So yeah, so, any </span><span class="line" data-startTime="3588">more questions? </span><span class="line" data-startTime="3591">All right, thank you. </span> <span class="line" data-startTime="3593">[APPLAUSE] </span></p>