<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Google I/O 2013 &mdash; Mobile, Web and Cloud &mdash; The Triple Crown of Modern Applications</h1>

<h2>Ido Green, Danny Hermes</h2>

<a class="video" href="http://youtu.be/6_oO9Gwf_do">youtu.be/6_oO9Gwf_do</a><div id="transcript"><p><span class="line" data-startTime="2">[MUSIC PLAYING] </span></p>

<p class="speaker"><span class="line" data-starttime="13"><span class="speakerName">Ido Green</span>: OK. </span><span class="line" data-startTime="14">Yeah? </span><span class="line" data-startTime="15">Can you hear me? </span><span class="line" data-startTime="18">This is not working. </span><span class="line" data-startTime="20">Good afternoon. </span><span class="line" data-startTime="21">Thank you very much </span><span class="line" data-startTime="21">for coming. </span><span class="line" data-startTime="22">We're really excited </span><span class="line" data-startTime="22">to be here. </span><span class="line" data-startTime="24">It's always a pleasure to be </span><span class="line" data-startTime="24">in a crowd where people are </span><span class="line" data-startTime="26">passionate about the things that </span><span class="line" data-startTime="26">you are passionate about. </span><span class="line" data-startTime="29">I'm Ido Green, and I'm </span><span class="line" data-startTime="29">Developer Advocate. </span></p>

<p class="speaker"><span class="line" data-starttime="31"><span class="speakerName">Danny Hermes</span>: I'm </span><span class="line" data-startTime="31">Danny Hermes, a </span><span class="line" data-startTime="33">Developer Programs Engineer. </span><span class="line" data-startTime="34">And I worked on the cloud. </span></p>

<p class="speaker"><span class="line" data-starttime="35"><span class="speakerName">Ido Green</span>: Right. </span><span class="line" data-startTime="36">And I'm the client guy </span><span class="line" data-startTime="36">that will speak </span><span class="line" data-startTime="37">about Chrome and HTML5. </span><span class="line" data-startTime="39">Today we're going to talk about </span><span class="line" data-startTime="39">three quite amazing </span><span class="line" data-startTime="43">technologies that keep changing </span><span class="line" data-startTime="43">in a rapid pace. </span><span class="line" data-startTime="46">We'll speak about mobile, about </span><span class="line" data-startTime="46">the web, mobile web, and </span><span class="line" data-startTime="49">about the cloud. </span><span class="line" data-startTime="50">And we thought to tell a story </span><span class="line" data-startTime="50">that will take you through the </span><span class="line" data-startTime="52">process that we went, we're </span><span class="line" data-startTime="52">building a mobile web app, and </span><span class="line" data-startTime="56">utilizing Google Cloud Endpoints </span><span class="line" data-startTime="56">as our backend. </span><span class="line" data-startTime="60">So let's first just start with </span><span class="line" data-startTime="60">a nice little demo that just </span><span class="line" data-startTime="64">will show you a macro </span><span class="line" data-startTime="64">view of what we did. </span><span class="line" data-startTime="67">So you could see this app. </span><span class="line" data-startTime="69">And first and foremost, I'll </span><span class="line" data-startTime="69">just sign in because we do </span><span class="line" data-startTime="72">want to handle our users and </span><span class="line" data-startTime="72">have the amazing photo that I </span><span class="line" data-startTime="75">will save under my user and </span><span class="line" data-startTime="75">Danny's his, et cetera. </span><span class="line" data-startTime="80">We are here on the normal </span><span class="line" data-startTime="80">network, so please, if </span><span class="line" data-startTime="84">you are with us &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="84"><span class="speakerName">Danny Hermes</span>: Yeah. </span><span class="line" data-startTime="84">Stop using internet. </span></p>

<p class="speaker"><span class="line" data-starttime="85"><span class="speakerName">Ido Green</span>: Yeah, it would </span><span class="line" data-startTime="85">help us a lot. </span><span class="line" data-startTime="88">So I'm accepting. </span><span class="line" data-startTime="89">I have this &mdash; </span><span class="line" data-startTime="92">when it will finish loading. </span></p>

<p class="speaker"><span class="line" data-starttime="93"><span class="speakerName">Danny Hermes</span>: It's fine. </span><span class="line" data-startTime="94">Just click Accept. </span></p>

<p class="speaker"><span class="line" data-starttime="95"><span class="speakerName">Ido Green</span>: Yeah. </span><span class="line" data-startTime="95">I did. </span></p>

<p class="speaker"><span class="line" data-starttime="98"><span class="speakerName">Danny Hermes</span>: Demo gods smile. </span></p>

<p class="speaker"><span class="line" data-starttime="99"><span class="speakerName">Ido Green</span>: Yeah, </span><span class="line" data-startTime="99">it's demo gods. </span> <span class="line" data-startTime="100">So basically, what we're going </span><span class="line" data-startTime="100">here, it's that regular </span><span class="line" data-startTime="104">process of what you do </span><span class="line" data-startTime="104">when you sign in </span><span class="line" data-startTime="106">with Google+ button. </span> <span class="line" data-startTime="108">And after we accepting it. </span> <span class="line" data-startTime="110">It's need to confirm and send </span><span class="line" data-startTime="110">us the token back, we'll be </span><span class="line" data-startTime="113">able to see the app itself. </span> <span class="line" data-startTime="115">And basically what we'll do, it </span><span class="line" data-startTime="115">will fetch all the photos </span><span class="line" data-startTime="118">that we have stored </span><span class="line" data-startTime="118">in our cloud. </span> <span class="line" data-startTime="121">Now, the app itself is built </span><span class="line" data-startTime="121">on top of a few layers. </span> <span class="line" data-startTime="124">And what we thought would be </span><span class="line" data-startTime="124">wise is just to show you some </span><span class="line" data-startTime="127">of the best practices that we </span><span class="line" data-startTime="127">encapsulate and baked into the </span><span class="line" data-startTime="131">app itself. </span> <span class="line" data-startTime="132">So the app itself will work </span><span class="line" data-startTime="132">when finally we'll end </span><span class="line" data-startTime="136">[INAUDIBLE]. </span></p>

<p><span class="line" data-startTime="137">It will work offline </span><span class="line" data-startTime="137">completely. </span> <span class="line" data-startTime="139">So like any native app that you </span><span class="line" data-startTime="139">are accustomed to, this </span><span class="line" data-startTime="143">app need just the beginning to </span><span class="line" data-startTime="143">do this, call to the server, </span><span class="line" data-startTime="147">get all the assets, get the </span><span class="line" data-startTime="147">skeleton, and let you work </span><span class="line" data-startTime="151">with the app even when you don't </span><span class="line" data-startTime="151">have connection, or when </span><span class="line" data-startTime="153">you have flaky connections. </span> <span class="line" data-startTime="155">So one of the most important </span><span class="line" data-startTime="155">features that we are able to </span><span class="line" data-startTime="158">achieve here is that </span><span class="line" data-startTime="158">the performance </span><span class="line" data-startTime="160">will be much better. </span> <span class="line" data-startTime="161">We'll have 60 frames </span><span class="line" data-startTime="161">per second. </span> <span class="line" data-startTime="163">The app will be really </span><span class="line" data-startTime="163">responsive. </span> <span class="line" data-startTime="165">Everything will work fast. </span> <span class="line" data-startTime="167">And the user, of course, </span><span class="line" data-startTime="167">satisfaction will be higher. </span> <span class="line" data-startTime="170">So apparently our network </span><span class="line" data-startTime="170">here is not allowing </span><span class="line" data-startTime="173">us to do too much. </span></p>

<p><span class="line" data-startTime="175">So basically, I'll try &mdash; </span><span class="line" data-startTime="175">maybe we'll &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="177"><span class="speakerName">Danny Hermes</span>: Let's do </span><span class="line" data-startTime="177">it from the desktop. </span><span class="line" data-startTime="179">Let's just pretend like we're </span><span class="line" data-startTime="179">on mobile, sadly. </span></p>

<p class="speaker"><span class="line" data-starttime="184"><span class="speakerName">Ido Green</span>: Yeah. </span> <span class="line" data-startTime="184">So this is our app. </span> <span class="line" data-startTime="186">And you have your status button </span><span class="line" data-startTime="186">that just will confirm </span><span class="line" data-startTime="190">to us when we are offline and </span><span class="line" data-startTime="190">online, so you'll be able to </span><span class="line" data-startTime="192">see it with us. </span> <span class="line" data-startTime="193">And I already signed in, so I </span><span class="line" data-startTime="193">could do it pretty quick again </span><span class="line" data-startTime="197">just to see that all the </span><span class="line" data-startTime="197">process is working. </span> <span class="line" data-startTime="199">So I'm accepting. </span> <span class="line" data-startTime="200">The sign in button </span><span class="line" data-startTime="200">has vanished. </span> <span class="line" data-startTime="201">And now I'm in the app. </span> <span class="line" data-startTime="203">I have here my photos. </span> <span class="line" data-startTime="205">And of course I can attach </span><span class="line" data-startTime="205">and create new photo. </span> <span class="line" data-startTime="209">So one of the beautiful things </span><span class="line" data-startTime="209">here is that when I'm taking a </span><span class="line" data-startTime="212">new photo, here it will just </span><span class="line" data-startTime="212">open the file chooser and will </span><span class="line" data-startTime="216">fetch the photo, as you saw. </span></p>

<p><span class="line" data-startTime="218">But on the mobile device, it </span><span class="line" data-startTime="218">will actually go to the camera </span><span class="line" data-startTime="221">itself and allow me to </span><span class="line" data-startTime="221">capture and speak </span><span class="line" data-startTime="223">with the camera directly. </span> <span class="line" data-startTime="225">And we see that we have lots of </span><span class="line" data-startTime="225">device APIs through there </span><span class="line" data-startTime="227">that are baked into the web </span><span class="line" data-startTime="227">platform and allow you to do </span><span class="line" data-startTime="230">quite amazing stuff when being </span><span class="line" data-startTime="230">closer to the metal. </span> <span class="line" data-startTime="233">So here I have this photo. </span> <span class="line" data-startTime="235">I'll give it a title, a </span><span class="line" data-startTime="235">description, and I'll save it. </span> <span class="line" data-startTime="241">One of the things that you saw, </span><span class="line" data-startTime="241">it immediately saved it. </span> <span class="line" data-startTime="243">And then we got another </span><span class="line" data-startTime="243">confirmation that it send it </span><span class="line" data-startTime="245">into the cloud. </span> <span class="line" data-startTime="246">So basically, we are able here &mdash; </span><span class="line" data-startTime="246">and here it was quite </span><span class="line" data-startTime="248">fast, but if this was working, </span><span class="line" data-startTime="248">you could see that </span><span class="line" data-startTime="251">we have some lags. </span></p>

<p><span class="line" data-startTime="252">But the beauty of it is that </span><span class="line" data-startTime="252">we are confirming to the </span><span class="line" data-startTime="254">client that the action </span><span class="line" data-startTime="254">was done. </span> <span class="line" data-startTime="256">Our user doesn't really need to </span><span class="line" data-startTime="256">be worry about it, and it </span><span class="line" data-startTime="260">works much faster. </span> <span class="line" data-startTime="261">Now, the photo is here. </span> <span class="line" data-startTime="264">I'll pull out the </span><span class="line" data-startTime="264">network cable. </span> <span class="line" data-startTime="268">And as you saw, it's </span><span class="line" data-startTime="268">becoming offline. </span> <span class="line" data-startTime="271">And I could do the same </span><span class="line" data-startTime="271">operation again. </span> <span class="line" data-startTime="274">So I'm going, I'm </span><span class="line" data-startTime="274">adding a photo. </span> <span class="line" data-startTime="277">Let's add a new one, give </span><span class="line" data-startTime="277">it a name, and save it. </span> <span class="line" data-startTime="286">Now we're getting confirmation </span><span class="line" data-startTime="286">just that it saved locally. </span> <span class="line" data-startTime="288">And since we don't have any </span><span class="line" data-startTime="288">connection with the cloud, </span><span class="line" data-startTime="291">we'll save it. </span> <span class="line" data-startTime="292">We'll put it in a queue, and </span><span class="line" data-startTime="292">later on when we do have </span><span class="line" data-startTime="294">connection, and let's just </span><span class="line" data-startTime="294">hook it up and see what </span><span class="line" data-startTime="297">happened, it will know how to </span><span class="line" data-startTime="297">sync it with the cloud and </span><span class="line" data-startTime="301">actually enable us to see it </span><span class="line" data-startTime="301">from different devices. </span></p>

<p><span class="line" data-startTime="303">So if it was working, we could </span><span class="line" data-startTime="303">have seen it here and here on </span><span class="line" data-startTime="308">different screens. </span> <span class="line" data-startTime="309">And actually, you can see that </span><span class="line" data-startTime="309">we're doing the best with the </span><span class="line" data-startTime="311">real estate that the screen </span><span class="line" data-startTime="311">itself is letting us. </span> <span class="line" data-startTime="313">So we passed the demo. </span> <span class="line" data-startTime="314">Maybe we'll move on. </span> <span class="line" data-startTime="318">Yeah. </span> <span class="line" data-startTime="322">So cloud and client. </span> <span class="line" data-startTime="323">So let's just have a little </span><span class="line" data-startTime="323">role game here. </span> <span class="line" data-startTime="327">I'm the client guy, as </span><span class="line" data-startTime="327">you mentioned, so my </span><span class="line" data-startTime="329">answer would be no. </span></p>

<p><span class="line" data-startTime="330">We don't need any server. </span> <span class="line" data-startTime="332">We just need it once to get all </span><span class="line" data-startTime="332">the assets, and then we </span><span class="line" data-startTime="334">are happy campers. </span> <span class="line" data-startTime="335">But before we do that, let's </span><span class="line" data-startTime="335">just define to ourselves what </span><span class="line" data-startTime="338">we see in a modern </span><span class="line" data-startTime="338">web application. </span> <span class="line" data-startTime="340">And it could be web, it </span><span class="line" data-startTime="340">could be mobile, it </span><span class="line" data-startTime="342">could be both of them. </span> <span class="line" data-startTime="344">One of the things that we saw, </span><span class="line" data-startTime="344">that all of them got one goal, </span><span class="line" data-startTime="347">and they're trying to get the </span><span class="line" data-startTime="347">user to achieve their goal </span><span class="line" data-startTime="351">with the highest efficiency </span><span class="line" data-startTime="351">as possible. </span> <span class="line" data-startTime="352">So they are very focused, </span><span class="line" data-startTime="352">very contained. </span> <span class="line" data-startTime="355">We see more and more code that </span><span class="line" data-startTime="355">is flowing to the client side, </span><span class="line" data-startTime="358">and that's why we see it </span><span class="line" data-startTime="358">flourishing in all the MV* </span><span class="line" data-startTime="361">frameworks. </span> <span class="line" data-startTime="361">Basically, we're talking about </span><span class="line" data-startTime="361">clear separation between our </span><span class="line" data-startTime="364">data and our views. </span> <span class="line" data-startTime="365">We just want to be able to </span><span class="line" data-startTime="365">maintain our apps, especially </span><span class="line" data-startTime="368">when they're growing </span><span class="line" data-startTime="368">quite fast. </span> <span class="line" data-startTime="370">Offline first, so like Eric </span><span class="line" data-startTime="370">Schmidt coined the term mobile </span><span class="line" data-startTime="373">first, we'll now try to term </span><span class="line" data-startTime="373">and work with offline first </span><span class="line" data-startTime="377">methodology. </span></p>

<p><span class="line" data-startTime="377">So the app will work everywhere </span><span class="line" data-startTime="377">in any case. </span> <span class="line" data-startTime="381">And it's true that we're in a </span><span class="line" data-startTime="381">web browser and we are online </span><span class="line" data-startTime="384">most of the time, but even in </span><span class="line" data-startTime="384">cases where we are on a </span><span class="line" data-startTime="387">submarine or airplane or flaky </span><span class="line" data-startTime="387">connection, we'll still be </span><span class="line" data-startTime="390">able to do the most &mdash; </span><span class="line" data-startTime="391">with our app, like you saw, the </span><span class="line" data-startTime="391">most crucial functionality </span><span class="line" data-startTime="394">to take a photo is back there. </span> <span class="line" data-startTime="396">Device aware, you know that we </span><span class="line" data-startTime="396">have now browsers as an open </span><span class="line" data-startTime="400">technology on handheld devices, </span><span class="line" data-startTime="400">tablets, laptops, </span><span class="line" data-startTime="403">desktops, and TVs. </span> <span class="line" data-startTime="404">So screen size of 2 inch up to, </span><span class="line" data-startTime="404">I don't know, 100 inch, </span><span class="line" data-startTime="407">and you should do the best with </span><span class="line" data-startTime="407">the real estate that the </span><span class="line" data-startTime="409">device itself lets you. </span> <span class="line" data-startTime="411">Pref matters, it's a hashtag </span><span class="line" data-startTime="411">that we're using through all </span><span class="line" data-startTime="414">Chrome channels. </span> <span class="line" data-startTime="415">And we just want to emphasize </span><span class="line" data-startTime="415">the importance of making the </span><span class="line" data-startTime="418">app work best. </span></p>

<p><span class="line" data-startTime="420">We all know that users love the </span><span class="line" data-startTime="420">app to be responsive and </span><span class="line" data-startTime="424">snappy, and everything should </span><span class="line" data-startTime="424">work as fast as possible. </span> <span class="line" data-startTime="428">So cloud and server. </span> <span class="line" data-startTime="429">So if I'm playing the role &mdash; and </span><span class="line" data-startTime="429">please take my things with </span><span class="line" data-startTime="432">a grain of salt here &mdash; </span><span class="line" data-startTime="434">I could say hey, we have quite </span><span class="line" data-startTime="434">a lot of amazing HTML5 APIs </span><span class="line" data-startTime="438">that allow us to save the </span><span class="line" data-startTime="438">skeleton of the app in the </span><span class="line" data-startTime="441">AppCache to use local storage </span><span class="line" data-startTime="441">or File API or IndexedDB or </span><span class="line" data-startTime="444">any methodology that will let us </span><span class="line" data-startTime="444">save state and data on the </span><span class="line" data-startTime="447">client side. </span> <span class="line" data-startTime="448">So basically, we are </span><span class="line" data-startTime="448">quite happy just </span><span class="line" data-startTime="451">to be on the client. </span></p>

<p><span class="line" data-startTime="453">We want to minimize </span><span class="line" data-startTime="453">the interactions. </span> <span class="line" data-startTime="455">Why? </span><span class="line" data-startTime="455">Because network is quite slow, </span><span class="line" data-startTime="455">specifically on some networks, </span><span class="line" data-startTime="459">like we have here, a </span><span class="line" data-startTime="459">perfect example. </span> <span class="line" data-startTime="461">And we want this one connection </span><span class="line" data-startTime="461">and that's it, so </span><span class="line" data-startTime="464">really to do the most </span><span class="line" data-startTime="464">from any and each </span><span class="line" data-startTime="467">connection that we're making. </span> <span class="line" data-startTime="469">The way to do it is just to </span><span class="line" data-startTime="469">pretend that there is no </span><span class="line" data-startTime="471">connection, and then to </span><span class="line" data-startTime="471">build a sync layer. </span> <span class="line" data-startTime="473">Because as you saw, to save </span><span class="line" data-startTime="473">things locally, to save things </span><span class="line" data-startTime="475">offline, quite easy. </span> <span class="line" data-startTime="476">The logic or the magic is in the </span><span class="line" data-startTime="476">sync layer that does the </span><span class="line" data-startTime="479">right things in the </span><span class="line" data-startTime="479">right moment. </span> <span class="line" data-startTime="481">And the code here is just this </span><span class="line" data-startTime="481">really simple API to know </span><span class="line" data-startTime="484">where we are offline or </span><span class="line" data-startTime="484">when we are online. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="488"><span class="speakerName">Danny Hermes</span>: So when asked the </span><span class="line" data-startTime="488">question to me, are the </span><span class="line" data-startTime="492">cloud and the client friends, </span><span class="line" data-startTime="492">well, of course they are. </span> <span class="line" data-startTime="495">Maybe the tablet and </span><span class="line" data-startTime="495">the network in </span><span class="line" data-startTime="497">this room aren't friends. </span> <span class="line" data-startTime="498">But the cloud and the client </span><span class="line" data-startTime="498">are definitely friends. </span> <span class="line" data-startTime="500">So I'm a resounding </span><span class="line" data-startTime="500">yes on this one. </span> <span class="line" data-startTime="502">So when you're building a modern </span><span class="line" data-startTime="502">application, you're </span><span class="line" data-startTime="505">obviously thinking about your </span><span class="line" data-startTime="505">client first, whether it's the </span><span class="line" data-startTime="507">mobile web or a native </span><span class="line" data-startTime="507">application. </span> <span class="line" data-startTime="509">But they have to rely </span><span class="line" data-startTime="509">on the cloud. </span> <span class="line" data-startTime="511">Users are used to holding a </span><span class="line" data-startTime="511">phone, which they treat as a </span><span class="line" data-startTime="514">data center. </span> <span class="line" data-startTime="515">They send off queries to very </span><span class="line" data-startTime="515">large organizations that are </span><span class="line" data-startTime="519">doing very intense things across </span><span class="line" data-startTime="519">the network, and they </span><span class="line" data-startTime="523">actually expect this from </span><span class="line" data-startTime="523">your applications. </span> <span class="line" data-startTime="525">So being able to offload </span><span class="line" data-startTime="525">computation is </span><span class="line" data-startTime="527">actually a big deal. </span></p>

<p><span class="line" data-startTime="530">When you have lots of users, </span><span class="line" data-startTime="530">you want a single source of </span><span class="line" data-startTime="533">truth for data. </span> <span class="line" data-startTime="534">You want to be able to store </span><span class="line" data-startTime="534">it somewhere other than the </span><span class="line" data-startTime="536">client, right? </span><span class="line" data-startTime="537">And of course, as we saw here, </span><span class="line" data-startTime="537">we have the tablet, which </span><span class="line" data-startTime="540">won't work, and the desktop, </span><span class="line" data-startTime="540">which is connected to ethernet </span><span class="line" data-startTime="543">and just fine. </span> <span class="line" data-startTime="544">So you have some users signing </span><span class="line" data-startTime="544">in from more than one place. </span> <span class="line" data-startTime="547">So you actually need the cloud, </span><span class="line" data-startTime="547">a server, to have this </span><span class="line" data-startTime="550">one source of truth. </span> <span class="line" data-startTime="553">So he's saying we have to </span><span class="line" data-startTime="553">minimize interactions. </span> <span class="line" data-startTime="555">We have to be offline. </span> <span class="line" data-startTime="557">Well, that's actually </span><span class="line" data-startTime="557">a good thing. </span> <span class="line" data-startTime="558">It's not abandoning the cloud. </span> <span class="line" data-startTime="560">It's informing the way </span><span class="line" data-startTime="560">that we actually </span><span class="line" data-startTime="562">think about the cloud. </span> <span class="line" data-startTime="563">So does anyone remember DRY, </span><span class="line" data-startTime="563">Don't Repeat Yourself? </span><span class="line" data-startTime="567">We hear this all the time. </span></p>

<p><span class="line" data-startTime="569">When we're writing code, </span><span class="line" data-startTime="569">obviously don't write the same </span><span class="line" data-startTime="571">thing twice, right? </span><span class="line" data-startTime="572">Functions, classes, whatever. </span> <span class="line" data-startTime="574">But when we're talking about </span><span class="line" data-startTime="574">the network, it's just as </span><span class="line" data-startTime="577">important not to repeat </span><span class="line" data-startTime="577">yourself. </span> <span class="line" data-startTime="579">Because in this situation, where </span><span class="line" data-startTime="579">you don't have lots of </span><span class="line" data-startTime="581">network, you can actually rely </span><span class="line" data-startTime="581">on things that you already </span><span class="line" data-startTime="584">know, rely on the conversations </span><span class="line" data-startTime="584">that you've </span><span class="line" data-startTime="586">already had, and use these nice </span><span class="line" data-startTime="586">HTML5 technologies to </span><span class="line" data-startTime="589">actually keep this </span><span class="line" data-startTime="589">data around. </span> <span class="line" data-startTime="592">So we have to actually get the </span><span class="line" data-startTime="592">most out of each and every </span><span class="line" data-startTime="595">interaction and lick the bowl </span><span class="line" data-startTime="595">clean like a good boy or girl. </span> <span class="line" data-startTime="600">So now I want to talk a bit </span><span class="line" data-startTime="600">about the tools we use to </span><span class="line" data-startTime="603">build this application. </span> <span class="line" data-startTime="605">I'd love to demo it </span><span class="line" data-startTime="605">at some point. </span> <span class="line" data-startTime="608">So we actually use a good chunk </span><span class="line" data-startTime="608">of the Google Cloud </span><span class="line" data-startTime="611">Platform, which is </span><span class="line" data-startTime="611">what I work on. </span> <span class="line" data-startTime="613">And I just want to talk about </span><span class="line" data-startTime="613">some tools that we use to help </span><span class="line" data-startTime="616">our friends. </span></p>

<p><span class="line" data-startTime="617">So if it wasn't already </span><span class="line" data-startTime="617">clear, the cloud </span><span class="line" data-startTime="619">the client are friends. </span> <span class="line" data-startTime="621">So we do need a server. </span> <span class="line" data-startTime="622">But who wants to run a server? </span><span class="line" data-startTime="624">It's hard, right? </span><span class="line" data-startTime="626">Let's go shopping. </span> <span class="line" data-startTime="627">No. </span> <span class="line" data-startTime="628">So running a server is hard, and </span><span class="line" data-startTime="628">we want to make it easy. </span> <span class="line" data-startTime="630">So some of the things that are </span><span class="line" data-startTime="630">solved problems that are hard </span><span class="line" data-startTime="634">but not worth solving are things </span><span class="line" data-startTime="634">like traffic spikes, </span><span class="line" data-startTime="638">communicating with your client </span><span class="line" data-startTime="638">and your server, actually </span><span class="line" data-startTime="642">doing authentication, trying </span><span class="line" data-startTime="642">to figure out how to make </span><span class="line" data-startTime="644">payloads efficient. </span> <span class="line" data-startTime="646">Like I said, these are all </span><span class="line" data-startTime="646">solved problems, and these are </span><span class="line" data-startTime="648">things you shouldn't be thinking </span><span class="line" data-startTime="648">about when building </span><span class="line" data-startTime="650">an application. </span></p>

<p><span class="line" data-startTime="651">So we want to be the easy button </span><span class="line" data-startTime="651">in as many places as we </span><span class="line" data-startTime="654">can, and we want to push </span><span class="line" data-startTime="654">this down extra hard. </span> <span class="line" data-startTime="657">So the biggest technology </span><span class="line" data-startTime="657">that we run on </span><span class="line" data-startTime="660">is Google App Engine. </span> <span class="line" data-startTime="661">Google App Engine, for those who </span><span class="line" data-startTime="661">don't know, is a platform </span><span class="line" data-startTime="664">as a service, which allows you </span><span class="line" data-startTime="664">to write code in your language </span><span class="line" data-startTime="667">of choice &mdash; </span><span class="line" data-startTime="667">here Java, Go, Python, </span><span class="line" data-startTime="667">and as [INAUDIBLE] </span><span class="line" data-startTime="670">earlier today, PHP as well. </span> <span class="line" data-startTime="673">But you actually get to use </span><span class="line" data-startTime="673">Google's infrastructure to </span><span class="line" data-startTime="675">scale up and scale down </span><span class="line" data-startTime="675">based on your traffic. </span> <span class="line" data-startTime="678">And in addition, you also get to </span><span class="line" data-startTime="678">use App Engine's NoSQL data </span><span class="line" data-startTime="682">store to store and interact with </span><span class="line" data-startTime="682">data the same way Google </span><span class="line" data-startTime="685">services do. </span> <span class="line" data-startTime="686">On top of Google App Engine, </span><span class="line" data-startTime="686">we're using Google Cloud </span><span class="line" data-startTime="689">Endpoints, which essentially </span><span class="line" data-startTime="689">allows you to write an API </span><span class="line" data-startTime="693">that looks like a Google API. </span> <span class="line" data-startTime="696">More about this later. </span></p>

<p><span class="line" data-startTime="697">What does that mean, </span><span class="line" data-startTime="697">a Google API? </span><span class="line" data-startTime="699">So all modern Google </span><span class="line" data-startTime="699">APIs have something </span><span class="line" data-startTime="702">called a discovery document. </span> <span class="line" data-startTime="704">And it's a giant bit of JSON. </span> <span class="line" data-startTime="706">You don't have to actually </span><span class="line" data-startTime="706">see what's on this slide. </span> <span class="line" data-startTime="708">But what this discovery document </span><span class="line" data-startTime="708">does, it fully </span><span class="line" data-startTime="711">specifies everything </span><span class="line" data-startTime="711">the API can do. </span> <span class="line" data-startTime="713">So it's a language to actually </span><span class="line" data-startTime="713">describe what payloads should </span><span class="line" data-startTime="717">look like, what methods are </span><span class="line" data-startTime="717">available, what kind of auth </span><span class="line" data-startTime="719">is needed, you name it. </span> <span class="line" data-startTime="721">It describes how the </span><span class="line" data-startTime="721">API behaves. </span> <span class="line" data-startTime="723">OK, Danny. </span> <span class="line" data-startTime="725">So what? </span><span class="line" data-startTime="725">I don't care. </span> <span class="line" data-startTime="726">It's JSON. </span> <span class="line" data-startTime="727">Cool. </span> <span class="line" data-startTime="728">Well, so what? </span><span class="line" data-startTime="729">By having a single document to </span><span class="line" data-startTime="729">describe all APIs, we have </span><span class="line" data-startTime="734">client libraries in lots and </span><span class="line" data-startTime="734">lots of different languages </span><span class="line" data-startTime="737">that actually understand </span><span class="line" data-startTime="737">discovery no matter </span><span class="line" data-startTime="740">which API it is. </span></p>

<p><span class="line" data-startTime="741">And so if we bring a new API </span><span class="line" data-startTime="741">online, these libraries out of </span><span class="line" data-startTime="744">the box work with that API. </span> <span class="line" data-startTime="748">OK, sweet. </span> <span class="line" data-startTime="748">So with Google Cloud Endpoints, </span><span class="line" data-startTime="748">you can write your </span><span class="line" data-startTime="752">own API that looks like a Google </span><span class="line" data-startTime="752">API, and this giant </span><span class="line" data-startTime="756">tool chain is already </span><span class="line" data-startTime="756">at your disposal. </span> <span class="line" data-startTime="758">So now you can think about </span><span class="line" data-startTime="758">features instead of thinking </span><span class="line" data-startTime="761">about how in the world </span><span class="line" data-startTime="761">am I going to send my </span><span class="line" data-startTime="763">data back and forth. </span></p>

<p><span class="line" data-startTime="766">And the last piece of the puzzle </span><span class="line" data-startTime="766">that we use, it's a </span><span class="line" data-startTime="769">library that I wrote, so it's </span><span class="line" data-startTime="769">definitely my favorite piece. </span> <span class="line" data-startTime="772">It's called </span><span class="line" data-startTime="772">endpoints-proto-datastore. </span> <span class="line" data-startTime="774">And this is a way for us, on the </span><span class="line" data-startTime="774">Python runtime of Google </span><span class="line" data-startTime="777">App Engine, to have a way for </span><span class="line" data-startTime="777">our data and our interface to </span><span class="line" data-startTime="781">be the same. </span> <span class="line" data-startTime="782">So I have this simple class up </span><span class="line" data-startTime="782">here, bank account, which says </span><span class="line" data-startTime="785">OK, we've got an owner, which </span><span class="line" data-startTime="785">is a string, and a balance, </span><span class="line" data-startTime="788">which is a flow property. </span> <span class="line" data-startTime="789">So in my bank account, I have </span><span class="line" data-startTime="789">leet dollars, right? </span><span class="line" data-startTime="793">But my data through the client </span><span class="line" data-startTime="793">looks exactly like the </span><span class="line" data-startTime="797">structure that I'm defining </span><span class="line" data-startTime="797">on the server. </span></p>

<p><span class="line" data-startTime="800">And this again, data is the most </span><span class="line" data-startTime="800">important thing in our </span><span class="line" data-startTime="802">application. </span> <span class="line" data-startTime="804">I keep saying API, API, API. </span> <span class="line" data-startTime="806">Well, that I in API stands </span><span class="line" data-startTime="806">for interface. </span> <span class="line" data-startTime="809">And when we're writing </span><span class="line" data-startTime="809">applications, we care about </span><span class="line" data-startTime="812">getting data to the server </span><span class="line" data-startTime="812">and just moving </span><span class="line" data-startTime="815">away from that step. </span> <span class="line" data-startTime="816">All we really want to do is </span><span class="line" data-startTime="816">send what we know and just </span><span class="line" data-startTime="819">move on from there. </span> <span class="line" data-startTime="820">And so by using this </span><span class="line" data-startTime="820">library, we're </span><span class="line" data-startTime="823">actually able to do that. </span> <span class="line" data-startTime="824">So enough about the </span><span class="line" data-startTime="824">tools we did use. </span></p>

<p><span class="line" data-startTime="827">Let's talk about how </span><span class="line" data-startTime="827">we use them. </span></p>

<p class="speaker"><span class="line" data-starttime="831"><span class="speakerName">Ido Green</span>: So we take </span><span class="line" data-startTime="831">it from the client. </span> <span class="line" data-startTime="832">And as you saw before, and </span><span class="line" data-startTime="832">actually now it's all here, </span><span class="line" data-startTime="837">because some time passed, so </span><span class="line" data-startTime="837">we have it locally here as </span><span class="line" data-startTime="840">well, but here the most </span><span class="line" data-startTime="840">important aspect is when we </span><span class="line" data-startTime="843">open dev tools, we could see </span><span class="line" data-startTime="843">literally that we have all the </span><span class="line" data-startTime="845">metadata under local storage. </span> <span class="line" data-startTime="847">So the metadata on each and </span><span class="line" data-startTime="847">every photo is there. </span> <span class="line" data-startTime="849">And then we use the application </span><span class="line" data-startTime="849">File API to save </span><span class="line" data-startTime="852">the photos themselves. </span> <span class="line" data-startTime="854">When speaking about the </span><span class="line" data-startTime="854">application itself, so we </span><span class="line" data-startTime="856">touched upon it, but we want </span><span class="line" data-startTime="856">the skeleton of the app </span><span class="line" data-startTime="858">already in our disposal. </span> <span class="line" data-startTime="860">So one interaction, and we're </span><span class="line" data-startTime="860">getting the HTML, JavaScript, </span><span class="line" data-startTime="863">CSS of our app. </span></p>

<p><span class="line" data-startTime="865">We could download some assets, </span><span class="line" data-startTime="865">like some images and mp3 files </span><span class="line" data-startTime="869">if you want. </span> <span class="line" data-startTime="871">And once we do that, the </span><span class="line" data-startTime="871">app is full functional. </span> <span class="line" data-startTime="874">And from that moment, basically </span><span class="line" data-startTime="874">we're using the sync </span><span class="line" data-startTime="876">layer to speak with the server </span><span class="line" data-startTime="876">when we want this one source </span><span class="line" data-startTime="878">of truth to broadcast all the </span><span class="line" data-startTime="878">information to all the </span><span class="line" data-startTime="882">different devices that we </span><span class="line" data-startTime="882">consume and use this </span><span class="line" data-startTime="884">application. </span> <span class="line" data-startTime="886">Photos, we love photos, and </span><span class="line" data-startTime="886">that's why we shift our app </span><span class="line" data-startTime="889">around them. </span> <span class="line" data-startTime="890">For photos, we have quite a lot </span><span class="line" data-startTime="890">of abilities to save them. </span> <span class="line" data-startTime="894">In our case, we use files. </span> <span class="line" data-startTime="896">So like any other platform, </span><span class="line" data-startTime="896">you could really use files </span><span class="line" data-startTime="899">under the browser. </span> <span class="line" data-startTime="900">And in our case, HTML5 File </span><span class="line" data-startTime="900">API is really nice to work </span><span class="line" data-startTime="905">with filer.js, that Eric </span><span class="line" data-startTime="905">Bidelman wrote, and its open </span><span class="line" data-startTime="907">source in GitHub. </span></p>

<p><span class="line" data-startTime="908">And basically, it lets you open </span><span class="line" data-startTime="908">files like you're working </span><span class="line" data-startTime="910">with files in Linux. </span> <span class="line" data-startTime="912">One of the things that we did </span><span class="line" data-startTime="912">here that's another tip is </span><span class="line" data-startTime="916">that we choose the right </span><span class="line" data-startTime="916">tool to the job. </span> <span class="line" data-startTime="918">So when we want to save </span><span class="line" data-startTime="918">metadata, local storage is </span><span class="line" data-startTime="922">perfect key value. </span> <span class="line" data-startTime="923">API, when we want to store the </span><span class="line" data-startTime="923">images, we want to store </span><span class="line" data-startTime="926">binary data. </span> <span class="line" data-startTime="927">So it would be much more </span><span class="line" data-startTime="927">efficient to render </span><span class="line" data-startTime="929">the DOM with them. </span> <span class="line" data-startTime="929">And we don't need these basics </span><span class="line" data-startTime="929">for in and out each time. </span> <span class="line" data-startTime="933">That's why we choose the File </span><span class="line" data-startTime="933">API with the local storage to </span><span class="line" data-startTime="936">do the best in both worlds. </span> <span class="line" data-startTime="939">When we're going and speaking </span><span class="line" data-startTime="939">about the world out there, </span><span class="line" data-startTime="942">it's usually not white </span><span class="line" data-startTime="942">and black. </span></p>

<p><span class="line" data-startTime="944">It's usually the golden </span><span class="line" data-startTime="944">path between them. </span> <span class="line" data-startTime="946">And it's a complex world. </span> <span class="line" data-startTime="947">We have a wide range </span><span class="line" data-startTime="947">of devices with </span><span class="line" data-startTime="950">browsers, with versions. </span> <span class="line" data-startTime="952">And we want to support as </span><span class="line" data-startTime="952">much many of course. </span> <span class="line" data-startTime="955">In our case, one of the things </span><span class="line" data-startTime="955">that we choose is this </span><span class="line" data-startTime="957">obstruction layer. </span> <span class="line" data-startTime="958">In our case, it's launcher. </span> <span class="line" data-startTime="959">But there are plenty of other </span><span class="line" data-startTime="959">libraries that are out there </span><span class="line" data-startTime="963">that basically mask the </span><span class="line" data-startTime="963">lower level APIs that </span><span class="line" data-startTime="964">you're going to use. </span></p>

<p><span class="line" data-startTime="965">And it will do the best things </span><span class="line" data-startTime="965">with the capabilities that </span><span class="line" data-startTime="968">your users' browsers </span><span class="line" data-startTime="968">are letting you do. </span> <span class="line" data-startTime="970">So if there is quite an old </span><span class="line" data-startTime="970">browser, and it just supports, </span><span class="line" data-startTime="973">let's say, local storage, </span><span class="line" data-startTime="973">it will do </span><span class="line" data-startTime="974">that, or website storage. </span> <span class="line" data-startTime="976">If it has NoSQL, the </span><span class="line" data-startTime="976">new IndexedDB </span><span class="line" data-startTime="979">there, it will use it. </span> <span class="line" data-startTime="980">If you need WebSQL on another </span><span class="line" data-startTime="980">platform, it will let you do </span><span class="line" data-startTime="983">that as well. </span> <span class="line" data-startTime="984">And it's really nice, because in </span><span class="line" data-startTime="984">your data layer, you could </span><span class="line" data-startTime="987">just commit the save method. </span></p>

<p><span class="line" data-startTime="989">And under the seam, it will do </span><span class="line" data-startTime="989">the right things with it. </span></p>

<p class="speaker"><span class="line" data-starttime="994"><span class="speakerName">Danny Hermes</span>: So we actually </span><span class="line" data-startTime="994">can do this demo because it </span><span class="line" data-startTime="996">doesn't require the network. </span></p>

<p class="speaker"><span class="line" data-starttime="997"><span class="speakerName">Ido Green</span>: Right. </span><span class="line" data-startTime="998">So let's switch. </span></p>

<p class="speaker"><span class="line" data-starttime="1000"><span class="speakerName">Danny Hermes</span>: So this is </span><span class="line" data-startTime="1000">the mobile device. </span></p>

<p class="speaker"><span class="line" data-starttime="1002"><span class="speakerName">Ido Green</span>: And you can see now </span><span class="line" data-startTime="1002">that we've got all the photos </span><span class="line" data-startTime="1004">from before, and even </span><span class="line" data-startTime="1004">the one that I took </span><span class="line" data-startTime="1006">on the machine itself. </span></p>

<p class="speaker"><span class="line" data-starttime="1008"><span class="speakerName">Danny Hermes</span>: Let me &mdash; </span><span class="line" data-startTime="1015">there we go. </span><span class="line" data-startTime="1017">And I have here the Chrome </span><span class="line" data-startTime="1017">Inspector open for this </span><span class="line" data-startTime="1021">application. </span><span class="line" data-startTime="1022">And we can actually see </span><span class="line" data-startTime="1022">all these assets. </span><span class="line" data-startTime="1024">So if we blow them away, </span><span class="line" data-startTime="1024">goodbye, goodbye, goodbye, and </span><span class="line" data-startTime="1029">go back to the application, </span><span class="line" data-startTime="1029">force a reload, we still have </span><span class="line" data-startTime="1035">the application, but none </span><span class="line" data-startTime="1035">of the data is there. </span><span class="line" data-startTime="1038">And we really don't </span><span class="line" data-startTime="1038">have a connection </span><span class="line" data-startTime="1040">to make this happen. </span><span class="line" data-startTime="1041">So it's really completely </span><span class="line" data-startTime="1041">happening locally. </span><span class="line" data-startTime="1043">So it's a wonderful </span><span class="line" data-startTime="1043">thing that we </span><span class="line" data-startTime="1047">actually get to demo something. </span></p>

<p class="speaker"><span class="line" data-starttime="1050"><span class="speakerName">Ido Green</span>: Lucky us. </span></p>

<p class="speaker"><span class="line" data-starttime="1052"><span class="speakerName">Danny Hermes</span>: So that was </span><span class="line" data-startTime="1052">how it works offline. </span> <span class="line" data-startTime="1055">And I promise, though that </span><span class="line" data-startTime="1055">button was green, that really </span><span class="line" data-startTime="1058">was offline. </span> <span class="line" data-startTime="1059">But let's talk about online, how </span><span class="line" data-startTime="1059">we're actually talking to </span><span class="line" data-startTime="1062">our server when we are talking </span><span class="line" data-startTime="1062">to our server, as infrequently </span><span class="line" data-startTime="1067">as that may be. </span> <span class="line" data-startTime="1069">So first, that red button, which </span><span class="line" data-startTime="1069">would have worked great, </span><span class="line" data-startTime="1074">is very simple to add if you </span><span class="line" data-startTime="1074">want to add authorization to </span><span class="line" data-startTime="1076">your application. </span> <span class="line" data-startTime="1077">It's really a tiny bit of HTML, </span><span class="line" data-startTime="1077">just a button with a </span><span class="line" data-startTime="1082">sign in call back to actually </span><span class="line" data-startTime="1082">respond from the response of </span><span class="line" data-startTime="1088">whether or not sign in was </span><span class="line" data-startTime="1088">successful or not. </span> <span class="line" data-startTime="1092">So this is another thing which </span><span class="line" data-startTime="1092">we don't have to do. </span> <span class="line" data-startTime="1094">Easy button. </span> <span class="line" data-startTime="1096">So how about discovery? </span><span class="line" data-startTime="1098">How is discovery helping us with </span><span class="line" data-startTime="1098">actually calling our API? </span><span class="line" data-startTime="1102">So in this first code snippet </span><span class="line" data-startTime="1102">up above, we see gapi dot </span><span class="line" data-startTime="1106">client dot load, and </span><span class="line" data-startTime="1106">then there's an API </span><span class="line" data-startTime="1108">name and an API version. </span></p>

<p><span class="line" data-startTime="1109">And this is how we're actually </span><span class="line" data-startTime="1109">loading the client library for </span><span class="line" data-startTime="1113">a specific API, in this case, </span><span class="line" data-startTime="1113">the URL Shortener API. </span> <span class="line" data-startTime="1117">And once we've done that, the </span><span class="line" data-startTime="1117">gapi dot client object now has </span><span class="line" data-startTime="1122">a URL shortener object, which it </span><span class="line" data-startTime="1122">owns, which knows how to do </span><span class="line" data-startTime="1125">everything in calling </span><span class="line" data-startTime="1125">that API, which is </span><span class="line" data-startTime="1128">specified in discovery. </span> <span class="line" data-startTime="1129">And through the library, we </span><span class="line" data-startTime="1129">just pass in our payload. </span> <span class="line" data-startTime="1132">And from there, we get an object </span><span class="line" data-startTime="1132">which has an execute </span><span class="line" data-startTime="1135">method, and that execute method </span><span class="line" data-startTime="1135">will take a call back, </span><span class="line" data-startTime="1138">and that callback handles </span><span class="line" data-startTime="1138">the response. </span> <span class="line" data-startTime="1139">Very simple, and it's based </span><span class="line" data-startTime="1139">on the discovery </span><span class="line" data-startTime="1142">document for that API. </span> <span class="line" data-startTime="1143">So with Google Cloud Endpoints, </span><span class="line" data-startTime="1143">this is already at </span><span class="line" data-startTime="1147">our disposal. </span></p>

<p><span class="line" data-startTime="1148">So in the same fashion, we </span><span class="line" data-startTime="1148">specify our API name and </span><span class="line" data-startTime="1151">version to gapi dot client dot </span><span class="line" data-startTime="1151">load, but we also need to </span><span class="line" data-startTime="1155">specify an API route because </span><span class="line" data-startTime="1155">we can't host our APIs on </span><span class="line" data-startTime="1159">googleapis.com if we're </span><span class="line" data-startTime="1159">not Google, right? </span><span class="line" data-startTime="1162">And then to actually call the </span><span class="line" data-startTime="1162">API, it's the exact same </span><span class="line" data-startTime="1166">thing, gapi dot client, </span><span class="line" data-startTime="1166">API name, the </span><span class="line" data-startTime="1170">resource, then the method. </span> <span class="line" data-startTime="1171">And you got it. </span> <span class="line" data-startTime="1172">It's the exact same thing. </span> <span class="line" data-startTime="1174">So I got this. </span> <span class="line" data-startTime="1178">So what happened to minimizing </span><span class="line" data-startTime="1178">interactions? </span><span class="line" data-startTime="1181">So there was actually a bad </span><span class="line" data-startTime="1181">thing in there, which goes </span><span class="line" data-startTime="1184">against these things we </span><span class="line" data-startTime="1184">were saying before. </span> <span class="line" data-startTime="1188">Gapi dot client dot load </span><span class="line" data-startTime="1188">actually uses a network call </span><span class="line" data-startTime="1191">every time we want to </span><span class="line" data-startTime="1191">talk to a new API. </span></p>

<p><span class="line" data-startTime="1195">So if we are in these conditions </span><span class="line" data-startTime="1195">where we don't have </span><span class="line" data-startTime="1198">a great network connection, </span><span class="line" data-startTime="1198">wasting one request could make </span><span class="line" data-startTime="1202">a difference between actually </span><span class="line" data-startTime="1202">retrieving a photo and making </span><span class="line" data-startTime="1204">a user's experience </span><span class="line" data-startTime="1204">better or not. </span> <span class="line" data-startTime="1207">So to get the most out of it, we </span><span class="line" data-startTime="1207">have to tweak this a little </span><span class="line" data-startTime="1210">bit and get our hands dirty, </span><span class="line" data-startTime="1210">but not too dirty. </span> <span class="line" data-startTime="1214">So if you were to pop open the </span><span class="line" data-startTime="1214">Chrome dev tools and check out </span><span class="line" data-startTime="1219">the network for a typical </span><span class="line" data-startTime="1219">request, you would see a giant </span><span class="line" data-startTime="1222">waterfall with a bunch of </span><span class="line" data-startTime="1222">RPCs down the left. </span> <span class="line" data-startTime="1225">And one of those RPCs really </span><span class="line" data-startTime="1225">isn't too complex. </span> <span class="line" data-startTime="1229">It's a standard path based on </span><span class="line" data-startTime="1229">where your application lives. </span> <span class="line" data-startTime="1233">And then the actual payload </span><span class="line" data-startTime="1233">takes a method name, so here </span><span class="line" data-startTime="1236">picturesque photo list when we </span><span class="line" data-startTime="1236">want to list photos, and then </span><span class="line" data-startTime="1240">the actual payload as params. </span></p>

<p><span class="line" data-startTime="1242">So constructing one of these, </span><span class="line" data-startTime="1242">not so difficult. </span> <span class="line" data-startTime="1245">But we wanted to make things </span><span class="line" data-startTime="1245">easier, right? </span><span class="line" data-startTime="1246">So never fear. </span> <span class="line" data-startTime="1248">GAPI actually provides us a way </span><span class="line" data-startTime="1248">to do this without wasting </span><span class="line" data-startTime="1252">that network request on </span><span class="line" data-startTime="1252">GAPI client load. </span> <span class="line" data-startTime="1254">So we can actually create the </span><span class="line" data-startTime="1254">RPC request by hand using </span><span class="line" data-startTime="1259">gapi.client and call it in the </span><span class="line" data-startTime="1259">exact same fashion by passing </span><span class="line" data-startTime="1263">a call back to execute. </span> <span class="line" data-startTime="1264">So it's OK. </span> <span class="line" data-startTime="1266">We can still use it. </span></p>

<p><span class="line" data-startTime="1268">And this is how we're </span><span class="line" data-startTime="1268">calling offline. </span> <span class="line" data-startTime="1270">So now that we know how to call </span><span class="line" data-startTime="1270">offline, let's actually </span><span class="line" data-startTime="1273">see how we're doing this, not </span><span class="line" data-startTime="1273">in the abstract, but in the </span><span class="line" data-startTime="1277">applied sense in our </span><span class="line" data-startTime="1277">application. </span></p>

<p class="speaker"><span class="line" data-starttime="1282"><span class="speakerName">Ido Green</span>: So we all know, and </span><span class="line" data-startTime="1282">we spoke about the separation </span><span class="line" data-startTime="1284">between our data and the views, </span><span class="line" data-startTime="1284">and here when we are </span><span class="line" data-startTime="1288">taking a photo, one of the most </span><span class="line" data-startTime="1288">important aspect is that </span><span class="line" data-startTime="1291">today, modern browsers, you </span><span class="line" data-startTime="1291">put in this one line, and </span><span class="line" data-startTime="1293">basically you're getting the </span><span class="line" data-startTime="1293">ability to go to the camera </span><span class="line" data-startTime="1296">itself, and in some cases, to </span><span class="line" data-startTime="1296">the file system that you have </span><span class="line" data-startTime="1298">on the device, and to </span><span class="line" data-startTime="1298">choose the camera. </span> <span class="line" data-startTime="1300">So you don't need any other apps </span><span class="line" data-startTime="1300">or any other libraries in </span><span class="line" data-startTime="1303">order to support this close </span><span class="line" data-startTime="1303">nature to the methods of the </span><span class="line" data-startTime="1306">device itself. </span> <span class="line" data-startTime="1309">When we come in to do it in our </span><span class="line" data-startTime="1309">own application, what we </span><span class="line" data-startTime="1312">have here in store is </span><span class="line" data-startTime="1312">our own data layer. </span> <span class="line" data-startTime="1315">And we have the callbacks just </span><span class="line" data-startTime="1315">to make sure that we'll be </span><span class="line" data-startTime="1317">able to respond to the things </span><span class="line" data-startTime="1317">that we make in the </span><span class="line" data-startTime="1320">configuration of it. </span></p>

<p><span class="line" data-startTime="1321">But then the beauty is that </span><span class="line" data-startTime="1321">we have the save click. </span> <span class="line" data-startTime="1324">And basically, we just need </span><span class="line" data-startTime="1324">to focus on that. </span> <span class="line" data-startTime="1326">Our add photo method is asking </span><span class="line" data-startTime="1326">us what we'll do beneath it in </span><span class="line" data-startTime="1329">the sync layer. </span> <span class="line" data-startTime="1330">So for us now as developers that </span><span class="line" data-startTime="1330">are using this library, </span><span class="line" data-startTime="1333">we just want to save </span><span class="line" data-startTime="1333">the photo. </span> <span class="line" data-startTime="1334">We don't care about if </span><span class="line" data-startTime="1334">it's locally, if it's </span><span class="line" data-startTime="1336">in the cloud, whatever. </span> <span class="line" data-startTime="1337">We just know that it </span><span class="line" data-startTime="1337">would be saved. </span> <span class="line" data-startTime="1339">And then the codec will return </span><span class="line" data-startTime="1339">and let us know what </span><span class="line" data-startTime="1342">happened with it. </span></p>

<p><span class="line" data-startTime="1343">So we'll communicate it </span><span class="line" data-startTime="1343">to the view itself. </span></p>

<p class="speaker"><span class="line" data-starttime="1346"><span class="speakerName">Danny Hermes</span>: So on the server, </span><span class="line" data-startTime="1346">when that add photo </span><span class="line" data-startTime="1349">request comes through, in the </span><span class="line" data-startTime="1349">same way we defined a bank </span><span class="line" data-startTime="1351">account using </span><span class="line" data-startTime="1351">endpoints-proto-datastore, we </span><span class="line" data-startTime="1354">define a photo with the same </span><span class="line" data-startTime="1354">data that we expect to send in </span><span class="line" data-startTime="1357">our interface. </span><span class="line" data-startTime="1359">And with that, there's </span><span class="line" data-startTime="1359">a nice bit of sugar. </span><span class="line" data-startTime="1361">There's a decorator provided, </span><span class="line" data-startTime="1361">photo dot method, which allows </span><span class="line" data-startTime="1365">us to decorate a method, which </span><span class="line" data-startTime="1365">will expect to actually </span><span class="line" data-startTime="1369">receive a native photo </span><span class="line" data-startTime="1369">object based on the </span><span class="line" data-startTime="1371">data from the request. </span><span class="line" data-startTime="1373">So here, we could do some things </span><span class="line" data-startTime="1373">to validate the request </span><span class="line" data-startTime="1376">after it comes in, but </span><span class="line" data-startTime="1376">essentially, all we really </span><span class="line" data-startTime="1379">want to do is store it. </span><span class="line" data-startTime="1380">So we call photo dot put to save </span><span class="line" data-startTime="1380">that in the App Engine </span><span class="line" data-startTime="1384">data store. </span></p>

<p class="speaker"><span class="line" data-starttime="1387"><span class="speakerName">Ido Green</span>: And in the client, </span><span class="line" data-startTime="1387">when we basically use this </span><span class="line" data-startTime="1389">separation between our data and </span><span class="line" data-startTime="1389">our views, what we did is </span><span class="line" data-startTime="1392">just listening to the online </span><span class="line" data-startTime="1392">navigator, and you could see </span><span class="line" data-startTime="1395">quite nicely here what's </span><span class="line" data-startTime="1395">happening. </span> <span class="line" data-startTime="1397">So let's see this piece of code </span><span class="line" data-startTime="1397">and walk you through it. </span> <span class="line" data-startTime="1399">Basically, we have the task </span><span class="line" data-startTime="1399">object that know how to handle </span><span class="line" data-startTime="1402">our calls to the API itself, and </span><span class="line" data-startTime="1402">we have some payloads and </span><span class="line" data-startTime="1406">some metadata on our photos. </span> <span class="line" data-startTime="1408">And when we go in and we want </span><span class="line" data-startTime="1408">to active a new task, </span><span class="line" data-startTime="1411">basically we see if our </span><span class="line" data-startTime="1411">user is logged in, </span><span class="line" data-startTime="1414">and here we'll know. </span></p>

<p><span class="line" data-startTime="1415">In case it doesn't login because </span><span class="line" data-startTime="1415">we had some problems </span><span class="line" data-startTime="1418">like in our demo, we go to this </span><span class="line" data-startTime="1418">special queue and just </span><span class="line" data-startTime="1422">put it, and we'll wait until it </span><span class="line" data-startTime="1422">would be authenticated and </span><span class="line" data-startTime="1425">log into our app. </span> <span class="line" data-startTime="1427">In the case that it is logged </span><span class="line" data-startTime="1427">in, we just need to check with </span><span class="line" data-startTime="1430">navigator online if we are </span><span class="line" data-startTime="1430">online or offline, and that in </span><span class="line" data-startTime="1433">case we are online, we just want </span><span class="line" data-startTime="1433">to call the task itself </span><span class="line" data-startTime="1436">and do the best in terms of </span><span class="line" data-startTime="1436">going local storage or moving </span><span class="line" data-startTime="1439">it to the cloud. </span> <span class="line" data-startTime="1440">And if it's not online for some </span><span class="line" data-startTime="1440">reason, or we got some </span><span class="line" data-startTime="1443">flaky connections, we just add </span><span class="line" data-startTime="1443">it to this queue of offline </span><span class="line" data-startTime="1446">tasks that we'll run over and </span><span class="line" data-startTime="1446">over to make sure when we have </span><span class="line" data-startTime="1449">connection, to just take </span><span class="line" data-startTime="1449">those tasks and </span><span class="line" data-startTime="1452">send them to the server. </span> <span class="line" data-startTime="1453">The beauty here is that we </span><span class="line" data-startTime="1453">always take the photo and </span><span class="line" data-startTime="1455">immediately save it locally, </span><span class="line" data-startTime="1455">but then when we have </span><span class="line" data-startTime="1458">connection, we'll sync it </span><span class="line" data-startTime="1458">to the server itself. </span></p>

<p></p>

<p class="speaker"><span class="line" data-starttime="1464"><span class="speakerName">Danny Hermes</span>: All right. </span> <span class="line" data-startTime="1465">So sorry about that. </span> <span class="line" data-startTime="1466">We're actually going to </span><span class="line" data-startTime="1466">try to demo something. </span> <span class="line" data-startTime="1468">They've got some hardware which </span><span class="line" data-startTime="1468">will let us get ethernet </span><span class="line" data-startTime="1471">into that tablet. </span> <span class="line" data-startTime="1472">So after we create a photo, </span><span class="line" data-startTime="1472">there's really only one other </span><span class="line" data-startTime="1476">thing we want to do for this </span><span class="line" data-startTime="1476">application, which is getting </span><span class="line" data-startTime="1478">photos potentially from other </span><span class="line" data-startTime="1478">devices that we have saved for </span><span class="line" data-startTime="1481">our account. </span> <span class="line" data-startTime="1483">So we're actually going to &mdash; </span><span class="line" data-startTime="1485">this is the point where the </span><span class="line" data-startTime="1485">server doing the expensive </span><span class="line" data-startTime="1487">things comes into place. </span> <span class="line" data-startTime="1489">But in doing those expensive </span><span class="line" data-startTime="1489">things, we have to keep </span><span class="line" data-startTime="1492">something in mind. </span> <span class="line" data-startTime="1493">Minimize interactions, if </span><span class="line" data-startTime="1493">it wasn't clear already. </span> <span class="line" data-startTime="1496">So what are some things </span><span class="line" data-startTime="1496">that we're doing? </span><span class="line" data-startTime="1499">We're loading photos in the </span><span class="line" data-startTime="1499">order that the server learned </span><span class="line" data-startTime="1503">about them. </span></p>

<p><span class="line" data-startTime="1504">And so by doing this, we </span><span class="line" data-startTime="1504">actually have a time stamp, </span><span class="line" data-startTime="1507">which is sort of the latest </span><span class="line" data-startTime="1507">date that our client knows </span><span class="line" data-startTime="1511">that it talked to the server. </span> <span class="line" data-startTime="1512">And of course, in the same way </span><span class="line" data-startTime="1512">we implemented the sync layer </span><span class="line" data-startTime="1516">with create, when it's time to </span><span class="line" data-startTime="1516">actually talk to the API, if </span><span class="line" data-startTime="1520">we're not online, we're not </span><span class="line" data-startTime="1520">signed in, we defer it into </span><span class="line" data-startTime="1523">some kind of task. </span> <span class="line" data-startTime="1526">Back to the slides, please. </span> <span class="line" data-startTime="1528">Yeah. </span> <span class="line" data-startTime="1531">So on the client &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="1533"><span class="speakerName">Ido Green</span>: On the client, </span><span class="line" data-startTime="1533">what we do here is </span><span class="line" data-startTime="1535">basically quite simple. </span> <span class="line" data-startTime="1536">We're getting the local photos </span><span class="line" data-startTime="1536">first and getting </span><span class="line" data-startTime="1539">a remote call back. </span> <span class="line" data-startTime="1540">And now that we got all the </span><span class="line" data-startTime="1540">local photos first, we're </span><span class="line" data-startTime="1542">getting some metadata with </span><span class="line" data-startTime="1542">them, and one of the most </span><span class="line" data-startTime="1544">important aspect is </span><span class="line" data-startTime="1544">the last update. </span> <span class="line" data-startTime="1546">So we'll call the server with </span><span class="line" data-startTime="1546">this attribute and making sure </span><span class="line" data-startTime="1549">that we're just getting the </span><span class="line" data-startTime="1549">data of the photos that we </span><span class="line" data-startTime="1551">don't have locally. </span></p>

<p><span class="line" data-startTime="1552">And that will, of course, </span><span class="line" data-startTime="1552">improve the performance, and </span><span class="line" data-startTime="1555">basically will reduce the time </span><span class="line" data-startTime="1555">and the time around it we are </span><span class="line" data-startTime="1558">spending just to get </span><span class="line" data-startTime="1558">all the data back. </span> <span class="line" data-startTime="1561">As you can see, in the client, </span><span class="line" data-startTime="1561">it's quite simple. </span> <span class="line" data-startTime="1563">The not problematic but </span><span class="line" data-startTime="1563">challenging aspect is on the </span><span class="line" data-startTime="1567">server side. </span> <span class="line" data-startTime="1567">So let's see how we're </span><span class="line" data-startTime="1567">doing there. </span></p>

<p class="speaker"><span class="line" data-starttime="1568"><span class="speakerName">Danny Hermes</span>: Yeah. </span> <span class="line" data-startTime="1569">So on the server, we're trying </span><span class="line" data-startTime="1569">to make our queries more </span><span class="line" data-startTime="1572">intelligent and make our server </span><span class="line" data-startTime="1572">work harder so that our </span><span class="line" data-startTime="1575">clients don't have to. </span> <span class="line" data-startTime="1576">So what we're actually going </span><span class="line" data-startTime="1576">to be doing is creating an </span><span class="line" data-startTime="1579">index for sort of more </span><span class="line" data-startTime="1579">complex interactions. </span> <span class="line" data-startTime="1582">So by default, the App Engine </span><span class="line" data-startTime="1582">NoSQL Datastore will create an </span><span class="line" data-startTime="1586">index for every property </span><span class="line" data-startTime="1586">that you have, unless </span><span class="line" data-startTime="1588">you tell it not to. </span> <span class="line" data-startTime="1590">So if you want to know every </span><span class="line" data-startTime="1590">photo that I own with title of </span><span class="line" data-startTime="1593">fu, it can do it for </span><span class="line" data-startTime="1593">you out of the box. </span> <span class="line" data-startTime="1596">But if you wanted something more </span><span class="line" data-startTime="1596">complex, like a composite </span><span class="line" data-startTime="1598">of some properties, like here we </span><span class="line" data-startTime="1598">see owner and updated, you </span><span class="line" data-startTime="1603">would have to specify that </span><span class="line" data-startTime="1603">in index.yaml file. </span></p>

<p><span class="line" data-startTime="1607">It's just a specification when </span><span class="line" data-startTime="1607">you deploy your application. </span> <span class="line" data-startTime="1610">So this actually makes it </span><span class="line" data-startTime="1610">a little more expensive. </span> <span class="line" data-startTime="1613">Every time we have to write our </span><span class="line" data-startTime="1613">entity to the data store </span><span class="line" data-startTime="1617">when we're saving the data </span><span class="line" data-startTime="1617">that we received from our </span><span class="line" data-startTime="1619">clients, we also have to create </span><span class="line" data-startTime="1619">a log and an index to </span><span class="line" data-startTime="1622">actually reference later when </span><span class="line" data-startTime="1622">we're doing these queries. </span> <span class="line" data-startTime="1625">But the advantage is when our </span><span class="line" data-startTime="1625">client makes the request, it's </span><span class="line" data-startTime="1630">way faster. </span></p>

<p><span class="line" data-startTime="1631">So to actually provide this </span><span class="line" data-startTime="1631">through our interface, the </span><span class="line" data-startTime="1635">library </span><span class="line" data-startTime="1635">endpoints-proto-datastore </span><span class="line" data-startTime="1637">actually provides us with </span><span class="line" data-startTime="1637">some extra sugar. </span> <span class="line" data-startTime="1640">Other than properties to be </span><span class="line" data-startTime="1640">persisted, we also have a </span><span class="line" data-startTime="1644">property called endpoints alias </span><span class="line" data-startTime="1644">property, as you see </span><span class="line" data-startTime="1647">here, which allows us to have </span><span class="line" data-startTime="1647">fields which are only a part </span><span class="line" data-startTime="1651">of the interface and never </span><span class="line" data-startTime="1651">get stored anywhere. </span> <span class="line" data-startTime="1653">And so for us to actually let </span><span class="line" data-startTime="1653">the client ask us, hey, I know </span><span class="line" data-startTime="1657">about everything up until </span><span class="line" data-startTime="1657">20 minutes ago. </span> <span class="line" data-startTime="1659">Can you give me everything </span><span class="line" data-startTime="1659">since 20 minutes ago? </span><span class="line" data-startTime="1661">We have to give them a way to </span><span class="line" data-startTime="1661">send 20 minutes ago, right? </span><span class="line" data-startTime="1665">So we have an endpoints </span><span class="line" data-startTime="1665">alias property. </span> <span class="line" data-startTime="1667">And the real work here is </span><span class="line" data-startTime="1667">happening in a setter. </span></p>

<p><span class="line" data-startTime="1671">So in that setter, </span><span class="line" data-startTime="1671">there's really </span><span class="line" data-startTime="1673">three things that happen. </span> <span class="line" data-startTime="1675">So the first thing, we take the </span><span class="line" data-startTime="1675">value from the request. </span> <span class="line" data-startTime="1677">We try to turn it from a string </span><span class="line" data-startTime="1677">to a native Python </span><span class="line" data-startTime="1680">daytime object. </span> <span class="line" data-startTime="1682">If we can't do it, we raise </span><span class="line" data-startTime="1682">what's called an endpoints dot </span><span class="line" data-startTime="1685">bad request exception. </span> <span class="line" data-startTime="1687">And for those familiar with HTTP </span><span class="line" data-startTime="1687">status codes, that tells </span><span class="line" data-startTime="1690">the client, hey, here's a 400. </span> <span class="line" data-startTime="1693">You sent me bad data. </span> <span class="line" data-startTime="1694">Send me good data or </span><span class="line" data-startTime="1694">don't talk to me. </span> <span class="line" data-startTime="1696">And of course, if we did get </span><span class="line" data-startTime="1696">good data, then we take the </span><span class="line" data-startTime="1700">query associated with the </span><span class="line" data-startTime="1700">request, and we are able to </span><span class="line" data-startTime="1703">add a filter, which here says </span><span class="line" data-startTime="1703">photo dot updated greater than </span><span class="line" data-startTime="1708">or equal to last updated. </span></p>

<p><span class="line" data-startTime="1709">So what this does, it takes our </span><span class="line" data-startTime="1709">data and says we only want </span><span class="line" data-startTime="1713">the things which have been </span><span class="line" data-startTime="1713">updated since, for example, 20 </span><span class="line" data-startTime="1716">minutes ago, whatever </span><span class="line" data-startTime="1716">time stamp came </span><span class="line" data-startTime="1718">in through the request. </span> <span class="line" data-startTime="1720">And finally, when we're actually </span><span class="line" data-startTime="1720">serving this request, </span><span class="line" data-startTime="1725">in the same way we got a photo </span><span class="line" data-startTime="1725">dot method decorator, we have </span><span class="line" data-startTime="1728">a photo dot query decorator, </span><span class="line" data-startTime="1728">which allows us to interact </span><span class="line" data-startTime="1731">directly with a data store </span><span class="line" data-startTime="1731">query, instead of directly </span><span class="line" data-startTime="1735">with the data, the photo </span><span class="line" data-startTime="1735">from the request. </span> <span class="line" data-startTime="1738">And so we want to order that </span><span class="line" data-startTime="1738">query by when it was updated. </span> <span class="line" data-startTime="1742">And by doing this, if a user has </span><span class="line" data-startTime="1742">to actually page through a </span><span class="line" data-startTime="1745">results set, they will </span><span class="line" data-startTime="1745">get them in the order </span><span class="line" data-startTime="1748">from oldest to newest. </span></p>

<p><span class="line" data-startTime="1750">And so, for example, if you </span><span class="line" data-startTime="1750">drop your connection while </span><span class="line" data-startTime="1753">you're paging through a results </span><span class="line" data-startTime="1753">set, you'll actually </span><span class="line" data-startTime="1755">be able to say, well, it used </span><span class="line" data-startTime="1755">to be that I knew about </span><span class="line" data-startTime="1757">everything up until </span><span class="line" data-startTime="1757">20 minutes ago. </span> <span class="line" data-startTime="1759">Now I know about everything </span><span class="line" data-startTime="1759">until 10 minutes ago, and so I </span><span class="line" data-startTime="1762">don't have to waste that query </span><span class="line" data-startTime="1762">for the time in between. </span> <span class="line" data-startTime="1766">So that was everything that we </span><span class="line" data-startTime="1766">would have showed in the demo, </span><span class="line" data-startTime="1771">some other things that we would </span><span class="line" data-startTime="1771">have like to have done, </span><span class="line" data-startTime="1774">and which we will be adding to </span><span class="line" data-startTime="1774">the open source code for this </span><span class="line" data-startTime="1778">application. </span> <span class="line" data-startTime="1780">One would be sharing. </span></p>

<p><span class="line" data-startTime="1782">So we actually did implement </span><span class="line" data-startTime="1782">this before, and we were able </span><span class="line" data-startTime="1787">to create an access control </span><span class="line" data-startTime="1787">list, or an apple, for every </span><span class="line" data-startTime="1790">photo, and allow users with </span><span class="line" data-startTime="1790">Google+ share intents to </span><span class="line" data-startTime="1794">actually have a native Google+ </span><span class="line" data-startTime="1794">share button and share their </span><span class="line" data-startTime="1798">photos with other users. </span> <span class="line" data-startTime="1800">And it would again be based </span><span class="line" data-startTime="1800">on auth and fairly easy. </span> <span class="line" data-startTime="1804">In addition, we were downscoping </span><span class="line" data-startTime="1804">the photos, </span><span class="line" data-startTime="1806">shrinking them so they would fit </span><span class="line" data-startTime="1806">in the Google App Engine </span><span class="line" data-startTime="1810">data store. </span> <span class="line" data-startTime="1810">There are many pieces of the </span><span class="line" data-startTime="1810">Google Cloud Platform that </span><span class="line" data-startTime="1814">address storage. </span></p>

<p><span class="line" data-startTime="1815">And so Google Cloud Storage, </span><span class="line" data-startTime="1815">or the Google App Engine </span><span class="line" data-startTime="1819">Blobstore, are probably a better </span><span class="line" data-startTime="1819">place for large and </span><span class="line" data-startTime="1822">high quality photos, rather than </span><span class="line" data-startTime="1822">the data store, which in </span><span class="line" data-startTime="1826">the same way that local storage </span><span class="line" data-startTime="1826">was a good place to </span><span class="line" data-startTime="1830">actually store metadata, while </span><span class="line" data-startTime="1830">the local file system was a </span><span class="line" data-startTime="1834">good place to store photos, we </span><span class="line" data-startTime="1834">have the data store as a good </span><span class="line" data-startTime="1837">place for metadata and a nice </span><span class="line" data-startTime="1837">bucket type system like cloud </span><span class="line" data-startTime="1843">storage, which is a good </span><span class="line" data-startTime="1843">place for photos. </span></p>

<p class="speaker"><span class="line" data-starttime="1847"><span class="speakerName">Ido Green</span>: Yeah. </span> <span class="line" data-startTime="1848">Take a deep breath. </span> <span class="line" data-startTime="1851">So we tried to tell you a story </span><span class="line" data-startTime="1851">and communicate some </span><span class="line" data-startTime="1854">important aspect that </span><span class="line" data-startTime="1854">we found compelling. </span> <span class="line" data-startTime="1856">One is that Google App Engine </span><span class="line" data-startTime="1856">and specifically Google Cloud </span><span class="line" data-startTime="1859">Endpoint is powerful service </span><span class="line" data-startTime="1859">that you might want to check </span><span class="line" data-startTime="1861">out in your next API service </span><span class="line" data-startTime="1861">product that you're building. </span> <span class="line" data-startTime="1865">Or we think about performance </span><span class="line" data-startTime="1865">and try to minimize the </span><span class="line" data-startTime="1868">connections and optimize each </span><span class="line" data-startTime="1868">and every connection that </span><span class="line" data-startTime="1870">you're doing to the server. </span></p>

<p><span class="line" data-startTime="1872">Use obstructions layer and do </span><span class="line" data-startTime="1872">clear separation between your </span><span class="line" data-startTime="1875">data and the views. </span> <span class="line" data-startTime="1876">It will be much more </span><span class="line" data-startTime="1876">maintainable code. </span> <span class="line" data-startTime="1878">And as you all know, you're </span><span class="line" data-startTime="1878">reading code much more than </span><span class="line" data-startTime="1880">you're writing it, so you do </span><span class="line" data-startTime="1880">want the shortest possible </span><span class="line" data-startTime="1883">clear code in your app. </span> <span class="line" data-startTime="1886">Leverage modern browser </span><span class="line" data-startTime="1886">features. </span> <span class="line" data-startTime="1887">So we have actually on </span><span class="line" data-startTime="1887">the mobile browsers </span><span class="line" data-startTime="1891">quite a lot of features. </span> <span class="line" data-startTime="1892">And a site like caniuse.com </span><span class="line" data-startTime="1892">could reveal to you all the </span><span class="line" data-startTime="1895">new APIs that mobile browser </span><span class="line" data-startTime="1895">are supporting, and we have </span><span class="line" data-startTime="1898">great adoption in that field. </span></p>

<p><span class="line" data-startTime="1900">So just use them. </span> <span class="line" data-startTime="1901">We have some really nice talks </span><span class="line" data-startTime="1901">today, tomorrow, and on Friday </span><span class="line" data-startTime="1905">that are addressing it, and </span><span class="line" data-startTime="1905">we highly encourage you </span><span class="line" data-startTime="1907">to check them out. </span> <span class="line" data-startTime="1908">There are a few options here. </span> <span class="line" data-startTime="1910">Danny chose his favorite. </span> <span class="line" data-startTime="1912">I chose mine. </span> <span class="line" data-startTime="1913">But feel free to </span><span class="line" data-startTime="1913">check them out. </span> <span class="line" data-startTime="1915">Some compelling stories about </span><span class="line" data-startTime="1915">how to do interesting things </span><span class="line" data-startTime="1917">in the cloud and on </span><span class="line" data-startTime="1917">the mobile web. </span> <span class="line" data-startTime="1922">Thank you very much </span><span class="line" data-startTime="1922">for your time. </span> <span class="line" data-startTime="1924">We do have seven minutes, and </span><span class="line" data-startTime="1924">would be more than happy to </span><span class="line" data-startTime="1928">try and answer your questions. </span> <span class="line" data-startTime="1930">[APPLAUSE] </span></p>

<p class="speaker"><span class="line" data-starttime="1933"><span class="speakerName">Danny Hermes</span>: In theory, </span><span class="line" data-startTime="1933">we could do the demo. </span></p>

<p class="speaker"><span class="line" data-starttime="1938"><span class="speakerName">Ido Green</span>: If you have </span><span class="line" data-startTime="1938">any questions, just </span><span class="line" data-startTime="1939">please come to the mic. </span></p>

<p class="speaker"><span class="line" data-starttime="1943"><span class="speakerName">Audience</span>: Hi. </span></p>

<p class="speaker"><span class="line" data-starttime="1944"><span class="speakerName">Ido Green</span>: Hi. </span></p>

<p class="speaker"><span class="line" data-starttime="1944"><span class="speakerName">Danny Hermes</span>: Howdy. </span></p>

<p class="speaker"><span class="line" data-starttime="1945"><span class="speakerName">Audience</span>: I've been using Cloud </span><span class="line" data-startTime="1945">Endpoints for some time, </span><span class="line" data-startTime="1948">and it's really, really cool. </span><span class="line" data-startTime="1950">One of the things that is </span><span class="line" data-startTime="1950">probably out of the scope of </span><span class="line" data-startTime="1952">this conference, </span><span class="line" data-startTime="1952">access control. </span><span class="line" data-startTime="1956">I mean, it's kind of a huge </span><span class="line" data-startTime="1956">beast to handle sometimes, so </span><span class="line" data-startTime="1960">I would love to see </span><span class="line" data-startTime="1960">elegant ways of </span><span class="line" data-startTime="1963">handling access control. </span></p>

<p class="speaker"><span class="line" data-starttime="1964"><span class="speakerName">Danny Hermes</span>: Sure, sure. </span> <span class="line" data-startTime="1967">I don't know that there's </span><span class="line" data-startTime="1967">a question there. </span> <span class="line" data-startTime="1968">But I will address sort of </span><span class="line" data-startTime="1968">the general concept. </span> <span class="line" data-startTime="1972">So with access controls, </span><span class="line" data-startTime="1972">we're essentially &mdash; </span><span class="line" data-startTime="1978">every user, especially when </span><span class="line" data-startTime="1978">you're doing Google+ sign in, </span><span class="line" data-startTime="1981">you get access to their Google+ </span><span class="line" data-startTime="1981">ID via the scopes that </span><span class="line" data-startTime="1983">they allow. </span> <span class="line" data-startTime="1984">And so there's sort of a </span><span class="line" data-startTime="1984">global ID for accounts. </span> <span class="line" data-startTime="1988">And so what we're using, we're </span><span class="line" data-startTime="1988">allowing the data store to </span><span class="line" data-startTime="1992">actually have just a list of </span><span class="line" data-startTime="1992">account IDs associated with </span><span class="line" data-startTime="1996">every photo. </span> <span class="line" data-startTime="1997">And then, in addition to that, </span><span class="line" data-startTime="1997">to make queries for somebody </span><span class="line" data-startTime="2000">else's stuff that I was </span><span class="line" data-startTime="2000">allowed to see. </span> <span class="line" data-startTime="2002">We would also, on our user </span><span class="line" data-startTime="2002">objects, where we were storing </span><span class="line" data-startTime="2006">our created user accounts, we </span><span class="line" data-startTime="2006">would keep a list of all the </span><span class="line" data-startTime="2010">other users that had shared </span><span class="line" data-startTime="2010">stuff with them. </span></p>

<p><span class="line" data-startTime="2012">And so by doing so, as sort of </span><span class="line" data-startTime="2012">a first order implementation, </span><span class="line" data-startTime="2018">we were able to actually to </span><span class="line" data-startTime="2018">utilize the data store and </span><span class="line" data-startTime="2024">queries from App Engine to </span><span class="line" data-startTime="2024">make it appear fast. </span> <span class="line" data-startTime="2027">But as far as something native, </span><span class="line" data-startTime="2027">there's not anything </span><span class="line" data-startTime="2030">that I know of. </span> <span class="line" data-startTime="2037">This mic's not on. </span></p>

<p class="speaker"><span class="line" data-starttime="2047"><span class="speakerName">Audience</span>: Operate on the Google+ </span><span class="line" data-startTime="2047">sign in plus endpoints </span><span class="line" data-startTime="2050">integration. </span><span class="line" data-startTime="2051">Because for plus log in, you </span><span class="line" data-startTime="2051">need to request a difference </span><span class="line" data-startTime="2055">code than for endpoints, </span><span class="line" data-startTime="2055">right? </span><span class="line" data-startTime="2057">The user emails code versus </span><span class="line" data-startTime="2057">that plus [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="2061"><span class="speakerName">Danny Hermes</span>: So the question </span><span class="line" data-startTime="2061">was he wanted us to elaborate </span><span class="line" data-startTime="2064">on how you can use endpoints </span><span class="line" data-startTime="2064">and G+ sign </span><span class="line" data-startTime="2066">in at the same time. </span><span class="line" data-startTime="2068">So what actually happens with </span><span class="line" data-startTime="2068">endpoints for typical OAuth is </span><span class="line" data-startTime="2080">you need the email scope and </span><span class="line" data-startTime="2080">sort of nothing else. </span><span class="line" data-startTime="2082">And G+ sign in requires the </span><span class="line" data-startTime="2082">user info profile scope. </span><span class="line" data-startTime="2087">But you can actually </span><span class="line" data-startTime="2087">combine the two. </span><span class="line" data-startTime="2089">So you have a token which has </span><span class="line" data-startTime="2089">both scopes on it, and either </span><span class="line" data-startTime="2094">ID tokens or bearer tokens can </span><span class="line" data-startTime="2094">be used with endpoints. </span><span class="line" data-startTime="2098">And so if you actually send a </span><span class="line" data-startTime="2098">bearer token, it will still </span><span class="line" data-startTime="2101">check out that it has </span><span class="line" data-startTime="2101">the email scope. </span><span class="line" data-startTime="2103">It's only in the ID token case </span><span class="line" data-startTime="2103">where that will fail since you </span><span class="line" data-startTime="2108">don't just have the </span><span class="line" data-startTime="2108">email scope. </span></p>

<p class="speaker"><span class="line" data-starttime="2112"><span class="speakerName">Ido Green</span>: Yes, please. </span></p>

<p class="speaker"><span class="line" data-starttime="2113"><span class="speakerName">Audience</span>: On the client side, </span><span class="line" data-startTime="2113">in this example, it looked </span><span class="line" data-startTime="2116">like all the data was </span><span class="line" data-startTime="2116">kind of dynamic. </span><span class="line" data-startTime="2119">I was wondering if you have any </span><span class="line" data-startTime="2119">guidance around what would </span><span class="line" data-startTime="2122">traditionally be the static </span><span class="line" data-startTime="2122">part of the pages that are </span><span class="line" data-startTime="2126">filled in with the dynamic data </span><span class="line" data-startTime="2126">with the idea that I want </span><span class="line" data-startTime="2130">to cache this and have it </span><span class="line" data-startTime="2130">available somewhat offline. </span></p>

<p class="speaker"><span class="line" data-starttime="2133"><span class="speakerName">Ido Green</span>: Yeah, so actually </span><span class="line" data-startTime="2133">we couldn't show it, but in </span><span class="line" data-startTime="2136">our demo, we had the structure </span><span class="line" data-startTime="2136">of the app itself, which </span><span class="line" data-startTime="2139">wasn't dynamic at all. </span> <span class="line" data-startTime="2140">So we have all the </span><span class="line" data-startTime="2140">assets with us. </span> <span class="line" data-startTime="2142">All the nice button and the </span><span class="line" data-startTime="2142">footer and the header are </span><span class="line" data-startTime="2146">actually being fetched </span><span class="line" data-startTime="2146">in the first call. </span> <span class="line" data-startTime="2148">And from that on, once we have </span><span class="line" data-startTime="2148">the skeleton of the app, it </span><span class="line" data-startTime="2151">could be a background image, </span><span class="line" data-startTime="2151">it could be some </span><span class="line" data-startTime="2154">music file if you like. </span> <span class="line" data-startTime="2155">Once we have all that, then </span><span class="line" data-startTime="2155">we're fetching everything </span><span class="line" data-startTime="2157">dynamically. </span></p>

<p><span class="line" data-startTime="2158">And it's actually a phenomenon </span><span class="line" data-startTime="2158">that we see in lots of </span><span class="line" data-startTime="2162">different apps, native end </span><span class="line" data-startTime="2162">mobile webs, where you have </span><span class="line" data-startTime="2165">the skeleton, and then the </span><span class="line" data-startTime="2165">data itself is being </span><span class="line" data-startTime="2166">retrieving. </span> <span class="line" data-startTime="2168">All the apps containing some </span><span class="line" data-startTime="2168">long list of things. </span> <span class="line" data-startTime="2170">It could be a mail. </span> <span class="line" data-startTime="2171">It could be a social app. </span> <span class="line" data-startTime="2172">It could be a photo app. </span> <span class="line" data-startTime="2173">It's usually the skeleton just </span><span class="line" data-startTime="2173">like we did, and then all the </span><span class="line" data-startTime="2176">photos there. </span> <span class="line" data-startTime="2177">I didn't mention it, but the </span><span class="line" data-startTime="2177">app itself is live at that </span><span class="line" data-startTime="2180">URL, and you're more than happy </span><span class="line" data-startTime="2180">to check it when you </span><span class="line" data-startTime="2183">have connection and see </span><span class="line" data-startTime="2183">that it works for you. </span></p>

<p><span class="line" data-startTime="2188">Yes, please. </span></p>

<p class="speaker"><span class="line" data-starttime="2188"><span class="speakerName">Audience</span>: Cool, I maybe have </span><span class="line" data-startTime="2188">two questions for you guys. </span><span class="line" data-startTime="2190">Is endpoints still considered </span><span class="line" data-startTime="2190">experimental? </span></p>

<p class="speaker"><span class="line" data-starttime="2193"><span class="speakerName">Danny Hermes</span>: It's considered </span><span class="line" data-startTime="2193">preview. </span><span class="line" data-startTime="2196">The language around that </span><span class="line" data-startTime="2196">and cloud platform </span><span class="line" data-startTime="2199">has recently changed. </span><span class="line" data-startTime="2201">We have a product manager here </span><span class="line" data-startTime="2201">who could probably talk your </span><span class="line" data-startTime="2203">ear off about it, but I </span><span class="line" data-startTime="2203">know a fair amount. </span><span class="line" data-startTime="2206">So preview essentially is our </span><span class="line" data-startTime="2206">way of saying it's not </span><span class="line" data-startTime="2210">completely general availability </span><span class="line" data-startTime="2210">yet, which is our </span><span class="line" data-startTime="2213">generic term for like no labels </span><span class="line" data-startTime="2213">at all other than just </span><span class="line" data-startTime="2216">use it, right? </span><span class="line" data-startTime="2217">But we're committed to it, we're </span><span class="line" data-startTime="2217">committed to improving </span><span class="line" data-startTime="2219">it, and we're actively working </span><span class="line" data-startTime="2219">on it very quickly. </span></p>

<p class="speaker"><span class="line" data-starttime="2222"><span class="speakerName">Audience</span>: So that's my </span><span class="line" data-startTime="2222">second question. </span><span class="line" data-startTime="2224">I'm the developer at </span><span class="line" data-startTime="2224">the Ferris web </span><span class="line" data-startTime="2226">framework for App Engine. </span><span class="line" data-startTime="2227">And I'm planning on integrating </span><span class="line" data-startTime="2227">Cloud and </span><span class="line" data-startTime="2229">Endpoints with that </span><span class="line" data-startTime="2229">so that Ferris &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="2230"><span class="speakerName">Danny Hermes</span>: Sorry, what </span><span class="line" data-startTime="2230">framework did you say? </span></p>

<p class="speaker"><span class="line" data-starttime="2232"><span class="speakerName">Audience</span>: Ferris. </span><span class="line" data-startTime="2233">Ferris by &mdash; </span></p>

<p class="speaker"><span class="line" data-starttime="2234"><span class="speakerName">Danny Hermes</span>: Ferris, </span><span class="line" data-startTime="2234">like Ferris wheel? </span></p>

<p class="speaker"><span class="line" data-starttime="2235"><span class="speakerName">Audience</span>: Like Ferris Bueller. </span></p>

<p class="speaker"><span class="line" data-starttime="2236"><span class="speakerName">Danny Hermes</span>: OK, </span><span class="line" data-startTime="2236">that works too. </span></p>

<p class="speaker"><span class="line" data-starttime="2238"><span class="speakerName">Audience</span>: Yeah, it's </span><span class="line" data-startTime="2238">to be lazy. </span><span class="line" data-startTime="2239">It's kind of similar to Flask </span><span class="line" data-startTime="2239">and Django in a way, </span><span class="line" data-startTime="2242">specifically for App Engine. </span><span class="line" data-startTime="2244">So we're planning on integrating </span><span class="line" data-startTime="2244">Cloud Endpoints </span><span class="line" data-startTime="2246">into Ferris so you can share the </span><span class="line" data-startTime="2246">same code between the two. </span><span class="line" data-startTime="2250">So the big question there is, </span><span class="line" data-startTime="2250">how much more is the API going </span><span class="line" data-startTime="2253">to change from this point. </span></p>

<p class="speaker"><span class="line" data-starttime="2256"><span class="speakerName">Danny Hermes</span>: Yeah, I can't </span><span class="line" data-startTime="2256">answer a question like that. </span></p>

<p class="speaker"><span class="line" data-starttime="2257"><span class="speakerName">Audience</span>: You can't answer </span><span class="line" data-startTime="2257">a question like that. </span><span class="line" data-startTime="2260">OK, cool. </span><span class="line" data-startTime="2261">Yeah, so I was just wondering </span><span class="line" data-startTime="2261">how much we could expect &mdash; </span><span class="line" data-startTime="2264">new features is great, but I </span><span class="line" data-startTime="2264">mean like just kind of the </span><span class="line" data-startTime="2266">core, is the core kind of </span><span class="line" data-startTime="2266">solid, do you guys feel? </span></p>

<p class="speaker"><span class="line" data-starttime="2269"><span class="speakerName">Danny Hermes</span>: So Cloud Endpoints </span><span class="line" data-startTime="2269">is actually more </span><span class="line" data-startTime="2271">than just an App Engine feature </span><span class="line" data-startTime="2271">because it uses a </span><span class="line" data-startTime="2274">shared infrastructure that all </span><span class="line" data-startTime="2274">of Google's APIs use as well. </span><span class="line" data-startTime="2278">And so there's a fair amount </span><span class="line" data-startTime="2278">of discovery itself is a </span><span class="line" data-startTime="2281">specification, and there's also </span><span class="line" data-startTime="2281">a back end configuration, </span><span class="line" data-startTime="2283">which allows us to register with </span><span class="line" data-startTime="2283">that shared API service </span><span class="line" data-startTime="2287">and say this is what I look </span><span class="line" data-startTime="2287">like, this is the kind of </span><span class="line" data-startTime="2290">things that I want you to send </span><span class="line" data-startTime="2290">me, this is the kind of things </span><span class="line" data-startTime="2291">that I'll give back </span><span class="line" data-startTime="2291">to you, and other </span><span class="line" data-startTime="2293">related things like auth. </span><span class="line" data-startTime="2296">So this is an active </span><span class="line" data-startTime="2296">conversation </span><span class="line" data-startTime="2297">which we have a lot. </span><span class="line" data-startTime="2299">So I I'm happy to talk more </span><span class="line" data-startTime="2299">about it after, but. </span></p>

<p class="speaker"><span class="line" data-starttime="2303"><span class="speakerName">Audience</span>: Thanks. </span><span class="line" data-startTime="2303">It's great so far. </span><span class="line" data-startTime="2304">ProtoRPC and everything </span><span class="line" data-startTime="2304">involved in that </span><span class="line" data-startTime="2306">looks great so far. </span><span class="line" data-startTime="2307">Thank you, guys. </span></p>

<p class="speaker"><span class="line" data-starttime="2307"><span class="speakerName">Danny Hermes</span>: OK, cool. </span></p>

<p class="speaker"><span class="line" data-starttime="2315"><span class="speakerName">Ido Green</span>: OK, thank </span><span class="line" data-startTime="2315">you very much. </span><span class="line" data-startTime="2317">Bye bye. </span><span class="line" data-startTime="2318">[APPLAUSE] </span></p></div>