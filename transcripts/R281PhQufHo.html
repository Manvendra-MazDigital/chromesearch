<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>GDC 2012: Porting your game to NaCl</h1>

<h2>Colt McAnlis</h2>

<a class="video" href="http://youtu.be/R281PhQufHo">youtu.be/R281PhQufHo</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="5"><span class="speakerName">Colt McAnlis</span>: Hey, everybody. </span> <span class="line" data-startTime="5">Thanks for coming. </span> <span class="line" data-startTime="6">My name is Colt McAnlis. </span> <span class="line" data-startTime="7">And I'm a developer advocate at </span><span class="line" data-startTime="7">Google focusing on Native </span><span class="line" data-startTime="10">Client and gaming. </span> <span class="line" data-startTime="12">And what we're going to </span><span class="line" data-startTime="12">talk about today is </span><span class="line" data-startTime="13">getting your port on. </span> <span class="line" data-startTime="14">Specifically, porting your </span><span class="line" data-startTime="14">game to Native Client </span><span class="line" data-startTime="17">as of Pepper 18. </span> <span class="line" data-startTime="19">So a quick show of hands, </span><span class="line" data-startTime="19">who's already </span><span class="line" data-startTime="21">touched Native Client? </span><span class="line" data-startTime="22">Have you compiled the </span><span class="line" data-startTime="22">application before? </span><span class="line" data-startTime="24">OK. </span> <span class="line" data-startTime="25">Cool. </span> <span class="line" data-startTime="25">Put your hands down. </span> <span class="line" data-startTime="26">For those you, how many people </span><span class="line" data-startTime="26">have no idea what </span><span class="line" data-startTime="28">Native Client is? </span><span class="line" data-startTime="29">Or they've heard about it and </span><span class="line" data-startTime="29">want to learn more, and that's </span><span class="line" data-startTime="31">why you're here? </span><span class="line" data-startTime="32">OK. </span> <span class="line" data-startTime="32">Cool. </span></p>

<p><span class="line" data-startTime="33">That's good. </span> <span class="line" data-startTime="33">That allows me to kind </span><span class="line" data-startTime="33">of gauge how </span><span class="line" data-startTime="35">deep I dive into stuff. </span> <span class="line" data-startTime="36">So Pepper 18 is the active SDK </span><span class="line" data-startTime="36">build, as of right now. </span> <span class="line" data-startTime="41">If you go to gonacl.com, you'll </span><span class="line" data-startTime="41">be able to get our SDK </span><span class="line" data-startTime="45">and see all the documentation </span><span class="line" data-startTime="45">that we're talking about </span><span class="line" data-startTime="46">today, as well as some other </span><span class="line" data-startTime="46">amazing opportunities there. </span> <span class="line" data-startTime="51">So let's get started. </span> <span class="line" data-startTime="53">So it works. </span> <span class="line" data-startTime="54">Native Client allows </span><span class="line" data-startTime="54">you to run C and C </span><span class="line" data-startTime="57">code in a web page. </span> <span class="line" data-startTime="58">Now this has been around </span><span class="line" data-startTime="58">as a feature set </span><span class="line" data-startTime="59">for a long time now. </span> <span class="line" data-startTime="61">But the most important thing, </span><span class="line" data-startTime="61">and probably the coolest one </span><span class="line" data-startTime="63">about Native Client, is that </span><span class="line" data-startTime="63">no plug-in is required. </span> <span class="line" data-startTime="66">Now this is the kicker, right? </span><span class="line" data-startTime="68">I've got some statistical </span><span class="line" data-startTime="68">information sitting in a vault </span><span class="line" data-startTime="71">somewhere that shows that, for </span><span class="line" data-startTime="71">some games, they lose up to </span><span class="line" data-startTime="73">90% of the users that wanted </span><span class="line" data-startTime="73">to play the game as soon as </span><span class="line" data-startTime="77">they are prompted to </span><span class="line" data-startTime="77">install a plug-in. </span></p>

<p><span class="line" data-startTime="79">90%. </span> <span class="line" data-startTime="80">Now if you're an indie in this </span><span class="line" data-startTime="80">crowd, and you've got a </span><span class="line" data-startTime="83">mortgage and a wife and a </span><span class="line" data-startTime="83">mother-in-law who thinks </span><span class="line" data-startTime="85">you're a bum because you're </span><span class="line" data-startTime="85">a game developer and not a </span><span class="line" data-startTime="88">stockbroker, or something, 90% </span><span class="line" data-startTime="88">of those developers wanted to </span><span class="line" data-startTime="91">give you money. </span> <span class="line" data-startTime="92">And they couldn't because </span><span class="line" data-startTime="92">you asked them </span><span class="line" data-startTime="93">to install a plug-in. </span> <span class="line" data-startTime="94">So the goal here is </span><span class="line" data-startTime="94">if no plug-in is </span><span class="line" data-startTime="96">required, that's fantastic. </span> <span class="line" data-startTime="98">And if you're one of the </span><span class="line" data-startTime="98">programmers who has worked in </span><span class="line" data-startTime="101">the games industry for the past </span><span class="line" data-startTime="101">30 years, chances are </span><span class="line" data-startTime="103">you've got 30 years of C code </span><span class="line" data-startTime="103">sitting around and 30 years of </span><span class="line" data-startTime="107">experience in C code sitting </span><span class="line" data-startTime="107">around that can now migrate to </span><span class="line" data-startTime="111">the web, which is </span><span class="line" data-startTime="111">amazing, right? </span><span class="line" data-startTime="113">Developers spend billions of </span><span class="line" data-startTime="113">dollars cultivating this </span><span class="line" data-startTime="115">technology. </span></p>

<p><span class="line" data-startTime="116">And to get to the web right </span><span class="line" data-startTime="116">now, they have to throw it </span><span class="line" data-startTime="118">away and rewrite it in some </span><span class="line" data-startTime="118">other scripting language. </span> <span class="line" data-startTime="120">But if you can use the direct </span><span class="line" data-startTime="120">code, this is fantastic. </span> <span class="line" data-startTime="123">It allows you to leverage your </span><span class="line" data-startTime="123">existing technology to move </span><span class="line" data-startTime="125">into this new marketplace. </span> <span class="line" data-startTime="128">So here's the gist. It all </span><span class="line" data-startTime="128">starts with your C code. </span> <span class="line" data-startTime="132">Native Client provides, in the </span><span class="line" data-startTime="132">SDK, a version of a GCC and a </span><span class="line" data-startTime="135">G compiler that produces safe, </span><span class="line" data-startTime="135">portable x86 code. </span> <span class="line" data-startTime="140">This is provided in the </span><span class="line" data-startTime="140">form of NEXEs, or </span><span class="line" data-startTime="142">Native Client exe. </span> <span class="line" data-startTime="144">In addition to this, we'll </span><span class="line" data-startTime="144">produce one for 32-bit and </span><span class="line" data-startTime="146">64-bit architectures, as well </span><span class="line" data-startTime="146">as an NMF file, or a Native </span><span class="line" data-startTime="150">Client manifest file. </span></p>

<p><span class="line" data-startTime="152">The manifest effectively lists </span><span class="line" data-startTime="152">which architecture goes to </span><span class="line" data-startTime="155">what file path for </span><span class="line" data-startTime="155">what executable. </span> <span class="line" data-startTime="158">So it says if you're running </span><span class="line" data-startTime="158">a 32-bit, point to this </span><span class="line" data-startTime="160">executable. </span> <span class="line" data-startTime="160">If you're running 64-bit, </span><span class="line" data-startTime="160">run to that executable. </span> <span class="line" data-startTime="163">You embed this information in an </span><span class="line" data-startTime="163">HTML file using this small, </span><span class="line" data-startTime="167">little tag right here. </span> <span class="line" data-startTime="168">So you make an embed element. </span> <span class="line" data-startTime="169">You name it. </span> <span class="line" data-startTime="170">You give it a height. </span> <span class="line" data-startTime="170">You define your manifest. </span> <span class="line" data-startTime="170">You point to the </span><span class="line" data-startTime="173">manifest, not to the NEXEs. </span> <span class="line" data-startTime="174">Because, remember, the </span><span class="line" data-startTime="174">manifest defines </span><span class="line" data-startTime="176">what NEXE to use. </span></p>

<p><span class="line" data-startTime="177">And then you set an application </span><span class="line" data-startTime="177">type right there. </span> <span class="line" data-startTime="179">Once you do this, you've gone </span><span class="line" data-startTime="179">through this process. </span> <span class="line" data-startTime="181">You've compiled it. </span> <span class="line" data-startTime="182">You've embedded it in a page. </span> <span class="line" data-startTime="184">And then you load the </span><span class="line" data-startTime="184">page up and boom! </span><span class="line" data-startTime="185">You see some amazing graphics on </span><span class="line" data-startTime="185">the screen, stuff that you </span><span class="line" data-startTime="189">traditionally don't </span><span class="line" data-startTime="189">see in a web game. </span> <span class="line" data-startTime="190">This is actually a screen shot </span><span class="line" data-startTime="190">from an Xbox 360 title running </span><span class="line" data-startTime="194">in Native Client that was ported </span><span class="line" data-startTime="194">in about three months. </span> <span class="line" data-startTime="197">That's amazing technology to see </span><span class="line" data-startTime="197">post processing and full </span><span class="line" data-startTime="200">screen blend and skin animation </span><span class="line" data-startTime="200">and color tint and </span><span class="line" data-startTime="203">all this just great stuff </span><span class="line" data-startTime="203">there that you </span><span class="line" data-startTime="205">have access to now. </span></p>

<p><span class="line" data-startTime="207">So let's talk about the </span><span class="line" data-startTime="207">first steps, your </span><span class="line" data-startTime="208">GCC and your G compiler. </span> <span class="line" data-startTime="211">So to use these &mdash; if anyone </span><span class="line" data-startTime="211">here is a Linux developer, </span><span class="line" data-startTime="214">then you're very intimately </span><span class="line" data-startTime="214">familiar with GCC and G If </span><span class="line" data-startTime="217">you're a Windows developer, </span><span class="line" data-startTime="217">this is kind of new ground </span><span class="line" data-startTime="219">that's kind of awkward and </span><span class="line" data-startTime="219">uncomfortable for you. </span> <span class="line" data-startTime="222">But first off, to get your code </span><span class="line" data-startTime="222">compiling in GCC and G , </span><span class="line" data-startTime="225">you have to make sure that it's </span><span class="line" data-startTime="225">ISO and IEC complaint, </span><span class="line" data-startTime="228">which effectively means that it </span><span class="line" data-startTime="228">matches these protocols and </span><span class="line" data-startTime="230">these standards. </span> <span class="line" data-startTime="231">Now it's probably not best to go </span><span class="line" data-startTime="231">look at these standards and </span><span class="line" data-startTime="234">figure out the mapping. </span> <span class="line" data-startTime="235">It's probably actually best to </span><span class="line" data-startTime="235">try to compile your code in </span><span class="line" data-startTime="237">GCC, figure out what it </span><span class="line" data-startTime="237">complains about, and then </span><span class="line" data-startTime="240">iterate that way. </span> <span class="line" data-startTime="242">Predominately, this standard </span><span class="line" data-startTime="242">defines POSIX style coding and </span><span class="line" data-startTime="245">functioning. </span></p>

<p><span class="line" data-startTime="246">So it uses syntaxes like p </span><span class="line" data-startTime="246">threads as opposed to begin </span><span class="line" data-startTime="249">and end thread, as well as </span><span class="line" data-startTime="249">conditional variables rather </span><span class="line" data-startTime="252">than retexes and other </span><span class="line" data-startTime="252">things like that. </span> <span class="line" data-startTime="254">In addition, this compliance </span><span class="line" data-startTime="254">standard &mdash; and this is the </span><span class="line" data-startTime="256">important one &mdash; </span><span class="line" data-startTime="257">does not define any </span><span class="line" data-startTime="257">OS specific calls. </span> <span class="line" data-startTime="260">So you can't access the </span><span class="line" data-startTime="260">registry from GCC. </span> <span class="line" data-startTime="264">That doesn't make sense. </span> <span class="line" data-startTime="265">You can't open up a direct </span><span class="line" data-startTime="265">video stream </span><span class="line" data-startTime="268">using direct media. </span> <span class="line" data-startTime="269">That doesn't make sense </span><span class="line" data-startTime="269">either, right? </span><span class="line" data-startTime="270">So you need to make sure that </span><span class="line" data-startTime="270">your code is platform </span><span class="line" data-startTime="272">independent and uses these </span><span class="line" data-startTime="272">POSIX-style calls. </span> <span class="line" data-startTime="276">The GCC and G compilers also </span><span class="line" data-startTime="276">do the amazing thing &mdash; and </span><span class="line" data-startTime="279">this is sort of the linchpin &mdash; </span><span class="line" data-startTime="281">it removes any unsafe code. </span> <span class="line" data-startTime="283">This is the whole point </span><span class="line" data-startTime="283">of Native Client. </span></p>

<p><span class="line" data-startTime="285">The whole point is to execute </span><span class="line" data-startTime="285">safe, portable assembly </span><span class="line" data-startTime="289">language code in </span><span class="line" data-startTime="289">a web browser. </span> <span class="line" data-startTime="291">Security is of the utmost </span><span class="line" data-startTime="291">importance here, more than </span><span class="line" data-startTime="294">performance, more than </span><span class="line" data-startTime="294">anything else. </span> <span class="line" data-startTime="295">Although we are amazingly </span><span class="line" data-startTime="295">performant. </span> <span class="line" data-startTime="297">And I can give you those numbers </span><span class="line" data-startTime="297">offline, if you're </span><span class="line" data-startTime="299">looking for it. </span> <span class="line" data-startTime="300">But it removes all this unsafe </span><span class="line" data-startTime="300">stuff and creates this nice </span><span class="line" data-startTime="303">little package that can run, </span><span class="line" data-startTime="303">execute, in multiple places. </span> <span class="line" data-startTime="308">And so once you get this code &mdash; </span><span class="line" data-startTime="308">and you're saying, OK, </span><span class="line" data-startTime="311">this is cool. </span></p>

<p><span class="line" data-startTime="312">I have the ability to </span><span class="line" data-startTime="312">execute this code &mdash; </span><span class="line" data-startTime="313">how does it actually interact </span><span class="line" data-startTime="313">with the system? </span><span class="line" data-startTime="316">So to understand how Native </span><span class="line" data-startTime="316">Client gets access to these </span><span class="line" data-startTime="318">system-level resources, I have </span><span class="line" data-startTime="318">to take a step back, and </span><span class="line" data-startTime="321">actually talk about how Chrome, </span><span class="line" data-startTime="321">the web browser, gets </span><span class="line" data-startTime="324">access to these system-level </span><span class="line" data-startTime="324">resources. </span> <span class="line" data-startTime="326">So a long time ago, a company </span><span class="line" data-startTime="326">made a plug-in architecture </span><span class="line" data-startTime="329">called NPAPI. </span> <span class="line" data-startTime="332">Effectively, this plug-in </span><span class="line" data-startTime="332">architecture allowed plug-ins </span><span class="line" data-startTime="335">to be developed for a browser </span><span class="line" data-startTime="335">that then had access to lower </span><span class="line" data-startTime="338">level systems in various </span><span class="line" data-startTime="338">ways, so that users </span><span class="line" data-startTime="340">can install the plug-in. </span> <span class="line" data-startTime="341">And if the plug-in dll targeted </span><span class="line" data-startTime="341">these header files, </span><span class="line" data-startTime="343">it had access to these things. </span></p>

<p><span class="line" data-startTime="345">Well, the problem was that </span><span class="line" data-startTime="345">at its heyday, this NPAPI </span><span class="line" data-startTime="349">architecture was actually the </span><span class="line" data-startTime="349">number one problem of malware </span><span class="line" data-startTime="352">and bugs in the environment. </span> <span class="line" data-startTime="354">So Chrome went ahead and said, </span><span class="line" data-startTime="354">we're going to support NPAPI. </span> <span class="line" data-startTime="357">But we want to create a safer </span><span class="line" data-startTime="357">version, so that we don't have </span><span class="line" data-startTime="359">to worry about all these </span><span class="line" data-startTime="359">pop-ups, and </span><span class="line" data-startTime="361">spyware, and malware. </span> <span class="line" data-startTime="362">So we created what we call the </span><span class="line" data-startTime="362">Pepper API, or PPAPI, which is </span><span class="line" data-startTime="366">a plug-in architecture that </span><span class="line" data-startTime="366">allows you to target file IO, </span><span class="line" data-startTime="370">rendering, audio, and even </span><span class="line" data-startTime="370">have the ability to </span><span class="line" data-startTime="372">communicate back to the page </span><span class="line" data-startTime="372">that's hosting the plug-in </span><span class="line" data-startTime="375">through JavaScript post </span><span class="line" data-startTime="375">message results. </span> <span class="line" data-startTime="378">So understanding this, that </span><span class="line" data-startTime="378">there's effectively a Pepper </span><span class="line" data-startTime="380">API that allows plug-ins to </span><span class="line" data-startTime="380">access these inner workings </span><span class="line" data-startTime="384">through Chrome, Native Client </span><span class="line" data-startTime="384">is effectively a module that </span><span class="line" data-startTime="388">communicates with this. </span> <span class="line" data-startTime="389">So your NEXE file, when you </span><span class="line" data-startTime="389">compile it, you'll target </span><span class="line" data-startTime="392">these specific headers to do </span><span class="line" data-startTime="392">things like file IO, audio, </span><span class="line" data-startTime="394">rendering, and JavaScript. </span></p>

<p><span class="line" data-startTime="396">This is how your program gets </span><span class="line" data-startTime="396">access to the lower level </span><span class="line" data-startTime="398">architecture. </span> <span class="line" data-startTime="400">Now it's worth noting this, too, </span><span class="line" data-startTime="400">is that the Pepper thread </span><span class="line" data-startTime="403">is actually running on the </span><span class="line" data-startTime="403">main thread of Chrome. </span> <span class="line" data-startTime="406">So your Native Client module is </span><span class="line" data-startTime="407">sitting there doing execution. </span> <span class="line" data-startTime="409">Also on this main thread, </span><span class="line" data-startTime="409">though, are some other </span><span class="line" data-startTime="411">important buddies that you </span><span class="line" data-startTime="411">need to be aware of. </span> <span class="line" data-startTime="413">First off is WebKit. </span> <span class="line" data-startTime="414">WebKit executes on </span><span class="line" data-startTime="414">the same thread. </span></p>

<p><span class="line" data-startTime="416">This is the layout </span><span class="line" data-startTime="416">organizational DOM rendering </span><span class="line" data-startTime="418">style engine. </span> <span class="line" data-startTime="419">It is out there open source. </span> <span class="line" data-startTime="420">Also V8, which is Chrome's </span><span class="line" data-startTime="420">virtual machine for handling </span><span class="line" data-startTime="424">JavaScript, as well as some </span><span class="line" data-startTime="424">other fun stuff like Web RTC, </span><span class="line" data-startTime="427">audio processing, video, and </span><span class="line" data-startTime="427">all this other stuff. </span> <span class="line" data-startTime="429">The important takeaway you </span><span class="line" data-startTime="429">should see here is that your </span><span class="line" data-startTime="432">Native Client module has the </span><span class="line" data-startTime="432">ability to effectively stall </span><span class="line" data-startTime="435">out this main thread not </span><span class="line" data-startTime="435">doing correctly. </span> <span class="line" data-startTime="437">So if you go in and put a spin </span><span class="line" data-startTime="437">loop on your main thread, </span><span class="line" data-startTime="441">you're effectively going to </span><span class="line" data-startTime="441">halt the entire web page, </span><span class="line" data-startTime="443">because the WebKit doesn't get </span><span class="line" data-startTime="443">the input processing, and V8 </span><span class="line" data-startTime="446">doesn't get JavaScript </span><span class="line" data-startTime="446">processing. </span> <span class="line" data-startTime="447">So it's going to stall the tab </span><span class="line" data-startTime="447">and effectively crash out. </span></p>

<p><span class="line" data-startTime="450">Because of this, you're not </span><span class="line" data-startTime="450">supposed to call any blocking </span><span class="line" data-startTime="454">functions on the main thread. </span> <span class="line" data-startTime="455">This is a bad idea, so none of </span><span class="line" data-startTime="455">your code should be calling </span><span class="line" data-startTime="458">blocking functions on </span><span class="line" data-startTime="458">the main thread. </span> <span class="line" data-startTime="460">And because of that, the </span><span class="line" data-startTime="460">Pepper API's are all </span><span class="line" data-startTime="463">asynchronous. </span> <span class="line" data-startTime="465">None of them are blocking </span><span class="line" data-startTime="465">at all. </span> <span class="line" data-startTime="467">This means that you can call the </span><span class="line" data-startTime="467">Pepper API from the main </span><span class="line" data-startTime="470">thread, and then some </span><span class="line" data-startTime="470">time in the future </span><span class="line" data-startTime="471">you'll get that result. </span> <span class="line" data-startTime="473">Generally, that's </span><span class="line" data-startTime="473">about one frame. </span> <span class="line" data-startTime="475">So if you looked at that </span><span class="line" data-startTime="475">previous diagram, you can see </span><span class="line" data-startTime="477">that we've got WebKit, we've </span><span class="line" data-startTime="477">got V8, and then we've got </span><span class="line" data-startTime="479">NaCl and some other stuff. </span> <span class="line" data-startTime="480">So if NaCl says, hey, I want </span><span class="line" data-startTime="480">to go load this file, it's </span><span class="line" data-startTime="483">going to kick off a request. And </span><span class="line" data-startTime="483">then we have to generally </span><span class="line" data-startTime="485">wait until WebKit, V8 gets </span><span class="line" data-startTime="485">processed and the plug-in </span><span class="line" data-startTime="487">frame gets processed before </span><span class="line" data-startTime="487">those results can be given </span><span class="line" data-startTime="490">back to the main thread of your </span><span class="line" data-startTime="490">Native Client module. </span></p>

<p><span class="line" data-startTime="495">Also, one of the restrictions </span><span class="line" data-startTime="495">of Pepper is that all the </span><span class="line" data-startTime="498">Pepper API's must be called </span><span class="line" data-startTime="498">from the main </span><span class="line" data-startTime="500">thread right now. </span> <span class="line" data-startTime="501">This is a current restriction </span><span class="line" data-startTime="501">that our team is actively </span><span class="line" data-startTime="503">working on to fix. </span> <span class="line" data-startTime="505">But this has some potential </span><span class="line" data-startTime="505">downsides that you </span><span class="line" data-startTime="507">need to be aware of. </span> <span class="line" data-startTime="509">Before we dive into </span><span class="line" data-startTime="509">that, let's talk </span><span class="line" data-startTime="511">about how this works. </span> <span class="line" data-startTime="512">So on the top here we've got a </span><span class="line" data-startTime="512">function that shows how to do </span><span class="line" data-startTime="515">file layout. </span> <span class="line" data-startTime="516">So we've got a function. </span></p>

<p><span class="line" data-startTime="517">We're asserting that this is </span><span class="line" data-startTime="517">coming from the main thread. </span> <span class="line" data-startTime="519">We get some information </span><span class="line" data-startTime="519">from the user. </span> <span class="line" data-startTime="521">And we actually call </span><span class="line" data-startTime="521">FileIO.Open. </span> <span class="line" data-startTime="523">With FileIO.Open you actually </span><span class="line" data-startTime="523">provide a completion callback. </span> <span class="line" data-startTime="526">The completion callback will </span><span class="line" data-startTime="526">occur once this file open </span><span class="line" data-startTime="529">request has occurred at the </span><span class="line" data-startTime="529">lower level, the Pepper API </span><span class="line" data-startTime="532">level, and the results of that </span><span class="line" data-startTime="532">will be pushed back to you. </span> <span class="line" data-startTime="535">That's the second function </span><span class="line" data-startTime="535">here you can see </span><span class="line" data-startTime="536">open, f open callback. </span> <span class="line" data-startTime="539">This will get called on your </span><span class="line" data-startTime="539">main thread once everything </span><span class="line" data-startTime="541">has been done in the lower </span><span class="line" data-startTime="541">bowels of Chrome and the </span><span class="line" data-startTime="545">Pepper API's. </span> <span class="line" data-startTime="546">And then you can, yay, </span><span class="line" data-startTime="546">do some stuff. </span> <span class="line" data-startTime="547">Show a cat. </span> <span class="line" data-startTime="548">Issue a read. </span> <span class="line" data-startTime="549">Whatever you need to </span><span class="line" data-startTime="549">do at that point. </span> <span class="line" data-startTime="551">So this is sort of a problem. </span> <span class="line" data-startTime="553">Because this works in a very </span><span class="line" data-startTime="553">different way than all of your </span><span class="line" data-startTime="556">architectures. </span> <span class="line" data-startTime="558">This is not how your game </span><span class="line" data-startTime="558">engine is designed. </span></p>

<p><span class="line" data-startTime="560">I can guarantee this </span><span class="line" data-startTime="560">is not how your </span><span class="line" data-startTime="561">game engine is designed. </span> <span class="line" data-startTime="562">Even if you have asynchronous </span><span class="line" data-startTime="562">loading in your game, sooner </span><span class="line" data-startTime="565">or later you're going </span><span class="line" data-startTime="565">to expect f read </span><span class="line" data-startTime="567">as a blocking function. </span> <span class="line" data-startTime="568">You've got everything </span><span class="line" data-startTime="568">working around that. </span> <span class="line" data-startTime="569">More importantly, you probably </span><span class="line" data-startTime="569">have f read calls coming from </span><span class="line" data-startTime="572">the main thread, which, in </span><span class="line" data-startTime="572">general, is a problem. </span> <span class="line" data-startTime="575">So the point next is how do </span><span class="line" data-startTime="575">you design around this? </span><span class="line" data-startTime="580">How do you beat this? </span><span class="line" data-startTime="581">How do you say &mdash; </span><span class="line" data-startTime="582">how do I touch my code? </span><span class="line" data-startTime="583">Well, one idea is to modify </span><span class="line" data-startTime="583">all of your f reads to use </span><span class="line" data-startTime="587">this blocking callback system. </span> <span class="line" data-startTime="589">Or how do you do these </span><span class="line" data-startTime="589">other things? </span><span class="line" data-startTime="590">Make sure the thread </span><span class="line" data-startTime="590">doesn't stall. </span> <span class="line" data-startTime="591">Forget all that. </span></p>

<p><span class="line" data-startTime="592">I'm going to give you the </span><span class="line" data-startTime="592">shortcut I'm going to drop </span><span class="line" data-startTime="594">some wisdom on you. </span> <span class="line" data-startTime="595">I'm going to point my knowledge </span><span class="line" data-startTime="595">cannon in your </span><span class="line" data-startTime="597">direction, and give you </span><span class="line" data-startTime="597">a blast of info. </span> <span class="line" data-startTime="599">The best idea is to actually </span><span class="line" data-startTime="599">spin up a thread and run your </span><span class="line" data-startTime="602">main game logic on </span><span class="line" data-startTime="602">that thread. </span> <span class="line" data-startTime="605">And leave the original main </span><span class="line" data-startTime="605">thread as the Pepper thread. </span> <span class="line" data-startTime="609">Basically, what this allows you </span><span class="line" data-startTime="609">to do is you wrap all of </span><span class="line" data-startTime="612">your platform functions to issue </span><span class="line" data-startTime="612">communication back and </span><span class="line" data-startTime="615">forth to the main thread. </span></p>

<p><span class="line" data-startTime="617">Let's take a look at what </span><span class="line" data-startTime="617">that looks like here. </span> <span class="line" data-startTime="619">So your game has the Pepper </span><span class="line" data-startTime="619">thread or the main thread. </span> <span class="line" data-startTime="621">That spawns off your </span><span class="line" data-startTime="621">logic thread. </span> <span class="line" data-startTime="623">Now the logic thread is </span><span class="line" data-startTime="623">effectively going to run the </span><span class="line" data-startTime="626">main loop, while true &mdash; </span><span class="line" data-startTime="628">update, render, network, update, </span><span class="line" data-startTime="628">network, render. </span> <span class="line" data-startTime="632">Do all that stuff. </span> <span class="line" data-startTime="633">And it's going to just continue </span><span class="line" data-startTime="633">doing that on the </span><span class="line" data-startTime="634">logic thread. </span> <span class="line" data-startTime="635">The Pepper thread is the </span><span class="line" data-startTime="635">only access to FileIO, </span><span class="line" data-startTime="638">JavaScript, and audio. </span> <span class="line" data-startTime="639">Your logic thread should not </span><span class="line" data-startTime="639">have direct access to that. </span> <span class="line" data-startTime="642">Instead, the logic thread will </span><span class="line" data-startTime="642">call specific commands, which </span><span class="line" data-startTime="644">pushes a function to the </span><span class="line" data-startTime="644">Pepper thread and </span><span class="line" data-startTime="647">then it will block. </span></p>

<p><span class="line" data-startTime="648">The Pepper thread will then </span><span class="line" data-startTime="648">receive that function, </span><span class="line" data-startTime="651">communicate off to the lower </span><span class="line" data-startTime="651">level IO, do its fun stuff, </span><span class="line" data-startTime="654">return that data to the Pepper </span><span class="line" data-startTime="654">thread, and the Pepper thread </span><span class="line" data-startTime="658">will then return that </span><span class="line" data-startTime="658">data to your logic </span><span class="line" data-startTime="660">thread in the fashion. </span> <span class="line" data-startTime="661">What this means is that you can </span><span class="line" data-startTime="661">overload f read, f write, </span><span class="line" data-startTime="665">blocking functions like that, </span><span class="line" data-startTime="665">to effectively do the same </span><span class="line" data-startTime="668">thing that you would </span><span class="line" data-startTime="668">expect them to </span><span class="line" data-startTime="669">already do in your game. </span> <span class="line" data-startTime="670">You just effectively create this </span><span class="line" data-startTime="670">abstraction layer around </span><span class="line" data-startTime="673">them, so that it actually </span><span class="line" data-startTime="673">communicates with the Pepper </span><span class="line" data-startTime="675">thread in a proper manner </span><span class="line" data-startTime="675">without actually having to </span><span class="line" data-startTime="678">touch all the lines </span><span class="line" data-startTime="678">of code that </span><span class="line" data-startTime="679">you've already got written. </span> <span class="line" data-startTime="681">Here's an example of how </span><span class="line" data-startTime="681">to look at this. </span></p>

<p><span class="line" data-startTime="683">So this top function here </span><span class="line" data-startTime="683">is request and wait. </span> <span class="line" data-startTime="686">So what this will do is assert </span><span class="line" data-startTime="686">that, first off, you're not </span><span class="line" data-startTime="688">running on the main thread. </span> <span class="line" data-startTime="688">You're running on </span><span class="line" data-startTime="688">a worker thread. </span> <span class="line" data-startTime="690">And Native Client and Pepper </span><span class="line" data-startTime="690">actually provide a nice little </span><span class="line" data-startTime="693">API that will auto call your </span><span class="line" data-startTime="693">function on the main thread on </span><span class="line" data-startTime="697">your behalf, so that you don't </span><span class="line" data-startTime="697">have to write all the </span><span class="line" data-startTime="699">intricate threading, and </span><span class="line" data-startTime="699">messaging, and queuing logic </span><span class="line" data-startTime="702">to get it to call there. </span> <span class="line" data-startTime="703">So simply, you call </span><span class="line" data-startTime="703">module.get.core. </span> <span class="line" data-startTime="706">Call on main thread. </span> <span class="line" data-startTime="707">And you effectively pass </span><span class="line" data-startTime="707">it a callback function. </span> <span class="line" data-startTime="710">And this will ensure that your </span><span class="line" data-startTime="710">callback function will get </span><span class="line" data-startTime="713">pushed into the proper queues. </span> <span class="line" data-startTime="715">And it will be called in the </span><span class="line" data-startTime="715">main thread the next time a </span><span class="line" data-startTime="716">frame process happens. </span></p>

<p><span class="line" data-startTime="718">Now what's nice about this is </span><span class="line" data-startTime="718">that this allows you, on the </span><span class="line" data-startTime="720">calling thread, to then set a </span><span class="line" data-startTime="720">conditional data variable and </span><span class="line" data-startTime="723">sit around and wait. </span> <span class="line" data-startTime="724">So with this function here, you </span><span class="line" data-startTime="724">actually issue a function </span><span class="line" data-startTime="727">command, wait until it has been </span><span class="line" data-startTime="727">called and executed on </span><span class="line" data-startTime="730">the main thread and control </span><span class="line" data-startTime="730">has been returned. </span> <span class="line" data-startTime="732">And you can see on the bottom </span><span class="line" data-startTime="732">here, this is the return from </span><span class="line" data-startTime="734">main thread function. </span> <span class="line" data-startTime="736">Effectively what this does is, </span><span class="line" data-startTime="736">first off, asserts that you're </span><span class="line" data-startTime="739">on the main thread, because </span><span class="line" data-startTime="739">you want to make sure your </span><span class="line" data-startTime="740">code's clean. </span> <span class="line" data-startTime="741">You want to make sure you're </span><span class="line" data-startTime="741">doing the right thing. </span> <span class="line" data-startTime="742">And then it will actually get </span><span class="line" data-startTime="742">the information that has been </span><span class="line" data-startTime="744">passed to it as a callback </span><span class="line" data-startTime="744">parameter, set some result, </span><span class="line" data-startTime="746">and then signal the conditional </span><span class="line" data-startTime="746">signal. </span></p>

<p><span class="line" data-startTime="749">That signal right there, that </span><span class="line" data-startTime="749">event, that p thread </span><span class="line" data-startTime="751">conditional, will allow the </span><span class="line" data-startTime="751">worker thread, the logic </span><span class="line" data-startTime="754">thread, that actually issued the </span><span class="line" data-startTime="754">command to then wake up, </span><span class="line" data-startTime="757">continue doing what it was </span><span class="line" data-startTime="757">doing, and move on. </span> <span class="line" data-startTime="758">This is fantastic. </span> <span class="line" data-startTime="759">With these two little functions </span><span class="line" data-startTime="759">right here, you can </span><span class="line" data-startTime="761">implement a structure around it </span><span class="line" data-startTime="761">that allow you to overload </span><span class="line" data-startTime="764">f read and f write and those </span><span class="line" data-startTime="764">other functions to be blocking </span><span class="line" data-startTime="767">functions from the </span><span class="line" data-startTime="767">logic thread. </span> <span class="line" data-startTime="770">So this is effectively </span><span class="line" data-startTime="770">what happens. </span> <span class="line" data-startTime="771">You end up in a situation where </span><span class="line" data-startTime="771">you start calling data. </span></p>

<p><span class="line" data-startTime="774">It blocks. </span> <span class="line" data-startTime="774">Comes back. </span> <span class="line" data-startTime="775">Calls data, blocks, </span><span class="line" data-startTime="775">comes back. </span> <span class="line" data-startTime="776">And this is fine for a lot of </span><span class="line" data-startTime="776">functions that you expect to </span><span class="line" data-startTime="779">work this way. </span> <span class="line" data-startTime="780">Your architecture will </span><span class="line" data-startTime="780">transition over seamlessly. </span> <span class="line" data-startTime="782">And you won't have to </span><span class="line" data-startTime="782">worry about it. </span> <span class="line" data-startTime="784">The problem turns into function </span><span class="line" data-startTime="784">APIs that don't </span><span class="line" data-startTime="788">benefit from working </span><span class="line" data-startTime="788">in this fashion. </span> <span class="line" data-startTime="790">For example, rendering. </span> <span class="line" data-startTime="791">Rendering works very </span><span class="line" data-startTime="791">differently. </span> <span class="line" data-startTime="793">Rendering expects that I </span><span class="line" data-startTime="793">shouldn't have to block for </span><span class="line" data-startTime="795">lots and lots of frames to </span><span class="line" data-startTime="795">submit each instance. </span></p>

<p><span class="line" data-startTime="799">In that situation, what you want </span><span class="line" data-startTime="799">to do is for these types </span><span class="line" data-startTime="801">of calls that are best for </span><span class="line" data-startTime="801">fire and forget, that you </span><span class="line" data-startTime="804">don't actually wait </span><span class="line" data-startTime="804">for a response. </span> <span class="line" data-startTime="806">These things don't need </span><span class="line" data-startTime="806">any information back </span><span class="line" data-startTime="807">from the main thread. </span> <span class="line" data-startTime="808">As such, you should just fire </span><span class="line" data-startTime="808">them off very quickly and </span><span class="line" data-startTime="811">allow the logic thread </span><span class="line" data-startTime="811">to move on. </span> <span class="line" data-startTime="813">So you can see here you get </span><span class="line" data-startTime="813">three fires really quick. </span> <span class="line" data-startTime="815">And then the Pepper thread </span><span class="line" data-startTime="815">spends its time doing the </span><span class="line" data-startTime="817">proper resource handling to the </span><span class="line" data-startTime="817">underlying architecture </span><span class="line" data-startTime="820">without you having to block. </span> <span class="line" data-startTime="822">Now for rendering, there's </span><span class="line" data-startTime="822">actually a different process </span><span class="line" data-startTime="824">involved here that you can </span><span class="line" data-startTime="824">actually think about in a </span><span class="line" data-startTime="826">different way. </span> <span class="line" data-startTime="827">A very modern graphics engine </span><span class="line" data-startTime="827">mechanic is actually the </span><span class="line" data-startTime="832">concept of buffering up all of </span><span class="line" data-startTime="832">your draw commands, submitting </span><span class="line" data-startTime="835">them off to the Pepper thread at </span><span class="line" data-startTime="835">a various form, so that it </span><span class="line" data-startTime="838">kind of gets the entire frame. </span> <span class="line" data-startTime="840">And then it starts queuing </span><span class="line" data-startTime="840">through it properly. </span></p>

<p><span class="line" data-startTime="843">So what happens is your logic </span><span class="line" data-startTime="843">thread will go and do the </span><span class="line" data-startTime="845">rendering, actually </span><span class="line" data-startTime="845">create the calls. </span> <span class="line" data-startTime="847">But instead of actually doing </span><span class="line" data-startTime="847">the rendering and calling the </span><span class="line" data-startTime="849">APIs, what happens is you </span><span class="line" data-startTime="849">overload the API to create a </span><span class="line" data-startTime="852">small, little representation, </span><span class="line" data-startTime="852">like a quad word or some form </span><span class="line" data-startTime="855">of it that gets pushed </span><span class="line" data-startTime="855">into an FIFO. </span> <span class="line" data-startTime="857">And that FIFO is then consumed </span><span class="line" data-startTime="857">by the Pepper thread, and </span><span class="line" data-startTime="860">issued off to the appropriate </span><span class="line" data-startTime="860">engines below that. </span></p>

<p><span class="line" data-startTime="863">Now this is important, that what </span><span class="line" data-startTime="863">you're effectively doing </span><span class="line" data-startTime="865">here is you're creating a </span><span class="line" data-startTime="865">waterfall processing method, </span><span class="line" data-startTime="867">or a producer consumer FIFO </span><span class="line" data-startTime="867">between your logic thread and </span><span class="line" data-startTime="870">your Pepper thread, where the </span><span class="line" data-startTime="870">logic thread will do logic </span><span class="line" data-startTime="873">frame n, kick off the rendering </span><span class="line" data-startTime="873">results for that. </span> <span class="line" data-startTime="877">And render thread will then do </span><span class="line" data-startTime="877">render frame n while the logic </span><span class="line" data-startTime="880">thread moves on to </span><span class="line" data-startTime="880">the next frame. </span> <span class="line" data-startTime="882">This, again, is a very </span><span class="line" data-startTime="882">common paradigm for </span><span class="line" data-startTime="885">next generation consoles &mdash; </span><span class="line" data-startTime="886">Xbox 360, PS3. </span> <span class="line" data-startTime="888">This is what you're doing </span><span class="line" data-startTime="888">in a lot of your </span><span class="line" data-startTime="889">systems right here. </span> <span class="line" data-startTime="890">Traditionally they call the </span><span class="line" data-startTime="890">Pepper thread the render </span><span class="line" data-startTime="892">thread at that point. </span></p>

<p><span class="line" data-startTime="893">And there's some variation </span><span class="line" data-startTime="893">of what data is </span><span class="line" data-startTime="895">pushed between the two. </span> <span class="line" data-startTime="896">In this particular method, you </span><span class="line" data-startTime="896">want no logic occurring on the </span><span class="line" data-startTime="900">Pepper thread other than just </span><span class="line" data-startTime="900">rendering your data. </span> <span class="line" data-startTime="903">So that's the ecosystem </span><span class="line" data-startTime="903">that you're in. </span> <span class="line" data-startTime="906">That's sort of what you're </span><span class="line" data-startTime="906">dealing with. </span> <span class="line" data-startTime="907">Basically, what you need to do </span><span class="line" data-startTime="907">is spin off a logic threat and </span><span class="line" data-startTime="910">then modify your code such that </span><span class="line" data-startTime="910">you handle two different </span><span class="line" data-startTime="913">types of calls. </span> <span class="line" data-startTime="913">You've got the calls that </span><span class="line" data-startTime="913">require feedback from the </span><span class="line" data-startTime="915">Pepper thread. </span></p>

<p><span class="line" data-startTime="916">And then those you need to </span><span class="line" data-startTime="916">block and wait for that </span><span class="line" data-startTime="918">information to return. </span> <span class="line" data-startTime="919">And then you've got the </span><span class="line" data-startTime="919">fire and forget calls. </span> <span class="line" data-startTime="921">And those are the calls that </span><span class="line" data-startTime="921">you just either issue </span><span class="line" data-startTime="923">immediately and then </span><span class="line" data-startTime="923">keep moving on. </span> <span class="line" data-startTime="925">Or you bundle up into some </span><span class="line" data-startTime="925">sort of frame or boundary </span><span class="line" data-startTime="927">mechanic and submit in one </span><span class="line" data-startTime="927">batch, and then let the Pepper </span><span class="line" data-startTime="929">thread do its thing while you're </span><span class="line" data-startTime="929">logic thread moves on. </span> <span class="line" data-startTime="932">So once you understand the </span><span class="line" data-startTime="932">environment that you're in, </span><span class="line" data-startTime="934">because of the Pepper API </span><span class="line" data-startTime="934">restrictions, which are </span><span class="line" data-startTime="936">temporary, by the way, now you </span><span class="line" data-startTime="936">can actually start porting the </span><span class="line" data-startTime="939">rest of your code. </span></p>

<p><span class="line" data-startTime="940">And this involves understanding </span><span class="line" data-startTime="941">at a number of levels. </span> <span class="line" data-startTime="942">So let's dive in. </span> <span class="line" data-startTime="944">The first is FileIO. </span> <span class="line" data-startTime="946">So if you've never developed a </span><span class="line" data-startTime="946">web game, let me clue you in </span><span class="line" data-startTime="948">on some specific information. </span> <span class="line" data-startTime="949">You're going to put your HTML </span><span class="line" data-startTime="949">datas and your NEXE datas and </span><span class="line" data-startTime="954">your NMF datas on some </span><span class="line" data-startTime="954">server somewhere. </span> <span class="line" data-startTime="957">And when the user loads your </span><span class="line" data-startTime="957">page that embeds this module, </span><span class="line" data-startTime="960">it's going to be received by the </span><span class="line" data-startTime="960">client and auto-cached by </span><span class="line" data-startTime="963">Chrome on your behalf. </span> <span class="line" data-startTime="964">This is just going to happen </span><span class="line" data-startTime="964">automatically. </span> <span class="line" data-startTime="966">And it will grab the HTML data, </span><span class="line" data-startTime="966">the NEXE data, and the </span><span class="line" data-startTime="969">NMF data and cache it for </span><span class="line" data-startTime="969">you because it's defined </span><span class="line" data-startTime="971">in the embed tag. </span></p>

<p><span class="line" data-startTime="972">And this is great. </span> <span class="line" data-startTime="973">This means that Chrome </span><span class="line" data-startTime="973">is handling your </span><span class="line" data-startTime="974">caching on your behalf. </span> <span class="line" data-startTime="976">You don't have to do </span><span class="line" data-startTime="976">anything else. </span> <span class="line" data-startTime="977">You just sit back, hands </span><span class="line" data-startTime="977">behind your head, </span><span class="line" data-startTime="979">allow it all to happen. </span> <span class="line" data-startTime="980">It's good to go. </span> <span class="line" data-startTime="981">The problem is that </span><span class="line" data-startTime="981">there's other data </span><span class="line" data-startTime="982">that your game needs. </span> <span class="line" data-startTime="983">There are zip files, for </span><span class="line" data-startTime="983">instance, ZIP0 and ZIP1. </span> <span class="line" data-startTime="986">These will not be pulled down </span><span class="line" data-startTime="986">automatically for you when the </span><span class="line" data-startTime="988">user loads your page. </span> <span class="line" data-startTime="989">Instead, for these, you have to </span><span class="line" data-startTime="989">use a GetURL API inside of </span><span class="line" data-startTime="993">Pepper or an XHR request </span><span class="line" data-startTime="993">inside of JavaScript. </span> <span class="line" data-startTime="997">And that will pull down </span><span class="line" data-startTime="997">these binary assets. </span> <span class="line" data-startTime="1000">Now the cool thing is that </span><span class="line" data-startTime="1000">with this call, with the </span><span class="line" data-startTime="1003">GetURL call, it will also </span><span class="line" data-startTime="1003">cache itself in </span><span class="line" data-startTime="1005">Chrome on your behalf. </span> <span class="line" data-startTime="1006">So you can actually fetch </span><span class="line" data-startTime="1006">these zip files. </span></p>

<p><span class="line" data-startTime="1008">Chrome will cache it. </span> <span class="line" data-startTime="1009">And then the next time the </span><span class="line" data-startTime="1009">user asks for it, it will </span><span class="line" data-startTime="1011">already be in the cache. </span> <span class="line" data-startTime="1012">And they can get it from there, </span><span class="line" data-startTime="1012">as opposed to going </span><span class="line" data-startTime="1013">back to the server, which </span><span class="line" data-startTime="1013">is a longer round trip. </span> <span class="line" data-startTime="1017">One of the interesting things </span><span class="line" data-startTime="1017">about this, though, is that </span><span class="line" data-startTime="1020">when your data is in the cache, </span><span class="line" data-startTime="1020">it can also be evicted </span><span class="line" data-startTime="1023">from the cache at </span><span class="line" data-startTime="1023">any single time. </span> <span class="line" data-startTime="1025">The user can go and load a </span><span class="line" data-startTime="1025">website which uses more data. </span> <span class="line" data-startTime="1027">Or they can clear the </span><span class="line" data-startTime="1027">cache themselves. </span></p>

<p><span class="line" data-startTime="1030">But basically, they can purge </span><span class="line" data-startTime="1030">all of this asset storing that </span><span class="line" data-startTime="1033">you're doing on their behalf, so </span><span class="line" data-startTime="1033">that the experience in your </span><span class="line" data-startTime="1036">game is not as optimal </span><span class="line" data-startTime="1036">as it should be. </span> <span class="line" data-startTime="1038">And this is a bad thing. </span> <span class="line" data-startTime="1039">To answer this, there's actually </span><span class="line" data-startTime="1039">a cool little API </span><span class="line" data-startTime="1041">inside of Pepper called </span><span class="line" data-startTime="1041">the File Store API. </span> <span class="line" data-startTime="1043">The File Store API will allow </span><span class="line" data-startTime="1043">you to grab data inside of the </span><span class="line" data-startTime="1047">client's memory and store it </span><span class="line" data-startTime="1047">to a persistent sandboxed </span><span class="line" data-startTime="1052">obfuscated file store. </span> <span class="line" data-startTime="1053">Now, this data will exist on </span><span class="line" data-startTime="1053">disk until one of two things </span><span class="line" data-startTime="1057">happens or both will happen. </span></p>

<p><span class="line" data-startTime="1059">The user navigates to this </span><span class="line" data-startTime="1059">sandbox system somehow through </span><span class="line" data-startTime="1062">their API and their operating </span><span class="line" data-startTime="1062">system and </span><span class="line" data-startTime="1064">manually deletes the data. </span> <span class="line" data-startTime="1067">Or your program deletes </span><span class="line" data-startTime="1067">the data. </span> <span class="line" data-startTime="1070">So effectively this allows you </span><span class="line" data-startTime="1070">to take control over the </span><span class="line" data-startTime="1072">caching mechanisms that </span><span class="line" data-startTime="1072">are used during </span><span class="line" data-startTime="1073">this transfer process. </span> <span class="line" data-startTime="1074">So definitely make sure </span><span class="line" data-startTime="1074">you're using that. </span> <span class="line" data-startTime="1077">You can click the link at </span><span class="line" data-startTime="1077">the bottom here for more </span><span class="line" data-startTime="1079">information. </span> <span class="line" data-startTime="1079">That actually directs </span><span class="line" data-startTime="1079">to gonacl.com. </span></p>

<p><span class="line" data-startTime="1081">We have a specific article </span><span class="line" data-startTime="1081">on how to do all this. </span> <span class="line" data-startTime="1085">FileIO and shutdown. </span> <span class="line" data-startTime="1087">Console developers in here, you </span><span class="line" data-startTime="1087">will help me lament over </span><span class="line" data-startTime="1090">the process of trying to write </span><span class="line" data-startTime="1090">to a memory stick that has </span><span class="line" data-startTime="1094">been pushed into a console. </span> <span class="line" data-startTime="1096">And as you're writing, the </span><span class="line" data-startTime="1096">user rips the stick out </span><span class="line" data-startTime="1098">because they think it's done. </span> <span class="line" data-startTime="1099">And now, all of a sudden, </span><span class="line" data-startTime="1099">you have &mdash; </span><span class="line" data-startTime="1100">effectively the world </span><span class="line" data-startTime="1100">explodes. </span> <span class="line" data-startTime="1101">The data written to </span><span class="line" data-startTime="1101">disk is corrupted. </span> <span class="line" data-startTime="1103">The information being </span><span class="line" data-startTime="1103">transferred is corrupted. </span> <span class="line" data-startTime="1105">And the user is mad at you </span><span class="line" data-startTime="1105">because you didn't know they </span><span class="line" data-startTime="1108">were going to rip </span><span class="line" data-startTime="1108">the stick out. </span> <span class="line" data-startTime="1109">Who knows? </span><span class="line" data-startTime="1110">Well, anyhow, in a web page </span><span class="line" data-startTime="1110">you have the same problem. </span> <span class="line" data-startTime="1113">When you're trying to write data </span><span class="line" data-startTime="1113">to your persistent file </span><span class="line" data-startTime="1115">store, the user can tab away. </span> <span class="line" data-startTime="1117">They can close the data. </span></p>

<p><span class="line" data-startTime="1119">A crash can occur. </span> <span class="line" data-startTime="1120">Something can happen </span><span class="line" data-startTime="1120">that effectively </span><span class="line" data-startTime="1121">does the same process. </span> <span class="line" data-startTime="1123">It effectively deteriorates </span><span class="line" data-startTime="1123">the data. </span> <span class="line" data-startTime="1125">Stops the write. </span> <span class="line" data-startTime="1126">Causes problems of all sorts. </span> <span class="line" data-startTime="1128">So if you've actually opened </span><span class="line" data-startTime="1128">this file and tried to write </span><span class="line" data-startTime="1131">to it, when you try to load it </span><span class="line" data-startTime="1131">the next time around, the </span><span class="line" data-startTime="1134">information is going </span><span class="line" data-startTime="1134">to be corrupt. </span> <span class="line" data-startTime="1135">Basically, you're going </span><span class="line" data-startTime="1135">to lose it. </span> <span class="line" data-startTime="1137">The better methodology here is </span><span class="line" data-startTime="1137">for any writes to file, what </span><span class="line" data-startTime="1140">you actually want to do is write </span><span class="line" data-startTime="1140">to a separate file or a </span><span class="line" data-startTime="1143">duplicate file and communicate </span><span class="line" data-startTime="1143">all of your data there. </span></p>

<p><span class="line" data-startTime="1146">And then once all of your </span><span class="line" data-startTime="1146">writing has been finalized, at </span><span class="line" data-startTime="1150">the end of your process, you </span><span class="line" data-startTime="1150">actually then move, rename, </span><span class="line" data-startTime="1154">some process, over to the </span><span class="line" data-startTime="1154">intended position. </span> <span class="line" data-startTime="1157">And this means &mdash; what occurs </span><span class="line" data-startTime="1157">here is that if the chance </span><span class="line" data-startTime="1161">that the user corrupts the data </span><span class="line" data-startTime="1161">during the write to the </span><span class="line" data-startTime="1164">persistent file store, that it </span><span class="line" data-startTime="1164">doesn't actually corrupt the </span><span class="line" data-startTime="1166">original data on disks. </span> <span class="line" data-startTime="1167">So when the user loads the game </span><span class="line" data-startTime="1167">next time, all they've </span><span class="line" data-startTime="1170">lost is the delta between the </span><span class="line" data-startTime="1170">last time they've saved, as </span><span class="line" data-startTime="1174">opposed to your entire saved </span><span class="line" data-startTime="1174">file, which is a good thing. </span> <span class="line" data-startTime="1179">Now for those of you who are </span><span class="line" data-startTime="1179">doing FileIO, there is a </span><span class="line" data-startTime="1181">really cool mode that's recent, </span><span class="line" data-startTime="1181">that's actually a </span><span class="line" data-startTime="1185">dangerous FileIO. </span> <span class="line" data-startTime="1186">And there's some terminology </span><span class="line" data-startTime="1186">about why you want to call it </span><span class="line" data-startTime="1189">dangerous or not. </span> <span class="line" data-startTime="1189">But this is really helpful </span><span class="line" data-startTime="1189">to those of you who are </span><span class="line" data-startTime="1191">developers. </span> <span class="line" data-startTime="1192">So in developer mode, you can </span><span class="line" data-startTime="1192">actually write directly to </span><span class="line" data-startTime="1195">disk outside of the obfuscated </span><span class="line" data-startTime="1195">sandbox. </span></p>

<p><span class="line" data-startTime="1199">This is really helpful. </span> <span class="line" data-startTime="1200">Effectively, when you launch </span><span class="line" data-startTime="1200">Chrome, you can send an </span><span class="line" data-startTime="1203">environment variable, NaCl </span><span class="line" data-startTime="1203">Dangerous Enable File Access. </span> <span class="line" data-startTime="1206">And then you run Chrome </span><span class="line" data-startTime="1206">with no sandbox. </span> <span class="line" data-startTime="1207">This effectively turns off some </span><span class="line" data-startTime="1207">of the security handles </span><span class="line" data-startTime="1210">that you have available </span><span class="line" data-startTime="1210">to you. </span> <span class="line" data-startTime="1212">And then in the code, in your </span><span class="line" data-startTime="1212">C code, you actually do a </span><span class="line" data-startTime="1214">direct f open and start </span><span class="line" data-startTime="1214">writing to it. </span> <span class="line" data-startTime="1218">And what this will do is </span><span class="line" data-startTime="1218">actually create a file in the </span><span class="line" data-startTime="1221">application location </span><span class="line" data-startTime="1221">of where NaCl is. </span></p>

<p><span class="line" data-startTime="1224">So for instance, path to Chrome </span><span class="line" data-startTime="1224">slash build number. </span> <span class="line" data-startTime="1226">That's where NaCl.exe exists. </span> <span class="line" data-startTime="1229">So with this set up here, </span><span class="line" data-startTime="1229">this actually creates a </span><span class="line" data-startTime="1231">tracelog.txt in my application </span><span class="line" data-startTime="1231">folder for Chrome 19, which is </span><span class="line" data-startTime="1234">currently in Canary. </span> <span class="line" data-startTime="1236">This is amazing. </span> <span class="line" data-startTime="1237">So for those of you developers </span><span class="line" data-startTime="1237">who are trying to do inline </span><span class="line" data-startTime="1239">profiling or trying to dump </span><span class="line" data-startTime="1239">crash disks or crash logs to </span><span class="line" data-startTime="1245">disk in these sorts of fashions, </span><span class="line" data-startTime="1245">having to wait for </span><span class="line" data-startTime="1247">the asynchronous file system </span><span class="line" data-startTime="1247">is just not doable. </span> <span class="line" data-startTime="1250">Instead, you actually want </span><span class="line" data-startTime="1250">to control writing </span><span class="line" data-startTime="1252">directly to a disk. </span></p>

<p><span class="line" data-startTime="1253">And this gives you </span><span class="line" data-startTime="1253">that ability. </span> <span class="line" data-startTime="1255">This is really important. </span> <span class="line" data-startTime="1256">It allows you to move </span><span class="line" data-startTime="1256">forward with getting </span><span class="line" data-startTime="1257">all this stuff done. </span> <span class="line" data-startTime="1258">And you can click that </span><span class="line" data-startTime="1258">link there for more. </span> <span class="line" data-startTime="1260">It's got more information on </span><span class="line" data-startTime="1260">it and how you use it. </span> <span class="line" data-startTime="1263">Rendering. </span> <span class="line" data-startTime="1264">So first off, Native Client </span><span class="line" data-startTime="1264">uses OpenGL ES 2.0 as a </span><span class="line" data-startTime="1269">rendering API. </span> <span class="line" data-startTime="1270">So this is the same API that's </span><span class="line" data-startTime="1270">used on mobile devices today. </span> <span class="line" data-startTime="1274">Porting your game to use </span><span class="line" data-startTime="1274">this is step one. </span> <span class="line" data-startTime="1277">So if you're using DirectX, you </span><span class="line" data-startTime="1277">need to port your stuff </span><span class="line" data-startTime="1279">over to OpenGL first, because </span><span class="line" data-startTime="1279">that will be an easy </span><span class="line" data-startTime="1280">transition for you. </span> <span class="line" data-startTime="1281">And then from OpenGL, you need </span><span class="line" data-startTime="1281">to move to OpenGL ES 2.0. </span> <span class="line" data-startTime="1285">You can do this using a project </span><span class="line" data-startTime="1287">called ANGLE on Windows. </span> <span class="line" data-startTime="1288">If you click that link, </span><span class="line" data-startTime="1288">there's a source code </span><span class="line" data-startTime="1290">repository there where </span><span class="line" data-startTime="1290">the entire </span><span class="line" data-startTime="1291">source code is available. </span></p>

<p><span class="line" data-startTime="1292">Effectively, ANGLE is a dll </span><span class="line" data-startTime="1292">suite that provides OpenGL ES </span><span class="line" data-startTime="1298">2.0 headers that you can then </span><span class="line" data-startTime="1298">target that will translate to </span><span class="line" data-startTime="1301">DirectX calls internally. </span> <span class="line" data-startTime="1303">So you can effectively test how </span><span class="line" data-startTime="1303">your code is working and </span><span class="line" data-startTime="1305">do this all on Windows. </span> <span class="line" data-startTime="1306">To note, there's no OpenGL ES </span><span class="line" data-startTime="1306">2.0 runtime on Windows. </span> <span class="line" data-startTime="1309">It doesn't exist. So if you're </span><span class="line" data-startTime="1309">going to try to test this on </span><span class="line" data-startTime="1312">Windows, you're going to </span><span class="line" data-startTime="1312">need to use ANGLE. </span> <span class="line" data-startTime="1316">Specifically, you need </span><span class="line" data-startTime="1316">to know that OpenGL </span><span class="line" data-startTime="1318">ES 2.0 is not OpenGL. </span> <span class="line" data-startTime="1320">There's a stricter set </span><span class="line" data-startTime="1320">of compiler rules. </span> <span class="line" data-startTime="1321">And this is because we need to </span><span class="line" data-startTime="1321">make sure that security is </span><span class="line" data-startTime="1323">step one for the end user. </span> <span class="line" data-startTime="1326">The developer, your experience </span><span class="line" data-startTime="1326">that you're trying to </span><span class="line" data-startTime="1327">communicate, that's all </span><span class="line" data-startTime="1327">fine and dandy. </span> <span class="line" data-startTime="1329">Keeping the user safe is more </span><span class="line" data-startTime="1329">important than all of that. </span></p>

<p><span class="line" data-startTime="1332">And not all the extensions </span><span class="line" data-startTime="1332">are available. </span> <span class="line" data-startTime="1334">So, for instance, if you're </span><span class="line" data-startTime="1334">expecting instancing or access </span><span class="line" data-startTime="1338">to a specific tessellation </span><span class="line" data-startTime="1338">shader, they're just not going </span><span class="line" data-startTime="1340">to be there. </span> <span class="line" data-startTime="1341">This is an API. </span> <span class="line" data-startTime="1342">This is handled by the Khronos </span><span class="line" data-startTime="1342">group and then rolling the </span><span class="line" data-startTime="1344">feature sets out is sort of </span><span class="line" data-startTime="1344">tiered because we have to go </span><span class="line" data-startTime="1347">through those bodies. </span> <span class="line" data-startTime="1349">But make sure that you </span><span class="line" data-startTime="1349">understand that OpenGL ES 2.0 </span><span class="line" data-startTime="1351">and OpenGL are not </span><span class="line" data-startTime="1351">the same thing. </span> <span class="line" data-startTime="1353">Specifically, for API nuances. </span> <span class="line" data-startTime="1355">For instance, in OpenGL you </span><span class="line" data-startTime="1355">can create a compressed </span><span class="line" data-startTime="1359">texture and not pass any </span><span class="line" data-startTime="1359">information into it. </span> <span class="line" data-startTime="1362">So you can just say, hey, create </span><span class="line" data-startTime="1362">this blank texture, and </span><span class="line" data-startTime="1364">I'll fill it in later. </span></p>

<p><span class="line" data-startTime="1365">OpenGL ES 2.0, actually, this </span><span class="line" data-startTime="1365">is considered an error. </span> <span class="line" data-startTime="1368">If you try to do this, it </span><span class="line" data-startTime="1368">will actually crash. </span> <span class="line" data-startTime="1370">Now the problem is this is </span><span class="line" data-startTime="1370">not well documented. </span> <span class="line" data-startTime="1373">And if you go to the Native </span><span class="line" data-startTime="1373">Client forums, you'll actually </span><span class="line" data-startTime="1375">see about 10 or 11 people, </span><span class="line" data-startTime="1375">myself included, complaining </span><span class="line" data-startTime="1378">about this problem and asking </span><span class="line" data-startTime="1378">for a solution. </span> <span class="line" data-startTime="1380">The reality is that this is an </span><span class="line" data-startTime="1380">OpenGL E 2.0 spec that is not </span><span class="line" data-startTime="1387">compatible with OpenGL. </span> <span class="line" data-startTime="1388">Make sure you test all of </span><span class="line" data-startTime="1388">this stuff properly. </span> <span class="line" data-startTime="1390">And definitely make sure you're </span><span class="line" data-startTime="1390">checking the API before </span><span class="line" data-startTime="1392">you start blaming Native Client, </span><span class="line" data-startTime="1392">because a lot of the </span><span class="line" data-startTime="1394">times the problem is there. </span></p>

<p><span class="line" data-startTime="1398">So the next thing you need to be </span><span class="line" data-startTime="1398">aware of when you're doing </span><span class="line" data-startTime="1400">rendering is that </span><span class="line" data-startTime="1400">you're actually </span><span class="line" data-startTime="1402">rendering from a sandbox. </span> <span class="line" data-startTime="1403">Now because of security issues, </span><span class="line" data-startTime="1403">we don't actually </span><span class="line" data-startTime="1405">allow your code to directly </span><span class="line" data-startTime="1405">go to the driver. </span> <span class="line" data-startTime="1408">When you do a set command or a </span><span class="line" data-startTime="1408">draw command or anything, we </span><span class="line" data-startTime="1411">don't actually go right </span><span class="line" data-startTime="1411">to the API. </span> <span class="line" data-startTime="1413">Instead, what occurs </span><span class="line" data-startTime="1413">is we have a </span><span class="line" data-startTime="1414">separate render process. </span> <span class="line" data-startTime="1416">The render process is </span><span class="line" data-startTime="1416">responsible for handling all </span><span class="line" data-startTime="1420">the interaction with the API. </span> <span class="line" data-startTime="1421">Nothing else goes through </span><span class="line" data-startTime="1421">this render </span><span class="line" data-startTime="1423">process except API calls. </span></p>

<p><span class="line" data-startTime="1425">Now to get from the Pepper </span><span class="line" data-startTime="1425">thread to the render process, </span><span class="line" data-startTime="1428">though, we actually create </span><span class="line" data-startTime="1428">an RPC buffer. </span> <span class="line" data-startTime="1430">Now what happens is the Pepper </span><span class="line" data-startTime="1430">thread will push commands into </span><span class="line" data-startTime="1433">the RPC buffer. </span> <span class="line" data-startTime="1435">And then that buffer will be </span><span class="line" data-startTime="1435">flushed at some time later to </span><span class="line" data-startTime="1437">the render process. </span> <span class="line" data-startTime="1438">This basically creates about a </span><span class="line" data-startTime="1438">frame of latency between a </span><span class="line" data-startTime="1441">producer-consumer FIFO that </span><span class="line" data-startTime="1441">you need to be aware of. </span> <span class="line" data-startTime="1446">What happens with this </span><span class="line" data-startTime="1446">producer-consumer FIFO, </span><span class="line" data-startTime="1448">though, is that your RPC </span><span class="line" data-startTime="1448">buffer, sooner or </span><span class="line" data-startTime="1450">later, will get full. </span> <span class="line" data-startTime="1453">So what happens is you </span><span class="line" data-startTime="1453">draw an object. </span> <span class="line" data-startTime="1454">You update your vertex buffer. </span></p>

<p><span class="line" data-startTime="1455">You go to draw an object again, </span><span class="line" data-startTime="1455">and the buffer's full. </span> <span class="line" data-startTime="1458">So then it stalls. </span> <span class="line" data-startTime="1459">What happens here is you hit </span><span class="line" data-startTime="1459">something called a flush sink </span><span class="line" data-startTime="1462">or sink flush, depending on </span><span class="line" data-startTime="1462">which documentation you get. </span> <span class="line" data-startTime="1466">What happens here is that the </span><span class="line" data-startTime="1466">process, even though you're </span><span class="line" data-startTime="1470">not done with your frame, </span><span class="line" data-startTime="1470">will actually halt. </span> <span class="line" data-startTime="1472">And it will say, hey, </span><span class="line" data-startTime="1472">we're done here. </span> <span class="line" data-startTime="1473">I'm full. </span> <span class="line" data-startTime="1474">And it will actually </span><span class="line" data-startTime="1474">issue a flush sink. </span> <span class="line" data-startTime="1476">Now, what will happen here is </span><span class="line" data-startTime="1476">that it blocks the processing </span><span class="line" data-startTime="1479">and calling thread until all </span><span class="line" data-startTime="1479">of the data inside that RPC </span><span class="line" data-startTime="1481">buffer has been consumed </span><span class="line" data-startTime="1481">by the render process. </span> <span class="line" data-startTime="1484">What this means to you is </span><span class="line" data-startTime="1484">you'll start seeing </span><span class="line" data-startTime="1486">30-millisecond spikes randomly </span><span class="line" data-startTime="1486">in your game, </span><span class="line" data-startTime="1489">hitches in weird places. </span> <span class="line" data-startTime="1490">When you start debugging and </span><span class="line" data-startTime="1490">profiling down into it, you'll </span><span class="line" data-startTime="1493">see random calls all of a sudden </span><span class="line" data-startTime="1493">taking 30 milliseconds. </span></p>

<p><span class="line" data-startTime="1496">And to you this is going </span><span class="line" data-startTime="1496">to be maddening. </span> <span class="line" data-startTime="1497">You're going try to figure out </span><span class="line" data-startTime="1497">why this one draw object is </span><span class="line" data-startTime="1500">taking 30 milliseconds. </span> <span class="line" data-startTime="1501">Is it the pixel shader? </span><span class="line" data-startTime="1502">Is it the number of vertices? </span><span class="line" data-startTime="1503">Yada, yada. </span> <span class="line" data-startTime="1503">You'll start moving the thing </span><span class="line" data-startTime="1503">around and noticing that it </span><span class="line" data-startTime="1506">never happens on the same draw </span><span class="line" data-startTime="1506">call, that it happens sort of </span><span class="line" data-startTime="1508">as a temporal problem. </span> <span class="line" data-startTime="1509">And what the real problem is </span><span class="line" data-startTime="1509">is that the RPC buffer is </span><span class="line" data-startTime="1512">getting full. </span> <span class="line" data-startTime="1513">So make sure you note </span><span class="line" data-startTime="1513">that ahead of time. </span> <span class="line" data-startTime="1515">Now how you combat this is </span><span class="line" data-startTime="1515">kind of interesting. </span> <span class="line" data-startTime="1520">First off, swap buffers actually </span><span class="line" data-startTime="1520">kicks off a GL finish </span><span class="line" data-startTime="1523">call on your behalf. </span></p>

<p><span class="line" data-startTime="1524">GL finish will actually </span><span class="line" data-startTime="1524">force a flush to </span><span class="line" data-startTime="1527">occur of the RPC buffer. </span> <span class="line" data-startTime="1529">So you fill in a frame. </span> <span class="line" data-startTime="1530">You hit swap buffers. </span> <span class="line" data-startTime="1531">And then you start filling </span><span class="line" data-startTime="1531">in the next frame. </span> <span class="line" data-startTime="1532">And that swap buffers will push </span><span class="line" data-startTime="1532">everything off to the </span><span class="line" data-startTime="1534">render process on your behalf. </span> <span class="line" data-startTime="1535">The goal here is to implement </span><span class="line" data-startTime="1535">these flushes in strategic </span><span class="line" data-startTime="1540">locations inside of your render </span><span class="line" data-startTime="1540">loop, so that you never </span><span class="line" data-startTime="1543">hit a sink flush. </span> <span class="line" data-startTime="1544">So effectively what you're doing </span><span class="line" data-startTime="1544">is continuously pushing </span><span class="line" data-startTime="1546">the data and forcing that RPC </span><span class="line" data-startTime="1546">buffer to flush, so that you </span><span class="line" data-startTime="1550">never hit these 30-millisecond </span><span class="line" data-startTime="1550">waits. </span> <span class="line" data-startTime="1552">So you need to do is once </span><span class="line" data-startTime="1552">you draw some stuff, </span><span class="line" data-startTime="1554">you insert a flush. </span> <span class="line" data-startTime="1555">You draw some more stuff, and </span><span class="line" data-startTime="1555">you insert another flush. </span> <span class="line" data-startTime="1557">Now the key here is that </span><span class="line" data-startTime="1557">figuring out where to insert </span><span class="line" data-startTime="1561">these GL flush calls. </span></p>

<p><span class="line" data-startTime="1563">That's the trick. </span> <span class="line" data-startTime="1564">To do that what you have to do </span><span class="line" data-startTime="1564">is you have to go back and </span><span class="line" data-startTime="1566">analyze your frame. </span> <span class="line" data-startTime="1567">You got to take a look at where </span><span class="line" data-startTime="1567">the heavy spots are, </span><span class="line" data-startTime="1569">where you're hitting your flush </span><span class="line" data-startTime="1569">sinks, and then figure </span><span class="line" data-startTime="1571">out, hey, I need to insert a GL </span><span class="line" data-startTime="1571">flush manually before I hit </span><span class="line" data-startTime="1574">that point to save me </span><span class="line" data-startTime="1574">30 milliseconds. </span> <span class="line" data-startTime="1576">Basically, what you're trying to </span><span class="line" data-startTime="1576">do is keep that RPC buffer </span><span class="line" data-startTime="1579">continuously moving to keep </span><span class="line" data-startTime="1579">your frames from getting </span><span class="line" data-startTime="1582">stalled out. </span> <span class="line" data-startTime="1585">So once you understand how all </span><span class="line" data-startTime="1585">this works and how you're </span><span class="line" data-startTime="1587">rendering, how the rendering </span><span class="line" data-startTime="1587">occurs, and how the rendering </span><span class="line" data-startTime="1590">happens between the Chrome and </span><span class="line" data-startTime="1590">Native Client module in the </span><span class="line" data-startTime="1593">rendering process, you need to </span><span class="line" data-startTime="1593">take a step back and take a </span><span class="line" data-startTime="1596">view of the bigger picture, </span><span class="line" data-startTime="1596">which is 3D and the web. </span></p>

<p><span class="line" data-startTime="1599">3D API's, as well documented, </span><span class="line" data-startTime="1599">can be malicious on the web. </span> <span class="line" data-startTime="1602">As much as we would like </span><span class="line" data-startTime="1602">to admit it, the web is </span><span class="line" data-startTime="1605">homogeneous. </span> <span class="line" data-startTime="1606">But GPUs and hardware are not. </span> <span class="line" data-startTime="1609">You've got a different </span><span class="line" data-startTime="1609">machine. </span> <span class="line" data-startTime="1610">You've got a different </span><span class="line" data-startTime="1610">machine. </span> <span class="line" data-startTime="1611">Heck, my coffee cup has a </span><span class="line" data-startTime="1611">different GPU processing in it </span><span class="line" data-startTime="1614">than any of you, which I think </span><span class="line" data-startTime="1614">this is a 9,800, but we'll get </span><span class="line" data-startTime="1618">back to that later. </span> <span class="line" data-startTime="1619">So the problem here is that </span><span class="line" data-startTime="1619">because of the fact that some </span><span class="line" data-startTime="1623">of these drivers can be </span><span class="line" data-startTime="1623">malicious, WebGL actually has </span><span class="line" data-startTime="1626">a list of blacklisted </span><span class="line" data-startTime="1626">3D drivers. </span> <span class="line" data-startTime="1628">Most of the time if a driver </span><span class="line" data-startTime="1628">has a problem, we can say, </span><span class="line" data-startTime="1630">hey, here's the problem. </span></p>

<p><span class="line" data-startTime="1631">Submit it to the vendor. </span> <span class="line" data-startTime="1632">The vendor can fix it and </span><span class="line" data-startTime="1632">push out a patch to it. </span> <span class="line" data-startTime="1635">In the situations where this </span><span class="line" data-startTime="1635">doesn't occur, we effectively </span><span class="line" data-startTime="1638">have to say we have to blacklist </span><span class="line" data-startTime="1638">the driver because </span><span class="line" data-startTime="1640">this is a malicious piece of </span><span class="line" data-startTime="1640">software that can cause </span><span class="line" data-startTime="1642">problems on the end user's </span><span class="line" data-startTime="1642">machine and expose them to </span><span class="line" data-startTime="1645">potential security risks. </span> <span class="line" data-startTime="1646">And because of that, the user </span><span class="line" data-startTime="1646">can hit a web page, and we can </span><span class="line" data-startTime="1649">say, hey, you're not allowed </span><span class="line" data-startTime="1649">to run WebGL. </span> <span class="line" data-startTime="1651">You're not allowed </span><span class="line" data-startTime="1651">to run OpenGL </span><span class="line" data-startTime="1653">inside of Native Client. </span></p>

<p><span class="line" data-startTime="1655">And to detect this, effectively </span><span class="line" data-startTime="1655">what happens is </span><span class="line" data-startTime="1657">you fail to create a context. </span> <span class="line" data-startTime="1659">That's the basic thing. </span> <span class="line" data-startTime="1660">The first thing you do in any </span><span class="line" data-startTime="1660">OpenGL-style system is you </span><span class="line" data-startTime="1663">create a GL context. </span> <span class="line" data-startTime="1664">When that fails, it means </span><span class="line" data-startTime="1664">one of two things. </span> <span class="line" data-startTime="1666">Either the user doesn't have the </span><span class="line" data-startTime="1666">proper hardware to run any </span><span class="line" data-startTime="1669">WebGL or OpenGL. </span> <span class="line" data-startTime="1670">Or the user has a set of </span><span class="line" data-startTime="1670">blacklisted drivers. </span> <span class="line" data-startTime="1674">Your job is to detect this </span><span class="line" data-startTime="1674">and respond very early. </span> <span class="line" data-startTime="1677">Because I'll tell you, nothing </span><span class="line" data-startTime="1677">is more annoying than a user </span><span class="line" data-startTime="1680">spending an hour and a half </span><span class="line" data-startTime="1680">trying to get your game to run </span><span class="line" data-startTime="1682">and updating drivers and </span><span class="line" data-startTime="1682">updating Chrome and doing this </span><span class="line" data-startTime="1685">and that to finally get down to </span><span class="line" data-startTime="1685">and realize the problem is </span><span class="line" data-startTime="1688">they needed to go update a patch </span><span class="line" data-startTime="1688">or that they just can't </span><span class="line" data-startTime="1690">do it in general. </span> <span class="line" data-startTime="1691">Make sure you update this early </span><span class="line" data-startTime="1691">and tell the users, so </span><span class="line" data-startTime="1693">you can save them </span><span class="line" data-startTime="1693">all that time. </span></p>

<p><span class="line" data-startTime="1696">To do this is is actually </span><span class="line" data-startTime="1696">really simple. </span> <span class="line" data-startTime="1697">Here's a little snippet of </span><span class="line" data-startTime="1697">code that you can use in </span><span class="line" data-startTime="1699">JavaScript. </span> <span class="line" data-startTime="1700">So this is way before Native </span><span class="line" data-startTime="1700">Client even loads. </span> <span class="line" data-startTime="1702">So the user loads your page. </span> <span class="line" data-startTime="1704">You're going to execute this </span><span class="line" data-startTime="1704">snippet of JavaScript to </span><span class="line" data-startTime="1706">determine whether or not the </span><span class="line" data-startTime="1706">user is blacklisted first. OK. </span> <span class="line" data-startTime="1709">Basically what you do is you try </span><span class="line" data-startTime="1709">to create a WebGL context. </span> <span class="line" data-startTime="1712">If that WebGL context fails, </span><span class="line" data-startTime="1712">you can alert the user </span><span class="line" data-startTime="1715">immediately, immediately that </span><span class="line" data-startTime="1715">they either have blacklisted </span><span class="line" data-startTime="1717">hardware, or they don't </span><span class="line" data-startTime="1717">have hardware </span><span class="line" data-startTime="1719">sufficient to run this. </span> <span class="line" data-startTime="1720">If it passes, then you know the </span><span class="line" data-startTime="1720">user has a system that can </span><span class="line" data-startTime="1723">run your game, your 3D game. </span> <span class="line" data-startTime="1725">And you can also do some </span><span class="line" data-startTime="1725">other cool stuff here. </span></p>

<p><span class="line" data-startTime="1727">Since you have the context, </span><span class="line" data-startTime="1727">you can go ahead and test </span><span class="line" data-startTime="1729">additional extensions. </span> <span class="line" data-startTime="1730">Like does the user have </span><span class="line" data-startTime="1730">occlusion calling? </span><span class="line" data-startTime="1732">Or does the user have </span><span class="line" data-startTime="1732">the ability to run </span><span class="line" data-startTime="1734">4096 by 4096 textures? </span><span class="line" data-startTime="1736">You can do all this in </span><span class="line" data-startTime="1736">JavaScript before you start </span><span class="line" data-startTime="1739">loading all of your NEXEs and </span><span class="line" data-startTime="1739">start transferring your binary </span><span class="line" data-startTime="1741">data from the web. </span> <span class="line" data-startTime="1742">This is really cool to do. </span> <span class="line" data-startTime="1744">The link at the bottom here, </span><span class="line" data-startTime="1744">actually, links to a specific </span><span class="line" data-startTime="1747">example of how to do all this. </span> <span class="line" data-startTime="1748">As well as you should take a </span><span class="line" data-startTime="1748">look at the load progress </span><span class="line" data-startTime="1750">example in the SDK. </span> <span class="line" data-startTime="1752">It has this as well as a fleet </span><span class="line" data-startTime="1752">of other tasks that you should </span><span class="line" data-startTime="1754">be doing, as well as detecting </span><span class="line" data-startTime="1754">download process and </span><span class="line" data-startTime="1758">displaying that to your users. </span></p>

<p><span class="line" data-startTime="1759">So make sure that that's part </span><span class="line" data-startTime="1759">of your best practices. </span> <span class="line" data-startTime="1762">Working in a browser. </span> <span class="line" data-startTime="1763">So you understand the </span><span class="line" data-startTime="1763">environment you're in. </span> <span class="line" data-startTime="1766">You understand the hitches and </span><span class="line" data-startTime="1766">the hurdles that you're going </span><span class="line" data-startTime="1768">to have to jump for FileIO and </span><span class="line" data-startTime="1768">rendering and all the problems </span><span class="line" data-startTime="1771">associated with that. </span> <span class="line" data-startTime="1772">So now let's talk about working </span><span class="line" data-startTime="1772">inside of a browser. </span> <span class="line" data-startTime="1774">So this has less to do with your </span><span class="line" data-startTime="1774">technology and your code </span><span class="line" data-startTime="1776">and more to do with </span><span class="line" data-startTime="1776">the ecosystem that </span><span class="line" data-startTime="1777">you're living in. </span> <span class="line" data-startTime="1779">So first off is NaCl </span><span class="line" data-startTime="1779">white listing. </span> <span class="line" data-startTime="1781">Native Client is not enabled </span><span class="line" data-startTime="1781">inside of Chrome until an </span><span class="line" data-startTime="1785">action occurs. </span> <span class="line" data-startTime="1787">This is for a number </span><span class="line" data-startTime="1787">of reasons, </span><span class="line" data-startTime="1789">predominately security. </span> <span class="line" data-startTime="1790">If there's an issue in Native </span><span class="line" data-startTime="1790">Client that we're not aware </span><span class="line" data-startTime="1792">of, we don't want malicious code </span><span class="line" data-startTime="1792">just sitting around on </span><span class="line" data-startTime="1794">the internet. </span> <span class="line" data-startTime="1795">We want some way to make sure </span><span class="line" data-startTime="1795">that random users are not at </span><span class="line" data-startTime="1798">the mercy of a problem </span><span class="line" data-startTime="1798">that we find. </span> <span class="line" data-startTime="1801">So Native Client is not enabled </span><span class="line" data-startTime="1803">until one of two things. </span></p>

<p><span class="line" data-startTime="1803">First off, for developers, you </span><span class="line" data-startTime="1803">can turn on Native Client by a </span><span class="line" data-startTime="1806">flag in the about flags page. </span> <span class="line" data-startTime="1808">So this will allow you, as a </span><span class="line" data-startTime="1808">developer, to get access to </span><span class="line" data-startTime="1811">any Native Client content </span><span class="line" data-startTime="1811">that exists on the web. </span> <span class="line" data-startTime="1813">For users, though, you don't </span><span class="line" data-startTime="1813">want them setting a flag. </span> <span class="line" data-startTime="1816">Users have to go through </span><span class="line" data-startTime="1816">a different path. </span> <span class="line" data-startTime="1817">They actually install the game </span><span class="line" data-startTime="1817">from the Chrome web store. </span> <span class="line" data-startTime="1820">And what happens here is that </span><span class="line" data-startTime="1820">the Chrome web store will </span><span class="line" data-startTime="1823">actually list the origin that </span><span class="line" data-startTime="1823">you've specified for your NaCl </span><span class="line" data-startTime="1826">module, so basically where </span><span class="line" data-startTime="1826">it's resting on a server. </span> <span class="line" data-startTime="1828">So I've got a website, </span><span class="line" data-startTime="1828">mainroach.blogspot.com. </span></p>

<p><span class="line" data-startTime="1832">And I host my Native </span><span class="line" data-startTime="1832">Client app there. </span> <span class="line" data-startTime="1834">When I create my Chrome Web </span><span class="line" data-startTime="1834">Store instance, I say that my </span><span class="line" data-startTime="1837">Native Client application </span><span class="line" data-startTime="1837">will be hosted for </span><span class="line" data-startTime="1839">mainroach.blogspot.com. </span> <span class="line" data-startTime="1842">When you install that, as </span><span class="line" data-startTime="1842">a user, that origin, </span><span class="line" data-startTime="1844">mainroach.blogspot.com will </span><span class="line" data-startTime="1844">get listed inside of your </span><span class="line" data-startTime="1847">preferences as a white </span><span class="line" data-startTime="1847">listed location. </span> <span class="line" data-startTime="1849">Hey, it's OK to serve </span><span class="line" data-startTime="1849">Native Client </span><span class="line" data-startTime="1851">content from this location. </span> <span class="line" data-startTime="1854">And note that the NMF and </span><span class="line" data-startTime="1854">the NEXEs must be </span><span class="line" data-startTime="1857">loaded from that location. </span> <span class="line" data-startTime="1858">You can put zip data in </span><span class="line" data-startTime="1858">different places and aug files </span><span class="line" data-startTime="1861">and JavaScript all on </span><span class="line" data-startTime="1861">a content network, </span><span class="line" data-startTime="1863">wherever you want them. </span> <span class="line" data-startTime="1864">But the NEXEs and the NMFs </span><span class="line" data-startTime="1864">must exist from that </span><span class="line" data-startTime="1867">white-listed origin. </span> <span class="line" data-startTime="1870">So once you've done that, </span><span class="line" data-startTime="1870">you have a pretty </span><span class="line" data-startTime="1871">easy way to test this. </span> <span class="line" data-startTime="1873">So you can actually determine </span><span class="line" data-startTime="1873">beforehand whether or not the </span><span class="line" data-startTime="1875">user actually has Native </span><span class="line" data-startTime="1875">Client enabled or </span><span class="line" data-startTime="1877">available to install. </span> <span class="line" data-startTime="1879">So first off, you need to detect </span><span class="line" data-startTime="1879">whether or not the user </span><span class="line" data-startTime="1880">is running Chrome. </span></p>

<p><span class="line" data-startTime="1881">As of today, much to my dismay, </span><span class="line" data-startTime="1881">Chrome is the only one </span><span class="line" data-startTime="1885">that uses and installs </span><span class="line" data-startTime="1885">Native Client. </span> <span class="line" data-startTime="1887">So first off, to determine if a </span><span class="line" data-startTime="1887">user can run Native Client, </span><span class="line" data-startTime="1891">you need to detect if they're </span><span class="line" data-startTime="1891">using Chrome. </span> <span class="line" data-startTime="1893">Secondly the Chrome web store </span><span class="line" data-startTime="1893">has a really cool API called </span><span class="line" data-startTime="1897">window.chrome.app.isinstalled. </span> <span class="line" data-startTime="1900">And you can define in this </span><span class="line" data-startTime="1900">whether or not the application </span><span class="line" data-startTime="1904">defined on this page has </span><span class="line" data-startTime="1904">been installed from </span><span class="line" data-startTime="1905">the Chrome web store. </span> <span class="line" data-startTime="1907">Now because an end user has </span><span class="line" data-startTime="1907">to install a Native Client </span><span class="line" data-startTime="1909">application from the Chrome web </span><span class="line" data-startTime="1909">store, this is effectively </span><span class="line" data-startTime="1912">your test to determine if </span><span class="line" data-startTime="1912">the user can run it. </span> <span class="line" data-startTime="1914">So if some user randomly browses </span><span class="line" data-startTime="1914">to your web page that </span><span class="line" data-startTime="1918">doesn't have Native Client </span><span class="line" data-startTime="1918">installed or hasn't installed </span><span class="line" data-startTime="1920">it from the web store, you can </span><span class="line" data-startTime="1920">detect it here and direct them </span><span class="line" data-startTime="1923">to install it. </span></p>

<p><span class="line" data-startTime="1924">You can also use something </span><span class="line" data-startTime="1924">called Inline Install, which </span><span class="line" data-startTime="1927">is a great little nifty feature </span><span class="line" data-startTime="1927">from the Chrome web </span><span class="line" data-startTime="1929">store, too. </span> <span class="line" data-startTime="1930">But the important thing here </span><span class="line" data-startTime="1930">is that you need to detect </span><span class="line" data-startTime="1931">this and tell the user because, </span><span class="line" data-startTime="1931">otherwise, they're </span><span class="line" data-startTime="1933">going to browse to </span><span class="line" data-startTime="1933">your website. </span> <span class="line" data-startTime="1935">And then they'll get a plug-in </span><span class="line" data-startTime="1935">request. And they're going to </span><span class="line" data-startTime="1937">be like, hey, what's this? </span><span class="line" data-startTime="1938">This is crummy. </span> <span class="line" data-startTime="1938">I'm going to give you zero star </span><span class="line" data-startTime="1938">reviews, and send you </span><span class="line" data-startTime="1941">pictures that you don't </span><span class="line" data-startTime="1941">want to see. </span> <span class="line" data-startTime="1942">Definitely click the link at </span><span class="line" data-startTime="1942">the bottom of this slide. </span> <span class="line" data-startTime="1944">And also check out the load </span><span class="line" data-startTime="1944">progress example in the SDK </span><span class="line" data-startTime="1946">for more on that. </span> <span class="line" data-startTime="1948">Now for developers, it's worth </span><span class="line" data-startTime="1948">pointing out that the Chrome </span><span class="line" data-startTime="1951">caching mechanism is </span><span class="line" data-startTime="1951">both aggressive, </span><span class="line" data-startTime="1955">amazing, and magical. </span></p>

<p><span class="line" data-startTime="1957">How well it caches data and </span><span class="line" data-startTime="1957">how aggressive it is at </span><span class="line" data-startTime="1960">keeping it around to make sure </span><span class="line" data-startTime="1960">that you're always hitting the </span><span class="line" data-startTime="1962">cache as opposed to going </span><span class="line" data-startTime="1962">to the web is </span><span class="line" data-startTime="1964">really a thing of beauty. </span> <span class="line" data-startTime="1965">The problem is for those of us </span><span class="line" data-startTime="1965">game developers who do test, </span><span class="line" data-startTime="1969">launch, and iterate patterns, </span><span class="line" data-startTime="1969">this is a problem. </span> <span class="line" data-startTime="1972">Because as I change some code, </span><span class="line" data-startTime="1972">deploy it to Chrome, and then </span><span class="line" data-startTime="1975">iterate on that content, I </span><span class="line" data-startTime="1975">want the latest version. </span> <span class="line" data-startTime="1978">I don't want the </span><span class="line" data-startTime="1978">cached version. </span> <span class="line" data-startTime="1980">To get around this, because </span><span class="line" data-startTime="1980">Chrome will bite you in this </span><span class="line" data-startTime="1983">matter, you can actually go </span><span class="line" data-startTime="1983">to the developer tools and </span><span class="line" data-startTime="1986">actually turn off caching. </span></p>

<p><span class="line" data-startTime="1987">You can disable caching, so that </span><span class="line" data-startTime="1987">Chrome will always try to </span><span class="line" data-startTime="1989">fetch the most recent version </span><span class="line" data-startTime="1989">and won't ever try to grab the </span><span class="line" data-startTime="1993">data from the cache. </span> <span class="line" data-startTime="1994">Now, it's worth pointing out </span><span class="line" data-startTime="1994">that you probably don't want </span><span class="line" data-startTime="1996">to do this on the version of </span><span class="line" data-startTime="1996">Chrome that you're running </span><span class="line" data-startTime="1998">every day because otherwise your </span><span class="line" data-startTime="1998">browser will just slow </span><span class="line" data-startTime="2000">down in general. </span> <span class="line" data-startTime="2001">But make sure that in your </span><span class="line" data-startTime="2001">developer version of Chrome </span><span class="line" data-startTime="2003">that you're doing </span><span class="line" data-startTime="2003">it like this. </span> <span class="line" data-startTime="2006">Now also while you're developing </span><span class="line" data-startTime="2006">in Chrome, there's </span><span class="line" data-startTime="2008">a whole fleet of tools that </span><span class="line" data-startTime="2008">will help you in your </span><span class="line" data-startTime="2012">development. </span></p>

<p><span class="line" data-startTime="2012">And these are called the </span><span class="line" data-startTime="2012">Chrome developer tools. </span> <span class="line" data-startTime="2014">You can click the link to the </span><span class="line" data-startTime="2014">more expansive declaration. </span> <span class="line" data-startTime="2017">But effectively, you can click </span><span class="line" data-startTime="2017">on the wrench, go down to </span><span class="line" data-startTime="2019">tools, and go down to </span><span class="line" data-startTime="2019">developer tools. </span> <span class="line" data-startTime="2021">And this will launch a small </span><span class="line" data-startTime="2021">little bar at the bottom of </span><span class="line" data-startTime="2023">your window that has a number </span><span class="line" data-startTime="2023">of options here &mdash; </span><span class="line" data-startTime="2025">elements, resources, network </span><span class="line" data-startTime="2025">views, et cetera. </span> <span class="line" data-startTime="2028">One of the cool things about </span><span class="line" data-startTime="2028">this is that it actually </span><span class="line" data-startTime="2029">provides a networking view. </span></p>

<p><span class="line" data-startTime="2031">The networking view actually </span><span class="line" data-startTime="2031">lists all of the asset </span><span class="line" data-startTime="2034">requests that your module has </span><span class="line" data-startTime="2034">made through Chrome over the </span><span class="line" data-startTime="2037">lifetime of its application. </span> <span class="line" data-startTime="2039">So you can actually see, hey, </span><span class="line" data-startTime="2039">am I loading my zip file. </span> <span class="line" data-startTime="2042">Am I loading my audio data? </span><span class="line" data-startTime="2043">How long does it take </span><span class="line" data-startTime="2043">to fetch that? </span><span class="line" data-startTime="2045">Can I change anything </span><span class="line" data-startTime="2045">to make that faster? </span><span class="line" data-startTime="2047">Can I bundle things up </span><span class="line" data-startTime="2047">to make that easier? </span><span class="line" data-startTime="2049">These are sort of quintessential </span><span class="line" data-startTime="2049">tools that you </span><span class="line" data-startTime="2053">need to be using, if you're </span><span class="line" data-startTime="2053">starting to develop inside of </span><span class="line" data-startTime="2055">Chrome, especially the console </span><span class="line" data-startTime="2055">tab, which will tell you a lot </span><span class="line" data-startTime="2057">of errors the Native Client </span><span class="line" data-startTime="2057">spits out that you may not be </span><span class="line" data-startTime="2059">able to catch in </span><span class="line" data-startTime="2059">other fashions. </span> <span class="line" data-startTime="2062">Another amazing tool </span><span class="line" data-startTime="2062">is About Tracing. </span> <span class="line" data-startTime="2065">So if you open up Chrome, and </span><span class="line" data-startTime="2065">you create a new tab, and you </span><span class="line" data-startTime="2067">type in the address bar About </span><span class="line" data-startTime="2067">Tracing, it will take you to </span><span class="line" data-startTime="2071">this great API here, which </span><span class="line" data-startTime="2071">effectively is an inline </span><span class="line" data-startTime="2074">profiler view of Chrome. </span> <span class="line" data-startTime="2077">So it actually shows you what </span><span class="line" data-startTime="2077">thread is running and what </span><span class="line" data-startTime="2081">blocks of time is </span><span class="line" data-startTime="2081">running there. </span></p>

<p><span class="line" data-startTime="2082">And it allows you to drill down </span><span class="line" data-startTime="2082">to actually get the name </span><span class="line" data-startTime="2085">of the function being called. </span> <span class="line" data-startTime="2087">The best part about this is you </span><span class="line" data-startTime="2087">can actually issue data </span><span class="line" data-startTime="2090">into About Tracing from </span><span class="line" data-startTime="2090">JavaScript or, subsequently, </span><span class="line" data-startTime="2093">Native Client. </span> <span class="line" data-startTime="2094">And the even cooler thing about </span><span class="line" data-startTime="2094">this is see that little </span><span class="line" data-startTime="2097">Load button over there? </span><span class="line" data-startTime="2099">You can write out an </span><span class="line" data-startTime="2099">inline profile. </span> <span class="line" data-startTime="2101">So for those of you who have </span><span class="line" data-startTime="2101">inline profilers that already </span><span class="line" data-startTime="2104">exist in your game, you can </span><span class="line" data-startTime="2104">modify it to output adjacent </span><span class="line" data-startTime="2107">file that matches what this tool </span><span class="line" data-startTime="2107">uses, and use Chrome to </span><span class="line" data-startTime="2112">do all of the profiling </span><span class="line" data-startTime="2112">in your game. </span> <span class="line" data-startTime="2114">It's an entire tool that allows </span><span class="line" data-startTime="2114">you to get all this </span><span class="line" data-startTime="2116">progress and availability </span><span class="line" data-startTime="2116">to you free of charge. </span></p>

<p><span class="line" data-startTime="2118">You don't have to </span><span class="line" data-startTime="2118">write the UI. </span> <span class="line" data-startTime="2119">You don't have to do that. </span> <span class="line" data-startTime="2120">We got a guy dedicated </span><span class="line" data-startTime="2120">to writing this. </span> <span class="line" data-startTime="2122">Use this tool. </span> <span class="line" data-startTime="2122">It's amazing to see. </span> <span class="line" data-startTime="2125">Google Stack. </span> <span class="line" data-startTime="2125">So now we've talked about what </span><span class="line" data-startTime="2125">the ecosystem is and all this </span><span class="line" data-startTime="2128">other stuff. </span> <span class="line" data-startTime="2129">So let's talk about what </span><span class="line" data-startTime="2129">Google can do to </span><span class="line" data-startTime="2130">help you with this. </span> <span class="line" data-startTime="2131">So you've got your game. </span> <span class="line" data-startTime="2133">You can serve your content, your </span><span class="line" data-startTime="2133">database information, off </span><span class="line" data-startTime="2136">of Google App Engine. </span> <span class="line" data-startTime="2137">So this is basically your </span><span class="line" data-startTime="2137">database handling and your </span><span class="line" data-startTime="2140">asset distribution. </span></p>

<p><span class="line" data-startTime="2142">We have the Chrome web store </span><span class="line" data-startTime="2142">that we've already talked </span><span class="line" data-startTime="2144">about and touched on, </span><span class="line" data-startTime="2144">which handles </span><span class="line" data-startTime="2146">distribution and discovery. </span> <span class="line" data-startTime="2147">You also need to install your </span><span class="line" data-startTime="2147">Native Client apps from there </span><span class="line" data-startTime="2149">to white list them. </span> <span class="line" data-startTime="2150">We've got Google Wallet, which </span><span class="line" data-startTime="2150">helps you monetize through </span><span class="line" data-startTime="2153">in-app payments and everything </span><span class="line" data-startTime="2153">else along those lines. </span> <span class="line" data-startTime="2155">Once you've got all that, you're </span><span class="line" data-startTime="2155">eventually going to </span><span class="line" data-startTime="2157">want some sort of social graph, </span><span class="line" data-startTime="2157">so that people can </span><span class="line" data-startTime="2159">detect and move between </span><span class="line" data-startTime="2159">friends and submit </span><span class="line" data-startTime="2161">information. </span> <span class="line" data-startTime="2161">We've got Google+ And then, </span><span class="line" data-startTime="2161">finally, we've got Google </span><span class="line" data-startTime="2164">Analytics, which is an amazingly </span><span class="line" data-startTime="2164">powerful tool that </span><span class="line" data-startTime="2167">allows you to detect what your </span><span class="line" data-startTime="2167">users are doing, how they're </span><span class="line" data-startTime="2170">doing it, and kick off </span><span class="line" data-startTime="2170">events to match that. </span> <span class="line" data-startTime="2173">Now definitely check out my </span><span class="line" data-startTime="2173">other talk today on best </span><span class="line" data-startTime="2176">practices in developing a web </span><span class="line" data-startTime="2176">application to do a deep dive </span><span class="line" data-startTime="2179">on the way to properly use </span><span class="line" data-startTime="2179">these for your web game. </span></p>

<p><span class="line" data-startTime="2182">Check it out, and </span><span class="line" data-startTime="2182">leave comments. </span> <span class="line" data-startTime="2183">I highly appreciate it. </span> <span class="line" data-startTime="2185">That's all for me. </span> <span class="line" data-startTime="2186">Make sure you check out </span><span class="line" data-startTime="2186">gonacl.com for the best </span><span class="line" data-startTime="2188">information available. </span> <span class="line" data-startTime="2189">And then you can find me on all </span><span class="line" data-startTime="2189">of these different places, </span><span class="line" data-startTime="2192">especially </span><span class="line" data-startTime="2192">mainroach.blogspot.com. </span> <span class="line" data-startTime="2194">So, hey, thank you </span><span class="line" data-startTime="2194">for your time. </span> <span class="line" data-startTime="2195">Appreciate your comments. </span> <span class="line" data-startTime="2196">Drop me a line. </span> <span class="line" data-startTime="2197">I'd love to hear from you. </span> <span class="line" data-startTime="2198">Thank you. </span></p></div>