<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>HTML5, CSS3, and DOM Performance</h1>

<h2>Paul Irish</h2>

<a class="video" href="http://youtu.be/q_O9_C2ZjoA">youtu.be/q_O9_C2ZjoA</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="0"><span class="speakerName">Paul Irish</span>: Well, hello. </span> <span class="line" data-startTime="1">My name is Paul Irish, and I </span><span class="line" data-startTime="1">wanted to share some things </span><span class="line" data-startTime="4">with you about performance, </span><span class="line" data-startTime="4">specifically HTML5, CSS3, </span><span class="line" data-startTime="8">DOM-type stuff about </span><span class="line" data-startTime="8">performance, things happening </span><span class="line" data-startTime="12">in the front end, the browser, </span><span class="line" data-startTime="12">things that could be slow and </span><span class="line" data-startTime="15">could be faster. </span> <span class="line" data-startTime="16">And so we're going to talk about </span><span class="line" data-startTime="16">these kind of things. </span> <span class="line" data-startTime="20">First we're going to talk </span><span class="line" data-startTime="20">about reflows, hardware </span><span class="line" data-startTime="23">accelerated CSS, animation, web </span><span class="line" data-startTime="23">workers, benchmarking, and </span><span class="line" data-startTime="27">a little bit about </span><span class="line" data-startTime="27">build scripts. </span> <span class="line" data-startTime="28">Sound good? </span><span class="line" data-startTime="29">Great. </span> <span class="line" data-startTime="30">OK reflows, let's just </span><span class="line" data-startTime="30">look at this diagram. </span> <span class="line" data-startTime="38">This is a diagram put together </span><span class="line" data-startTime="38">by Stoyan Stefanov. </span> <span class="line" data-startTime="42">When we're talking about </span><span class="line" data-startTime="42">reflows, we're talking about </span><span class="line" data-startTime="44">the render tree. </span> <span class="line" data-startTime="45">That's the really </span><span class="line" data-startTime="45">important part. </span></p>

<p><span class="line" data-startTime="46">And the render tree </span><span class="line" data-startTime="46">is made from &mdash; </span><span class="line" data-startTime="49">well, it comes from two </span><span class="line" data-startTime="49">different things. </span> <span class="line" data-startTime="51">So we have the DOM tree. </span> <span class="line" data-startTime="53">The DOM tree is the result after </span><span class="line" data-startTime="53">you tokenize and parse </span><span class="line" data-startTime="58">your HTML markup. </span> <span class="line" data-startTime="59">It gets parsed into the DOM. </span> <span class="line" data-startTime="60">And that's what you see in </span><span class="line" data-startTime="60">Chrome Developer Tools or </span><span class="line" data-startTime="63">Firebug, all the elements, </span><span class="line" data-startTime="63">right? </span><span class="line" data-startTime="65">Of course. </span> <span class="line" data-startTime="66">At the same time, we have </span><span class="line" data-startTime="66">styles coming in. </span> <span class="line" data-startTime="68">And so we have styles coming </span><span class="line" data-startTime="68">in from the style </span><span class="line" data-startTime="69">sheets and so on. </span> <span class="line" data-startTime="70">And when those two combine, </span><span class="line" data-startTime="70">we get the render tree. </span> <span class="line" data-startTime="74">And the difference between the </span><span class="line" data-startTime="74">DOM tree and the render tree </span><span class="line" data-startTime="77">is that the render tree &mdash; </span><span class="line" data-startTime="80">let's say that we have an </span><span class="line" data-startTime="80">element that is display:none. </span></p>

<p><span class="line" data-startTime="83">Not present in the </span><span class="line" data-startTime="83">render tree. </span> <span class="line" data-startTime="84">So it's in the DOM tree, but </span><span class="line" data-startTime="84">it's not in the render tree </span><span class="line" data-startTime="86">because we don't see it. </span> <span class="line" data-startTime="88">It's just not even there. </span> <span class="line" data-startTime="89">Or if we manipulate the window </span><span class="line" data-startTime="89">size or change the font size, </span><span class="line" data-startTime="94">the full-page zoom, that, of </span><span class="line" data-startTime="94">course, changes the render </span><span class="line" data-startTime="98">tree most of the time, whereas </span><span class="line" data-startTime="98">the DOM probably is staying </span><span class="line" data-startTime="101">the exact same. </span> <span class="line" data-startTime="103">So the render tree is what </span><span class="line" data-startTime="103">you see, and the DOM </span><span class="line" data-startTime="105">is underneath it. </span> <span class="line" data-startTime="108">A reflow is a change that </span><span class="line" data-startTime="108">necessitates a recalculation </span><span class="line" data-startTime="114">of the render tree. </span> <span class="line" data-startTime="115">And it might recalculate just </span><span class="line" data-startTime="115">the very bottom of it. </span></p>

<p><span class="line" data-startTime="118">But it might recalculate </span><span class="line" data-startTime="118">the entire thing. </span> <span class="line" data-startTime="121">And reflows can be cheap. </span> <span class="line" data-startTime="124">But at the same time, they </span><span class="line" data-startTime="124">can be expensive. </span> <span class="line" data-startTime="126">Specifically on mobile devices </span><span class="line" data-startTime="126">or old IE, they can be quite </span><span class="line" data-startTime="131">expensive, and you don't </span><span class="line" data-startTime="131">want to do a reflow if </span><span class="line" data-startTime="134">you don't have to. </span> <span class="line" data-startTime="135">And there's ways </span><span class="line" data-startTime="135">to avoid them. </span> <span class="line" data-startTime="137">So first, well, let </span><span class="line" data-startTime="137">me show you this. </span> <span class="line" data-startTime="143">This right here &mdash; </span><span class="line" data-startTime="145">ah, this is so cool. </span> <span class="line" data-startTime="146">This is a debug version </span><span class="line" data-startTime="146">of Firefox, I believe. </span> <span class="line" data-startTime="153">And it's actually laying out </span><span class="line" data-startTime="153">the mozilla.org homepage, </span><span class="line" data-startTime="158">calculating the layout and the </span><span class="line" data-startTime="158">position of absolutely </span><span class="line" data-startTime="160">everything. </span> <span class="line" data-startTime="162">This is awesome. </span> <span class="line" data-startTime="164">It figured out where </span><span class="line" data-startTime="164">it all goes. </span> <span class="line" data-startTime="166">And then once it's all done and </span><span class="line" data-startTime="166">the browser's figured out </span><span class="line" data-startTime="168">it, there we go. </span> <span class="line" data-startTime="170">Pretty cool. </span> <span class="line" data-startTime="171">But let me show you this </span><span class="line" data-startTime="171">one part in here. </span></p>

<p><span class="line" data-startTime="174">It's right about here &mdash; </span><span class="line" data-startTime="177">finish off the footer. </span> <span class="line" data-startTime="178">And then all of a sudden, </span><span class="line" data-startTime="178">something happens. </span> <span class="line" data-startTime="181">And then it has to recalculate </span><span class="line" data-startTime="181">the whole </span><span class="line" data-startTime="183">thing all over again. </span> <span class="line" data-startTime="184">And I don't know why </span><span class="line" data-startTime="184">that happened, but </span><span class="line" data-startTime="188">it didn't need to. </span> <span class="line" data-startTime="189">And we were basically </span><span class="line" data-startTime="189">done at this point. </span> <span class="line" data-startTime="192">And now we have to wait another </span><span class="line" data-startTime="192">30% of our time so </span><span class="line" data-startTime="195">that it can recalculate the </span><span class="line" data-startTime="195">layout of absolutely </span><span class="line" data-startTime="197">everything when it should </span><span class="line" data-startTime="197">have been done. </span> <span class="line" data-startTime="200">And so this is the kind of thing </span><span class="line" data-startTime="200">that we want to avoid. </span> <span class="line" data-startTime="203">We don't want to have a full </span><span class="line" data-startTime="203">page reflow that invalidates </span><span class="line" data-startTime="207">the entire render tree. </span> <span class="line" data-startTime="209">We want to get that finalized </span><span class="line" data-startTime="209">render tree out to the user as </span><span class="line" data-startTime="213">fast as possible so that they </span><span class="line" data-startTime="213">can interact with your DOM. </span> <span class="line" data-startTime="218">So what causes reflows? </span><span class="line" data-startTime="221">A lot of people have wondered. </span> <span class="line" data-startTime="222">And a lot of people have </span><span class="line" data-startTime="222">thought, well, checking the </span><span class="line" data-startTime="226">element.offsetWidth is </span><span class="line" data-startTime="226">normally the trick. </span> <span class="line" data-startTime="230">But Tony G. On the Chrome </span><span class="line" data-startTime="230">team dug into this and </span><span class="line" data-startTime="234">tried to answer it. </span> <span class="line" data-startTime="235">So Tony dug in, just opened up </span><span class="line" data-startTime="235">Google Code Search and looked </span><span class="line" data-startTime="242">for Update Layout, Ignore </span><span class="line" data-startTime="242">Pending Style Sheets &mdash; </span><span class="line" data-startTime="246">and this is essentially what </span><span class="line" data-startTime="246">does a reflow in WebKit &mdash; </span><span class="line" data-startTime="252">and found all these items, and </span><span class="line" data-startTime="252">then just listed them out. </span></p>

<p><span class="line" data-startTime="257">So what we get is this. </span> <span class="line" data-startTime="259">These are all the properties </span><span class="line" data-startTime="259">and methods that </span><span class="line" data-startTime="262">will cause a reflow. </span> <span class="line" data-startTime="264">And so the offsetWidth, which </span><span class="line" data-startTime="264">is kind of the one that most </span><span class="line" data-startTime="268">people know, that's </span><span class="line" data-startTime="268">certainly here. </span> <span class="line" data-startTime="272">But there's a lot </span><span class="line" data-startTime="272">of other ones. </span> <span class="line" data-startTime="274">And interestingly, innerText </span><span class="line" data-startTime="274">appears to cause a reflow </span><span class="line" data-startTime="277">whereas innerHTML does not. </span> <span class="line" data-startTime="279">I'm not exactly sure </span><span class="line" data-startTime="279">about that. </span> <span class="line" data-startTime="283">scrollTo on the window does. </span> <span class="line" data-startTime="287">So these are all the things </span><span class="line" data-startTime="287">that by calling, you would </span><span class="line" data-startTime="290">trigger a reflow. </span> <span class="line" data-startTime="292">But what are the kind of </span><span class="line" data-startTime="292">typical operations </span><span class="line" data-startTime="294">that would do it? </span><span class="line" data-startTime="296">Of course, manipulating the DOM </span><span class="line" data-startTime="296">tree is definitely going </span><span class="line" data-startTime="299">to cause a reflow. </span> <span class="line" data-startTime="301">Yeah, definitely. </span> <span class="line" data-startTime="304">If you hide a DOM node with </span><span class="line" data-startTime="304">display:none, that will </span><span class="line" data-startTime="309">manipulate the render tree. </span></p>

<p><span class="line" data-startTime="309">It will cause a reflow. </span> <span class="line" data-startTime="311">But then any changes to </span><span class="line" data-startTime="311">that element once it's </span><span class="line" data-startTime="314">display:noned won't. </span> <span class="line" data-startTime="317">Whereas over with </span><span class="line" data-startTime="317">visibility:hidden, if you just </span><span class="line" data-startTime="322">take an element, </span><span class="line" data-startTime="322">visibility:hidden it, there's </span><span class="line" data-startTime="325">no recalculation of the page. </span> <span class="line" data-startTime="328">The geometry of the page </span><span class="line" data-startTime="328">stays the same. </span> <span class="line" data-startTime="330">So actually there's no reflow. </span> <span class="line" data-startTime="331">We just repaint that one little </span><span class="line" data-startTime="331">box and keep going. </span> <span class="line" data-startTime="336">If we're animating anything </span><span class="line" data-startTime="336">across the page, of course </span><span class="line" data-startTime="338">we're doing reflows. </span> <span class="line" data-startTime="339">It depends on maybe you could </span><span class="line" data-startTime="339">overflow:hidden it, a </span><span class="line" data-startTime="344">container, so that it's kind of </span><span class="line" data-startTime="344">encapsulated a little bit. </span> <span class="line" data-startTime="348">Adding new styles, and then any </span><span class="line" data-startTime="348">sort of user interaction </span><span class="line" data-startTime="351">like resizing the window, </span><span class="line" data-startTime="351">changing the font size, even </span><span class="line" data-startTime="354">scrolling causes reflows. </span></p>

<p><span class="line" data-startTime="358">So here's a little example about </span><span class="line" data-startTime="358">a small optimization </span><span class="line" data-startTime="362">that you could do to avoid </span><span class="line" data-startTime="362">causing excess reflows. </span> <span class="line" data-startTime="366">So what we're doing, this is </span><span class="line" data-startTime="366">just some simple little jQuery </span><span class="line" data-startTime="370">code, right? </span><span class="line" data-startTime="371">We are grabbing an element, and </span><span class="line" data-startTime="371">we're just grabbing the </span><span class="line" data-startTime="373">left style property off of it. </span> <span class="line" data-startTime="375">And then we're going to take </span><span class="line" data-startTime="375">that left and apply it to </span><span class="line" data-startTime="377">something else. </span> <span class="line" data-startTime="378">And then we have to do that </span><span class="line" data-startTime="378">to another one as well. </span> <span class="line" data-startTime="380">So we get it here, set it, </span><span class="line" data-startTime="380">get it here, and set it. </span> <span class="line" data-startTime="385">The problem here is that </span><span class="line" data-startTime="385">actually checking our style </span><span class="line" data-startTime="388">property is going to trigger </span><span class="line" data-startTime="388">a recalculation of </span><span class="line" data-startTime="392">the styles in a reflow. </span> <span class="line" data-startTime="394">And because we set something </span><span class="line" data-startTime="394">here, it has to </span><span class="line" data-startTime="397">do it all over again. </span> <span class="line" data-startTime="398">So a way to avoid this is we </span><span class="line" data-startTime="398">can just bunch our gets </span><span class="line" data-startTime="403">together and then our </span><span class="line" data-startTime="403">sets together. </span></p>

<p><span class="line" data-startTime="406">I'll show you. </span> <span class="line" data-startTime="407">This is kind of what it looks </span><span class="line" data-startTime="407">like over in the Chrome Dev </span><span class="line" data-startTime="412">Tools Timeline view. </span> <span class="line" data-startTime="415">So here we are. </span> <span class="line" data-startTime="416">We have Recalculate </span><span class="line" data-startTime="416">Style and Layout. </span> <span class="line" data-startTime="417">And these kind of go together. </span> <span class="line" data-startTime="419">Recalculate Style is essentially </span><span class="line" data-startTime="419">the prerequisite </span><span class="line" data-startTime="422">for a reflow. </span> <span class="line" data-startTime="423">In WebKit and in other </span><span class="line" data-startTime="423">browsers, a </span><span class="line" data-startTime="425">reflow is called a layout. </span> <span class="line" data-startTime="428">Mozilla uses the term </span><span class="line" data-startTime="428">"reflow." It's just </span><span class="line" data-startTime="430">terminology really. </span> <span class="line" data-startTime="432">What you'll see here is that in </span><span class="line" data-startTime="432">that first example, we kind </span><span class="line" data-startTime="436">of do this thing twice before </span><span class="line" data-startTime="436">we're able to paint out what </span><span class="line" data-startTime="439">the changes are. </span> <span class="line" data-startTime="440">Whereas in the second one when </span><span class="line" data-startTime="440">we bunch them together, we can </span><span class="line" data-startTime="443">get away with just doing </span><span class="line" data-startTime="443">a single reflow </span><span class="line" data-startTime="446">before we're all set. </span></p>

<p><span class="line" data-startTime="447">And then we can paint it out. </span> <span class="line" data-startTime="449">And I will point out the scale </span><span class="line" data-startTime="449">looks a little weird here. </span> <span class="line" data-startTime="451">But we finished the second time </span><span class="line" data-startTime="451">at about 3 milliseconds. </span> <span class="line" data-startTime="455">Whereas the first time we </span><span class="line" data-startTime="455">finished maybe about 4 to 4 </span><span class="line" data-startTime="459">and a 1/2 milliseconds. </span> <span class="line" data-startTime="461">So the third one, in addition </span><span class="line" data-startTime="461">to having less reflows, is </span><span class="line" data-startTime="465">actually indeed faster. </span> <span class="line" data-startTime="469">So there's a few strategies </span><span class="line" data-startTime="469">for avoiding reflows. </span> <span class="line" data-startTime="473">The first is batching your </span><span class="line" data-startTime="473">DOM changes together </span><span class="line" data-startTime="475">like we just did. </span> <span class="line" data-startTime="477">Other ways we can do it is you </span><span class="line" data-startTime="477">can clone the existing </span><span class="line" data-startTime="480">element, work off DOM with </span><span class="line" data-startTime="480">that element, and then &mdash; </span><span class="line" data-startTime="486">because any manipulations while </span><span class="line" data-startTime="486">it's off DOM are not </span><span class="line" data-startTime="489">going to cause a reflow. </span> <span class="line" data-startTime="490">And then once you're done </span><span class="line" data-startTime="490">manipulating it, you can </span><span class="line" data-startTime="492">replace that one that was </span><span class="line" data-startTime="492">already there and check the </span><span class="line" data-startTime="494">new one in. </span></p>

<p><span class="line" data-startTime="497">If you hide anything with </span><span class="line" data-startTime="497">display:none, it </span><span class="line" data-startTime="499">will cause a reflow. </span> <span class="line" data-startTime="501">But if you then manipulate it, </span><span class="line" data-startTime="501">all those manipulations while </span><span class="line" data-startTime="504">it's display:none will not cause </span><span class="line" data-startTime="504">reflows, except in IE. </span> <span class="line" data-startTime="517">However, you can take </span><span class="line" data-startTime="517">an element. </span> <span class="line" data-startTime="520">Instead of doing display:none, </span><span class="line" data-startTime="520">you can just take it off DOM, </span><span class="line" data-startTime="522">hold it in documentFragment, </span><span class="line" data-startTime="522">do your manipulations in </span><span class="line" data-startTime="525">documentFragment, and then put </span><span class="line" data-startTime="525">it back in when you're done. </span> <span class="line" data-startTime="531">You only get the reflow when </span><span class="line" data-startTime="531">you are manipulating the </span><span class="line" data-startTime="536">actual DOM. </span> <span class="line" data-startTime="537">And when things are off </span><span class="line" data-startTime="537">DOM, you're fine. </span> <span class="line" data-startTime="538">So that one you're fine in </span><span class="line" data-startTime="538">IE and everywhere else. </span></p>

<p><span class="line" data-startTime="542">Cool? </span><span class="line" data-startTime="543">OK, there's a few more resources </span><span class="line" data-startTime="543">I would like you to </span><span class="line" data-startTime="547">just check out if you're </span><span class="line" data-startTime="547">into this stuff. </span> <span class="line" data-startTime="549">Stoyan Stefanov has done </span><span class="line" data-startTime="549">a lot of research </span><span class="line" data-startTime="551">on reflows and repaints. </span> <span class="line" data-startTime="553">and so he's got some </span><span class="line" data-startTime="553">great stuff here. </span> <span class="line" data-startTime="556">BrowserScope has a few tests to </span><span class="line" data-startTime="556">see what triggers reflows. </span> <span class="line" data-startTime="561">Like we were just seeing, </span><span class="line" data-startTime="561">there's a lot of small details </span><span class="line" data-startTime="563">that are different </span><span class="line" data-startTime="563">across browsers. </span> <span class="line" data-startTime="565">David Baron had a really great </span><span class="line" data-startTime="565">Google Tech Talk about browser </span><span class="line" data-startTime="570">internals and specifically </span><span class="line" data-startTime="570">aiming that talk at web </span><span class="line" data-startTime="574">developers. </span> <span class="line" data-startTime="575">And so this is, I think, an </span><span class="line" data-startTime="575">hour-long talk that you </span><span class="line" data-startTime="578">should check out. </span></p>

<p><span class="line" data-startTime="579">And WebKit, about five years </span><span class="line" data-startTime="579">ago, did a five-part series </span><span class="line" data-startTime="584">about how rendering works. </span> <span class="line" data-startTime="585">And it's so cool. </span> <span class="line" data-startTime="587">It's from five years ago. </span> <span class="line" data-startTime="588">But it's totally </span><span class="line" data-startTime="588">relevant today. </span> <span class="line" data-startTime="589">I definitely recommend </span><span class="line" data-startTime="589">checking that out. </span> <span class="line" data-startTime="593">OK, I think we're done </span><span class="line" data-startTime="593">with reflow. </span> <span class="line" data-startTime="594">Let's move on. </span> <span class="line" data-startTime="596">Hardware accelerated </span><span class="line" data-startTime="596">CSS, yeah. </span> <span class="line" data-startTime="600">All right, getting into </span><span class="line" data-startTime="600">some sexy here. </span> <span class="line" data-startTime="602">So we're just going to skip </span><span class="line" data-startTime="602">right into the demo. </span> <span class="line" data-startTime="606">This is Isotope by </span><span class="line" data-startTime="606">David DeSandro. </span> <span class="line" data-startTime="611">Let's see, I'm going to change </span><span class="line" data-startTime="611">the sort a little bit. </span></p>

<p><span class="line" data-startTime="615">And then I'm going to insert </span><span class="line" data-startTime="615">some new elements. </span> <span class="line" data-startTime="620">Click around here. </span> <span class="line" data-startTime="622">Yeah, like this. </span> <span class="line" data-startTime="622">This is good. </span> <span class="line" data-startTime="625">Even resize the window, and that </span><span class="line" data-startTime="625">responds really nicely. </span> <span class="line" data-startTime="629">So what's actually happening </span><span class="line" data-startTime="629">here is that we're actually </span><span class="line" data-startTime="635">using CSS transitions and CSS </span><span class="line" data-startTime="637">transforms to do these changes. </span> <span class="line" data-startTime="640">Now, normally you might think </span><span class="line" data-startTime="640">you're going to manipulate the </span><span class="line" data-startTime="642">position of where things go. </span> <span class="line" data-startTime="644">And you'll probably be like, </span><span class="line" data-startTime="644">oh, it'll be absolutely </span><span class="line" data-startTime="646">positioned. </span> <span class="line" data-startTime="647">And then I'll just manipulate </span><span class="line" data-startTime="647">left and top and tell it where </span><span class="line" data-startTime="649">it's going to go now. </span> <span class="line" data-startTime="651">The trick here is that </span><span class="line" data-startTime="651">we're actually using </span><span class="line" data-startTime="653">2D transforms translate. </span> <span class="line" data-startTime="655">So we're using </span><span class="line" data-startTime="655">webkit-transform:translate, </span><span class="line" data-startTime="657">and then we're just changing </span><span class="line" data-startTime="657">the x and y of translate. </span></p>

<p><span class="line" data-startTime="662">Then we're also using </span><span class="line" data-startTime="662">a CSS transition. </span> <span class="line" data-startTime="668">And as a result, we're able to </span><span class="line" data-startTime="668">get all these operations </span><span class="line" data-startTime="674">hardware accelerated, which </span><span class="line" data-startTime="674">means super-high frame rates, </span><span class="line" data-startTime="678">really high-fidelity animations, </span><span class="line" data-startTime="678">and they look </span><span class="line" data-startTime="680">basically as good as they can. </span> <span class="line" data-startTime="682">You're writing it in a </span><span class="line" data-startTime="682">declarative way so that the </span><span class="line" data-startTime="684">browser can be like, oh, </span><span class="line" data-startTime="684">yeah, I got this. </span> <span class="line" data-startTime="687">Let me take this. </span> <span class="line" data-startTime="687">I'm going to take this down to </span><span class="line" data-startTime="687">my friend the GPU and optimize </span><span class="line" data-startTime="690">this for you. </span> <span class="line" data-startTime="691">And so it's going to </span><span class="line" data-startTime="691">look really good. </span> <span class="line" data-startTime="694">The cool thing here in Isotope </span><span class="line" data-startTime="694">is that David wrote it in a </span><span class="line" data-startTime="697">way that it can detect support </span><span class="line" data-startTime="697">for transforms and </span><span class="line" data-startTime="701">transitions. </span></p>

<p><span class="line" data-startTime="702">And if there's not support, </span><span class="line" data-startTime="702">then it'll go back to a </span><span class="line" data-startTime="704">jQuery-based animation style. </span> <span class="line" data-startTime="707">So if your browser is new and </span><span class="line" data-startTime="707">good, we're going to do the </span><span class="line" data-startTime="709">right thing. </span> <span class="line" data-startTime="710">And if it's a bit older, it'll </span><span class="line" data-startTime="710">still look OK, but not as high </span><span class="line" data-startTime="715">fidelity as possible. </span> <span class="line" data-startTime="717">So this is kind of the power </span><span class="line" data-startTime="717">of animations of </span><span class="line" data-startTime="722">hardware-accelerated CSS. </span> <span class="line" data-startTime="726">Now, those were 2D transforms, </span><span class="line" data-startTime="726">and everything was just moving </span><span class="line" data-startTime="731">around on a 2D plane. </span> <span class="line" data-startTime="733">And normally, 2D transforms and </span><span class="line" data-startTime="733">operations on the 2D plane </span><span class="line" data-startTime="738">don't get hardware-accelerated </span><span class="line" data-startTime="738">by browsers and by WebKit </span><span class="line" data-startTime="742">specifically. </span> <span class="line" data-startTime="744">But there's a trick. </span></p>

<p><span class="line" data-startTime="745">And there's a trick to make </span><span class="line" data-startTime="745">the browser do it. </span> <span class="line" data-startTime="748">Let me show this clip </span><span class="line" data-startTime="748">from Remy Sharp. </span> <span class="line" data-startTime="752">[VIDEO PLAYBACK] </span><span class="line" data-startTime="752">-OK what I'm about to show </span><span class="line" data-startTime="752">you is a CSS animation. </span> <span class="line" data-startTime="757">And it's engaged using </span><span class="line" data-startTime="757">JavaScript and just the normal </span><span class="line" data-startTime="761">touch gestures. </span> <span class="line" data-startTime="762">But the first effect I'm going </span><span class="line" data-startTime="762">to show you now is one without </span><span class="line" data-startTime="766">a 3D transform. </span> <span class="line" data-startTime="768">So this is just doing a scale </span><span class="line" data-startTime="768">and nothing else. </span> <span class="line" data-startTime="773">And you see it's just </span><span class="line" data-startTime="773">a little bit jumpy. </span> <span class="line" data-startTime="774">That's the actual animation </span><span class="line" data-startTime="774">jumping. </span></p>

<p><span class="line" data-startTime="777">And if I show you the same </span><span class="line" data-startTime="777">version but just with the </span><span class="line" data-startTime="781">translate3d set on the element </span><span class="line" data-startTime="781">that I'm zooming, you can see </span><span class="line" data-startTime="785">it's completely smooth. </span> <span class="line" data-startTime="786">And all I've done is </span><span class="line" data-startTime="786">said the image &mdash; </span><span class="line" data-startTime="789">so the image element that I'm </span><span class="line" data-startTime="789">pinching and zooming on, I've </span><span class="line" data-startTime="792">just added a CSS property </span><span class="line" data-startTime="792">to say translate 3D. </span> <span class="line" data-startTime="794">[END VIDEO PLAYBACK] </span><span class="line" data-startTime="795">Yeah, so that's it. </span> <span class="line" data-startTime="799">It's kind of a total hack. </span> <span class="line" data-startTime="801">You can use either WebKit </span><span class="line" data-startTime="801">transform, translateZ(0) or do </span><span class="line" data-startTime="806">translate3d. </span> <span class="line" data-startTime="807">Depending on your use case, one </span><span class="line" data-startTime="807">will probably make more </span><span class="line" data-startTime="809">sense for you. </span> <span class="line" data-startTime="813">And all of a sudden, the </span><span class="line" data-startTime="813">browser's like, oh, cool. </span></p>

<p><span class="line" data-startTime="816">Let's throw this on the GPU. </span> <span class="line" data-startTime="819">And as a result, we can get </span><span class="line" data-startTime="819">much higher-fidelity </span><span class="line" data-startTime="823">manipulation on the 2D </span><span class="line" data-startTime="823">plane, just like </span><span class="line" data-startTime="826">we saw in this video. </span> <span class="line" data-startTime="827">It's pretty cool. </span> <span class="line" data-startTime="829">There's a few really good ways </span><span class="line" data-startTime="829">when you're working with this </span><span class="line" data-startTime="833">kind of stuff to debug it </span><span class="line" data-startTime="833">a little bit better. </span> <span class="line" data-startTime="835">Over in Safari, there's a </span><span class="line" data-startTime="835">development flag to turn on </span><span class="line" data-startTime="841">some colors. </span> <span class="line" data-startTime="842">This actually stands </span><span class="line" data-startTime="842">for core animation. </span> <span class="line" data-startTime="844">I'm going to load this up over </span><span class="line" data-startTime="844">the iPhone simulator. </span> <span class="line" data-startTime="849">And I'm actually going </span><span class="line" data-startTime="849">to load this page. </span> <span class="line" data-startTime="852">This is a tutorial on HTML5Rocks </span><span class="line" data-startTime="852">by Malte Ubl. </span> <span class="line" data-startTime="856">And we're going to show </span><span class="line" data-startTime="856">this little demo here. </span></p>

<p><span class="line" data-startTime="859">And what we're actually doing is </span><span class="line" data-startTime="859">we're detecting support for </span><span class="line" data-startTime="862">CSS transitions and </span><span class="line" data-startTime="862">transforms. </span> <span class="line" data-startTime="863">And if we have support, we're </span><span class="line" data-startTime="863">just going to use a transform </span><span class="line" data-startTime="867">along with the transition. </span> <span class="line" data-startTime="868">Otherwise, we use </span><span class="line" data-startTime="868">jQuery animate. </span> <span class="line" data-startTime="870">So here in Chrome, we're using </span><span class="line" data-startTime="870">a transition transform. </span> <span class="line" data-startTime="874">And you see that moves </span><span class="line" data-startTime="874">across the screen. </span> <span class="line" data-startTime="877">I'm going to show this in </span><span class="line" data-startTime="877">the iPhone simulator. </span> <span class="line" data-startTime="882">You can see the OS </span><span class="line" data-startTime="882">is accelerated. </span> <span class="line" data-startTime="888">Scroll down, here we go. </span> <span class="line" data-startTime="891">So I'm just going to click. </span> <span class="line" data-startTime="892">And you'll see &mdash; yeah. </span> <span class="line" data-startTime="898">And the trick here is that </span><span class="line" data-startTime="898">we actually use that </span><span class="line" data-startTime="902">translateZ(0) &mdash; </span><span class="line" data-startTime="904">we call it the silver </span><span class="line" data-startTime="904">bullet here &mdash; </span><span class="line" data-startTime="907">trick to make that hardware </span><span class="line" data-startTime="907">acceleration happen. </span> <span class="line" data-startTime="915">Over in Chrome, we have a </span><span class="line" data-startTime="915">somewhat similar thing. </span></p>

<p><span class="line" data-startTime="919">Over in about:flags, we </span><span class="line" data-startTime="919">have this setting. </span> <span class="line" data-startTime="922">And let me bring this up. </span> <span class="line" data-startTime="924">In about:flags, there's a bunch </span><span class="line" data-startTime="924">of really crazy stuff. </span> <span class="line" data-startTime="927">I recommend you dig into </span><span class="line" data-startTime="927">this some time. </span> <span class="line" data-startTime="929">We have composited render </span><span class="line" data-startTime="929">layer borders. </span> <span class="line" data-startTime="932">And well, let me just show </span><span class="line" data-startTime="932">you what it does. </span> <span class="line" data-startTime="936">Here's this presentation that </span><span class="line" data-startTime="936">we've been looking at but with </span><span class="line" data-startTime="939">this setting turned on. </span> <span class="line" data-startTime="943">And you can see we get borders </span><span class="line" data-startTime="943">around of all the layers that </span><span class="line" data-startTime="947">are composited. </span> <span class="line" data-startTime="949">Pretty cool. </span> <span class="line" data-startTime="952">So this helps a lot to just </span><span class="line" data-startTime="952">verify that yes, this actually </span><span class="line" data-startTime="955">is being composited </span><span class="line" data-startTime="955">on the GPU. </span></p>

<p><span class="line" data-startTime="958">And then also in this 3D case, </span><span class="line" data-startTime="958">we have a nice little debug </span><span class="line" data-startTime="962">view of what's going on. </span> <span class="line" data-startTime="964">I will point out that this </span><span class="line" data-startTime="964">used to happen as a </span><span class="line" data-startTime="968">command line flag. </span> <span class="line" data-startTime="970">So it didn't used to be nice and </span><span class="line" data-startTime="970">handy in this about:flags. </span> <span class="line" data-startTime="972">But yes, it used to have to run </span><span class="line" data-startTime="972">the Chrome executable with </span><span class="line" data-startTime="976">a command line flag. </span> <span class="line" data-startTime="977">And this page over on Peter </span><span class="line" data-startTime="977">Beverloo's site maintains a </span><span class="line" data-startTime="980">list of all the active command </span><span class="line" data-startTime="980">line switches or flags. </span> <span class="line" data-startTime="985">And so I recommend you </span><span class="line" data-startTime="985">checking this out. </span> <span class="line" data-startTime="987">One of the ones in here </span><span class="line" data-startTime="987">is a show-paint-rects. </span> <span class="line" data-startTime="991">And so this actually draws </span><span class="line" data-startTime="991">little borders whenever a </span><span class="line" data-startTime="994">section of the DOM </span><span class="line" data-startTime="994">gets repainted. </span></p>

<p><span class="line" data-startTime="998">Why that's interesting is </span><span class="line" data-startTime="998">because you want to know &mdash; </span><span class="line" data-startTime="1000">kind of when we were talking </span><span class="line" data-startTime="1000">about reflows, you want to </span><span class="line" data-startTime="1002">know exactly how much of the </span><span class="line" data-startTime="1002">DOM is being invalidated or </span><span class="line" data-startTime="1006">the render tree is </span><span class="line" data-startTime="1006">being invalidated </span><span class="line" data-startTime="1008">when there's a change. </span> <span class="line" data-startTime="1009">And so with show-paint-rects, </span><span class="line" data-startTime="1009">you can see that when you make </span><span class="line" data-startTime="1012">a change, only the part that </span><span class="line" data-startTime="1012">needs to be recalculated and </span><span class="line" data-startTime="1015">repainted is being changed </span><span class="line" data-startTime="1015">rather than a much larger </span><span class="line" data-startTime="1018">chunk, which would be </span><span class="line" data-startTime="1018">kind of unexpected. </span> <span class="line" data-startTime="1020">So show-paint-rects is another </span><span class="line" data-startTime="1020">very helpful flag to use when </span><span class="line" data-startTime="1025">you're debugging some of this </span><span class="line" data-startTime="1025">advanced rendering stuff. </span> <span class="line" data-startTime="1039">This tutorial has a number of </span><span class="line" data-startTime="1039">other recommendations around </span><span class="line" data-startTime="1044">graphics optimizations that </span><span class="line" data-startTime="1044">you can make and also digs </span><span class="line" data-startTime="1049">into JavaScript profiling. </span></p>

<p><span class="line" data-startTime="1050">So dig into that a little bit </span><span class="line" data-startTime="1050">more if you're looking to eek </span><span class="line" data-startTime="1053">out some better performance of </span><span class="line" data-startTime="1053">your HTML5 app and these </span><span class="line" data-startTime="1056">recommendations are not </span><span class="line" data-startTime="1056">good enough for you. </span> <span class="line" data-startTime="1059">But next we're going to dig into </span><span class="line" data-startTime="1059">requestAnimationFrame. </span> <span class="line" data-startTime="1062">So requestAnimationFrame </span><span class="line" data-startTime="1062">basically came about because </span><span class="line" data-startTime="1068">browsers were like, hey, we </span><span class="line" data-startTime="1068">know that you're doing </span><span class="line" data-startTime="1073">animation in the browser. </span> <span class="line" data-startTime="1074">And we know that you're just </span><span class="line" data-startTime="1074">abusing setTimeout and </span><span class="line" data-startTime="1077">setInterval loops to do it. </span> <span class="line" data-startTime="1080">And that's not cool. </span> <span class="line" data-startTime="1083">It's not really cool. </span> <span class="line" data-startTime="1085">Because you know what? </span><span class="line" data-startTime="1085">A browser can optimize animation </span><span class="line" data-startTime="1085">better than you </span><span class="line" data-startTime="1090">writing a setInterval loop, just </span><span class="line" data-startTime="1090">trying to peg the CPU as </span><span class="line" data-startTime="1094">fast as it will go. </span></p>

<p><span class="line" data-startTime="1095">Browser is smarter. </span> <span class="line" data-startTime="1097">So one of the things that it can </span><span class="line" data-startTime="1097">do is it can batch things </span><span class="line" data-startTime="1102">into a single reflow </span><span class="line" data-startTime="1102">and repaint cycle. </span> <span class="line" data-startTime="1104">So let's say that you had a </span><span class="line" data-startTime="1104">JavaScript-based animation. </span> <span class="line" data-startTime="1109">You had an absolute position </span><span class="line" data-startTime="1109">element, and you're updating </span><span class="line" data-startTime="1111">the left and top or something </span><span class="line" data-startTime="1111">like that. </span> <span class="line" data-startTime="1114">The browser can now synchronize </span><span class="line" data-startTime="1114">that along with </span><span class="line" data-startTime="1116">the concurrently running </span><span class="line" data-startTime="1116">CSS transition. </span> <span class="line" data-startTime="1118">Or if you had some SVG SMIL </span><span class="line" data-startTime="1118">animation running at the same </span><span class="line" data-startTime="1122">time, it can kind of make sure </span><span class="line" data-startTime="1122">that those are all going at </span><span class="line" data-startTime="1124">the same time. </span> <span class="line" data-startTime="1127">It's going to optimize it for 60 </span><span class="line" data-startTime="1127">frames per second, which is </span><span class="line" data-startTime="1131">the refresh rate of </span><span class="line" data-startTime="1131">most displays. </span> <span class="line" data-startTime="1134">And so you're going to get the </span><span class="line" data-startTime="1134">best frame rate possible. </span></p>

<p><span class="line" data-startTime="1136">60 Hertz is kind of the perfect </span><span class="line" data-startTime="1136">target for everything </span><span class="line" data-startTime="1141">that you want going </span><span class="line" data-startTime="1141">on in the browser. </span> <span class="line" data-startTime="1143">And the really cool thing is </span><span class="line" data-startTime="1143">that you're really friendly to </span><span class="line" data-startTime="1147">your users' batteries. </span> <span class="line" data-startTime="1151">Because what happens is that if </span><span class="line" data-startTime="1151">the tab is not visible, it </span><span class="line" data-startTime="1157">gets skipped. </span> <span class="line" data-startTime="1158">So let me load this </span><span class="line" data-startTime="1158">up right here. </span> <span class="line" data-startTime="1161">This is a &mdash; </span><span class="line" data-startTime="1163">whoa! </span><span class="line" data-startTime="1171">Yeah, OK, here we go. </span> <span class="line" data-startTime="1173">So we got this WebGL demo. </span> <span class="line" data-startTime="1176">And you see here we got a lot </span><span class="line" data-startTime="1176">of action over on the GPU. </span> <span class="line" data-startTime="1181">And this is the JavaScript </span><span class="line" data-startTime="1181">running inside this page. </span> <span class="line" data-startTime="1184">It's pretty heavy. </span> <span class="line" data-startTime="1188">Gonna move this around. </span> <span class="line" data-startTime="1189">Now I'm just going to switch </span><span class="line" data-startTime="1189">to another tab. </span> <span class="line" data-startTime="1194">You see that instantly </span><span class="line" data-startTime="1194">dropped. </span> <span class="line" data-startTime="1200">Because the </span><span class="line" data-startTime="1200">requestAnimationFrame is being </span><span class="line" data-startTime="1201">used, the browser is like, </span><span class="line" data-startTime="1201">hey, you're not even </span><span class="line" data-startTime="1205">viewing this tab. </span></p>

<p><span class="line" data-startTime="1206">We don't need to be wasting the </span><span class="line" data-startTime="1206">browser, the CPU, the GPU </span><span class="line" data-startTime="1210">in order to make this happen </span><span class="line" data-startTime="1210">because we know that they're </span><span class="line" data-startTime="1213">not looking at it. </span> <span class="line" data-startTime="1213">Whereas if this field demo had </span><span class="line" data-startTime="1213">been using a timer loop, it'd </span><span class="line" data-startTime="1219">still be going. </span> <span class="line" data-startTime="1220">It would still be eating </span><span class="line" data-startTime="1220">down my battery here. </span> <span class="line" data-startTime="1223">So I bring that back up. </span> <span class="line" data-startTime="1226">And our use of the </span><span class="line" data-startTime="1226">CPU returns. </span> <span class="line" data-startTime="1236">So if you're doing any </span><span class="line" data-startTime="1236">sort of animation, </span><span class="line" data-startTime="1239">use this if you can. </span> <span class="line" data-startTime="1240">This actually just </span><span class="line" data-startTime="1240">landed in jQuery. </span> <span class="line" data-startTime="1243">So this is going to </span><span class="line" data-startTime="1243">be in jQuery 1.6. </span></p>

<p><span class="line" data-startTime="1245">And it's also in Grit. </span> <span class="line" data-startTime="1246">And it's in a few other </span><span class="line" data-startTime="1246">libraries at this point. </span> <span class="line" data-startTime="1251">So I definitely recommend it. </span> <span class="line" data-startTime="1253">This is available in both </span><span class="line" data-startTime="1253">Chrome and also in </span><span class="line" data-startTime="1256">Firefox, Firefox 4. </span> <span class="line" data-startTime="1259">Over on my blog, we have a </span><span class="line" data-startTime="1259">nice little shim layer to </span><span class="line" data-startTime="1266">handle this. </span> <span class="line" data-startTime="1267">We basically feature detect </span><span class="line" data-startTime="1267">to see if the </span><span class="line" data-startTime="1269">native support is present. </span> <span class="line" data-startTime="1270">And if not, we're going to use </span><span class="line" data-startTime="1270">a setTimeout loop that </span><span class="line" data-startTime="1274">optimizes for 60 frames </span><span class="line" data-startTime="1274">per second. </span> <span class="line" data-startTime="1276">And that's how you use it. </span> <span class="line" data-startTime="1282">Cool. </span> <span class="line" data-startTime="1283">Web Workers, the idea here &mdash; </span><span class="line" data-startTime="1286">and I don't want to cover </span><span class="line" data-startTime="1286">this too much. </span> <span class="line" data-startTime="1288">The idea with Web Workers that </span><span class="line" data-startTime="1288">you're probably familiar with </span><span class="line" data-startTime="1290">is we want to move heavy </span><span class="line" data-startTime="1290">computation, expensive tasks </span><span class="line" data-startTime="1295">outside of the UI thread. </span> <span class="line" data-startTime="1297">Pretty much all JavaScript </span><span class="line" data-startTime="1297">runs in the UI thread. </span> <span class="line" data-startTime="1299">And if something is taking a </span><span class="line" data-startTime="1299">long time, the user can't </span><span class="line" data-startTime="1302">interact with the page. </span></p>

<p><span class="line" data-startTime="1303">The page becomes </span><span class="line" data-startTime="1303">non-responsive. </span> <span class="line" data-startTime="1304">And in the case of Chrome, we </span><span class="line" data-startTime="1304">get a sad, freezing cold tab. </span> <span class="line" data-startTime="1309">He's so cold. </span> <span class="line" data-startTime="1310">And we don't want that. </span> <span class="line" data-startTime="1311">No, that's bad. </span> <span class="line" data-startTime="1314">And we want to avoid that. </span> <span class="line" data-startTime="1315">And without Web Workers, </span><span class="line" data-startTime="1315">we can. </span> <span class="line" data-startTime="1320">I'm going to show this. </span> <span class="line" data-startTime="1320">This is a little bit more </span><span class="line" data-startTime="1320">advanced use of Web Worker. </span> <span class="line" data-startTime="1322">But I think it's really cool. </span> <span class="line" data-startTime="1325">First, normally the way that </span><span class="line" data-startTime="1325">you instantiate a brand-new </span><span class="line" data-startTime="1329">Web Worker is you would </span><span class="line" data-startTime="1329">be like, new Worker, </span><span class="line" data-startTime="1332">myworker.js, there. </span> <span class="line" data-startTime="1336">This is where the code </span><span class="line" data-startTime="1336">is going now. </span> <span class="line" data-startTime="1339">You pass it a file name. </span> <span class="line" data-startTime="1341">And then it goes and </span><span class="line" data-startTime="1341">gets that file. </span> <span class="line" data-startTime="1343">And then it uses that file. </span></p>

<p><span class="line" data-startTime="1344">And that's your worker. </span> <span class="line" data-startTime="1346">It has its limitations. </span> <span class="line" data-startTime="1348">This here is an example </span><span class="line" data-startTime="1348">of creating a </span><span class="line" data-startTime="1352">worker on the fly, basically. </span> <span class="line" data-startTime="1354">So here we have &mdash; oops &mdash; </span><span class="line" data-startTime="1356">our worker code, and it's </span><span class="line" data-startTime="1356">a script of type worker. </span> <span class="line" data-startTime="1359">So this is going to get skipped </span><span class="line" data-startTime="1359">by the browser. </span> <span class="line" data-startTime="1361">So we're just kind of using it </span><span class="line" data-startTime="1361">to hold some text right now. </span> <span class="line" data-startTime="1365">And then down here on our </span><span class="line" data-startTime="1365">script, we're going to </span><span class="line" data-startTime="1367">use the file API. </span> <span class="line" data-startTime="1368">And we're going to use </span><span class="line" data-startTime="1368">BlobBuilder, create a new </span><span class="line" data-startTime="1371">BlobBuilder. </span> <span class="line" data-startTime="1372">Then we're going to grab the </span><span class="line" data-startTime="1372">text of this script node, </span><span class="line" data-startTime="1375">throw that into the blob. </span> <span class="line" data-startTime="1377">And then when we create our </span><span class="line" data-startTime="1377">worker, we're going to use </span><span class="line" data-startTime="1380">URL.createobject URL with the </span><span class="line" data-startTime="1380">blob, and check that in. </span></p>

<p><span class="line" data-startTime="1384">Essentially, we create a file </span><span class="line" data-startTime="1384">on the fly and then </span><span class="line" data-startTime="1387">instantiate the worker </span><span class="line" data-startTime="1387">with that. </span> <span class="line" data-startTime="1389">And so now we have the advantage </span><span class="line" data-startTime="1389">of having a little </span><span class="line" data-startTime="1391">bit more control over the worker </span><span class="line" data-startTime="1391">in case we want to </span><span class="line" data-startTime="1394">change it or something </span><span class="line" data-startTime="1394">like that. </span> <span class="line" data-startTime="1396">And then also we avoid </span><span class="line" data-startTime="1396">an HTTP run trip. </span> <span class="line" data-startTime="1399">So from a network layer, </span><span class="line" data-startTime="1399">we're a little bit more </span><span class="line" data-startTime="1404">optimized as well. </span> <span class="line" data-startTime="1405">So that is just kind of a cool </span><span class="line" data-startTime="1405">example of where you can go </span><span class="line" data-startTime="1409">with workers combined </span><span class="line" data-startTime="1409">with the file API. </span> <span class="line" data-startTime="1412">Some places where you might </span><span class="line" data-startTime="1412">want to use workers, text </span><span class="line" data-startTime="1415">formatting of a long document, </span><span class="line" data-startTime="1415">syntax highlighting maybe, </span><span class="line" data-startTime="1418">maybe not, depends </span><span class="line" data-startTime="1418">on your use case. </span> <span class="line" data-startTime="1422">If you're doing heavy image </span><span class="line" data-startTime="1422">processing or dealing with </span><span class="line" data-startTime="1426">large arrays, also the audio </span><span class="line" data-startTime="1426">API, for instance, the WebKit </span><span class="line" data-startTime="1430">Web Audio API or the Mozilla </span><span class="line" data-startTime="1430">Audio Data API, depending on </span><span class="line" data-startTime="1435">kind of the analysis that you're </span><span class="line" data-startTime="1435">running, a worker might </span><span class="line" data-startTime="1437">make sense. </span></p>

<p><span class="line" data-startTime="1438">Also, the FileSystem API, which </span><span class="line" data-startTime="1438">is available in Chrome, </span><span class="line" data-startTime="1441">has had support for workers </span><span class="line" data-startTime="1441">for a while now. </span> <span class="line" data-startTime="1444">And this is really good. </span> <span class="line" data-startTime="1445">You might be dealing with large </span><span class="line" data-startTime="1445">binary data, and you </span><span class="line" data-startTime="1447">don't want that holding up </span><span class="line" data-startTime="1447">the UI thread at all. </span> <span class="line" data-startTime="1449">You want to just let that </span><span class="line" data-startTime="1449">happen as it does. </span> <span class="line" data-startTime="1452">And so letting Web Workers </span><span class="line" data-startTime="1452">handle the interaction with </span><span class="line" data-startTime="1455">the file system is the right </span><span class="line" data-startTime="1455">way to go there. </span> <span class="line" data-startTime="1458">Cool. </span> <span class="line" data-startTime="1460">Want to touch on JSPERF </span><span class="line" data-startTime="1460">real quick. </span> <span class="line" data-startTime="1464">Yeah, this is real cool. </span> <span class="line" data-startTime="1465">So JSPERF, if you don't </span><span class="line" data-startTime="1465">know, is a site </span><span class="line" data-startTime="1470">for performance tests. </span></p>

<p><span class="line" data-startTime="1471">And so we have a few things </span><span class="line" data-startTime="1471">going on here. </span> <span class="line" data-startTime="1473">We have a nice human </span><span class="line" data-startTime="1473">readable URL. </span> <span class="line" data-startTime="1476">And oftentimes, with a URL like </span><span class="line" data-startTime="1476">join-concat, this is now </span><span class="line" data-startTime="1481">the definitive join versus </span><span class="line" data-startTime="1481">concat string </span><span class="line" data-startTime="1484">concatenation test. </span> <span class="line" data-startTime="1486">And there's revisions as well. </span> <span class="line" data-startTime="1488">So within the page we have our </span><span class="line" data-startTime="1488">variations of the code that we </span><span class="line" data-startTime="1492">want to test. </span> <span class="line" data-startTime="1492">So this is the age-old </span><span class="line" data-startTime="1492">concatenation with plus equals </span><span class="line" data-startTime="1496">or array.join, which </span><span class="line" data-startTime="1496">is faster. </span> <span class="line" data-startTime="1499">And I believe it's IE 6 and 7 </span><span class="line" data-startTime="1499">are faster with the array </span><span class="line" data-startTime="1503">join, and absolutely everyone </span><span class="line" data-startTime="1503">else is faster with a </span><span class="line" data-startTime="1506">straight-up concatenation </span><span class="line" data-startTime="1506">augmented in a string. </span> <span class="line" data-startTime="1510">So don't use a array.join </span><span class="line" data-startTime="1510">anymore. </span> <span class="line" data-startTime="1515">But the nice thing here is that </span><span class="line" data-startTime="1515">we can run the test and </span><span class="line" data-startTime="1519">get our results and figure </span><span class="line" data-startTime="1519">out kind of what it is. </span></p>

<p><span class="line" data-startTime="1521">And so the site is used </span><span class="line" data-startTime="1521">by a lot of people. </span> <span class="line" data-startTime="1525">In fact, jQuery has been </span><span class="line" data-startTime="1525">using it for the </span><span class="line" data-startTime="1527">library development recently. </span> <span class="line" data-startTime="1530">So let's say there's </span><span class="line" data-startTime="1530">a few different </span><span class="line" data-startTime="1532">variations of DOM traversal. </span> <span class="line" data-startTime="1534">The nice thing here is that we </span><span class="line" data-startTime="1534">can do our tests with a few </span><span class="line" data-startTime="1537">variations, kind of see what's </span><span class="line" data-startTime="1537">going on, and then the results </span><span class="line" data-startTime="1540">get reported to BrowserScope, </span><span class="line" data-startTime="1540">which kind of handles what </span><span class="line" data-startTime="1544">user agent it's coming from, </span><span class="line" data-startTime="1544">what are the numbers, and kind </span><span class="line" data-startTime="1547">of give us a really </span><span class="line" data-startTime="1547">comprehensive table of what </span><span class="line" data-startTime="1550">the story is across all browsers </span><span class="line" data-startTime="1550">and where is each </span><span class="line" data-startTime="1553">thing faster. </span> <span class="line" data-startTime="1556">And so I'm running it here. </span></p>

<p><span class="line" data-startTime="1558">This is WebKit Nightly. </span> <span class="line" data-startTime="1560">And we see, well, in this case, </span><span class="line" data-startTime="1560">we have these traversal, </span><span class="line" data-startTime="1563">and we have some different </span><span class="line" data-startTime="1563">results. </span> <span class="line" data-startTime="1569">So JSPERF is really good. </span> <span class="line" data-startTime="1571">I like it a lot because it's </span><span class="line" data-startTime="1571">kind of like the clearinghouse </span><span class="line" data-startTime="1575">of performance best practices. </span> <span class="line" data-startTime="1578">People will say, oh, well, you </span><span class="line" data-startTime="1578">should use triple equals </span><span class="line" data-startTime="1582">instead of double equals </span><span class="line" data-startTime="1582">because it's faster. </span> <span class="line" data-startTime="1586">And now we can actually find </span><span class="line" data-startTime="1586">out, hey, are they right? </span><span class="line" data-startTime="1588">And are they right across </span><span class="line" data-startTime="1588">all browsers or not? </span><span class="line" data-startTime="1591">It's powered by benchmark.js, </span><span class="line" data-startTime="1591">which is a very finely tuned </span><span class="line" data-startTime="1595">and calibrated benchmarking </span><span class="line" data-startTime="1595">script that works not only in </span><span class="line" data-startTime="1599">the browser but in Node and </span><span class="line" data-startTime="1599">Narwhal and Ringo and all </span><span class="line" data-startTime="1603">these different environments </span><span class="line" data-startTime="1603">and is definitely the right </span><span class="line" data-startTime="1605">way to be benchmarking different </span><span class="line" data-startTime="1605">variations of code. </span> <span class="line" data-startTime="1612">So a quick touch on the </span><span class="line" data-startTime="1612">HTML5 Boilerplate. </span></p>

<p><span class="line" data-startTime="1615">It's a project that </span><span class="line" data-startTime="1615">I work with. </span> <span class="line" data-startTime="1619">And recently, we put </span><span class="line" data-startTime="1619">out a build tool. </span> <span class="line" data-startTime="1623">The build script is just </span><span class="line" data-startTime="1623">an Ant script. </span> <span class="line" data-startTime="1625">But the cool thing is that when </span><span class="line" data-startTime="1625">you use it alongside one </span><span class="line" data-startTime="1628">of the web server </span><span class="line" data-startTime="1628">configurations, like for </span><span class="line" data-startTime="1630">Apache or Nginx, you're </span><span class="line" data-startTime="1630">basically going to get a 90% </span><span class="line" data-startTime="1635">on your score for Google </span><span class="line" data-startTime="1635">PageSpeed or YSlow. </span> <span class="line" data-startTime="1641">There's all these things </span><span class="line" data-startTime="1641">that you've heard. </span> <span class="line" data-startTime="1643">And you're supposed to be </span><span class="line" data-startTime="1643">doing like combining and </span><span class="line" data-startTime="1645">minifying your JavaScript, </span><span class="line" data-startTime="1645">your CSS, your image </span><span class="line" data-startTime="1647">optimization. </span> <span class="line" data-startTime="1649">And the script does </span><span class="line" data-startTime="1649">all these things. </span> <span class="line" data-startTime="1650">It also does HTML </span><span class="line" data-startTime="1650">minification. </span> <span class="line" data-startTime="1653">It revs your file names so that </span><span class="line" data-startTime="1653">we can cachebust when </span><span class="line" data-startTime="1656">there's a new version. </span> <span class="line" data-startTime="1657">And then we upgrade the web </span><span class="line" data-startTime="1657">server configuration to use </span><span class="line" data-startTime="1660">far Future and Expires headers </span><span class="line" data-startTime="1660">because now we have unique </span><span class="line" data-startTime="1663">file names. </span></p>

<p><span class="line" data-startTime="1666">So it does all these </span><span class="line" data-startTime="1666">things for you. </span> <span class="line" data-startTime="1668">And we can basically take what </span><span class="line" data-startTime="1668">was a C and B grade website </span><span class="line" data-startTime="1675">and bring it up to some </span><span class="line" data-startTime="1675">much higher scores. </span> <span class="line" data-startTime="1679">So I definitely recommend you </span><span class="line" data-startTime="1679">dig into that if you'd like to </span><span class="line" data-startTime="1684">not have to repeat all these </span><span class="line" data-startTime="1684">performance optimizations </span><span class="line" data-startTime="1688">every time you make a site. </span> <span class="line" data-startTime="1690">And let a script handle </span><span class="line" data-startTime="1690">it for you. </span> <span class="line" data-startTime="1694">All right, I guess </span><span class="line" data-startTime="1694">that's it for me. </span> <span class="line" data-startTime="1697">If you have any questions, you </span><span class="line" data-startTime="1697">can leave a comment or hit me </span><span class="line" data-startTime="1701">up on Twitter. </span> <span class="line" data-startTime="1702">I'd also recommend to check </span><span class="line" data-startTime="1702">out html5rocks.com. </span></p>

<p><span class="line" data-startTime="1706">We have a lot of tutorials on </span><span class="line" data-startTime="1706">there of really good stuff. </span> <span class="line" data-startTime="1709">And we have a lot that are </span><span class="line" data-startTime="1709">focused on performance and a </span><span class="line" data-startTime="1711">lot of the things that I've been </span><span class="line" data-startTime="1711">talking about here, so </span><span class="line" data-startTime="1714">plenty more to read </span><span class="line" data-startTime="1714">and learn there. </span> <span class="line" data-startTime="1716">So I guess that's it. </span> <span class="line" data-startTime="1718">Thank you very much </span><span class="line" data-startTime="1718">for watching. </span></p></div>