<style>* {font-family: "Open Sans", sans-serif}
a {color: #77aaff}
a.video {border-bottom: 1px solid #ddd; display: block; margin: 0 0 2em 0; padding: 0 0 2em 0}
h2 {color: #444; font-size: 18px;}
span.speakerName {color: black; font-weight: 900;}
body {padding: 2em}
p {color: #444; margin: 0; text-indent: 1.5em;}
p.speaker {margin: 1em 0 0 0; text-indent: 0;}
div#transcript > p:first-child {text-indent: 0;}
</style>

<h1>Google I/O 2012 &mdash; Upgrading Your Web App to a Chrome App</h1>

<h2>Pete LePage, Mehi</h2>

<a class="video" href="http://youtu.be/TEwpppxgZhM">youtu.be/TEwpppxgZhM</a><div id="transcript"><p class="speaker"><span class="line" data-starttime="8"><span class="speakerName">Pete LePage</span>: All right, </span><span class="line" data-startTime="8">welcome everybody. </span> <span class="line" data-startTime="10">Thanks for joining me. </span> <span class="line" data-startTime="12">I did hear a little rumor </span><span class="line" data-startTime="12">earlier that the description </span><span class="line" data-startTime="16">for this was that you might </span><span class="line" data-startTime="16">be coming up and </span><span class="line" data-startTime="18">showing off your apps. </span> <span class="line" data-startTime="19">If you were expecting that, </span><span class="line" data-startTime="19">not so much today. </span> <span class="line" data-startTime="23">What did you guys think of </span><span class="line" data-startTime="23">the keynote this morning? </span><span class="line" data-startTime="25">Liked it, yeah? </span><span class="line" data-startTime="27">Awesome Cirque du </span><span class="line" data-startTime="27">Soleil thing? </span><span class="line" data-startTime="29">Cool, yeah? </span><span class="line" data-startTime="30">All right, sweet. </span> <span class="line" data-startTime="32">I'm going to be talking about </span><span class="line" data-startTime="32">how to take a web app and turn </span><span class="line" data-startTime="35">it into one of the new Chrome </span><span class="line" data-startTime="35">packaged applications using </span><span class="line" data-startTime="39">the new technologies that we've </span><span class="line" data-startTime="39">got available to us. </span></p>

<p><span class="line" data-startTime="43">Chrome packaged applications </span><span class="line" data-startTime="43">do a lot of things that are </span><span class="line" data-startTime="46">really cool. </span> <span class="line" data-startTime="47">And really allow us as </span><span class="line" data-startTime="47">developers to build </span><span class="line" data-startTime="50">applications using the </span><span class="line" data-startTime="50">technology that we know today </span><span class="line" data-startTime="54">already, that we know how to </span><span class="line" data-startTime="54">use, divs and C S S and all </span><span class="line" data-startTime="57">that great JavaScript stuff. </span> <span class="line" data-startTime="58">And build applications that feel </span><span class="line" data-startTime="58">like they're installed, </span><span class="line" data-startTime="62">that break out of the browser </span><span class="line" data-startTime="62">so that they don't have that </span><span class="line" data-startTime="70">browser bar cross the top. </span> <span class="line" data-startTime="72">They don't feel like that </span><span class="line" data-startTime="72">experience of oh, I've got to </span><span class="line" data-startTime="75">open the browser and then I </span><span class="line" data-startTime="75">got to go to this site. </span> <span class="line" data-startTime="77">You click a button on the doc, </span><span class="line" data-startTime="77">or you click something on the </span><span class="line" data-startTime="80">start menu, and the application </span><span class="line" data-startTime="80">starts just as </span><span class="line" data-startTime="84">you'd expect it to. </span> <span class="line" data-startTime="89">With an enhanced UI that allows </span><span class="line" data-startTime="89">us to really be able to </span><span class="line" data-startTime="93">do things that we can't </span><span class="line" data-startTime="93">normally do in web </span><span class="line" data-startTime="95">applications. </span></p>

<p><span class="line" data-startTime="96">I want to be able to </span><span class="line" data-startTime="96">open a window. </span> <span class="line" data-startTime="97">I want to be able to move </span><span class="line" data-startTime="97">it around or resize it. </span> <span class="line" data-startTime="100">I want to be able to do things </span><span class="line" data-startTime="100">that with web applications I </span><span class="line" data-startTime="104">can do today, but I might get </span><span class="line" data-startTime="104">blocked because I'm not </span><span class="line" data-startTime="108">allowed to open new pop-up </span><span class="line" data-startTime="108">windows and things like that. </span> <span class="line" data-startTime="111">So an enhanced UI that really </span><span class="line" data-startTime="111">lets us get beyond what we're </span><span class="line" data-startTime="114">used to doing. </span> <span class="line" data-startTime="117">Offline by default, apps </span><span class="line" data-startTime="117">that just work. </span> <span class="line" data-startTime="121">Today when an app gets installed </span><span class="line" data-startTime="121">on your computer, </span><span class="line" data-startTime="124">you expect it to work. </span> <span class="line" data-startTime="125">When an app get installed on </span><span class="line" data-startTime="125">your phone, you start it, you </span><span class="line" data-startTime="128">expect it to work whether </span><span class="line" data-startTime="128">you've got an internet </span><span class="line" data-startTime="130">connection or not. </span> <span class="line" data-startTime="131">Chrome packaged applications </span><span class="line" data-startTime="131">should work like that. </span></p>

<p><span class="line" data-startTime="135">Web applications should </span><span class="line" data-startTime="135">work like that. </span> <span class="line" data-startTime="137">And we need to get users </span><span class="line" data-startTime="137">thinking about that, right? </span><span class="line" data-startTime="141">I got made fun of a little bit </span><span class="line" data-startTime="141">when I used this reference, so </span><span class="line" data-startTime="144">pardon me, but when my mom </span><span class="line" data-startTime="144">starts a web app, she goes to </span><span class="line" data-startTime="148">Gmail or wherever she's going. </span> <span class="line" data-startTime="151">If her computer's not connected, </span><span class="line" data-startTime="151">she doesn't think </span><span class="line" data-startTime="153">that it's going to </span><span class="line" data-startTime="153">work if it's not </span><span class="line" data-startTime="155">connected to the internet. </span> <span class="line" data-startTime="156">So for her, we need </span><span class="line" data-startTime="156">to really say hey, </span><span class="line" data-startTime="159">these apps work offline. </span> <span class="line" data-startTime="160">And Chrome packaged applications </span><span class="line" data-startTime="160">allow us to do </span><span class="line" data-startTime="165">that within this new model </span><span class="line" data-startTime="165">that we've now got. </span> <span class="line" data-startTime="170">And my battery is dead, so I </span><span class="line" data-startTime="170">guess I'm going to have to </span><span class="line" data-startTime="174">move around. </span> <span class="line" data-startTime="175">My name is Pete LePage, I'm a </span><span class="line" data-startTime="175">Developer Advocate on the </span><span class="line" data-startTime="177">Chrome Team. </span> <span class="line" data-startTime="178">And it's my job to help folks </span><span class="line" data-startTime="178">like you guys build web </span><span class="line" data-startTime="183">applications, build Chrome </span><span class="line" data-startTime="183">packaged applications, and </span><span class="line" data-startTime="187">really take advantage of all the </span><span class="line" data-startTime="187">cool stuff that you saw in </span><span class="line" data-startTime="189">the keynote this morning. </span></p>

<p><span class="line" data-startTime="191">And be able to get better access </span><span class="line" data-startTime="191">to your customers, to </span><span class="line" data-startTime="195">your users, and to all the fun </span><span class="line" data-startTime="195">stuff that Chrome really has </span><span class="line" data-startTime="198">to offer for you. </span> <span class="line" data-startTime="200">You can find me on Google+. </span> <span class="line" data-startTime="201">I'm also on Twitter, though I </span><span class="line" data-startTime="201">don't tweet very often, as </span><span class="line" data-startTime="205">well as my blog. </span> <span class="line" data-startTime="206">And I've got some stuff </span><span class="line" data-startTime="206">up on GitHub. </span> <span class="line" data-startTime="210">So when I think about the legacy </span><span class="line" data-startTime="210">packaged app, this is </span><span class="line" data-startTime="214">what a legacy packaged </span><span class="line" data-startTime="214">app looks like. </span> <span class="line" data-startTime="216">I've still got the address bar </span><span class="line" data-startTime="216">up at the top, I still need to </span><span class="line" data-startTime="220">start it in the same way. </span> <span class="line" data-startTime="221">In fact, let's get out of here </span><span class="line" data-startTime="221">and let's have a look at a </span><span class="line" data-startTime="227">little packaged app. </span> <span class="line" data-startTime="229">So we're going to take a </span><span class="line" data-startTime="229">look at this particular </span><span class="line" data-startTime="232">application. </span> <span class="line" data-startTime="233">This is just a simple </span><span class="line" data-startTime="233">RSS reader that </span><span class="line" data-startTime="237">I've gone and built. </span> <span class="line" data-startTime="238">Because I wanted to see what </span><span class="line" data-startTime="238">it was like to build an </span><span class="line" data-startTime="241">application and then convert it </span><span class="line" data-startTime="241">to a packaged application. </span></p>

<p><span class="line" data-startTime="245">So you can see I've got a list </span><span class="line" data-startTime="245">of different feeds available. </span> <span class="line" data-startTime="250">I can go, I can scroll down, I </span><span class="line" data-startTime="250">can go click on one of these. </span> <span class="line" data-startTime="253">But I still have the address </span><span class="line" data-startTime="253">bar up here, I </span><span class="line" data-startTime="256">can't open new Windows. </span> <span class="line" data-startTime="258">It's not exactly the best </span><span class="line" data-startTime="258">connection, it's not exactly </span><span class="line" data-startTime="262">the best experience that I </span><span class="line" data-startTime="262">really want to have as I'm </span><span class="line" data-startTime="265">reading through my RSS feeds </span><span class="line" data-startTime="265">and all of that. </span> <span class="line" data-startTime="272">So I chose this application in </span><span class="line" data-startTime="272">particular because it does a </span><span class="line" data-startTime="276">couple of things really well. </span> <span class="line" data-startTime="278">One, it's a single-page </span><span class="line" data-startTime="278">application. </span> <span class="line" data-startTime="282">So it works really well, </span><span class="line" data-startTime="282">there's not a lot of </span><span class="line" data-startTime="285">navigation from page </span><span class="line" data-startTime="285">to page to page. </span> <span class="line" data-startTime="288">It should work offline. </span></p>

<p><span class="line" data-startTime="291">I should be able to take all of </span><span class="line" data-startTime="291">that data that I've got and </span><span class="line" data-startTime="293">all of the stuff that I'm used </span><span class="line" data-startTime="293">to using, and I should be able </span><span class="line" data-startTime="296">to just say all right, great, </span><span class="line" data-startTime="296">I want to access all of that </span><span class="line" data-startTime="299">without having to do </span><span class="line" data-startTime="299">anything else. </span> <span class="line" data-startTime="305">So we're going to walk </span><span class="line" data-startTime="305">through what I went </span><span class="line" data-startTime="308">through to get there. </span> <span class="line" data-startTime="310">So let's go back ti the slides </span><span class="line" data-startTime="310">for a sec and try that again. </span> <span class="line" data-startTime="321">Hey, there we go, that looks </span><span class="line" data-startTime="321">a little better. </span> <span class="line" data-startTime="324">So when you think of a legacy </span><span class="line" data-startTime="324">packaged app, you had a </span><span class="line" data-startTime="327">manifest file. </span> <span class="line" data-startTime="328">How many people have built a </span><span class="line" data-startTime="328">packaged app or a Chrome app </span><span class="line" data-startTime="331">in the past? </span><span class="line" data-startTime="332">All right, so few people, </span><span class="line" data-startTime="332">about half the room. </span> <span class="line" data-startTime="335">So you had a manifest file, </span><span class="line" data-startTime="335">and that manifest file was </span><span class="line" data-startTime="337">really what told Chrome how your </span><span class="line" data-startTime="337">apps should work and what </span><span class="line" data-startTime="340">it should start, where </span><span class="line" data-startTime="340">it should go. </span> <span class="line" data-startTime="343">And within that manifest, it had </span><span class="line" data-startTime="343">effectively a link, or it </span><span class="line" data-startTime="347">said hey, when you start </span><span class="line" data-startTime="347">I want you to go </span><span class="line" data-startTime="350">open this index file. </span></p>

<p><span class="line" data-startTime="352">And that index file might go off </span><span class="line" data-startTime="352">and grab any resources it </span><span class="line" data-startTime="355">might need, any HTML, </span><span class="line" data-startTime="355">or C S S. </span> <span class="line" data-startTime="358">But all of that stuff fit into </span><span class="line" data-startTime="358">as a package, into a zip file, </span><span class="line" data-startTime="361">that you uploaded to the </span><span class="line" data-startTime="361">Chrome Web Store. </span> <span class="line" data-startTime="364">And it could also sometimes </span><span class="line" data-startTime="364">have a background page. </span> <span class="line" data-startTime="367">And you might use that </span><span class="line" data-startTime="367">background page to say go pull </span><span class="line" data-startTime="370">for data so that you </span><span class="line" data-startTime="370">could pull data </span><span class="line" data-startTime="373">down and save it somewhere. </span> <span class="line" data-startTime="375">You might use some </span><span class="line" data-startTime="375">context menus. </span> <span class="line" data-startTime="379">But all of that stuff, you'd </span><span class="line" data-startTime="379">have to set up a loop. </span> <span class="line" data-startTime="382">You'd have to either use a loop, </span><span class="line" data-startTime="382">you'd have to use set </span><span class="line" data-startTime="384">interval, there were a whole </span><span class="line" data-startTime="384">bunch of things that would </span><span class="line" data-startTime="387">cause some pain in the </span><span class="line" data-startTime="387">butt sometimes. </span></p>

<p><span class="line" data-startTime="390">And could potentially, if you </span><span class="line" data-startTime="390">didn't write it very well or </span><span class="line" data-startTime="395">used some bad practices or worst </span><span class="line" data-startTime="395">practices, if such a </span><span class="line" data-startTime="399">thing exists, could affect the </span><span class="line" data-startTime="399">performance of Chrome for </span><span class="line" data-startTime="403">everything else. </span> <span class="line" data-startTime="405">So one of the things that we </span><span class="line" data-startTime="405">really wanted to address as we </span><span class="line" data-startTime="408">started making these </span><span class="line" data-startTime="408">enhancements to Chrome </span><span class="line" data-startTime="413">packaged apps is </span><span class="line" data-startTime="413">how we do that. </span> <span class="line" data-startTime="415">How do we make it easier so </span><span class="line" data-startTime="415">that the applications that </span><span class="line" data-startTime="418">you're writing, it's harder </span><span class="line" data-startTime="418">to do the wrong thing. </span> <span class="line" data-startTime="424">So let's get started </span><span class="line" data-startTime="424">and have a look at </span><span class="line" data-startTime="426">how I converted this. </span> <span class="line" data-startTime="429">Now, I'm going to throw </span><span class="line" data-startTime="429">up this warning. </span> <span class="line" data-startTime="430">I'm just going to say </span><span class="line" data-startTime="430">time out for a sec. </span></p>

<p><span class="line" data-startTime="433">This is a developer preview, </span><span class="line" data-startTime="433">this is not something that you </span><span class="line" data-startTime="436">can go ship a production-level </span><span class="line" data-startTime="436">app on. </span> <span class="line" data-startTime="440">If you do, congratulations. </span> <span class="line" data-startTime="442">You can't get it in the </span><span class="line" data-startTime="442">Chrome Web Store. </span> <span class="line" data-startTime="445">But if you give it out to a </span><span class="line" data-startTime="445">bunch of users, it probably </span><span class="line" data-startTime="448">will break at some point </span><span class="line" data-startTime="448">in the future. </span> <span class="line" data-startTime="450">So just that word of warning as </span><span class="line" data-startTime="450">you're playing with this. </span> <span class="line" data-startTime="453">If you're like hey, this worked </span><span class="line" data-startTime="453">yesterday, but now that </span><span class="line" data-startTime="456">I got a Chrome update </span><span class="line" data-startTime="456">it doesn't work. </span> <span class="line" data-startTime="458">Go have a look at the docs for </span><span class="line" data-startTime="458">known issues in any updates. </span> <span class="line" data-startTime="461">Because things are changing on </span><span class="line" data-startTime="461">a regular basis, and we're </span><span class="line" data-startTime="465">working to get a lot of </span><span class="line" data-startTime="465">new great stuff added. </span></p>

<p><span class="line" data-startTime="469">And sometimes that means taking </span><span class="line" data-startTime="469">your feedback and going </span><span class="line" data-startTime="472">oh, guess we didn't think </span><span class="line" data-startTime="472">about that one too well. </span> <span class="line" data-startTime="475">I guess we better change that. </span> <span class="line" data-startTime="477">So getting your feedback is </span><span class="line" data-startTime="477">really important to us. </span> <span class="line" data-startTime="480">We want to hear what you </span><span class="line" data-startTime="480">have to say about these </span><span class="line" data-startTime="482">applications as you're </span><span class="line" data-startTime="482">building them. </span> <span class="line" data-startTime="484">What are your experiences? </span><span class="line" data-startTime="486">How do we need to make these </span><span class="line" data-startTime="486">things better so that you can </span><span class="line" data-startTime="489">build the type of applications </span><span class="line" data-startTime="489">that you want to build? </span><span class="line" data-startTime="495">So with the new architecture, </span><span class="line" data-startTime="495">it changes a little bit. </span> <span class="line" data-startTime="500">Remember before we had our </span><span class="line" data-startTime="500">manifest which would then </span><span class="line" data-startTime="503">kick-off an index file? </span><span class="line" data-startTime="506">In a new Chrome packaged </span><span class="line" data-startTime="506">application, instead of </span><span class="line" data-startTime="509">kicking-off an index file, </span><span class="line" data-startTime="509">the first thing that the </span><span class="line" data-startTime="512">application does is it kicks-off </span><span class="line" data-startTime="512">a background script. </span></p>

<p><span class="line" data-startTime="515">So that background script, think </span><span class="line" data-startTime="515">very similarly to if </span><span class="line" data-startTime="520">you're writing a native </span><span class="line" data-startTime="520">application for Windows or for </span><span class="line" data-startTime="525">Android or for any </span><span class="line" data-startTime="525">other device. </span> <span class="line" data-startTime="526">There's some kind of like C# </span><span class="line" data-startTime="526">file, or there's some main </span><span class="line" data-startTime="530">file that might kick open other </span><span class="line" data-startTime="530">windows and all that </span><span class="line" data-startTime="533">kind of stuff. </span> <span class="line" data-startTime="534">It works in the same way. </span> <span class="line" data-startTime="536">So that background script is </span><span class="line" data-startTime="536">going to go, and it's going to </span><span class="line" data-startTime="538">start running first thing. </span> <span class="line" data-startTime="541">And when you want to start the </span><span class="line" data-startTime="541">application, it then goes and </span><span class="line" data-startTime="544">opens your application </span><span class="line" data-startTime="544">UI window. </span> <span class="line" data-startTime="547">So it says, oh hey, the </span><span class="line" data-startTime="547">user wants to start. </span> <span class="line" data-startTime="551">I guess I should open this </span><span class="line" data-startTime="551">window up, and it goes and </span><span class="line" data-startTime="553">opens that window. </span></p>

<p><span class="line" data-startTime="554">So the difference here, and </span><span class="line" data-startTime="554">the really important thing </span><span class="line" data-startTime="557">here, is that background </span><span class="line" data-startTime="557">script needs </span><span class="line" data-startTime="559">to listen for events. </span> <span class="line" data-startTime="560">We'll talk about </span><span class="line" data-startTime="560">that in a sec. </span> <span class="line" data-startTime="562">So the application that we used, </span><span class="line" data-startTime="562">we didn't use all of the </span><span class="line" data-startTime="565">technology that's possibly </span><span class="line" data-startTime="565">available to us, </span><span class="line" data-startTime="569">but we used a bunch. </span> <span class="line" data-startTime="570">When we used the Chrome </span><span class="line" data-startTime="570">experimental apps API &mdash; </span><span class="line" data-startTime="576">maybe it's just standing </span><span class="line" data-startTime="576">too far away. </span> <span class="line" data-startTime="579">Maybe if I go over here. </span> <span class="line" data-startTime="580">We used the chrome.storage.sync. </span> <span class="line" data-startTime="582">I'm going to talk about </span><span class="line" data-startTime="582">each of these in </span><span class="line" data-startTime="583">depth in a little bit. </span> <span class="line" data-startTime="584">But chrome.storage.sync, how </span><span class="line" data-startTime="584">many people used chrome.sync </span><span class="line" data-startTime="588">in Chrome when they used Chrome </span><span class="line" data-startTime="588">today to sync all your </span><span class="line" data-startTime="591">passwords, your favorites, </span><span class="line" data-startTime="591">all that kind of stuff? </span><span class="line" data-startTime="594">And, kind of cool, </span><span class="line" data-startTime="594">chrome.storage.sync basically </span><span class="line" data-startTime="597">lets you take whatever you want </span><span class="line" data-startTime="597">for your application, </span><span class="line" data-startTime="600">within a set of limits </span><span class="line" data-startTime="600">obviously, and store that </span><span class="line" data-startTime="603">stuff up in the cloud. </span></p>

<p><span class="line" data-startTime="604">So that no matter which computer </span><span class="line" data-startTime="604">I'm logged into, I </span><span class="line" data-startTime="607">have all of those settings </span><span class="line" data-startTime="607">synced across all machines. </span> <span class="line" data-startTime="610">So I can have maybe my </span><span class="line" data-startTime="610">credentials, maybe a list of </span><span class="line" data-startTime="613">read items. </span> <span class="line" data-startTime="614">All of that stuff I can keep </span><span class="line" data-startTime="614">synced in the cloud. </span> <span class="line" data-startTime="618">Chrome.storage.local which is </span><span class="line" data-startTime="618">very similar, but it only is </span><span class="line" data-startTime="623">local to that specific </span><span class="line" data-startTime="623">machine. </span> <span class="line" data-startTime="625">We use Chrome alerts to notify </span><span class="line" data-startTime="625">the user of a bunch of stuff. </span> <span class="line" data-startTime="629">We use sandbox pages, and I'm </span><span class="line" data-startTime="629">going to talk about Content </span><span class="line" data-startTime="632">Security Policy in a little </span><span class="line" data-startTime="632">bit and why we'd </span><span class="line" data-startTime="635">use a sandbox page. </span> <span class="line" data-startTime="637">And we used Angular.js. </span> <span class="line" data-startTime="638">We used Angular.js because </span><span class="line" data-startTime="638">Angular did something that </span><span class="line" data-startTime="642">made our lives a little </span><span class="line" data-startTime="642">bit easier. </span> <span class="line" data-startTime="645">How many people have heard of </span><span class="line" data-startTime="645">Content Security Policy? </span><span class="line" data-startTime="647">Yay, OK, only a couple hands. </span></p>

<p><span class="line" data-startTime="650">We're going to go into </span><span class="line" data-startTime="650">more depth on this. </span> <span class="line" data-startTime="652">This is something that's really </span><span class="line" data-startTime="652">important, but it could </span><span class="line" data-startTime="655">change the way we think </span><span class="line" data-startTime="655">about a lot of stuff. </span> <span class="line" data-startTime="657">And it's, like I said, it's </span><span class="line" data-startTime="657">really important and it will </span><span class="line" data-startTime="659">make the web a lot safer. </span> <span class="line" data-startTime="663">Nice big eye chart. </span> <span class="line" data-startTime="664">This is how the app is </span><span class="line" data-startTime="664">kind of laid out. </span> <span class="line" data-startTime="666">So you can see right there in </span><span class="line" data-startTime="666">the center of the app is that </span><span class="line" data-startTime="669">background page. </span> <span class="line" data-startTime="670">And that background page goes </span><span class="line" data-startTime="670">and does all of the stuff we </span><span class="line" data-startTime="673">need to do. </span> <span class="line" data-startTime="674">And I promise, we will get into </span><span class="line" data-startTime="674">real code here shortly. </span> <span class="line" data-startTime="678">I think it's like one slide </span><span class="line" data-startTime="678">or two slides away. </span> <span class="line" data-startTime="680">So we've got that background </span><span class="line" data-startTime="680">page, and it goes off and </span><span class="line" data-startTime="683">kicks-off the app page there </span><span class="line" data-startTime="683">at the very bottom. </span></p>

<p><span class="line" data-startTime="686">It goes over and it gets access </span><span class="line" data-startTime="686">to data in different </span><span class="line" data-startTime="689">data places. </span> <span class="line" data-startTime="691">And it goes up to the cloud </span><span class="line" data-startTime="691">and it asks for feeds. </span> <span class="line" data-startTime="697">So the first thing we need to </span><span class="line" data-startTime="697">do in our application is we </span><span class="line" data-startTime="700">need to update the manifest. </span> <span class="line" data-startTime="702">The manifest for a new packaged </span><span class="line" data-startTime="702">app has changed a </span><span class="line" data-startTime="706">little bit, and I want </span><span class="line" data-startTime="706">to highlight a </span><span class="line" data-startTime="707">couple of the changes. </span> <span class="line" data-startTime="708">So the first thing that changes </span><span class="line" data-startTime="708">is we need to add a </span><span class="line" data-startTime="711">manifest version 2. </span> <span class="line" data-startTime="713">Manifest version 2 tells Chrome, </span><span class="line" data-startTime="713">hey, this is a new </span><span class="line" data-startTime="717">Chrome packaged app. </span></p>

<p><span class="line" data-startTime="719">It also turns on Content </span><span class="line" data-startTime="719">Security Policy. </span> <span class="line" data-startTime="723">Second thing, we want to add </span><span class="line" data-startTime="723">offline true, because our apps </span><span class="line" data-startTime="727">are designed to work offline. </span> <span class="line" data-startTime="729">Everything that we have we need </span><span class="line" data-startTime="729">for our application is </span><span class="line" data-startTime="732">sitting there in our zip file in </span><span class="line" data-startTime="732">our package that we zipped </span><span class="line" data-startTime="737">up and uploaded and </span><span class="line" data-startTime="737">is good to go. </span> <span class="line" data-startTime="740">The next thing is we </span><span class="line" data-startTime="740">need to add the </span><span class="line" data-startTime="743">app background scripts. </span> <span class="line" data-startTime="745">If you remember before in V1 </span><span class="line" data-startTime="745">apps, that was where we put </span><span class="line" data-startTime="750">our index file. </span> <span class="line" data-startTime="750">We said, hey, this </span><span class="line" data-startTime="750">is my index file. </span> <span class="line" data-startTime="752">And then finally, we need to </span><span class="line" data-startTime="752">add a couple of specific </span><span class="line" data-startTime="755">permissions. </span></p>

<p><span class="line" data-startTime="756">We need to add the app window </span><span class="line" data-startTime="756">permission which says hey, we </span><span class="line" data-startTime="760">want to be able to open windows, </span><span class="line" data-startTime="760">we need to be able to </span><span class="line" data-startTime="762">manipulate windows. </span> <span class="line" data-startTime="763">We want to do all that stuff. </span> <span class="line" data-startTime="765">And then we need experimental. </span> <span class="line" data-startTime="767">Now, we are only going to need </span><span class="line" data-startTime="767">experimental while we're in an </span><span class="line" data-startTime="771">experimental stage, so </span><span class="line" data-startTime="771">that will go away </span><span class="line" data-startTime="774">sometime in the future. </span> <span class="line" data-startTime="777">And that right now is one of the </span><span class="line" data-startTime="777">things that will prevent </span><span class="line" data-startTime="780">your app from getting uploaded </span><span class="line" data-startTime="780">to the Chrome Web Store. </span> <span class="line" data-startTime="783">So if you go and you're like, </span><span class="line" data-startTime="783">hey, I got this great app and </span><span class="line" data-startTime="785">I want to get it in, </span><span class="line" data-startTime="785">and you're like </span><span class="line" data-startTime="786">why won't it upload? </span><span class="line" data-startTime="787">Well, that's a big part </span><span class="line" data-startTime="787">of the reason. </span> <span class="line" data-startTime="790">So let's go and actually </span><span class="line" data-startTime="790">do that. </span></p>

<p><span class="line" data-startTime="795">So I have here my text editor. </span> <span class="line" data-startTime="797">And don't worry, we got some </span><span class="line" data-startTime="797">nice decent size fonts here. </span> <span class="line" data-startTime="800">And instead of doing it in </span><span class="line" data-startTime="800">there, I'm going to do it in </span><span class="line" data-startTime="806">my Updated, and I'm going </span><span class="line" data-startTime="806">to go grab my manifest. </span> <span class="line" data-startTime="809">All right, so we need to </span><span class="line" data-startTime="809">add a couple of things. </span> <span class="line" data-startTime="813">So we need to add our manifest </span><span class="line" data-startTime="813">version, and we want to set </span><span class="line" data-startTime="819">that guy at two, right? </span><span class="line" data-startTime="821">We want to add offline enabled, </span><span class="line" data-startTime="821">and we want to set </span><span class="line" data-startTime="828">that to true. </span> <span class="line" data-startTime="830">Then, remember we said we had </span><span class="line" data-startTime="830">to change from the index to </span><span class="line" data-startTime="834">instead use our background </span><span class="line" data-startTime="834">page? </span><span class="line" data-startTime="837">So I'm going to say background, </span><span class="line" data-startTime="837">and I'm going to </span><span class="line" data-startTime="841">go here and say scripts, and </span><span class="line" data-startTime="841">turn that into an array, </span><span class="line" data-startTime="851">because we can have multiple </span><span class="line" data-startTime="851">background scripts. </span> <span class="line" data-startTime="854">And I'm just going to say </span><span class="line" data-startTime="854">background.js, and I'm going </span><span class="line" data-startTime="858">to put that in my js folder. </span> <span class="line" data-startTime="860">All right, two other things </span><span class="line" data-startTime="860">we need to do. </span></p>

<p><span class="line" data-startTime="869">Run permissions, and appWindow, </span><span class="line" data-startTime="869">and experimental. </span> <span class="line" data-startTime="881">All right, so we've done </span><span class="line" data-startTime="881">all the things we </span><span class="line" data-startTime="888">needed to do here. </span> <span class="line" data-startTime="890">So we've got our manifest </span><span class="line" data-startTime="890">set to go. </span> <span class="line" data-startTime="893">We can't actually go hit run </span><span class="line" data-startTime="893">yet, because we don't have our </span><span class="line" data-startTime="895">background page. </span> <span class="line" data-startTime="896">So let's have a look at what </span><span class="line" data-startTime="896">is in our background page. </span> <span class="line" data-startTime="902">So in our background page we're </span><span class="line" data-startTime="902">going to put primarily </span><span class="line" data-startTime="905">just one chunk of </span><span class="line" data-startTime="905">code for now. </span> <span class="line" data-startTime="907">And that's the listen for the </span><span class="line" data-startTime="907">application start event. </span> <span class="line" data-startTime="911">So instead of doing loops and </span><span class="line" data-startTime="911">all kinds of other stuff like </span><span class="line" data-startTime="914">we did before in the legacy </span><span class="line" data-startTime="914">packaged apps, everything is </span><span class="line" data-startTime="921">event-driven, event-based. </span> <span class="line" data-startTime="923">So we want to say right there </span><span class="line" data-startTime="923">in the top bit of our app, </span><span class="line" data-startTime="927">Chrome experimental app </span><span class="line" data-startTime="927">unlaunched, add listener. </span> <span class="line" data-startTime="931">So we want to say we want </span><span class="line" data-startTime="931">to listen for an event. </span></p>

<p><span class="line" data-startTime="933">And we then say all right, when </span><span class="line" data-startTime="933">that event fires we want </span><span class="line" data-startTime="936">to start and create </span><span class="line" data-startTime="936">a new window. </span> <span class="line" data-startTime="939">And the window we want to create </span><span class="line" data-startTime="939">is the index HTML. </span> <span class="line" data-startTime="943">Now, I can also add a couple </span><span class="line" data-startTime="943">additional properties. </span> <span class="line" data-startTime="945">So I can say I want that window </span><span class="line" data-startTime="945">to open up at 1024 by </span><span class="line" data-startTime="949">768, I wanted it to open at 100 </span><span class="line" data-startTime="949">pixels over and 100 pixels </span><span class="line" data-startTime="955">down, and type shell. </span> <span class="line" data-startTime="958">All right, we're just going </span><span class="line" data-startTime="958">to cheat a little bit. </span> <span class="line" data-startTime="961">We're going to copy this and new </span><span class="line" data-startTime="961">file, paste that guy in, </span><span class="line" data-startTime="975">background.js. </span> <span class="line" data-startTime="979">So we've got our background </span><span class="line" data-startTime="979">page in, so it's there. </span> <span class="line" data-startTime="983">Now when the app starts, we're </span><span class="line" data-startTime="983">going to be good to go. </span> <span class="line" data-startTime="990">There's a couple other events </span><span class="line" data-startTime="990">that we can listen for, like </span><span class="line" data-startTime="992">the uninstalled and an </span><span class="line" data-startTime="992">on suspend event. </span></p>

<p><span class="line" data-startTime="996">We're not going to worry about </span><span class="line" data-startTime="996">those right now, because </span><span class="line" data-startTime="997">really the only thing we want to </span><span class="line" data-startTime="997">do right now when we start </span><span class="line" data-startTime="1000">is the on start. </span> <span class="line" data-startTime="1003">Couple of things we need to </span><span class="line" data-startTime="1003">do just in preparation. </span> <span class="line" data-startTime="1006">In the future we probably </span><span class="line" data-startTime="1006">won't have to do this, </span><span class="line" data-startTime="1010">but for now we do. </span> <span class="line" data-startTime="1012">This stuff is only available </span><span class="line" data-startTime="1012">in Chrome Canary. </span> <span class="line" data-startTime="1015">There's a reason for that, kind </span><span class="line" data-startTime="1015">of fun, kind of a little </span><span class="line" data-startTime="1019">bit on the edge. </span> <span class="line" data-startTime="1021">Chrome Canary's where </span><span class="line" data-startTime="1021">you can always get </span><span class="line" data-startTime="1023">the latest and greatest. </span> <span class="line" data-startTime="1026">It will be in dev </span><span class="line" data-startTime="1026">channel soon. </span> <span class="line" data-startTime="1028">Now the great thing about </span><span class="line" data-startTime="1028">running it in Chrome Canary is </span><span class="line" data-startTime="1030">that you can run Chrome Canary </span><span class="line" data-startTime="1030">and Chrome Stable or Chrome </span><span class="line" data-startTime="1033">Beta or Chrome Dev </span><span class="line" data-startTime="1033">side by side. </span> <span class="line" data-startTime="1036">So that way if you're ever like </span><span class="line" data-startTime="1036">OK, well, I want to go </span><span class="line" data-startTime="1038">try something and see how it </span><span class="line" data-startTime="1038">works and I still need to </span><span class="line" data-startTime="1041">actually be able to browse and </span><span class="line" data-startTime="1041">do my real stuff, you can have </span><span class="line" data-startTime="1044">those both side by side. </span></p>

<p><span class="line" data-startTime="1045">So Chrome Canary, and then we </span><span class="line" data-startTime="1045">need to just go add our app, </span><span class="line" data-startTime="1048">just like we did with the </span><span class="line" data-startTime="1048">legacy packaged app. </span> <span class="line" data-startTime="1051">So the first thing I'm </span><span class="line" data-startTime="1051">going to do, let's go </span><span class="line" data-startTime="1053">over to Chrome Canary. </span> <span class="line" data-startTime="1055">And I'm going to close this guy </span><span class="line" data-startTime="1055">out, I'm going to go to </span><span class="line" data-startTime="1059">Tools, and Extensions. </span> <span class="line" data-startTime="1064">So I've already checked the </span><span class="line" data-startTime="1064">developer mode, so I'm going </span><span class="line" data-startTime="1067">to go and load an unpacked </span><span class="line" data-startTime="1067">extension. </span> <span class="line" data-startTime="1069">So I'm going to grab this, click </span><span class="line" data-startTime="1069">Select, a-ha, all right, </span><span class="line" data-startTime="1074">dictionary keys must be </span><span class="line" data-startTime="1074">quoted, so line 16. </span> <span class="line" data-startTime="1082">You know that pink thing that's </span><span class="line" data-startTime="1082">right there might have </span><span class="line" data-startTime="1085">given it away when I was </span><span class="line" data-startTime="1085">doing this early. </span> <span class="line" data-startTime="1094">Try that again. </span> <span class="line" data-startTime="1098">All right, so now if I </span><span class="line" data-startTime="1098">go over here, you'll </span><span class="line" data-startTime="1102">notice I've got my legacy. </span> <span class="line" data-startTime="1104">We've got my final, so we'll see </span><span class="line" data-startTime="1104">what that looks like in a </span><span class="line" data-startTime="1106">sec, but I've got the updated. </span> <span class="line" data-startTime="1109">One thing you'll notice, the </span><span class="line" data-startTime="1109">difference between the legacy </span><span class="line" data-startTime="1111">and the updated, the legacy is </span><span class="line" data-startTime="1111">kind of gray there because I </span><span class="line" data-startTime="1116">don't have an internet </span><span class="line" data-startTime="1116">connection right now. </span></p>

<p><span class="line" data-startTime="1119">By putting that offline enabled </span><span class="line" data-startTime="1119">there, it tells the </span><span class="line" data-startTime="1123">app hey, this app </span><span class="line" data-startTime="1123">works offline. </span> <span class="line" data-startTime="1126">And as we go through and have </span><span class="line" data-startTime="1126">a look at why it works </span><span class="line" data-startTime="1129">offline, you'll get into this </span><span class="line" data-startTime="1129">a little bit deeper. </span> <span class="line" data-startTime="1132">But let's go and </span><span class="line" data-startTime="1132">start our app. </span> <span class="line" data-startTime="1134">Hmm, OK, it's started, but it </span><span class="line" data-startTime="1134">doesn't look very good. </span> <span class="line" data-startTime="1142">I would expect to see some </span><span class="line" data-startTime="1142">numbers there, I'd expect to </span><span class="line" data-startTime="1144">see some data. </span> <span class="line" data-startTime="1146">At least we have an app running, </span><span class="line" data-startTime="1146">our window opened. </span> <span class="line" data-startTime="1150">We've got a sad panda, we </span><span class="line" data-startTime="1150">can deal with sad panda. </span> <span class="line" data-startTime="1158">All right, so let's see that in </span><span class="line" data-startTime="1158">action, we already saw it. </span> <span class="line" data-startTime="1161">What happened there? </span><span class="line" data-startTime="1162">We actually got hit by something </span><span class="line" data-startTime="1162">called Content </span><span class="line" data-startTime="1165">Security Policy there. </span> <span class="line" data-startTime="1168">I asked how many people </span><span class="line" data-startTime="1168">have heard about </span><span class="line" data-startTime="1170">Content Security Policy. </span></p>

<p><span class="line" data-startTime="1172">It's a new thing that's coming, </span><span class="line" data-startTime="1172">and it's going to make </span><span class="line" data-startTime="1174">the web a lot safer. </span> <span class="line" data-startTime="1176">But it also makes things a </span><span class="line" data-startTime="1176">little bit different for us as </span><span class="line" data-startTime="1180">developers, because we have </span><span class="line" data-startTime="1180">to approach things </span><span class="line" data-startTime="1182">in a different way. </span> <span class="line" data-startTime="1184">I kind of like to use a little </span><span class="line" data-startTime="1184">bit of an analogy of it, and </span><span class="line" data-startTime="1188">talk about it as when you </span><span class="line" data-startTime="1188">take the kids trick </span><span class="line" data-startTime="1191">or treating at Halloween. </span> <span class="line" data-startTime="1194">They go out to all these </span><span class="line" data-startTime="1194">strangers' houses and the </span><span class="line" data-startTime="1196">strangers give them candy. </span> <span class="line" data-startTime="1199">And you get home, and as </span><span class="line" data-startTime="1199">parents, the parents sort </span><span class="line" data-startTime="1204">through the candy and say you </span><span class="line" data-startTime="1204">can have this, you can't have </span><span class="line" data-startTime="1206">this, you can have this. </span></p>

<p><span class="line" data-startTime="1208">As a kid, you're like I want </span><span class="line" data-startTime="1208">all of it, it's all good. </span> <span class="line" data-startTime="1211">Like, you want all that </span><span class="line" data-startTime="1211">candy, but some of </span><span class="line" data-startTime="1213">it's potentially dangerous. </span> <span class="line" data-startTime="1216">The web is very similar. </span> <span class="line" data-startTime="1217">When we say hey, you can take </span><span class="line" data-startTime="1217">anything you want, you might </span><span class="line" data-startTime="1224">get good stuff, right? </span><span class="line" data-startTime="1225">You might get great stuff, you </span><span class="line" data-startTime="1225">might get great data feeds, </span><span class="line" data-startTime="1229">you might get whatever </span><span class="line" data-startTime="1229">you want. </span> <span class="line" data-startTime="1231">But somebody out there might be </span><span class="line" data-startTime="1231">malicious and say oh, I'm </span><span class="line" data-startTime="1235">going to give you some bad </span><span class="line" data-startTime="1235">stuff, and you're going to get </span><span class="line" data-startTime="1238">something like a cross-site </span><span class="line" data-startTime="1238">scripting vulnerability. </span></p>

<p><span class="line" data-startTime="1240">Well, Content Security Policy </span><span class="line" data-startTime="1240">basically says on the web you </span><span class="line" data-startTime="1246">are allowed to get content, data </span><span class="line" data-startTime="1246">source, whatever, from </span><span class="line" data-startTime="1250">these places, but </span><span class="line" data-startTime="1250">not from these. </span> <span class="line" data-startTime="1252">So just like when your parents </span><span class="line" data-startTime="1252">came in at Halloween and said </span><span class="line" data-startTime="1255">you can have this candy but you </span><span class="line" data-startTime="1255">can't have this, Content </span><span class="line" data-startTime="1258">Security Policy does </span><span class="line" data-startTime="1258">that same thing. </span> <span class="line" data-startTime="1260">It says this is safe, </span><span class="line" data-startTime="1260">this is not. </span> <span class="line" data-startTime="1264">Now with Chrome packaged apps, </span><span class="line" data-startTime="1264">we said you know what, let's </span><span class="line" data-startTime="1267">make these apps as </span><span class="line" data-startTime="1267">safe as we can. </span> <span class="line" data-startTime="1270">So we put a relatively strict </span><span class="line" data-startTime="1270">set of rules on that. </span> <span class="line" data-startTime="1275">So let's talk about a couple </span><span class="line" data-startTime="1275">of the things that are </span><span class="line" data-startTime="1276">potentially dangerous, why </span><span class="line" data-startTime="1276">we block them, and </span><span class="line" data-startTime="1280">what's going on. </span></p>

<p><span class="line" data-startTime="1282">So any code that comes from </span><span class="line" data-startTime="1282">outside of your control, so </span><span class="line" data-startTime="1285">that's not delivered in the </span><span class="line" data-startTime="1285">package of your application, </span><span class="line" data-startTime="1289">is going to be blocked. </span> <span class="line" data-startTime="1290">That means if you try and go </span><span class="line" data-startTime="1290">get Google Analytics, the </span><span class="line" data-startTime="1294">ga.js kind of code, that's </span><span class="line" data-startTime="1294">going to be blocked. </span> <span class="line" data-startTime="1298">Sure, you get it from </span><span class="line" data-startTime="1298">Google Analytics. </span> <span class="line" data-startTime="1300">We're probably not evil, at </span><span class="line" data-startTime="1300">least I hope we're not. </span> <span class="line" data-startTime="1303">Well, we've got this </span><span class="line" data-startTime="1303">thing that says </span><span class="line" data-startTime="1304">don't be evil, right? </span><span class="line" data-startTime="1305">So that's OK, but we don't know </span><span class="line" data-startTime="1305">where you're going to go </span><span class="line" data-startTime="1309">get all this stuff from. </span> <span class="line" data-startTime="1310">So we say if it's not your </span><span class="line" data-startTime="1310">package, you can't have it. </span></p>

<p><span class="line" data-startTime="1313">Because you might go and get </span><span class="line" data-startTime="1313">something from somebody else's </span><span class="line" data-startTime="1315">source, maybe somebody said </span><span class="line" data-startTime="1315">oh hey, I'll host Google </span><span class="line" data-startTime="1318">Analytics code for you. </span> <span class="line" data-startTime="1319">And all a sudden it's not </span><span class="line" data-startTime="1319">actually that code anymore, </span><span class="line" data-startTime="1323">and they're doing something </span><span class="line" data-startTime="1323">malicious with it. </span> <span class="line" data-startTime="1324">So if it's code from outside of </span><span class="line" data-startTime="1324">your control, you can't put </span><span class="line" data-startTime="1327">it in the app. </span> <span class="line" data-startTime="1329">Second thing, we block </span><span class="line" data-startTime="1329">inline scripts, </span><span class="line" data-startTime="1332">including JavaScript URLs. </span> <span class="line" data-startTime="1337">That one kind of sucks, right? </span><span class="line" data-startTime="1340">We're kind of used to </span><span class="line" data-startTime="1340">sometimes doing </span><span class="line" data-startTime="1342">that kind of stuff. </span></p>

<p><span class="line" data-startTime="1342">Now, it's not exactly a best </span><span class="line" data-startTime="1342">practice for doing that, but </span><span class="line" data-startTime="1346">inline scripts &mdash; the problem </span><span class="line" data-startTime="1346">with inline scripts is, so </span><span class="line" data-startTime="1349">we're looking through this HTML, </span><span class="line" data-startTime="1349">and we come across a </span><span class="line" data-startTime="1352">script block. </span> <span class="line" data-startTime="1353">Well, if we come across a script </span><span class="line" data-startTime="1353">block, how do we know </span><span class="line" data-startTime="1355">that you as the developer </span><span class="line" data-startTime="1355">actually put that in there </span><span class="line" data-startTime="1359">versus somebody injecting that </span><span class="line" data-startTime="1359">in via some kind of cross-site </span><span class="line" data-startTime="1363">scripting attack, or </span><span class="line" data-startTime="1363">something else? </span><span class="line" data-startTime="1365">So anything that could get </span><span class="line" data-startTime="1365">injected into the HTML, nope, </span><span class="line" data-startTime="1371">sorry, we're not going to let </span><span class="line" data-startTime="1371">that happen because it could </span><span class="line" data-startTime="1374">potentially allow that </span><span class="line" data-startTime="1374">cross-site scripting. </span></p>

<p><span class="line" data-startTime="1377">This one I think should be </span><span class="line" data-startTime="1377">pretty obvious why we don't </span><span class="line" data-startTime="1380">let you have eval. </span> <span class="line" data-startTime="1382">Eval is kind of evil, it's </span><span class="line" data-startTime="1382">one letter away. </span> <span class="line" data-startTime="1385">So unsafe code execution like </span><span class="line" data-startTime="1385">eval, because you could </span><span class="line" data-startTime="1391">basically take any text, run it </span><span class="line" data-startTime="1391">through eval, turn it into </span><span class="line" data-startTime="1395">some nice, cool, nasty </span><span class="line" data-startTime="1395">script, not so good. </span> <span class="line" data-startTime="1399">Pretty much every browser today </span><span class="line" data-startTime="1399">supports JSON.parse and </span><span class="line" data-startTime="1403">JSON.stringify. </span> <span class="line" data-startTime="1403">String/file. </span> <span class="line" data-startTime="1404">So realistically, the need for </span><span class="line" data-startTime="1404">eval is pretty limited. </span> <span class="line" data-startTime="1408">There are a few places where </span><span class="line" data-startTime="1408">eval is useful and </span><span class="line" data-startTime="1411">where eval is good. </span> <span class="line" data-startTime="1416">Safe, good, protecting your </span><span class="line" data-startTime="1416">users, protecting your </span><span class="line" data-startTime="1420">customers, protecting your </span><span class="line" data-startTime="1420">data, potentially evil. </span> <span class="line" data-startTime="1424">Hmm, I usually like the </span><span class="line" data-startTime="1424">safe, good better. </span></p>

<p><span class="line" data-startTime="1429">So let's have a look at a </span><span class="line" data-startTime="1429">practical example, like a very </span><span class="line" data-startTime="1431">specific example here. </span> <span class="line" data-startTime="1433">So this is in the HTML of my </span><span class="line" data-startTime="1433">application, I've got a </span><span class="line" data-startTime="1436">function that says callme and </span><span class="line" data-startTime="1436">it prints out a little line. </span> <span class="line" data-startTime="1440">And I've got a button, and the </span><span class="line" data-startTime="1440">button has an onclick directly </span><span class="line" data-startTime="1444">on it that calls the function, </span><span class="line" data-startTime="1444">and I've got </span><span class="line" data-startTime="1448">some text in there. </span> <span class="line" data-startTime="1449">So that's not going </span><span class="line" data-startTime="1449">to work, right? </span><span class="line" data-startTime="1452">We've got both an inline script </span><span class="line" data-startTime="1452">block, and we've got </span><span class="line" data-startTime="1460">inline script in our </span><span class="line" data-startTime="1460">button as well &mdash; </span><span class="line" data-startTime="1462">not going to happen. </span></p>

<p><span class="line" data-startTime="1464">So here's the better </span><span class="line" data-startTime="1464">way to do it. </span> <span class="line" data-startTime="1466">It's a couple more lines of </span><span class="line" data-startTime="1466">code, but it's the better </span><span class="line" data-startTime="1469">practice to do it. </span> <span class="line" data-startTime="1470">First thing we do, we've got our </span><span class="line" data-startTime="1470">script block that links to </span><span class="line" data-startTime="1477">our file, and then we put </span><span class="line" data-startTime="1477">our button there that </span><span class="line" data-startTime="1480">says hey, call me. </span> <span class="line" data-startTime="1482">It's got an ID on the button so </span><span class="line" data-startTime="1482">that we can get access to </span><span class="line" data-startTime="1484">it a little bit later. </span> <span class="line" data-startTime="1486">And then we have our </span><span class="line" data-startTime="1486">function in the </span><span class="line" data-startTime="1488">JavaScript that says callme. </span></p>

<p><span class="line" data-startTime="1490">And we add an event listener </span><span class="line" data-startTime="1490">to say hey, go grab that </span><span class="line" data-startTime="1495">callme button and add a listen </span><span class="line" data-startTime="1495">so that when the user clicks </span><span class="line" data-startTime="1498">on it maybe they call. </span> <span class="line" data-startTime="1500">Sorry, bad pun, bad joke, I like </span><span class="line" data-startTime="1500">that song, I admit it. </span> <span class="line" data-startTime="1505">I'll go away in shame now. </span> <span class="line" data-startTime="1508">So this is the better </span><span class="line" data-startTime="1508">way to do it. </span> <span class="line" data-startTime="1510">There's a bunch of really great </span><span class="line" data-startTime="1510">content out there that </span><span class="line" data-startTime="1513">talks about CSP. </span> <span class="line" data-startTime="1516">I've got a link to it at the end </span><span class="line" data-startTime="1516">of the slides, it's really </span><span class="line" data-startTime="1518">worth having a look at. </span> <span class="line" data-startTime="1520">Converting from inline script </span><span class="line" data-startTime="1520">blocks and that kind of stuff, </span><span class="line" data-startTime="1524">not an impossible thing to do. </span> <span class="line" data-startTime="1526">It takes a little bit of work </span><span class="line" data-startTime="1526">and a little bit of rethinking </span><span class="line" data-startTime="1529">on our part, but something </span><span class="line" data-startTime="1529">really important </span><span class="line" data-startTime="1531">that we should do. </span></p>

<p><span class="line" data-startTime="1533">So one of the things I'm going </span><span class="line" data-startTime="1533">to do, let's actually get out </span><span class="line" data-startTime="1536">of here for a sec. </span> <span class="line" data-startTime="1539">And before we go over there, </span><span class="line" data-startTime="1539">let's tab over here. </span> <span class="line" data-startTime="1542">So one of the reasons why I </span><span class="line" data-startTime="1542">chose to use this app and why </span><span class="line" data-startTime="1547">I chose to use Angular, is </span><span class="line" data-startTime="1547">Angular actually has some CSP </span><span class="line" data-startTime="1555">ability to deal with it right </span><span class="line" data-startTime="1555">inside so that I don't have to </span><span class="line" data-startTime="1560">go and deal with all </span><span class="line" data-startTime="1560">the craziness. </span> <span class="line" data-startTime="1562">I can actually just go ng-csp. </span> <span class="line" data-startTime="1567">And that now, if I did </span><span class="line" data-startTime="1567">everything right, I'm going to </span><span class="line" data-startTime="1571">close this guy, open this up, </span><span class="line" data-startTime="1571">and I didn't do it right. </span></p>

<p><span class="line" data-startTime="1580">All right, I'm going to cheat </span><span class="line" data-startTime="1580">one sec, I'm going to have a </span><span class="line" data-startTime="1587">look at my file over here. </span> <span class="line" data-startTime="1588">Ng-csp, that was the </span><span class="line" data-startTime="1588">right thing to do? </span><span class="line" data-startTime="1590">Oh, yeah, reloading helps. </span> <span class="line" data-startTime="1596">So over here, go reload my </span><span class="line" data-startTime="1596">app, and sure enough, it </span><span class="line" data-startTime="1603">doesn't work again. </span> <span class="line" data-startTime="1605">I can come back to that, because </span><span class="line" data-startTime="1605">I've actually got </span><span class="line" data-startTime="1607">something else I'm going to </span><span class="line" data-startTime="1607">do in my next step here. </span> <span class="line" data-startTime="1617">So one of the other things that </span><span class="line" data-startTime="1617">is really important and </span><span class="line" data-startTime="1621">really useful to do in moving </span><span class="line" data-startTime="1621">your app to a packaged app, is </span><span class="line" data-startTime="1627">taking that shared and common </span><span class="line" data-startTime="1627">functionality, pulling it out </span><span class="line" data-startTime="1631">of your JavaScript places where </span><span class="line" data-startTime="1631">it's going to get used </span><span class="line" data-startTime="1635">in multiple places, </span><span class="line" data-startTime="1635">and putting it </span><span class="line" data-startTime="1637">into the same place. </span> <span class="line" data-startTime="1639">So with the RSS reader </span><span class="line" data-startTime="1639">application we've got, it goes </span><span class="line" data-startTime="1644">up and it pulls for data, and </span><span class="line" data-startTime="1644">then it pulls that down and it </span><span class="line" data-startTime="1648">goes and puts it into </span><span class="line" data-startTime="1648">a data store. </span> <span class="line" data-startTime="1650">So for something like this, we </span><span class="line" data-startTime="1650">want to take that and put that </span><span class="line" data-startTime="1654">into the background page. </span></p>

<p><span class="line" data-startTime="1656">So that we take all that shared </span><span class="line" data-startTime="1656">code that's all over </span><span class="line" data-startTime="1659">the place, maybe a little bit </span><span class="line" data-startTime="1659">spaghetti-like, and try and </span><span class="line" data-startTime="1662">really reduce some of the </span><span class="line" data-startTime="1662">work that's going on. </span> <span class="line" data-startTime="1666">One of the ways that </span><span class="line" data-startTime="1666">you can do that and </span><span class="line" data-startTime="1669">that's really useful &mdash; </span><span class="line" data-startTime="1670">we'll dive into the </span><span class="line" data-startTime="1670">chrome.storage API in a sec &mdash; </span><span class="line" data-startTime="1675">but in my application I could </span><span class="line" data-startTime="1675">take this chrome.storage </span><span class="line" data-startTime="1679">listener and I can say hey, </span><span class="line" data-startTime="1679">anytime anything changed I </span><span class="line" data-startTime="1682">want you to go listen </span><span class="line" data-startTime="1682">for this. </span></p>

<p><span class="line" data-startTime="1684">And I want to update all of the </span><span class="line" data-startTime="1684">rest of the page so that </span><span class="line" data-startTime="1691">oh hey, I just got new feeds, </span><span class="line" data-startTime="1691">let's go update what's </span><span class="line" data-startTime="1694">displayed to the user. </span> <span class="line" data-startTime="1698">So I was talking a little bit </span><span class="line" data-startTime="1698">about the package, making </span><span class="line" data-startTime="1704">stuff work offline. </span> <span class="line" data-startTime="1706">And making applications work </span><span class="line" data-startTime="1706">offline, we can do it on the </span><span class="line" data-startTime="1709">web today, but it is a small </span><span class="line" data-startTime="1709">pain in the bum to put it </span><span class="line" data-startTime="1712">mildly, right? </span><span class="line" data-startTime="1713">Like, there's AppCache, then </span><span class="line" data-startTime="1713">you've got to deal with well, </span><span class="line" data-startTime="1716">where are you going to put it? </span><span class="line" data-startTime="1717">Are you going to put it in an </span><span class="line" data-startTime="1717">index db, you going to put it </span><span class="line" data-startTime="1719">in local storage, are you </span><span class="line" data-startTime="1719">going to put it &mdash; </span><span class="line" data-startTime="1721">where are you going to put it? </span><span class="line" data-startTime="1723">And well, typically as web </span><span class="line" data-startTime="1723">developers we say hey, let's </span><span class="line" data-startTime="1727">go get data from the cloud and </span><span class="line" data-startTime="1727">then display it on screen. </span></p>

<p><span class="line" data-startTime="1733">Oh well, maybe we should just </span><span class="line" data-startTime="1733">store it locally, too. </span> <span class="line" data-startTime="1736">So when you start to think about </span><span class="line" data-startTime="1736">your applications and </span><span class="line" data-startTime="1739">how they should work offline, we </span><span class="line" data-startTime="1739">want to think about them in </span><span class="line" data-startTime="1743">a little bit of a </span><span class="line" data-startTime="1743">different way. </span> <span class="line" data-startTime="1746">So we've got our packaged app, </span><span class="line" data-startTime="1746">and our packaged app should </span><span class="line" data-startTime="1749">talk to a local data </span><span class="line" data-startTime="1749">store first. </span> <span class="line" data-startTime="1752">So some kind of local </span><span class="line" data-startTime="1752">data storage. </span> <span class="line" data-startTime="1755">That way, if I have no network </span><span class="line" data-startTime="1755">connection I'm always going to </span><span class="line" data-startTime="1760">be able to pull data in. </span> <span class="line" data-startTime="1762">I start my app, hey look, </span><span class="line" data-startTime="1762">there's data. </span> <span class="line" data-startTime="1765">It may be stale and old data, </span><span class="line" data-startTime="1765">but at least I've got </span><span class="line" data-startTime="1768">something, right? </span><span class="line" data-startTime="1768">Like, you go to Goggle+, you go </span><span class="line" data-startTime="1768">to any other site, you want </span><span class="line" data-startTime="1772">to see something when </span><span class="line" data-startTime="1772">the app starts. </span> <span class="line" data-startTime="1778">Now, it'd be really kick butt if </span><span class="line" data-startTime="1778">we could also store all of </span><span class="line" data-startTime="1782">that data in the cloud </span><span class="line" data-startTime="1782">so that it was synced </span><span class="line" data-startTime="1784">across all of my computers. </span> <span class="line" data-startTime="1787">So that I didn't have to go oh, </span><span class="line" data-startTime="1787">hey, well I haven't run </span><span class="line" data-startTime="1790">this app in a while on this </span><span class="line" data-startTime="1790">computer, so I guess I don't </span><span class="line" data-startTime="1793">have this data. </span></p>

<p><span class="line" data-startTime="1794">I want all the stuff synced </span><span class="line" data-startTime="1794">across the cloud so that I </span><span class="line" data-startTime="1797">open my Chromebook, great, </span><span class="line" data-startTime="1797">I've got all that data. </span> <span class="line" data-startTime="1800">I open my iPad with Chrome on </span><span class="line" data-startTime="1800">it, I've got all that data. </span> <span class="line" data-startTime="1805">I've got, open whatever device </span><span class="line" data-startTime="1805">I've got, I've got all of that </span><span class="line" data-startTime="1808">stuff synced across the cloud. </span> <span class="line" data-startTime="1810">And there's a great new Chrome </span><span class="line" data-startTime="1810">API that's going </span><span class="line" data-startTime="1812">to help me do that. </span> <span class="line" data-startTime="1814">And then finally, from our local </span><span class="line" data-startTime="1814">data store, or from our </span><span class="line" data-startTime="1822">background page, we want to go </span><span class="line" data-startTime="1822">and have that talk to the </span><span class="line" data-startTime="1826">backend services for </span><span class="line" data-startTime="1826">our application. </span> <span class="line" data-startTime="1829">So our packaged app, our UI, is </span><span class="line" data-startTime="1829">never talking to any kind </span><span class="line" data-startTime="1833">of application server-side </span><span class="line" data-startTime="1833">stuff. </span> <span class="line" data-startTime="1836">All of that is happening on </span><span class="line" data-startTime="1836">a separate business layer. </span></p>

<p><span class="line" data-startTime="1839">When you think about, if you've </span><span class="line" data-startTime="1839">taken computer science </span><span class="line" data-startTime="1843">classes and you separate out, </span><span class="line" data-startTime="1843">hey, here's my business layer, </span><span class="line" data-startTime="1845">here's my display layer, </span><span class="line" data-startTime="1845">here's all this stuff. </span> <span class="line" data-startTime="1847">You're separating all those out </span><span class="line" data-startTime="1847">and that's what we really </span><span class="line" data-startTime="1851">want to see in these </span><span class="line" data-startTime="1851">packaged apps. </span> <span class="line" data-startTime="1852">So that your app talks to </span><span class="line" data-startTime="1852">the data store, pulls </span><span class="line" data-startTime="1856">everything in there. </span> <span class="line" data-startTime="1858">And then the background page or </span><span class="line" data-startTime="1858">any of those other pieces </span><span class="line" data-startTime="1860">then go and pull stuff </span><span class="line" data-startTime="1860">in so that we can </span><span class="line" data-startTime="1863">deal with those pieces. </span> <span class="line" data-startTime="1866">So we have this new set of </span><span class="line" data-startTime="1866">chrome.storage APIs. </span> <span class="line" data-startTime="1873">They give you all the power of </span><span class="line" data-startTime="1873">Google's Chrome Sync stuff </span><span class="line" data-startTime="1878">without having to go deal with </span><span class="line" data-startTime="1878">oh, well, I got to go set up a </span><span class="line" data-startTime="1882">bunch of servers. </span> <span class="line" data-startTime="1882">I got to figure out how </span><span class="line" data-startTime="1882">to do data syncing. </span></p>

<p><span class="line" data-startTime="1884">I got to figure out how to </span><span class="line" data-startTime="1884">do all these things. </span> <span class="line" data-startTime="1888">Now it's not meant for </span><span class="line" data-startTime="1888">you to store tons and </span><span class="line" data-startTime="1891">tons and tons of data. </span> <span class="line" data-startTime="1892">That's Google Drive, and we do </span><span class="line" data-startTime="1892">have some easy abilities for </span><span class="line" data-startTime="1897">you to get into that. </span> <span class="line" data-startTime="1898">They're not quite there yet, </span><span class="line" data-startTime="1898">we're not going to talk about </span><span class="line" data-startTime="1900">those in today's session. </span> <span class="line" data-startTime="1902">But to be able to store user </span><span class="line" data-startTime="1902">settings, not necessarily </span><span class="line" data-startTime="1908">login information, but </span><span class="line" data-startTime="1908">application settings, or </span><span class="line" data-startTime="1911">little bits of data like key </span><span class="line" data-startTime="1911">value pairs is exactly what we </span><span class="line" data-startTime="1915">want to use this chrome.storage </span><span class="line" data-startTime="1915">API. </span> <span class="line" data-startTime="1918">So there's a couple of things </span><span class="line" data-startTime="1918">we need to do it in </span><span class="line" data-startTime="1920">order to use it. </span> <span class="line" data-startTime="1921">One, we need to turn on the </span><span class="line" data-startTime="1921">storage permission, because it </span><span class="line" data-startTime="1924">needs a permission. </span> <span class="line" data-startTime="1926">And then there's two things we </span><span class="line" data-startTime="1926">can do, we can get and we </span><span class="line" data-startTime="1929">could save &mdash; </span><span class="line" data-startTime="1931">or I guess that's </span><span class="line" data-startTime="1931">technically set. </span></p>

<p><span class="line" data-startTime="1934">There are some other APIs, but </span><span class="line" data-startTime="1934">these are the key things I </span><span class="line" data-startTime="1936">want to show you here. </span> <span class="line" data-startTime="1938">So if I want to save something, </span><span class="line" data-startTime="1938">I use this set. </span> <span class="line" data-startTime="1943">Let me highlight this out </span><span class="line" data-startTime="1943">here for a sec, and </span><span class="line" data-startTime="1945">we send it in object. </span> <span class="line" data-startTime="1947">That object is just a name value </span><span class="line" data-startTime="1947">pair, or a JSON Object. </span> <span class="line" data-startTime="1950">So I've got hey, here's all of </span><span class="line" data-startTime="1950">the Chromium articles that </span><span class="line" data-startTime="1954">I've got that I want to </span><span class="line" data-startTime="1954">save, and I give it </span><span class="line" data-startTime="1957">that list of items. </span> <span class="line" data-startTime="1959">And then I've got a call back </span><span class="line" data-startTime="1959">that's used to say all right, </span><span class="line" data-startTime="1963">everything's saved, you're good </span><span class="line" data-startTime="1963">to go, all hunky dory. </span></p>

<p><span class="line" data-startTime="1970">To get that stuff out of the </span><span class="line" data-startTime="1970">back side, we use the </span><span class="line" data-startTime="1977">chrome.storage.sync.get, and we </span><span class="line" data-startTime="1977">just ask for what we want </span><span class="line" data-startTime="1985">and we give it a call </span><span class="line" data-startTime="1985">back again. </span> <span class="line" data-startTime="1987">And so Chrome says OK, </span><span class="line" data-startTime="1987">yep, you want that? </span><span class="line" data-startTime="1990">Sure, no problem, I'll give </span><span class="line" data-startTime="1990">that to you in a sec. </span> <span class="line" data-startTime="1992">Goes off, gets it, and pulls </span><span class="line" data-startTime="1992">it down and gives it to you </span><span class="line" data-startTime="1995">via that callback. </span> <span class="line" data-startTime="1998">So let's actually go take a look </span><span class="line" data-startTime="1998">at the code we've got. </span> <span class="line" data-startTime="2003">And trying to do the two things </span><span class="line" data-startTime="2003">that I just talked </span><span class="line" data-startTime="2008">about up on stage would have </span><span class="line" data-startTime="2008">been a little messy because it </span><span class="line" data-startTime="2013">changes a lot of stuff </span><span class="line" data-startTime="2013">in this application. </span> <span class="line" data-startTime="2015">So I want to show you the things </span><span class="line" data-startTime="2015">that we did in order to </span><span class="line" data-startTime="2019">get that to work. </span></p>

<p><span class="line" data-startTime="2019">So our background page before, </span><span class="line" data-startTime="2019">you remember, was just that </span><span class="line" data-startTime="2025">start for our application. </span> <span class="line" data-startTime="2027">So we've got that still in here, </span><span class="line" data-startTime="2027">so we add our Chrome </span><span class="line" data-startTime="2033">Experimental app launched, and </span><span class="line" data-startTime="2033">we open up our window. </span> <span class="line" data-startTime="2041">And we've moved a lot of the </span><span class="line" data-startTime="2041">code that our application is </span><span class="line" data-startTime="2045">using out into here. </span> <span class="line" data-startTime="2048">So we've got a factor here </span><span class="line" data-startTime="2048">that's going to go and do our </span><span class="line" data-startTime="2052">feed fetching. </span> <span class="line" data-startTime="2053">So all of our feed fetching, all </span><span class="line" data-startTime="2053">of our feed syncing, all </span><span class="line" data-startTime="2063">of that is done here in </span><span class="line" data-startTime="2063">our background page. </span> <span class="line" data-startTime="2066">So we've got our factory to </span><span class="line" data-startTime="2066">get our feeds, we've got a </span><span class="line" data-startTime="2071">factory again here where we're </span><span class="line" data-startTime="2071">refreshing things, and then </span><span class="line" data-startTime="2074">we've got some angular stuff as </span><span class="line" data-startTime="2074">well down here, just sort </span><span class="line" data-startTime="2078">of angular filtering stuff. </span></p>

<p><span class="line" data-startTime="2081">We've also gone and created </span><span class="line" data-startTime="2081">a store module. </span> <span class="line" data-startTime="2085">So Angular allows you to have </span><span class="line" data-startTime="2085">these concepts of modules. </span> <span class="line" data-startTime="2088">So we've got in here our store </span><span class="line" data-startTime="2088">module, we create our factory, </span><span class="line" data-startTime="2091">and we want to say hey, we've </span><span class="line" data-startTime="2091">got our state store and our </span><span class="line" data-startTime="2096">content store. </span> <span class="line" data-startTime="2102">As we're working on this, we </span><span class="line" data-startTime="2102">sort of said OK, we're storing </span><span class="line" data-startTime="2108">large amounts of data. </span> <span class="line" data-startTime="2110">How do we do that in </span><span class="line" data-startTime="2110">a really good way? </span><span class="line" data-startTime="2113">How do we take all of that </span><span class="line" data-startTime="2113">information and put it in the </span><span class="line" data-startTime="2116">user's hands without sending </span><span class="line" data-startTime="2116">lots of data up to the cloud, </span><span class="line" data-startTime="2122">without overloading all the </span><span class="line" data-startTime="2122">user's synced storage space </span><span class="line" data-startTime="2126">and complexities? </span><span class="line" data-startTime="2128">Said OK, well, what if we </span><span class="line" data-startTime="2128">separate out the blog feed, </span><span class="line" data-startTime="2134">each RSS poster, each RSS </span><span class="line" data-startTime="2134">item, from its state? </span><span class="line" data-startTime="2140">So we said we want to sync all </span><span class="line" data-startTime="2140">of the state, whether it's </span><span class="line" data-startTime="2143">been read or not, and whether </span><span class="line" data-startTime="2143">it's been starred or not, and </span><span class="line" data-startTime="2147">we're going to store that </span><span class="line" data-startTime="2147">up in the cloud. </span> <span class="line" data-startTime="2148">Because that's, what, </span><span class="line" data-startTime="2148">two bits? </span><span class="line" data-startTime="2151">It's not even a byte for </span><span class="line" data-startTime="2151">that matter, because </span><span class="line" data-startTime="2154">it's just like a Boolean. </span> <span class="line" data-startTime="2156">And then we store all of the </span><span class="line" data-startTime="2156">information about the feeds on </span><span class="line" data-startTime="2161">the user's local computer, </span><span class="line" data-startTime="2161">because we can always go get </span><span class="line" data-startTime="2164">those later, those </span><span class="line" data-startTime="2164">are easy to get. </span></p>

<p><span class="line" data-startTime="2167">So we've separated those two </span><span class="line" data-startTime="2167">things in our data storage. </span> <span class="line" data-startTime="2172">And then when we go to actually </span><span class="line" data-startTime="2172">get these things, </span><span class="line" data-startTime="2177">just sort of scroll down here. </span> <span class="line" data-startTime="2185">So we go and get our feeds from </span><span class="line" data-startTime="2185">content storage, which </span><span class="line" data-startTime="2190">Angular then has a way to say </span><span class="line" data-startTime="2190">hey, if there's everything in </span><span class="line" data-startTime="2193">there, we want to go and do </span><span class="line" data-startTime="2193">a forEach on each of them. </span> <span class="line" data-startTime="2196">So we're going to go and iterate </span><span class="line" data-startTime="2196">through each item and </span><span class="line" data-startTime="2199">go and add them to the </span><span class="line" data-startTime="2199">user's display. </span> <span class="line" data-startTime="2205">So let's go and add this guy. </span> <span class="line" data-startTime="2207">So I'm going to load our </span><span class="line" data-startTime="2207">unpacked extension, and we'll </span><span class="line" data-startTime="2210">grab number three that </span><span class="line" data-startTime="2210">we've refactored. </span> <span class="line" data-startTime="2221">And sure enough, now we </span><span class="line" data-startTime="2221">don't have anything. </span> <span class="line" data-startTime="2225">But that's OK right now, </span><span class="line" data-startTime="2225">because I don't have us </span><span class="line" data-startTime="2228">plugged into the network </span><span class="line" data-startTime="2228">right yet. </span> <span class="line" data-startTime="2230">So now we've got all </span><span class="line" data-startTime="2230">of our data. </span></p>

<p><span class="line" data-startTime="2233">Everything works right, but </span><span class="line" data-startTime="2233">we're trying to pull </span><span class="line" data-startTime="2236">everything from our </span><span class="line" data-startTime="2236">local machine, </span><span class="line" data-startTime="2238">we don't have anything. </span> <span class="line" data-startTime="2239">So let's try it again. </span> <span class="line" data-startTime="2241">I'm going to close the window. </span> <span class="line" data-startTime="2243">Actually, I'm going to </span><span class="line" data-startTime="2243">join a network first. </span> <span class="line" data-startTime="2247">I'm going to be a little bit </span><span class="line" data-startTime="2247">brave, I'm going to try it on </span><span class="line" data-startTime="2251">wireless first. </span> <span class="line" data-startTime="2253">Think we can get it </span><span class="line" data-startTime="2253">working today? </span><span class="line" data-startTime="2260">All right, so close </span><span class="line" data-startTime="2260">this window. </span> <span class="line" data-startTime="2268">And so it's fair enough, </span><span class="line" data-startTime="2268">now we've got our data. </span> <span class="line" data-startTime="2274">So we've got everything in </span><span class="line" data-startTime="2274">there, and I'm going to go </span><span class="line" data-startTime="2278">turn Wi-Fi off again. </span> <span class="line" data-startTime="2282">So now because I've turned the </span><span class="line" data-startTime="2282">Wi-Fi off, if we try and go </span><span class="line" data-startTime="2285">get everything from the </span><span class="line" data-startTime="2285">server it should work. </span> <span class="line" data-startTime="2290">So close this guy out, start it </span><span class="line" data-startTime="2290">again, refactored, and sure </span><span class="line" data-startTime="2298">enough we have everything </span><span class="line" data-startTime="2298">back again. </span> <span class="line" data-startTime="2301">Now if I were to go and try this </span><span class="line" data-startTime="2301">on another computer that </span><span class="line" data-startTime="2304">I'm signed into, all of the </span><span class="line" data-startTime="2304">things that I've read are </span><span class="line" data-startTime="2309">going to be synced across </span><span class="line" data-startTime="2309">the different computers. </span></p>

<p><span class="line" data-startTime="2311">Now it's going to have to go and </span><span class="line" data-startTime="2311">pull that data down on the </span><span class="line" data-startTime="2314">second computer, but the key </span><span class="line" data-startTime="2314">point being it knows what I've </span><span class="line" data-startTime="2317">read, knows what I've starred, </span><span class="line" data-startTime="2317">it knows what I like. </span> <span class="line" data-startTime="2320">So I'm able to store specific </span><span class="line" data-startTime="2320">sets of information about what </span><span class="line" data-startTime="2326">I'm really interested in, or how </span><span class="line" data-startTime="2326">I want to go and do these </span><span class="line" data-startTime="2329">things, across different </span><span class="line" data-startTime="2329">places. </span> <span class="line" data-startTime="2342">Keeping the application up to </span><span class="line" data-startTime="2342">date is also really useful. </span> <span class="line" data-startTime="2345">It would be nice if when I </span><span class="line" data-startTime="2345">first started the app it </span><span class="line" data-startTime="2349">didn't have to go and download </span><span class="line" data-startTime="2349">all the stuff and say all </span><span class="line" data-startTime="2353">right that first time, but </span><span class="line" data-startTime="2353">instead it just always stayed </span><span class="line" data-startTime="2358">up to date. </span> <span class="line" data-startTime="2359">So that the first time I started </span><span class="line" data-startTime="2359">it, or that first time </span><span class="line" data-startTime="2361">I opened it after not using it </span><span class="line" data-startTime="2361">for two days, all of my data's </span><span class="line" data-startTime="2364">there, right? </span><span class="line" data-startTime="2366">You go to Google+, wouldn't it </span><span class="line" data-startTime="2366">be nice if that first time it </span><span class="line" data-startTime="2369">loaded it was all fresh data </span><span class="line" data-startTime="2369">instead of going oh, now I got </span><span class="line" data-startTime="2373">to wait for it to load, do ta </span><span class="line" data-startTime="2373">do ta do, OK, now I can see </span><span class="line" data-startTime="2376">what I want. </span></p>

<p><span class="line" data-startTime="2377">We want that ability so that </span><span class="line" data-startTime="2377">when users start the </span><span class="line" data-startTime="2379">application, users want </span><span class="line" data-startTime="2379">that fast, fast. </span> <span class="line" data-startTime="2383">They want &mdash; </span><span class="line" data-startTime="2385">there's something else, like a </span><span class="line" data-startTime="2385">different app that's just as </span><span class="line" data-startTime="2388">good but theirs is faster, </span><span class="line" data-startTime="2388">they're going to go use the </span><span class="line" data-startTime="2391">faster app. </span> <span class="line" data-startTime="2392">They're going to use somebody </span><span class="line" data-startTime="2392">else's app. </span> <span class="line" data-startTime="2394">So we want to make sure your </span><span class="line" data-startTime="2394">apps are nice and snappy, your </span><span class="line" data-startTime="2396">apps are nice and fast. </span> <span class="line" data-startTime="2398">So there's this new </span><span class="line" data-startTime="2398">Chrome.alarms API, and it </span><span class="line" data-startTime="2402">works very similarly to set </span><span class="line" data-startTime="2402">time out or set interval. </span> <span class="line" data-startTime="2407">It's got three &mdash; </span><span class="line" data-startTime="2410">I guess it's got three, I </span><span class="line" data-startTime="2410">thought it had four &mdash; </span><span class="line" data-startTime="2413">it's got three different </span><span class="line" data-startTime="2413">settings on it. </span></p>

<p><span class="line" data-startTime="2415">One, Delay, so you can say hey, </span><span class="line" data-startTime="2415">from the time you fire </span><span class="line" data-startTime="2419">this event, I want you to wait </span><span class="line" data-startTime="2419">five minutes and then fire. </span> <span class="line" data-startTime="2424">It's got a Period, which is very </span><span class="line" data-startTime="2424">similar to set interval, </span><span class="line" data-startTime="2427">and it's going to fire </span><span class="line" data-startTime="2427">every X minutes. </span> <span class="line" data-startTime="2430">And then finally there's a </span><span class="line" data-startTime="2430">When that's like for a </span><span class="line" data-startTime="2432">specific time. </span> <span class="line" data-startTime="2435">Now for alarms, to use that, </span><span class="line" data-startTime="2435">again we need to turn on a </span><span class="line" data-startTime="2438">specific permission. </span> <span class="line" data-startTime="2442">So we're going to say hey, we </span><span class="line" data-startTime="2442">need that alarms permission. </span> <span class="line" data-startTime="2447">And then we go and </span><span class="line" data-startTime="2447">create an alarm. </span> <span class="line" data-startTime="2449">We give it a name, and we give </span><span class="line" data-startTime="2449">it a particular property. </span> <span class="line" data-startTime="2453">So whether we want it to fire </span><span class="line" data-startTime="2453">in a period of minutes, </span><span class="line" data-startTime="2456">whether we want to fire </span><span class="line" data-startTime="2456">it in a delay, </span><span class="line" data-startTime="2458">or a when, or whatever. </span></p>

<p><span class="line" data-startTime="2460">So in this particular case, </span><span class="line" data-startTime="2460">we're going to use a period in </span><span class="line" data-startTime="2463">five minutes, which is </span><span class="line" data-startTime="2463">going to fire the </span><span class="line" data-startTime="2467">event every five minutes. </span> <span class="line" data-startTime="2469">Now, remember one of the things </span><span class="line" data-startTime="2469">that I said earlier was </span><span class="line" data-startTime="2474">that it's really important that </span><span class="line" data-startTime="2474">these apps really work </span><span class="line" data-startTime="2479">seamlessly and not cause </span><span class="line" data-startTime="2479">a lot of headache or </span><span class="line" data-startTime="2481">anything like that. </span> <span class="line" data-startTime="2482">So we don't want to have </span><span class="line" data-startTime="2482">functions that are sitting </span><span class="line" data-startTime="2486">there looping. </span> <span class="line" data-startTime="2487">We want everything to </span><span class="line" data-startTime="2487">be event-based. </span></p>

<p><span class="line" data-startTime="2488">So because this is an event, </span><span class="line" data-startTime="2488">we need to create </span><span class="line" data-startTime="2491">an add event listener. </span> <span class="line" data-startTime="2494">So we're going to add </span><span class="line" data-startTime="2494">our event listener. </span> <span class="line" data-startTime="2496">So I'm going to go and I'm just </span><span class="line" data-startTime="2496">going to &mdash; in fact, we'll </span><span class="line" data-startTime="2498">pop this into our application. </span> <span class="line" data-startTime="2502">And I'm going to </span><span class="line" data-startTime="2502">put this into &mdash; </span><span class="line" data-startTime="2505">not that background &mdash; </span><span class="line" data-startTime="2507">and I'm just going to close a </span><span class="line" data-startTime="2507">couple of these so that we can </span><span class="line" data-startTime="2509">actually see where we are. </span> <span class="line" data-startTime="2514">I've put in a place where I want </span><span class="line" data-startTime="2514">to put my background, so </span><span class="line" data-startTime="2517">I'm going to add my listener. </span> <span class="line" data-startTime="2522">Let's make that a </span><span class="line" data-startTime="2522">little prettier. </span></p>

<p><span class="line" data-startTime="2526">And the other thing we need </span><span class="line" data-startTime="2526">to do is start our alarm. </span> <span class="line" data-startTime="2530">Now I've already added the </span><span class="line" data-startTime="2530">alarms permission, so we don't </span><span class="line" data-startTime="2532">need to go add that. </span> <span class="line" data-startTime="2536">Pop that in, now the app will </span><span class="line" data-startTime="2536">stay up to date and everything </span><span class="line" data-startTime="2539">will fire every five minutes. </span> <span class="line" data-startTime="2542">Now, I probably should have </span><span class="line" data-startTime="2542">picked a blog feed that was </span><span class="line" data-startTime="2546">posting more than every five </span><span class="line" data-startTime="2546">minutes, or probably posting </span><span class="line" data-startTime="2549">once a day right now because </span><span class="line" data-startTime="2549">of I/O. But you can imagine </span><span class="line" data-startTime="2552">for something like this where </span><span class="line" data-startTime="2552">you've got something that you </span><span class="line" data-startTime="2554">want to keep up to date, maybe </span><span class="line" data-startTime="2554">a friend's feed, or maybe </span><span class="line" data-startTime="2558">something from Twitter, or any </span><span class="line" data-startTime="2558">other API that's changing on a </span><span class="line" data-startTime="2563">regular basis, you want that </span><span class="line" data-startTime="2563">to fire much more quickly. </span> <span class="line" data-startTime="2577">So there's a bunch of other new </span><span class="line" data-startTime="2577">functionality in APIs that </span><span class="line" data-startTime="2580">are available to us that </span><span class="line" data-startTime="2580">are pretty slick. </span> <span class="line" data-startTime="2584">Some of them didn't really fit </span><span class="line" data-startTime="2584">into the app all that well. </span></p>

<p><span class="line" data-startTime="2595">Because of the way the app was </span><span class="line" data-startTime="2595">written, they didn't really </span><span class="line" data-startTime="2597">fit all that well. </span> <span class="line" data-startTime="2598">They were one of those things </span><span class="line" data-startTime="2598">where it's like ah, OK, well </span><span class="line" data-startTime="2600">this wasn't really particularly </span><span class="line" data-startTime="2600">needed. </span> <span class="line" data-startTime="2602">But I still thought they were </span><span class="line" data-startTime="2602">really cool and definitely </span><span class="line" data-startTime="2605">worth talking about. </span> <span class="line" data-startTime="2610">There's a new Identity API </span><span class="line" data-startTime="2610">that's available that allows </span><span class="line" data-startTime="2614">you to have your application </span><span class="line" data-startTime="2614">automatically </span><span class="line" data-startTime="2616">log into Google services. </span> <span class="line" data-startTime="2618">So the user says hey, I want to </span><span class="line" data-startTime="2618">log in to this particular </span><span class="line" data-startTime="2621">Google service. </span> <span class="line" data-startTime="2623">This is really for making it </span><span class="line" data-startTime="2623">easy so that you can get </span><span class="line" data-startTime="2626">things up to drive, or if you </span><span class="line" data-startTime="2626">want to access any of the </span><span class="line" data-startTime="2630">other APIs that Google </span><span class="line" data-startTime="2630">has to offer. </span> <span class="line" data-startTime="2632">So there's a couple of things </span><span class="line" data-startTime="2632">that we need do here in </span><span class="line" data-startTime="2635">order to use it. </span> <span class="line" data-startTime="2637">First thing you need to do, add </span><span class="line" data-startTime="2637">that identity permission. </span> <span class="line" data-startTime="2643">And then we create a new block </span><span class="line" data-startTime="2643">within the manifest file, and </span><span class="line" data-startTime="2649">we say OAuth 2.0 so it uses </span><span class="line" data-startTime="2649">the OAuth 2.0 protocol, I </span><span class="line" data-startTime="2655">guess it is. </span></p>

<p><span class="line" data-startTime="2657">And we go in and we provide </span><span class="line" data-startTime="2657">a client ID. </span> <span class="line" data-startTime="2660">So you get your client ID </span><span class="line" data-startTime="2660">from the dev console, so </span><span class="line" data-startTime="2667">code.google.com/API/console. </span> <span class="line" data-startTime="2669">You get your client ID from </span><span class="line" data-startTime="2669">there, and then you specify </span><span class="line" data-startTime="2673">the scopes that you want </span><span class="line" data-startTime="2673">to get access to. </span> <span class="line" data-startTime="2676">Much like you do if you're </span><span class="line" data-startTime="2676">writing any kind of other web </span><span class="line" data-startTime="2682">app that uses OAuth. </span> <span class="line" data-startTime="2684">We take all that complexity, all </span><span class="line" data-startTime="2684">that pain in the butt &mdash; if </span><span class="line" data-startTime="2687">you've ever done OAuth 2.0, </span><span class="line" data-startTime="2687">it's definitely at least </span><span class="line" data-startTime="2690">easier than OAuth 1.0, but it's </span><span class="line" data-startTime="2690">still not exactly the </span><span class="line" data-startTime="2693">most fun thing to do. </span> <span class="line" data-startTime="2695">And we simplify it for </span><span class="line" data-startTime="2695">you all in here. </span> <span class="line" data-startTime="2698">So we'll ask the user to sign </span><span class="line" data-startTime="2698">in, yep, great, here you go. </span> <span class="line" data-startTime="2701">And then you don't ever have </span><span class="line" data-startTime="2701">to worry about it again, </span><span class="line" data-startTime="2704">because all those requests that </span><span class="line" data-startTime="2704">you make will be done </span><span class="line" data-startTime="2709">with the right set </span><span class="line" data-startTime="2709">of permissions. </span></p>

<p><span class="line" data-startTime="2715">And then there's also when </span><span class="line" data-startTime="2715">you need to go get the </span><span class="line" data-startTime="2718">authentication token, there's </span><span class="line" data-startTime="2718">just a simple API that you </span><span class="line" data-startTime="2720">call and say hey, go </span><span class="line" data-startTime="2720">get me that token. </span> <span class="line" data-startTime="2723">All right, we're good to go, </span><span class="line" data-startTime="2723">we can start doing things. </span> <span class="line" data-startTime="2727">One of the ways that I wanted </span><span class="line" data-startTime="2727">to use this and see myself </span><span class="line" data-startTime="2733">using this for in the future, </span><span class="line" data-startTime="2733">is if you wanted to build an </span><span class="line" data-startTime="2738">offline RSS reader that actually </span><span class="line" data-startTime="2738">grabs the user's feed </span><span class="line" data-startTime="2744">from Google Reader, you could </span><span class="line" data-startTime="2744">use exactly this API to say </span><span class="line" data-startTime="2748">all right, let's go authenticate </span><span class="line" data-startTime="2748">the user. </span></p>

<p><span class="line" data-startTime="2750">Now we can go and get their feed </span><span class="line" data-startTime="2750">information, figure out </span><span class="line" data-startTime="2753">what they're reading and </span><span class="line" data-startTime="2753">pull it in that way. </span> <span class="line" data-startTime="2756">So that way instead of having to </span><span class="line" data-startTime="2756">go deal with anything else, </span><span class="line" data-startTime="2759">we're golden. </span> <span class="line" data-startTime="2760">We can just, sweet, don't have </span><span class="line" data-startTime="2760">to write anything crazy in </span><span class="line" data-startTime="2764">order to do that. </span> <span class="line" data-startTime="2766">There's a bunch of other stuff </span><span class="line" data-startTime="2766">that I think is pretty slick. </span> <span class="line" data-startTime="2771">Context menus, like real apps. </span> <span class="line" data-startTime="2773">If I've got an app that's </span><span class="line" data-startTime="2773">installed on my computer, I </span><span class="line" data-startTime="2776">expect to be able to right-click </span><span class="line" data-startTime="2776">on it and pull up </span><span class="line" data-startTime="2778">a context menu. </span> <span class="line" data-startTime="2779">Chrome apps have the ability </span><span class="line" data-startTime="2779">to say hey, I </span><span class="line" data-startTime="2782">want a context menu. </span> <span class="line" data-startTime="2783">So through Chrome context </span><span class="line" data-startTime="2783">menus create, you </span><span class="line" data-startTime="2786">can go and do that. </span></p>

<p><span class="line" data-startTime="2788">All of these &mdash; </span><span class="line" data-startTime="2789">don't worry about writing any </span><span class="line" data-startTime="2789">of these down if you can't </span><span class="line" data-startTime="2791">really read it all that well. </span> <span class="line" data-startTime="2794">You can go check the slides </span><span class="line" data-startTime="2794">later, or have a look at some </span><span class="line" data-startTime="2796">of the docs &mdash; </span><span class="line" data-startTime="2798">create windows. </span> <span class="line" data-startTime="2800">Apps should be able to create </span><span class="line" data-startTime="2800">as many windows as often as </span><span class="line" data-startTime="2804">they want without being spammy </span><span class="line" data-startTime="2804">or annoying, but </span><span class="line" data-startTime="2808">real apps can do that. </span> <span class="line" data-startTime="2809">We're kind of prevented from </span><span class="line" data-startTime="2809">doing that on the web. </span> <span class="line" data-startTime="2811">For a good reason most </span><span class="line" data-startTime="2811">of the time. </span></p>

<p><span class="line" data-startTime="2813">But we just say create a </span><span class="line" data-startTime="2813">window, provide a URL &mdash; </span><span class="line" data-startTime="2818">that URL is a local URL. </span> <span class="line" data-startTime="2820">We can't say open a URL to HTTP </span><span class="line" data-startTime="2820">whack whack Google, or </span><span class="line" data-startTime="2824">whack whack whatever, </span><span class="line" data-startTime="2824">it has to be a </span><span class="line" data-startTime="2826">file within our package. </span> <span class="line" data-startTime="2830">We've got great stuff for doing </span><span class="line" data-startTime="2830">window manipulation. </span> <span class="line" data-startTime="2833">So I can go and set </span><span class="line" data-startTime="2833">focus on a window. </span> <span class="line" data-startTime="2835">I could say this window should </span><span class="line" data-startTime="2835">be in focus right now, or </span><span class="line" data-startTime="2838">minimize and maximize windows. </span> <span class="line" data-startTime="2840">Just like you can with regular </span><span class="line" data-startTime="2840">applications that </span><span class="line" data-startTime="2844">the user has installed. </span> <span class="line" data-startTime="2845">They're used to having app do </span><span class="line" data-startTime="2845">that, like hey, this app, I </span><span class="line" data-startTime="2848">want you to go away because </span><span class="line" data-startTime="2848">I'm not really </span><span class="line" data-startTime="2850">using you right now. </span> <span class="line" data-startTime="2852">Great, done. </span> <span class="line" data-startTime="2853">We can have them restore, move </span><span class="line" data-startTime="2853">and resize, just like we can </span><span class="line" data-startTime="2857">with regular installed </span><span class="line" data-startTime="2857">applications. </span> <span class="line" data-startTime="2863">One of the ones that </span><span class="line" data-startTime="2863">I think is kind of </span><span class="line" data-startTime="2864">cool, text to speech. </span> <span class="line" data-startTime="2865">So you can have your apps </span><span class="line" data-startTime="2865">start talking to you. </span></p>

<p><span class="line" data-startTime="2870">There's even one that'll listen </span><span class="line" data-startTime="2870">for what you say, so </span><span class="line" data-startTime="2873">there's a speech recognition. </span> <span class="line" data-startTime="2874">Hmm, speech recognition plus a </span><span class="line" data-startTime="2874">little text speech, you could </span><span class="line" data-startTime="2879">start writing your </span><span class="line" data-startTime="2879">own kind of fun &mdash; </span><span class="line" data-startTime="2881">anyway, you can figure out where </span><span class="line" data-startTime="2881">we're going on that one, </span><span class="line" data-startTime="2883">or where I think you should </span><span class="line" data-startTime="2883">go on that one. </span> <span class="line" data-startTime="2887">There's a couple other API </span><span class="line" data-startTime="2887">changes that I want to call </span><span class="line" data-startTime="2890">out because I think they're </span><span class="line" data-startTime="2890">pretty important. </span> <span class="line" data-startTime="2894">Links. </span> <span class="line" data-startTime="2895">When we're used to writing web </span><span class="line" data-startTime="2895">apps, we put links in our </span><span class="line" data-startTime="2897">apps, right? </span><span class="line" data-startTime="2898">Like, you've got a link that </span><span class="line" data-startTime="2898">goes to here, you've got a </span><span class="line" data-startTime="2900">link that goes to there. </span></p>

<p><span class="line" data-startTime="2902">Links will open in a new Chrome </span><span class="line" data-startTime="2902">window if they go to </span><span class="line" data-startTime="2906">somewhere external. </span> <span class="line" data-startTime="2908">So keep that in mind. </span> <span class="line" data-startTime="2909">That like hey, if you put a </span><span class="line" data-startTime="2909">link to HTTP whack whack </span><span class="line" data-startTime="2912">Google.com, it's going to go and </span><span class="line" data-startTime="2912">open up a browser window. </span> <span class="line" data-startTime="2915">It's not going to </span><span class="line" data-startTime="2915">open up within </span><span class="line" data-startTime="2917">your application window. </span> <span class="line" data-startTime="2919">So links to outside places will </span><span class="line" data-startTime="2919">open in a new window. </span> <span class="line" data-startTime="2925">By default, this one threw me </span><span class="line" data-startTime="2925">when I first did it, because I </span><span class="line" data-startTime="2929">was like, why can't </span><span class="line" data-startTime="2929">I select anything? </span><span class="line" data-startTime="2930">I'm trying select something. </span> <span class="line" data-startTime="2934">Think about most applications </span><span class="line" data-startTime="2934">that you have. </span> <span class="line" data-startTime="2936">You can't go and select most </span><span class="line" data-startTime="2936">of the text on there unless </span><span class="line" data-startTime="2938">it's a text box. </span> <span class="line" data-startTime="2940">So just like an installed </span><span class="line" data-startTime="2940">application, you can't select </span><span class="line" data-startTime="2944">the text in one of these </span><span class="line" data-startTime="2944">applications unless you </span><span class="line" data-startTime="2946">specifically say this region, </span><span class="line" data-startTime="2946">this block here, the C S S div </span><span class="line" data-startTime="2952">span, whatever, is selectable. </span></p>

<p><span class="line" data-startTime="2954">So by default, we say </span><span class="line" data-startTime="2954">user select is none. </span> <span class="line" data-startTime="2958">We can't put iframes in there, </span><span class="line" data-startTime="2958">we got to use something called </span><span class="line" data-startTime="2962">the browser tag instead. </span> <span class="line" data-startTime="2965">Again, that's a security </span><span class="line" data-startTime="2965">thing. </span> <span class="line" data-startTime="2968">Think about hey, we've got this </span><span class="line" data-startTime="2968">app, this great app, and </span><span class="line" data-startTime="2972">we let you put an iframe in. </span> <span class="line" data-startTime="2973">Or you're rendering content from </span><span class="line" data-startTime="2973">somewhere else and they </span><span class="line" data-startTime="2977">put an iframe in. </span> <span class="line" data-startTime="2978">All of a sudden you've just </span><span class="line" data-startTime="2978">opened this gigantic potential </span><span class="line" data-startTime="2983">security vulnerability, because </span><span class="line" data-startTime="2983">other people could </span><span class="line" data-startTime="2985">start putting anything they want </span><span class="line" data-startTime="2985">within your application. </span></p>

<p><span class="line" data-startTime="2988">So we make it very explicit </span><span class="line" data-startTime="2988">what you can and can't put </span><span class="line" data-startTime="2991">into those. </span> <span class="line" data-startTime="2992">You could create some sandboxed </span><span class="line" data-startTime="2992">iframes, and the </span><span class="line" data-startTime="2995">browser tag is a </span><span class="line" data-startTime="2995">sandbox thing. </span> <span class="line" data-startTime="2998">If you didn't make it to Eric </span><span class="line" data-startTime="2998">and Mehi's session earlier, </span><span class="line" data-startTime="3002">they showed some specific </span><span class="line" data-startTime="3002">demos around that. </span> <span class="line" data-startTime="3006">Kind of neat stuff. </span> <span class="line" data-startTime="3008">Local storage and Web SQL </span><span class="line" data-startTime="3008">are also turned off. </span> <span class="line" data-startTime="3016">Local storage is turned </span><span class="line" data-startTime="3016">off primarily </span><span class="line" data-startTime="3017">for performance reasons. </span> <span class="line" data-startTime="3020">It's synchronous, so hey, </span><span class="line" data-startTime="3020">go put something </span><span class="line" data-startTime="3023">into the data storage. </span> <span class="line" data-startTime="3026">OK, please wait while </span><span class="line" data-startTime="3026">I do that. </span> <span class="line" data-startTime="3032">Applications should be fast. </span></p>

<p><span class="line" data-startTime="3034">Having synchronous things </span><span class="line" data-startTime="3034">happening is not exactly going </span><span class="line" data-startTime="3037">to do that. </span> <span class="line" data-startTime="3038">We've also turned off Web SQL. </span> <span class="line" data-startTime="3040">It is a deprecated API. </span> <span class="line" data-startTime="3044">Will it ever go away </span><span class="line" data-startTime="3044">from the web? </span><span class="line" data-startTime="3045">Probably not, but it's </span><span class="line" data-startTime="3045">not getting the </span><span class="line" data-startTime="3048">attention it deserves. </span> <span class="line" data-startTime="3049">So instead, use something like </span><span class="line" data-startTime="3049">index db, which has a pretty </span><span class="line" data-startTime="3053">strong following right now and </span><span class="line" data-startTime="3053">it's got good browser support. </span> <span class="line" data-startTime="3060">The FileSystem API is </span><span class="line" data-startTime="3060">another great one. </span> <span class="line" data-startTime="3063">It allows you to store big </span><span class="line" data-startTime="3063">files on the user's file </span><span class="line" data-startTime="3066">system in a sandboxed </span><span class="line" data-startTime="3066">environment so you can't </span><span class="line" data-startTime="3070">exactly go read their resume and </span><span class="line" data-startTime="3070">their user documents file </span><span class="line" data-startTime="3073">or something like that. </span> <span class="line" data-startTime="3075">Or use the storage API that I </span><span class="line" data-startTime="3075">talked about earlier, so that </span><span class="line" data-startTime="3077">you can go in and say hey, I </span><span class="line" data-startTime="3077">want to store something on the </span><span class="line" data-startTime="3080">user's computer, I want it </span><span class="line" data-startTime="3080">synced up into the cloud, or </span><span class="line" data-startTime="3083">maybe I just want it locally </span><span class="line" data-startTime="3083">in this one specific place. </span></p>

<p><span class="line" data-startTime="3088">Most plug-ins and a number of </span><span class="line" data-startTime="3088">the Chrome extension things </span><span class="line" data-startTime="3092">are disabled. </span> <span class="line" data-startTime="3093">So you can't go put some kind </span><span class="line" data-startTime="3093">of plug-in in your app, we </span><span class="line" data-startTime="3099">stopped those from happening. </span> <span class="line" data-startTime="3100">We think the web can be built </span><span class="line" data-startTime="3100">without any plug-ins. </span> <span class="line" data-startTime="3104">You saw this morning in the </span><span class="line" data-startTime="3104">keynote, the Cirque du Soleil </span><span class="line" data-startTime="3106">thing, there were no </span><span class="line" data-startTime="3106">plug-ins there. </span> <span class="line" data-startTime="3108">That was all HTML, C S S and a </span><span class="line" data-startTime="3108">bunch of divs and some images. </span> <span class="line" data-startTime="3113">So all that stuff can be done </span><span class="line" data-startTime="3113">without plug-ins, so let's </span><span class="line" data-startTime="3116">start doing that. </span> <span class="line" data-startTime="3118">And finally &mdash; </span><span class="line" data-startTime="3120">I know I'm guilty of it myself </span><span class="line" data-startTime="3120">sometime, you put in an alert </span><span class="line" data-startTime="3127">or something like that </span><span class="line" data-startTime="3127">so you can do </span><span class="line" data-startTime="3128">debugging modal dialogs. </span> <span class="line" data-startTime="3131">Users don't want </span><span class="line" data-startTime="3131">modal dialogs. </span></p>

<p><span class="line" data-startTime="3133">So instead, use custom light </span><span class="line" data-startTime="3133">boxes, use other things so </span><span class="line" data-startTime="3137">that the app can keep running. </span> <span class="line" data-startTime="3139">Because the one key thing </span><span class="line" data-startTime="3139">about modal dialogues is </span><span class="line" data-startTime="3143">they're not just a modal for </span><span class="line" data-startTime="3143">what the user's doing, but </span><span class="line" data-startTime="3146">they also stop the </span><span class="line" data-startTime="3146">app from running. </span> <span class="line" data-startTime="3149">So any of the JavaScript is just </span><span class="line" data-startTime="3149">sitting there going do da </span><span class="line" data-startTime="3151">do da do, we're not </span><span class="line" data-startTime="3151">doing anything. </span> <span class="line" data-startTime="3155">I could stand up here for three </span><span class="line" data-startTime="3155">minutes and not say </span><span class="line" data-startTime="3157">anything, and it's </span><span class="line" data-startTime="3157">just as boring. </span> <span class="line" data-startTime="3160">So you want your app </span><span class="line" data-startTime="3160">to keep running. </span> <span class="line" data-startTime="3164">So what's next? </span><span class="line" data-startTime="3167">You could start using this and </span><span class="line" data-startTime="3167">start playing with this today </span><span class="line" data-startTime="3170">to really build apps that break </span><span class="line" data-startTime="3170">out of the browser. </span> <span class="line" data-startTime="3173">I go back to those first </span><span class="line" data-startTime="3173">four points. </span></p>

<p><span class="line" data-startTime="3176">They break out of the browser so </span><span class="line" data-startTime="3176">they don't have the address </span><span class="line" data-startTime="3178">bar, so they don't look like a </span><span class="line" data-startTime="3178">browser-based application. </span> <span class="line" data-startTime="3184">Takes that power that we think </span><span class="line" data-startTime="3184">the web has, and really allows </span><span class="line" data-startTime="3189">it to break out of there and </span><span class="line" data-startTime="3189">become a much bigger platform. </span> <span class="line" data-startTime="3194">The enhanced UI so that you can </span><span class="line" data-startTime="3194">control how applications </span><span class="line" data-startTime="3197">look, how they feel, how they </span><span class="line" data-startTime="3197">open and close windows. </span> <span class="line" data-startTime="3202">They feel like they're </span><span class="line" data-startTime="3202">installed, that they work </span><span class="line" data-startTime="3205">offline by default. </span> <span class="line" data-startTime="3206">This is the one I think I'm most </span><span class="line" data-startTime="3206">excited about, because it </span><span class="line" data-startTime="3209">means that I can write stuff </span><span class="line" data-startTime="3209">that works offline and that </span><span class="line" data-startTime="3213">people expect to work offline. </span> <span class="line" data-startTime="3216">I'm going to say, I'm going to </span><span class="line" data-startTime="3216">use it again, and some people </span><span class="line" data-startTime="3220">will make fun of me. </span> <span class="line" data-startTime="3221">My mom doesn't expect web </span><span class="line" data-startTime="3221">apps to work offline. </span> <span class="line" data-startTime="3223">She's going to expect these to </span><span class="line" data-startTime="3223">work offline, so we got to </span><span class="line" data-startTime="3228">start building them this way. </span> <span class="line" data-startTime="3229">And finally, really takes </span><span class="line" data-startTime="3229">advantage of the native </span><span class="line" data-startTime="3233">capabilities through new APIs. </span></p>

<p><span class="line" data-startTime="3235">I didn't get into it at all in </span><span class="line" data-startTime="3235">this session, but you should </span><span class="line" data-startTime="3238">drop by the Chrome </span><span class="line" data-startTime="3238">booth afterwards. </span> <span class="line" data-startTime="3240">We actually have taken one of </span><span class="line" data-startTime="3240">these new packaged apps, used </span><span class="line" data-startTime="3244">the Bluetooth API through this </span><span class="line" data-startTime="3244">packaged app, and we're </span><span class="line" data-startTime="3248">controlling a LEGO Mindstorm </span><span class="line" data-startTime="3248">robot with it. </span> <span class="line" data-startTime="3251">So you've got access to </span><span class="line" data-startTime="3251">Bluetooth, USB, TCP, UDP. </span> <span class="line" data-startTime="3255">You've got great access to truly </span><span class="line" data-startTime="3255">the device that these </span><span class="line" data-startTime="3260">applications are running on. </span> <span class="line" data-startTime="3262">But most importantly, you can </span><span class="line" data-startTime="3262">start testing this today. </span> <span class="line" data-startTime="3264">Go install the Chrome Canary </span><span class="line" data-startTime="3264">build and start playing, </span><span class="line" data-startTime="3269">because there's a lot of </span><span class="line" data-startTime="3269">great stuff there. </span></p>

<p><span class="line" data-startTime="3272">There's a bunch of really good </span><span class="line" data-startTime="3272">resources if you're looking to </span><span class="line" data-startTime="3275">get started in this. </span> <span class="line" data-startTime="3276">The Chrome packaged apps </span><span class="line" data-startTime="3276">documentation, the URLs there, </span><span class="line" data-startTime="3280">these slides will go up </span><span class="line" data-startTime="3280">online momentarily. </span> <span class="line" data-startTime="3283">But if you go to </span><span class="line" data-startTime="3283">developers.google.com/chrome, </span><span class="line" data-startTime="3289">all of that stuff will </span><span class="line" data-startTime="3289">be linked from there. </span> <span class="line" data-startTime="3291">If you've got questions, you're </span><span class="line" data-startTime="3291">working on something </span><span class="line" data-startTime="3293">and you're like why isn't </span><span class="line" data-startTime="3293">this working? </span><span class="line" data-startTime="3296">Send an email to the </span><span class="line" data-startTime="3296">Chromium-Apps Mailing List. </span> <span class="line" data-startTime="3299">We all have a whole bunch of </span><span class="line" data-startTime="3299">great sample applications, so </span><span class="line" data-startTime="3302">you can see how some of these </span><span class="line" data-startTime="3302">applications were built. </span> <span class="line" data-startTime="3306">And finally, the last one that </span><span class="line" data-startTime="3306">I put up on there because I </span><span class="line" data-startTime="3309">thought it was really useful. </span> <span class="line" data-startTime="3311">Mike West, who's at the back </span><span class="line" data-startTime="3311">of the room, wrote a </span><span class="line" data-startTime="3313">wonderfully fantastic </span><span class="line" data-startTime="3313">article that is an </span><span class="line" data-startTime="3316">introduction to CSP. </span></p>

<p><span class="line" data-startTime="3318">I gave you sort of a taste of </span><span class="line" data-startTime="3318">it today, but he goes into a </span><span class="line" data-startTime="3322">lot more depth, additional </span><span class="line" data-startTime="3322">things it's useful for. </span> <span class="line" data-startTime="3326">And if you're going to use it </span><span class="line" data-startTime="3326">in a website, how you can go </span><span class="line" data-startTime="3330">and adjust some of the different </span><span class="line" data-startTime="3330">permissions to </span><span class="line" data-startTime="3333">restrict or loosen things </span><span class="line" data-startTime="3333">for websites. </span> <span class="line" data-startTime="3337">You can't change them in a </span><span class="line" data-startTime="3337">Chrome packaged app, but you </span><span class="line" data-startTime="3340">can change them on the web. </span> <span class="line" data-startTime="3343">With that, I want to say thank </span><span class="line" data-startTime="3343">you guys very much for coming </span><span class="line" data-startTime="3346">and sticking with me. </span> <span class="line" data-startTime="3347">I hope this was somewhat </span><span class="line" data-startTime="3347">interesting for you. </span> <span class="line" data-startTime="3353">The link to the slides is up </span><span class="line" data-startTime="3353">there, you could see it, </span><span class="line" data-startTime="3355">goo.gl/5krvb. </span></p>

<p><span class="line" data-startTime="3359">The slides are up there now. </span> <span class="line" data-startTime="3362">I'll say thank you, </span><span class="line" data-startTime="3362">I'll open it up </span><span class="line" data-startTime="3363">to any of your questions. </span></p>

<p class="speaker"><span class="line" data-starttime="3371"><span class="speakerName">Audience</span>: So how would I put </span><span class="line" data-startTime="3371">Analytics into an app? </span></p>

<p class="speaker"><span class="line" data-starttime="3375"><span class="speakerName">Pete LePage</span>: That's </span><span class="line" data-startTime="3375">a great question. </span><span class="line" data-startTime="3377">So the question, I guess I </span><span class="line" data-startTime="3377">don't need to repeat them </span><span class="line" data-startTime="3379">because we have microphones. </span><span class="line" data-startTime="3382">We are working on an Analytics </span><span class="line" data-startTime="3382">API that will allow you to go </span><span class="line" data-startTime="3385">and do that so that you can </span><span class="line" data-startTime="3385">just say hey, here's my </span><span class="line" data-startTime="3388">Analytics UA string, and here's </span><span class="line" data-startTime="3388">the things I want to </span><span class="line" data-startTime="3394">[? apply. ?] </span><span class="line" data-startTime="3395">We're not ready with it yet, but </span><span class="line" data-startTime="3395">it will be coming at some </span><span class="line" data-startTime="3398">point in the near future. </span></p>

<p class="speaker"><span class="line" data-starttime="3399"><span class="speakerName">Audience</span>: Could I copy </span><span class="line" data-startTime="3399">the Analytics js </span><span class="line" data-startTime="3401">files and package them? </span></p>

<p class="speaker"><span class="line" data-starttime="3403"><span class="speakerName">Pete LePage</span>: So the question </span><span class="line" data-startTime="3403">was, can I copy the Analytics </span><span class="line" data-startTime="3405">js files and include them </span><span class="line" data-startTime="3405">in your package? </span><span class="line" data-startTime="3408">You could try. </span><span class="line" data-startTime="3409">My guess is it probably </span><span class="line" data-startTime="3409">won't work, I </span><span class="line" data-startTime="3411">haven't tried it myself. </span><span class="line" data-startTime="3414">It uses cookies, so </span><span class="line" data-startTime="3414">the answer is no. </span><span class="line" data-startTime="3416">There you go. </span></p>

<p class="speaker"><span class="line" data-starttime="3420"><span class="speakerName">Audience</span>: Is this stuff going </span><span class="line" data-startTime="3420">to work on Chrome </span><span class="line" data-startTime="3422">for Android and iOS? </span></p>

<p class="speaker"><span class="line" data-starttime="3423"><span class="speakerName">Pete LePage</span>: So Chrome for </span><span class="line" data-startTime="3423">Android, Chrome for iOS, it's </span><span class="line" data-startTime="3428">something we're definitely </span><span class="line" data-startTime="3428">thinking about. </span><span class="line" data-startTime="3430">I think as Sundar said this </span><span class="line" data-startTime="3430">morning, it's something we </span><span class="line" data-startTime="3432">want to bring there, it's </span><span class="line" data-startTime="3432">not there today. </span><span class="line" data-startTime="3437">I want it just as soon as you </span><span class="line" data-startTime="3437">guys do, because hey, if I can </span><span class="line" data-startTime="3441">write an app and have it work </span><span class="line" data-startTime="3441">everywhere, I'm a happy guy. </span></p>

<p class="speaker"><span class="line" data-starttime="3449"><span class="speakerName">Audience</span>: When can I write </span><span class="line" data-startTime="3449">my Chrome app in Dart? </span></p>

<p class="speaker"><span class="line" data-starttime="3452"><span class="speakerName">Pete LePage</span>: When can you write </span><span class="line" data-startTime="3452">your Chrome app in Dart? </span><span class="line" data-startTime="3454">I believe you can write your </span><span class="line" data-startTime="3454">Chrome app in Dart today. </span><span class="line" data-startTime="3460">I'll give you two answers. </span><span class="line" data-startTime="3462">One, you can write it in Dart </span><span class="line" data-startTime="3462">today, compile it down to </span><span class="line" data-startTime="3465">JavaScript, done, you </span><span class="line" data-startTime="3465">can publish today. </span><span class="line" data-startTime="3468">In Dart, I'm not sure how close </span><span class="line" data-startTime="3468">the Dartium browser is </span><span class="line" data-startTime="3473">staying to the Chrome </span><span class="line" data-startTime="3473">dev channel. </span><span class="line" data-startTime="3476">So whenever those guys are close </span><span class="line" data-startTime="3476">to whatever we have in </span><span class="line" data-startTime="3480">dev today is then. </span></p>

<p class="speaker"><span class="line" data-starttime="3481"><span class="speakerName">Audience</span>: The Manifest </span><span class="line" data-startTime="3481">by JSON had a </span><span class="line" data-startTime="3486">JavaScript function call? </span></p>

<p class="speaker"><span class="line" data-starttime="3488"><span class="speakerName">Pete LePage</span>: Yes, so that's </span><span class="line" data-startTime="3488">a good question. </span><span class="line" data-startTime="3491">I don't have an answer </span><span class="line" data-startTime="3491">to that. </span><span class="line" data-startTime="3493">Do either of you guys </span><span class="line" data-startTime="3493">know offhand? </span></p>

<p class="speaker"><span class="line" data-starttime="3495"><span class="speakerName">Male Speaker</span>: Right now </span><span class="line" data-startTime="3495">they [INAUDIBLE]. </span></p>

<p class="speaker"><span class="line" data-starttime="3504"><span class="speakerName">Pete LePage</span>: So right now </span><span class="line" data-startTime="3504">JavaScript only, but it is </span><span class="line" data-startTime="3508">something that potentially </span><span class="line" data-startTime="3508">is coming? </span><span class="line" data-startTime="3511">Is &mdash; </span><span class="line" data-startTime="3512">yeah, well. </span><span class="line" data-startTime="3513">So Mehi is one of </span><span class="line" data-startTime="3513">the developers. </span></p>

<p class="speaker"><span class="line" data-starttime="3518"><span class="speakerName">Mehi</span>: Hi, I'm one of the </span><span class="line" data-startTime="3518">engineers on Chrome apps. </span><span class="line" data-startTime="3521">So these APIs have a language </span><span class="line" data-startTime="3521">agnostic binding system, and </span><span class="line" data-startTime="3526">the goal is to expose them </span><span class="line" data-startTime="3526">to Dart Native Client and </span><span class="line" data-startTime="3528">JavaScript. </span><span class="line" data-startTime="3529">Right now only the JavaScript </span><span class="line" data-startTime="3529">part is implemented, but </span><span class="line" data-startTime="3532">coming soon those other two. </span></p>

<p class="speaker"><span class="line" data-starttime="3537"><span class="speakerName">Pete LePage</span>: Cool. </span><span class="line" data-startTime="3538">Any other questions? </span><span class="line" data-startTime="3542">All right, well that's </span><span class="line" data-startTime="3542">the way to finish. </span><span class="line" data-startTime="3544">I'm sorry, I'm going to let </span><span class="line" data-startTime="3544">you out a minute and 20 </span><span class="line" data-startTime="3547">seconds early, I hope </span><span class="line" data-startTime="3547">you don't mind. </span><span class="line" data-startTime="3549">Thanks guys, have a great </span><span class="line" data-startTime="3549">day, have a great I/O. </span></p></div>